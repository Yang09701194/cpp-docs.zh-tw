---
title: 日期類型
ms.date: 11/04/2016
f1_keywords:
- DATE
helpviewer_keywords:
- Date data type, implementing
- Date data type
- DATE type
- Date data type, about Date data type
- MFC, date and time
- hour values representation
ms.assetid: 695853ed-b614-4575-b793-b8c287372038
ms.openlocfilehash: bd63b400cad6efc3b3899c17a3bf835596b4008c
ms.sourcegitcommit: dedd4c3cb28adec3793329018b9163ffddf890a4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/11/2019
ms.locfileid: "57750386"
---
# <a name="date-type"></a>日期類型

日期類型被實作使用 8 位元組浮點數。 開頭為 1899 年 12 月 30 日午夜時間為零的整數值為增量單位來表示天。 小時值會表示為數值的小數點後數字的絕對值。 下表說明以及其日期類型的數字相等的數個日期：

|日期和時間|表示法|
|-------------------|--------------------|
|1899 年 12 月 30日日午夜|0.00|
|1900 年 1 月 1日日午夜|2.00|
|1900 年 1 月 4日日午夜|5.00|
|1900 年 1 月 4 日上午 6 點|5.25|
|4 年 1 月 1900 年中午 12:00|5.50|
|1900 年 1 月 4 日下午 9 點。|5.875|

日期的日期類型，以及`COleDateTime`類別，表示日期和時間，以傳統的數字行。 `COleDateTime`類別包含數種方法來操作日期值，包括其他常見的日期格式的來回轉換。

在自動化中的這些日期和時間格式使用時，應該注意下列幾點：

- 被指定本地時間的日期使用不同時區的日期時，必須手動執行同步處理。

- 不考慮日光節約時間的日期類型。

- 日期時間軸會變成不連續的日期值小於 0 （1899年前的 30 年 12 月）。 這是因為日期值的整數部分視為帶正負號，而小數部分，都會被視為為不帶正負號。 換句話說，日期值的整數部分可能是正數或負數時的日期值的小數部分永遠會加入到整體的日期。 下表說明一些範例：

|日期和時間|表示法|
|-------------------|--------------------|
|1899 年 12 月 27日日午夜|-3.00|
|28 1899 年 12 月中午 12:00|-2.50|
|1899 年 12 月 28日日午夜|-2.00|
|1899 年 12 月 29日日午夜|-1.00|
|1899 年 12 月 30日日下午 6 點。|-0.75|
|30 年 12 月 1899 日中午 12:00|-0.50|
|1899 年 12 月 30日日上午 6 點|-0.25|
|1899 年 12 月 30日日午夜|0.00|
|1899 年 12 月 30日日上午 6 點|0.25|
|30 年 12 月 1899 日中午 12:00|0.50|
|1899 年 12 月 30日日下午 6 點。|0.75|
|1899 年 12 月 31日日午夜|1.00|
|1900 年 1 月 1日日午夜|2.00|
|1 年 1 月 1900 年中午 12:00|2.50|
|1900 年 1 月 2日日午夜|3.00|

> [!CAUTION]
>  請注意，因為上午 6:00 一律由分數值 0.25 不論代表日期的整數是正數 （之後 1899 年 12 月 30 日) 或負數 （之前 1899 年 12 月 30 日)，簡單的浮動點比較會錯誤地排序代表早於 12/30/1899 做為一天上午 6:00 的任何日期*稍後*比代表上午 7:00 該同一天的日期。

在日期相關的問題的詳細資訊和`COleDateTime`可以找到類型[COleDateTime 類別](../atl-mfc-shared/reference/coledatetime-class.md)和[日期和時間：自動化支援](../atl-mfc-shared/date-and-time-automation-support.md)。

## <a name="see-also"></a>另請參閱

[日期和時間](../atl-mfc-shared/date-and-time.md)<br/>
[COleDateTime 類別](../atl-mfc-shared/reference/coledatetime-class.md)
