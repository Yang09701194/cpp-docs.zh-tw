---
title: "加入控制項 (ATL 教學課程，第 2 部分) | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "get-started-article"
dev_langs: 
  - "C++"
ms.assetid: c9575a75-1064-41f1-9697-7aada560c669
caps.latest.revision: 15
caps.handback.revision: 10
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# 加入控制項 (ATL 教學課程，第 2 部分)
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

在這個步驟中，您會將控制項加入至專案、加以建置，並在網頁上進行測試。  
  
## 程序  
  
#### 若要將物件加入至 ATL 專案。  
  
1.  在 \[類別檢視\] 中以滑鼠右鍵按一下 Polygon 專案。  
  
2.  指向捷徑功能表上的 \[**加入**\]，再按一下子功能表中的 \[**類別**\]。  
  
     \[加入類別\] 對話方塊隨即出現。  不同的物件分類會在左邊的樹狀結構中列出。  
  
3.  按一下 \[**ATL**\] 資料夾。  
  
4.  從右側的範本清單，選取 \[**ATL 控制項**\]。  按一下 \[**加入**\]。  ATL 控制項精靈將會開啟，您可以設定控制項。  
  
5.  輸入 `PolyCtl` 做為簡短名稱，並注意其他欄位會自動完成。  還不要按下 \[**完成**\]，因為還要進行一些變更。  
  
 ATL 控制項精靈的 \[**名稱**\] 頁面包含下列欄位：  
  
|欄位|內容|  
|--------|--------|  
|**簡短名稱**|您為控制項輸入的名稱。|  
|**類別**|建立來實作控制項的 C\+\+ 類別名稱。|  
|**.h 檔案**|所建立來包含 C\+\+ 類別定義的檔案。|  
|**.cpp 檔**|所建立來包含 C\+\+ 類別實作的檔案。|  
|**CoClass**|此控制項之元件類別的名稱。|  
|**介面**|介面的名稱，控制項將會在此介面上實作其自訂方法和屬性。|  
|**型別**|控制項的描述。|  
|**ProgID**|可用於查詢控制項 CLSID 的可讀取名稱。|  
  
 您必須在 ATL 控制項精靈中進行數個不同的設定。  
  
#### 若要啟用對豐富錯誤資訊和連接點的支援  
  
1.  按一下 \[**選項**\] 開啟 \[**選項**\] 頁面。  
  
2.  選取 \[**連接點**\] 核取方塊。  這會在 IDL 檔案中建立流出介面的支援。  
  
 您也可以讓控制項可插入，這表示它可以內嵌在支援內嵌物件的應用程式，例如 Excel 或 Word。  
  
#### 若要將控制項設為可插入  
  
1.  按一下 \[**外觀**\] 開啟 \[**外觀**\] 頁面。  
  
2.  選取 \[**可插入的**\] 核取方塊。  
  
 物件顯示的多邊形具有純色填滿色彩，因此您必須加入 `Fill Color` 內建屬性。  
  
#### 若要加入填滿色彩內建屬性及建立控制項  
  
1.  按一下 \[**內建屬性**\] 開啟 \[**內建屬性**\] 頁面。  
  
2.  在 \[**不支援**\] 下，向下捲動可能的內建屬性清單。  按兩下 \[`Fill Color`\]，將它移至 \[**支援**\] 清單。  
  
3.  這樣便完成了控制項的選項。  按一下 \[完成\]。  
  
 精靈建立控制項時，會發生數個變更程式碼和新增檔案的情況。  同時會建立以下的檔案：  
  
|檔案|描述|  
|--------|--------|  
|PolyCtl.h|包含大部分 C\+\+ 類別 `CPolyCtl` 的實作。|  
|PolyCtl.cpp|包含 `CPolyCtl` 的其餘部分。|  
|PolyCtl.rgs|包含用來註冊控制項指令碼控制項的文字檔。|  
|PolyCtl.htm|包含新建立之控制項的 Web 參考。|  
  
 精靈也實作了下列程式碼變更：  
  
-   將 `#include` 陳述式加入至 stdafx.h 和 stdafx.cpp 檔，以包含支援控制項所需的 ATL 檔案。  
  
-   變更 Polygon.idl 以加入新控制項的詳細資料。  
  
-   將新的控制項加入至 Polygon.cpp 中的物件對應。  
  
 您現在可以建置控制項以了解其動作。  
  
## 建置和測試控制項  
  
#### 若要建置和測試控制項  
  
1.  在 \[**建置**\] 功能表上，按一下 \[**建置多邊形**\]。  
  
     控制項完成建置後，以滑鼠右鍵按一下 \[**方案總管**\] 中的 PolyCtl.htm，並選取 \[**在瀏覽器中檢視**\]。  將會顯示包含控制項的 HTML 網頁。  您應該會看到標題為「物件 PolyCtl 的 ATL 8.0 測試頁」的頁面和文字 **PolyCtl**。  這是您的控制項。  
  
> [!NOTE]
>  當完成本教學課程時，如果您收到 DLL 檔案無法建立的錯誤訊息時，請關閉 PolyCtl.htm 檔案和 ActiveX 控制項測試容器並重新建置方案。  如果您仍然無法建立 DLL，請重新啟動電腦或登出 \(如果您使用終端機服務\)。  
  
 接下來將自訂屬性加入至控制項。  
  
 [回到步驟 1](../atl/creating-the-project-atl-tutorial-part-1.md) &#124; [繼續至步驟 3。](../atl/adding-a-property-to-the-control-atl-tutorial-part-3.md)  
  
## 請參閱  
 [教學課程](../atl/active-template-library-atl-tutorial.md)