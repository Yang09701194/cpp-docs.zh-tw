---
title: ATL COM+ 1.0 元件精靈
ms.date: 10/03/2018
f1_keywords:
- vc.codewiz.class.atl.mts.overview
helpviewer_keywords:
- ATL projects, adding components
- ATL COM+ 1.0 Component Wizard
ms.assetid: 11670681-8671-4122-96a4-2e52f8dadce0
ms.openlocfilehash: df13c94eb0cc2aa7e2dea49aba6901f01fce0a15
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62248818"
---
# <a name="atl-com-10-component-wizard"></a>ATL COM+ 1.0 元件精靈

您可以使用此精靈，將物件加入至您的專案，支援 COM + 1.0 服務，包括交易。

您可以指定物件是否支援雙重介面和自動化。 您也可以指定錯誤的資訊介面、 增強的物件控制、 交易和非同步的訊息佇列的支援。

> [!WARNING]
> 在 Visual Studio 2017 15.9 版中，此程式碼精靈已淘汰，並且將從 Visual Studio 的未來版本中移除。 使用者很少用到這個精靈。 移除此精靈不會影響 ATL 和 MFC 的一般支援。 如果您想要分享關於此項淘汰的意見反應，請填寫[此問卷](https://www.surveymonkey.com/r/QDWKKCN)。 我們非常重視您的意見反應。

## <a name="remarks"></a>備註

從 Visual Studio 2008 開始，此精靈所產生的註冊指令碼會註冊其下的 COM 元件**HKEY_CURRENT_USER**而不是**HKEY_LOCAL_MACHINE**。 若要修改此行為，請設定**為所有使用者的註冊元件**ATL 精靈的選項。

## <a name="names"></a>名稱

指定物件、 介面和類別新增至您的專案的名稱。 除了**簡短名稱**，可以獨立於其他編輯所有其他的方塊。 如果您變更的文字**簡短名稱**，變更會反映在這個頁面中的所有其他方塊的名稱。 如果您變更**Coclass**名稱在 [COM] 區段中，變更會反映在**型別**並**ProgID**方塊中，但**介面**名稱不會變更。 此命名的行為可讓您開發您的控制項時輕鬆地識別所有的名稱。

- **簡短名稱**

   設定物件的縮寫的名稱。 名稱可決定`Class`和`Coclass`名稱， **.cpp 檔**和 **.h 檔案**名稱**介面**命名， **型別**名稱，而**ProgID**，除非您個別變更這些欄位。

- **.h 檔案**

   設定新物件類別的標頭檔名稱。 根據預設，這個名稱根據您在中提供的名稱**簡短名稱**。 按一下省略符號按鈕，將檔案名稱儲存至您選擇的位置，或將類別宣告附加至現有的檔案。 如果您選擇現有的檔案，在您按一下精靈中的 [完成] 之前，精靈不會將它儲存至選取的位置。

   精靈不會覆寫檔案。 如果您選取現有檔案的名稱，當您按一下 [完成] 時，精靈會提示您指出是否應該將類別宣告附加至檔案的內容。 按一下 [是] 可附加檔案，按一下 [否] 可返回精靈並指定另一個檔案名稱。

- **類別**

   設定要建立之類別的名稱。 這個名稱根據您在中提供的名稱**簡短名稱**前面 'C'，類別名稱的一般前置詞加上。

- **.cpp 檔**

   設定新物件類別的實作檔名稱。 根據預設，這個名稱根據您在中提供的名稱**簡短名稱**。 按一下省略符號按鈕，將檔案名稱儲存至您選擇的位置。 在您按一下精靈中的 [完成] 之前，檔案不會儲存至選取的位置。

   精靈不會覆寫檔案。 如果您選取現有檔案的名稱，當您按一下 [完成] 時，精靈會提示您指出是否應該將類別實作附加至檔案的內容。 按一下 [是] 可附加檔案，按一下 [否] 可返回精靈並指定另一個檔案名稱。

- **使用屬性**

   指出物件是否使用屬性。 如果您要為屬性化 ATL 專案中新增物件，此選項已選取不可以變更。 也就是說，您可以將屬性化的物件加入建立以屬性支援的專案。

   如果您選取此選項，ATL 專案，並沒有支援的屬性，精靈會提示您指定是否要將屬性支援加入至專案。

   設定此選項之後加入的任何物件會指定為屬性化預設 （核取方塊已選取）。 您可以清除此方塊，將不會使用屬性的物件。

   請參閱[ATL 專案精靈、 應用程式設定](../../atl/reference/application-settings-atl-project-wizard.md)並[屬性的基本機制](../../windows/basic-mechanics-of-attributes.md)如需詳細資訊。

### <a name="com"></a>COM

提供物件的 COM 功能的相關資訊。

- **Coclass**

   設定元件類別，其中包含的物件所支援的介面清單的名稱。

> [!NOTE]
>  如果您建立您的專案使用的屬性，或如果您在此精靈頁面指出 COM + 1.0 元件會使用屬性，您就無法變更此選項，因為不包含 ATL`coclass`屬性。

- **Type**

   設定會在登錄中的物件描述

- **Interface**

   設定您建立物件的介面。 這個介面包含將自訂方法。

- **ProgID**

   設定而不是物件的 CLSID 可用容器的名稱。

## <a name="see-also"></a>另請參閱

[ATL COM + 1.0 元件](../../atl/reference/adding-an-atl-com-plus-1-0-component.md)
