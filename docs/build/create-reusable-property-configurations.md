---
title: 共用或重複使用可視化工作室項目設置 - C++
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], reusable
ms.openlocfilehash: bcf54be0531c7150c1506eb6f5dda2b5bc95161f
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81328696"
---
# <a name="share-or-reuse-visual-studio-project-settings"></a>共用或重複使用 Visual Studio 專案設定

要建立可以與他人共用或重複使用多個專案的自定義設置群組,請使用**屬性管理器**創建*屬性表*(.props 檔案),以儲存您希望能夠重用或與他人共用的每種項目的設置。 使用屬性表比其他創建"全域"設置的方法更容易出錯。

> [!IMPORTANT]
> **.user 檔案，以及這些檔案會有問題的原因**
>
> Visual Studio 的過去版本會使用具有 .user 副檔名且位於 \<使用者設定檔>\AppData\Local\Microsoft\MSBuild\v4.0\ 資料夾的全域屬性工作表中。 我們已不建議使用，因為這些檔案是按照每位使用者、每台電腦基準來設定專案組態的屬性。 這類「全域」設定可能干擾組建，尤其是在您以組建電腦上的多個平台為目標時。 例如，如果您同時有 MFC 專案和 Windows Phone 專案，那麼 .user 屬性對其中一個專案會是無效的。 可重複使用的屬性工作表具有較大彈性且更為穩固。
>
> 雖然 .user 檔案仍舊由 Visual Studio 安裝並且參與屬性繼承，但預設為空白。 最佳做法是在**屬性管理器**中刪除對它們的引用,以確保項目獨立於任何每使用者、每台計算機設置運行 這一點對於確保 SCC(原始程式碼管理)環境中的正確行為非常重要。

要在選單列上顯示**屬性管理員**,請選擇 **「查看** > **屬性管理員**」**或「查看** > 其他**Windows** > **屬性管理員**」,具體取決於您的設定。

如果您有一組常用的屬性,要應用於多個專案,則可以使用**屬性管理器**在可重用*的屬性表*檔中捕獲它們,根據約定,該檔具有 .props 檔名副檔名。 您可以將一個或多個工作表套用至新的專案，這樣就不需要從頭設定其屬性。

![屬性管理員捷徑功能表](media/sharingnew.png "共用新")

在每個組態節點下，您會看到該組態所套用的每個屬性工作表的節點。 系統會新增屬性工作表，這些屬性工作表是在您建立專案時，根據應用程式精靈中選擇的選項設定值。 請以滑鼠右鍵按一下任何節點，然後選擇 [屬性]，以查看套用到該節點的屬性。 所有屬性工作表都會自動匯入專案的「主要」屬性工作表 (ms.cpp.props)，並依 [屬性管理員] 中的出現順序進行評估。 您可以移動它們以變更評估順序。 稍後評估的屬性工作表將會覆寫先前評估之工作表中的值。 有關 .vcxproj 檔中的評估順序、.props 和 .targets 檔案、環境變數和命令列中有關評估順序的詳細資訊,請參閱[Project 屬性繼承](project-property-inheritance.md)。

如果選擇 **「添加新項目屬性表**」,然後選擇 MyProps.props 屬性表,則會顯示屬性頁對話方塊。 請注意，這會套用至 MyProps 屬性工作表。您所做的任何變更都將寫入至工作表，而非專案檔 (.vcxproj)。

如果直接在 .vcxproj 檔案中設定相同屬性，就會覆寫屬性工作表中的屬性。

您可以視需要匯入屬性工作表。 方案中的多個專案可以繼承同一個屬性工作表中的設定，而且專案可以有多個工作表。 屬性工作表本身可以繼承另一個屬性工作表中的設定。

您也可以為多個組態建立一個屬性工作表。 為此,請為每個配置創建一個屬性表,打開其中一個配置的快捷方式功能表,選擇 **「添加現有屬性表**」,然後添加其他工作表。 但是,如果您使用一個公共屬性表,請注意,當您設置屬性時,它會為該表應用於的所有配置設置,並且 IDE 不顯示從給定屬性表繼承的專案或其他屬性表。

在具有許多個專案的大型方案中，建立方案層級的屬性工作表會很有用。 將專案添加到解決方案時,請使用**屬性管理員**將該屬性表添加到專案中。 如果這必須在專案層級進行，您可以加入新的屬性工作表來設定專案特定值。

> [!IMPORTANT]
> 默認情況下,.props 檔不參與原始程式碼管理,因為它不是作為專案項創建的。 如果要在原始檔控制中包含這個檔案，可以手動將其加入做為方案項目。

#### <a name="to-create-a-property-sheet"></a>建立屬性工作表

1. 在選單列上,選擇 **「查看** > **屬性管理員**」或 **「查看** > 其他**Windows** > **屬性管理器**」 。。 **屬性管理員**將打開。

2. 若要定義屬性工作表的範圍，請選取套用的項目。 這可以是特定組態，或其他屬性工作表。 打開此專案的快捷方式功能表,然後選擇 **「添加新項目屬性表**」。 指定名稱和位置。

3. 在**屬性管理員**中,打開新的屬性表,然後設置要包括的屬性。
