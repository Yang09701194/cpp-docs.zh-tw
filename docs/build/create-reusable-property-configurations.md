---
title: 共用或重複使用 Visual Studio 專案設定-C++
ms.date: 07/17/2019
helpviewer_keywords:
- project properties [C++], reusable
ms.openlocfilehash: 49a0153edc5678777c937423ba2bdbd2d92a6a35
ms.sourcegitcommit: 069e3833bd821e7d64f5c98d0ea41fc0c5d22e53
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/21/2019
ms.locfileid: "74303210"
---
# <a name="share-or-reuse-visual-studio-project-settings"></a>共用或重複使用 Visual Studio 專案設定

若要建立可與其他人共用或在多個專案中重複使用的自訂設定群組，請使用**屬性管理員**來建立*屬性工作表*（.props 檔案），以儲存您想要能夠重複使用或與他人共用的每一種專案的設定。 使用屬性工作表比其他建立「全域」設定的方式更不容易發生錯誤。 

> [!IMPORTANT]
> **.user 檔案，以及其問題的原因**
>
> Visual Studio 的過去版本會使用具有 .user 副檔名且位於 \<使用者設定檔>\AppData\Local\Microsoft\MSBuild\v4.0\ 資料夾的全域屬性工作表中。 我們已不建議使用，因為這些檔案是按照每位使用者、每台電腦基準來設定專案組態的屬性。 這類「全域」設定可能干擾組建，尤其是在您以組建電腦上的多個平台為目標時。 例如，如果您同時有 MFC 專案和 Windows Phone 專案，那麼 .user 屬性對其中一個專案會是無效的。 可重複使用的屬性工作表具有較大彈性且更為穩固。
>
> 雖然 .user 檔案仍舊由 Visual Studio 安裝並且參與屬性繼承，但預設為空白。 最佳做法是在 [屬性管理員] 中刪除其參考，以確保您的專案獨立運作，不受每個使用者、每部電腦設定的影響。這點對確保在 SCC (原始程式碼控制) 環境中產生正確行為非常重要。

若要顯示**屬性管理員**，請在功能表列上選擇 [ **view** > **屬性管理員**] 或 [ **view** > **其他 Windows** > **屬性管理員**]，視您的設定而定。

如果您有一組要套用至多個專案的常用共同屬性，您可以使用 [屬性管理員] ，將這些屬性擷取到可重複使用的「屬性工作表」檔案，其依慣例具有 .props 副檔名。 您可以將一個或多個工作表套用至新的專案，這樣就不需要從頭設定其屬性。

![屬性管理員快捷方式功能表](media/sharingnew.png "SharingNew")

在每個組態節點下，您會看到該組態所套用的每個屬性工作表的節點。 系統會新增屬性工作表，這些屬性工作表是在您建立專案時，根據應用程式精靈中選擇的選項設定值。 請以滑鼠右鍵按一下任何節點，然後選擇 [屬性]，以查看套用到該節點的屬性。 所有屬性工作表都會自動匯入專案的「主要」屬性工作表 (ms.cpp.props)，並依 [屬性管理員] 中的出現順序進行評估。 您可以移動它們以變更評估順序。 稍後評估的屬性工作表將會覆寫先前評估之工作表中的值。 如需 .vcxproj 檔案、.props 和 .targets 檔案、環境變數及命令列中評估順序的詳細資訊，請參閱[專案屬性繼承](project-property-inheritance.md)。

如果您選擇 [新增專案屬性工作表]，然後選擇 (例如) MyProps.props 屬性工作表，就會出現屬性頁對話方塊。 請注意，這會套用至 MyProps 屬性工作表。您所做的任何變更都將寫入至工作表，而非專案檔 (.vcxproj)。

如果直接在 .vcxproj 檔案中設定相同屬性，就會覆寫屬性工作表中的屬性。

您可以視需要匯入屬性工作表。 方案中的多個專案可以繼承同一個屬性工作表中的設定，而且專案可以有多個工作表。 屬性工作表本身可以繼承另一個屬性工作表中的設定。

您也可以為多個組態建立一個屬性工作表。 若要這麼做，請建立每個組態的屬性工作表，開啟其中一個工作表的捷徑功能表，選擇 [新增現有屬性工作表]，然後新增其他工作表。 不過，如果您使用一個通用的屬性工作表，請注意，當您設定屬性時，它會針對工作表適用的所有設定進行設定，而且 IDE 不會顯示哪些專案或其他屬性工作表繼承自指定的屬性工作表。

在具有許多個專案的大型方案中，建立方案層級的屬性工作表會很有用。 當您將專案新增至方案時，請使用 [屬性管理員] 將該屬性工作表新增至專案。 如果這必須在專案層級進行，您可以加入新的屬性工作表來設定專案特定值。

> [!IMPORTANT]
> 根據預設，.props 檔案不會參與原始檔控制，因為它不會建立為專案專案。 如果要在原始檔控制中包含這個檔案，可以手動將其加入做為方案項目。

#### <a name="to-create-a-property-sheet"></a>建立屬性工作表

1. 在功能表列上，選擇 [ **view** > ]**屬性管理員**或**view** > **其他 Windows** > **屬性管理員**。 [屬性管理員] 隨即開啟。

2. 若要定義屬性工作表的範圍，請選取套用的項目。 這可以是特定組態，或其他屬性工作表。 開啟這個項目的捷徑功能表，然後選擇 [新增專案屬性工作表]。 指定名稱和位置。

3. 在 [屬性管理員] 中，開啟新的屬性工作表，然後設定您要包含的屬性。
