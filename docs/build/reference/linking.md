---
title: MSVC 連結器參考
ms.date: 12/10/2018
ms.assetid: bb736587-d13b-4f3c-8982-3cc2c015c59c
ms.openlocfilehash: d46874b5eaff889834df284ba90e6c6f196d8d66
ms.sourcegitcommit: 8e285a766523e653aeeb34d412dc6f615ef7b17b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/21/2020
ms.locfileid: "80079505"
---
# <a name="linking"></a>連結

在C++專案中，當編譯器將原始程式碼編譯成目的檔（* .obj）之後，就會執行*連結*步驟。 連結器（link .exe）會將物件檔案結合成單一可執行檔。

連結器選項可以在 Visual Studio 內部或外部設定。 在 Visual Studio 中，您可以用滑鼠右鍵按一下**方案總管**中的專案節點，然後選擇 [**屬性**] 來顯示內容頁，以存取連結器選項。 選擇左窗格中的 [**連結器**] 來展開節點，並查看所有選項。

## <a name="linker-command-line-syntax"></a>連結器命令列語法

當您執行 Visual Studio 外部的連結時，您可以透過一或多個方式指定輸入：

- 在命令列上

- 使用命令檔

- 在環境變數中

連結連結環境變數中指定的第一個進程選項，後面接著在命令列和命令檔中指定順序的選項。 如果使用不同的引數重複選項，則最後一個處理的會優先。

選項適用于整個組建;沒有任何選項可以套用至特定的輸入檔。

執行連結。EXE，請使用下列命令語法：

```
LINK arguments
```

`arguments` 包含選項和檔案名，而且可以依任何順序指定。 系統會先處理選項，然後再進行檔案。 使用一或多個空格或索引標籤來分隔引數。

> [!NOTE]
>  您只能從 Visual Studio 命令提示字元啟動此工具。 您無法從系統命令提示字元，或從 [檔案總管] 啟動它。

## <a name="command-line"></a>命令列

在命令列上，選項包含選項規範、虛線（-）或斜線（/），後面接著選項的名稱。 選項名稱不可以是縮寫。 有些選項會接受引數，並在冒號（:) 之後指定。 除了在/COMMENT 選項中加上引號的字串以外，選項規格中不允許空格或索引標籤。 指定十進位或 C 語言標記法中的數值引數。 選項名稱及其關鍵字或檔案名引數不區分大小寫，但做為引數的識別碼會區分大小寫。

若要將檔案傳遞至連結器，請在連結命令之後的命令列上指定檔案名。 您可以指定檔案名的絕對或相對路徑，而且可以在檔案名中使用萬用字元。 如果您省略點（.）和副檔名，則 LINK 會假設為尋找檔案的目的。 連結不會使用副檔名，或缺少它們來對檔案內容進行假設;它會藉由檢查來判斷檔的類型，並據以進行處理。

連結 .exe 會針對成功傳回零（沒有錯誤）。  否則，連結器會傳回停止連結的錯誤號碼。  例如，如果連結器產生 LNK1104，則連結器會傳回1104。  因此，連結器在錯誤上傳回的最低錯誤號碼是1000。  傳回值128表示作業系統或 .config 檔案的設定問題。載入器未載入連結 .exe 或 c2 .dll。

## <a name="link-command-files"></a>LINK 命令檔

您可以傳遞命令列引數，以命令檔的形式連結。 若要指定連結器的命令檔，請使用下列語法：

> **連結 \@** <em>commandfile</em>

*Commandfile*是文字檔的名稱。 @ 符號（ **\@** ）和檔案名之間不允許有空格或索引標籤。 沒有預設的延伸模組;您必須指定完整的檔案名，包括任何延伸模組。 無法使用萬用字元。 您可以指定具有檔案名的絕對或相對路徑。 連結不會使用環境變數來搜尋檔案。

在命令檔中，引數可以用空格或索引標籤（如同在命令列上）和分行符號分隔。

您可以在命令檔中指定全部或部分的命令列。 您可以在連結命令中使用一個以上的命令檔。 連結會接受命令檔輸入，如同在命令列上指定的位置一樣。 命令檔無法加以嵌套。 連結會回顯命令檔的內容，除非指定[/nologo](nologo-suppress-startup-banner-linker.md)選項。

## <a name="example"></a>範例

下列用來建立 DLL 的命令會在個別的命令檔中傳遞物件檔案和程式庫的名稱，並使用第三個命令檔來指定/EXPORTS 選項：

```cmd
link /dll @objlist.txt @liblist.txt @exports.txt
```

## <a name="link-environment-variables"></a>LINK 環境變數

LINK 工具使用下列環境變數：

- 連結和 \_連結\_（如果已定義）。 連結工具會前面加上連結環境變數中定義的選項和引數，並將 \_連結\_ 環境變數中定義的選項和引數附加至命令列引數，然後再進行處理。

- LIB (若已定義)。 連結工具會在搜尋命令列上或以[/base](base-base-address.md)選項所指定的物件、程式庫或其他檔案時，使用 LIB 路徑。 它也會使用 LIB 路徑來尋找物件中指定的 .pdb 檔案。 LIB 變數可以包含一或多個以分號分隔的路徑規格。 一個路徑必須指向 Visual C++ 安裝的 \lib 子目錄。

- PATH，如果該工具必須執行 CVTRES，但在 LINK 本身的相同目錄中找不到檔案。 （連結需要 CVTRES 才能連結 .res 檔案）。PATH 必須指向視覺效果C++安裝的 \bin 子目錄。

- TMP，在連結 OMF 或 .res 檔案時指定目錄。

## <a name="see-also"></a>另請參閱

[C/C++建築物參考](c-cpp-building-reference.md)
[MSVC 連結器選項](linker-options.md)
[模組定義（.Def）](module-definition-dot-def-files.md)檔案
[連結器支援延遲載入的 dll](linker-support-for-delay-loaded-dlls.md)
