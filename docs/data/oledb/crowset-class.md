---
title: CRowset 類別
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: dc4f619fb0dba924693682c927247e809fe2cfe9
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/05/2019
ms.locfileid: "59032319"
---
# <a name="crowset-class"></a>CRowset 類別

封裝的 OLE DB 資料列集物件，以及數個相關的介面，並提供資料列集資料的操作方法。

## <a name="syntax"></a>語法

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>參數

*TAccessor*<br/>
存取子類別。 預設為 `CAccessorBase`。

## <a name="requirements"></a>需求

**標題:** atldbcli.h

## <a name="members"></a>成員

### <a name="methods"></a>方法

|||
|-|-|
|[AddRefRows](#addrefrows)|遞增參考計數相關聯的目前資料列。|
|[關閉](#close)|釋放資料列和目前`IRowset`介面。|
|[比較](#compare)|比較兩個設定為書籤使用[IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))。|
|[CRowset](#crowset)|建立新`CRowset`物件，並 （選擇性） 將它與`IRowset`當做參數提供的介面。|
|[刪除](#delete)|刪除的資料列集使用資料列[IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v=vs.85))。|
|[FindNextRow](#findnextrow)|尋找在指定的書籤之後的下一個相符的資料列。|
|[GetApproximatePosition](#getapproximateposition)|傳回對應至書籤的資料列約略位置。|
|[GetData](#getdata)|資料擷取的資料列的資料列集的副本。|
|[GetDataHere](#getdatahere)|從指定的緩衝區中擷取資料。|
|[GetOriginalData](#getoriginaldata)|擷取的資料最近從擷取或傳送到資料來源，略過暫止的變更。|
|[GetRowStatus](#getrowstatus)|傳回所有資料列的狀態。|
|[Insert](#insert)|建立並將插入新的資料列使用[IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921(v=vs.85))。|
|[IsSameRow](#issamerow)|比較指定的資料列與目前資料列。|
|[MoveFirst](#movefirst)|會的下一個提取位置重新定位至初始位置。|
|[MoveLast](#movelast)|移至最後一個記錄。|
|[MoveNext](#movenext)|提取資料，從下一個循序資料列或指定的下一個資料列之後的位置數目。|
|[MovePrev](#moveprev)|移至前一筆記錄。|
|[MoveToBookmark](#movetobookmark)|擷取書籤所標記的資料列或資料列中指定的位移，從該書籤。|
|[MoveToRatio](#movetoratio)|擷取資料列從資料列集中的小數位置開始。|
|[ReleaseRows](#releaserows)|呼叫[irowset:: Releaserows](/previous-versions/windows/desktop/ms719771(v=vs.85))釋放目前的資料列控制代碼。|
|[SetData](#setdata)|中的資料列，使用的一或多個資料行設定資料值[IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232(v=vs.85))。|
|[復原](#undo)|復原自上次擷取資料列所做的變更或[更新](../../data/oledb/crowset-update.md)。|
|[更新](#update)|將任何暫止的變更目前的資料列自上次擷取或更新的傳輸。|
|[UpdateAll](#updateall)|將任何暫止的變更的所有資料列自上次擷取或更新的傳輸。|

## <a name="remarks"></a>備註

OLE DB 中的資料列集是透過此程式設定和擷取資料的物件。

這個類別不是具現化但而不是傳遞做為範本參數`CTable`或是`CCommand`(`CRowset`是預設值)。

## <a name="addrefrows"></a> CRowset::AddRefRows

呼叫[irowset:: Addrefrows](/previous-versions/windows/desktop/ms719619(v=vs.85))每次增加 （1) 的參考計數相關聯的目前資料列控制代碼。

### <a name="syntax"></a>語法

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

這個方法會遞增目前的資料列控制代碼的參考計數。 呼叫[ReleaseRows](../../data/oledb/crowset-releaserows.md)遞減計數。 移動方法所傳回的資料列都有一個參考計數。

## <a name="close"></a> CRowset::Close

釋放資料列和目前[IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85))介面。

### <a name="syntax"></a>語法

```cpp
void Close() throw();
```

### <a name="remarks"></a>備註

這個方法會釋出目前在資料列集中的所有資料列。

## <a name="compare"></a> CRowset::Compare

比較兩個設定為書籤使用[IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539(v=vs.85))。

### <a name="syntax"></a>語法

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1,
   const CBookmarkBase& bookmark2,
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>參數

*Bookmark1*<br/>
[in]要比較的第一個書籤。

*Bookmark2*<br/>
[in]要比較的第二個書籤。

*pComparison*<br/>
[out]比較的結果的指標。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetLocate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetLocate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

在取用者中使用書籤的相關資訊，請參閱[使用書籤](../../data/oledb/using-bookmarks.md)。

## <a name="crowset"></a> CRowset::CRowset

建立新`CRowset`物件，並 （選擇性） 將它與相關聯[IRowset](/previous-versions/windows/desktop/ms720986(v=vs.85))當做參數提供的介面。

### <a name="syntax"></a>語法

```cpp
CRowset();

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>參數

*pRowset*<br/>
[in] 要與這個類別相關聯的 `IRowset` 介面指標。

## <a name="delete"></a> CRowset::Delete

呼叫[irowsetchange:: Deleterows](/previous-versions/windows/desktop/ms724362(v=vs.85))從資料列集刪除目前的資料列。

### <a name="syntax"></a>語法

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

## <a name="findnextrow"></a> CRowset::FindNextRow

尋找在指定的書籤之後的下一個相符的資料列。

### <a name="syntax"></a>語法

```cpp
HRESULT FindNextRow(DBCOMPAREOP op,
   BYTE* pData,
   DBTYPE wType,
   DBLENGTH nLength,
   BYTE bPrecision,
   BYTE bScale,
   BOOL bSkipCurrent = TRUE,
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>參數

*op*<br/>
[in]要用於比較資料列值的作業。 值，請參閱[irowsetfind:: Findnextrow](/previous-versions/windows/desktop/ms723091(v=vs.85))。

*pData*<br/>
[in]要比對值的指標。

*wType*<br/>
[in]指出緩衝區的值部分的資料類型。 類型指標的相關資訊，請參閱[資料型別](/previous-versions/windows/desktop/ms723969(v=vs.85))中*OLE DB 程式設計人員參考*Windows SDK 中。

*nLength*<br/>
[in]取用者的資料結構配置資料值的長度，以位元組為單位。 如需詳細資訊，請參閱說明`cbMaxLen`中[DBBINDING 結構](/previous-versions/windows/desktop/ms716845(v=vs.85))在*OLE DB 程式設計人員參考。*

*bPrecision*<br/>
[in]使用 取得資料時最大有效位數。 使用的才*wType*是 DBTYPE_NUMERIC。 如需詳細資訊，請參閱 <<c0> [ 涉及 DBTYPE_NUMERIC 或 DBTYPE_DECIMAL 轉換](/previous-versions/windows/desktop/ms719714(v=vs.85))中*OLE DB 程式設計人員參考*。

*bScale*<br/>
[in]取得資料時，使用小數位數。 使用的才*wType* DBTYPE_NUMERIC 或 DBTYPE_DECIMAL。 如需詳細資訊，請參閱 <<c0> [ 涉及 DBTYPE_NUMERIC 或 DBTYPE_DECIMAL 轉換](/previous-versions/windows/desktop/ms719714(v=vs.85))中*OLE DB 程式設計人員參考*。

*bSkipCurrent*<br/>
[in]從 開始搜尋的書籤的資料列數目。

*pBookmark*<br/>
[in]要開始搜尋位置的書籤。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetFind`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetFind`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

在取用者中使用書籤的相關資訊，請參閱[使用書籤](../../data/oledb/using-bookmarks.md)。

## <a name="getapproximateposition"></a> CRowset::GetApproximatePosition

傳回對應至書籤的資料列約略位置。

### <a name="syntax"></a>語法

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark,
   DBCOUNTITEM* pPosition,
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>參數

*pBookmark*<br/>
[in]書籤，識別其位置是要找的資料列指標。 如果只是必要的資料列計數為 NULL。

*pPosition*<br/>
[out]位置指標，其中`GetApproximatePosition`傳回資料列的位置。 如果位置不需要，則為 NULL。

*pcRows*<br/>
[out]位置指標，其中`GetApproximatePosition`傳回的資料列總數。 如果不需要的資料列計數，則為 NULL。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetScroll`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetScroll`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

在取用者中使用書籤的相關資訊，請參閱[使用書籤](../../data/oledb/using-bookmarks.md)。

## <a name="getdata"></a> CRowset::GetData

資料擷取的資料列的資料列集的副本。

### <a name="syntax"></a>語法

```cpp
HRESULT GetData() throw();

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>參數

*nAccessor*<br/>
[in]用來存取資料的存取子 （零位移） 索引編號。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

如果您指定的存取子，不是在 autoaccessor [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md)，使用這個方法來明確地傳遞存取子數目以取得資料。

## <a name="getdatahere"></a> CRowset::GetDataHere

從目前的資料列擷取資料，並將它放入指定的緩衝區。

### <a name="syntax"></a>語法

```cpp
HRESULT GetDataHere(int nAccessor,
   void* pBuffer) throw();
```

#### <a name="parameters"></a>參數

*nAccessor*<br/>
[in]用來存取資料的存取子的索引編號。

*pBuffer*<br/>
[out]要放置目前記錄的資料緩衝區。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

如需如何使用此函式的範例，請參閱 < [MultiRead 的範例](../../overview/visual-cpp-samples.md)。

## <a name="getoriginaldata"></a> CRowset::GetOriginalData

呼叫`IRowsetUpdate::GetOriginalData`擷取最近從擷取或傳送到資料來源的資料。

### <a name="syntax"></a>語法

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

這個方法會擷取資料，從最近擷取或傳送到資料來源;它不會擷取暫止的變更為基礎的值。

此方法需要的選擇性介面`IRowsetUpdate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetUpdate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="getrowstatus"></a> CRowset::GetRowStatus

傳回所有資料列的狀態。

### <a name="syntax"></a>語法

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>參數

*pStatus*<br/>
[out]位置指標，其中`GetRowStatus`傳回狀態值。 請參閱 DBPENDINGSTATUS OLE DB 程式設計人員參考中。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetUpdate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetUpdate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="insert"></a> CRowset::Insert

建立並初始化新的資料列，使用從存取子的資料。

### <a name="syntax"></a>語法

```cpp
HRESULT Insert(int nAccessor = 0,
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>參數

*nAccessor*<br/>
[in]要用於插入資料的存取子數目。

*bGetHRow*<br/>
[in]指出是否要擷取的已插入的資料列的控制代碼。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetChange`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetChange`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

如果一或多個資料行不是可寫入，插入可能會失敗。 請修改您的資料指標對應以修正這個問題。

### <a name="example"></a>範例

下列範例示範如何透過資料列集來存取資料來源，然後將 使用資料表中該資料列集的字串。

首先，您的專案中插入新的 ATL 物件的建立資料表類別。 例如，以滑鼠右鍵按一下 [工作區] 窗格中的專案，然後選取**新 ATL 物件**。 從**資料存取**類別目錄中，選取**消費者**。 建立取用者物件的型別**資料表**。 (選取**表格**直接從資料表中建立一個資料列集，選取**命令**會建立一個資料列集，透過 SQL 命令。)選取資料來源，指定可存取該資料來源資料表。 如果您呼叫您的取用者物件**CCustomerTable**，您然後實作您的插入程式碼，如下所示：

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset::IsSameRow

比較指定的資料列與目前資料列。

### <a name="syntax"></a>語法

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>參數

*hRow*<br/>
[in]要比較目前資料列的資料列控制代碼。

### <a name="return-value"></a>傳回值

標準的 HRESULT。 S_OK 表示資料列的相同。 其他值，請參閱[IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629(v=vs.85))中*OLE DB 程式設計人員參考*Windows SDK 中。

## <a name="movefirst"></a> CRowset::MoveFirst

將游標移至初始位置，並擷取初始的資料列。

### <a name="syntax"></a>語法

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

呼叫[irowset:: Restartposition](/previous-versions/windows/desktop/ms712877(v=vs.85))重新定位到的初始位置 （資料列集建立時所下一個提取位置的位置） 的下一個提取位置，並擷取初始的資料列。

## <a name="movelast"></a> CRowset::MoveLast

將游標移到最後一個資料列。

### <a name="syntax"></a>語法

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

呼叫[irowset:: Restartposition](/previous-versions/windows/desktop/ms712877(v=vs.85))重新定位的下一個提取位置的最後一個位置，並擷取最後一個資料列。

這個方法會要求您設定`DBPROP_CANSCROLLBACKWARDS`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。 (為了達到最佳效能，您也可以設定`DBPROP_QUICKRESTART`為 VARIANT_TRUE。)

## <a name="movenext"></a> CRowset::MoveNext

將游標移至下一筆記錄。

### <a name="syntax"></a>語法

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip,
   bool bForward= true) throw();
```

#### <a name="parameters"></a>參數

*lSkip*<br/>
[in]略過擷取的資料列數目。

*bForward*<br/>
[in]傳遞**真**向前移動至下一筆記錄， **false**向後移動。

### <a name="return-value"></a>傳回值

標準的 HRESULT。 當已到達資料列集結尾時，會傳回 DB_S_ENDOFROWSET。

### <a name="remarks"></a>備註

擷取下一個循序資料列，從`CRowset`物件，記住先前的位置。 （選擇性） 您可以選擇跳*lSkip*列] 或 [向後移動。

這個方法會要求您設定下列屬性，才能呼叫`Open`的資料表上包含資料列集的命令：

- `DBPROP_CANSCROLLBACKWARDS` 如果必須是 VARIANT_TRUE *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` 如果必須是 VARIANT_TRUE *bForward* = false

否則 (如果*lSkip* > = 0 並*bForward* = true)，您不需要設定任何其他的屬性。

## <a name="moveprev"></a> CRowset::MovePrev

將游標移到上一筆記錄。

### <a name="syntax"></a>語法

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

這個方法會要求您設定其中一個`DBPROP_CANFETCHBACKWARDS`或是`DBPROP_CANSCROLLBACKWARDS`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="movetobookmark"></a> CRowset::MoveToBookmark

擷取標示書籤或指定之位移的資料列的資料列 (*lSkip*) 從該書籤。

### <a name="syntax"></a>語法

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark,
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>參數

*Bookmark - 書籤*<br/>
[in] 標記您要從中擷取資料之位置的書籤。

*lSkip*<br/>
[in] 從書籤到目標資料列的資料列計數。 如果*lSkip*為零，將擷取的第一個資料列是已標記書籤的資料列。 如果*lSkip*為 1，將擷取的第一個資料列是資料列已標記書籤的資料列之後。 如果*lSkip*為-1，將擷取的第一個資料列是已標記書籤的資料列之前的資料列。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetLocate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetLocate`為 VARIANT_TRUE，並將`DBPROP_CANFETCHBACKWARDS`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

在取用者中使用書籤的相關資訊，請參閱[使用書籤](../../data/oledb/using-bookmarks.md)。

## <a name="movetoratio"></a> CRowset::MoveToRatio

擷取資料列從資料列集中的小數位置開始。

### <a name="syntax"></a>語法

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator,
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>參數

*nNumerator*<br/>
[in]用來判斷小數分子位置要從中擷取資料。

*nDenominator*<br/>
[in]用來判斷小數分母位置要從中擷取資料。

*bForward*<br/>
[in]指出是否要向前或向後移動。 預設為轉寄。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

`MoveToRatio` 擷取資料列大約根據下列公式：

`(nNumerator *  RowsetSize ) / nDenominator`

其中`RowsetSize`是以資料列的資料列集的大小。 此公式的精確度取決於特定的提供者。 如需詳細資訊，請參閱 < [irowsetscroll::](/previous-versions/windows/desktop/ms709602(v=vs.85))。

此方法需要的選擇性介面`IRowsetScroll`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetScroll`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="releaserows"></a> CRowset::ReleaseRows

呼叫[irowset:: Releaserows](/previous-versions/windows/desktop/ms719771(v=vs.85))釋放目前的資料列控制代碼。

### <a name="syntax"></a>語法

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>傳回值

標準的 HRESULT。

## <a name="setdata"></a> CRowset::SetData

設定資料值的資料列的一個或多個資料行中。

### <a name="syntax"></a>語法

```cpp
HRESULT SetData() const throw();

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>參數

*nAccessor*<br/>
[in]用來存取資料的存取子數目。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

針對`SetData`接受任何引數，所有存取子的格式用來更新。 一般都會呼叫`SetData`若要設定資料列中的資料行中的資料值，然後呼叫[更新](../../data/oledb/crowset-update.md)傳輸這些變更。

此方法需要的選擇性介面`IRowsetChange`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetChange`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

如果一或多個資料行不是可寫入，設定作業可能會失敗。 請修改您的資料指標對應以修正這個問題。

## <a name="undo"></a> CRowset::Undo

復原自上次擷取資料列所做的變更或[更新](../../data/oledb/crowset-update.md)。

### <a name="syntax"></a>語法

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>參數

*pcRows*<br/>
[out]位置指標，其中`Undo`傳回它嘗試復原所需的資料列數目。

*phRow*<br/>
[out]位置指標，其中`Undo`嘗試復原所需的所有資料列中傳回的控制代碼陣列。

*pStatus*<br/>
[out]位置指標，其中`Undo`傳回資料列的值。 如果，則會傳回任何狀態*pStatus*為 null。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

此方法需要的選擇性介面`IRowsetUpdate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetUpdate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="update"></a> CRowset::Update

傳輸任何暫止的變更目前的資料列自上次擷取或`Update`上呼叫。

### <a name="syntax"></a>語法

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL,
   HROW* phRow = NULL,
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>參數

*pcRows*<br/>
[out]位置指標，其中`Update`傳回它嘗試更新，如有必要的資料列數目。

*phRow*<br/>
[out]位置指標，其中`Update`傳回它嘗試更新的資料列控制代碼。 如果，則會傳回任何控制代碼*phRow*為 null。

*pStatus*<br/>
[out]位置指標，其中`Update`傳回資料列的值。 如果，則會傳回任何狀態*pStatus*為 null。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

### <a name="remarks"></a>備註

傳輸任何暫止的變更對目前的資料列，因為該資料列上次擷取或更新 (使用`Update`或是[UpdateAll](../../data/oledb/crowset-updateall.md))。 一般都會呼叫[SetData](../../data/oledb/crowset-setdata.md)中的資料列中的資料行設定資料值，然後呼叫`Update`傳輸這些變更。

此方法需要的選擇性介面`IRowsetUpdate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetUpdate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

## <a name="updateall"></a> CRowset::UpdateAll

傳輸任何暫止的變更的所有資料列自上次擷取或`Update`上呼叫。

### <a name="syntax"></a>語法

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL,
   HROW** pphRow = NULL,
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>參數

*pcRows*<br/>
[out]位置指標，其中`UpdateAll`傳回它嘗試更新，如有必要的資料列數目。

*pphRow*<br/>
[out]要在其中記憶體的指標`UpdateAll`傳回它嘗試更新的資料列控制代碼。 如果，則會傳回任何控制代碼*pphRow*為 null。

*ppStatus*<br/>
[out]位置指標，其中`Update`傳回資料列的值。 如果，則會傳回任何狀態*ppStatus*為 null。

### <a name="remarks"></a>備註

任何暫止對所有資料列，因為這些資料列上次提取，或使用更新的變更會傳輸[更新](../../data/oledb/crowset-update.md)或`UpdateAll`。 `UpdateAll` 將會更新已修改，無論是否仍有控制代碼為它們每個資料列 (請參閱*pphRow*) 與否。

例如，如果您使用`Insert`若要插入資料列集的五個資料列，您可以呼叫`Update`五次或呼叫`UpdateAll`更新全部一次。

此方法需要的選擇性介面`IRowsetUpdate`這可能不支援所有的提供者; 如果這個情況下，此方法會傳回 E_NOINTERFACE。 您也必須設定`DBPROP_IRowsetUpdate`為 VARIANT_TRUE，然後再呼叫`Open`的資料表上包含資料列集的命令。

### <a name="return-value"></a>傳回值

標準的 HRESULT。

## <a name="see-also"></a>另請參閱

[DBViewer 範例](../../overview/visual-cpp-samples.md)<br/>
[MultiRead 的範例](../../overview/visual-cpp-samples.md)<br/>
[MultiRead 的屬性範例](../../overview/visual-cpp-samples.md)<br/>
[OLE DB 消費者樣板](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[OLE DB 消費者樣板參考](../../data/oledb/ole-db-consumer-templates-reference.md)