---
title: 新增方法精靈 | Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-ide
ms.topic: conceptual
f1_keywords:
- vc.codewiz.method.overview
dev_langs:
- C++
helpviewer_keywords:
- Add Method Wizard [C++]
- methods [C++], adding using wizards
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 45c3b0ca9a3e6c88e4ae40a5eb52aeb3223d2860
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/19/2018
ms.locfileid: "46397296"
---
# <a name="add-method-wizard"></a>加入方法精靈

使用此精靈將方法新增至介面。 根據您要新增方法的專案類型或介面類型而定，精靈會顯示不同的選項。

## <a name="names"></a>名稱

- **傳回類型**

   方法傳回的資料類型。 建議針對所有介面類型使用 `HRESULT`，因為它提供傳回錯誤的標準方式。

   |介面類型|描述|
   |--------------------|-----------------|
   |雙重介面|`HRESULT`. 無法變更。|
   |自訂介面|`HRESULT`. 無法變更。|
   |本機自訂介面|提供您自己的傳回型別，或從清單中選取。|
   |分配介面 (Dispinterface)|提供您自己的傳回型別，或從清單中選取。|
   |MFC ActiveX 控制項分配介面|如果您實作內建方法，傳回型別則會設定為適當的值，而且無法變更。 如果您從 [方法名稱] 清單中選取方法，並按一下 [選取方法類型] 下的 [自訂]，請從清單中選取傳回型別。|

- **方法名稱**

   設定方法的名稱。

   |介面類型|描述|
   |--------------------|-----------------|
   |ATL 雙重介面、自訂介面和本機自訂介面|提供您自己的方法名稱。|
   |MFC 分配介面|提供您自己的方法名稱，或從清單中選取建議的方法名稱。 如果您從清單中選取名稱，適當的值會出現在 [傳回型別] 方塊中，而且該值無法變更。|
   |MFC ActiveX 控制項分配介面|提供您自己的內建方法，或選取其中一個內建方法 ([DoClick](../mfc/reference/colecontrol-class.md#doclick) 和 [Refresh](../mfc/reference/colecontrol-class.md#refresh))。 如需詳細資訊，請參閱 [MFC ActiveX 控制項：新增內建方法](../mfc/mfc-activex-controls-adding-stock-methods.md)。|

- **方法類型**

   僅適用於 MFC ActiveX 控制項。 如果您在 [方法名稱] 方塊中提供方法名稱，而不是從清單中選取一種方法，就無法使用此方塊。

   如果您在 [方法名稱] 清單中選取其中一個方法，請選取內建實作或自訂實作。

   |方法類型|描述|
   |-----------------|-----------------|
   |**內建**|預設值。 插入您在 [方法名稱] 清單中所選取之方法的內建實作。 如果您選取 [內建] 則無法變更 [傳回型別]。|
   |**自訂**|插入您在 [方法名稱] 清單中所選取之方法的虛設常式實作。 若為自訂方法類型，您可以提供您自己的傳回型別，也可以從 [傳回型別] 清單中選取傳回型別。|

- **內部名稱**

   僅適用於新增至 MFC 分配介面的自訂方法。 請設定用於分派對應、 標頭檔 (.h) 和實作檔 (.cpp) 的名稱。 根據預設，此名稱與 [方法名稱] 相同。 如果您要使用 MFC 分配介面，或者要將自訂方法新增至 MFC ActiveX 控制項分配介面中，則可以變更方法名稱。

   |介面類型|描述|
   |--------------------|-----------------|
   |ATL 雙重介面、自訂介面和本機自訂介面|無法使用|
   |MFC 分配介面|預設設定為方法名稱。 您可以編輯內部名稱。|
   |MFC ActiveX 控制項分配介面|您只能為自訂方法設定內部名稱。 內建方法不會使用內部名稱。|

- **參數屬性**

   為 [參數名稱] 中指定的參數設定任何其他屬性。

   |參數屬性|描述|允許的組合|
   |-------------------------|-----------------|--------------------------|
   |**In**|表示參數會從呼叫程序傳遞至被呼叫程序。|只有 **in**<br /><br /> **in** 和 **out**|
   |**Out**|表示指標參數會從被呼叫程序傳回至呼叫程序 (從伺服器至用戶端)。|只有 **out**<br /><br /> **in** 和 **out**<br /><br /> **out** 和 **retval**|
   |**Retval**|表示接收成員傳回值的參數。|**retval** 和 out|

- **參數類型**

   設定參數的資料類型。 請從清單中選取類型。

- **參數名稱**

   設定要透過方法傳遞的參數名稱。 鍵入名稱之後，您必須按一下 [新增]，將它新增至將透過方法傳遞的參數清單。 如果您未提供參數名稱，則精靈會忽略任何參數屬性 (僅限 ATL) 或 [參數類型] 選取項目。

   按一下 [新增] 之後，參數名稱會出現在 [參數清單] 中。

   > [!Note]
   > 如果您提供參數名稱，然後依序按一下 [完成] 和 [新增]，則參數不會新增至方法。 您必須尋找方法，並手動插入參數。

- **[新增]**

   將您在 [參數名稱] 中指定的參數以及其類型和參數屬性，新增至 [參數清單]。 您必須按一下 [新增]，才能將參數新增至清單。

- **移除**

   將您在 [參數清單] 中選取的參數從清單移除。

- **參數清單**

   顯示目前針對方法新增的所有參數及其修飾詞和類型。 新增參數時，精靈會更新 [參數清單] 以顯示每個參數及其修飾詞和類型。

## <a name="see-also"></a>請參閱

[新增方法](../ide/adding-a-method-visual-cpp.md)<br/>
[新增方法精靈、IDL 屬性](../ide/idl-attributes-add-method-wizard.md)