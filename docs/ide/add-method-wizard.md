---
title: "加入方法精靈 |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-ide
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- vc.codewiz.method.overview
dev_langs:
- C++
helpviewer_keywords:
- Add Method Wizard [C++]
- methods [C++], adding using wizards
ms.assetid: b9a71b0e-9ecf-40fa-9f86-4200cb23d671
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 63595fe7fda434b7ee16161bd3afdaf8a46fad82
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/21/2017
---
# <a name="add-method-wizard"></a>加入方法精靈
使用此精靈將方法加入至介面。 根據專案類型或介面類型，您會加入方法中，精靈會顯示不同的選項。  
  
## <a name="names"></a>名稱  
 **傳回類型**  
 方法所傳回的資料型別。 `HRESULT`建議用於所有介面類型，因為它會提供標準的方式，來傳回錯誤。  
  
|介面類型|描述|  
|--------------------|-----------------|  
|雙重介面|`HRESULT`. 無法變更。|  
|自訂介面|`HRESULT`. 無法變更。|  
|本機的自訂介面|提供您自己的傳回型別，或從清單中選取。|  
|Dispinterface|提供您自己的傳回型別，或從清單中選取。|  
|MFC ActiveX 控制項的分配介面|如果您實作內建方法，傳回型別設定為適當的值，並且無法變更。 如果您選取的方法，從**方法名稱**清單，然後按一下**自訂**下**選取方法類型**，從清單中選取的傳回型別。|  
  
 **方法名稱**  
 設定方法的名稱。  
  
|介面類型|描述|  
|--------------------|-----------------|  
|ATL 雙重介面、 自訂介面和本機的自訂介面|提供您自己的方法名稱。|  
|MFC 分配介面|提供您自己的方法名稱，或從清單中選取建議的方法名稱。 如果您從清單選取名稱時，適當的值會出現在**傳回型別** 方塊中，而且這是不能變更。|  
|MFC ActiveX 控制項的分配介面|提供您自己或選取其中一個內建方法[DoClick](../mfc/reference/colecontrol-class.md#doclick)和[重新整理](../mfc/reference/colecontrol-class.md#refresh)。 請參閱[MFC ActiveX 控制項： 加入內建方法](../mfc/mfc-activex-controls-adding-stock-methods.md)如需詳細資訊。|  
  
 **方法的型別**  
 僅適用於 MFC ActiveX 控制項。 如果您提供的方法名稱中**方法名稱**方塊中，而不是從清單中選取一種方法，就無法使用此方塊。  
  
 如果您選取其中一個方法中**方法名稱**清單中，選取 內建實作或自訂的實作。  
  
|方法的型別|描述|  
|-----------------|-----------------|  
|**內建**|預設值。 插入您在所選取的內建實作**方法名稱**清單。 **傳回型別**，則無法變更，如果您選取**股票**。|  
|**自訂**|插入在選取的方法虛設常式實作**方法名稱**清單。 自訂方法的型別，您可以提供您自己的傳回型別，或您可以選取從**傳回型別**清單。|  
  
 **內部名稱**  
 適用於只加入至 MFC 分配介面的自訂方法。 設定用於分派對應、 標頭 (.h) 檔案，以及實作 (.cpp) 檔案的名稱。 根據預設，此名稱會是相同**方法名稱**。 如果您正在使用 MFC 分配介面，或如果您要將自訂的方法加入 MFC ActiveX 控制項的分配程式介面，您可以變更方法名稱。  
  
|介面類型|描述|  
|--------------------|-----------------|  
|ATL 雙重介面、 自訂介面和本機的自訂介面|無法使用|  
|MFC 分配介面|預設設定為 方法名稱。 您可以編輯的內部名稱。|  
|MFC ActiveX 控制項的分配介面|您可以設定自訂方法的內部名稱。 內建方法不會使用內部名稱。|  
  
 **參數屬性**  
 設定中指定參數的任何其他屬性**參數名稱**。  
  
|參數屬性|描述|允許的組合|  
|-------------------------|-----------------|--------------------------|  
|**In**|指出參數呼叫程序從傳遞至呼叫的程序。|**在**只<br /><br /> **在**和**出**|  
|**Out**|指出指標參數，會傳回從呼叫的程序呼叫的程序 （從伺服器到用戶端）。|**out**只<br /><br /> **在**和**出**<br /><br /> **out**和**retval**|  
|**Retval**|指出參數接收成員的傳回值。|**retval**與出|  
  
 **參數型別**  
 設定參數的資料類型。 從清單中選取類型。  
  
 **參數名稱**  
 設定要傳遞到您的方法的參數名稱。 輸入名稱之後, 您必須按一下**新增**將它加入至您的方法會將傳遞的參數清單。 如果您未提供參數名稱，則精靈會忽略任何參數的屬性 (僅 ATL) 或**參數型別**選取項目。  
  
 一旦您按一下**新增**，參數名稱會出現在**參數清單**。  
  
 **請注意**如果您提供參數名稱，然後按一下**完成**您按一下前**新增**，參數不會加入至方法。 您必須尋找的方法，並手動插入參數。  
  
 **[新增]**  
 將您在中指定的參數加入**參數名稱**，其型別和參數屬性，以**參數清單**。 您必須按一下**新增**將參數新增至清單。  
  
 **移除**  
 移除在選取的參數**參數清單**從清單中。  
  
 **參數清單**  
 顯示所有參數及其修飾詞和目前方法中加入型別。 加入參數時，精靈會更新**參數清單**顯示每個參數的類型和修飾詞。  
  
## <a name="see-also"></a>請參閱  
 [加入方法](../ide/adding-a-method-visual-cpp.md)   
 [新增方法精靈、IDL 屬性](../ide/idl-attributes-add-method-wizard.md)