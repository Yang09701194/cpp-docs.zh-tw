---
title: 變更簽章
ms.date: 11/16/2016
ms.assetid: 8daaa060-7305-4035-99d2-8b460b4f4454
ms.openlocfilehash: 97f70f7fdf6cb8a130427d8920152d44c1cb1349
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/15/2018
ms.locfileid: "51693526"
---
# <a name="change-signature"></a>變更簽章

**目的：** 讓您修改函式的參數。

**時機：** 您想要重新排序、新增、移除或修改目前在各種位置中使用之函式的參數。

**原因：** 您可以自行手動變更這些參數，然後尋找對該函式的所有呼叫並逐一變更這些呼叫，但這樣可能會造成錯誤。  這個重構工具將可自動執行此工作。

**做法：**

1. 將文字或滑鼠游標放在要修改的方法名稱或它的其中一個使用方式內：

   ![醒目標示的程式碼](images/changesignature_highlight.png)

1. 接著，執行下列其中一項操作：
   * **鍵盤**
     * 依序按 **CTRL+R** 和 **CTRL+O**。  (請注意，根據您所選取的設定檔，鍵盤快速鍵可能會不同)。
     * 按 **Ctrl+.** 以觸發 [快速動作與重構] 功能表，然後從操作功能表選取 [變更簽章]。
   * **滑鼠**
     * 選取 [編輯] > [重構] > [重新排列參數]。
     * 以滑鼠右鍵按一下程式碼，選取 [快速動作與重構] 功能表，然後從操作功能表選取 [變更簽章]。

1. 在 [變更簽章] 快顯對話方塊中，您可以使用右邊的按鈕來變更方法簽章：

   ![[變更簽章] 對話方塊](images/changesignature_dialog.png)

   | 按鈕 | 描述
   | ------ | ---
   | **向上/向下**    | 將選取的參數在清單中向上和向下移動
   | **[新增]**        | 新增參數至清單
   | **移除**     | 將選取的參數從清單中移除
   | **修改**     | 修改選取的參數，包括變更其類型、名稱與是否為選擇性，以及其將插入的值
   | **還原**     | 將選取的參數還原成其原始狀態
   | **全部還原** | 將所有參數還原成其原始狀態

   > [!TIP]
   > 使用 [如果已確認所有參考，則跳過預覽參考變更] 核取方塊立即進行變更，而不會先顯示預覽視窗。

   新增或修改參數時，您會看到 [新增參數] 或 [編輯參數] 視窗。

   ![新增/修改參數](images/changesignature_addmodify.png)

   您可以在此進行下列設定：

   | 進入 | 描述
   | ----- | ---
   | **Type**               | 參數的類型 (int、double、float 等)
   | **名稱**               | 參數的名稱
   | **選擇性參數** | 選擇性地指定參數
   | **插入的值**     | 插入未指定參數之任何函式呼叫的值 (只適用於 [新增])
   | **預設值**      | 函式所使用的值 (如果呼叫者未指定，只適用於 [選擇性參數])

1. 使用 [搜尋範圍] 下拉式清單來選擇變更要套用至專案或整個方案。

1. 完成時，按 [確定] 按鈕以進行變更。  確定您所要求的變更會適當地進行。  使用視窗上半部的核取方塊，啟用或停用任何項目的重新命名。

   ![變更簽章預覽](images/changesignature_preview.png)

1. 如果看起來沒問題，請按一下 [套用] 按鈕，即會變更您原始程式碼中的函式。

   ![「變更簽章」結果](images/changesignature_result.png)