---
title: CDockingManager 類別
ms.date: 11/04/2016
f1_keywords:
- CDockingManager
- AFXDOCKINGMANAGER/CDockingManager
- AFXDOCKINGMANAGER/CDockingManager::AddDockSite
- AFXDOCKINGMANAGER/CDockingManager::AddHiddenMDITabbedBar
- AFXDOCKINGMANAGER/CDockingManager::AddMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::AddPane
- AFXDOCKINGMANAGER/CDockingManager::AdjustDockingLayout
- AFXDOCKINGMANAGER/CDockingManager::AdjustPaneFrames
- AFXDOCKINGMANAGER/CDockingManager::AdjustRectToClientArea
- AFXDOCKINGMANAGER/CDockingManager::AlignAutoHidePane
- AFXDOCKINGMANAGER/CDockingManager::AutoHidePane
- AFXDOCKINGMANAGER/CDockingManager::BringBarsToTop
- AFXDOCKINGMANAGER/CDockingManager::BuildPanesMenu
- AFXDOCKINGMANAGER/CDockingManager::CalcExpectedDockedRect
- AFXDOCKINGMANAGER/CDockingManager::Create
- AFXDOCKINGMANAGER/CDockingManager::DeterminePaneAndStatus
- AFXDOCKINGMANAGER/CDockingManager::DisableRestoreDockState
- AFXDOCKINGMANAGER/CDockingManager::DockPane
- AFXDOCKINGMANAGER/CDockingManager::DockPaneLeftOf
- AFXDOCKINGMANAGER/CDockingManager::EnableAutoHidePanes
- AFXDOCKINGMANAGER/CDockingManager::EnableDocking
- AFXDOCKINGMANAGER/CDockingManager::EnableDockSiteMenu
- AFXDOCKINGMANAGER/CDockingManager::EnablePaneContextMenu
- AFXDOCKINGMANAGER/CDockingManager::FindDockSite
- AFXDOCKINGMANAGER/CDockingManager::FindDockSiteByPane
- AFXDOCKINGMANAGER/CDockingManager::FindPaneByID
- AFXDOCKINGMANAGER/CDockingManager::FixupVirtualRects
- AFXDOCKINGMANAGER/CDockingManager::FrameFromPoint
- AFXDOCKINGMANAGER/CDockingManager::GetClientAreaBounds
- AFXDOCKINGMANAGER/CDockingManager::GetDockingMode
- AFXDOCKINGMANAGER/CDockingManager::GetDockSiteFrameWnd
- AFXDOCKINGMANAGER/CDockingManager::GetEnabledAutoHideAlignment
- AFXDOCKINGMANAGER/CDockingManager::GetMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::GetOuterEdgeBounds
- AFXDOCKINGMANAGER/CDockingManager::GetPaneList
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingManager
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingManagerPermanent
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingParams
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingTheme
- AFXDOCKINGMANAGER/CDockingManager::HideAutoHidePanes
- AFXDOCKINGMANAGER/CDockingManager::InsertDockSite
- AFXDOCKINGMANAGER/CDockingManager::InsertPane
- AFXDOCKINGMANAGER/CDockingManager::IsDockSiteMenu
- AFXDOCKINGMANAGER/CDockingManager::IsInAdjustLayout
- AFXDOCKINGMANAGER/CDockingManager::IsOLEContainerMode
- AFXDOCKINGMANAGER/CDockingManager::IsPointNearDockSite
- AFXDOCKINGMANAGER/CDockingManager::IsPrintPreviewValid
- AFXDOCKINGMANAGER/CDockingManager::LoadState
- AFXDOCKINGMANAGER/CDockingManager::LockUpdate
- AFXDOCKINGMANAGER/CDockingManager::OnActivateFrame
- AFXDOCKINGMANAGER/CDockingManager::OnClosePopupMenu
- AFXDOCKINGMANAGER/CDockingManager::OnMoveMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::OnPaneContextMenu
- AFXDOCKINGMANAGER/CDockingManager::PaneFromPoint
- AFXDOCKINGMANAGER/CDockingManager::ProcessPaneContextMenuCommand
- AFXDOCKINGMANAGER/CDockingManager::RecalcLayout
- AFXDOCKINGMANAGER/CDockingManager::ReleaseEmptyPaneContainers
- AFXDOCKINGMANAGER/CDockingManager::RemoveHiddenMDITabbedBar
- AFXDOCKINGMANAGER/CDockingManager::RemoveMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::RemovePaneFromDockManager
- AFXDOCKINGMANAGER/CDockingManager::ReplacePane
- AFXDOCKINGMANAGER/CDockingManager::ResortMiniFramesForZOrder
- AFXDOCKINGMANAGER/CDockingManager::SaveState
- AFXDOCKINGMANAGER/CDockingManager::SendMessageToMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::Serialize
- AFXDOCKINGMANAGER/CDockingManager::SetAutohideZOrder
- AFXDOCKINGMANAGER/CDockingManager::SetDockingMode
- AFXDOCKINGMANAGER/CDockingManager::SetDockState
- AFXDOCKINGMANAGER/CDockingManager::SetPrintPreviewMode
- AFXDOCKINGMANAGER/CDockingManager::SetSmartDockingParams
- AFXDOCKINGMANAGER/CDockingManager::ShowDelayShowMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::ShowPanes
- AFXDOCKINGMANAGER/CDockingManager::StartSDocking
- AFXDOCKINGMANAGER/CDockingManager::StopSDocking
- AFXDOCKINGMANAGER/CDockingManager::m_bHideDockingBarsInContainerMode
- AFXDOCKINGMANAGER/CDockingManager::m_dockModeGlobal
- AFXDOCKINGMANAGER/CDockingManager::m_nDockSensitivity
- AFXDOCKINGMANAGER/CDockingManager::m_nTimeOutBeforeDockingBarDock
- AFXDOCKINGMANAGER/CDockingManager::m_nTimeOutBeforeToolBarDock
helpviewer_keywords:
- CDockingManager [MFC], AddDockSite
- CDockingManager [MFC], AddHiddenMDITabbedBar
- CDockingManager [MFC], AddMiniFrame
- CDockingManager [MFC], AddPane
- CDockingManager [MFC], AdjustDockingLayout
- CDockingManager [MFC], AdjustPaneFrames
- CDockingManager [MFC], AdjustRectToClientArea
- CDockingManager [MFC], AlignAutoHidePane
- CDockingManager [MFC], AutoHidePane
- CDockingManager [MFC], BringBarsToTop
- CDockingManager [MFC], BuildPanesMenu
- CDockingManager [MFC], CalcExpectedDockedRect
- CDockingManager [MFC], Create
- CDockingManager [MFC], DeterminePaneAndStatus
- CDockingManager [MFC], DisableRestoreDockState
- CDockingManager [MFC], DockPane
- CDockingManager [MFC], DockPaneLeftOf
- CDockingManager [MFC], EnableAutoHidePanes
- CDockingManager [MFC], EnableDocking
- CDockingManager [MFC], EnableDockSiteMenu
- CDockingManager [MFC], EnablePaneContextMenu
- CDockingManager [MFC], FindDockSite
- CDockingManager [MFC], FindDockSiteByPane
- CDockingManager [MFC], FindPaneByID
- CDockingManager [MFC], FixupVirtualRects
- CDockingManager [MFC], FrameFromPoint
- CDockingManager [MFC], GetClientAreaBounds
- CDockingManager [MFC], GetDockingMode
- CDockingManager [MFC], GetDockSiteFrameWnd
- CDockingManager [MFC], GetEnabledAutoHideAlignment
- CDockingManager [MFC], GetMiniFrames
- CDockingManager [MFC], GetOuterEdgeBounds
- CDockingManager [MFC], GetPaneList
- CDockingManager [MFC], GetSmartDockingManager
- CDockingManager [MFC], GetSmartDockingManagerPermanent
- CDockingManager [MFC], GetSmartDockingParams
- CDockingManager [MFC], GetSmartDockingTheme
- CDockingManager [MFC], HideAutoHidePanes
- CDockingManager [MFC], InsertDockSite
- CDockingManager [MFC], InsertPane
- CDockingManager [MFC], IsDockSiteMenu
- CDockingManager [MFC], IsInAdjustLayout
- CDockingManager [MFC], IsOLEContainerMode
- CDockingManager [MFC], IsPointNearDockSite
- CDockingManager [MFC], IsPrintPreviewValid
- CDockingManager [MFC], LoadState
- CDockingManager [MFC], LockUpdate
- CDockingManager [MFC], OnActivateFrame
- CDockingManager [MFC], OnClosePopupMenu
- CDockingManager [MFC], OnMoveMiniFrame
- CDockingManager [MFC], OnPaneContextMenu
- CDockingManager [MFC], PaneFromPoint
- CDockingManager [MFC], ProcessPaneContextMenuCommand
- CDockingManager [MFC], RecalcLayout
- CDockingManager [MFC], ReleaseEmptyPaneContainers
- CDockingManager [MFC], RemoveHiddenMDITabbedBar
- CDockingManager [MFC], RemoveMiniFrame
- CDockingManager [MFC], RemovePaneFromDockManager
- CDockingManager [MFC], ReplacePane
- CDockingManager [MFC], ResortMiniFramesForZOrder
- CDockingManager [MFC], SaveState
- CDockingManager [MFC], SendMessageToMiniFrames
- CDockingManager [MFC], Serialize
- CDockingManager [MFC], SetAutohideZOrder
- CDockingManager [MFC], SetDockingMode
- CDockingManager [MFC], SetDockState
- CDockingManager [MFC], SetPrintPreviewMode
- CDockingManager [MFC], SetSmartDockingParams
- CDockingManager [MFC], ShowDelayShowMiniFrames
- CDockingManager [MFC], ShowPanes
- CDockingManager [MFC], StartSDocking
- CDockingManager [MFC], StopSDocking
- CDockingManager [MFC], m_bHideDockingBarsInContainerMode
- CDockingManager [MFC], m_dockModeGlobal
- CDockingManager [MFC], m_nDockSensitivity
- CDockingManager [MFC], m_nTimeOutBeforeDockingBarDock
- CDockingManager [MFC], m_nTimeOutBeforeToolBarDock
ms.assetid: 98e69c43-55d8-4f43-b861-4fda80ec1e32
ms.openlocfilehash: 8709b3a4eb3f57a3d2700ad7aaed16df994245c5
ms.sourcegitcommit: 3e8fa01f323bc5043a48a0c18b855d38af3648d4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2020
ms.locfileid: "78883917"
---
# <a name="cdockingmanager-class"></a>CDockingManager 類別

實作控制配置停駐於主框架視窗中的核心功能。

## <a name="syntax"></a>語法

```
class CDockingManager : public CObject
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CDockingManager::AddDockSite](#adddocksite)|建立停駐窗格，並將它新增至控制列清單。|
|[CDockingManager::AddHiddenMDITabbedBar](#addhiddenmditabbedbar)|將 [橫條圖] 的控點加入至隱藏的 MDI 索引標籤式橫條窗格清單。|
|[CDockingManager::AddMiniFrame](#addminiframe)|將框架加入迷你框架的清單。|
|[CDockingManager::AddPane](#addpane)|向銜接管理員註冊窗格。|
|[CDockingManager：： AdjustDockingLayout](#adjustdockinglayout)|重新計算並調整框架視窗中所有窗格的版面配置。|
|[CDockingManager::AdjustPaneFrames](#adjustpaneframes)|導致 WM_NCCALCSIZE 訊息傳送至所有窗格，並 `CPaneFrameWnd` 視窗。|
|[CDockingManager::AdjustRectToClientArea](#adjustrecttoclientarea)|調整矩形的對齊方式。|
|[CDockingManager::AlignAutoHidePane](#alignautohidepane)|調整自動隱藏模式中的停駐窗格大小，讓它取得框架工作區的完整寬度或高度，並以固定的網站括住。|
|[CDockingManager::AutoHidePane](#autohidepane)|建立自動隱藏工具列。|
|[CDockingManager::BringBarsToTop](#bringbarstotop)|將具有指定對齊方式的停駐列帶入頂端。|
|[CDockingManager::BuildPanesMenu](#buildpanesmenu)|將停駐窗格和工具列的名稱新增至功能表。|
|[CDockingManager::CalcExpectedDockedRect](#calcexpecteddockedrect)|計算固定視窗的預期矩形。|
|[CDockingManager：： Create](#create)|建立停駐管理員。|
|[CDockingManager：:D eterminePaneAndStatus](#determinepaneandstatus)|決定包含指定點和其銜接狀態的窗格。|
|[CDockingManager：:D isableRestoreDockState](#disablerestoredockstate)|啟用或停用從登錄中載入停駐版面配置的功能。|
|[CDockingManager：:D ockPane](#dockpane)|將窗格停駐至另一個窗格或框架視窗。|
|[CDockingManager：:D ockPaneLeftOf](#dockpaneleftof)|將窗格停駐於另一個窗格的左邊。|
|[CDockingManager::EnableAutoHidePanes](#enableautohidepanes)|將窗格停駐到主框架、建立固定窗格，並將它新增至控制列清單。|
|[CDockingManager：： EnableDocking](#enabledocking)|建立停駐窗格，並讓窗格與主框架銜接。|
|[CDockingManager::EnableDockSiteMenu](#enabledocksitemenu)|顯示 [其他] 按鈕，在所有銜接窗格的標題上開啟快顯功能表。|
|[CDockingManager::EnablePaneCoNtextMenu](#enablepanecontextmenu)|當使用者按一下滑鼠右鍵且程式庫正在處理 WM_CONTEXTMENU 訊息時，告訴程式庫顯示一個特殊的內容功能表，其中包含應用程式工具列和停駐窗格的清單。|
|[CDockingManager::FindDockSite](#finddocksite)|抓取位於指定位置且具有指定對齊的橫條窗格。|
|[CDockingManager::FindDockSiteByPane](#finddocksitebypane)|傳回具有 [目標列] 窗格識別碼的 [橫條圖] 窗格。|
|[CDockingManager::FindPaneByID](#findpanebyid)|依據指定的控制項 ID 尋找窗格。|
|[CDockingManager::FixupVirtualRects](#fixupvirtualrects)|將所有目前的工具列位置認可至虛擬矩形。|
|[CDockingManager::FrameFromPoint](#framefrompoint)|傳回包含指定點的框架。|
|[CDockingManager::GetClientAreaBounds](#getclientareabounds)|取得包含工作區範圍的矩形。|
|[CDockingManager：： GetDockingMode](#getdockingmode)|傳回目前的銜接模式。|
|[CDockingManager::GetDockSiteFrameWnd](#getdocksiteframewnd)|取得父視窗框架的指標。|
|[CDockingManager::GetEnabledAutoHideAlignment](#getenabledautohidealignment)|傳回窗格的已啟用對齊。|
|[CDockingManager::GetMiniFrames](#getminiframes)|取得 miniframes 的清單。|
|[CDockingManager::GetOuterEdgeBounds](#getouteredgebounds)|取得包含框架外部邊緣的矩形。|
|[CDockingManager::GetPaneList](#getpanelist)|傳回屬於銜接管理員的窗格清單。 這包括所有浮動窗格。|
|[CDockingManager::GetSmartDockingManager](#getsmartdockingmanager)|抓取智慧停駐管理員的指標。|
|[CDockingManager::GetSmartDockingManagerPermanent](#getsmartdockingmanagerpermanent)|抓取智慧停駐管理員的指標。|
|[CDockingManager::GetSmartDockingParams](#getsmartdockingparams)|傳回停駐管理員的智慧銜接參數。|
|[CDockingManager::GetSmartDockingTheme](#getsmartdockingtheme)|靜態方法，會傳回用來顯示智慧停駐標記的主題。|
|[CDockingManager::HideAutoHidePanes](#hideautohidepanes)|隱藏處於自動隱藏模式的窗格。|
|[CDockingManager::InsertDockSite](#insertdocksite)|建立停駐窗格，並將它插入控制列清單中。|
|[CDockingManager::InsertPane](#insertpane)|將控制項窗格插入控制列清單中。|
|[CDockingManager::IsDockSiteMenu](#isdocksitemenu)|指定是否要在所有窗格的標題上顯示快顯功能表。|
|[CDockingManager::IsInAdjustLayout](#isinadjustlayout)|決定是否要調整所有窗格的版面配置。|
|[CDockingManager::IsOLEContainerMode](#isolecontainermode)|指定停駐管理員是否為 OLE 容器模式。|
|[CDockingManager::IsPointNearDockSite](#ispointneardocksite)|判斷指定的點是否接近 dock 網站。|
|[CDockingManager::IsPrintPreviewValid](#isprintpreviewvalid)|決定預覽列印模式是否已設定。|
|[CDockingManager：： LoadState](#loadstate)|從登錄載入停駐管理員的狀態。|
|[CDockingManager::LockUpdate](#lockupdate)|鎖定指定的視窗。|
|[CDockingManager::OnActivateFrame](#onactivateframe)|當框架視窗設為現用或停用時，由架構呼叫。|
|[CDockingManager::OnClosePopupMenu](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[CDockingManager::OnMoveMiniFrame](#onmoveminiframe)|由架構呼叫以移動迷你框架視窗。|
|[CDockingManager::OnPaneCoNtextMenu](#onpanecontextmenu)|在建立具有窗格清單的功能表時，由架構呼叫。|
|[CDockingManager：:P aneFromPoint](#panefrompoint)|傳回包含指定點的窗格。|
|[CDockingManager：:P rocessPaneCoNtextMenuCommand](#processpanecontextmenucommand)|由架構呼叫以選取或清除指定之命令的核取方塊，並重新計算所顯示窗格的版面配置。|
|[CDockingManager：： RecalcLayout](#recalclayout)|重新計算控制項清單中所顯示控制項的內部配置。|
|[CDockingManager::ReleaseEmptyPaneContainers](#releaseemptypanecontainers)|釋放空的窗格容器。|
|[CDockingManager::RemoveHiddenMDITabbedBar](#removehiddenmditabbedbar)|移除指定的隱藏橫條窗格。|
|[CDockingManager::RemoveMiniFrame](#removeminiframe)|從迷你框架清單中移除指定的框架。|
|[CDockingManager::RemovePaneFromDockManager](#removepanefromdockmanager)|取消註冊窗格，並將它從停駐管理員中的清單移除。|
|[CDockingManager::ReplacePane](#replacepane)|以一個窗格取代另一個。|
|[CDockingManager::ResortMiniFramesForZOrder](#resortminiframesforzorder)|將小型框架清單中的框架化。|
|[CDockingManager：： SaveState](#savestate)|將停駐管理員的狀態儲存至登錄。|
|[CDockingManager::SendMessageToMiniFrames](#sendmessagetominiframes)|將指定的訊息傳送至所有迷你框架。|
|[CDockingManager：：序列化](#serialize)|將停駐管理員寫入封存。 (覆寫 [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)。)|
|[CDockingManager::SetAutohideZOrder](#setautohidezorder)|設定控制列和指定窗格的大小、寬度和高度。|
|[CDockingManager::SetDockingMode](#setdockingmode)|設定銜接模式。|
|[CDockingManager::SetDockState](#setdockstate)|設定控制列、迷你框架和自動隱藏列的停駐狀態。|
|[CDockingManager::SetPrintPreviewMode](#setprintpreviewmode)|設定預覽列印中顯示的長條預覽列印模式。|
|[CDockingManager::SetSmartDockingParams](#setsmartdockingparams)|設定參數，以定義智慧銜接的行為。|
|[CDockingManager::ShowDelayShowMiniFrames](#showdelayshowminiframes)|顯示或隱藏迷你框架的視窗。|
|[CDockingManager::ShowPanes](#showpanes)|顯示或隱藏 [控制項] 和 [自動隱藏] 橫條圖的窗格。|
|[CDockingManager::StartSDocking](#startsdocking)|根據智慧停駐管理員的對齊，啟動指定之視窗的智慧停駐。|
|[CDockingManager::StopSDocking](#stopsdocking)|停止智慧型銜接。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CDockingManager：： m_bHideDockingBarsInContainerMode](#m_bhidedockingbarsincontainermode)|指定停駐管理員是否隱藏 OLE 容器模式中的窗格。|
|[CDockingManager：： m_dockModeGlobal](#m_dockmodeglobal)|指定全域銜接模式。|
|[CDockingManager：： m_nDockSensitivity](#m_ndocksensitivity)|指定停駐敏感度。|
|[CDockingManager：： m_nTimeOutBeforeDockingBarDock](#m_ntimeoutbeforedockingbardock)|指定停駐窗格停駐在立即銜接模式之前的時間（以毫秒為單位）。|
|[CDockingManager：： m_nTimeOutBeforeToolBarDock](#m_ntimeoutbeforetoolbardock)|指定工具列停駐于主框架視窗之前的時間（以毫秒為單位）。|

## <a name="remarks"></a>備註

主框架視窗會自動建立並初始化這個類別。

停駐管理員物件會保留停駐版面配置中所有窗格的清單，以及屬於主框架視窗的所有[CPaneFrameWnd](../../mfc/reference/cpaneframewnd-class.md)視窗清單。

`CDockingManager` 類別會執行一些您可以用來尋找窗格或 `CPaneFrameWnd` 視窗的服務。 您通常不會直接呼叫這些服務，因為它們會包裝在主框架視窗物件中。 如需詳細資訊，請參閱[CPaneFrameWnd 類別](../../mfc/reference/cpaneframewnd-class.md)。

## <a name="customization-tips"></a>自訂秘訣

下列秘訣適用于 `CDockingManager` 物件：

- [CDockingManager 類別](../../mfc/reference/cdockingmanager-class.md)支援下列銜接模式：

  - `AFX_DOCK_TYPE::DT_IMMEDIATE`

  - `AFX_DOCK_TYPE::DT_STANDARD`

  - `AFX_DOCK_TYPE::DT_SMART`

  這些銜接模式是由[CDockingManager：： m_dockModeGlobal](#m_dockmodeglobal)所定義，而且是藉由呼叫[CDockingManager：： SetDockingMode](#setdockingmode)來設定。

- 如果您想要建立非浮動、不可調整大小的窗格，請呼叫[CDockingManager：： AddPane](#addpane)方法。 這個方法會向停駐管理員註冊窗格，這會負責處理窗格的版面配置。

## <a name="example"></a>範例

下列範例示範如何在 `CDockingManager` 類別中使用各種方法來設定 `CDockingManager` 物件。 此範例示範如何顯示額外的按鈕，在所有停駐窗格的標題上開啟快顯功能表，以及如何設定物件的銜接模式。 此程式碼片段是[Visual Studio 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_VisualStudioDemo#24](../../mfc/codesnippet/cpp/cdockingmanager-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CDockingManager](../../mfc/reference/cdockingmanager-class.md)

## <a name="requirements"></a>需求

**標頭：** afxDockingManager。h

##  <a name="adddocksite"></a>CDockingManager::AddDockSite

建立停駐窗格，並將它新增至控制列清單。

```
BOOL AddDockSite(
    const AFX_DOCKSITE_INFO& info,
    CDockSite** ppDockBar = NULL);
```

### <a name="parameters"></a>參數

*info*<br/>
在包含停駐窗格對齊的 info 結構參考。

*ppDockBar*<br/>
脫銷指向新 dock 窗格之指標的指標。

### <a name="return-value"></a>傳回值

如果已成功建立 dock 窗格，則為 TRUE;否則為 FALSE。

##  <a name="addhiddenmditabbedbar"></a>CDockingManager::AddHiddenMDITabbedBar

將 [橫條圖] 的控點加入至隱藏的 MDI 索引標籤式橫條窗格清單。

```
void AddHiddenMDITabbedBar(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在橫條窗格的指標

##  <a name="addpane"></a>CDockingManager::AddPane

向銜接管理員註冊窗格。

```
BOOL AddPane(
    CBasePane* pWnd,
    BOOL bTail = TRUE,
    BOOL bAutoHide = FALSE,
    BOOL bInsertForOuterEdge = FALSE);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in、out]指定要加入至銜接管理員的窗格。

*bTail*<br/>
在TRUE 會將窗格新增至停駐管理員的窗格清單結尾;否則為 FALSE。

*bAutoHide*<br/>
在僅供內部使用。 一律使用預設值 FALSE。

*bInsertForOuterEdge*<br/>
在僅供內部使用。 一律使用預設值 FALSE。

### <a name="return-value"></a>傳回值

如果窗格已成功向停駐管理員註冊，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法，即可使用停駐管理員來註冊非浮動、不可調整大小的窗格。 如果您未註冊窗格，當停駐管理員配置時，它們將不會正確顯示。

##  <a name="adjustdockinglayout"></a>CDockingManager：： AdjustDockingLayout

重新計算並調整框架視窗中所有窗格的版面配置。

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### <a name="parameters"></a>參數

*hdwp*<br/>
在指定延後的視窗位置結構。 如需詳細資訊，請參閱 [Windows 資料類型](/windows/win32/WinProg/windows-data-types)。

### <a name="remarks"></a>備註

##  <a name="addminiframe"></a>CDockingManager::AddMiniFrame

將框架加入迷你框架的清單。

```
virtual BOOL AddMiniFrame(CPaneFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在框架的指標。

### <a name="return-value"></a>傳回值

如果框架不在迷你框架清單中，而且已成功新增，則為 TRUE;否則為 FALSE。

##  <a name="adjustpaneframes"></a>CDockingManager::AdjustPaneFrames

導致 WM_NCCALCSIZE 訊息傳送至所有窗格，並 `CPaneFrameWnd` 視窗。

```
virtual void AdjustPaneFrames();
```

### <a name="remarks"></a>備註

##  <a name="adjustrecttoclientarea"></a>CDockingManager::AdjustRectToClientArea

調整矩形的對齊方式。

```
virtual BOOL AdjustRectToClientArea(
    CRect& rectResult,
    DWORD dwAlignment);
```

### <a name="parameters"></a>參數

*rectResult*<br/>
在`CRect` 物件的參考

*dwAlignment*<br/>
在`CRect` 物件的對齊

### <a name="return-value"></a>傳回值

如果已調整 `CRect` 物件的對齊，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*DwAlignment*參數可以有下列其中一個值：

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

##  <a name="alignautohidepane"></a>CDockingManager::AlignAutoHidePane

調整自動隱藏模式中的停駐窗格大小，讓它取得框架工作區的完整寬度或高度，並以固定的網站括住。

```
void AlignAutoHidePane(
    CPaneDivider* pDefaultSlider,
    BOOL bIsVisible = TRUE);
```

### <a name="parameters"></a>參數

*pDefaultSlider*<br/>
在固定滑動軸窗格。

*bIsVisible*<br/>
在如果停駐窗格為可見，則為 TRUE;否則為 FALSE。

##  <a name="autohidepane"></a>CDockingManager::AutoHidePane

建立自動隱藏工具列。

```
CMFCAutoHideToolBar* AutoHidePane(
    CDockablePane* pBar,
    CMFCAutoHideToolBar* pCurrAutoHideToolBar = NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在橫條窗格的指標。

*pCurrAutoHideToolBar*<br/>
在自動隱藏工具列的指標。

### <a name="return-value"></a>傳回值

如果未建立自動隱藏工具列，則為 Null;否則為新工具列的指標。

##  <a name="bringbarstotop"></a>CDockingManager::BringBarsToTop

將具有指定對齊方式的停駐列帶入頂端。

```
void BringBarsToTop(
    DWORD dwAlignment = 0,
    BOOL bExcludeDockedBars = TRUE);
```

### <a name="parameters"></a>參數

*dwAlignment*<br/>
在放在其他視窗頂端的停駐線對齊。

*bExcludeDockedBars*<br/>
在TRUE 表示排除停駐的橫條，而不是放在上方;否則為 FALSE。

##  <a name="buildpanesmenu"></a>CDockingManager::BuildPanesMenu

將停駐窗格和工具列的名稱新增至功能表。

```
void BuildPanesMenu(
    CMenu& menu,
    BOOL bToolbarsOnly);
```

### <a name="parameters"></a>參數

*下拉式功能表*<br/>
在一個功能表，可將停駐窗格和工具列的名稱新增至。

*bToolbarsOnly*<br/>
在TRUE 表示只將工具列名稱新增至功能表;否則為 FALSE。

##  <a name="calcexpecteddockedrect"></a>CDockingManager::CalcExpectedDockedRect

計算固定視窗的預期矩形。

```
void CalcExpectedDockedRect(
    CWnd* pWnd,
    CPoint ptMouse,
    CRect& rectResult,
    BOOL& bDrawTab,
    CDockablePane** ppTargetBar);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在要停駐之視窗的指標。

*ptMouse*<br/>
在滑鼠位置。

*rectResult*<br/>
脫銷計算的矩形。

*bDrawTab*<br/>
在TRUE 表示繪製索引標籤;否則為 FALSE。

*ppTargetBar*<br/>
脫銷指向目標窗格指標的指標。

### <a name="remarks"></a>備註

如果使用者將視窗拖曳到*ptMouse*所指定的點，並將它停駐在該處，這個方法會計算視窗會佔用的矩形。

##  <a name="create"></a>CDockingManager：： Create

建立停駐管理員。

```
BOOL Create(CFrameWnd* pParentWnd);
```

### <a name="parameters"></a>參數

*pParentWnd*<br/>
在停駐管理員之父框架的指標。 此值不得為 Null。

### <a name="return-value"></a>傳回值

TRUE 一律為。

##  <a name="determinepaneandstatus"></a>CDockingManager：:D eterminePaneAndStatus

決定包含指定點和其銜接狀態的窗格。

```
virtual AFX_CS_STATUS DeterminePaneAndStatus(
    CPoint pt,
    int nSensitivity,
    DWORD dwEnabledAlignment,
    CBasePane** ppTargetBar,
    const CBasePane* pBarToIgnore,
    const CBasePane* pBarToDock);
```

### <a name="parameters"></a>參數

*pt*<br/>
在要檢查之窗格的位置。

*nSensitivity*<br/>
在值，可增加每個已核取窗格的視窗矩形。 如果指定的點在這個增加的區域中，則窗格會符合搜尋準則。

*dwEnabledAlignment*<br/>
在停駐窗格的對齊方式。

*ppTargetBar*<br/>
脫銷指向目標窗格指標的指標。

*pBarToIgnore*<br/>
在方法會忽略的窗格。

*pBarToDock*<br/>
在停駐的窗格。

### <a name="return-value"></a>傳回值

停駐狀態。

### <a name="remarks"></a>備註

銜接狀態可以是下列其中一個值：

|AFX_CS_STATUS 值|意義|
|---------------------------|-------------|
|CS_NOTHING|指標不在停駐的網站上。 因此，請將窗格保持浮動。|
|CS_DOCK_IMMEDIATELY|指標是在「立即模式」中的停駐網站上（DT_IMMEDIATE 樣式已啟用），因此必須立即固定窗格。|
|CS_DELAY_DOCK|指標位於停駐在另一個固定窗格，或是主要框架邊緣的 dock 網站上方。|
|CS_DELAY_DOCK_TO_TAB|指標位於停駐在索引標籤式視窗中的 dock 網站上方。 當滑鼠停留在另一個停駐窗格的標題上方或索引標籤式窗格的索引標籤區域上方時，就會發生這種情況。|

##  <a name="disablerestoredockstate"></a>CDockingManager：:D isableRestoreDockState

啟用或停用從登錄中載入停駐版面配置的功能。

```
void DisableRestoreDockState(BOOL bDisable = TRUE);
```

### <a name="parameters"></a>參數

*bDisable*<br/>
在TRUE 表示停用從登錄載入停駐版面配置;否則為 FALSE。

### <a name="remarks"></a>備註

當您必須在載入應用程式狀態時保留目前的停駐窗格和工具列配置時，請呼叫這個方法。

##  <a name="dockpane"></a>CDockingManager：:D ockPane

將窗格停駐至另一個窗格或框架視窗。

```
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在要停駐的橫條窗格指標。

*nDockBarID*<br/>
在要停駐的橫條識別碼。

*lpRect*<br/>
在目的地矩形。

##  <a name="dockpaneleftof"></a>CDockingManager：:D ockPaneLeftOf

將窗格停駐於另一個窗格的左邊。

```
BOOL DockPaneLeftOf(
    CPane* pBarToDock,
    CPane* pTargetBar);
```

### <a name="parameters"></a>參數

*pBarToDock*<br/>
在要停駐在*pTargetBar*左邊的窗格指標。

*pTargetBar*<br/>
在目標窗格的指標。

### <a name="return-value"></a>傳回值

如果已成功停駐窗格，則為 TRUE;否則為 FALSE。

##  <a name="enableautohidepanes"></a>CDockingManager::EnableAutoHidePanes

將窗格停駐到主框架、建立固定窗格，並將它新增至控制列清單。

```
BOOL EnableAutoHidePanes(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
在停駐對齊。

### <a name="return-value"></a>傳回值

如果已成功建立 dock 窗格，則為 TRUE;否則為 FALSE。

##  <a name="enabledocking"></a>CDockingManager：： EnableDocking

建立停駐窗格，並讓窗格與主框架銜接。

```
BOOL EnableDocking(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
在停駐對齊。

### <a name="return-value"></a>傳回值

如果已成功建立 dock 窗格，則為 TRUE;否則為 FALSE。

##  <a name="enabledocksitemenu"></a>CDockingManager::EnableDockSiteMenu

顯示 [其他] 按鈕，在所有銜接窗格的標題上開啟快顯功能表。

```
static void EnableDockSiteMenu(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用 [停駐網站] 功能表;否則為 FALSE。

### <a name="remarks"></a>備註

[停駐網站] 功能表會顯示下列選項，以變更窗格的停駐狀態：

- `Floating`-將窗格浮動

- `Docking`-在主要畫面格上停駐窗格所在位置的窗格

- `AutoHide`-將窗格切換為自動隱藏模式

- `Hide`-隱藏窗格

根據預設，不會顯示此功能表。

##  <a name="enablepanecontextmenu"></a>CDockingManager::EnablePaneCoNtextMenu

當使用者按一下滑鼠右鍵且程式庫正在處理 WM_CONTEXTMENU 訊息時，告訴程式庫顯示一個特殊的內容功能表，其中包含應用程式工具列和停駐窗格的清單。

```
void EnablePaneContextMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bToolbarsOnly = FALSE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在若為 TRUE，則程式庫會開啟自動內容功能表的支援;如果為 FALSE，則程式庫會關閉自動內容功能表的支援。

*uiCustomizeCmd*<br/>
在功能表中 [**自訂**] 專案的命令識別碼。

*strCustomizeText*<br/>
在**自訂**專案的文字。

*bToolbarsOnly*<br/>
在若為 TRUE，則功能表只會顯示應用程式工具列的清單;如果為 FALSE，則程式庫會將應用程式停駐窗格新增至此清單。

##  <a name="finddocksite"></a>CDockingManager::FindDockSite

抓取位於指定位置且具有指定對齊的橫條窗格。

```
virtual CDockSite* FindDockSite(
    DWORD dwAlignment,
    BOOL bOuter);
```

### <a name="parameters"></a>參數

*dwAlignment*<br/>
在橫條圖窗格的對齊方式。

*bOuter*<br/>
在若為 TRUE，則抓取控制列清單中標題位置的橫條。 否則，請在控制列清單中取出結尾位置的橫條。

### <a name="return-value"></a>傳回值

具有指定對齊的銜接窗格;否則為 Null。

##  <a name="findpanebyid"></a>CDockingManager::FindPaneByID

依據指定的控制項 ID 尋找窗格。

```
virtual CBasePane* FindPaneByID(
    UINT uBarID,
    BOOL bSearchMiniFrames = FALSE);
```

### <a name="parameters"></a>參數

*uBarID*<br/>
在指定要尋找之窗格的控制項識別碼。

*bSearchMiniFrames*<br/>
在TRUE 表示在搜尋中包含所有浮動窗格。 FALSE 表示只包含停駐的窗格。

### <a name="return-value"></a>傳回值

具有指定控制項識別碼的[CBasePane](../../mfc/reference/cbasepane-class.md)物件，如果找不到指定的窗格，則為 Null。

### <a name="remarks"></a>備註

##  <a name="finddocksitebypane"></a>CDockingManager::FindDockSiteByPane

傳回具有 [目標列] 窗格識別碼的 [橫條圖] 窗格。

```
virtual CDockSite* FindDockSiteByPane(CPane* pTargetBar);
```

### <a name="parameters"></a>參數

*pTargetBar*<br/>
在目標橫條窗格的指標。

### <a name="return-value"></a>傳回值

具有目標列窗格識別碼的 [橫條圖] 窗格;如果沒有這類橫條窗格，則為 Null。

##  <a name="fixupvirtualrects"></a>CDockingManager::FixupVirtualRects

將所有目前的工具列位置認可至虛擬矩形。

```
virtual void FixupVirtualRects();
```

### <a name="remarks"></a>備註

當使用者開始拖曳工具列時，應用程式會記住其在*虛擬矩形*中的原始位置。 當使用者在其停駐網站間移動工具列時，工具列可能會移位其他工具列。 其他工具列的原始位置會儲存在對應的虛擬矩形中。

##  <a name="framefrompoint"></a>CDockingManager::FrameFromPoint

傳回包含指定點的框架。

```
virtual CPaneFrameWnd* FrameFromPoint(
    CPoint pt,
    CPaneFrameWnd* pFrameToExclude,
    BOOL bFloatMultiOnly) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
在指定要檢查的點（以螢幕座標表示）。

*pFrameToExclude*<br/>
在要排除之框架的指標。

*bFloatMultiOnly*<br/>
在TRUE 表示排除不是 `CMultiPaneFrameWnd`實例的框架;否則為 FALSE。

### <a name="return-value"></a>傳回值

包含指定點的框架;否則為 Null。

##  <a name="getclientareabounds"></a>CDockingManager::GetClientAreaBounds

取得包含工作區範圍的矩形。

```
CRect GetClientAreaBounds() const;

void GetClientAreaBounds(CRect& rcClient);
```

### <a name="parameters"></a>參數

*rcClient*<br/>
脫銷包含工作區範圍之矩形的參考。

### <a name="return-value"></a>傳回值

包含工作區範圍的矩形。

##  <a name="getdockingmode"></a>CDockingManager：： GetDockingMode

傳回目前的銜接模式。

```
static AFX_DOCK_TYPE GetDockingMode();
```

### <a name="return-value"></a>傳回值

表示目前銜接模式的列舉值。 它可能是下列其中一個值：

- DT_STANDARD

- DT_IMMEDIATE

- DT_SMART

### <a name="remarks"></a>備註

若要設定銜接模式，請呼叫[CDockingManager：： SetDockingMode](#setdockingmode)。

##  <a name="getdocksiteframewnd"></a>CDockingManager::GetDockSiteFrameWnd

取得父視窗框架的指標。

```
CFrameWnd* GetDockSiteFrameWnd() const;
```

### <a name="return-value"></a>傳回值

父視窗框架的指標。

##  <a name="getenabledautohidealignment"></a>CDockingManager::GetEnabledAutoHideAlignment

傳回窗格的已啟用對齊。

```
DWORD GetEnabledAutoHideAlignment() const;
```

### <a name="return-value"></a>傳回值

CBRS_ALIGN_ 旗標的位元組合，如果未啟用自動隱藏窗格，則為0。 如需詳細資訊，請參閱[CFrameWnd：： EnableDocking](../../mfc/reference/cframewnd-class.md#enabledocking)。

### <a name="remarks"></a>備註

方法會傳回自動隱藏控制條的已啟用對齊。 若要啟用自動隱藏列，請呼叫[CFrameWndEx：： EnableAutoHidePanes](../../mfc/reference/cframewndex-class.md#enableautohidepanes)。

##  <a name="getminiframes"></a>CDockingManager::GetMiniFrames

取得 miniframes 的清單。

```
const CObList& GetMiniFrames() const;
```

### <a name="return-value"></a>傳回值

包含屬於銜接管理員之控制列的 miniframes 清單。

##  <a name="getouteredgebounds"></a>CDockingManager::GetOuterEdgeBounds

取得包含框架外部邊緣的矩形。

```
CRect GetOuterEdgeBounds() const;
```

### <a name="return-value"></a>傳回值

包含框架外部邊緣的矩形。

##  <a name="getpanelist"></a>CDockingManager::GetPaneList

傳回屬於銜接管理員的窗格清單。 這包括所有浮動窗格。

```
void GetPaneList(
    CObList& lstBars,
    BOOL bIncludeAutohide = FALSE,
    CRuntimeClass* pRTCFilter = NULL,
    BOOL bIncludeTabs = FALSE);
```

### <a name="parameters"></a>參數

*lstBars*<br/>
[in、out]包含目前銜接管理員的所有窗格。

*bIncludeAutohide*<br/>
在TRUE 表示包含處於自動隱藏模式的窗格;否則為 FALSE。

*pRTCFilter*<br/>
在如果不是 Null，則傳回的清單只會包含所指定執行時間類別的窗格。

*bIncludeTabs*<br/>
在TRUE 表示包含定位字元;否則為 FALSE。

### <a name="remarks"></a>備註

如果停駐管理員中有任何索引標籤式窗格，此方法會傳回[CBaseTabbedPane 類別](../../mfc/reference/cbasetabbedpane-class.md)物件的指標，而且您必須明確地列舉索引標籤。

使用*pRTCFilter*來取得特定的窗格類別。 例如，您可以適當地設定此值來取得工具列。

##  <a name="getsmartdockingmanager"></a>CDockingManager::GetSmartDockingManager

抓取智慧停駐管理員的指標。

```
CSmartDockingManager* GetSmartDockingManager();
```

### <a name="return-value"></a>傳回值

智慧停駐管理員的指標。

##  <a name="getsmartdockingmanagerpermanent"></a>CDockingManager::GetSmartDockingManagerPermanent

抓取智慧停駐管理員的指標。

```
CSmartDockingManager* GetSmartDockingManagerPermanent() const;
```

### <a name="return-value"></a>傳回值

智慧停駐管理員的指標。

##  <a name="getsmartdockingparams"></a>CDockingManager::GetSmartDockingParams

傳回停駐管理員的智慧銜接參數。

```
static CSmartDockingInfo& GetSmartDockingParams();
```

### <a name="return-value"></a>傳回值

包含目前停駐管理員之智慧停駐參數的類別。 如需詳細資訊，請參閱[CSmartDockingInfo 類別](../../mfc/reference/csmartdockinginfo-class.md)。

### <a name="remarks"></a>備註

##  <a name="hideautohidepanes"></a>CDockingManager::HideAutoHidePanes

隱藏處於自動隱藏模式的窗格。

```
void HideAutoHidePanes(
    CDockablePane* pBarToExclude = NULL,
    BOOL bImmediately = FALSE);
```

### <a name="parameters"></a>參數

*pBarToExclude*<br/>
在要排除隱藏的橫條指標。

*bImmediately*<br/>
在TRUE 表示立即隱藏窗格;FALSE 表示隱藏具有自動隱藏效果的窗格。

##  <a name="insertdocksite"></a>CDockingManager::InsertDockSite

建立停駐窗格，並將它插入控制列清單中。

```
BOOL InsertDockSite(
    const AFX_DOCKSITE_INFO& info,
    DWORD dwAlignToInsertAfter,
    CDockSite** ppDockBar = NULL);
```

### <a name="parameters"></a>參數

*info*<br/>
在包含停駐窗格之對齊方式資訊的結構。

*dwAlignToInsertAfter*<br/>
在停駐窗格的對齊方式。

*ppDockBar*<br/>
脫銷停駐窗格指標的指標。

### <a name="return-value"></a>傳回值

如果已成功建立 dock 窗格，則為 TRUE;否則為 FALSE。

##  <a name="insertpane"></a>CDockingManager::InsertPane

將控制項窗格插入控制列清單中。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### <a name="parameters"></a>參數

*pControlBar*<br/>
在控制項窗格的指標。

*pTarget*<br/>
在目標窗格的指標。

*bAfter*<br/>
在TRUE 表示在目標窗格的位置之後插入窗格;否則為 FALSE。

### <a name="return-value"></a>傳回值

如果 [控制項] 窗格已成功加入控制列清單中，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果控制項窗格已在控制列清單中，或如果目標窗格不存在於控制列清單中，則這個方法會傳回 false。

##  <a name="isdocksitemenu"></a>CDockingManager::IsDockSiteMenu

指定是否要在所有窗格的標題上顯示快顯功能表。

```
static BOOL IsDockSiteMenu();
```

### <a name="return-value"></a>傳回值

如果停駐網站功能表顯示在所有銜接窗格的標題上，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

您可以藉由呼叫[CDockingManager：： EnableDockSiteMenu](#enabledocksitemenu)來啟用 [停駐網站] 功能表。

##  <a name="isinadjustlayout"></a>CDockingManager::IsInAdjustLayout

決定是否要調整所有窗格的版面配置。

```
BOOL IsInAdjustLayout() const;
```

### <a name="return-value"></a>傳回值

如果已調整所有窗格的版面配置，則為 TRUE;否則為 FALSE。

##  <a name="isolecontainermode"></a>CDockingManager::IsOLEContainerMode

指定停駐管理員是否為 OLE 容器模式。

```
BOOL IsOLEContainerMode() const;
```

### <a name="return-value"></a>傳回值

如果停駐管理員是在 OLE 容器模式中，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

在 OLE 容器模式中，所有銜接窗格和應用程式工具列都會隱藏起來。 如果您已將[CDockingManager：： m_bHideDockingBarsInContainerMode](#m_bhidedockingbarsincontainermode)設定為 TRUE，則窗格也會在此模式中隱藏。

##  <a name="ispointneardocksite"></a>CDockingManager::IsPointNearDockSite

判斷指定的點是否接近 dock 網站。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

*此處*<br/>
在指定的點。

*dwBarAlignment*<br/>
脫銷指定點接近的邊緣。 可能的值為 CBRS_ALIGN_LEFT、CBRS_ALIGN_RIGHT、CBRS_ALIGN_TOP 和 CBRS_ALIGN_BOTTOM。

*bOuterEdge*<br/>
脫銷如果點位於 dock 網站的外部框線附近，則為 TRUE;否則為 FALSE。

### <a name="return-value"></a>傳回值

如果點位於 dock 網站附近，則為 TRUE;否則為 FALSE。

##  <a name="isprintpreviewvalid"></a>CDockingManager::IsPrintPreviewValid

決定預覽列印模式是否已設定。

```
BOOL IsPrintPreviewValid() const;
```

### <a name="return-value"></a>傳回值

如果已設定預覽列印模式，則為 TRUE;否則為 FALSE。

##  <a name="loadstate"></a>CDockingManager：： LoadState

從登錄載入停駐管理員的狀態。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName = NULL,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在設定檔名稱。

*uiID*<br/>
在停駐管理員的識別碼。

### <a name="return-value"></a>傳回值

如果已成功載入停駐管理員狀態，則為 TRUE;否則為 FALSE。

##  <a name="lockupdate"></a>CDockingManager::LockUpdate

鎖定指定的視窗。

```
void LockUpdate(BOOL bLock);
```

### <a name="parameters"></a>參數

*總匯*<br/>
在如果視窗已鎖定，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當視窗已鎖定時，就無法移動它，也無法重新繪製。

##  <a name="m_bhidedockingbarsincontainermode"></a>CDockingManager：： m_bHideDockingBarsInContainerMode

指定停駐管理員是否隱藏 OLE 容器模式中的窗格。

```
AFX_IMPORT_DATA static BOOL m_bHideDockingBarsInContainerMode;
```

### <a name="remarks"></a>備註

如果您想要讓所有窗格在應用程式處於 OLE 容器模式時可見，請將此值設定為 [FALSE]。 根據預設，此值為 TRUE。

##  <a name="m_dockmodeglobal"></a>CDockingManager：： m_dockModeGlobal

指定全域銜接模式。

```
AFX_IMPORT_DATA static AFX_DOCK_TYPE m_dockModeGlobal;
```

### <a name="remarks"></a>備註

根據預設，每個停駐窗格都會使用此銜接模式。 如需此欄位可設定之值的詳細資訊，請參閱[CBasePane：： GetDockingMode](../../mfc/reference/cbasepane-class.md#getdockingmode)。

##  <a name="m_ndocksensitivity"></a>CDockingManager：： m_nDockSensitivity

指定停駐敏感度。

```
AFX_IMPORT_DATA static int m_nDockSensitivity;
```

### <a name="remarks"></a>備註

停駐敏感性會定義在架構將其狀態變更為停駐之前，浮動窗格如何接近停駐窗格、停駐網站或另一個窗格。

##  <a name="m_ntimeoutbeforedockingbardock"></a>CDockingManager：： m_nTimeOutBeforeDockingBarDock

指定停駐窗格停駐在立即銜接模式之前的時間（以毫秒為單位）。

```
static UINT m_nTimeOutBeforeDockingBarDock;
```

### <a name="remarks"></a>備註

在停駐窗格之前，架構會等待指定的時間長度。 這可避免在使用者仍在拖曳時，不小心停駐窗格到某個位置。

##  <a name="m_ntimeoutbeforetoolbardock"></a>CDockingManager：： m_nTimeOutBeforeToolBarDock

指定工具列停駐于主框架視窗之前的時間（以毫秒為單位）。

```
static UINT m_nTimeOutBeforeToolBarDock;
```

### <a name="remarks"></a>備註

在停駐工具列之前，架構會等待指定的時間長度。 這可防止工具列在使用者仍在拖曳時，不小心停駐到某個位置。

##  <a name="onactivateframe"></a>CDockingManager::OnActivateFrame

當框架視窗設為現用或停用時，由架構呼叫。

```
virtual void OnActivateFrame(BOOL bActivate);
```

### <a name="parameters"></a>參數

*bActivate*<br/>
在若為 TRUE，則框架視窗會變為作用中;如果為 FALSE，則表示框架視窗已停用。

##  <a name="onclosepopupmenu"></a>CDockingManager::OnClosePopupMenu

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```
void OnClosePopupMenu();
```

### <a name="remarks"></a>備註

架構即將關閉目前的主視窗時，會傳送 WM_DESTROY 訊息。 覆寫這個方法，以處理 `CMFCPopupMenu` 物件處理 WM_DESTROY 訊息時，屬於框架視窗 `CMFCPopupMenu` 物件的通知。

##  <a name="onmoveminiframe"></a>CDockingManager::OnMoveMiniFrame

由架構呼叫以移動迷你框架視窗。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
在迷你框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE;否則為 FALSE。

##  <a name="onpanecontextmenu"></a>CDockingManager::OnPaneCoNtextMenu

在建立具有窗格清單的功能表時，由架構呼叫。

```
void OnPaneContextMenu(CPoint point);
```

### <a name="parameters"></a>參數

*此處*<br/>
在指定功能表的位置。

##  <a name="panefrompoint"></a>CDockingManager：:P aneFromPoint

傳回包含指定點的窗格。

```
virtual CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar = false,
    CRuntimeClass* pRTCBarType = NULL,
    BOOL bCheckVisibility = FALSE,
    const CBasePane* pBarToIgnore = NULL) const;

virtual CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType = NULL,
    const CBasePane* pBarToIgnore = NULL) const;
```

### <a name="parameters"></a>參數

*此處*<br/>
在指定要檢查的點（以螢幕座標表示）。

*nSensitivity*<br/>
在要將每個已檢查窗格的視窗矩形擴大的值。 如果指定的點在此放大的區域中，則窗格會符合搜尋準則。

*bExactBar*<br/>
在TRUE 表示忽略*nSensitivity*參數;否則為 FALSE。

*pRTCBarType*<br/>
在如果不是 Null，此方法只會搜尋指定類型的窗格。

*bCheckVisibility*<br/>
在TRUE 表示只檢查可見窗格;否則為 FALSE。

*dwAlignment*<br/>
脫銷如果在指定的點找到窗格，此參數會包含最接近指定點之窗格的側邊。 如需詳細資訊，請參閱＜備註＞一節。

*pBarToIgnore*<br/>
在如果不是 Null，此方法會忽略此參數所指定的窗格。

### <a name="return-value"></a>傳回值

包含指定之點的[CBasePane](../../mfc/reference/cbasepane-class.md)衍生物件; 如果找不到任何窗格，則為 Null。

### <a name="remarks"></a>備註

當函式傳回並找到窗格時， *dwAlignment*會包含指定點的對齊方式。 例如，如果點最接近窗格頂端，則*dwAlignment*會設定為 CBRS_ALIGN_TOP。

##  <a name="processpanecontextmenucommand"></a>CDockingManager：:P rocessPaneCoNtextMenuCommand

由架構呼叫以選取或清除指定之命令的核取方塊，並重新計算所顯示窗格的版面配置。

```
BOOL ProcessPaneContextMenuCommand(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

*nID*<br/>
在功能表中控制列的識別碼。

*nCode*<br/>
在命令通知碼。

*pExtra*<br/>
在Void 的指標，如果*nCode* CN_UPDATE_COMMAND_UI，則會轉換到 `CCmdUI` 的指標。

*pHandlerInfo*<br/>
在Info 結構的指標。 不使用這個參數。

### <a name="return-value"></a>傳回值

如果*pEXtra*不是 Null，且*nCode*等於 CN_UPDATE_COMMAND_UI，或如果有具有指定之*nID*的控制列，則為 TRUE。

##  <a name="recalclayout"></a>CDockingManager：： RecalcLayout

重新計算控制項清單中所顯示控制項的內部配置。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

*bNotify*<br/>
在不使用這個參數。

##  <a name="releaseemptypanecontainers"></a>CDockingManager::ReleaseEmptyPaneContainers

釋放空的窗格容器。

```
void ReleaseEmptyPaneContainers();
```

##  <a name="removehiddenmditabbedbar"></a>CDockingManager::RemoveHiddenMDITabbedBar

移除指定的隱藏橫條窗格。

```
void RemoveHiddenMDITabbedBar(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
在要移除的橫條窗格指標。

##  <a name="removeminiframe"></a>CDockingManager::RemoveMiniFrame

從迷你框架清單中移除指定的框架。

```
virtual BOOL RemoveMiniFrame(CPaneFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在要移除之框架的指標。

### <a name="return-value"></a>傳回值

如果已移除指定的框架，則為 TRUE;否則為 FALSE。

##  <a name="removepanefromdockmanager"></a>CDockingManager::RemovePaneFromDockManager

取消註冊窗格，並將它從停駐管理員中的清單移除。

```
void RemovePaneFromDockManager(
    CBasePane* pWnd,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide = FALSE,
    CBasePane* pBarReplacement = NULL);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在要移除之窗格的指標。

*bDestroy*<br/>
在若為 TRUE，則會終結已移除的窗格。

*bAdjustLayout*<br/>
在若為 TRUE，請立即調整銜接配置。

*bAutoHide*<br/>
在若為 TRUE，則會從自動隱藏列清單中移除窗格。 如果為 FALSE，則會從一般窗格清單中移除窗格。

*pBarReplacement*<br/>
在取代已移除窗格之窗格的指標。

##  <a name="replacepane"></a>CDockingManager::ReplacePane

以一個窗格取代另一個。

```
BOOL ReplacePane(
    CDockablePane* pOriginalBar,
    CDockablePane* pNewBar);
```

### <a name="parameters"></a>參數

*pOriginalBar*<br/>
在原始窗格的指標。

*pNewBar*<br/>
在取代原始窗格之窗格的指標。

### <a name="return-value"></a>傳回值

如果已成功取代窗格，則為 TRUE;否則為 FALSE。

##  <a name="resortminiframesforzorder"></a>CDockingManager::ResortMiniFramesForZOrder

將小型框架清單中的框架化。

```
void ResortMiniFramesForZOrder();
```

##  <a name="savestate"></a>CDockingManager：： SaveState

將停駐管理員的狀態儲存至登錄。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName = NULL,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在登錄機碼的路徑。

*uiID*<br/>
在停駐管理員識別碼。

### <a name="return-value"></a>傳回值

如果已成功儲存狀態，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

將停駐管理員的狀態儲存至登錄，包括儲存控制列的狀態、自動隱藏列的狀態，以及停駐管理員中的迷你框架狀態。

##  <a name="sendmessagetominiframes"></a>CDockingManager::SendMessageToMiniFrames

將指定的訊息傳送至所有迷你框架。

```
BOOL SendMessageToMiniFrames(
    UINT uMessage,
    WPARAM wParam = 0,
    LPARAM lParam = 0);
```

### <a name="parameters"></a>參數

*uMessage*<br/>
在要傳送的訊息。

*wParam*<br/>
在其他訊息相關資訊。

*lParam*<br/>
在其他訊息相關資訊。

### <a name="return-value"></a>傳回值

TRUE 一律為。

##  <a name="serialize"></a>CDockingManager：：序列化

將停駐管理員寫入封存。

```
void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
在封存物件的參考。

### <a name="remarks"></a>備註

將停駐管理員寫入封存，包括決定停駐控制列和滑杆的數目，以及將控制列、迷你框架、自動隱藏列和 MDI 索引標籤式列寫入封存。

##  <a name="setautohidezorder"></a>CDockingManager::SetAutohideZOrder

設定控制列和指定窗格的大小、寬度和高度。

```
void SetAutohideZOrder(CDockablePane* pAHDockingBar);
```

### <a name="parameters"></a>參數

*pAHDockingBar*<br/>
在可停駐窗格的指標。

##  <a name="setdockingmode"></a>CDockingManager::SetDockingMode

設定銜接模式。

```
static void SetDockingMode(
    AFX_DOCK_TYPE dockMode,
    AFX_SMARTDOCK_THEME theme = AFX_SDT_DEFAULT);
```

### <a name="parameters"></a>參數

*dockMode*<br/>
指定新的銜接模式。 如需詳細資訊，請參閱＜備註＞一節。

*刪除主題*<br/>
指定要用於智慧停駐標記的主題。 它可以是下列其中一個列舉值： AFX_SDT_DEFAULT、AFX_SDT_VS2005 AFX_SDT_VS2008。

### <a name="remarks"></a>備註

呼叫此靜態方法以設定停駐模式。

*dockMode*可以是下列其中一個值：

- DT_STANDARD 標準銜接模式在 Visual Studio .NET 2003 中執行。 拖曳窗格時，不會拖曳內容。

- 在 Microsoft Visio 中執行的 DT_IMMEDIATE 立即銜接模式。 窗格是以拖曳內容進行拖放，但不會顯示任何標記。

- DT_SMART-在 Visual Studio 2005 中實行的智慧型銜接模式。 系統會使用拖曳內容來拖曳窗格，並顯示顯示窗格可停駐位置的智慧標籤。

##  <a name="setdockstate"></a>CDockingManager::SetDockState

設定控制列、迷你框架和自動隱藏列的停駐狀態。

```
virtual void SetDockState();
```

##  <a name="setprintpreviewmode"></a>CDockingManager::SetPrintPreviewMode

設定預覽列印中顯示的長條預覽列印模式。

```
void SetPrintPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

*bPreview*<br/>
在如果已設定預覽列印模式，則為 TRUE;否則為 FALSE。

*pState*<br/>
在預覽狀態的指標。 不使用這個參數。

##  <a name="setsmartdockingparams"></a>CDockingManager::SetSmartDockingParams

設定參數，以定義智慧銜接的行為。

```
static void SetSmartDockingParams(CSmartDockingInfo& params);
```

### <a name="parameters"></a>參數

*params*<br/>
[in、out]定義智慧停駐的參數。

### <a name="remarks"></a>備註

如果您想要自訂智慧停駐標記的外觀、色彩或形狀，請呼叫這個方法。

若要使用智慧停駐標記的預設尋找，請將未初始化的[CSmartDockingInfo 類別](../../mfc/reference/csmartdockinginfo-class.md)實例傳遞給*params*。

##  <a name="showdelayshowminiframes"></a>CDockingManager::ShowDelayShowMiniFrames

顯示或隱藏迷你框架的視窗。

```
void ShowDelayShowMiniFrames(BOOL bshow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在TRUE 表示讓顯示的框架視窗變成作用中;FALSE 表示隱藏框架的視窗。

##  <a name="showpanes"></a>CDockingManager::ShowPanes

顯示或隱藏 [控制項] 和 [自動隱藏] 橫條圖的窗格。

```
virtual BOOL ShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在TRUE 表示顯示窗格;FALSE 表示隱藏窗格。

### <a name="return-value"></a>傳回值

永遠為 FALSE。

##  <a name="startsdocking"></a>CDockingManager::StartSDocking

根據智慧停駐管理員的對齊，啟動指定之視窗的智慧停駐。

```
void StartSDocking(CWnd* pDockingWnd);
```

### <a name="parameters"></a>參數

*pDockingWnd*<br/>
在要停駐之視窗的指標。

##  <a name="stopsdocking"></a>CDockingManager::StopSDocking

停止智慧型銜接。

```
void StopSDocking();
```

##  <a name="getsmartdockingtheme"></a>CDockingManager::GetSmartDockingTheme

靜態方法，會傳回用來顯示智慧停駐標記的主題。

```
static AFX_SMARTDOCK_THEME __stdcall GetSmartDockingTheme();
```

### <a name="return-value"></a>傳回值

傳回下列其中一個列舉值： AFX_SDT_DEFAULT、AFX_SDT_VS2005 AFX_SDT_VS2008。

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CObject 類別](../../mfc/reference/cobject-class.md)<br/>
[CFrameWndEx 類別](../../mfc/reference/cframewndex-class.md)<br/>
[CDockablePane Class](../../mfc/reference/cdockablepane-class.md)<br/>
[CPaneFrameWnd 類別](../../mfc/reference/cpaneframewnd-class.md)
