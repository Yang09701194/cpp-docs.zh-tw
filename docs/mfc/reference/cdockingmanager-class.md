---
title: CDockingManager 類別
ms.date: 11/04/2016
f1_keywords:
- CDockingManager
- AFXDOCKINGMANAGER/CDockingManager
- AFXDOCKINGMANAGER/CDockingManager::AddDockSite
- AFXDOCKINGMANAGER/CDockingManager::AddHiddenMDITabbedBar
- AFXDOCKINGMANAGER/CDockingManager::AddMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::AddPane
- AFXDOCKINGMANAGER/CDockingManager::AdjustDockingLayout
- AFXDOCKINGMANAGER/CDockingManager::AdjustPaneFrames
- AFXDOCKINGMANAGER/CDockingManager::AdjustRectToClientArea
- AFXDOCKINGMANAGER/CDockingManager::AlignAutoHidePane
- AFXDOCKINGMANAGER/CDockingManager::AutoHidePane
- AFXDOCKINGMANAGER/CDockingManager::BringBarsToTop
- AFXDOCKINGMANAGER/CDockingManager::BuildPanesMenu
- AFXDOCKINGMANAGER/CDockingManager::CalcExpectedDockedRect
- AFXDOCKINGMANAGER/CDockingManager::Create
- AFXDOCKINGMANAGER/CDockingManager::DeterminePaneAndStatus
- AFXDOCKINGMANAGER/CDockingManager::DisableRestoreDockState
- AFXDOCKINGMANAGER/CDockingManager::DockPane
- AFXDOCKINGMANAGER/CDockingManager::DockPaneLeftOf
- AFXDOCKINGMANAGER/CDockingManager::EnableAutoHidePanes
- AFXDOCKINGMANAGER/CDockingManager::EnableDocking
- AFXDOCKINGMANAGER/CDockingManager::EnableDockSiteMenu
- AFXDOCKINGMANAGER/CDockingManager::EnablePaneContextMenu
- AFXDOCKINGMANAGER/CDockingManager::FindDockSite
- AFXDOCKINGMANAGER/CDockingManager::FindDockSiteByPane
- AFXDOCKINGMANAGER/CDockingManager::FindPaneByID
- AFXDOCKINGMANAGER/CDockingManager::FixupVirtualRects
- AFXDOCKINGMANAGER/CDockingManager::FrameFromPoint
- AFXDOCKINGMANAGER/CDockingManager::GetClientAreaBounds
- AFXDOCKINGMANAGER/CDockingManager::GetDockingMode
- AFXDOCKINGMANAGER/CDockingManager::GetDockSiteFrameWnd
- AFXDOCKINGMANAGER/CDockingManager::GetEnabledAutoHideAlignment
- AFXDOCKINGMANAGER/CDockingManager::GetMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::GetOuterEdgeBounds
- AFXDOCKINGMANAGER/CDockingManager::GetPaneList
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingManager
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingManagerPermanent
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingParams
- AFXDOCKINGMANAGER/CDockingManager::GetSmartDockingTheme
- AFXDOCKINGMANAGER/CDockingManager::HideAutoHidePanes
- AFXDOCKINGMANAGER/CDockingManager::InsertDockSite
- AFXDOCKINGMANAGER/CDockingManager::InsertPane
- AFXDOCKINGMANAGER/CDockingManager::IsDockSiteMenu
- AFXDOCKINGMANAGER/CDockingManager::IsInAdjustLayout
- AFXDOCKINGMANAGER/CDockingManager::IsOLEContainerMode
- AFXDOCKINGMANAGER/CDockingManager::IsPointNearDockSite
- AFXDOCKINGMANAGER/CDockingManager::IsPrintPreviewValid
- AFXDOCKINGMANAGER/CDockingManager::LoadState
- AFXDOCKINGMANAGER/CDockingManager::LockUpdate
- AFXDOCKINGMANAGER/CDockingManager::OnActivateFrame
- AFXDOCKINGMANAGER/CDockingManager::OnClosePopupMenu
- AFXDOCKINGMANAGER/CDockingManager::OnMoveMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::OnPaneContextMenu
- AFXDOCKINGMANAGER/CDockingManager::PaneFromPoint
- AFXDOCKINGMANAGER/CDockingManager::ProcessPaneContextMenuCommand
- AFXDOCKINGMANAGER/CDockingManager::RecalcLayout
- AFXDOCKINGMANAGER/CDockingManager::ReleaseEmptyPaneContainers
- AFXDOCKINGMANAGER/CDockingManager::RemoveHiddenMDITabbedBar
- AFXDOCKINGMANAGER/CDockingManager::RemoveMiniFrame
- AFXDOCKINGMANAGER/CDockingManager::RemovePaneFromDockManager
- AFXDOCKINGMANAGER/CDockingManager::ReplacePane
- AFXDOCKINGMANAGER/CDockingManager::ResortMiniFramesForZOrder
- AFXDOCKINGMANAGER/CDockingManager::SaveState
- AFXDOCKINGMANAGER/CDockingManager::SendMessageToMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::Serialize
- AFXDOCKINGMANAGER/CDockingManager::SetAutohideZOrder
- AFXDOCKINGMANAGER/CDockingManager::SetDockingMode
- AFXDOCKINGMANAGER/CDockingManager::SetDockState
- AFXDOCKINGMANAGER/CDockingManager::SetPrintPreviewMode
- AFXDOCKINGMANAGER/CDockingManager::SetSmartDockingParams
- AFXDOCKINGMANAGER/CDockingManager::ShowDelayShowMiniFrames
- AFXDOCKINGMANAGER/CDockingManager::ShowPanes
- AFXDOCKINGMANAGER/CDockingManager::StartSDocking
- AFXDOCKINGMANAGER/CDockingManager::StopSDocking
- AFXDOCKINGMANAGER/CDockingManager::m_bHideDockingBarsInContainerMode
- AFXDOCKINGMANAGER/CDockingManager::m_dockModeGlobal
- AFXDOCKINGMANAGER/CDockingManager::m_nDockSensitivity
- AFXDOCKINGMANAGER/CDockingManager::m_nTimeOutBeforeDockingBarDock
- AFXDOCKINGMANAGER/CDockingManager::m_nTimeOutBeforeToolBarDock
helpviewer_keywords:
- CDockingManager [MFC], AddDockSite
- CDockingManager [MFC], AddHiddenMDITabbedBar
- CDockingManager [MFC], AddMiniFrame
- CDockingManager [MFC], AddPane
- CDockingManager [MFC], AdjustDockingLayout
- CDockingManager [MFC], AdjustPaneFrames
- CDockingManager [MFC], AdjustRectToClientArea
- CDockingManager [MFC], AlignAutoHidePane
- CDockingManager [MFC], AutoHidePane
- CDockingManager [MFC], BringBarsToTop
- CDockingManager [MFC], BuildPanesMenu
- CDockingManager [MFC], CalcExpectedDockedRect
- CDockingManager [MFC], Create
- CDockingManager [MFC], DeterminePaneAndStatus
- CDockingManager [MFC], DisableRestoreDockState
- CDockingManager [MFC], DockPane
- CDockingManager [MFC], DockPaneLeftOf
- CDockingManager [MFC], EnableAutoHidePanes
- CDockingManager [MFC], EnableDocking
- CDockingManager [MFC], EnableDockSiteMenu
- CDockingManager [MFC], EnablePaneContextMenu
- CDockingManager [MFC], FindDockSite
- CDockingManager [MFC], FindDockSiteByPane
- CDockingManager [MFC], FindPaneByID
- CDockingManager [MFC], FixupVirtualRects
- CDockingManager [MFC], FrameFromPoint
- CDockingManager [MFC], GetClientAreaBounds
- CDockingManager [MFC], GetDockingMode
- CDockingManager [MFC], GetDockSiteFrameWnd
- CDockingManager [MFC], GetEnabledAutoHideAlignment
- CDockingManager [MFC], GetMiniFrames
- CDockingManager [MFC], GetOuterEdgeBounds
- CDockingManager [MFC], GetPaneList
- CDockingManager [MFC], GetSmartDockingManager
- CDockingManager [MFC], GetSmartDockingManagerPermanent
- CDockingManager [MFC], GetSmartDockingParams
- CDockingManager [MFC], GetSmartDockingTheme
- CDockingManager [MFC], HideAutoHidePanes
- CDockingManager [MFC], InsertDockSite
- CDockingManager [MFC], InsertPane
- CDockingManager [MFC], IsDockSiteMenu
- CDockingManager [MFC], IsInAdjustLayout
- CDockingManager [MFC], IsOLEContainerMode
- CDockingManager [MFC], IsPointNearDockSite
- CDockingManager [MFC], IsPrintPreviewValid
- CDockingManager [MFC], LoadState
- CDockingManager [MFC], LockUpdate
- CDockingManager [MFC], OnActivateFrame
- CDockingManager [MFC], OnClosePopupMenu
- CDockingManager [MFC], OnMoveMiniFrame
- CDockingManager [MFC], OnPaneContextMenu
- CDockingManager [MFC], PaneFromPoint
- CDockingManager [MFC], ProcessPaneContextMenuCommand
- CDockingManager [MFC], RecalcLayout
- CDockingManager [MFC], ReleaseEmptyPaneContainers
- CDockingManager [MFC], RemoveHiddenMDITabbedBar
- CDockingManager [MFC], RemoveMiniFrame
- CDockingManager [MFC], RemovePaneFromDockManager
- CDockingManager [MFC], ReplacePane
- CDockingManager [MFC], ResortMiniFramesForZOrder
- CDockingManager [MFC], SaveState
- CDockingManager [MFC], SendMessageToMiniFrames
- CDockingManager [MFC], Serialize
- CDockingManager [MFC], SetAutohideZOrder
- CDockingManager [MFC], SetDockingMode
- CDockingManager [MFC], SetDockState
- CDockingManager [MFC], SetPrintPreviewMode
- CDockingManager [MFC], SetSmartDockingParams
- CDockingManager [MFC], ShowDelayShowMiniFrames
- CDockingManager [MFC], ShowPanes
- CDockingManager [MFC], StartSDocking
- CDockingManager [MFC], StopSDocking
- CDockingManager [MFC], m_bHideDockingBarsInContainerMode
- CDockingManager [MFC], m_dockModeGlobal
- CDockingManager [MFC], m_nDockSensitivity
- CDockingManager [MFC], m_nTimeOutBeforeDockingBarDock
- CDockingManager [MFC], m_nTimeOutBeforeToolBarDock
ms.assetid: 98e69c43-55d8-4f43-b861-4fda80ec1e32
ms.openlocfilehash: 76fd12b0817c99d0d08327f9d9156eadf3559dc5
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753320"
---
# <a name="cdockingmanager-class"></a>CDockingManager 類別

實作控制配置停駐於主框架視窗中的核心功能。

## <a name="syntax"></a>語法

```
class CDockingManager : public CObject
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CDocking 管理員::新增Dock網站](#adddocksite)|建立停靠窗格並將其添加到控制欄清單中。|
|[CDocking管理員::添加隱藏MDITabbedbar](#addhiddenmditabbedbar)|將句柄添加到欄窗格到隱藏的 MDI 選項卡欄窗格清單中。|
|[CDocking 管理員::添加Mini框架](#addminiframe)|將框架添加到迷你框架清單中。|
|[CDocking 管理員::新增窗格](#addpane)|向停靠管理器註冊窗格。|
|[CDocking管理員::調整停靠佈局](#adjustdockinglayout)|重新計算和調整框架視窗中所有窗格的佈局。|
|[CDocking 管理員::調整窗格框架](#adjustpaneframes)|使WM_NCCALCSIZE消息發送到所有窗格和`CPaneFrameWnd`視窗。|
|[Cdocking 管理員:調整到客戶端區域](#adjustrecttoclientarea)|調整矩形的對齊方式。|
|[CDocking 管理員:對齊自動隱藏窗格](#alignautohidepane)|在自動隱藏模式下調整停靠窗格的大小,以便它佔用幀的工作區的全寬或高度,並包圍停靠網站。|
|[CDocking 管理員:自動隱藏窗格](#autohidepane)|建立自動隱藏工具列。|
|[CDocking管理員::帶巴斯托托](#bringbarstotop)|將具有指定對齊的停靠條帶到頂部。|
|[CDocking 管理員::編譯窗格選單](#buildpanesmenu)|將停靠窗格和工具列的名稱添加到功能表中。|
|[CDocking 管理員::Calc預期多克已重新](#calcexpecteddockedrect)|計算停靠視窗的預期矩形。|
|[CDocking 管理員:建立](#create)|建立停靠管理器。|
|[CDocking管理員::D](#determinepaneandstatus)|確定包含給定點的窗格及其停靠狀態。|
|[CDocking管理員::D可還原DockDockState](#disablerestoredockstate)|啟用或禁用從註冊表載入停靠佈局。|
|[CDocking管理員::DockPane](#dockpane)|將窗格停靠到另一個窗格或框架視窗。|
|[對接管理器::D奧克帕內左](#dockpaneleftof)|將窗格停駐於另一個窗格的左邊。|
|[CDocking 管理員:開啟自動隱藏窗格](#enableautohidepanes)|啟用窗格與主框架的停靠,創建停靠窗格,並將其添加到控制欄清單中。|
|[CDocking 管理員:啟用對接](#enabledocking)|創建停靠窗格,並使窗格與主框架對接。|
|[CDocking 管理員:啟用DockSite功能表](#enabledocksitemenu)|顯示一個附加按鈕,該按鈕在所有停靠窗格的標題上打開一個彈出式功能表。|
|[CDocking 管理員::啟用窗格上下文選單](#enablepanecontextmenu)|告訴庫顯示一個特殊的上下文菜單,該功能表具有應用程式工具列和停靠窗格的清單,當使用者單擊滑鼠右鍵並且庫正在處理WM_CONTEXTMENU消息時。|
|[CDocking管理員::尋找DockSite](#finddocksite)|檢索位於指定位置且具有指定對齊方式的條形窗格。|
|[CDocking管理員::尋找DocksitebyPane](#finddocksitebypane)|返回具有目標欄窗格 ID 的條形窗格。|
|[CDocking管理員::查找PaneByID](#findpanebyid)|依指定的控制項識別碼識別碼。|
|[CDocking 管理員:修復虛擬重新](#fixupvirtualrects)|將所有當前工具列位置提交到虛擬矩形。|
|[CDocking管理員::從點幀](#framefrompoint)|返回包含給定點的幀。|
|[CDocking 管理員:取得客戶區域繫結](#getclientareabounds)|獲取包含工作區邊界的矩形。|
|[CDocking 管理員:取得對接模式](#getdockingmode)|返回當前停靠模式。|
|[CDocking管理員::獲取DockSiteFramewnd](#getdocksiteframewnd)|獲取指向父視窗框架的指標。|
|[Cdocking 管理員:啟用自動隱藏對齊](#getenabledautohidealignment)|返回窗格的啟用對齊方式。|
|[CDocking 管理員:取得迷你框架](#getminiframes)|獲取微型幀清單。|
|[CDocking 管理員:取得外部邊緣繫結](#getouteredgebounds)|獲取包含框架外邊緣的矩形。|
|[CDocking 管理員:抓取窗格清單](#getpanelist)|返回屬於停靠管理器的窗格清單。 這包括所有浮動窗格。|
|[CDocking 管理員:取得智慧擴充管理員](#getsmartdockingmanager)|檢索指向智慧停靠管理器的指標。|
|[CDocking 管理員:取得智慧擴充管理員永久](#getsmartdockingmanagerpermanent)|檢索指向智慧停靠管理器的指標。|
|[CDocking 管理員:取得智慧對接參數](#getsmartdockingparams)|返回停靠管理器的智慧停靠參數。|
|[CDocking管理員:取得智慧對接主題](#getsmartdockingtheme)|返回用於顯示智慧停靠標記的主題的靜態方法。|
|[CDocking 管理員:隱藏自動隱藏窗格](#hideautohidepanes)|隱藏處於自動隱藏模式的窗格。|
|[CDocking 管理員::插入DockSite](#insertdocksite)|建立停靠窗格並將其插入控制欄清單。|
|[CDocking 管理員:插入窗格](#insertpane)|將控制窗格插入控制欄清單中。|
|[CDocking管理員::IsDockSiteMenu](#isdocksitemenu)|指定彈出選單是否顯示在所有窗格的標題上。|
|[Cdocking 管理員:正在調整佈局](#isinadjustlayout)|確定是否調整了所有窗格的佈局。|
|[CDocking 管理員:isOLE容器模式](#isolecontainermode)|指定停靠管理器是否處於 OLE 容器模式。|
|[CDocking管理員::IsPointNearDockSite](#ispointneardocksite)|確定指定點是否靠近停靠網站。|
|[CDocking 管理員::正在列印預覽有效](#isprintpreviewvalid)|確定是否設置了列印預覽模式。|
|[CDocking 管理員:載入狀態](#loadstate)|從註冊表載入停靠管理器的狀態。|
|[CDocking 管理員:鎖更新](#lockupdate)|鎖定給定的視窗。|
|[CDocking管理員:在啟動幀上](#onactivateframe)|當框架視窗變為活動或停用時,由框架調用。|
|[CDocking管理員::上接合彈出選單](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[Cdocking管理員:在移動迷你框架](#onmoveminiframe)|由框架調用以移動微型框架視窗。|
|[Cdocking管理員::在窗格上下文選單](#onpanecontextmenu)|當框架生成包含窗格列表的功能表時,由框架調用。|
|[CDocking管理員::P從點](#panefrompoint)|返回包含給定點的窗格。|
|[CDocking管理員::ProcessPane上下文菜單命令](#processpanecontextmenucommand)|由框架呼叫以選擇或清除指定命令的複選框,並重新計算顯示的窗格的佈局。|
|[CDocking管理員:Recalclayout](#recalclayout)|重新計算控制清單中存在的控制項的內部佈局。|
|[CDocking 管理員::釋放空窗格容器](#releaseemptypanecontainers)|釋放空窗格容器。|
|[CDocking 管理員::刪除隱藏 MDITabbedbar](#removehiddenmditabbedbar)|刪除指定的隱藏欄窗格。|
|[CDocking 管理員:刪除Mini框架](#removeminiframe)|從迷你框架清單中刪除指定的幀。|
|[CDockManager:從Dock管理員中移除窗格](#removepanefromdockmanager)|取消註冊窗格並將其從停靠管理器中的清單中刪除。|
|[CDocking 管理員:取代窗格](#replacepane)|以一個窗格取代另一個。|
|[CDocking管理員::度假村迷你框架為ZOrder](#resortminiframesforzorder)|在迷你幀清單中對幀進行設置。|
|[CDocking 管理員::儲存狀態](#savestate)|將停靠管理器的狀態保存到註冊表。|
|[CDocking管理員::發送消息到微型幀](#sendmessagetominiframes)|將指定的消息發送到所有微型幀。|
|[CDocking 管理員:序列化](#serialize)|將停靠管理器寫入存檔。 (覆寫 [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)。)|
|[CDocking 管理員:設定自動隱藏順序](#setautohidezorder)|設置控制列和指定窗格的大小、寬度和高度。|
|[CDocking 管理員:設定對接模式](#setdockingmode)|設置停靠模式。|
|[CDocking管理員::SetDockState](#setdockstate)|設置控制欄、微型框架和自動隱藏欄的停靠狀態。|
|[CDocking 管理員::設定列印預覽模式](#setprintpreviewmode)|設置列印預覽中顯示的條形圖的列印預覽模式。|
|[CDocking管理員:設定智慧對接參數](#setsmartdockingparams)|設置定義智慧停靠行為的參數。|
|[CDocking 管理員::顯示延遲顯示迷你幀](#showdelayshowminiframes)|顯示或隱藏微型框架的視窗。|
|[CDocking管理員::顯示窗格](#showpanes)|顯示或隱藏控制器和自動隱藏列的窗格。|
|[CDocking管理員:開始對接](#startsdocking)|根據智慧對接管理器的對齊方式啟動指定窗口的智慧停靠。|
|[CDocking管理員:停止對接](#stopsdocking)|停止智慧停靠。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CDocking管理員:m_bHideDockingBarsInContainerMode](#m_bhidedockingbarsincontainermode)|指定停靠管理員是否在 OLE 容器模式下隱藏窗格。|
|[CDocking管理員::m_dockModeGlobal](#m_dockmodeglobal)|指定全域停靠模式。|
|[CDocking管理員::m_nDockSensitivity](#m_ndocksensitivity)|指定停靠靈敏度。|
|[CDocking管理員::m_nTimeOutBeforeDockingBarDock](#m_ntimeoutbeforedockingbardock)|指定停靠窗格在直接停靠模式下停靠之前的時間(以毫秒為單位)。|
|[CDocking管理員:m_nTimeOutBeforeToolBarDock](#m_ntimeoutbeforetoolbardock)|指定工具列停靠到主框架視窗之前的時間(以毫秒為單位)。|

## <a name="remarks"></a>備註

主框架視窗會自動創建並初始化此類。

停靠管理器物件包含停靠佈局中所有窗格的清單,以及屬於主框架視窗的所有[CPaneFrameWnd](../../mfc/reference/cpaneframewnd-class.md)視窗的清單。

類`CDockingManager`實現一些服務,可用於查找窗格`CPaneFrameWnd`或 視窗。 通常不直接調用這些服務,因為它們包裝在主框架視窗物件中。 有關詳細資訊,請參閱[CPaneFramewnd 類別](../../mfc/reference/cpaneframewnd-class.md)。

## <a name="customization-tips"></a>自訂秘訣

以下提示適用於`CDockingManager`物件:

- [CDockingManager 類別](../../mfc/reference/cdockingmanager-class.md)支援以下停靠模式:

  - `AFX_DOCK_TYPE::DT_IMMEDIATE`

  - `AFX_DOCK_TYPE::DT_STANDARD`

  - `AFX_DOCK_TYPE::DT_SMART`

  這些停靠模式由[CDockingManager:::m_dockModeGlobal](#m_dockmodeglobal)定義,並通過調用[CDockingManager::setDockingMode](#setdockingmode)進行設置。

- 如果要創建非浮動、不可調整大小的窗格,請調用[CDockingManager::AddPane](#addpane)方法。 此方法將窗格註冊到負責窗格佈局的停靠管理器。

## <a name="example"></a>範例

下面的範例展示如何在`CDockingManager`類中使用各種方法來配置`CDockingManager`物件。 該示例演示如何在所有停靠窗格的標題上顯示打開彈出功能表的其他按鈕,以及如何設置物件的停靠模式。 此代碼段是[可視化工作室演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_VisualStudioDemo#24](../../mfc/codesnippet/cpp/cdockingmanager-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CDockingManager](../../mfc/reference/cdockingmanager-class.md)

## <a name="requirements"></a>需求

**標題:** afxDockingManager.h

## <a name="cdockingmanageradddocksite"></a><a name="adddocksite"></a>CDocking 管理員::新增Dock網站

建立停靠窗格並將其添加到控制欄清單中。

```
BOOL AddDockSite(
    const AFX_DOCKSITE_INFO& info,
    CDockSite** ppDockBar = NULL);
```

### <a name="parameters"></a>參數

*資訊*<br/>
[在]對包含停靠窗格對齊的資訊結構的引用。

*ppDockBar*<br/>
[出]指向指向新停靠窗格的指標。

### <a name="return-value"></a>傳回值

如果成功創建了停靠窗格,則為 TRUE;如果成功創建了停靠窗格,則為 TRUE。否則。

## <a name="cdockingmanageraddhiddenmditabbedbar"></a><a name="addhiddenmditabbedbar"></a>CDocking管理員::添加隱藏MDITabbedbar

將句柄添加到欄窗格到隱藏的 MDI 選項卡欄窗格清單中。

```cpp
void AddHiddenMDITabbedBar(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向條形窗格的指標

## <a name="cdockingmanageraddpane"></a><a name="addpane"></a>CDocking 管理員::新增窗格

向停靠管理器註冊窗格。

```
BOOL AddPane(
    CBasePane* pWnd,
    BOOL bTail = TRUE,
    BOOL bAutoHide = FALSE,
    BOOL bInsertForOuterEdge = FALSE);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[進出]指定要加入到停靠管理員的窗格。

*b泰爾*<br/>
[在]TRUE將窗格添加到停靠管理器的窗格列表的末尾;否則,FALSE。

*bAutoHide*<br/>
[在]僅供內部使用。 始終使用預設值 FALSE。

*b 插入外邊緣*<br/>
[在]僅供內部使用。 始終使用預設值 FALSE。

### <a name="return-value"></a>傳回值

如果窗格已成功註冊到停靠管理器,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

調用此方法與停靠管理器註冊非浮動、不可調整大小的窗格。 如果不註冊窗格,則在佈局停靠管理器時,窗格將不會正確顯示。

## <a name="cdockingmanageradjustdockinglayout"></a><a name="adjustdockinglayout"></a>CDocking管理員::調整停靠佈局

重新計算和調整框架視窗中所有窗格的佈局。

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### <a name="parameters"></a>參數

*hdwp*<br/>
[在]指定延遲的視窗位置結構。 如需詳細資訊，請參閱 [Windows 資料類型](/windows/win32/WinProg/windows-data-types)。

### <a name="remarks"></a>備註

## <a name="cdockingmanageraddminiframe"></a><a name="addminiframe"></a>CDocking 管理員::添加Mini框架

將框架添加到迷你框架清單中。

```
virtual BOOL AddMiniFrame(CPaneFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向幀的指標。

### <a name="return-value"></a>傳回值

如果幀不在微型幀清單中並已成功添加,則為 TRUE;否則。

## <a name="cdockingmanageradjustpaneframes"></a><a name="adjustpaneframes"></a>CDocking 管理員::調整窗格框架

使WM_NCCALCSIZE消息發送到所有窗格和`CPaneFrameWnd`視窗。

```
virtual void AdjustPaneFrames();
```

### <a name="remarks"></a>備註

## <a name="cdockingmanageradjustrecttoclientarea"></a><a name="adjustrecttoclientarea"></a>Cdocking 管理員:調整到客戶端區域

調整矩形的對齊方式。

```
virtual BOOL AdjustRectToClientArea(
    CRect& rectResult,
    DWORD dwAlignment);
```

### <a name="parameters"></a>參數

*rectResult*<br/>
[在]對物件的參考`CRect`

*dwalignment*<br/>
[在]`CRect`物件的對齊方式

### <a name="return-value"></a>傳回值

如果調整了物件的對齊方式,`CRect`則為 TRUE;否則。

### <a name="remarks"></a>備註

*dwalignment*參數可以具有以下值之一:

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

## <a name="cdockingmanageralignautohidepane"></a><a name="alignautohidepane"></a>CDocking 管理員:對齊自動隱藏窗格

在自動隱藏模式下調整停靠窗格的大小,以便它佔用幀的工作區的全寬或高度,並包圍停靠網站。

```cpp
void AlignAutoHidePane(
    CPaneDivider* pDefaultSlider,
    BOOL bIsVisible = TRUE);
```

### <a name="parameters"></a>參數

*p 預設滑動*<br/>
[在]停靠滑塊窗格。

*b 可見*<br/>
[在]如果停靠窗格可見,則為 TRUE;如果停靠窗格可見,則為 TRUE。否則。

## <a name="cdockingmanagerautohidepane"></a><a name="autohidepane"></a>CDocking 管理員:自動隱藏窗格

建立自動隱藏工具列。

```
CMFCAutoHideToolBar* AutoHidePane(
    CDockablePane* pBar,
    CMFCAutoHideToolBar* pCurrAutoHideToolBar = NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向條形窗格的指標。

*pCurrAutoHideTool工具列*<br/>
[在]指向自動隱藏工具列的指標。

### <a name="return-value"></a>傳回值

如果未建立自動隱藏工具列,則為 NULL;如果未建立自動隱藏工具列,則為 NULL。否則指向新工具列的指標。

## <a name="cdockingmanagerbringbarstotop"></a><a name="bringbarstotop"></a>CDocking管理員::帶巴斯托托

將具有指定對齊的停靠條帶到頂部。

```cpp
void BringBarsToTop(
    DWORD dwAlignment = 0,
    BOOL bExcludeDockedBars = TRUE);
```

### <a name="parameters"></a>參數

*dwalignment*<br/>
[在]帶到其他窗口頂部的停靠條的對齊方式。

*b 排除已停靠條形*<br/>
[在]TRUE 以排除停靠的條形圖位於頂部;否則 FALSE。

## <a name="cdockingmanagerbuildpanesmenu"></a><a name="buildpanesmenu"></a>CDocking 管理員::編譯窗格選單

將停靠窗格和工具列的名稱添加到功能表中。

```cpp
void BuildPanesMenu(
    CMenu& menu,
    BOOL bToolbarsOnly);
```

### <a name="parameters"></a>參數

*選單*<br/>
[在]要向其添加停靠窗格和工具列名稱的功能表。

*b工具列*<br/>
[在]TRUE 僅向功能表添加工具列名稱;否則。

## <a name="cdockingmanagercalcexpecteddockedrect"></a><a name="calcexpecteddockedrect"></a>CDocking 管理員::Calc預期多克已重新

計算停靠視窗的預期矩形。

```cpp
void CalcExpectedDockedRect(
    CWnd* pWnd,
    CPoint ptMouse,
    CRect& rectResult,
    BOOL& bDrawTab,
    CDockablePane** ppTargetBar);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向要停靠的視窗的指標。

*ptMouse*<br/>
[在]滑鼠位置。

*rectResult*<br/>
[出]計算的矩形。

*bDrawTab*<br/>
[在]TRUE 以繪製選項卡;否則 FALSE。

*ppTargetBar*<br/>
[出]指向目標窗格的指標。

### <a name="remarks"></a>備註

此方法計算當使用者將視窗拖曳到*ptMouse*指定的點並將其停靠在那裡時,視窗將佔用的矩形。

## <a name="cdockingmanagercreate"></a><a name="create"></a>CDocking 管理員:建立

建立停靠管理器。

```
BOOL Create(CFrameWnd* pParentWnd);
```

### <a name="parameters"></a>參數

*pparentwnd*<br/>
[在]指向停靠管理器的父幀的指標。 此值不能為 NULL。

### <a name="return-value"></a>傳回值

永遠真實。

## <a name="cdockingmanagerdeterminepaneandstatus"></a><a name="determinepaneandstatus"></a>CDocking管理員::D

確定包含給定點的窗格及其停靠狀態。

```
virtual AFX_CS_STATUS DeterminePaneAndStatus(
    CPoint pt,
    int nSensitivity,
    DWORD dwEnabledAlignment,
    CBasePane** ppTargetBar,
    const CBasePane* pBarToIgnore,
    const CBasePane* pBarToDock);
```

### <a name="parameters"></a>參數

*pt*<br/>
[在]要檢查的窗格的位置。

*nSensitivity*<br/>
[在]要增加每個選中窗格的視窗矩形的值。 如果給定點位於此增加的區域中,則窗格滿足搜索條件。

*開啟對齊*<br/>
[在]停靠窗格的對齊方式。

*ppTargetBar*<br/>
[出]指向目標窗格的指標。

*pBartoignore*<br/>
[在]該方法忽略的窗格。

*pBartodock*<br/>
[在]停靠的窗格。

### <a name="return-value"></a>傳回值

停靠狀態。

### <a name="remarks"></a>備註

停靠狀態可以是以下值之一:

|AFX_CS_STATUS值|意義|
|---------------------------|-------------|
|CS_NOTHING|指標不在停靠網站上。 因此,保持窗格浮動。|
|CS_DOCK_IMMEDIATELY|指標在即立模式下位於停靠網站上(DT_IMMEDIATE樣式已啟用),因此必須立即停靠窗格。|
|CS_DELAY_DOCK|指標位於另一個停靠窗格或主框架的邊緣的停靠網站上。|
|CS_DELAY_DOCK_TO_TAB|指標位於停靠網站上,該網站會導致窗格停靠在選項卡式視窗中。 當滑鼠位於另一個停靠窗格的標題上或選項卡式窗格的選項卡區域上時,將發生這種情況。|

## <a name="cdockingmanagerdisablerestoredockstate"></a><a name="disablerestoredockstate"></a>CDocking管理員::D可還原DockDockState

啟用或禁用從註冊表載入停靠佈局。

```cpp
void DisableRestoreDockState(BOOL bDisable = TRUE);
```

### <a name="parameters"></a>參數

*b停用*<br/>
[在]TRUE 禁用從註冊表載入停靠佈局;否則,FALSE。

### <a name="remarks"></a>備註

在載入應用程式狀態時必須保留停靠窗格和工具列的當前佈局時,請呼叫此方法。

## <a name="cdockingmanagerdockpane"></a><a name="dockpane"></a>CDocking管理員::DockPane

將窗格停靠到另一個窗格或框架視窗。

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要停靠的條形窗格的指標。

*nDockBarID*<br/>
[在]要停靠的條形的 ID。

*lpRect*<br/>
[在]目標矩形。

## <a name="cdockingmanagerdockpaneleftof"></a><a name="dockpaneleftof"></a>對接管理器::D奧克帕內左

將窗格停駐於另一個窗格的左邊。

```
BOOL DockPaneLeftOf(
    CPane* pBarToDock,
    CPane* pTargetBar);
```

### <a name="parameters"></a>參數

*pBartodock*<br/>
[在]指向要停靠在*pTargetBar*左側的窗格的指標。

*p 目標列*<br/>
[在]指向目標窗格的指標。

### <a name="return-value"></a>傳回值

如果窗格已成功停靠,則為 TRUE;如果窗格已成功停靠。否則,FALSE。

## <a name="cdockingmanagerenableautohidepanes"></a><a name="enableautohidepanes"></a>CDocking 管理員:開啟自動隱藏窗格

啟用窗格與主框架的停靠,創建停靠窗格,並將其添加到控制欄清單中。

```
BOOL EnableAutoHidePanes(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
[在]停靠對齊。

### <a name="return-value"></a>傳回值

如果成功創建了停靠窗格,則為 TRUE;如果成功創建了停靠窗格,則為 TRUE。否則。

## <a name="cdockingmanagerenabledocking"></a><a name="enabledocking"></a>CDocking 管理員:啟用對接

創建停靠窗格,並使窗格與主框架對接。

```
BOOL EnableDocking(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
[在]停靠對齊。

### <a name="return-value"></a>傳回值

如果成功創建了停靠窗格,則為 TRUE;如果成功創建了停靠窗格,則為 TRUE。否則。

## <a name="cdockingmanagerenabledocksitemenu"></a><a name="enabledocksitemenu"></a>CDocking 管理員:啟用DockSite功能表

顯示一個附加按鈕,該按鈕在所有停靠窗格的標題上打開一個彈出式功能表。

```
static void EnableDockSiteMenu(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用停靠網站功能功能表;否則,FALSE。

### <a name="remarks"></a>備註

停靠網站選單顯示以下選項,用於更改窗格的停靠狀態:

- `Floating`- 浮動窗格

- `Docking`- 將窗格停在窗格上一次停靠的位置的主框架上

- `AutoHide`- 將窗格切換到自動隱藏模式

- `Hide`- 隱藏窗格

預設情況下,不顯示此功能表。

## <a name="cdockingmanagerenablepanecontextmenu"></a><a name="enablepanecontextmenu"></a>CDocking 管理員::啟用窗格上下文選單

告訴庫顯示一個特殊的上下文菜單,該功能表具有應用程式工具列和停靠窗格的清單,當使用者單擊滑鼠右鍵並且庫正在處理WM_CONTEXTMENU消息時。

```cpp
void EnablePaneContextMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bToolbarsOnly = FALSE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]如果為 TRUE,庫將打開對自動上下文菜單的支援;如果為 TRUE,則庫將打開對自動上下文菜單的支援。如果 FALSE 庫關閉對自動上下文功能表的支援。

*ui 客製化Cmd*<br/>
[在]選單中 **「自定義**」項的命令 ID。

*str定製文字*<br/>
[在]**自定義**項的文本。

*b工具列*<br/>
[在]如果為 TRUE,則功能表僅顯示應用程式工具列的清單;如果為 TRUE,則功能表僅顯示應用程式工具列的清單。如果 FALSE,函式庫將應用程式停靠窗格添加到此清單。

## <a name="cdockingmanagerfinddocksite"></a><a name="finddocksite"></a>CDocking管理員::尋找DockSite

檢索位於指定位置且具有指定對齊方式的條形窗格。

```
virtual CDockSite* FindDockSite(
    DWORD dwAlignment,
    BOOL bOuter);
```

### <a name="parameters"></a>參數

*dwalignment*<br/>
[在]條形窗格的對齊方式。

*b外部*<br/>
[在]如果為 TRUE,則檢索控制欄列表中頭部位置的條形。 否則,在控制條列表中檢索尾部位置的條。

### <a name="return-value"></a>傳回值

具有指定對齊方式的停靠窗格;否則為 NULL。

## <a name="cdockingmanagerfindpanebyid"></a><a name="findpanebyid"></a>CDocking管理員::查找PaneByID

依指定的控制項識別碼識別碼。

```
virtual CBasePane* FindPaneByID(
    UINT uBarID,
    BOOL bSearchMiniFrames = FALSE);
```

### <a name="parameters"></a>參數

*烏巴里德*<br/>
[在]指定要查找的窗格的控制 ID。

*b 搜尋迷你框架*<br/>
[在]TRUE 以包括搜索中的所有浮動窗格。 FALSE 只包括停靠的窗格。

### <a name="return-value"></a>傳回值

具有指定控制項 ID 的[CBasePane](../../mfc/reference/cbasepane-class.md)物件,如果找不到指定的窗格,則為 NULL。

### <a name="remarks"></a>備註

## <a name="cdockingmanagerfinddocksitebypane"></a><a name="finddocksitebypane"></a>CDocking管理員::尋找DocksitebyPane

返回具有目標欄窗格 ID 的條形窗格。

```
virtual CDockSite* FindDockSiteByPane(CPane* pTargetBar);
```

### <a name="parameters"></a>參數

*p 目標列*<br/>
[在]指向目標欄窗格的指標。

### <a name="return-value"></a>傳回值

具有目標欄窗格 ID 的欄窗格;如果沒有此類條形窗格,則 NULL。

## <a name="cdockingmanagerfixupvirtualrects"></a><a name="fixupvirtualrects"></a>CDocking 管理員:修復虛擬重新

將所有當前工具列位置提交到虛擬矩形。

```
virtual void FixupVirtualRects();
```

### <a name="remarks"></a>備註

當用戶開始拖動工具列時,應用程式會記住其*在虛擬矩形*中的原始位置。 當使用者在其停靠網站上移動工具列時,工具列可能會移動其他工具列。 其他工具列的原始位置存儲在相應的虛擬矩形中。

## <a name="cdockingmanagerframefrompoint"></a><a name="framefrompoint"></a>CDocking管理員::從點幀

返回包含給定點的幀。

```
virtual CPaneFrameWnd* FrameFromPoint(
    CPoint pt,
    CPaneFrameWnd* pFrameToExclude,
    BOOL bFloatMultiOnly) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
[在]指定要檢查的點(在螢幕座標中)。

*pFrame 排除*<br/>
[在]指向要排除的幀的指標。

*b 浮動多隻*<br/>
[在]TRUE 以排除不是 的`CMultiPaneFrameWnd`實例的 幀。否則。

### <a name="return-value"></a>傳回值

包含給定點的幀;否則為 NULL。

## <a name="cdockingmanagergetclientareabounds"></a><a name="getclientareabounds"></a>CDocking 管理員:取得客戶區域繫結

獲取包含工作區邊界的矩形。

```
CRect GetClientAreaBounds() const;

void GetClientAreaBounds(CRect& rcClient);
```

### <a name="parameters"></a>參數

*rcClient*<br/>
[出]對包含工作區邊界的矩形的引用。

### <a name="return-value"></a>傳回值

包含工作區邊界的矩形。

## <a name="cdockingmanagergetdockingmode"></a><a name="getdockingmode"></a>CDocking 管理員:取得對接模式

返回當前停靠模式。

```
static AFX_DOCK_TYPE GetDockingMode();
```

### <a name="return-value"></a>傳回值

表示當前停靠模式的枚舉器值。 它可能是下列其中一個值：

- DT_STANDARD

- DT_IMMEDIATE

- DT_SMART

### <a name="remarks"></a>備註

要設定停靠模式,請致電[CdockingManager::設定停靠模式](#setdockingmode)。

## <a name="cdockingmanagergetdocksiteframewnd"></a><a name="getdocksiteframewnd"></a>CDocking管理員::獲取DockSiteFramewnd

獲取指向父視窗框架的指標。

```
CFrameWnd* GetDockSiteFrameWnd() const;
```

### <a name="return-value"></a>傳回值

指向父視窗框架的指標。

## <a name="cdockingmanagergetenabledautohidealignment"></a><a name="getenabledautohidealignment"></a>Cdocking 管理員:啟用自動隱藏對齊

返回窗格的啟用對齊方式。

```
DWORD GetEnabledAutoHideAlignment() const;
```

### <a name="return-value"></a>傳回值

如果未啟用自動隱藏窗格,則CBRS_ALIGN_標誌或 0 的位組合。 有關詳細資訊,請參閱[CFramewnd::啟用停靠](../../mfc/reference/cframewnd-class.md#enabledocking)。

### <a name="remarks"></a>備註

該方法返回自動隱藏控制欄的啟用對齊方式。 要啟用自動隱藏列,請致電[CFramewndEx::啟用自動隱藏窗格](../../mfc/reference/cframewndex-class.md#enableautohidepanes)。

## <a name="cdockingmanagergetminiframes"></a><a name="getminiframes"></a>CDocking 管理員:取得迷你框架

獲取微型幀清單。

```
const CObList& GetMiniFrames() const;
```

### <a name="return-value"></a>傳回值

包含屬於停靠管理器的控制欄的小型幀清單。

## <a name="cdockingmanagergetouteredgebounds"></a><a name="getouteredgebounds"></a>CDocking 管理員:取得外部邊緣繫結

獲取包含框架外邊緣的矩形。

```
CRect GetOuterEdgeBounds() const;
```

### <a name="return-value"></a>傳回值

包含框架外邊緣的矩形。

## <a name="cdockingmanagergetpanelist"></a><a name="getpanelist"></a>CDocking 管理員:抓取窗格清單

返回屬於停靠管理器的窗格清單。 這包括所有浮動窗格。

```cpp
void GetPaneList(
    CObList& lstBars,
    BOOL bIncludeAutohide = FALSE,
    CRuntimeClass* pRTCFilter = NULL,
    BOOL bIncludeTabs = FALSE);
```

### <a name="parameters"></a>參數

*lstBars*<br/>
[進出]包含當前停靠管理器的所有窗格。

*bInclude 自動隱藏*<br/>
[在]TRUE 以包括處於自動隱藏模式的窗格;否則,FALSE。

*pRTC 過濾器*<br/>
[在]如果不是 NULL,則傳回的清單僅包含指定執行時類的窗格。

*bIncludeTabs*<br/>
[在]TRUE 以包括選項卡;否則,FALSE。

### <a name="remarks"></a>備註

如果停靠管理器中有任何選項卡式窗格,該方法將返回指向[CBaseTabbedPane 類](../../mfc/reference/cbasetabbedpane-class.md)物件的指標,並且必須顯式枚舉選項卡。

使用*pRTCFilter*獲取特定類的窗格。 例如,您可以通過適當設置此值來僅獲取工具列。

## <a name="cdockingmanagergetsmartdockingmanager"></a><a name="getsmartdockingmanager"></a>CDocking 管理員:取得智慧擴充管理員

檢索指向智慧停靠管理器的指標。

```
CSmartDockingManager* GetSmartDockingManager();
```

### <a name="return-value"></a>傳回值

指向智慧停靠管理器的指標。

## <a name="cdockingmanagergetsmartdockingmanagerpermanent"></a><a name="getsmartdockingmanagerpermanent"></a>CDocking 管理員:取得智慧擴充管理員永久

檢索指向智慧停靠管理器的指標。

```
CSmartDockingManager* GetSmartDockingManagerPermanent() const;
```

### <a name="return-value"></a>傳回值

指向智慧停靠管理器的指標。

## <a name="cdockingmanagergetsmartdockingparams"></a><a name="getsmartdockingparams"></a>CDocking 管理員:取得智慧對接參數

返回停靠管理器的智慧停靠參數。

```
static CSmartDockingInfo& GetSmartDockingParams();
```

### <a name="return-value"></a>傳回值

包含當前停靠管理器的智慧停靠參數的類。 有關詳細資訊,請參閱[CSmartDockingInfo 類別](../../mfc/reference/csmartdockinginfo-class.md)。

### <a name="remarks"></a>備註

## <a name="cdockingmanagerhideautohidepanes"></a><a name="hideautohidepanes"></a>CDocking 管理員:隱藏自動隱藏窗格

隱藏處於自動隱藏模式的窗格。

```cpp
void HideAutoHidePanes(
    CDockablePane* pBarToExclude = NULL,
    BOOL bImmediately = FALSE);
```

### <a name="parameters"></a>參數

*pBarto 排除*<br/>
[在]指向要從隱藏中排除的條形的指標。

*b 立即*<br/>
[在]TRUE 立即隱藏窗格;FALSE 以隱藏具有自動隱藏效果的窗格。

## <a name="cdockingmanagerinsertdocksite"></a><a name="insertdocksite"></a>CDocking 管理員::插入DockSite

建立停靠窗格並將其插入控制欄清單。

```
BOOL InsertDockSite(
    const AFX_DOCKSITE_INFO& info,
    DWORD dwAlignToInsertAfter,
    CDockSite** ppDockBar = NULL);
```

### <a name="parameters"></a>參數

*資訊*<br/>
[在]包含有關停靠窗格的對齊資訊的結構。

*dwalignto 插入後*<br/>
[在]停靠窗格的對齊方式。

*ppDockBar*<br/>
[出]指向指向停靠窗格的指標。

### <a name="return-value"></a>傳回值

如果成功創建了停靠窗格,則為 TRUE;如果成功創建了停靠窗格,則為 TRUE。否則。

## <a name="cdockingmanagerinsertpane"></a><a name="insertpane"></a>CDocking 管理員:插入窗格

將控制窗格插入控制欄清單中。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]指向控件窗格的指標。

*p 目標*<br/>
[在]指向目標窗格的指標。

*b 後*<br/>
[在]TRUE 在目標窗格的位置後插入窗格;否則。

### <a name="return-value"></a>傳回值

如果控制窗格已成功添加到控制欄清單中,則為 TRUE;如果控制窗格已成功添加到控制欄清單中,則為 TRUE。否則。

### <a name="remarks"></a>備註

如果控制窗格已在控制欄清單中,或者控制列清單中不存在目標窗格,則此方法將返回 false。

## <a name="cdockingmanagerisdocksitemenu"></a><a name="isdocksitemenu"></a>CDocking管理員::IsDockSiteMenu

指定彈出選單是否顯示在所有窗格的標題上。

```
static BOOL IsDockSiteMenu();
```

### <a name="return-value"></a>傳回值

如果停靠網站功能表顯示在所有停靠窗格的標題上,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

您可以通過調用[CDockingManager::啟用DockSiteMenu](#enabledocksitemenu)來啟用擴展網站功能選單。

## <a name="cdockingmanagerisinadjustlayout"></a><a name="isinadjustlayout"></a>Cdocking 管理員:正在調整佈局

確定是否調整了所有窗格的佈局。

```
BOOL IsInAdjustLayout() const;
```

### <a name="return-value"></a>傳回值

如果調整了所有窗格的佈局,則為 TRUE;如果調整了所有窗格的佈局。否則。

## <a name="cdockingmanagerisolecontainermode"></a><a name="isolecontainermode"></a>CDocking 管理員:isOLE容器模式

指定停靠管理器是否處於 OLE 容器模式。

```
BOOL IsOLEContainerMode() const;
```

### <a name="return-value"></a>傳回值

如果停靠管理器處於 OLE 容器模式,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

在 OLE 容器模式下,所有停靠窗格和應用程式工具列都處於隱藏狀態。 如果將[CDockingManager::m_bHideDockingBarsInContainerMode](#m_bhidedockingbarsincontainermode)設置為 TRUE,則窗格也會在此模式下隱藏。

## <a name="cdockingmanagerispointneardocksite"></a><a name="ispointneardocksite"></a>CDocking管理員::IsPointNearDockSite

確定指定點是否靠近停靠網站。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]指定的點。

*dwBaralignment*<br/>
[出]指定點附近的邊。 可能的值是CBRS_ALIGN_LEFT、CBRS_ALIGN_RIGHT、CBRS_ALIGN_TOP 和CBRS_ALIGN_BOTTOM。

*bouterEdge*<br/>
[出]如果點靠近停靠網站的外部邊界,則為 TRUE;否則。

### <a name="return-value"></a>傳回值

如果點靠近停靠網站,則為 TRUE;否則 FALSE。

## <a name="cdockingmanagerisprintpreviewvalid"></a><a name="isprintpreviewvalid"></a>CDocking 管理員::正在列印預覽有效

確定是否設置了列印預覽模式。

```
BOOL IsPrintPreviewValid() const;
```

### <a name="return-value"></a>傳回值

如果設置了列印預覽模式,則為 TRUE;如果已設置列印預覽模式,則為 TRUE。否則。

## <a name="cdockingmanagerloadstate"></a><a name="loadstate"></a>CDocking 管理員:載入狀態

從註冊表載入停靠管理器的狀態。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName = NULL,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]設定檔名稱。

*uiID*<br/>
[在]停靠管理員的 ID。

### <a name="return-value"></a>傳回值

如果停靠管理器狀態已成功載入,則為 TRUE;如果停靠管理器狀態已成功載入,則為 TRUE。否則 FALSE。

## <a name="cdockingmanagerlockupdate"></a><a name="lockupdate"></a>CDocking 管理員:鎖更新

鎖定給定的視窗。

```cpp
void LockUpdate(BOOL bLock);
```

### <a name="parameters"></a>參數

*塊*<br/>
[在]如果視窗已鎖定,則為 TRUE;否則。

### <a name="remarks"></a>備註

當視窗被鎖定時,它不能移動,也不能重繪。

## <a name="cdockingmanagerm_bhidedockingbarsincontainermode"></a><a name="m_bhidedockingbarsincontainermode"></a>CDocking管理員:m_bHideDockingBarsInContainerMode

指定停靠管理員是否在 OLE 容器模式下隱藏窗格。

```
AFX_IMPORT_DATA static BOOL m_bHideDockingBarsInContainerMode;
```

### <a name="remarks"></a>備註

如果要使所有窗格停靠在主機架上,當應用程式處於 OLE 容器模式時,將此值設置為 FALSE。 預設情況下,此值為 TRUE。

## <a name="cdockingmanagerm_dockmodeglobal"></a><a name="m_dockmodeglobal"></a>CDocking管理員::m_dockModeGlobal

指定全域停靠模式。

```
AFX_IMPORT_DATA static AFX_DOCK_TYPE m_dockModeGlobal;
```

### <a name="remarks"></a>備註

預設情況下,每個停靠窗格都使用此停靠模式。 有關此欄位可以設定為的值的詳細資訊,請參閱[CBasePane::取得停靠模式](../../mfc/reference/cbasepane-class.md#getdockingmode)。

## <a name="cdockingmanagerm_ndocksensitivity"></a><a name="m_ndocksensitivity"></a>CDocking管理員::m_nDockSensitivity

指定停靠靈敏度。

```
AFX_IMPORT_DATA static int m_nDockSensitivity;
```

### <a name="remarks"></a>備註

停靠敏感度定義在框架將其狀態更改為停靠之前,浮動窗格可以接近停靠窗格、停靠網站或其他窗格的接近程度。

## <a name="cdockingmanagerm_ntimeoutbeforedockingbardock"></a><a name="m_ntimeoutbeforedockingbardock"></a>CDocking管理員::m_nTimeOutBeforeDockingBarDock

指定停靠窗格在直接停靠模式下停靠之前的時間(以毫秒為單位)。

```
static UINT m_nTimeOutBeforeDockingBarDock;
```

### <a name="remarks"></a>備註

在停靠窗格之前,框架將等待指定的時間長度。 這樣可以防止在使用者仍在拖動窗格時意外停靠到該位置。

## <a name="cdockingmanagerm_ntimeoutbeforetoolbardock"></a><a name="m_ntimeoutbeforetoolbardock"></a>CDocking管理員:m_nTimeOutBeforeToolBarDock

指定工具列停靠到主框架視窗之前的時間(以毫秒為單位)。

```
static UINT m_nTimeOutBeforeToolBarDock;
```

### <a name="remarks"></a>備註

在停靠工具列之前,框架將等待指定的時間長度。 這樣可以防止工具列在使用者仍在拖動時意外停靠到該位置。

## <a name="cdockingmanageronactivateframe"></a><a name="onactivateframe"></a>CDocking管理員:在啟動幀上

當框架視窗變為活動或停用時,由框架調用。

```
virtual void OnActivateFrame(BOOL bActivate);
```

### <a name="parameters"></a>參數

*b 啟動*<br/>
[在]如果為 TRUE,則框架視窗將變為活動狀態;如果為 TRUE,則框架視窗將變為活動狀態。如果 FALSE,則框架視窗將停用。

## <a name="cdockingmanageronclosepopupmenu"></a><a name="onclosepopupmenu"></a>CDocking管理員::上接合彈出選單

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```cpp
void OnClosePopupMenu();
```

### <a name="remarks"></a>備註

框架在即將關閉當前主視窗時發送WM_DESTROY消息。 重寫此方法,以處理`CMFCPopupMenu``CMFCPopupMenu`物件處理WM_DESTROY消息時屬於幀視窗的物件的通知。

## <a name="cdockingmanageronmoveminiframe"></a><a name="onmoveminiframe"></a>Cdocking管理員:在移動迷你框架

由框架調用以移動微型框架視窗。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
[在]指向微型框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則 FALSE。

## <a name="cdockingmanageronpanecontextmenu"></a><a name="onpanecontextmenu"></a>Cdocking管理員::在窗格上下文選單

當框架生成包含窗格列表的功能表時,由框架調用。

```cpp
void OnPaneContextMenu(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]指定功能表的位置。

## <a name="cdockingmanagerpanefrompoint"></a><a name="panefrompoint"></a>CDocking管理員::P從點

返回包含給定點的窗格。

```
virtual CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar = false,
    CRuntimeClass* pRTCBarType = NULL,
    BOOL bCheckVisibility = FALSE,
    const CBasePane* pBarToIgnore = NULL) const;

virtual CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType = NULL,
    const CBasePane* pBarToIgnore = NULL) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]指定要檢查的點(在螢幕座標中)。

*nSensitivity*<br/>
[在]要膨脹每個選中窗格的視窗矩形的值。 如果給定點位於此膨脹區域中,則窗格滿足搜索條件。

*bExactBar*<br/>
[在]TRUE 忽略*n 敏感參數*;否則,FALSE。

*pRTCBar 類型*<br/>
[在]如果不是 NULL,該方法將僅搜尋指定類型的窗格。

*b 檢查可見度*<br/>
[在]TRUE 僅檢查可見窗格;否則,FALSE。

*dwalignment*<br/>
[出]如果在指定點找到窗格,則此參數包含最接近指定點的窗格的一側。 如需詳細資訊，請參閱＜備註＞一節。

*pBartoignore*<br/>
[在]如果不是 NULL,該方法將忽略此參數指定的窗格。

### <a name="return-value"></a>傳回值

包含給定點的[CBasePane](../../mfc/reference/cbasepane-class.md)派生物件,如果沒有找到窗格,則為 NULL。

### <a name="remarks"></a>備註

當函數返回並找到窗格時 *,dwAlignment*包含指定點的對齊方式。 例如,如果點最接近窗格的頂部,*則 dwAlignment*設置為CBRS_ALIGN_TOP。

## <a name="cdockingmanagerprocesspanecontextmenucommand"></a><a name="processpanecontextmenucommand"></a>CDocking管理員::ProcessPane上下文菜單命令

由框架呼叫以選擇或清除指定命令的複選框,並重新計算顯示的窗格的佈局。

```
BOOL ProcessPaneContextMenuCommand(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]功能表中控制欄的 ID。

*n代碼*<br/>
[在]命令通知代碼。

*pExtra*<br/>
[在]如果*nCode* CN_UPDATE_COMMAND_UI,則指向`CCmdUI`void 的指標,該指標將轉換為指向指向的指標。

*pHandlerInfo*<br/>
[在]指向資訊結構的指標。 不使用這個參數。

### <a name="return-value"></a>傳回值

如果*pEXtra*不是 NULL,*並且 nCode*等於CN_UPDATE_COMMAND_UI,或者如果有一個帶有指定*nID 的控制*欄,則為 TRUE。

## <a name="cdockingmanagerrecalclayout"></a><a name="recalclayout"></a>CDocking管理員:Recalclayout

重新計算控制清單中存在的控制項的內部佈局。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

*b 通知*<br/>
[在]不使用此參數。

## <a name="cdockingmanagerreleaseemptypanecontainers"></a><a name="releaseemptypanecontainers"></a>CDocking 管理員::釋放空窗格容器

釋放空窗格容器。

```cpp
void ReleaseEmptyPaneContainers();
```

## <a name="cdockingmanagerremovehiddenmditabbedbar"></a><a name="removehiddenmditabbedbar"></a>CDocking 管理員::刪除隱藏 MDITabbedbar

刪除指定的隱藏欄窗格。

```cpp
void RemoveHiddenMDITabbedBar(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要刪除的條形窗格的指標。

## <a name="cdockingmanagerremoveminiframe"></a><a name="removeminiframe"></a>CDocking 管理員:刪除Mini框架

從迷你框架清單中刪除指定的幀。

```
virtual BOOL RemoveMiniFrame(CPaneFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向要刪除的幀的指標。

### <a name="return-value"></a>傳回值

如果刪除了指定的幀,則為 TRUE;如果已刪除指定的幀否則。

## <a name="cdockingmanagerremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>CDockManager:從Dock管理員中移除窗格

取消註冊窗格並將其從停靠管理器中的清單中刪除。

```cpp
void RemovePaneFromDockManager(
    CBasePane* pWnd,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide = FALSE,
    CBasePane* pBarReplacement = NULL);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向要刪除的窗格的指標。

*b破壞*<br/>
[在]如果為 TRUE,則刪除的窗格將被銷毀。

*b 調整佈局*<br/>
[在]如果為 TRUE,請立即調整停靠佈局。

*bAutoHide*<br/>
[在]如果為 TRUE,則窗格將從自動隱藏欄列表中刪除。 如果 FALSE,則窗格將從常規窗格列表中刪除。

*pBar 取代*<br/>
[在]指向替換已刪除窗格的窗格的指標。

## <a name="cdockingmanagerreplacepane"></a><a name="replacepane"></a>CDocking 管理員:取代窗格

以一個窗格取代另一個。

```
BOOL ReplacePane(
    CDockablePane* pOriginalBar,
    CDockablePane* pNewBar);
```

### <a name="parameters"></a>參數

*p 原始欄*<br/>
[在]指向原始窗格的指標。

*pNewBar*<br/>
[在]指向替換原始窗格的窗格的指標。

### <a name="return-value"></a>傳回值

如果已成功替換窗格,則為 TRUE;如果窗格已成功替換,則為 TRUE。否則。

## <a name="cdockingmanagerresortminiframesforzorder"></a><a name="resortminiframesforzorder"></a>CDocking管理員::度假村迷你框架為ZOrder

在迷你幀清單中對幀進行設置。

```cpp
void ResortMiniFramesForZOrder();
```

## <a name="cdockingmanagersavestate"></a><a name="savestate"></a>CDocking 管理員::儲存狀態

將停靠管理器的狀態保存到註冊表。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName = NULL,
    UINT uiID = (UINT) -1);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]註冊表項的路徑。

*uiID*<br/>
[在]停靠管理器識別碼。

### <a name="return-value"></a>傳回值

如果成功保存狀態,則為 TRUE;如果狀態已成功保存,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

將停靠管理器的狀態保存到註冊表涉及保存控制欄的狀態、自動隱藏欄的狀態以及停靠管理器中存在的微型幀的狀態。

## <a name="cdockingmanagersendmessagetominiframes"></a><a name="sendmessagetominiframes"></a>CDocking管理員::發送消息到微型幀

將指定的消息發送到所有微型幀。

```
BOOL SendMessageToMiniFrames(
    UINT uMessage,
    WPARAM wParam = 0,
    LPARAM lParam = 0);
```

### <a name="parameters"></a>參數

*u訊息*<br/>
[在]要發送的消息。

*wParam*<br/>
[在]其他郵件相關信息。

*lParam*<br/>
[在]其他郵件相關信息。

### <a name="return-value"></a>傳回值

永遠真實。

## <a name="cdockingmanagerserialize"></a><a name="serialize"></a>CDocking 管理員:序列化

將停靠管理器寫入存檔。

```cpp
void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
[在]對存檔物件的引用。

### <a name="remarks"></a>備註

將停靠管理器寫入存檔涉及確定停靠控制欄和滑塊的數量,並將控制欄、迷你框架、自動隱藏欄和 MDI 選項卡欄寫入存檔。

## <a name="cdockingmanagersetautohidezorder"></a><a name="setautohidezorder"></a>CDocking 管理員:設定自動隱藏順序

設置控制列和指定窗格的大小、寬度和高度。

```cpp
void SetAutohideZOrder(CDockablePane* pAHDockingBar);
```

### <a name="parameters"></a>參數

*pAHDockingBar*<br/>
[在]指向可停靠窗格的指標。

## <a name="cdockingmanagersetdockingmode"></a><a name="setdockingmode"></a>CDocking 管理員:設定對接模式

設置停靠模式。

```
static void SetDockingMode(
    AFX_DOCK_TYPE dockMode,
    AFX_SMARTDOCK_THEME theme = AFX_SDT_DEFAULT);
```

### <a name="parameters"></a>參數

*塢站模式*<br/>
指定新的停靠模式。 如需詳細資訊，請參閱＜備註＞一節。

*主題*<br/>
指定用於智慧停靠標記的主題。 它可以是以下枚舉值之一:AFX_SDT_DEFAULT、AFX_SDT_VS2005、AFX_SDT_VS2008。

### <a name="remarks"></a>備註

調用此靜態方法以設置停靠模式。

*dockMode*可以是以下值之一:

- DT_STANDARD - 可視化工作室 2003 中實現的標準停靠模式。 在沒有拖動上下文的情況下拖動窗格。

- DT_IMMEDIATE - 在 Microsoft Visio 中實現的即時停靠模式。 窗格使用拖動上下文拖動,但不會顯示任何標記。

- DT_SMART - Visual Studio 2005 中實現的智慧對接模式。 使用拖動上下文拖動窗格,並顯示顯示窗格停靠位置的智能標記。

## <a name="cdockingmanagersetdockstate"></a><a name="setdockstate"></a>CDocking管理員::SetDockState

設置控制欄、微型框架和自動隱藏欄的停靠狀態。

```
virtual void SetDockState();
```

## <a name="cdockingmanagersetprintpreviewmode"></a><a name="setprintpreviewmode"></a>CDocking 管理員::設定列印預覽模式

設置列印預覽中顯示的條形圖的列印預覽模式。

```cpp
void SetPrintPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

*b預覽*<br/>
[在]如果設置了列印預覽模式,則為 TRUE;如果已設置列印預覽模式,則為 TRUE。否則。

*pState*<br/>
[在]指向預覽狀態的指標。 不使用這個參數。

## <a name="cdockingmanagersetsmartdockingparams"></a><a name="setsmartdockingparams"></a>CDocking管理員:設定智慧對接參數

設置定義智慧停靠行為的參數。

```
static void SetSmartDockingParams(CSmartDockingInfo& params);
```

### <a name="parameters"></a>參數

*params*<br/>
[進出]定義智慧停靠的參數。

### <a name="remarks"></a>備註

如果要自定義智慧停靠標記的外觀、顏色或形狀,請調用此方法。

要使用智慧嵌入標籤的預設搜尋,請將[CSmartDockingInfo 類別](../../mfc/reference/csmartdockinginfo-class.md)的未初始化實體傳遞給*參數*。

## <a name="cdockingmanagershowdelayshowminiframes"></a><a name="showdelayshowminiframes"></a>CDocking 管理員::顯示延遲顯示迷你幀

顯示或隱藏微型框架的視窗。

```cpp
void ShowDelayShowMiniFrames(BOOL bshow);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]TRUE 使顯示的幀的視窗處於活動狀態;FALSE 以隱藏框架的視窗。

## <a name="cdockingmanagershowpanes"></a><a name="showpanes"></a>CDocking管理員::顯示窗格

顯示或隱藏控制器和自動隱藏列的窗格。

```
virtual BOOL ShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]TRUE 以顯示窗格;FALSE 以隱藏窗格。

### <a name="return-value"></a>傳回值

一律為 FALSE。

## <a name="cdockingmanagerstartsdocking"></a><a name="startsdocking"></a>CDocking管理員:開始對接

根據智慧對接管理器的對齊方式啟動指定窗口的智慧停靠。

```cpp
void StartSDocking(CWnd* pDockingWnd);
```

### <a name="parameters"></a>參數

*pDockingwnd*<br/>
[在]指向要停靠的視窗的指標。

## <a name="cdockingmanagerstopsdocking"></a><a name="stopsdocking"></a>CDocking管理員:停止對接

停止智慧停靠。

```cpp
void StopSDocking();
```

## <a name="cdockingmanagergetsmartdockingtheme"></a><a name="getsmartdockingtheme"></a>CDocking管理員:取得智慧對接主題

返回用於顯示智慧停靠標記的主題的靜態方法。

```
static AFX_SMARTDOCK_THEME __stdcall GetSmartDockingTheme();
```

### <a name="return-value"></a>傳回值

返回以下枚舉值之一:AFX_SDT_DEFAULT、AFX_SDT_VS2005、AFX_SDT_VS2008。

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CObject 類別](../../mfc/reference/cobject-class.md)<br/>
[CFrameWndEx 類別](../../mfc/reference/cframewndex-class.md)<br/>
[CDockablePane Class](../../mfc/reference/cdockablepane-class.md)<br/>
[CPaneFrameWnd 類別](../../mfc/reference/cpaneframewnd-class.md)
