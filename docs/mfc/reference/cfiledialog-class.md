---
title: CFileDialog 類別
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 247072d815b660fcd2cc6c2a1291b618aa6ce2ab
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753146"
---
# <a name="cfiledialog-class"></a>CFileDialog 類別

封裝用於檔打開或檔案儲存操作的通用對話方塊。

## <a name="syntax"></a>語法

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|建構 `CFileDialog` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[檔案對話::新增檢查按鈕](#addcheckbutton)|向對話框添加檢查按鈕。|
|[檔案對話::新增康博盒](#addcombobox)|向對話框添加組合框。|
|[檔案對話::新增控制項目](#addcontrolitem)|將項添加到對話方塊中的容器控制項。|
|[檔案對話::新增編輯框](#addeditbox)|向對話框添加編輯框。|
|[檔案對話::新增選單](#addmenu)|向對話框添加功能表。|
|[檔案對話::新增位置](#addplace)|已多載。 將資料夾添加到可供使用者打開或儲存專案的地方清單中。|
|[檔案對話::新增按鈕](#addpushbutton)|向對話框添加一個按鈕。|
|[檔案對話::新增無線按鈕清單](#addradiobuttonlist)|向對話框添加選項按鈕(也稱為單選按鈕)組。|
|[檔案對話::新增分離器](#addseparator)|向對話框添加分隔符。|
|[檔案對話::新增文字](#addtext)|將文字內容添加到對話框中。|
|[檔案對話::應用ofntoshell對話](#applyofntoshelldialog)|更新`CFileDialog`的狀態 以匹配存儲在成員變數`m_ofn`中的 參數和標誌。|
|[檔案對話::Do 模態](#domodal)|顯示對話框,並允許用戶進行選擇。|
|[檔案對話:開啟開啟下拉](#enableopendropdown)|在對話框中的 **「打開**」 或「**儲存」** 按鈕上啟用下拉清單。|
|[檔案對話::結束視覺群組](#endvisualgroup)|停止向對話框中的可視組添加元素。|
|[檔案對話::抓取檢查按鈕狀態](#getcheckbuttonstate)|獲取對話框中的複選框(複選框)的當前狀態。|
|[檔案對話框:抓取控制項目狀態](#getcontrolitemstate)|獲取對話框中找到的容器控制件中的項目的當前狀態。|
|[檔案對話::取得控制狀態](#getcontrolstate)|獲取給定控制件的目前可見性和啟用狀態。|
|[檔案對話::取得編輯框文字](#geteditboxtext)|取得編輯框控制檔中的目前文字。|
|[檔案對話::取得檔案Ext](#getfileext)|返回所選檔的副檔名。|
|[檔案對話::取得檔案名稱](#getfilename)|返回所選檔的檔名。|
|[檔案對話::取得檔案標題](#getfiletitle)|返回所選檔的標題。|
|[檔案對話::抓取資料夾路徑](#getfolderpath)|檢索目前打開的資料夾或目錄的路徑,用於資源管理器樣式**的"打開**"或 **"另存為**常見"對話方塊。|
|[檔案對話::取得檔案對話自訂](#getifiledialogcustomize)|檢索自定義`CFileDialog`物件的內部 COM 物件。|
|[檔案對話::取得I檔案開啟對話框](#getifileopendialog)|檢索用作打開檔案對話方塊的內部`CFileDialog`COM**Open**物件。|
|[檔案對話::取得I檔案儲存對話框](#getifilesavedialog)|檢索用作 **「保存**檔案」對話`CFileDialog`框的內部 COM 物件。|
|[檔案對話::抓取下一個路徑名稱](#getnextpathname)|返回下一個選定檔的完整路徑。|
|[檔案對話::GetOFN](#getofn)|檢索物件`OPENFILENAME`的結構`CFileDialog`。|
|[檔案對話::抓取路徑名稱](#getpathname)|返回所選檔的完整路徑。|
|[檔案對話::取得唯讀](#getreadonlypref)|返回所選檔的唯讀狀態。|
|[檔案對話::抓取結果](#getresult)|獲取使用者在對話框中所做的選擇。|
|[檔案對話::抓取結果](#getresults)|在允許多次選擇的對話框中獲取用戶的選擇。|
|[檔案對話::取得所選取的控制項目](#getselectedcontrolitem)|從對話框中的指定容器控制件獲取特定項。|
|[檔案對話::抓取起始位置](#getstartposition)|傳回檔案名清單的第一個元素的位置。|
|[檔案對話::隱藏控制](#hidecontrol)|在資源管理器樣式 **「打開**」 或「**儲存為**常見」 對話方塊中隱藏指定的控制項。|
|[檔案對話框::正在選取資料夾模式](#ispickfoldersmode)|確定當前對話框是否處於資料夾選取器模式。|
|[檔案對話::製作突出](#makeprominent)|在對話框中放置控制項,使其與其他添加的控制項相比脫穎而出。|
|[檔案對話::移除控制項目](#removecontrolitem)|從對話方塊中的容器控制件中刪除項。|
|[檔案對話::設定檢查按鈕狀態](#setcheckbuttonstate)|設置對話框中複選框(複選框)的當前狀態。|
|[檔案對話框::設定控制項狀態](#setcontrolitemstate)|設置對話框中容器控制項中的項目的當前狀態。|
|[檔案對話::設定控制項目文字](#setcontrolitemtext)|設定控制項項的文字。 例如,帶有單選按鈕或功能表中的專案的文本。|
|[檔案對話::設定控制標籤](#setcontrollabel)|設置與控制項關聯的文字,如按鈕文本或編輯框標籤。|
|[檔案對話::設定控制狀態](#setcontrolstate)|設置給定控制件的當前可見性和啟用狀態。|
|[檔案對話::設定控制文字](#setcontroltext)|在資源管理器樣式的 **「打開**」 或「**儲存為**常見」 對話方塊中設定指定控制項的文字。|
|[檔案對話::設定DefExt](#setdefext)|設定資源管理員樣式**的「打開**」或「**儲存」** 為「對話框的預設檔案名副檔名。|
|[檔案對話::設定編輯框文字](#seteditboxtext)|在編輯框控制項中設定目前的文字。|
|[檔案對話::設定屬性](#setproperties)|提供屬性儲存區，可定義要用於所儲存之項目的預設值。|
|[檔案對話::設定選擇的控制項目](#setselectedcontrolitem)|在選項按鈕組或對話方塊中找到的組合框中設置特定項的選定狀態。|
|[檔案對話::設定樣本](#settemplate)|設置`CFileDialog`物件的對話方塊範本。|
|[檔案對話::開始視覺群組](#startvisualgroup)|在對話框中聲明可視組。 對任何「添加」方法的後續調用將這些元素添加到此組中。|
|[檔案對話::從 ShellDialog 更新](#updateofnfromshelldialog)|更新儲存在成員變數中`m_ofn`的數據,以匹配文件對話框的當前狀態。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[檔案對話::點擊按鈕](#onbuttonclicked)|按下按鈕時調用。|
|[檔案對話::開啟檢查按鈕切換](#oncheckbuttontoggled)|選中/取消選中複選框時調用。|
|[檔案對話::在控制啟動](#oncontrolactivating)|當控件處於活動狀態時調用。|
|[檔案對話::檔案名稱變更](#onfilenamechange)|處理WM_NOTIFYCDN_SELCHANGE消息。|
|[檔案對話::在檔案名稱OK](#onfilenameok)|驗證在對話框中輸入的檔名。|
|[檔案對話::開啟資料夾變更](#onfolderchange)|處理WM_NOTIFYCDN_FOLDERCHANGE消息。|
|[檔案對話::OnInitdone](#oninitdone)|處理WM_NOTIFYCDN_INITDONE消息。|
|[檔案對話::項目選定](#onitemselected)|選擇容器項時調用。|
|[檔案對話::在LBSel改變通知](#onlbselchangednotify)|允許您在檔案選擇更改時執行自定義操作。|
|[檔案對話::在共用衝突](#onshareviolation)|處理共用衝突。|
|[檔案對話::在類型變更上](#ontypechange)|處理WM_NOTIFYCDN_TYPECHANGE消息。|

### <a name="public-data-members"></a>公用資料成員

|名稱|描述|
|----------|-----------------|
|[檔案對話::m_ofn](#m_ofn)|窗口`OPENFILENAME`結構。 提供對基本文件對話框參數的訪問。|

## <a name="remarks"></a>備註

通用檔案對話框允許您以符合 Windows 標準的方式實現檔案選擇對話方塊,例如「**打開檔案和****另存為**」,

您可以按照提供的`CFileDialog`建構函數使用,也可以`CFileDialog`從派生您自己的對話方塊類並編寫構造函數以滿足您的需要。 在這兩種情況下,這些對話框將類似於標準 MFC 對話框,因為它們派生自[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)。 `CFileDialog`依賴於 COMMDLG。包含在 Windows 中的 DLL 檔。

`CFileDialog` Windows Vista 的外觀和功能都不同於早期版本的 Windows。 如果程式`CFileDialog`在 Windows Vista 或更高版本下編譯和運行,則預設將自動使用新的 Windows Vista 或更高版本樣式,而無需更改代碼。 使用建構函數中的*bVistaStyle*參數手動覆蓋此自動更新。 自動更新的例外情況是自定義對話方塊。 它們不會轉換為新樣式。 有關建構函數的詳細資訊,請參閱[CFileDialog::CFileDialog](#cfiledialog)。

> [!NOTE]
> 使用 時,Windows Vista或更高版本的 Windows`CFileDialog`中控制項 ID 系統與早期版本的 Windows 不同。 必須先更新對`CFileDialog`代碼中控制件的所有引用,然後才能從早期版本的 Windows 移植專案。

Windows `CFileDialog` Vista 或更高版本不支援某些方法。 有關是否支援該方法的資訊,請查看各個方法主題。 此外,Windows Vista 或更高版本中不支援以下繼承函數:

- [CDialog:onInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::放大縮小字型功能 放大縮小字型功能](../../mfc/reference/cdialog-class.md#onsetfont)

類的視窗`CFileDialog`消息因您使用的作業系統而異。 例如,Windows XP 不支援[CDialog:::打開取消](../../mfc/reference/cdialog-class.md#oncancel)和[CDialog::類](../../mfc/reference/cdialog-class.md#onok)的`CFileDialog`OnOK。 但是,Windows Vista 和後來的作業系統確實支持它們。 有關產生的不同郵件及其接收順序的詳細資訊,請參閱[CFileDialog 範例:紀錄紀錄事件順序](../../overview/visual-cpp-samples.md)。

要使用`CFileDialog`物件,請首先`CFileDialog`使用 建構函數創建物件。 建構對話框後,可以設置或修改[CFileDialog::m_ofn](#m_ofn)結構中的任何值,以初始化對話方塊控制項的值或狀態。 結構`m_ofn`的類型`OPENFILENAME`。 有關詳細資訊,請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

初始化對話方塊控制項後,呼叫[CFileDialog::DoModal](#domodal)方法以顯示對話方塊,以便用戶可以鍵入路徑和檔名。 `DoModal`返回使用者按下「確定」(IDOK) 還是「取消」(IDCANCEL)按鈕。 如果`DoModal`返回 IDOK,則可以`CFileDialog`使用 其中一個公共成員函數來檢索使用者輸入的資訊。

> [!NOTE]
> 在 Windows Vista 或更高版本中,多次調用[IFileDialog:設定檔類型](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes)會導致錯誤。 對於 任何實`SetFileTypes`例 ,對`CFileDialog`的第二個調用將在 Windows Vista 中返回E_UNEXPECTED或更高版本。 某些`CFileDialog`方法函數呼叫`SetFileTypes`。 例如,對於`CFileDialog::DoModal``CFileDialog`生成[ASSERT](diagnostic-services.md#assert)的相同實體,對

`CFileDialog`包括幾個受保護的成員,允許您自定義處理共用衝突、檔名驗證和列表框更改通知。 這些受保護的成員是大多數應用程式不必使用的回調函數,因為默認處理是自動執行的。 這些函數的消息映射條目是必需的,因為它們是標準虛擬函數。

您可以使用 Windows [CommDlg 擴充錯誤](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)功能來確定在對話方塊的初始化過程中是否發生了錯誤,並瞭解有關該錯誤的詳細資訊。

對象的銷`CFileDialog`毀 會自動處理。 您不必呼叫[CDialog::結束對話](../../mfc/reference/cdialog-class.md#enddialog)。

要允許使用者選擇多個檔,請在調用`DoModal`之前設置OFN_ALLOWMULTISELECT標誌。 您必須提供您自己的檔名緩衝區,以適應返回的多個檔名的清單。 為此,在構造`m_ofn.lpstrFile``CFileDialog`之後,但在調`DoModal`用 之前,使用指向已分配的緩衝區的指標進行替換。

此外,必須使用`m_ofn.nMaxFile``m_ofn.lpstrFile`指向的緩衝區中的字元數進行設置。 如果將要選擇的最大檔案數設定為`n`,則所需的緩衝區大小`n * (_MAX_PATH + 1) + 1`為 。 緩衝區中返回的第一個專案是選擇檔的資料夾的路徑。 對於 Windows Vista 或更高樣式的對話框,目錄和檔名字符串為 null 終止,姓氏後具有額外的空字元。 此格式使資源管理器樣式對話框能夠返回包含空格的長檔名。 對於舊樣式的對話框,目錄和檔名字符串由空格分隔,函數使用短檔名對具有空格的檔名。

下面的範例展示如何使用緩衝區檢索和列出多個檔名。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

要更改緩衝區大小以回應使用者選擇多個檔名,必須從`CFileDialog` [CFileDialog:::onFileNameChange](#onfilenamechange)方法派生一個新類並重寫。

如果派生自`CFileDialog`的新類,則可以使用消息映射來處理任何消息。 要擴展預設消息處理,請從`CFileDialog`派生類,向新類添加消息映射,併為新消息提供成員函數。 不必提供挂鉤函數來自定義對話方塊。

要自定義對話框,請從`CFileDialog`派生類,提供自定義對話方塊樣本,並添加消息映射來處理來自擴展控制項的通知訊息。 將任何未處理的消息傳遞給基類。 您不必自定義挂鉤功能。

當您使用 Windows Vista`CFileDialog`或更高 樣式時,不能使用消息映射和對話方塊樣本。 相反,您必須將 COM 介面用於類似的功能。

關於如何使用的詳細資訊`CFileDialog`,請參閱[通用對話方塊類別](../../mfc/common-dialog-classes.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>需求

**標題:** afxdlgs.h

## <a name="cfiledialogaddcheckbutton"></a><a name="addcheckbutton"></a>檔案對話::新增檢查按鈕

向對話框添加檢查按鈕。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的檢查按鈕的 ID。

*斯特蘭*<br/>
檢查按鈕名稱。

*bChecked*<br/>
指示檢查按鈕當前狀態的布爾。 如果選中,為 TRUE;否則

### <a name="remarks"></a>備註

## <a name="cfiledialogaddcombobox"></a><a name="addcombobox"></a>檔案對話::新增康博盒

向對話框添加組合框。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的組合框的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddcontrolitem"></a><a name="addcontrolitem"></a>檔案對話::新增控制項目

將項添加到對話方塊中的容器控制項。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要將項添加到的容器控制件的 ID。

*dwIDItem*<br/>
項目的 ID。

*斯特蘭*<br/>
專案的文字。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddeditbox"></a><a name="addeditbox"></a>檔案對話::新增編輯框

向對話框添加編輯框。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的編輯框的 ID。

*斯特文字*<br/>
編輯框名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddmenu"></a><a name="addmenu"></a>檔案對話::新增選單

向對話框添加功能表。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的功能表的 ID。

*斯特蘭*<br/>
功能表名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddplace"></a><a name="addplace"></a>檔案對話::新增位置

將資料夾添加到可供使用者打開或儲存專案的地方清單中。

```cpp
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>參數

*lpszFolder*<br/>
要提供給使用者的資料夾的路徑。 這隻能是一個資料夾。

*達夫普*<br/>
指定資料夾在清單中的位置。

*psi*<br/>
指向 IShellItem 的指標,該指標表示要提供給使用者的資料夾。 這隻能是一個資料夾。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddpushbutton"></a><a name="addpushbutton"></a>檔案對話::新增按鈕

向對話框添加一個按鈕。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的按鈕的 ID。

*斯特蘭*<br/>
按鈕名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddradiobuttonlist"></a><a name="addradiobuttonlist"></a>檔案對話::新增無線按鈕清單

向對話框添加選項按鈕(也稱為單選按鈕)組。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的選項按鈕組的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddseparator"></a><a name="addseparator"></a>檔案對話::新增分離器

向對話框添加分隔符。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
分隔符的 ID 添加。

### <a name="remarks"></a>備註

## <a name="cfiledialogaddtext"></a><a name="addtext"></a>檔案對話::新增文字

將文字添加到對話框中。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要添加的文本的 ID。

*斯特文字*<br/>
文字名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogapplyofntoshelldialog"></a><a name="applyofntoshelldialog"></a>檔案對話::應用ofntoshell對話

根據`m_ofn`儲存在資料結構中的值更新[CFileDialog](../../mfc/reference/cfiledialog-class.md)的當前狀態。

```cpp
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>備註

在 Windows Vista 之前的 Windows 版本中,成員[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)數據結構與`CFileDialog`的狀態持續同步。 [對m_ofn](#m_ofn)成員變數的任何更改將立即反映在對話框的狀態中。 此外,對對話框狀態的任何更改都立即更新`m_ofn`成員變數。

在 Windows Vista 或更高`m_ofn`版本中, 成員變數`CFileDialog`中的值和 的狀態不保證同步。 此函數強制更新`CFileDialog`的狀態`m_ofn`以匹配 結構。 Windows 在[CFileDialog::Do 模式](#domodal)化 期間自動調用此功能。

有關如何在 Windows Vista 下`CFileDialog`或以後使用類別的詳細資訊,請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

  請參考[檔案對話「 的範例: 從 ShellDialog 更新](#updateofnfromshelldialog)。

## <a name="cfiledialogcfiledialog"></a><a name="cfiledialog"></a>檔案對話::檔案對話

調用此函數以建構標準 Windows 檔案對話方塊。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>參數

*b 開啟檔案對話*<br/>
[在]指定要建立的對話方塊類型的參數。 將設定為 TRUE 以建構**檔案開啟對話**框。 將其設置為 FALSE 以建構**檔案儲存為**對話方塊。

*lpszDefExt*<br/>
[在]預設檔名副檔名。 如果使用者在 Filename 框中不包含已知的副檔名(在使用者電腦上具有關聯的擴展名),*則 lpszDefExt*指定的擴展名將自動追加到檔名中。 如果此參數為 NULL,則不附加任何擴展。

*lpszFile 名稱*<br/>
[在]顯示在「檔名」框中的初始檔名。 如果為 NULL,則不顯示初始檔名。

*dwFlags*<br/>
[在]可用於自定義對話框的一個或多個標誌的組合。 有關這些標誌的說明,請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。 如果修改`m_ofn.Flags`結構成員,則在更改中使用位-OR 運算符以保持預設行為不變。

*lpszFilter*<br/>
[在]一系列字串對,用於指定可以應用於檔的篩選器。 如果指定檔案篩選器,則「檔案」清單中將僅顯示與篩選條件匹配的檔。 有關如何使用文件篩選器的詳細資訊,請參閱備註部分。

*pparentwnd*<br/>
[在]指向文件對話框的父視窗或所有者視窗的指標。

*dwSize*<br/>
[在]`OPENFILENAME`結構的大小。 此值取決於操作系統版本。 MFC 使用此參數確定要創建的相應類型的對話方塊。 默認大小 0 表示 MFC 代碼將根據執行程式的作業系統版本確定要使用的正確對話方塊大小。

*bVista風格*<br/>
[在]**注意**此參數在 Visual Studio 2008 及更高版本中可用,並且僅在 Windows Vista 中或更高版本中運行時才使用新樣式對話方塊。

指定檔案對話框樣式的參數。 將其設置為 TRUE 以使用新的 Vista 樣式檔對話方塊。 否則,將使用對話框的舊樣式。 有關在 Vista 下運行的詳細資訊,請參閱備註部分。

### <a name="remarks"></a>備註

根據*bOpenFileDialog*的值,建構**檔案打開**或 **「檔案儲存為**」對話框。

使用*lpszDefExt*指定預設擴充可能不會產生您期望的行為,因為很少可以預測哪些擴展在使用者的電腦上具有文件關聯。 如果需要對預設擴展的追加進行更多控制,可以從 派`CFileDialog`生 自己的類,並`CFileDialog::OnFileNameOK`重寫 方法以執行自己的擴展處理。

要使用戶能夠選擇多個檔,請在調用[DoModal](#domodal)之前設置OFN_ALLOWMULTISELECT標誌。 您必須提供自己的檔名緩衝區來存儲返回的多個檔名的清單。 在建構[CFileDialog](../../mfc/reference/cfiledialog-class.md)後,但在`DoModal`調用 之前,使用指向已分配的緩衝區的指標`m_ofn.lpstrFile`進行替換 來執行此操作。 此外,必須使用`m_ofn.nMaxFile`指向`m_ofn.lpstrFile`的緩衝區中的字元數進行設置。 如果將要選擇的最大檔案數設定為*n,* 則必要的緩衝區`n`大小為 *(_MAX_PATH = 1) = 1。 例如：

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

要使用戶能夠使用滑鼠或鍵盤調整資源管理器樣式對話方塊的大小,請設置OFN_ENABLESIZING標誌。 僅當提供挂鉤過程或自定義範本時,才需要設置此標誌。 該標誌僅適用於資源管理器樣式對話方塊;因此,該標誌僅適用於"資源管理器"樣式對話方塊。舊樣式對話框無法調整大小。

*lpszFilter*參數用於確定文件必須在檔案清單中顯示的檔名的類型。 字串對中的第一個字串描述篩選器;第二個字串指示要使用的檔名副檔名。 可以使用分號(';'字元)作為分隔符來指定多個擴展。 字串以兩個"&#124;"字元結束,後跟 NULL 字元。 也可以為此參數使用[CString](../../atl-mfc-shared/using-cstring.md)物件。

例如,Microsoft Excel 允許使用者打開具有擴充名 .xlc(圖表) 或 .xls(工作表)等的檔。 Excel 的篩選器可以編寫為:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

但是,如果您計劃使用此字串直接更新`OPENFILENAME`結構,則應用 null 字元"\0"而不是垂直條("&#124;")來分隔字串。

*bVistaStyle*參數僅在 Windows Vista 下或更高版本運行時才適用。 在早期版本的 Windows 下,將忽略此參數。 如果*bVistaStyle*設定為 TRUE,則當您使用 Visual Studio 2008 或更高版本編譯程式時,將使用新的 Vista 樣式**檔案對話框**。 否則,將使用以前的 MFC 樣式**檔案對話框**。

基於*bVistaStyle*的對話框不支援對話框樣本

### <a name="example"></a>範例

  請參考[CFileDialog::Do 模態的範例](#domodal)。

## <a name="cfiledialogdomodal"></a><a name="domodal"></a>檔案對話::Do 模態

呼叫此函數以顯示 Windows 通用檔案對話方塊,並允許使用者瀏覽檔和目錄並輸入檔名。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>傳回值

IDOK 或 IDCANCEL。 如果返回 IDCANCEL,請呼叫 Windows [CommDlg 擴充錯誤](/windows/win32/api/commdlg/nf-commdlg-commdlgextendederror)功能以確定是否發生了錯誤。

IDOK 和 IDCANCEL 是指示使用者選擇"確定"還是"取消"按鈕的常量。

### <a name="remarks"></a>備註

如果要通過設置`m_ofn`結構成員來初始化各種文件對話框選項,則應在調`DoModal`用 之前執行此操作,但在構造對話框物件之後。

例如,如果要允許使用者選擇多個檔,請在調用`DoModal`之前設置OFN_ALLOWMULTISELECT標誌,如本主題中的代碼示例所示。

當用戶按一下對話方塊的「確定」或「取消」按鈕,或從對話框的控制選單中選擇「關閉」選項時,控制件將返回到應用程式。 然後,您可以調用其他成員函數來檢索用戶輸入到對話方塊中的設置或資訊。

`DoModal`是從類`CDialog`重寫的虛擬函數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

## <a name="cfiledialogenableopendropdown"></a><a name="enableopendropdown"></a>檔案對話:開啟開啟下拉

在對話框中的「打開」或「儲存」按鈕上啟用下拉清單。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
下拉清單的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogendvisualgroup"></a><a name="endvisualgroup"></a>檔案對話::結束視覺群組

停止向對話框中的可視組添加元素。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>傳回值

如果成功,返回S_OK;否則為錯誤值。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetcheckbuttonstate"></a><a name="getcheckbuttonstate"></a>檔案對話::抓取檢查按鈕狀態

檢索對話框中複選框(複選框)的當前狀態。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
複選框的 ID。

*bChecked*<br/>
複選框的狀態。 TRUE 指示已檢查;FALSE 表示未選中。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetcontrolitemstate"></a><a name="getcontrolitemstate"></a>檔案對話框:抓取控制項目狀態

檢索對話框中找到的容器控制件中的項目的當前狀態。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的 ID。

*德沃州*<br/>
對從 CDCONTROLSTATE 枚舉中接收更多值之一的變數的引用,該引用指示控制項的當前狀態。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetcontrolstate"></a><a name="getcontrolstate"></a>檔案對話::取得控制狀態

檢索給定控制件的當前可見性和啟用狀態。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
控制項的識別碼。

*德沃州*<br/>
對從 CDCONTROLSTATE 枚舉中接收一個或多個值的變數的引用,該枚舉指示控制項的當前狀態。

### <a name="remarks"></a>備註

## <a name="cfiledialoggeteditboxtext"></a><a name="geteditboxtext"></a>檔案對話::取得編輯框文字

檢索編輯框控制件中的目前文字。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
編輯框的識別碼。

*斯特文字*<br/>
文字值。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetfileext"></a><a name="getfileext"></a>檔案對話::取得檔案Ext

呼叫此函數以檢索輸入到對話方塊中的檔名的副檔名。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>傳回值

檔名的副檔名。

### <a name="remarks"></a>備註

例如,如果輸入的檔的名稱是 DATA。TXT,`GetFileExt`傳回"TXT"。

如果`m_ofn.Flags`設定了OFN_ALLOWMULTISELECT標誌,則此字串包含一系列 null 終止字串,第一個字串是所選檔組的目錄路徑,後跟使用者選擇的所有檔案的名稱。 要檢查檔案路徑名稱,請使用[「獲取啟動位置](#getstartposition)」和[「獲取NextPathName」](#getnextpathname)成員函數。

## <a name="cfiledialoggetfilename"></a><a name="getfilename"></a>檔案對話::取得檔案名稱

呼叫此函數以檢索對話框中輸入的檔名的名稱。

```
CString GetFileName() const;
```

### <a name="return-value"></a>傳回值

檔案的名稱。

### <a name="remarks"></a>備註

檔的名稱包括首碼和副檔名。 例如,`GetFileName`將傳回「TEXT」。檔 C:_FILES_TEXT.DAT 的 DAT"。

如果`m_ofn.Flags`設定`OFN_ALLOWMULTISELECT`了 標誌,則應調用[GetStart定位](#getstartposition)和[GetNextPathName 來](#getnextpathname)檢索檔路徑名。

## <a name="cfiledialoggetfiletitle"></a><a name="getfiletitle"></a>檔案對話::取得檔案標題

呼叫此函式以檢索對話框中輸入的檔案的標題。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>傳回值

檔案的標題。

### <a name="remarks"></a>備註

檔的標題僅包括其首碼,沒有路徑或副檔名。 例如,`GetFileTitle`將返回檔 C:_FILES_TEXT.DAT 的"TEXT"

如果`m_ofn.Flags`設定了OFN_ALLOWMULTISELECT標誌,則此字串包含一系列 null 終止字串,第一個字串是所選檔組的目錄路徑,後跟使用者選擇的所有檔案的名稱。 因此,請使用[「獲取啟動位置](#getstartposition)」和[「GetNextPathName」](#getnextpathname)成員函數檢索清單中的下一個檔名。

### <a name="example"></a>範例

  請參考[CFileDialog::Do 模態的範例](#domodal)。

## <a name="cfiledialoggetfolderpath"></a><a name="getfolderpath"></a>檔案對話::抓取資料夾路徑

呼叫此成員函數以檢索資源管理器樣式的"打開"或"保存為通用"對話框的當前打開資料夾或目錄的路徑。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>傳回值

包含當前打開的資料夾或目錄的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件。

### <a name="remarks"></a>備註

對話框必須使用OFN_EXPLORER樣式創建;因此,該對話框必須使用 OFN_EXPLORER 樣式創建。否則,該方法將失敗與斷言。

僅當顯示對話方塊時,才能調用此方法。 關閉對話方塊後,此函數將不再工作,並且該方法將失敗,斷言。

## <a name="cfiledialoggetifiledialogcustomize"></a><a name="getifiledialogcustomize"></a>檔案對話::取得檔案對話自訂

檢索指向給定[CFileDialog](../../mfc/reference/cfiledialog-class.md)的內部 COM 物件的指標。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>傳回值

指向的內部 COM 物件的`CFileDialog`指標 。 您有責任適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 下或以後使用將*bVistaStyle*設置為 TRUE 的物件使用此功能。 如果在*bVistaStyle*為 FALSE 時使用此函數,它將在釋放模式下返回 NULL,並在調試模式下引發斷言。

有關該介面的詳細資訊,`IFileDialogCustomize`請參考[IFileDialog 自訂](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

### <a name="example"></a>範例

此示例檢索內部 COM 物件。 要運行此代碼示例,必須在 Windows Vista 或更高版本中編譯它。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

## <a name="cfiledialoggetifileopendialog"></a><a name="getifileopendialog"></a>檔案對話::取得I檔案開啟對話框

檢索指向給定`CFileDialog`的內部 COM 物件的指標。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>傳回值

指向的內部 COM 物件的`CFileDialog`指標 。 您有責任適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 下或以後使用將*bVistaStyle*設置為 TRUE 的物件使用此功能。 如果 不是**打開**對話框`CFileDialog`或*bVistaStyle*設置為 FALSE,則此功能將返回 NULL。 在最後情況下,函數僅在釋放模式下返回 NULL - 在調試模式下,它將引發斷言。

關於該介面的詳細資訊,`IFileOpenDialog`請參考[IFileOpenDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)。

### <a name="example"></a>範例

此示例檢索內部 COM 物件。 要運行此代碼,必須在 Windows Vista 下或更高版本中編譯它。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

## <a name="cfiledialoggetifilesavedialog"></a><a name="getifilesavedialog"></a>檔案對話::取得I檔案儲存對話框

檢索指向給定`CFileDialog`的內部 COM 物件的指標。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>傳回值

指向的內部 COM 物件的`CFileDialog`指標 。 您有責任適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 下或以後使用將*bVistaStyle*設置為 TRUE 的物件使用此功能。 如果不是 **"保存'** 對話`CFileDialog`框, 或者*bVistaStyle*設置為 FALSE,則此功能將返回 NULL。 在最後情況下,函數僅在釋放模式下返回 NULL - 在調試模式下,它將引發斷言。

有關該介面的詳細資訊,`IFileSaveDialog`請參考[IFileSaveDialog](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)。

### <a name="example"></a>範例

此示例檢索內部 COM 物件。 要運行此代碼示例,必須在 Windows Vista 或更高版本中編譯它。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

## <a name="cfiledialoggetnextpathname"></a><a name="getnextpathname"></a>檔案對話::抓取下一個路徑名稱

呼叫此函數從對話框中選擇的組中檢索下一個檔名。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>參數

*Pos*<br/>
對前一個或多個`GetNextPathName``GetStartPosition`函數調用返回的定位值的引用。 如果已達到清單的末尾,則 NULL。

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔名的路徑包括檔的標題以及整個目錄路徑。 例如,`GetNextPathName`將返回"C:_FILES_TEXT"檔 C:_FILES_TEXT.DAT 的 DAT"。 如果使用`GetNextPathName`調`GetStartPosition`用 建立初始位置,則可以在轉發反覆運算迴圈中使用。

如果所選內容僅包含一個檔,則將返回該檔名。

## <a name="cfiledialoggetofn"></a><a name="getofn"></a>檔案對話::GetOFN

檢索關聯的`OPENFILENAME`結構。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>傳回值

[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

### <a name="remarks"></a>備註

使用此函數的第二個版本在建構後,但在使用`DoModal`成員函數顯示之前,初始化**了檔打開**或**檔保存為**對話框的外觀。 例如,您可以將`lpstrTitle`其成員`m_ofn`設置為希望對話方塊具有的標題。

## <a name="cfiledialoggetpathname"></a><a name="getpathname"></a>檔案對話::抓取路徑名稱

調用此函數以檢索對話框中輸入的檔的完整路徑。

```
CString GetPathName() const;
```

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔名的路徑包括檔的標題以及整個目錄路徑。 例如,`GetPathName`將返回"C:_FILES_TEXT"檔 C:_FILES_TEXT.DAT 的 DAT"。

如果`m_ofn.Flags`設置了OFN_ALLOWMULTISELECT標誌集,則此字串包含一系列空壓縮字串,第一個字串是所選檔組的目錄路徑,後跟使用者選擇的所有檔的名稱。 因此,請使用[「獲取啟動位置](#getstartposition)」和[「GetNextPathName」](#getnextpathname)成員函數檢索清單中的下一個檔名。

### <a name="example"></a>範例

  請參考[CFileDialog::Do 模態的範例](#domodal)。

## <a name="cfiledialoggetreadonlypref"></a><a name="getreadonlypref"></a>檔案對話::取得唯讀

呼叫此函數以確定「唯讀」複選框是否已在 Windows 標準檔打開和檔案儲存為對話框中選中。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>傳回值

如果選擇了對話方塊中的「唯讀」複選框,則非零;否則 0。

### <a name="remarks"></a>備註

通過在`CFileDialog`建構函數中設置OFN_HIDEREADONLY樣式,可以隱藏"唯讀"複選框。

> [!NOTE]
> Windows Vista`CFileDialog`或更高版本的樣式物件不支援此功能。 試著在 Windows Vista 或更高`CFileDialog`版本的樣式 上使用此函數將引發[CNot 支援異常](../../mfc/reference/cnotsupportedexception-class.md)。

## <a name="cfiledialoggetresult"></a><a name="getresult"></a>檔案對話::抓取結果

檢索用戶在對話框中所做的選擇。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>傳回值

指向表示用戶選擇的 IShellItem 的指標。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetresults"></a><a name="getresults"></a>檔案對話::抓取結果

在允許多次選擇的對話框中檢索用戶的選擇。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>傳回值

指向 IShellItemArray 的指標,透過該指標可以訪問對話框中選擇的專案。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetselectedcontrolitem"></a><a name="getselectedcontrolitem"></a>檔案對話::取得所選取的控制項目

從對話方塊中的指定容器控制件檢索特定項。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
使用者在控制項中選擇的項的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialoggetstartposition"></a><a name="getstartposition"></a>檔案對話::抓取起始位置

如果設定了OFN_ALLOWMULTISELECT標誌,`m_ofn.Flags`則調用此成員函數以檢索清單中第一個檔路徑名的位置。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>傳回值

可用於反覆運算的定位值;如果清單為空,則為 NULL。

## <a name="cfiledialoghidecontrol"></a><a name="hidecontrol"></a>檔案對話::隱藏控制

呼叫此成員函數以在資源管理器樣式的"打開"或"保存為常見"對話框中隱藏指定的控制項。

```cpp
void HideControl(int nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
要隱藏的控制項的識別碼。

### <a name="remarks"></a>備註

對話框必須使用OFN_EXPLORER樣式創建;因此,該對話框必須使用 OFN_EXPLORER 樣式創建。否則,函數將失敗與斷言。

## <a name="cfiledialogispickfoldersmode"></a><a name="ispickfoldersmode"></a>檔案對話框::正在選取資料夾模式

確定當前對話框是否處於資料夾選取器模式。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>傳回值

如果對話框處於資料夾選取器模式,則為 TRUE;如果對話框處於資料夾選取器模式。"否則 FALSE。

### <a name="remarks"></a>備註

## <a name="cfiledialogm_ofn"></a><a name="m_ofn"></a>檔案對話::m_ofn

`m_ofn`是類型的`OPENFILENAME`結構。 此結構中的數據表示的`CFileDialog`當前狀態。

### <a name="remarks"></a>備註

使用此結構在建構**檔案打開**或**檔案保存為**對話框後,但在使用[DoModal](#domodal)方法顯示之前,可以初始化它的外觀。 例如,您可以將的`m_ofn` *lpstrTitle*成員設置為希望對話方塊具有的標題。

使用 Windows Vista 或[CFileDialog](../../mfc/reference/cfiledialog-class.md)`m_ofn`的更高樣式時,不能保證始終匹配對話框的狀態。 它與早期版本的 Windows 中的對話框同步。 請參閱[CFileDialog:應用 OFNToShellDialog](#applyofntoshelldialog)和[CFileDialog::更新 OfofofShellDialog,](#updateofnfromshelldialog)瞭解`m_ofn`有關在`CFileDialog`Windows Vista 下或更高 版本中同步結構和狀態的詳細資訊。

Windows Vista 或更高版本的樣式文件對話方塊不`CFileDialog`支援 的某些成員和標誌。 因此,這些將不起作用。

以下是 Windows Vista 或更高版本不支援的成員清單:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

不支援以下標誌,因此在使用 Windows Vista 或`CFileDialog`更高版本的 樣式時不起作用:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES - 在 Windows Vista 或更高版本中始終有效開啟

- OFN_NOLONGNAMES - Windows Vista 或更高版本中始終有效關閉

- OFN_NONETWORKBUTTON - Windows Vista 或更高版本中始終有效開啟

- OFN_READONLY

- OFN_SHOWHELP

有關此結構的詳細資訊,請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

## <a name="cfiledialogmakeprominent"></a><a name="makeprominent"></a>檔案對話::製作突出

在對話框中放置控件,使其與其他控制項相比脫穎而出。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
控制項的識別碼。

### <a name="remarks"></a>備註

## <a name="cfiledialogonbuttonclicked"></a><a name="onbuttonclicked"></a>檔案對話::點擊按鈕

按下按鈕時調用。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
按鈕的識別碼。

### <a name="remarks"></a>備註

## <a name="cfiledialogoncheckbuttontoggled"></a><a name="oncheckbuttontoggled"></a>檔案對話::開啟檢查按鈕切換

選中或取消選中複選框時調用。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
複選框的 ID。

*bChecked*<br/>
已選中或未選中。

### <a name="remarks"></a>備註

## <a name="cfiledialogoncontrolactivating"></a><a name="oncontrolactivating"></a>檔案對話::在控制啟動

啟動控件時調用。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
控制項的識別碼。

### <a name="remarks"></a>備註

## <a name="cfiledialogonfilenamechange"></a><a name="onfilenamechange"></a>檔案對話::檔案名稱變更

如果要處理WM_NOTIFYCDN_SELCHANGE消息,則重寫此方法。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>備註

當使用者在 **「打開**」或「**另存為」** 對話框的檔案清單中選擇新檔案或資料夾時,系統將發送CDN_SELCHANGE郵件。 如果要執行回應此消息的任何操作,則重寫此方法。

僅當對話框在啟用OFN_EXPLORER標誌時創建時,系統才會發送此消息。 有關通知的詳細資訊,請參閱[CDN_SELCHANGE](/windows/win32/dlgbox/cdn-selchange)。 有關OFN_EXPLORER標誌的資訊,請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構以及[「打開並另存為對話框](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)」。

## <a name="cfiledialogonfilenameok"></a><a name="onfilenameok"></a>檔案對話::在檔案名稱OK

僅當要提供在常見文件對話框中輸入的檔名的自定義驗證時,才重寫此函數。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>傳回值

如果檔名不是有效的檔名,則為 1;否則 0。

### <a name="remarks"></a>備註

此函數允許您出於任何特定於應用程式的原因拒絕檔名。 通常,您不需要使用此函數,因為框架提供檔名的默認驗證,並在輸入無效的檔名時顯示消息框。

如果返回 1,該對話方塊將保持顯示,以便使用者輸入另一個檔名。 如果返回為 0,則對話框過程將關閉該對話方塊。 其他非零返回值當前是保留的,不應使用。

## <a name="cfiledialogonfolderchange"></a><a name="onfolderchange"></a>檔案對話::開啟資料夾變更

重寫此函數以處理WM_NOTIFYCDN_FOLDERCHANGE消息。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>備註

在"打開"或"另存為"對話框中打開新資料夾時,將發送通知消息。

僅當使用OFN_EXPLORER樣式創建對話方塊時,才會發送通知。 有關通知的詳細資訊,請參閱[CDN_FOLDERCHANGE](/windows/win32/dlgbox/cdn-folderchange)。 有關OFN_EXPLORER樣式的資訊,請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構以及[「打開並另存為對話框](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)」。

## <a name="cfiledialogoninitdone"></a><a name="oninitdone"></a>檔案對話::OnInitdone

重寫此函數以處理WM_NOTIFYCDN_INITDONE消息。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>備註

當系統在 **「打開**」或「**另存為」** 對話框中完成排列控制項,為子對話框的控制器騰出空間時,系統將發送此通知訊息。

僅當使用OFN_EXPLORER樣式創建對話框時,系統才會發送此對話方塊。 有關通知的詳細資訊,請參閱[CDN_INITDONE](/windows/win32/dlgbox/cdn-initdone)。 有關OFN_EXPLORER樣式的資訊,請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構以及[「打開並另存為對話框](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)」。

> [!NOTE]
> Windows Vista 或更高版本的樣式文件對話方塊不支援此功能。 試著在 Windows Vista 或更高樣式檔案對話框上使用此函數將引發[CNot 支援異常](../../mfc/reference/cnotsupportedexception-class.md)。

## <a name="cfiledialogonitemselected"></a><a name="onitemselected"></a>檔案對話::項目選定

選擇容器項時調用。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogonlbselchangednotify"></a><a name="onlbselchangednotify"></a>檔案對話::在LBSel改變通知

每當清單框中的當前選擇即將更改時,都會調用此功能。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>參數

*nIDBox*<br/>
發生選擇的清單框或組合框的 ID。

*iCurSel*<br/>
當前選擇的索引。

*n代碼*<br/>
控件通知代碼。 這個參數必須具有以下值之一:

- CD_LBSELCHANGE指定*iCurSel*是單選清單框中的選定專案。

- CD_LBSELSUB 指定不再在多選清單框中選擇*iCurSel。*

- CD_LBSELADD 指定在多選清單框中選擇*iCurSel。*

- CD_LBSELNOITEMS 指定多選清單框中不存在選擇。

### <a name="remarks"></a>備註

重寫此函數以在清單框中提供選擇更改的自定義處理。 例如,可以使用此函數顯示使用者選擇的每個檔的訪問許可權或上次修改日期。

## <a name="cfiledialogonshareviolation"></a><a name="onshareviolation"></a>檔案對話::在共用衝突

重寫此函數以提供對共享衝突的自定義處理。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>參數

*lpszPath名稱*<br/>
發生共用衝突的檔的路徑。

### <a name="return-value"></a>傳回值

下列其中一個值：

- OFN_SHAREFALLTHROUGH從對話框返回檔名。

- OFN_SHARENOWARN無需採取進一步行動。

- OFN_SHAREWARN使用者會收到此錯誤的標準警告消息。

### <a name="remarks"></a>備註

通常,您不需要使用此函數,因為框架提供預設的共用衝突檢查,並在發生共用衝突時顯示消息框。

如果要關閉共享衝突檢查,請使用位元或運算子將標誌OFN_SHAREAWARE與`m_ofn.Flags`。

## <a name="cfiledialogontypechange"></a><a name="ontypechange"></a>檔案對話::在類型變更上

重寫此函數以處理WM_NOTIFYCDN_TYPECHANGE消息。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>備註

當使用者從"打開"或"另存為"對話框中的檔案類型清單中選擇新檔案類型時,將發送通知消息。

僅當使用OFN_EXPLORER樣式創建對話方塊時,才會發送通知。 有關通知的詳細資訊,請參閱[CDN_TYPECHANGE](/windows/win32/dlgbox/cdn-typechange)。 有關OFN_EXPLORER樣式的資訊,請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構以及[「打開並另存為對話框](/windows/win32/dlgbox/open-and-save-as-dialog-boxes)」。

## <a name="cfiledialogremovecontrolitem"></a><a name="removecontrolitem"></a>檔案對話::移除控制項目

從對話方塊中的容器控制件中刪除項。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
要從中刪除項的容器控制件的 ID。

*dwIDItem*<br/>
項目的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcheckbuttonstate"></a><a name="setcheckbuttonstate"></a>檔案對話::設定檢查按鈕狀態

設置對話框中複選框(複選框)的當前狀態。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
複選框的 ID。

*bChecked*<br/>
複選框的狀態。 TRUE 指示已檢查;FALSE 表示未選中。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcontrolitemstate"></a><a name="setcontrolitemstate"></a>檔案對話框::設定控制項狀態

設置對話框中容器控制項中的項目的當前狀態。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的 ID。

*德沃州*<br/>
來自 CDCONTROLSTATE 枚舉的一個或多個值,指示控制項的新狀態。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcontrolitemtext"></a><a name="setcontrolitemtext"></a>檔案對話::設定控制項目文字

設定控制項項的文字。 例如,帶有單選按鈕或功能表中的專案的文本。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的 ID。

*斯特蘭*<br/>
專案的文字。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcontrollabel"></a><a name="setcontrollabel"></a>檔案對話::設定控制標籤

設置與控制項關聯的文字,如按鈕文本或編輯框標籤。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
控制項的識別碼。

*斯特蘭*<br/>
控制項名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcontrolstate"></a><a name="setcontrolstate"></a>檔案對話::設定控制狀態

設置給定控制件的當前可見性和啟用狀態。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
控制項的識別碼。

*德沃州*<br/>
來自 CDCONTROLSTATE 枚舉的一個或多個值,指示控制項的當前狀態。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetcontroltext"></a><a name="setcontroltext"></a>檔案對話::設定控制文字

呼叫此方法以在資源管理器樣式**的「打開**」或「**另存為」** 對話框中設定指定控制項的文字。

```cpp
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]要為其設定文本的控制項的 ID。

*lpsz*<br/>
[在]指向要為控制項設定的文字的字串的指標。

### <a name="remarks"></a>備註

此函數的兩個版本都適用於使用 Unicode 的應用程式。 但是,只有具有 LPCSTR 類型的版本才適用於使用 ANSI 的應用程式。

要使用此方法,必須使用OFN_EXPLORER樣式創建對話方塊。 否則,函數將失敗與斷言。

## <a name="cfiledialogsetdefext"></a><a name="setdefext"></a>檔案對話::設定DefExt

呼叫此函數可為資源管理器樣式的"打開"或"保存為常見"對話框設置預設檔名副檔名。

```cpp
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>參數

*lpsz*<br/>
指向包含用於對話方塊物件的預設副檔名的字串的指標。 此字串不能包含句點 (.)。

### <a name="remarks"></a>備註

對話框必須使用OFN_EXPLORER樣式創建;因此,該對話框必須使用 OFN_EXPLORER 樣式創建。否則,函數將失敗與斷言。

## <a name="cfiledialogseteditboxtext"></a><a name="seteditboxtext"></a>檔案對話::設定編輯框文字

在編輯框控制項中設定目前的文字。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
編輯框的識別碼。

*斯特文字*<br/>
文字值。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetproperties"></a><a name="setproperties"></a>檔案對話::設定屬性

提供屬性儲存區，可定義要用於所儲存之項目的預設值。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>參數

*lpszProplist*<br/>
預先定義的屬性清單，以 ";" 分隔。 有關標誌的清單,請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)的 **「標誌」** 部分。

### <a name="remarks"></a>備註

## <a name="cfiledialogsetselectedcontrolitem"></a><a name="setselectedcontrolitem"></a>檔案對話::設定選擇的控制項目

在選項按鈕組或對話方塊中找到的組合框中設置特定項的選定狀態。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
使用者在控制項中選擇的項的 ID。

### <a name="remarks"></a>備註

## <a name="cfiledialogsettemplate"></a><a name="settemplate"></a>檔案對話::設定樣本

設置[CFileDialog](../../mfc/reference/cfiledialog-class.md)物件的對話方塊樣本。

```cpp
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>參數

*nWin3ID*<br/>
[在]包含非資源管理員`CFileDialog`物件的範本資源的 ID 號。 此範本僅在 Windows NT 3.51 上或不存在OFN_EXPLORER樣式時使用。

*nWin4ID*<br/>
[在]包含資源管理員`CFileDialog`物件的範本資源的 ID 號。 此範本僅在 Windows NT 4.0 和更高版本、Windows 95 和更高版本或存在OFN_EXPLORER樣式時使用。

*lpWin3ID*<br/>
[在]包含非資源管理員`CFileDialog`物件的範本資源的名稱。 此範本僅在 Windows NT 3.51 上或不存在OFN_EXPLORER樣式時使用。

*lpWin4ID*<br/>
[在]包含資源管理員`CFileDialog`物件的範本資源的名稱。 此範本僅在 Windows NT 4.0 和更高版本、Windows 95 和更高版本或存在OFN_EXPLORER樣式時使用。

### <a name="remarks"></a>備註

系統將僅使用其中一個指定的範本。 系統根據OFN_EXPLORER樣式的存在和應用程式正在運行的作業系統確定要使用的範本。 通過同時指定非資源管理器和資源管理器樣式的範本,可以輕鬆支援 Windows NT 3.51、Windows NT 4.0 和更高版本以及 Windows 95 及更高版本。

> [!NOTE]
> Windows Vista 或更高版本的樣式文件對話方塊不支援此功能。 試著在 Windows Vista 或更高樣式的檔案對話框上使用此函數將引發[CNot 支援異常](../../mfc/reference/cnotsupportedexception-class.md)。 另一種方法是使用自定義對話方塊。 有關使用自訂`CFileDialog`的詳細資訊,請參閱[IFileDialog 自訂](/windows/win32/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

## <a name="cfiledialogstartvisualgroup"></a><a name="startvisualgroup"></a>檔案對話::開始視覺群組

在對話框中聲明可視組。 對任何「添加」方法的後續調用將這些元素添加到此組中。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*德維塞爾*<br/>
可視組的 ID。

*斯特蘭*<br/>
群組名稱。

### <a name="remarks"></a>備註

## <a name="cfiledialogupdateofnfromshelldialog"></a><a name="updateofnfromshelldialog"></a>檔案對話::從 ShellDialog 更新

根據內部`m_ofn`物件的當前狀態更新[CFileDialog](../../mfc/reference/cfiledialog-class.md)的數據結構。

```cpp
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>備註

在 Windows Vista 之前的 Windows 版本中,成員[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamea)數據結構與`CFileDialog`的狀態持續同步。 對[m_ofn](#m_ofn)成員變數的任何更改都直接影響對話框的狀態。 此外,對對話框狀態的任何更改都立即更新了m_ofn成員變數。

在 Windows Vista 或`m_ofn`更高版本中,數據結構不會自動更新。 為了保證`m_ofn`成員變數中數據的準確性,應在訪問數據之前調用`UpdateOFNFromShellDialog`該函數。 Windows 在處理[IFileDialog 時自動呼叫此功能:onFileOK](/windows/win32/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)。

有關如何在 Windows Vista 下`CFileDialog`或以後使用類別的詳細資訊,請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

這個範例在顯示`CFileDialog`它之前更新 。 在更新`m_ofn`成員變數之前,我們需要將其同步到對話框的當前狀態。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>另請參閱

[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)
