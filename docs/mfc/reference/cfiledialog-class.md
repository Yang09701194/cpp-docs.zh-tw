---
title: CFileDialog 類別
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: 87f99b4f037c8cc881b33e1d07b4f07596ee9a1b
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/15/2018
ms.locfileid: "51694539"
---
# <a name="cfiledialog-class"></a>CFileDialog 類別

封裝的一般的對話方塊中，開啟檔案或檔案儲存作業所用的。

## <a name="syntax"></a>語法

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|建構 `CFileDialog` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|加入對話方塊中的核取記號按鈕。|
|[CFileDialog::AddComboBox](#addcombobox)|將下拉式方塊加入至對話方塊中。|
|[CFileDialog::AddControlItem](#addcontrolitem)|在對話方塊中的容器控制項中加入項目。|
|[CFileDialog::AddEditBox](#addeditbox)|加入對話方塊中的編輯方塊。|
|[CFileDialog::AddMenu](#addmenu)|將功能表加入至對話方塊中。|
|[CFileDialog::AddPlace](#addplace)|多載。 加入至清單的資料夾將可供使用者開啟或儲存項目。|
|[CFileDialog::AddPushButton](#addpushbutton)|將按鈕加入至對話方塊中。|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|選項按鈕 （也稱為選項按鈕） 將群組加入至對話方塊。|
|[CFileDialog::AddSeparator](#addseparator)|加入對話方塊中的分隔符號。|
|[CFileDialog::AddText](#addtext)|加入對話方塊中的文字內容。|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|更新的狀態`CFileDialog`來比對參數和旗標儲存在`m_ofn`成員變數。|
|[CFileDialog::DoModal](#domodal)|顯示對話方塊，並可讓使用者進行選取。|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|啟用上的下拉式清單**開放**或是**儲存**對話方塊中的按鈕。|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|停止新增要視覺化的群組 對話方塊中的項目。|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|取得對話方塊中的核取按鈕 （核取方塊） 的目前狀態。|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|取得目前的對話方塊中找到的容器控制項中的項目狀態。|
|[CFileDialog::GetControlState](#getcontrolstate)|取得目前的可見性，並啟用指定的控制項狀態。|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|取得目前的文字編輯方塊控制項中。|
|[CFileDialog::GetFileExt](#getfileext)|傳回所選檔案的副檔名。|
|[CFileDialog::GetFileName](#getfilename)|傳回所選檔案的檔案名稱。|
|[CFileDialog::GetFileTitle](#getfiletitle)|傳回所選檔案的標題。|
|[CFileDialog::GetFolderPath](#getfolderpath)|擷取目前開啟的資料夾或目錄的路徑，檔案總管樣式**開啟**或是**另存新檔**通用對話方塊。|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|擷取內部的 COM 物件，如自訂`CFileDialog`物件。|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|擷取內部的 COM 物件，如`CFileDialog`做**開啟**檔案 對話方塊。|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|擷取內部的 COM 物件，如`CFileDialog`做**儲存**檔案 對話方塊。|
|[CFileDialog::GetNextPathName](#getnextpathname)|傳回下一步選取的檔案完整路徑。|
|[CFileDialog::GetOFN](#getofn)|擷取`OPENFILENAME`結構`CFileDialog`物件。|
|[CFileDialog::GetPathName](#getpathname)|傳回所選檔案的完整路徑。|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|傳回所選檔案的唯讀狀態。|
|[CFileDialog::GetResult](#getresult)|取得對話方塊中的使用者所做的選擇。|
|[CFileDialog::GetResults](#getresults)|在對話方塊中，可讓多個選取項目中取得使用者的選擇。|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|從對話方塊中指定的容器控制項中取得特定的項目。|
|[CFileDialog::GetStartPosition](#getstartposition)|傳回檔案的名稱 清單中的第一個元素的位置。|
|[CFileDialog::HideControl](#hidecontrol)|隱藏指定的控制項，在 檔案總管樣式**開放**或是**另存新檔**通用對話方塊。|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|判斷目前的對話方塊，在資料夾選擇器模式中。|
|[CFileDialog::MakeProminent](#makeprominent)|上的芳鄰 對話方塊中的控制項，讓它脫穎而出相較於其他新增的控制項。|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|在對話方塊中的容器控制項中移除的項目。|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|在對話方塊中設定的核取按鈕 （核取方塊） 的目前狀態。|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|在對話方塊中找到的容器控制項中設定項目的目前狀態。|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|設定控制項項目的文字。 例如，文字所附的選項按鈕或功能表項目。|
|[CFileDialog::SetControlLabel](#setcontrollabel)|設定控制項，例如按鈕文字或編輯方塊標籤相關聯的文字。|
|[CFileDialog::SetControlState](#setcontrolstate)|設定目前的可見性，並啟用指定的控制項狀態。|
|[CFileDialog::SetControlText](#setcontroltext)|設定指定之控制項的文字在檔案總管樣式**開放**或是**另存新檔**通用對話方塊。|
|[Setdefext](#setdefext)|設定預設的檔案名稱副檔名的檔案總管樣式**開放**或是**另存新檔**通用對話方塊。|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|設定目前的文字編輯方塊控制項中。|
|[CFileDialog::SetProperties](#setproperties)|提供屬性儲存區，可定義要用於所儲存之項目的預設值。|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|設定中的選項按鈕群組或下拉式方塊的對話方塊中找到的特定項目的選取的狀態。|
|[CFileDialog::SetTemplate](#settemplate)|設定的對話方塊範本`CFileDialog`物件。|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|宣告在對話方塊中的視覺化群組。 「 新增 」 的任何方法的後續呼叫會將這些項目加入此群組。|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|更新儲存在資料`m_ofn`成員變數，以符合 [檔案] 對話方塊中的目前狀態。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|當按一下按鈕時呼叫。|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|勾選/取消核取此核取方塊時呼叫。|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|當控制項正在使用中時呼叫。|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|處理 WM_NOTIFY CDN_SELCHANGE 訊息。|
|[CFileDialog::OnFileNameOK](#onfilenameok)|驗證在對話方塊中輸入檔案名稱。|
|[CFileDialog::OnFolderChange](#onfolderchange)|處理 WM_NOTIFY CDN_FOLDERCHANGE 訊息。|
|[CFileDialog::OnInitDone](#oninitdone)|處理 WM_NOTIFY CDN_INITDONE 訊息。|
|[CFileDialog::OnItemSelected](#onitemselected)|所選取的容器項目時呼叫。|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|可讓您的檔案選取範圍變更時執行自訂動作。|
|[CFileDialog::OnShareViolation](#onshareviolation)|處理共用違規。|
|[CFileDialog::OnTypeChange](#ontypechange)|處理 WM_NOTIFY CDN_TYPECHANGE 訊息。|

### <a name="public-data-members"></a>公用資料成員

|名稱|描述|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Windows`OPENFILENAME`結構。 提供基本的檔案對話方塊方塊參數的存取權。|

## <a name="remarks"></a>備註

通用檔案對話方塊可讓您實作檔案選取對話方塊方塊中，例如**開啟的檔案**並**另存新檔**，與 Windows 標準一致的方式。

您可以使用`CFileDialog`現況提供，建構函式，或您可以衍生您自己的對話方塊類別從`CFileDialog`和寫入的建構函式，以符合您的需求。 在任一情況下，這些對話方塊會表現標準的 MFC 對話方塊因為它們衍生自[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)。 `CFileDialog` 依賴 COMMDLG。包含在 Windows 中的 DLL 檔案。

外觀和功能的`CFileDialog`與舊版 Windows 的不同的 Windows vista 或更新版本。 預設值`CFileDialog`會自動使用新的 Windows Vista 或更新版本的樣式，無須變更程式碼，如果程式是編譯和執行 Windows vista 或更新版本。 使用*bVistaStyle*參數的建構函式來手動覆寫這個自動更新。 自動更新的例外狀況是自訂的對話方塊。 它們不會轉換成新的樣式。 如需有關建構函式的詳細資訊，請參閱 < [CFileDialog::CFileDialog](#cfiledialog)。

> [!NOTE]
>  控制識別碼系統與在 Windows Vista 或更新版本從舊版的 Windows 當您使用`CFileDialog`。 您必須更新所有參考`CFileDialog`在程式碼之前，您可以移植您的專案從舊版 Windows 中的控制項。

某些`CFileDialog`方法不支援在 Windows Vista 或更新版本。 請檢查是否支援該方法的相關資訊的個別方法主題。 此外，下列繼承的函式不支援在 Windows Vista 或更新版本：

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

Windows 訊息`CFileDialog`類別視您正在使用哪個作業系統。 比方說，不支援 Windows XP [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel)並[CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok)如`CFileDialog`類別。 不過，Windows Vista 和更新版本的作業系統並支援它們。 如需有關不同所產生的訊息並接收它們的順序的詳細資訊，請參閱[CFileDialog 範例： 記錄事件順序](../../visual-cpp-samples.md)。

若要使用`CFileDialog`物件，請先建立物件，使用`CFileDialog`建構函式。 在建構對話方塊之後，您可以設定或修改中的任何值[CFileDialog::m_ofn](#m_ofn)結構初始化的值或對話方塊控制項的狀態。 `m_ofn`結構的類型是`OPENFILENAME`。 如需詳細資訊，請參閱 < [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK 中的結構。

初始化對話方塊控制項之後，請呼叫[CFileDialog::DoModal](#domodal)方法，以顯示對話方塊方塊，讓使用者可以輸入路徑和檔案名稱。 `DoModal` 傳回使用者是否按一下 [確定] (IDOK) 或 [取消 (IDCANCEL)] 按鈕。 如果`DoModal`傳回 IDOK，您可以使用其中一個`CFileDialog`公用成員函式來擷取資訊放入使用者。

> [!NOTE]
> 在 Windows Vista 或更新版本中，多次呼叫[IFileDialog::SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes)會造成錯誤。 第二次呼叫`SetFileTypes`之執行個體`CFileDialog`會傳回 E_UNEXPECTED，在 Windows Vista 或更新版本。 有些`CFileDialog`方法函式會呼叫`SetFileTypes`。 例如，兩個呼叫來`CFileDialog::DoModal`同一個執行個體`CFileDialog`會產生[ASSERT](diagnostic-services.md#assert)。

`CFileDialog` 包含幾個受保護的成員，讓您執行自訂處理共用違規 」、 「 檔案名稱驗證和 「 清單方塊變更通知。 這些受保護的成員是大部分的應用程式並沒有使用，因為預設的處理會自動執行的回呼函式。 訊息對應項目，這些函式不是必要的因為它們是標準虛擬函式。

您可以使用 Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror)函式來判斷是否在對話方塊的初始化期間發生錯誤，以及了解錯誤的詳細資訊。

損毀的`CFileDialog`物件會自動處理。 您沒有呼叫[CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog)。

若要讓使用者選取多個檔案、 設定 OFN_ALLOWMULTISELECT 旗標，然後再呼叫`DoModal`。 您必須提供您自己來容納傳回的多個檔案名稱清單的檔案名稱緩衝區。 執行這項操作來取代`m_ofn.lpstrFile`與緩衝區的指標所配置的之後您建構, `CFileDialog`，然後再呼叫，但`DoModal`。

此外，您必須設定`m_ofn.nMaxFile`所指向的緩衝區中使用的字元數`m_ofn.lpstrFile`。 如果您設定要選取的檔案數目上限`n`，必要的緩衝區大小是`n * (_MAX_PATH + 1) + 1`。 傳回緩衝區中的第一個項目是已在所選取檔案之資料夾的路徑。 Windows Vista 或更新版本樣式對話方塊、 目錄和檔案名稱的字串是 null 結束，額外的 null 字元之後的最後一個檔案名稱。 此格式可讓 [檔案總管樣式] 對話方塊，以傳回包含空格的長檔名。 舊式的對話方塊，目錄和檔案名稱的字串會以空格分隔，並用函式的檔案名稱的簡短檔案名稱有空格。

下列範例示範如何使用緩衝區來擷取，並列出多個檔案名稱。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

若要變更以回應使用者選取多個檔案名稱的緩衝區大小，您必須衍生新的類別，從`CFileDialog`，並覆寫[CFileDialog::OnFileNameChange](#onfilenamechange)方法。

如果您衍生新的類別，從`CFileDialog`，您可以使用訊息對應來處理任何訊息。 若要擴充的預設訊息處理，衍生的類別`CFileDialog`、 將訊息對應新增至新的類別，並提供成員函式，為新的訊息。 您不必提供自訂對話方塊中的攔截函式。

若要自訂對話方塊中，衍生的類別`CFileDialog`、 提供自訂對話方塊範本，及新增的訊息對應來處理從擴充的控制項通知訊息。 將任何未處理的訊息傳遞至基底類別。 您沒有自訂攔截函式。

當您使用 Windows Vista 或更新版本的樣式`CFileDialog`，您無法使用訊息對應和對話方塊範本。 相反地，您必須使用 COM 介面來執行類似功能。

如需有關如何使用`CFileDialog`，請參閱 <<c2> [ 通用對話方塊類別](../../mfc/common-dialog-classes.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>需求

**標頭：** afxdlgs.h

##  <a name="addcheckbutton"></a>  CFileDialog::AddCheckButton

加入對話方塊中的核取記號按鈕。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增核取按鈕的識別碼。

*strLabel*<br/>
核取按鈕名稱。

*bChecked*<br/>
布林值，表示核取按鈕的目前狀態。 如果已核取，則為 TRUE。FALSE 否則

### <a name="remarks"></a>備註

##  <a name="addcombobox"></a>  CFileDialog::AddComboBox

將下拉式方塊加入至對話方塊中。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
將下拉式方塊的識別碼。

### <a name="remarks"></a>備註

##  <a name="addcontrolitem"></a>  CFileDialog::AddControlItem

在對話方塊中的容器控制項中加入項目。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入項目的容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

*strLabel*<br/>
項目的文字。

### <a name="remarks"></a>備註

##  <a name="addeditbox"></a>  CFileDialog::AddEditBox

加入對話方塊中的編輯方塊。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增 [編輯] 方塊的識別碼。

*先把 strText*<br/>
編輯方塊名稱。

### <a name="remarks"></a>備註

##  <a name="addmenu"></a>  CFileDialog::AddMenu

將功能表加入至對話方塊中。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增功能表的識別碼。

*strLabel*<br/>
功能表名稱。

### <a name="remarks"></a>備註

##  <a name="addplace"></a>  CFileDialog::AddPlace

加入至清單的資料夾將可供使用者開啟或儲存項目。

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>參數

*lpszFolder*<br/>
若要可供使用者資料夾的路徑。 這只能是一個資料夾。

*fdap*<br/>
指定的資料夾清單中的放置位置。

*psi*<br/>
代表可供使用者使用的資料夾 IShellItem 指標。 這只能是一個資料夾。

### <a name="remarks"></a>備註

##  <a name="addpushbutton"></a>  CFileDialog::AddPushButton

將按鈕加入至對話方塊中。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增按鈕的識別碼。

*strLabel*<br/>
按鈕名稱。

### <a name="remarks"></a>備註

##  <a name="addradiobuttonlist"></a>  CFileDialog::AddRadioButtonList

選項按鈕 （也稱為選項按鈕） 將群組加入至對話方塊。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增選項按鈕群組的識別碼。

### <a name="remarks"></a>備註

##  <a name="addseparator"></a>  CFileDialog::AddSeparator

加入對話方塊中的分隔符號。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
加入分隔符號的識別碼。

### <a name="remarks"></a>備註

##  <a name="addtext"></a>  CFileDialog::AddText

將文字加入至對話方塊。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要新增的文字識別碼。

*先把 strText*<br/>
文字名稱。

### <a name="remarks"></a>備註

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

更新的目前狀態[CFileDialog](../../mfc/reference/cfiledialog-class.md)中儲存的值為基礎`m_ofn`資料結構。

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>備註

Windows Vista 中，成員之前的 Windows 版本中[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)持續資料結構進行同步處理狀態為  `CFileDialog`。 任何變更[m_ofn](#m_ofn)成員變數立即反映在對話方塊中的狀態。 此外，任何對話方塊中的狀態變更立即更新`m_ofn`成員變數。

在 Windows Vista 或更新版本中的值`m_ofn`成員變數和狀態`CFileDialog`不保證同步處理。 此函式會強制的狀態`CFileDialog`更新為符合`m_ofn`結構。 Windows 會呼叫此函式期間自動[CFileDialog::DoModal](#domodal)。

如需有關如何使用`CFileDialog`類別在 Windows Vista 或更新版本，請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

  範例，請參閱[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)。

##  <a name="cfiledialog"></a>  CFileDialog::CFileDialog

呼叫此函式來建構標準 Windows 檔案 對話方塊。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>參數

*bOpenFileDialog*<br/>
[in]指定的對話方塊來建立類型的參數。 將它設定為 TRUE 來建構**開啟舊檔** 對話方塊。 將它設定為 FALSE，以建構**另存新檔** 對話方塊。

*lpszDefExt*<br/>
[in]預設檔案名稱的副檔名。 如果使用者不包含檔案名稱 方塊中的已知的副檔名 （一個具有關聯使用者的電腦上），所指定的延伸模組*lpszDefExt*會自動附加至檔案名稱。 如果此參數為 NULL，則會附加不含副檔名。

*lpszFileName*<br/>
[in]初始檔案名稱出現在 [檔案名稱] 方塊中。 如果是 NULL，則會不出現任何初始檔案名稱。

*dwFlags*<br/>
[in]您可以使用自訂對話方塊中的一或多個旗標的組合。 如需這些旗標的描述，請參閱 < [OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK 中的結構。 如果您修改`m_ofn.Flags`結構成員，請使用您的變更的位元 OR 運算子，以讓預設行為保持不變。

*lpszFilter*<br/>
[in]指定篩選條件的字串組的一系列您可以套用至檔案。 如果您指定檔案篩選器時，只有符合篩選準則的檔案才會出現在檔案清單中。 請參閱 < 備註 > 一節，如需有關如何使用檔案篩選器。

*pParentWnd*<br/>
[in][檔案] 對話方塊中的父代或擁有者視窗指標。

*dwSize*<br/>
[in]大小`OPENFILENAME`結構。 這個值取決於作業系統的版本。 MFC 會使用這個參數來判斷的對話方塊來建立適當類型。 預設大小為 0 表示 MFC 程式碼將會決定要使用正確的對話方塊大小會根據程式執行所在的作業系統版本。

*bVistaStyle*<br/>
[in]**注意**這個參數可在 Visual Studio 2008 及更新版本，將會導致 [新樣式] 對話方塊，您會執行在 Windows Vista 或更新版本時，才使用。

指定的檔案對話方塊樣式參數。 將它設定為 true 會使用新的 Vista 樣式檔案對話方塊。 否則，您將使用舊樣式的對話方塊。 請參閱 < 備註 > 一節的詳細資訊的相關 Vista 下執行。

### <a name="remarks"></a>備註

任一**開啟舊檔**或是**另存新檔**建構對話方塊時，根據的值*bOpenFileDialog*。

指定使用預設延伸模組*lpszDefExt*可能不會產生的行為，您預期，因為它是很少可預測哪些延伸模組會對使用者的電腦中的檔案關聯。 如果您需要更充分掌控附加的預設延伸模組，您可以衍生自己的類別，從`CFileDialog`，並覆寫`CFileDialog::OnFileNameOK`方法，以執行您自己的延伸模組處理。

若要讓使用者選取多個檔案，設定才能呼叫的 OFN_ALLOWMULTISELECT 旗標[DoModal](#domodal)。 您必須提供您自己來儲存傳回的多個檔案名稱清單的檔案名稱緩衝區。 執行這項操作來取代`m_ofn.lpstrFile`與緩衝區的指標所配置的之後您建構, [CFileDialog](../../mfc/reference/cfiledialog-class.md)，然後再呼叫，但`DoModal`。 此外，您必須設定`m_ofn.nMaxFile`所指向的緩衝區中的字元數目`m_ofn.lpstrFile`。 如果您設定要選取的檔案數目上限*n*，所需的緩衝區大小是`n`*(_MAX_PATH + 1) + 1。 例如: 

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

若要讓使用者使用滑鼠或鍵盤，調整大小檔案總管樣式 對話方塊中，設定 OFN_ENABLESIZING 旗標。 只有當您提供的攔截程序或自訂的範本時，才必須設定這個旗標。 旗標僅適用於檔案總管樣式 對話方塊中;無法調整舊樣式的對話方塊。

*LpszFilter*參數用來判斷檔案必須具有要在檔案清單中顯示的檔案名稱的型別。 字串組中的第一個字串描述的篩選器。第二個字串會指出要使用的副檔名。 可以指定多個延伸模組做為分隔符號使用分號 （';' 字元）。 字串結尾兩個 '&#124;' 個字元，後面接著 NULL 字元。 您也可以使用[CString](../../atl-mfc-shared/using-cstring.md)此參數的物件。

例如，Microsoft Excel 可讓使用者開啟延伸模組.xlc （圖表） 或.xls （工作表），以及其他檔案。 適用於 Excel 的篩選條件可以寫成：

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

不過，如果您計劃將此字串，以便直接更新`OPENFILENAME`結構中，您應該來分隔字串以 null 字元 '\0'，而不是分隔號 ('&#124;')。

*BVistaStyle*參數只有時才適用 Windows vista 或更新版本執行。 在舊版 Windows 中，會忽略這個參數。 如果*bVistaStyle*設定為 TRUE，當您編譯的程式，Visual Studio 2008 或更新版本中，新的 Vista 樣式**檔案對話方塊**將使用。 否則，先前的 MFC 樣式**檔案對話方塊**將使用。

對話方塊範本不支援根據對話方塊*bVistaStyle*

### <a name="example"></a>範例

  範例，請參閱[CFileDialog::DoModal](#domodal)。

##  <a name="domodal"></a>  CFileDialog::DoModal

呼叫此函式來顯示 Windows 通用檔案對話方塊中，而且允許使用者瀏覽檔案和目錄，並輸入檔案名稱。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>傳回值

IDOK 或 IDCANCEL。 如果傳回 IDCANCEL，呼叫 Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror)函式來判斷是否發生錯誤。

IDOK 及 IDCANCEL 是常數，指出使用者是否已選取 [確定] 或 [取消] 按鈕。

### <a name="remarks"></a>備註

如果您想要設定的成員初始化的各種不同的檔案對話方塊選項`m_ofn`結構中，您應該執行這項操作之前先呼叫`DoModal`，但在建構對話方塊物件之後。

例如，如果您想要允許使用者選取多個檔案，設定 OFN_ALLOWMULTISELECT 旗標，然後再呼叫`DoModal`，如本主題中的程式碼範例所示。

當使用者按一下對話方塊的 確定 或 取消 按鈕或選取 關閉選項對話方塊的控制項功能表時，會將程式控制權回到您的應用程式。 您可以再呼叫其他成員函式，以設定或資訊來擷取使用者輸入 對話方塊。

`DoModal` 是從類別中覆寫虛擬函式`CDialog`。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>  CFileDialog::EnableOpenDropDown

可讓下拉式清單中開啟或儲存在對話方塊中的按鈕。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
下拉式清單的識別碼。

### <a name="remarks"></a>備註

##  <a name="endvisualgroup"></a>  CFileDialog::EndVisualGroup

停止新增要視覺化的群組 對話方塊中的項目。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>傳回值

傳回 S_OK，如果登錄成功。否則為錯誤值。

### <a name="remarks"></a>備註

##  <a name="getcheckbuttonstate"></a>  CFileDialog::GetCheckButtonState

擷取在對話方塊中的核取按鈕 （核取方塊） 的目前狀態。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
核取方塊的狀態。 TRUE 表示已檢查;FALSE 表示未核取。

### <a name="remarks"></a>備註

##  <a name="getcontrolitemstate"></a>  CFileDialog::GetControlItemState

擷取目前的對話方塊中找到的容器控制項中的項目狀態。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

*dwState*<br/>
接收多個值的其中一個 CDCONTROLSTATE 列舉，指出控制項的目前狀態中的變數參考。

### <a name="remarks"></a>備註

##  <a name="getcontrolstate"></a>  CFileDialog::GetControlState

擷取目前的可見性，並啟用指定的控制項狀態。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的 ID。

*dwState*<br/>
接收從 CDCONTROLSTATE 列舉，指出控制項的目前狀態的一或多個值的變數參考。

### <a name="remarks"></a>備註

##  <a name="geteditboxtext"></a>  CFileDialog::GetEditBoxText

擷取目前的文字編輯方塊控制項中。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
編輯方塊的識別碼。

*先把 strText*<br/>
文字值。

### <a name="remarks"></a>備註

##  <a name="getfileext"></a>  CFileDialog::GetFileExt

呼叫此函式來擷取在對話方塊中輸入的檔名的副檔名。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>傳回值

檔名的副檔名。

### <a name="remarks"></a>備註

例如，如果輸入檔案的名稱是資料。TXT、`GetFileExt`傳回"TXT"。

如果`m_ofn.Flags`OFN_ALLOWMULTISELECT 旗標設定，這個字串包含一系列的 null 終止的字串，與所選取的檔案群組的目錄路徑的第一個字串後面的所有使用者所選取的檔案名稱。 若要擷取檔案的路徑名稱，請使用[GetStartPosition](#getstartposition)並[GetNextPathName](#getnextpathname)成員函式。

##  <a name="getfilename"></a>  CFileDialog::GetFileName

呼叫此函式來擷取在對話方塊中輸入的檔名的名稱。

```
CString GetFileName() const;
```

### <a name="return-value"></a>傳回值

檔案的檔名。

### <a name="remarks"></a>備註

檔案的名稱會包含前置詞和擴充功能。 比方說，`GetFileName`操作會傳回"文字。DAT"C:\FILES\TEXT.DAT 檔案。

如果`m_ofn.Flags`已經`OFN_ALLOWMULTISELECT`旗標設定，您應該呼叫[GetStartPosition](#getstartposition)並[GetNextPathName](#getnextpathname)擷取檔案的路徑名稱。

##  <a name="getfiletitle"></a>  CFileDialog::GetFileTitle

呼叫此函式來擷取在對話方塊中輸入檔案的標題。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>傳回值

檔案的標題。

### <a name="remarks"></a>備註

檔案的標題會包含只有它的前置詞，沒有路徑或副檔名。 比方說， `GetFileTitle` C:\FILES\TEXT.DAT 檔案將會傳回"TEXT"。

如果`m_ofn.Flags`OFN_ALLOWMULTISELECT 旗標設定，這個字串包含一系列的 null 終止的字串，與所選取的檔案群組的目錄路徑的第一個字串後面的所有使用者所選取的檔案名稱。 基於這個理由，使用[GetStartPosition](#getstartposition)並[GetNextPathName](#getnextpathname)成員函式來擷取下一步 清單中的檔案名稱。

### <a name="example"></a>範例

  範例，請參閱[CFileDialog::DoModal](#domodal)。

##  <a name="getfolderpath"></a>  CFileDialog::GetFolderPath

呼叫此成員函式可擷取目前開啟的資料夾或檔案總管樣式開啟] 或 [另存新檔通用的對話方塊中的目錄的路徑。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，包含目前開啟的資料夾或目錄。

### <a name="remarks"></a>備註

對話方塊中必須已經使用 OFN_EXPLORER 樣式中，建立否則，方法將會失敗與判斷提示。

只有當顯示對話方塊時，您可以呼叫這個方法。 在關閉對話方塊之後，此函式將無法再運作，和方法會判斷提示失敗。

##  <a name="getifiledialogcustomize"></a>  CFileDialog::GetIFileDialogCustomize

擷取內部 COM 物件的指標給定[CFileDialog](../../mfc/reference/cfiledialog-class.md)。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>傳回值

針對內部的 COM 物件的指標`CFileDialog`。 您必須負責適當地釋放這個指標。

### <a name="remarks"></a>備註

使用此函式只有在 Windows Vista 或更新版本的物件具有*bVistaStyle*設為 TRUE。 如果您使用此函式時*bVistaStyle*為 FALSE，則會傳回 NULL，在發行模式中，並在偵錯模式中擲回判斷提示。

如需詳細資訊`IFileDialogCustomize`介面，請參閱 < [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

### <a name="example"></a>範例

此範例會擷取內部的 COM 物件。 若要執行此程式碼範例，您必須編譯它在 Windows Vista 或更新版本。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>  CFileDialog::GetIFileOpenDialog

擷取內部 COM 物件的指標指定`CFileDialog`。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>傳回值

針對內部的 COM 物件的指標`CFileDialog`。 您必須負責適當地釋放這個指標。

### <a name="remarks"></a>備註

使用此函式只有在 Windows Vista 或更新版本的物件具有*bVistaStyle*設為 TRUE。 此函式會傳回 NULL，如果`CFileDialog`不是**開放** 對話方塊中或如果*bVistaStyle*設為 FALSE。 在這個最後的情況下，函式只會傳回 NULL 以發行模式-在偵錯模式則會擲回判斷提示。

如需詳細資訊`IFileOpenDialog`介面，請參閱 < [IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)。

### <a name="example"></a>範例

此範例會擷取內部的 COM 物件。 若要執行此程式碼，您必須編譯它在 Windows Vista 或更新版本。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>  CFileDialog::GetIFileSaveDialog

擷取內部 COM 物件的指標指定`CFileDialog`。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>傳回值

針對內部的 COM 物件的指標`CFileDialog`。 您必須負責適當地釋放這個指標。

### <a name="remarks"></a>備註

使用此函式只有在 Windows Vista 或更新版本的物件具有*bVistaStyle*設為 TRUE。 此函式會傳回 NULL，如果`CFileDialog`不是**儲存** 對話方塊中或如果*bVistaStyle*設為 FALSE。 在這個最後的情況下，函式只會傳回 NULL 以發行模式-在偵錯模式則會擲回判斷提示。

如需詳細資訊`IFileSaveDialog`介面，請參閱 < [IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)。

### <a name="example"></a>範例

此範例會擷取內部的 COM 物件。 若要執行此程式碼範例，您必須編譯它在 Windows Vista 或更新版本。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>  CFileDialog::GetNextPathName

呼叫此函式來擷取在對話方塊中選取的群組中的下一個檔案名稱。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>參數

*pos*<br/>
前一個位置值的參考`GetNextPathName`或`GetStartPosition`函式呼叫。 如果已到達清單結尾，則為 NULL。

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔名的路徑包含檔案的標題，再加上的整個目錄路徑。 比方說，`GetNextPathName`會傳回"C:\FILES\TEXT。DAT"C:\FILES\TEXT.DAT 檔案。 您可以使用`GetNextPathName`向前反覆項目迴圈，如果您建立的初始位置，藉由呼叫`GetStartPosition`。

如果選取項目包含一個檔案，就會傳回該檔案名稱。

##  <a name="getofn"></a>  CFileDialog::GetOFN

擷取相關聯`OPENFILENAME`結構。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>傳回值

[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)結構。

### <a name="remarks"></a>備註

使用此函式的第二個版本初始化的外觀**開啟舊檔**或是**檔案另存新檔**建構後，但它會顯示對話方塊的 `DoModal`成員函式。 例如，您可以設定`lpstrTitle`隸屬`m_ofn`標題要擁有對話方塊。

##  <a name="getpathname"></a>  CFileDialog::GetPathName

呼叫此函式來擷取在對話方塊中輸入檔案的完整路徑。

```
CString GetPathName() const;
```

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔名的路徑包含檔案的標題，再加上的整個目錄路徑。 比方說，`GetPathName`會傳回"C:\FILES\TEXT。DAT"C:\FILES\TEXT.DAT 檔案。

如果`m_ofn.Flags`OFN_ALLOWMULTISELECT 旗標設定，這個字串包含一連串的 null teminated 所選取的檔案群組的目錄路徑的第一個字串的字串，後面接著的所有使用者所選取的檔案名稱。 基於這個理由，使用[GetStartPosition](#getstartposition)並[GetNextPathName](#getnextpathname)成員函式來擷取下一步 清單中的檔案名稱。

### <a name="example"></a>範例

  範例，請參閱[CFileDialog::DoModal](#domodal)。

##  <a name="getreadonlypref"></a>  CFileDialog::GetReadOnlyPref

呼叫此函式來判斷是否已 Windows 標準開啟檔案並另存新檔 對話方塊中選取 唯讀 核取方塊。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>傳回值

非為零，如果已選取 [唯讀] 核取方塊，在對話方塊中;否則為 0。

### <a name="remarks"></a>備註

您可以隱藏 [唯讀] 核取方塊，藉由設定 OFN_HIDEREADONLY 樣式`CFileDialog`建構函式。

> [!NOTE]
> Windows Vista 或更新版本的樣式`CFileDialog`物件並不支援此函式。 嘗試使用此函式上的 Windows Vista 或更新版本的樣式`CFileDialog`將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。

##  <a name="getresult"></a>  CFileDialog::GetResult

擷取在對話方塊中的使用者所做的選擇。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>傳回值

表示使用者的選擇 IShellItem 指標。

### <a name="remarks"></a>備註

##  <a name="getresults"></a>  CFileDialog::GetResults

擷取使用者的選擇，在對話方塊中，可讓多個選取項目。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>傳回值

透過此對話方塊中選取的項目都可以存取 IShellItemArray 指標。

### <a name="remarks"></a>備註

##  <a name="getselectedcontrolitem"></a>  CFileDialog::GetSelectedControlItem

擷取在對話方塊中指定的容器控制項中的特定項目。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
使用者控制項中選取之項目的識別碼。

### <a name="remarks"></a>備註

##  <a name="getstartposition"></a>  CFileDialog::GetStartPosition

呼叫此成員函式，以擷取在清單中，第一個檔案路徑名稱的位置，如果`m_ofn.Flags`已設定 OFN_ALLOWMULTISELECT 旗標。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>傳回值

位置值，可用於反覆項目;如果清單是空的則為 NULL。

##  <a name="hidecontrol"></a>  CFileDialog::HideControl

呼叫此成員函式，若要隱藏在檔案總管樣式開啟] 或 [另存為一般的對話方塊中指定的控制項。

```
void HideControl(int nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
若要隱藏控制項的 ID。

### <a name="remarks"></a>備註

對話方塊中必須已經使用 OFN_EXPLORER 樣式中，建立否則，函式將會失敗的判斷提示。

##  <a name="ispickfoldersmode"></a>  CFileDialog::IsPickFoldersMode

判斷目前的對話方塊是否在資料夾選擇器模式中。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>傳回值

如果對話方塊為資料夾選擇器模式，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="m_ofn"></a>  CFileDialog::m_ofn

`m_ofn` 是一種結構的型別`OPENFILENAME`。 此結構中的資料表示的目前狀態`CFileDialog`。

### <a name="remarks"></a>備註

使用此結構來初始化的外觀**開啟舊檔**或是**檔案另存新檔**建構它後，但您將它與顯示對話方塊的  [DoModal](#domodal)方法。 例如，您可以設定*lpstrTitle*隸屬`m_ofn`標題要擁有對話方塊。

與 Windows Vista 或更新版本的樣式[CFileDialog](../../mfc/reference/cfiledialog-class.md)，`m_ofn`不保證一定要相符的對話方塊中的狀態。 在舊版的 Windows 對話方塊，它會同步處理。 請參閱[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)並[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)如需有關同步處理`m_ofn`結構和`CFileDialog`狀態在 Windows Vista 或更新版本。

Windows Vista 或更新版本的樣式檔案對話方塊不支援某些成員和旗標的`CFileDialog`。 如此一來，這些會有任何作用。

以下是 Windows vista 或更新版本不支援成員的清單：

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

不支援下列旗標，而且當您使用 Windows Vista 或更新版本的樣式，因此沒有任何作用`CFileDialog`:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- OFN_LONGNAMES-永遠有效地在 Windows vista 或更新版本

- OFN_NOLONGNAMES-實際上一律會關閉在 Windows Vista 或更新版本

- OFN_NONETWORKBUTTON-永遠有效地在 Windows vista 或更新版本

- OFN_READONLY

- OFN_SHOWHELP

如需有關此結構的詳細資訊，請參閱[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna) Windows SDK 中的結構。

##  <a name="makeprominent"></a>  CFileDialog::MakeProminent

上的芳鄰 對話方塊中的控制項，讓它脫穎而出相較於其他控制項。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的 ID。

### <a name="remarks"></a>備註

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

當按一下按鈕時呼叫。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
按鈕的識別碼。

### <a name="remarks"></a>備註

##  <a name="oncheckbuttontoggled"></a>  CFileDialog::OnCheckButtonToggled

當核取方塊已核取或取消核取時呼叫。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
Checked 或 unchecked。

### <a name="remarks"></a>備註

##  <a name="oncontrolactivating"></a>  CFileDialog::OnControlActivating

在啟動控制項時呼叫。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的 ID。

### <a name="remarks"></a>備註

##  <a name="onfilenamechange"></a>  CFileDialog::OnFileNameChange

如果您想要處理 WM_NOTIFY CDN_SELCHANGE 訊息，請覆寫這個方法。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>備註

當使用者選取的檔案清單中的新檔案或資料夾時，系統會傳送 CDN_SELCHANGE 訊息**開放**或是**另存新檔**對話方塊。 如果您想要執行任何動作以回應這個訊息，請覆寫這個方法。

只有當對話方塊中建立與開啟 OFN_EXPLORER 旗標，系統就會傳送此訊息。 如需通知的詳細資訊，請參閱[CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange)。 OFN_EXPLORER 旗標的相關資訊，請參閱[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)結構並[開啟並儲存為對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

只有當您想要提供自訂驗證的通用檔案對話方塊中輸入的檔案名稱時，才會覆寫這個函式。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>傳回值

如果檔案名稱不是有效的檔名;，1否則為 0。

### <a name="remarks"></a>備註

此函式可讓您拒絕特定應用程式因故的檔案名稱。 一般來說，您不需要使用此函式，因為架構提供的檔案名稱的預設驗證，並顯示訊息方塊，如果您輸入了無效的檔名。

如果會傳回 1，對話方塊會保持顯示使用者輸入另一個檔名。 如果傳回為 0 的對話方塊程序會關閉對話方塊。 其他非零傳回值是目前保留，而且不應該使用。

##  <a name="onfolderchange"></a>  CFileDialog::OnFolderChange

覆寫這個函式以處理 WM_NOTIFYCDN_FOLDERCHANGE 訊息。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>備註

[開啟] 或 [另存新檔] 對話方塊中開啟新的資料夾時，會傳送通知訊息。

只有 OFN_EXPLORER 樣式建立的對話方塊時，會傳送通知。 如需通知的詳細資訊，請參閱[CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)結構並[開啟並儲存為對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

##  <a name="oninitdone"></a>  CFileDialog::OnInitDone

覆寫這個函式以處理 WM_NOTIFY CDN_INITDONE 訊息。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>備註

當系統完成排列中的控制項時，系統會傳送此通知訊息**開放**或**另存新檔**對話方塊中，以騰出供子系 對話方塊的控制項。

只有 OFN_EXPLORER 樣式建立的對話方塊時，系統會傳送這。 如需通知的詳細資訊，請參閱[CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)結構並[開啟並儲存為對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

> [!NOTE]
> Windows Vista 或更新版本的樣式檔案對話方塊不支援此函式。 嘗試在 Windows Vista 或更新版本的樣式檔案對話方塊上使用此函式會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

選取容器項目時呼叫。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

### <a name="remarks"></a>備註

##  <a name="onlbselchangednotify"></a>  CFileDialog::OnLBSelChangedNotify

若要變更清單方塊中目前的選取範圍時，會呼叫此函數。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>參數

*nIDBox*<br/>
清單方塊或下拉式方塊選取項目發生所在的識別碼。

*iCurSel*<br/>
目前的選取範圍的索引。

*則 nCode*<br/>
控制項通知程式碼。 這個參數必須要有下列值之一：

- 指定 CD_LBSELCHANGE *iCurSel*是單一選取清單方塊中選取的項目。

- 指定 CD_LBSELSUB *iCurSel*不再多重選取清單方塊中選取。

- 指定 CD_LBSELADD *iCurSel*多重選取清單方塊中選取。

- CD_LBSELNOITEMS 指定在於多重選取清單方塊中沒有選取項目。

### <a name="remarks"></a>備註

覆寫此函式可提供的清單方塊中的選取範圍變更的自訂處理。 例如，您可以使用此函式來顯示的存取權限，或日期-上次修改每個檔案的使用者選取。

##  <a name="onshareviolation"></a>  CFileDialog::OnShareViolation

覆寫這個函式來提供自訂處理共用違規。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>參數

*lpszPathName*<br/>
發生共用違規的檔案路徑。

### <a name="return-value"></a>傳回值

下列其中一個值：

- 從對話方塊傳回 OFN_SHAREFALLTHROUGH 檔案名稱。

- 需要採取 OFN_SHARENOWARN 沒有進一步的動作。

- OFN_SHAREWARN 使用者會收到此錯誤的標準的警告訊息。

### <a name="remarks"></a>備註

一般來說，您不需要使用此函式，因為架構提供預設的共用違規檢查，並顯示訊息方塊，如果發生共用違規。

如果您想要停用共用違規檢查，則使用位元的 OR 運算子結合的旗標 OFN_SHAREAWARE 與`m_ofn.Flags`。

##  <a name="ontypechange"></a>  CFileDialog::OnTypeChange

覆寫這個函式以處理 WM_NOTIFYCDN_TYPECHANGE 訊息。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>備註

當使用者選取 [從清單中新的檔案類型，在開啟的檔案類型] 或 [另存新檔] 對話方塊時，會傳送通知訊息。

只有 OFN_EXPLORER 樣式建立的對話方塊時，會傳送通知。 如需通知的詳細資訊，請參閱[CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)結構並[開啟並儲存為對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

在對話方塊中的容器控制項中移除的項目。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
若要移除的項目容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

### <a name="remarks"></a>備註

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

在對話方塊中設定的核取按鈕 （核取方塊） 的目前狀態。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
核取方塊的狀態。 TRUE 表示已檢查;FALSE 表示未核取。

### <a name="remarks"></a>備註

##  <a name="setcontrolitemstate"></a>  CFileDialog::SetControlItemState

在對話方塊中找到的容器控制項中設定項目的目前狀態。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

*dwState*<br/>
一或多個值從 CDCONTROLSTATE 列舉，指出控制項的新狀態。

### <a name="remarks"></a>備註

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

設定控制項項目的文字。 例如，文字所附的選項按鈕或功能表項目。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
項目的識別碼。

*strLabel*<br/>
項目的文字。

### <a name="remarks"></a>備註

##  <a name="setcontrollabel"></a>  CFileDialog::SetControlLabel

設定控制項，例如按鈕文字或編輯方塊標籤相關聯的文字。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的 ID。

*strLabel*<br/>
控制項名稱。

### <a name="remarks"></a>備註

##  <a name="setcontrolstate"></a>  CFileDialog::SetControlState

設定目前的可見性，並啟用指定的控制項狀態。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的 ID。

*dwState*<br/>
一或多個值從 CDCONTROLSTATE 列舉，指出控制項的目前狀態。

### <a name="remarks"></a>備註

##  <a name="setcontroltext"></a>  CFileDialog::SetControlText

呼叫這個方法來設定指定控制項的文字在檔案總管樣式**開放**或是**另存新檔** 對話方塊。

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>參數

*nID*<br/>
[in]要設定文字控制項的 ID。

*lpsz*<br/>
[in]包含要設定控制項的文字字串的指標。

### <a name="remarks"></a>備註

此函式的兩個版本的應用程式，使用 Unicode 的有效值。 不過，只有使用 LPCSTR 類型版本是適用於使用 ANSI 應用程式。

若要使用這個方法，您必須建立對話方塊 OFN_EXPLORER 樣式。 否則，函式將會失敗的判斷提示。

##  <a name="setdefext"></a>  Setdefext

呼叫此函式來設定 檔案總管樣式開啟 或 另存新檔通用的對話方塊中的預設檔案名稱副檔名。

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>參數

*lpsz*<br/>
包含要用於對話方塊物件的預設延伸模組的字串指標。 此字串必須包含句號 （.）。

### <a name="remarks"></a>備註

對話方塊中必須已經使用 OFN_EXPLORER 樣式中，建立否則，函式將會失敗的判斷提示。

##  <a name="seteditboxtext"></a>  CFileDialog::SetEditBoxText

設定目前的文字編輯方塊控制項中。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
編輯方塊的識別碼。

*先把 strText*<br/>
文字值。

### <a name="remarks"></a>備註

##  <a name="setproperties"></a>  CFileDialog::SetProperties

提供屬性儲存區，可定義要用於所儲存之項目的預設值。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>參數

*lpszPropList*<br/>
預先定義的屬性清單，以 ";" 分隔。 如需旗標的清單，請參閱 <<c0>  **旗標**一節[OPENFILENAME](/windows/desktop/api/commdlg/ns-commdlg-tagofna)。

### <a name="remarks"></a>備註

##  <a name="setselectedcontrolitem"></a>  CFileDialog::SetSelectedControlItem

設定中的選項按鈕群組或下拉式方塊的對話方塊中找到的特定項目的選取的狀態。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的 ID。

*dwIDItem*<br/>
使用者控制項中選取之項目的識別碼。

### <a name="remarks"></a>備註

##  <a name="settemplate"></a>  CFileDialog::SetTemplate

設定的對話方塊範本[CFileDialog](../../mfc/reference/cfiledialog-class.md)物件。

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>參數

*nWin3ID*<br/>
[in]包含非 Explorer 的範本資源的 ID 編號`CFileDialog`物件。 在 Windows NT 3.51 或 OFN_EXPLORER 樣式不存在時，只會使用此範本。

*nWin4ID*<br/>
[in][總管] 中包含的範本資源的 ID 編號`CFileDialog`物件。 只有 Windows NT 4.0 和更新版本、 Windows 95 和更新版本中，或有 OFN_EXPLORER 樣式時，會使用此範本。

*lpWin3ID*<br/>
[in]包含非 Explorer 的範本資源名稱`CFileDialog`物件。 在 Windows NT 3.51 或 OFN_EXPLORER 樣式不存在時，只會使用此範本。

*lpWin4ID*<br/>
[in]包含名稱的 [總管] 中的範本資源`CFileDialog`物件。 只有 Windows NT 4.0 和更新版本、 Windows 95 和更新版本中，或有 OFN_EXPLORER 樣式時，會使用此範本。

### <a name="remarks"></a>備註

系統會使用其中一個指定的範本。 系統會決定要使用哪個範本根據 OFN_EXPLORER 樣式和作業系統上執行應用程式存在。 藉由指定的非檔案總管 」 和 「 檔案總管樣式範本，很容易就能支援 Windows NT 3.51、 Windows NT 4.0 和更新版本中，和 Windows 95 和更新版本。

> [!NOTE]
> Windows Vista 或更新版本的樣式檔案對話方塊不支援此函式。 嘗試在 Windows Vista 或更新版本的樣式檔案 對話方塊中使用此函式會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。 替代方法是使用自訂的對話方塊。 如需有關使用自訂`CFileDialog`，請參閱 < [IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

##  <a name="startvisualgroup"></a>  CFileDialog::StartVisualGroup

宣告在對話方塊中的視覺化群組。 「 新增 」 的任何方法的後續呼叫會將這些項目加入此群組。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
視覺化群組的識別碼。

*strLabel*<br/>
群組名稱。

### <a name="remarks"></a>備註

##  <a name="updateofnfromshelldialog"></a>  CFileDialog::UpdateOFNFromShellDialog

更新`m_ofn`的資料結構[CFileDialog](../../mfc/reference/cfiledialog-class.md)根據內部物件的目前狀態。

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>備註

Windows Vista 中，成員之前的 Windows 版本中[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)持續資料結構進行同步處理狀態為  `CFileDialog`。 任何變更[m_ofn](#m_ofn)成員變數的直接影響對話方塊方塊的狀態。 此外，對話方塊狀態的任何變更會立即更新 m_ofn 成員變數。

在 Windows Vista 或更新版本，`m_ofn`資料結構不會自動更新。 若要保證中的資料的正確性`m_ofn`成員變數，您應該呼叫`UpdateOFNFromShellDialog`函式，才能存取資料。 Windows 會呼叫此函式會自動處理期間[IFileDialog::OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)。

如需有關如何使用`CFileDialog`類別在 Windows Vista 或更新版本，請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

此範例會更新`CFileDialog`之前顯示。 更新之前`m_ofn`成員變數，我們需要進行同步處理 對話方塊中的目前狀態。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>另請參閱

[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)

