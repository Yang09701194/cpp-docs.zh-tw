---
title: "CFileDialog 類別 |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
dev_langs:
- C++
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 611f26b07bc8ebd14fc394437ddda07cb65ab4e1
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/21/2017
---
# <a name="cfiledialog-class"></a>CFileDialog 類別
封裝檔案開啟或儲存作業檔案所用的通用對話方塊。  
  
## <a name="syntax"></a>語法  
  
```  
class CFileDialog : public CCommonDialog  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CFileDialog::CFileDialog](#cfiledialog)|建構 `CFileDialog` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CFileDialog::AddCheckButton](#addcheckbutton)|加入對話方塊中的核取記號按鈕。|  
|[CFileDialog::AddComboBox](#addcombobox)|將下拉式方塊加入至對話方塊。|  
|[CFileDialog::AddControlItem](#addcontrolitem)|在對話方塊中的容器控制項中加入項目。|  
|[CFileDialog::AddEditBox](#addeditbox)|加入對話方塊中的編輯方塊。|  
|[CFileDialog::AddMenu](#addmenu)|將功能表加入至對話方塊。|  
|[CFileDialog::AddPlace](#addplace)|多載。 加入至清單的資料夾將可供使用者開啟或儲存的項目。|  
|[CFileDialog::AddPushButton](#addpushbutton)|將按鈕加入至對話方塊。|  
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|選項按鈕 （也稱為選項按鈕） 將群組加入至對話方塊。|  
|[CFileDialog::AddSeparator](#addseparator)|加入對話方塊中的分隔符號。|  
|[CFileDialog::AddText](#addtext)|將文字內容加入至對話方塊。|  
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|更新的狀態，`CFileDialog`比對參數和儲存在旗標`m_ofn`成員變數。|  
|[CFileDialog::DoModal](#domodal)|顯示對話方塊，並可讓使用者進行選取。|  
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|啟用上的下拉式清單**開啟**或**儲存**對話方塊中的按鈕。|  
|[CFileDialog::EndVisualGroup](#endvisualgroup)|加入的項目 對話方塊中的視覺化群組就會停止。|  
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|取得對話方塊中的核取按鈕 （核取方塊） 的目前狀態。|  
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|取得對話方塊中找到的容器控制項中的項目目前的狀態。|  
|[CFileDialog::GetControlState](#getcontrolstate)|取得目前的可見性，並啟用特定控制項的狀態。|  
|[CFileDialog::GetEditBoxText](#geteditboxtext)|取得目前的文字編輯方塊控制項中。|  
|[CFileDialog::GetFileExt](#getfileext)|傳回所選檔案的副檔名。|  
|[CFileDialog::GetFileName](#getfilename)|傳回所選檔案的檔案名稱。|  
|[CFileDialog::GetFileTitle](#getfiletitle)|傳回所選檔案的標題。|  
|[CFileDialog::GetFolderPath](#getfolderpath)|擷取目前開啟的資料夾或目錄路徑的檔案總管樣式**開啟**或**存**通用對話方塊。|  
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|擷取內部的 COM 物件，如自訂`CFileDialog`物件。|  
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|擷取內部的 COM 物件，如`CFileDialog`，可當做**開啟**檔案 對話方塊。|  
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|擷取內部的 COM 物件，如`CFileDialog`，可當做**儲存**檔案 對話方塊。|  
|[CFileDialog::GetNextPathName](#getnextpathname)|傳回下一步選取的檔案的完整路徑。|  
|[CFileDialog::GetOFN](#getofn)|擷取`OPENFILENAME`結構`CFileDialog`物件。|  
|[CFileDialog::GetPathName](#getpathname)|傳回所選檔案的完整路徑。|  
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|傳回所選檔案的唯讀狀態。|  
|[CFileDialog::GetResult](#getresult)|取得對話方塊中的使用者所做的選擇。|  
|[CFileDialog::GetResults](#getresults)|在對話方塊中，可讓多個選取項目中取得使用者的選擇。|  
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|取得特定的項目從對話方塊中指定的容器控制項。|  
|[CFileDialog::GetStartPosition](#getstartposition)|傳回檔案名稱清單的第一個元素的位置。|  
|[CFileDialog::HideControl](#hidecontrol)|隱藏指定的控制項，在檔案總管樣式**開啟**或**存**通用對話方塊。|  
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|判斷目前對話方塊資料夾選擇器模式。|  
|[CFileDialog::MakeProminent](#makeprominent)|位置對話方塊中的控制項，讓它突出相較於其他已加入的控制項。|  
|[CFileDialog::RemoveControlItem](#removecontrolitem)|在對話方塊中的容器控制項中移除的項目。|  
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|在對話方塊中設定的核取按鈕 （核取方塊） 的目前狀態。|  
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|容器控制項位於對話方塊中設定項目的目前狀態。|  
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|設定控制項項目的文字。 例如，伴隨著選項按鈕或功能表項目變更的文字。|  
|[CFileDialog::SetControlLabel](#setcontrollabel)|設定控制項，例如按鈕文字或編輯方塊標籤相關聯的文字。|  
|[CFileDialog::SetControlState](#setcontrolstate)|設定目前的可見性，並啟用特定控制項的狀態。|  
|[CFileDialog::SetControlText](#setcontroltext)|設定指定之控制項的文字在檔案總管樣式**開啟**或**存**通用對話方塊。|  
|[CFileDialog::SetDefExt](#setdefext)|設定預設的副檔名的檔案總管樣式**開啟**或**存**通用對話方塊。|  
|[CFileDialog::SetEditBoxText](#seteditboxtext)|設定目前的文字編輯方塊控制項中。|  
|[CFileDialog::SetProperties](#setproperties)|提供屬性儲存區，可定義要用於所儲存之項目的預設值。|  
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|選項按鈕群組或在對話方塊中找到下拉式方塊中設定特定項目的選取的狀態。|  
|[CFileDialog::SetTemplate](#settemplate)|設定的對話方塊範本`CFileDialog`物件。|  
|[CFileDialog::StartVisualGroup](#startvisualgroup)|宣告可見的群組，在對話方塊中。 任何 「 加入 」 方法的後續呼叫會將這些項目新增至此群組。|  
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|更新儲存在資料`m_ofn`成員變數，以符合檔案對話方塊中的目前狀態。|  
  
### <a name="protected-methods"></a>保護方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|當按一下按鈕時呼叫。|  
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|選取/取消核取核取方塊時呼叫。|  
|[CFileDialog::OnControlActivating](#oncontrolactivating)|當控制項正在使用中時呼叫。|  
|[CFileDialog::OnFileNameChange](#onfilenamechange)|處理`WM_NOTIFY CDN_SELCHANGE`訊息。|  
|[CFileDialog::OnFileNameOK](#onfilenameok)|驗證在對話方塊中輸入檔案名稱。|  
|[CFileDialog::OnFolderChange](#onfolderchange)|處理`WM_NOTIFY CDN_FOLDERCHANGE`訊息。|  
|[CFileDialog::OnInitDone](#oninitdone)|處理`WM_NOTIFY CDN_INITDONE`訊息。|  
|[CFileDialog::OnItemSelected](#onitemselected)|當選取的容器項目時呼叫。|  
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|可讓您的檔案選取範圍變更時執行自訂動作。|  
|[CFileDialog::OnShareViolation](#onshareviolation)|控制代碼共用違規。|  
|[CFileDialog::OnTypeChange](#ontypechange)|處理`WM_NOTIFY CDN_TYPECHANGE`訊息。|  
  
### <a name="public-data-members"></a>公用資料成員  
  
|名稱|描述|  
|----------|-----------------|  
|[CFileDialog::m_ofn](#m_ofn)|Windows`OPENFILENAME`結構。 提供基本檔案對話方塊方塊參數的存取權。|  
  
## <a name="remarks"></a>備註  
 通用檔案對話方塊可讓您實作檔案選取對話方塊中，例如**開啟檔案**和**存**，與 Windows 標準一致的方式。  
  
 您可以使用`CFileDialog`現況提供，建構函式，或可衍生您自己的對話方塊類別從`CFileDialog`和寫入以符合您需求的建構函式。 在任一情況下，這些對話方塊的行為類似標準 MFC 對話方塊因為衍生自[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)。 `CFileDialog`依賴 COMMDLG。包含在 Windows 中的 DLL 檔案。  
  
 外觀和功能的`CFileDialog`與[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]與舊版 Windows 的不同。 預設值`CFileDialog`會自動使用新[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]沒有如果編譯程式的程式碼變更和執行所用的樣式[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。 使用`bVistaStyle`建構函式，以手動方式覆寫這個自動更新中的參數。 自動更新的例外狀況是自訂的對話方塊。 它們不會轉換成新的樣式。 如需建構函式的詳細資訊，請參閱[CFileDialog::CFileDialog](#cfiledialog)。  
  
> [!NOTE]
>  在不同的控制項識別碼系統[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]從舊版的 Windows，當您使用`CFileDialog`。 您必須更新所有參考`CFileDialog`程式碼之前，您就可以移植您的專案從舊版 Windows 中的控制項。  
  
 某些`CFileDialog`下不支援方法[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。 請檢查是否支援此方法的相關資訊的個別方法主題。 此外，下列繼承的函式不支援在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]:  
  
- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)  
  
- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)  
  
 Windows 訊息`CFileDialog`類別視您使用何種作業系統。 例如，不支援 Windows XP [CDialog::OnCancel](../../mfc/reference/cdialog-class.md#oncancel)和[CDialog::OnOK](../../mfc/reference/cdialog-class.md#onok)如`CFileDialog`類別。 不過，[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]支援它們。 如需不同所產生的訊息及接收它們的順序的詳細資訊，請參閱[CFileDialog 範例： 記錄事件順序](../../visual-cpp-samples.md)。  
  
 若要使用`CFileDialog`物件，請先建立物件，使用`CFileDialog`建構函式。 在建構對話方塊之後，您可以設定或修改中的任何值[CFileDialog::m_ofn](#m_ofn)結構初始化的值或對話方塊控制項的狀態。 `m_ofn`結構的類型是`OPENFILENAME`。 如需詳細資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Windows SDK 中的結構。  
  
 初始化對話方塊控制項之後，請呼叫[CFileDialog::DoModal](#domodal)方法，以顯示對話方塊方塊，讓使用者可以輸入路徑和檔案名稱。 `DoModal`傳回使用者點選 [確定] (IDOK) 或取消 (IDCANCEL) 按鈕。 如果`DoModal`傳回 IDOK，您可以使用其中一個`CFileDialog`公用成員函式來擷取資訊放入使用者。  
  
> [!NOTE]
>  在下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]，多個呼叫[IFileDialog::SetFileTypes](http://msdn.microsoft.com/library/windows/desktop/bb775980)會造成錯誤。 第二個呼叫`SetFileTypes`之執行個體`CFileDialog`會傳回`E_UNEXPECTED`中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。 某些`CFileDialog`方法函式會呼叫`SetFileTypes`。 例如，兩個呼叫`CFileDialog::DoModal`的同一個執行個體`CFileDialog`產生[ASSERT](diagnostic-services.md#assert)。  
  
 `CFileDialog`包含數個受保護的成員，可讓您執行自訂處理共用違規，檔案名稱驗證，清單方塊變更通知。 這些受保護的成員是大多數應用程式不需要使用，因為預設的處理會自動執行的回呼函式。 因為它們是標準虛擬函式，就不需要這些函式的訊息對應項目。  
  
 您可以使用 Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916)函式判斷是否在對話方塊的初始化期間發生錯誤，並深入了解錯誤。  
  
 解構`CFileDialog`物件會自動處理。 您不需要呼叫[CDialog::EndDialog](../../mfc/reference/cdialog-class.md#enddialog)。  
  
 若要讓使用者選取多個檔案，設定`OFN_ALLOWMULTISELECT`旗標，才能呼叫`DoModal`。 您必須提供您自己檔案名稱緩衝區，以容納傳回多個檔案名稱的清單。 執行這項操作來取代`m_ofn.lpstrFile`緩衝區的指標使用您已配置之後您建構, `CFileDialog`，但在呼叫之前`DoModal`。  
  
 此外，您必須設定`m_ofn.nMaxFile`所指向之緩衝區中使用的字元數`m_ofn.lpstrFile`。 如果您設定要選取的檔案數目上限`n`，必要的緩衝區大小是`n * (_MAX_PATH + 1) + 1`。 傳回緩衝區中的第一個項目是已在所選取檔案之資料夾的路徑。 如[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]-樣式對話方塊、 目錄和檔案名稱字串都是以 null 結尾，以額外的 null 字元之後的最後一個檔案名稱。 此格式可讓 [檔案總管樣式] 對話方塊，以傳回包含空格的長檔名。 舊樣式 對話方塊，會以空格分隔的目錄和檔案名稱的字串和函式使用的檔案名稱的簡短檔案名稱有空格。  
  
 下列範例會示範如何使用緩衝區以擷取，並列出多個檔案名稱。  
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 若要變更以回應使用者選取多個檔案名稱的緩衝區大小，您必須衍生新類別從`CFileDialog`並覆寫[CFileDialog::OnFileNameChange](#onfilenamechange)方法。  
  
 如果您衍生新類別從`CFileDialog`，您可以使用訊息對應來處理任何訊息。 若要擴充的預設訊息處理，衍生自`CFileDialog`、 將訊息對應新增到新的類別和成員函式提供新的訊息。 您沒有提供自訂對話方塊中的攔截函式。  
  
 若要自訂對話方塊中，衍生自`CFileDialog`、 提供自訂對話方塊範本，並加入處理從擴充的控制項通知訊息的訊息對應。 將任何未處理的訊息傳遞給基底類別。 沒有自訂攔截函式。  
  
 當您使用[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式`CFileDialog`，您無法使用訊息對應和對話方塊範本。 相反地，您必須使用 COM 介面的類似功能。  
  
 如需有關如何使用`CFileDialog`，請參閱[通用對話方塊類別](../../mfc/common-dialog-classes.md)。  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CDialog](../../mfc/reference/cdialog-class.md)  
  
 [CCommonDialog](../../mfc/reference/ccommondialog-class.md)  
  
 `CFileDialog`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxdlgs.h  
  
##  <a name="addcheckbutton"></a>CFileDialog::AddCheckButton  
 加入對話方塊中的核取記號按鈕。  
  
```  
HRESULT AddCheckButton(
    DWORD dwIDCtl,  
    const CString& strLabel,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入的核取按鈕識別碼。  
  
 `strLabel`  
 核取按鈕名稱。  
  
 `bChecked`  
 布林值，指出核取按鈕的目前狀態。 `TRUE`若選取此選項。`FALSE`否則  
  
### <a name="remarks"></a>備註  
  
##  <a name="addcombobox"></a>CFileDialog::AddComboBox  
 將下拉式方塊加入至對話方塊。  
  
```  
HRESULT AddComboBox(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入下拉式方塊的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addcontrolitem"></a>CFileDialog::AddControlItem  
 在對話方塊中的容器控制項中加入項目。  
  
```  
HRESULT AddControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入的項目容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
 `strLabel`  
 項目的文字。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addeditbox"></a>CFileDialog::AddEditBox  
 加入對話方塊中的編輯方塊。  
  
```  
HRESULT AddEditBox(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入的編輯方塊識別碼。  
  
 `strText`  
 編輯方塊名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addmenu"></a>CFileDialog::AddMenu  
 將功能表加入至對話方塊。  
  
```  
HRESULT AddMenu(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入功能表的識別碼。  
  
 `strLabel`  
 功能表的名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addplace"></a>CFileDialog::AddPlace  
 加入至清單的資料夾將可供使用者開啟或儲存的項目。  
  
```  
void AddPlace(
    LPCWSTR lpszFolder,  
    FDAP fdap = FDAP_TOP) throw();

 
void AddPlace(
    IShellItem* psi,  
    FDAP fdap = FDAP_TOP) throw();
```  
  
### <a name="parameters"></a>參數  
 `lpszFolder`  
 可供使用者資料夾的路徑。 這只能是一個資料夾。  
  
 `fdap`  
 指定的資料夾清單中的放置位置。  
  
 `psi`  
 代表可供使用者使用的資料夾 IShellItem 指標。 這只能是一個資料夾。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addpushbutton"></a>CFileDialog::AddPushButton  
 將按鈕加入至對話方塊。  
  
```  
HRESULT AddPushButton(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入按鈕的識別碼。  
  
 `strLabel`  
 按鈕名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addradiobuttonlist"></a>CFileDialog::AddRadioButtonList  
 選項按鈕 （也稱為選項按鈕） 將群組加入至對話方塊。  
  
```  
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入選項按鈕群組的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addseparator"></a>CFileDialog::AddSeparator  
 加入對話方塊中的分隔符號。  
  
```  
HRESULT AddSeparator(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 加入分隔的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="addtext"></a>CFileDialog::AddText  
 將文字加入至對話方塊。  
  
```  
HRESULT AddText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 若要加入之文字的識別碼。  
  
 `strText`  
 文字的名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="applyofntoshelldialog"></a>CFileDialog::ApplyOFNToShellDialog  
 更新的目前狀態[CFileDialog](../../mfc/reference/cfiledialog-class.md)中儲存的值為基礎`m_ofn`資料結構。  
  
```  
void ApplyOFNToShellDialog();
```  
  
### <a name="remarks"></a>備註  
 之前的 Windows 版本中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]，成員[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)持續資料結構進行同步處理狀態為  `CFileDialog`。 任何變更[m_ofn](#m_ofn)成員變數立即反映在對話方塊的狀態。 此外，在對話方塊的 狀態的任何變更立即更新`m_ofn`成員變數。  
  
 在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]中的值`m_ofn`成員變數和狀態`CFileDialog`不保證同步處理。 此函式會強制的狀態`CFileDialog`更新成符合`m_ofn`結構。 Windows 會呼叫此函式期間自動[CFileDialog::DoModal](#domodal)。  
  
 如需有關如何使用`CFileDialog`類別下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]，請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。  
  
### <a name="example"></a>範例  
  請參閱範例的[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)。  
  
##  <a name="cfiledialog"></a>CFileDialog::CFileDialog  
 呼叫此函式來建構標準的 Windows 檔案對話方塊。  
  
```  
explicit CFileDialog(
    BOOL bOpenFileDialog,  
    LPCTSTR lpszDefExt = NULL,  
    LPCTSTR lpszFileName = NULL,  
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,  
    LPCTSTR lpszFilter = NULL,  
    CWnd* pParentWnd = NULL,  
    DWORD dwSize = 0,  
    BOOL bVistaStyle = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bOpenFileDialog`  
 指定的對話方塊來建立類型的參數。 將它設定為`TRUE`建構**開啟舊檔** 對話方塊。 將它設定為`FALSE`建構**檔案另存新檔** 對話方塊。  
  
 [輸入] `lpszDefExt`  
 預設的副檔名。 如果使用者不是已知的副檔名 （一個在使用者電腦上有關聯） 包含檔案名稱 方塊中，所指定的延伸`lpszDefExt`自動附加至檔案名稱。 如果這個參數是`NULL`，沒有副檔名附加。  
  
 [輸入] `lpszFileName`  
 初始檔案名稱出現在檔案名稱 方塊中。 如果`NULL`，沒有任何初始檔案名稱會出現。  
  
 [輸入] `dwFlags`  
 您可以使用自訂對話方塊中的一或多個旗標的組合。 如需這些旗標的說明，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Windows SDK 中的結構。 如果您修改`m_ofn.Flags`結構成員，請使用您的變更的位元 OR 運算子，以保留的預設行為保持不變。  
  
 [輸入] `lpszFilter`  
 指定篩選條件的字串組一系列您可以套用至檔案。 如果您指定檔案篩選器時，符合篩選準則的檔案會出現在檔案清單。 請參閱 < 備註 > 一節，如需有關如何使用檔案篩選器。  
  
 [輸入] `pParentWnd`  
 [檔案] 對話方塊的父系或擁有者視窗的指標。  
  
 [輸入] `dwSize`  
 大小`OPENFILENAME`結構。 這個值取決於作業系統版本。 MFC 用來決定對話方塊來建立適當類型的這個參數 (例如，new[!INCLUDE[Win2kFamily](../../c-runtime-library/includes/win2kfamily_md.md)]對話方塊而不是 NT4 對話方塊)。 預設大小為 0 表示 MFC 程式碼會決定要使用的正確對話方塊方塊大小會根據程式執行所在的作業系統版本。  
  
 [輸入] `bVistaStyle`  
 **請注意**此參數可在 Visual Studio 2008 及更新版本，且會導致新樣式對話方塊，您在執行時，才使用[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]或更新版本。  
  
 指定的檔案對話方塊樣式參數。 將它設定為`TRUE`使用新的 Vista 樣式檔案對話方塊。 否則，您將使用舊樣式的對話方塊。 請參閱 < 備註 」 一節，如需詳細資訊的相關 Vista 下執行。  
  
### <a name="remarks"></a>備註  
 任一**開啟舊檔**或**檔案另存新檔**建構對話方塊時，根據的值`bOpenFileDialog`。  
  
 指定預設的延伸模組使用`lpszDefExt`可能不會產生的行為如預期，因為它是很少可預測哪些擴充功能必須在使用者電腦上的檔案關聯。 如果您需要進一步控制要附加的預設延伸模組，您可以衍生您自己的類別從`CFileDialog`，並覆寫`CFileDialog::OnFileNameOK`方法，以執行您自己的延伸模組處理。  
  
 若要讓使用者選取多個檔案，將`OFN_ALLOWMULTISELECT`旗標，才能呼叫[DoModal](#domodal)。 您必須提供您自己的檔案名稱緩衝區傳回多個檔案名稱的清單儲存。 執行這項操作來取代`m_ofn.lpstrFile`緩衝區的指標使用您已配置之後您建構, [CFileDialog](../../mfc/reference/cfiledialog-class.md)，但在呼叫之前`DoModal`。 此外，您必須設定`m_ofn.nMaxFile`中所指向之緩衝區的字元數與`m_ofn.lpstrFile`。 如果您設定要選取的檔案數目上限`n`，必要的緩衝區大小是`n`*(_MAX_PATH + 1) + 1。 例如:   
  
 [!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]  
  
 若要讓使用者使用滑鼠或鍵盤，調整大小檔案總管樣式 對話方塊，設定`OFN_ENABLESIZING`旗標。 只有當您提供的攔截程序或自訂範本，必須設定這個旗標。 旗標僅適用於檔案總管樣式 對話方塊中。無法調整大小的舊樣式的對話方塊。  
  
 `lpszFilter`參數用來判斷檔案必須有要在檔案清單中顯示的檔案名稱的型別。 字串組中的第一個字串描述篩選器。第二個字串表示要使用的副檔名。 可指定多個延伸模組做為分隔符號使用分號 （';' 字元）。 以兩個字串結束 ' &#124;' 字元，後面接著`NULL`字元。 您也可以使用[CString](../../atl-mfc-shared/using-cstring.md)這個參數的物件。  
  
 例如，[!INCLUDE[ofprexcel](../../mfc/reference/includes/ofprexcel_md.md)]和其他項目可讓使用者開啟具有延伸.xlc （圖表） 或.xls （工作表） 的檔案。 Excel 的篩選條件可以寫成：  
  
 [!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]  
  
 不過，如果您打算使用這個字串，以便直接更新`OPENFILENAME`結構，您應該來分隔字串以 null 字元 '\0'，而不是分隔號 ('&#124;')。  
  
 `bVistaStyle`參數下執行時，只是適用於[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。 在舊版 Windows 中，這個參數已忽略。 如果`bVistaStyle`設`TRUE`，當您編譯程式與 Visual Studio 2008 或更新版本，新的 Vista 樣式**檔案對話方塊**將使用。 否則，先前的 MFC 樣式**檔案對話方塊**將使用。  
  
 對話方塊範本不支援根據對話方塊`bVistaStyle`  
  
### <a name="example"></a>範例  
  請參閱範例的[CFileDialog::DoModal](#domodal)。  
  
##  <a name="domodal"></a>CFileDialog::DoModal  
 呼叫此函式可顯示 Windows 通用檔案對話方塊中，並讓使用者瀏覽檔案和目錄，並輸入檔案名稱。  
  
```  
virtual INT_PTR DoModal();
```  
  
### <a name="return-value"></a>傳回值  
 **IDOK**或**IDCANCEL**。 如果**IDCANCEL**是傳回，呼叫 Windows [CommDlgExtendedError](http://msdn.microsoft.com/library/windows/desktop/ms646916)函式來判斷是否發生錯誤。  
  
 **IDOK**和**IDCANCEL**是常數，以指出使用者是否選取 [確定] 或 [取消] 按鈕。  
  
### <a name="remarks"></a>備註  
 如果您想要設定的成員初始化的各種檔案對話方塊選項**m_ofn**結構，您應該這麼做會在呼叫之前`DoModal`，但在建構對話方塊物件之後。  
  
 例如，如果您想要允許使用者選取多個檔案，設定`OFN_ALLOWMULTISELECT`加上旗標，然後再呼叫`DoModal`，如本主題中的程式碼範例所示。  
  
 當使用者按一下對話方塊的 確定 或 取消 按鈕或選取 關閉選項對話方塊的控制項功能表時，控制權回到您的應用程式。 您可以再呼叫其他成員函式，來設定或資訊擷取使用者輸入在對話方塊中。  
  
 `DoModal`為類別中覆寫虛擬函式`CDialog`。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]  
  
##  <a name="enableopendropdown"></a>CFileDialog::EnableOpenDropDown  
 可讓在開啟或儲存對話方塊中的按鈕下拉式清單。  
  
```  
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 下拉式清單的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="endvisualgroup"></a>CFileDialog::EndVisualGroup  
 加入的項目 對話方塊中的視覺化群組就會停止。  
  
```  
HRESULT EndVisualGroup();
```  
  
### <a name="return-value"></a>傳回值  
 傳回 S_OK，如果登錄成功。否則為錯誤值。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getcheckbuttonstate"></a>CFileDialog::GetCheckButtonState  
 擷取對話方塊中的核取按鈕 （核取方塊） 的目前狀態。  
  
```  
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL& bChecked);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 核取方塊的識別碼。  
  
 `bChecked`  
 核取方塊的狀態。 `TRUE`表示已檢查;`FALSE`指出未核取。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getcontrolitemstate"></a>CFileDialog::GetControlItemState  
 擷取在對話方塊中找到的容器控制項中項目的目前狀態。  
  
```  
HRESULT GetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
 `dwState`  
 多個值的其中一個接收來自 CDCONTROLSTATE 列舉，指出控制項的目前狀態的變數參考。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getcontrolstate"></a>CFileDialog::GetControlState  
 擷取目前的可見性，並啟用特定控制項的狀態。  
  
```  
HRESULT GetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF& dwState);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 控制項的識別碼。  
  
 `dwState`  
 接收來自 CDCONTROLSTATE 列舉，指出控制項的目前狀態的一或多個值的變數參考。  
  
### <a name="remarks"></a>備註  
  
##  <a name="geteditboxtext"></a>CFileDialog::GetEditBoxText  
 擷取目前的編輯方塊控制項中的文字。  
  
```  
HRESULT GetEditBoxText(
    DWORD dwIDCtl,  
    CString& strText);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 編輯方塊的識別碼。  
  
 `strText`  
 文字值。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getfileext"></a>CFileDialog::GetFileExt  
 呼叫此函式可擷取在對話方塊中輸入的檔名的副檔名。  
  
```  
CString GetFileExt() const;  
```  
  
### <a name="return-value"></a>傳回值  
 檔案名稱的副檔名。  
  
### <a name="remarks"></a>備註  
 例如，如果輸入的檔案名稱是資料。TXT、`GetFileExt`傳回"TXT"。  
  
 如果`m_ofn.Flags`具有`OFN_ALLOWMULTISELECT`設定旗標，這個字串包含一連串的 null 終止的字串，與所選取的檔案群組的目錄路徑的第一個字串後面的所有使用者所選取的檔案名稱。 若要擷取檔案的路徑名稱，請使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式。  
  
##  <a name="getfilename"></a>CFileDialog::GetFileName  
 呼叫此函式可擷取在對話方塊中輸入檔案名稱的名稱。  
  
```  
CString GetFileName() const;  
```  
  
### <a name="return-value"></a>傳回值  
 檔案的檔名。  
  
### <a name="remarks"></a>備註  
 檔案名稱包含前置詞和延伸模組。 例如，`GetFileName`操作會傳回"文字。DAT"C:\FILES\TEXT.DAT 檔案。  
  
 如果`m_ofn.Flags`具有`OFN_ALLOWMULTISELECT`旗標設，您應該呼叫[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)擷取檔案的路徑名稱。  
  
##  <a name="getfiletitle"></a>CFileDialog::GetFileTitle  
 呼叫此函式可擷取在對話方塊中輸入檔案的標題。  
  
```  
CString GetFileTitle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 檔案的標題。  
  
### <a name="remarks"></a>備註  
 檔案的標題包括只有其前置詞，而不需要路徑或副檔名。 例如， `GetFileTitle` C:\FILES\TEXT.DAT 檔案將會傳回 「 文字 」。  
  
 如果`m_ofn.Flags`具有`OFN_ALLOWMULTISELECT`設定旗標，這個字串包含一連串的 null 終止的字串，與所選取的檔案群組的目錄路徑的第一個字串後面的所有使用者所選取的檔案名稱。 基於這個理由，使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式來擷取下一個檔案名稱清單中的。  
  
### <a name="example"></a>範例  
  請參閱範例的[CFileDialog::DoModal](#domodal)。  
  
##  <a name="getfolderpath"></a>CFileDialog::GetFolderPath  
 呼叫此成員函式，以擷取目前開啟的資料夾或檔案總管樣式開啟] 或 [另存新檔通用的對話方塊中的目錄路徑。  
  
```  
CString GetFolderPath() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，其中包含目前開啟的資料夾或目錄。  
  
### <a name="remarks"></a>備註  
 對話方塊中必須已建立具有**OFN_EXPLORER**樣式; 否則方法將會失敗，並判斷提示。  
  
 只有當對話方塊顯示時，您可以呼叫這個方法。 在關閉對話方塊之後，此函式將會無法運作，和該方法會失敗的判斷提示。  
  
##  <a name="getifiledialogcustomize"></a>CFileDialog::GetIFileDialogCustomize  
 擷取的內部 COM 物件的指標指定[CFileDialog](../../mfc/reference/cfiledialog-class.md)。  
  
```  
IFileDialogCustomize* GetIFileDialogCustomize();
```  
  
### <a name="return-value"></a>傳回值  
 為內部的 COM 物件的指標`CFileDialog`。 您要負責以適當地釋放這個指標。  
  
### <a name="remarks"></a>備註  
 使用此函式只能在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]物件具有`bVistaStyle`設`true`。 如果您使用此函式時`bVistaStyle`是`false`，它會傳回`NULL`在發行模式和偵錯模式中的判斷提示會擲回。  
  
 如需有關`IFileDialogCustomize`介面，請參閱[IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912)。  
  
### <a name="example"></a>範例  
 這個範例會擷取內部的 COM 物件。 若要執行這個程式碼範例，您必須將它編譯下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。  
  
 [!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]  
  
##  <a name="getifileopendialog"></a>CFileDialog::GetIFileOpenDialog  
 擷取的內部 COM 物件的指標指定`CFileDialog`。  
  
```  
IFileOpenDialog* GetIFileOpenDialog();
```  
  
### <a name="return-value"></a>傳回值  
 為內部的 COM 物件的指標`CFileDialog`。 您要負責以適當地釋放這個指標。  
  
### <a name="remarks"></a>備註  
 使用此函式只能在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]物件具有`bVistaStyle`設`true`。 此函數會傳回`NULL`如果`CFileDialog`不**開啟**對話方塊中或如果`bVistaStyle`設`false`。 在這個最後的情況下，函數只會傳回`NULL`在發行模式-在偵錯模式則會擲回的判斷提示。  
  
 如需有關`IFileOpenDialog`介面，請參閱[IFileOpenDialog](http://msdn.microsoft.com/library/windows/desktop/bb775834)。  
  
### <a name="example"></a>範例  
 這個範例會擷取內部的 COM 物件。 若要執行此程式碼，您必須將它編譯下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。  
  
 [!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]  
  
##  <a name="getifilesavedialog"></a>CFileDialog::GetIFileSaveDialog  
 擷取的內部 COM 物件的指標指定`CFileDialog`。  
  
```  
IFileSaveDialog* GetIFileSaveDialog();
```  
  
### <a name="return-value"></a>傳回值  
 為內部的 COM 物件的指標`CFileDialog`。 您要負責以適當地釋放這個指標。  
  
### <a name="remarks"></a>備註  
 使用此函式只能在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]物件具有`bVistaStyle`設`true`。 此函式會傳回`NULL`如果`CFileDialog`不**儲存**對話方塊或`bVistaStyle`設`false`。 在這個最後的情況下，函數只會傳回`NULL`在發行模式-在偵錯模式則會擲回的判斷提示。  
  
 如需有關`IFileSaveDialog`介面，請參閱[IFileSaveDialog](http://msdn.microsoft.com/library/windows/desktop/bb775688)。  
  
### <a name="example"></a>範例  
 這個範例會擷取內部的 COM 物件。 若要執行這個程式碼範例，您必須將它編譯下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。  
  
 [!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]  
  
##  <a name="getnextpathname"></a>CFileDialog::GetNextPathName  
 呼叫此函式可擷取在對話方塊中選取的群組中的下一個檔案名稱。  
  
```  
CString GetNextPathName(POSITION& pos) const;  
```  
  
### <a name="parameters"></a>參數  
 `pos`  
 若要參考**位置**傳回先前值`GetNextPathName`或`GetStartPosition`函式呼叫。 **NULL**是否已到達清單結尾。  
  
### <a name="return-value"></a>傳回值  
 檔案的完整路徑。  
  
### <a name="remarks"></a>備註  
 檔案名稱的路徑包含檔案的標題加上整個目錄路徑。 例如，`GetNextPathName`會傳回"C:\FILES\TEXT。DAT"C:\FILES\TEXT.DAT 檔案。 您可以使用`GetNextPathName`向前反覆項目迴圈，如果您建立的初始位置，藉由呼叫`GetStartPosition`。  
  
 如果選取項目包含一個檔案，將會傳回該檔案名稱。  
  
##  <a name="getofn"></a>CFileDialog::GetOFN  
 擷取相關聯**OPENFILENAME**結構。  
  
```  
const OPENFILENAME& GetOFN() const;  
  
OPENFILENAME& GetOFN();
```  
  
### <a name="return-value"></a>傳回值  
 [OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839)結構。  
  
### <a name="remarks"></a>備註  
 使用此函式的第二個版本初始化的外觀**開啟舊檔**或**檔案另存新檔**建構後，但它會顯示對話方塊`DoModal`成員函式。 例如，您可以設定**lpstrTitle**隸屬**m_ofn**到標題中，您想讓對話方塊。  
  
##  <a name="getpathname"></a>CFileDialog::GetPathName  
 呼叫此函式可擷取在對話方塊中輸入的檔案的完整路徑。  
  
```  
CString GetPathName() const;  
```  
  
### <a name="return-value"></a>傳回值  
 檔案的完整路徑。  
  
### <a name="remarks"></a>備註  
 檔案名稱的路徑包含檔案的標題加上整個目錄路徑。 例如，`GetPathName`會傳回"C:\FILES\TEXT。DAT"C:\FILES\TEXT.DAT 檔案。  
  
 如果`m_ofn.Flags`具有`OFN_ALLOWMULTISELECT`設定旗標，這個字串包含一連串的 null teminated 具有所選取的檔案群組的目錄路徑的第一個字串的字串，後面接著的所有使用者所選取的檔案名稱。 基於這個理由，使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式來擷取下一個檔案名稱清單中的。  
  
### <a name="example"></a>範例  
  請參閱範例的[CFileDialog::DoModal](#domodal)。  
  
##  <a name="getreadonlypref"></a>CFileDialog::GetReadOnlyPref  
 呼叫此函式可判斷是否已在 Windows 標準開啟檔案 和另存新檔對話方塊中選取唯讀核取方塊。  
  
```  
BOOL GetReadOnlyPref() const;  
```  
  
### <a name="return-value"></a>傳回值  
 非零如果選取唯讀核取方塊 對話方塊中。否則便是 0。  
  
### <a name="remarks"></a>備註  
 您可以隱藏 [唯讀] 核取方塊，藉由設定`OFN_HIDEREADONLY`中設定樣式`CFileDialog`建構函式。  
  
> [!NOTE]
> [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式`CFileDialog`物件並不支援此函式。 嘗試使用這個函式[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式`CFileDialog`將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。   
  
##  <a name="getresult"></a>CFileDialog::GetResult  
 擷取在對話方塊中的使用者所做的選擇。  
  
```  
IShellItem* GetResult() throw();
```  
  
### <a name="return-value"></a>傳回值  
 代表使用者的選擇 IShellItem 指標。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getresults"></a>CFileDialog::GetResults  
 擷取在對話方塊中，可讓多個選取的使用者的選擇。  
  
```  
IShellItemArray* GetResults() throw();
```  
  
### <a name="return-value"></a>傳回值  
 透過此對話方塊中選取的項目都可以存取 IShellItemArray 指標。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getselectedcontrolitem"></a>CFileDialog::GetSelectedControlItem  
 從指定的容器控制項在對話方塊中，擷取特定項目。  
  
```  
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD& dwIDItem);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 使用者控制項中選取之項目的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getstartposition"></a>CFileDialog::GetStartPosition  
 呼叫此成員函式，擷取的第一個檔案的路徑名稱的位置，在清單中，如果`m_ofn.Flags`具有`OFN_ALLOWMULTISELECT`旗標組。  
  
```  
POSITION GetStartPosition() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A**位置**值，可用於反覆項目。**NULL**如果清單是空的。  
  
##  <a name="hidecontrol"></a>CFileDialog::HideControl  
 呼叫此成員函式，若要隱藏在檔案總管樣式開啟] 或 [另存新檔通用的對話方塊中指定的控制項。  
  
```  
void HideControl(int nID);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 若要隱藏的控制項識別碼。  
  
### <a name="remarks"></a>備註  
 對話方塊中必須已建立具有**OFN_EXPLORER**樣式; 否則函式會失敗，並判斷提示。  
  
##  <a name="ispickfoldersmode"></a>CFileDialog::IsPickFoldersMode  
 判斷目前對話方塊是否在資料夾選擇器模式。  
  
```  
BOOL IsPickFoldersMode() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果對話方塊在資料夾選擇器模式;否則`FALSE`。  
  
### <a name="remarks"></a>備註  
  
##  <a name="m_ofn"></a>CFileDialog::m_ofn  
 `m_ofn`是一種類型的結構`OPENFILENAME`。 此結構中的資料表示的目前狀態`CFileDialog`。  
  
### <a name="remarks"></a>備註  
 使用此結構來初始化的外觀**開啟舊檔**或**檔案另存新檔**對話方塊建構它後，但您將其與顯示[DoModal](#domodal)方法。 例如，您可以設定`lpstrTitle`隸屬`m_ofn`到標題中，您想讓對話方塊。  
  
 與[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式[CFileDialog](../../mfc/reference/cfiledialog-class.md)，`m_ofn`不保證一定要相符對話方塊的狀態。 它會同步處理舊版 Windows 中的對話方塊。 請參閱[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)和[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)如需有關同步處理`m_ofn`結構和`CFileDialog`狀態在下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]。  
  
 [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式檔案對話方塊不支援某些成員和旗標的`CFileDialog`。 如此一來，這些會有任何作用。  
  
 以下是不支援成員的清單[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]:  
  
- `lpstrCustomFilter`  
  
- `lpstrInitialDir`  
  
- `lCustData`  
  
- `lpfnHook`  
  
- `lpTemplateName`  
  
 不支援下列旗標，且因此有任何作用，當您使用[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式`CFileDialog`:  
  
-   OFN_ENABLEHOOK  
  
-   OFN_ENABLEINCLUDENOTIFY  
  
-   OFN_ENABLETEMPLATE  
  
-   OFN_ENABLETEMPLATEHANDLE  
  
-   OFN_EXPLORER  
  
-   OFN_EXTENSIONDIFFERENT  
  
-   OFN_HIDEREADONLY  
  
-   OFN_LONGNAMES-永遠有效地在中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]  
  
-   OFN_NOLONGNAMES-有效永遠關閉中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]  
  
-   OFN_NONETWORKBUTTON-永遠有效地在中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]  
  
-   OFN_READONLY  
  
-   OFN_SHOWHELP  
  
 如需此結構的詳細資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839) Windows SDK 中的結構。  
  
##  <a name="makeprominent"></a>CFileDialog::MakeProminent  
 上的芳鄰 對話方塊中的控制項，讓它突出相較於其他控制項。  
  
```  
HRESULT MakeProminent(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 控制項的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="onbuttonclicked"></a>CFileDialog::OnButtonClicked  
 當按一下按鈕時呼叫。  
  
```  
virtual void OnButtonClicked(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 按鈕的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="oncheckbuttontoggled"></a>CFileDialog::OnCheckButtonToggled  
 選取或取消選取核取方塊時呼叫。  
  
```  
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 核取方塊的識別碼。  
  
 `bChecked`  
 Checked 或 unchecked。  
  
### <a name="remarks"></a>備註  
  
##  <a name="oncontrolactivating"></a>CFileDialog::OnControlActivating  
 啟動控制項時呼叫。  
  
```  
virtual void OnControlActivating(DWORD dwIDCtl);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 控制項的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="onfilenamechange"></a>CFileDialog::OnFileNY` `變更  
 覆寫這個方法，如果您想要處理`WM_NOTIFY``CDN_SELCHANGE`訊息。  
  
```  
virtual void OnFileNameChange();
```  
  
### <a name="remarks"></a>備註  
 系統會傳送`CDN_SELCHANGE`當使用者選取的檔案清單中的新檔案或資料夾時，訊息**開啟**或**存** 對話方塊。 如果您想要執行任何動作以回應這個訊息，覆寫這個方法。  
  
 只有當對話方塊建立 OFN_EXPLORER 旗標為開啟，系統會傳送此訊息。 如需通知的詳細資訊，請參閱[CDN_SELCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646865)。 OFN_EXPLORER 旗標的相關資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839)結構和[開啟和儲存為對話方塊](http://msdn.microsoft.com/library/windows/desktop/ms646960)。  
  
##  <a name="onfilenameok"></a>CFileDialog::OnFileNameOK  
 只有當您想要提供自訂驗證的通用檔案對話方塊中輸入的檔案名稱，覆寫這個函式。  
  
```  
virtual BOOL OnFileNameOK();
```  
  
### <a name="return-value"></a>傳回值  
 1，表示檔名不是有效的檔名。否則便是 0。  
  
### <a name="remarks"></a>備註  
 此函式可讓您拒絕任何應用程式特定原因的檔名。 一般來說，您不需要使用此函式，因為架構提供的檔名的預設驗證，並顯示訊息方塊，如果輸入無效的檔案名稱。  
  
 如果傳回 1，則對話方塊中將仍會顯示輸入另一個檔名使用者。 如果傳回為 0 的對話方塊程序會解除對話方塊。 其他則為非零傳回值是目前保留，而且不應使用。  
  
##  <a name="onfolderchange"></a>CFileDialog::OnFolderChange  
 覆寫這個函式，以處理**WM_NOTIFYCDN_FOLDERCHANGE**訊息。  
  
```  
virtual void OnFolderChange();
```  
  
### <a name="remarks"></a>備註  
 在 [開啟] 或 [另存新檔] 對話方塊中開啟新的資料夾時，會傳送通知訊息。  
  
 只有具有 OFN_EXPLORER 樣式建立對話方塊時，會傳送通知。 如需通知的詳細資訊，請參閱[CDN_FOLDERCHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646859)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839)結構和[開啟和儲存為對話方塊](http://msdn.microsoft.com/library/windows/desktop/ms646960)。  
  
##  <a name="oninitdone"></a>CFileDialog::OnInitDone  
 覆寫這個函式，以處理`WM_NOTIFY``CDN_INITDONE`訊息。  
  
```  
virtual void OnInitDone();
```  
  
### <a name="remarks"></a>備註  
 系統已完成排列控制項中的時，系統會傳送這項通知訊息**開啟**或**存**以騰出供子 對話方塊中控制項的對話方塊。  
  
 只有當對話方塊建立 OFN_EXPLORER 樣式，系統會傳送這。 如需通知的詳細資訊，請參閱[CDN_INITDONE](http://msdn.microsoft.com/library/windows/desktop/ms646863)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839)結構和[開啟和儲存為對話方塊](http://msdn.microsoft.com/library/windows/desktop/ms646960)。  
  
> [!NOTE]
> [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式檔案對話方塊不支援此函式。 嘗試使用這個函式[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式檔案對話方塊將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。 
  
##  <a name="onitemselected"></a>CFileDialog::OnItemSelected  
 選取容器項目時呼叫。  
  
```  
virtual void OnItemSelected(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="onlbselchangednotify"></a>CFileDialog::OnLBSelChangedNotify  
 若要變更清單方塊中的目前選取範圍時，會呼叫此函數。  
  
```  
virtual void OnLBSelChangedNotify(
    UINT nIDBox,  
    UINT iCurSel,  
    UINT nCode);
```  
  
### <a name="parameters"></a>參數  
 *nIDBox*  
 清單方塊或下拉式方塊選取項目發生所在的識別碼。  
  
 `iCurSel`  
 目前的選取範圍的索引。  
  
 `nCode`  
 控制項告知程式碼。 這個參數必須要有下列值之一：  
  
- **CD_LBSELCHANGE**指定`iCurSel`是單一選取清單方塊中選取的項目。  
  
- **CD_LBSELSUB**指定`iCurSel`不再多重選取清單方塊中選取。  
  
- **CD_LBSELADD**指定`iCurSel`多重選取清單方塊中選取。  
  
- **CD_LBSELNOITEMS**沒有選取項目存在多重選取清單方塊中指定。  
  
### <a name="remarks"></a>備註  
 覆寫此函式可提供的清單方塊中選取範圍變更的自訂處理。 例如，您可以使用此函式顯示的存取權限，或日期-上次修改的每個檔案在使用者選取。  
  
##  <a name="onshareviolation"></a>CFileDialog::OnShareViolation  
 覆寫此函式可提供共用違規的自訂處理。  
  
```  
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```  
  
### <a name="parameters"></a>參數  
 `lpszPathName`  
 發生共用違規的檔案路徑。  
  
### <a name="return-value"></a>傳回值  
 下列其中一個值：  
  
- **OFN_SHAREFALLTHROUGH**從對話方塊傳回檔名。  
  
- **OFN_SHARENOWARN**需要採取任何進一步的動作。  
  
- **OFN_SHAREWARN**使用者會收到此錯誤的標準的警告訊息。  
  
### <a name="remarks"></a>備註  
 一般來說，您不需要使用此函式，因為架構提供預設的共用違規檢查，並顯示訊息方塊，如果發生共用違規。  
  
 如果您想要停用共用違規檢查，會使用位元 OR 運算子來結合旗標**OFN_SHAREAWARE**與`m_ofn.Flags`。  
  
##  <a name="ontypechange"></a>CFileDialog::OnTypeChange  
 覆寫這個函式，以處理**WM_NOTIFYCDN_TYPECHANGE**訊息。  
  
```  
virtual void OnTypeChange();
```  
  
### <a name="remarks"></a>備註  
 當使用者選取新檔案類型從清單中開啟的檔案類型或另存新檔 對話方塊時，會傳送通知訊息。  
  
 只有具有 OFN_EXPLORER 樣式建立對話方塊時，會傳送通知。 如需通知的詳細資訊，請參閱[CDN_TYPECHANGE](http://msdn.microsoft.com/library/windows/desktop/ms646868)。 OFN_EXPLORER 樣式的相關資訊，請參閱[OPENFILENAME](http://msdn.microsoft.com/library/windows/desktop/ms646839)結構和[開啟和儲存為對話方塊](http://msdn.microsoft.com/library/windows/desktop/ms646960)。  
  
##  <a name="removecontrolitem"></a>CFileDialog::RemoveControlItem  
 在對話方塊中的容器控制項中移除的項目。  
  
```  
HRESULT RemoveControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 要移除的項目從容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcheckbuttonstate"></a>CFileDialog::SetCheckButtonState  
 在對話方塊中設定的核取按鈕 （核取方塊） 的目前狀態。  
  
```  
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,  
    BOOL bChecked);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 核取方塊的識別碼。  
  
 `bChecked`  
 核取方塊的狀態。 `TRUE`表示已檢查;`FALSE`指出未核取。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcontrolitemstate"></a>CFileDialog::SetControlItemState  
 容器控制項位於對話方塊中設定項目的目前狀態。  
  
```  
HRESULT SetControlItemState(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
 `dwState`  
 一或多個值來自 CDCONTROLSTATE 列舉，指出控制項的新狀態。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcontrolitemtext"></a>CFileDialog::SetControlItemText  
 設定控制項項目的文字。 例如，伴隨著選項按鈕或功能表項目變更的文字。  
  
```  
HRESULT SetControlItemText(
    DWORD dwIDCtl,  
    DWORD dwIDItem,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 項目的識別碼。  
  
 `strLabel`  
 項目的文字。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcontrollabel"></a>CFileDialog::SetControlLabel  
 設定控制項，例如按鈕文字或編輯方塊標籤相關聯的文字。  
  
```  
HRESULT SetControlLabel(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 控制項的識別碼。  
  
 `strLabel`  
 控制項名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcontrolstate"></a>CFileDialog::SetControlState  
 設定目前的可見性，並啟用特定控制項的狀態。  
  
```  
HRESULT SetControlState(
    DWORD dwIDCtl,  
    CDCONTROLSTATEF dwState);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 控制項的識別碼。  
  
 `dwState`  
 一或多個值來自 CDCONTROLSTATE 列舉，指出控制項的目前狀態。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setcontroltext"></a>CFileDialog::SetControlText  
 呼叫此方法以設定指定之控制項的文字在檔案總管樣式**開啟**或**存** 對話方塊。  
  
```  
void SetControlText(
    int nID,  
    LPCSTR lpsz);

 
void SetControlText(
    int nID,  
    const wchar_t *lpsz);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nID`  
 這是要設定的文字控制項的 ID。  
  
 [輸入] `lpsz`  
 包含要設定的控制項文字的字串指標。  
  
### <a name="remarks"></a>備註  
 此函式的兩個版本都有效的應用程式，使用 Unicode。 但是，只有 LPCSTR 類型與版本是有效的應用程式使用[!INCLUDE[vcpransi](../../atl-mfc-shared/reference/includes/vcpransi_md.md)]。  
  
 若要使用這個方法，您必須建立對話方塊 OFN_EXPLORER 樣式。 否則，函式將會失敗的判斷提示。  
  
##  <a name="setdefext"></a>CFileDialog::SetDefExt  
 呼叫此函式可設定 檔案總管樣式開啟 或 另存新檔通用的對話方塊中的預設檔案名稱副檔名。  
  
```  
void SetDefExt(LPCSTR lpsz);
```  
  
### <a name="parameters"></a>參數  
 `lpsz`  
 包含要用於對話方塊物件的預設副檔名的字串指標。 此字串必須包含句號 （.）。  
  
### <a name="remarks"></a>備註  
 對話方塊中必須已建立具有**OFN_EXPLORER**樣式; 否則函式會失敗，並判斷提示。  
  
##  <a name="seteditboxtext"></a>CFileDialog::SetEditBoxText  
 設定目前的文字編輯方塊控制項中。  
  
```  
HRESULT SetEditBoxText(
    DWORD dwIDCtl,  
    const CString& strText);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 編輯方塊的識別碼。  
  
 `strText`  
 文字值。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setproperties"></a>CFileDialog::SetProperties  
 提供屬性儲存區，可定義要用於所儲存之項目的預設值。  
  
```  
BOOL SetProperties(LPCWSTR lpszPropList);
```  
  
### <a name="parameters"></a>參數  
 `lpszPropList`  
 預先定義的屬性清單，以 ";" 分隔。 如需旗標的清單，請參閱`Flags`區段[OPENFILENAME](http://msdn.microsoft.com/en-us/8cecfd45-f7c1-4f8d-81a0-4e7fecc3b104)。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setselectedcontrolitem"></a>CFileDialog::SetSelectedControlItem  
 選項按鈕群組或在對話方塊中找到下拉式方塊中設定特定項目的選取的狀態。  
  
```  
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,  
    DWORD dwIDItem);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 容器控制項的識別碼。  
  
 `dwIDItem`  
 使用者控制項中選取之項目的識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="settemplate"></a>CFileDialog::SetTemplate  
 設定的對話方塊範本[CFileDialog](../../mfc/reference/cfiledialog-class.md)物件。  
  
```  
void SetTemplate(
    UINT nWin3ID,  
    UINT nWin4ID);

 
void SetTemplate(
    LPCTSTR lpWin3ID,  
    LPCTSTR lpWin4ID);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nWin3ID`  
 包含的範本資源的非 Explorer 識別碼`CFileDialog`物件。 在 Windows NT 3.51 或 OFN_EXPLORER 樣式不存在時，只會使用此範本。  
  
 [輸入] `nWin4ID`  
 [總管] 中包含的範本資源的 ID 編號`CFileDialog`物件。 此範本僅用於[!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)]和更新版本、 Windows 95 和更新版本中，或出現 OFN_EXPLORER 樣式時。  
  
 [輸入] `lpWin3ID`  
 包含名稱的範本資源的非 explorer`CFileDialog`物件。 在 Windows NT 3.51 或 OFN_EXPLORER 樣式不存在時，只會使用此範本。  
  
 [輸入] `lpWin4ID`  
 包含名稱的 [總管] 中的範本資源`CFileDialog`物件。 此範本僅用於[!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)]和更新版本、 Windows 95 和更新版本中，或出現 OFN_EXPLORER 樣式時。  
  
### <a name="remarks"></a>備註  
 系統會使用其中一個指定的範本。 系統會決定要使用哪一個範本以在 OFN_EXPLORER 樣式和作業系統上執行應用程式存在。 藉由指定的非總管 」 和 「 檔案總管樣式範本，所以可以輕鬆地支援 Windows NT 3.51[!INCLUDE[WinNt4Family](../../mfc/reference/includes/winnt4family_md.md)]和更新版本中，Windows 95 和更新版本。  
  
> [!NOTE]
> [!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式 [檔案] 對話方塊不支援此函式。 嘗試使用這個函式[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]樣式 [檔案] 對話方塊將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。 替代方法是使用自訂的對話方塊。 如需有關使用自訂`CFileDialog`，請參閱[IFileDialogCustomize](http://msdn.microsoft.com/library/windows/desktop/bb775912)。  
  
##  <a name="startvisualgroup"></a>CFileDialog::StartVisualGroup  
 宣告可見的群組，在對話方塊中。 任何 「 加入 」 方法的後續呼叫會將這些項目新增至此群組。  
  
```  
HRESULT StartVisualGroup(
    DWORD dwIDCtl,  
    const CString& strLabel);
```  
  
### <a name="parameters"></a>參數  
 `dwIDCtl`  
 視覺化群組的識別碼。  
  
 `strLabel`  
 群組名稱。  
  
### <a name="remarks"></a>備註  
  
##  <a name="updateofnfromshelldialog"></a>CFileDialog::UpdateOFNFromShellDialog  
 更新`m_ofn`資料結構[CFileDialog](../../mfc/reference/cfiledialog-class.md)內部物件的目前狀態為基礎。  
  
```  
void UpdateOFNFromShellDialog();
```  
  
### <a name="remarks"></a>備註  
 之前的 Windows 版本中[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]，成員[OPENFILENAME](https://msdn.microsoft.com/library/ms911906.aspx)持續資料結構進行同步處理狀態為  `CFileDialog`。 任何變更[m_ofn](#m_ofn)成員變數的直接影響對話方塊的狀態。 此外，在對話方塊的狀態的任何變更會立即更新 m_ofn 成員變數。  
  
 在[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]、`m_ofn`資料結構不會自動更新。 若要保證中資料的正確性`m_ofn`成員變數，您應該呼叫`UpdateOFNFromShellDialog`函式，才能存取資料。 Windows 會呼叫此函式會自動在處理期間[IFileDialog::OnFileOK](http://msdn.microsoft.com/library/windows/desktop/bb775879)。  
  
 如需有關如何使用`CFileDialog`類別下[!INCLUDE[wiprlhext](../../c-runtime-library/reference/includes/wiprlhext_md.md)]，請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。  
  
### <a name="example"></a>範例  
 這個範例會更新`CFileDialog`之前顯示。 更新之前`m_ofn`成員變數，我們需要進行同步處理 對話方塊中的目前狀態。  
  
 [!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]  
  
## <a name="see-also"></a>請參閱  
 [CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)

