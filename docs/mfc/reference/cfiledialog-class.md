---
title: CFileDialog 類別
ms.date: 11/04/2016
f1_keywords:
- CFileDialog
- AFXDLGS/CFileDialog
- AFXDLGS/CFileDialog::CFileDialog
- AFXDLGS/CFileDialog::AddCheckButton
- AFXDLGS/CFileDialog::AddComboBox
- AFXDLGS/CFileDialog::AddControlItem
- AFXDLGS/CFileDialog::AddEditBox
- AFXDLGS/CFileDialog::AddMenu
- AFXDLGS/CFileDialog::AddPlace
- AFXDLGS/CFileDialog::AddPushButton
- AFXDLGS/CFileDialog::AddRadioButtonList
- AFXDLGS/CFileDialog::AddSeparator
- AFXDLGS/CFileDialog::AddText
- AFXDLGS/CFileDialog::ApplyOFNToShellDialog
- AFXDLGS/CFileDialog::DoModal
- AFXDLGS/CFileDialog::EnableOpenDropDown
- AFXDLGS/CFileDialog::EndVisualGroup
- AFXDLGS/CFileDialog::GetCheckButtonState
- AFXDLGS/CFileDialog::GetControlItemState
- AFXDLGS/CFileDialog::GetControlState
- AFXDLGS/CFileDialog::GetEditBoxText
- AFXDLGS/CFileDialog::GetFileExt
- AFXDLGS/CFileDialog::GetFileName
- AFXDLGS/CFileDialog::GetFileTitle
- AFXDLGS/CFileDialog::GetFolderPath
- AFXDLGS/CFileDialog::GetIFileDialogCustomize
- AFXDLGS/CFileDialog::GetIFileOpenDialog
- AFXDLGS/CFileDialog::GetIFileSaveDialog
- AFXDLGS/CFileDialog::GetNextPathName
- AFXDLGS/CFileDialog::GetOFN
- AFXDLGS/CFileDialog::GetPathName
- AFXDLGS/CFileDialog::GetReadOnlyPref
- AFXDLGS/CFileDialog::GetResult
- AFXDLGS/CFileDialog::GetResults
- AFXDLGS/CFileDialog::GetSelectedControlItem
- AFXDLGS/CFileDialog::GetStartPosition
- AFXDLGS/CFileDialog::HideControl
- AFXDLGS/CFileDialog::IsPickFoldersMode
- AFXDLGS/CFileDialog::MakeProminent
- AFXDLGS/CFileDialog::RemoveControlItem
- AFXDLGS/CFileDialog::SetCheckButtonState
- AFXDLGS/CFileDialog::SetControlItemState
- AFXDLGS/CFileDialog::SetControlItemText
- AFXDLGS/CFileDialog::SetControlLabel
- AFXDLGS/CFileDialog::SetControlState
- AFXDLGS/CFileDialog::SetControlText
- AFXDLGS/CFileDialog::SetDefExt
- AFXDLGS/CFileDialog::SetEditBoxText
- AFXDLGS/CFileDialog::SetProperties
- AFXDLGS/CFileDialog::SetSelectedControlItem
- AFXDLGS/CFileDialog::SetTemplate
- AFXDLGS/CFileDialog::StartVisualGroup
- AFXDLGS/CFileDialog::UpdateOFNFromShellDialog
- AFXDLGS/CFileDialog::OnButtonClicked
- AFXDLGS/CFileDialog::OnCheckButtonToggled
- AFXDLGS/CFileDialog::OnControlActivating
- AFXDLGS/CFileDialog::OnFileNameChange
- AFXDLGS/CFileDialog::OnFileNameOK
- AFXDLGS/CFileDialog::OnFolderChange
- AFXDLGS/CFileDialog::OnInitDone
- AFXDLGS/CFileDialog::OnItemSelected
- AFXDLGS/CFileDialog::OnLBSelChangedNotify
- AFXDLGS/CFileDialog::OnShareViolation
- AFXDLGS/CFileDialog::OnTypeChange
- AFXDLGS/CFileDialog::m_ofn
helpviewer_keywords:
- CFileDialog [MFC], CFileDialog
- CFileDialog [MFC], AddCheckButton
- CFileDialog [MFC], AddComboBox
- CFileDialog [MFC], AddControlItem
- CFileDialog [MFC], AddEditBox
- CFileDialog [MFC], AddMenu
- CFileDialog [MFC], AddPlace
- CFileDialog [MFC], AddPushButton
- CFileDialog [MFC], AddRadioButtonList
- CFileDialog [MFC], AddSeparator
- CFileDialog [MFC], AddText
- CFileDialog [MFC], ApplyOFNToShellDialog
- CFileDialog [MFC], DoModal
- CFileDialog [MFC], EnableOpenDropDown
- CFileDialog [MFC], EndVisualGroup
- CFileDialog [MFC], GetCheckButtonState
- CFileDialog [MFC], GetControlItemState
- CFileDialog [MFC], GetControlState
- CFileDialog [MFC], GetEditBoxText
- CFileDialog [MFC], GetFileExt
- CFileDialog [MFC], GetFileName
- CFileDialog [MFC], GetFileTitle
- CFileDialog [MFC], GetFolderPath
- CFileDialog [MFC], GetIFileDialogCustomize
- CFileDialog [MFC], GetIFileOpenDialog
- CFileDialog [MFC], GetIFileSaveDialog
- CFileDialog [MFC], GetNextPathName
- CFileDialog [MFC], GetOFN
- CFileDialog [MFC], GetPathName
- CFileDialog [MFC], GetReadOnlyPref
- CFileDialog [MFC], GetResult
- CFileDialog [MFC], GetResults
- CFileDialog [MFC], GetSelectedControlItem
- CFileDialog [MFC], GetStartPosition
- CFileDialog [MFC], HideControl
- CFileDialog [MFC], IsPickFoldersMode
- CFileDialog [MFC], MakeProminent
- CFileDialog [MFC], RemoveControlItem
- CFileDialog [MFC], SetCheckButtonState
- CFileDialog [MFC], SetControlItemState
- CFileDialog [MFC], SetControlItemText
- CFileDialog [MFC], SetControlLabel
- CFileDialog [MFC], SetControlState
- CFileDialog [MFC], SetControlText
- CFileDialog [MFC], SetDefExt
- CFileDialog [MFC], SetEditBoxText
- CFileDialog [MFC], SetProperties
- CFileDialog [MFC], SetSelectedControlItem
- CFileDialog [MFC], SetTemplate
- CFileDialog [MFC], StartVisualGroup
- CFileDialog [MFC], UpdateOFNFromShellDialog
- CFileDialog [MFC], OnButtonClicked
- CFileDialog [MFC], OnCheckButtonToggled
- CFileDialog [MFC], OnControlActivating
- CFileDialog [MFC], OnFileNameChange
- CFileDialog [MFC], OnFileNameOK
- CFileDialog [MFC], OnFolderChange
- CFileDialog [MFC], OnInitDone
- CFileDialog [MFC], OnItemSelected
- CFileDialog [MFC], OnLBSelChangedNotify
- CFileDialog [MFC], OnShareViolation
- CFileDialog [MFC], OnTypeChange
- CFileDialog [MFC], m_ofn
ms.assetid: fda4fd3c-08b8-4ce0-8e9d-7bab23f8c6c0
ms.openlocfilehash: a7287b2e3011159573f44e9247e016d81d893491
ms.sourcegitcommit: c3bf94210bdb73be80527166264d49e33784152c
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/06/2019
ms.locfileid: "68821077"
---
# <a name="cfiledialog-class"></a>CFileDialog 類別

封裝用於檔案開啟或檔案儲存作業的通用對話方塊。

## <a name="syntax"></a>語法

```
class CFileDialog : public CCommonDialog
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|說明|
|----------|-----------------|
|[CFileDialog::CFileDialog](#cfiledialog)|建構 `CFileDialog` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CFileDialog::AddCheckButton](#addcheckbutton)|將核取按鈕新增至對話方塊。|
|[CFileDialog::AddComboBox](#addcombobox)|將下拉式方塊加入至對話方塊。|
|[CFileDialog::AddControlItem](#addcontrolitem)|將專案加入至對話方塊中的容器控制項。|
|[CFileDialog::AddEditBox](#addeditbox)|將編輯方塊新增至對話方塊。|
|[CFileDialog::AddMenu](#addmenu)|將功能表加入至對話方塊。|
|[CFileDialog::AddPlace](#addplace)|多載。 將資料夾新增至可讓使用者開啟或儲存專案的位置清單。|
|[CFileDialog::AddPushButton](#addpushbutton)|將按鈕加入至對話方塊。|
|[CFileDialog::AddRadioButtonList](#addradiobuttonlist)|將選項按鈕 (也稱為選項按鈕) 群組新增至對話方塊。|
|[CFileDialog::AddSeparator](#addseparator)|在對話方塊中加入分隔符號。|
|[CFileDialog::AddText](#addtext)|將文字內容新增至對話方塊。|
|[CFileDialog::ApplyOFNToShellDialog](#applyofntoshelldialog)|更新的`CFileDialog`狀態, 以符合儲存`m_ofn`在成員變數中的參數和旗標。|
|[CFileDialog::DoModal](#domodal)|顯示對話方塊, 並讓使用者進行選取。|
|[CFileDialog::EnableOpenDropDown](#enableopendropdown)|啟用對話方塊中 [**開啟**] 或 [**儲存**] 按鈕上的下拉式清單。|
|[CFileDialog::EndVisualGroup](#endvisualgroup)|停止將專案新增至對話方塊中的視覺效果群組。|
|[CFileDialog::GetCheckButtonState](#getcheckbuttonstate)|取得對話方塊中複選按鈕 (核取方塊) 的目前狀態。|
|[CFileDialog::GetControlItemState](#getcontrolitemstate)|取得在對話方塊中找到之容器控制項內專案的目前狀態。|
|[CFileDialog::GetControlState](#getcontrolstate)|取得指定控制項的目前可見度和已啟用狀態。|
|[CFileDialog::GetEditBoxText](#geteditboxtext)|取得編輯方塊控制項中的目前文字。|
|[CFileDialog::GetFileExt](#getfileext)|傳回所選取檔案的副檔名。|
|[CFileDialog::GetFileName](#getfilename)|傳回選取之檔案的檔案名。|
|[CFileDialog::GetFileTitle](#getfiletitle)|傳回選取之檔案的標題。|
|[CFileDialog::GetFolderPath](#getfolderpath)|抓取目前開啟的資料夾或目錄的路徑, 以取得 Explorer 樣式的**開啟**或**另存為**通用對話方塊。|
|[CFileDialog::GetIFileDialogCustomize](#getifiledialogcustomize)|抓取自訂`CFileDialog`物件的內部 COM 物件。|
|[CFileDialog::GetIFileOpenDialog](#getifileopendialog)|針對`CFileDialog`當做 [**開啟**檔案] 對話方塊使用的, 抓取的內部 COM 物件。|
|[CFileDialog::GetIFileSaveDialog](#getifilesavedialog)|抓取當做 [**儲存**盤案] `CFileDialog`對話方塊使用之的內部 COM 物件。|
|[CFileDialog::GetNextPathName](#getnextpathname)|傳回下一個選取之檔案的完整路徑。|
|[CFileDialog::GetOFN](#getofn)|抓取物件`CFileDialog`的結構。 `OPENFILENAME`|
|[CFileDialog::GetPathName](#getpathname)|傳回選取之檔案的完整路徑。|
|[CFileDialog::GetReadOnlyPref](#getreadonlypref)|傳回所選取檔案的唯讀狀態。|
|[CFileDialog::GetResult](#getresult)|取得使用者在對話方塊中所做的選擇。|
|[CFileDialog::GetResults](#getresults)|在允許多重選取的對話方塊中, 取得使用者的選擇。|
|[CFileDialog::GetSelectedControlItem](#getselectedcontrolitem)|從對話方塊中指定的容器控制項取得特定專案。|
|[CFileDialog::GetStartPosition](#getstartposition)|傳回檔案名清單中第一個元素的位置。|
|[CFileDialog::HideControl](#hidecontrol)|在 Explorer 樣式的 [**開啟**] 或 [**另存為**通用] 對話方塊中隱藏指定的控制項。|
|[CFileDialog::IsPickFoldersMode](#ispickfoldersmode)|判斷資料夾選擇器模式中目前的對話方塊。|
|[CFileDialog::MakeProminent](#makeprominent)|將控制項放在對話方塊中, 以便與其他加入的控制項相對應。|
|[CFileDialog::RemoveControlItem](#removecontrolitem)|從對話方塊中的容器控制項移除專案。|
|[CFileDialog::SetCheckButtonState](#setcheckbuttonstate)|設定對話方塊中複選按鈕 (核取方塊) 的目前狀態。|
|[CFileDialog::SetControlItemState](#setcontrolitemstate)|設定在對話方塊中找到之容器控制項內專案的目前狀態。|
|[CFileDialog::SetControlItemText](#setcontrolitemtext)|設定控制項專案的文字。 例如, 出現在功能表中的選項按鈕或專案的文字。|
|[CFileDialog::SetControlLabel](#setcontrollabel)|設定與控制項相關聯的文字, 例如按鈕文字或編輯方塊標籤。|
|[CFileDialog::SetControlState](#setcontrolstate)|設定指定控制項的目前可見度和已啟用狀態。|
|[CFileDialog::SetControlText](#setcontroltext)|在 [Explorer] 樣式的 [**開啟**] 或 [**另存為**通用] 對話方塊中, 設定指定之控制項的文字。|
|[CFileDialog::SetDefExt](#setdefext)|為 Explorer 樣式的**開啟**或 [**另存為**通用] 對話方塊設定預設的副檔名。|
|[CFileDialog::SetEditBoxText](#seteditboxtext)|設定編輯方塊控制項中的目前文字。|
|[CFileDialog::SetProperties](#setproperties)|提供屬性儲存區，可定義要用於所儲存之項目的預設值。|
|[CFileDialog::SetSelectedControlItem](#setselectedcontrolitem)|設定選項按鈕群組中特定專案的選取狀態, 或在對話方塊中找到的下拉式方塊。|
|[CFileDialog::SetTemplate](#settemplate)|設定`CFileDialog`物件的對話方塊範本。|
|[CFileDialog::StartVisualGroup](#startvisualgroup)|在對話方塊中宣告視覺效果群組。 後續呼叫任何 "add" 方法會將這些元素新增至此群組。|
|[CFileDialog::UpdateOFNFromShellDialog](#updateofnfromshelldialog)|更新儲存在`m_ofn`成員變數中的資料, 以符合 [檔案] 對話方塊的目前狀態。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CFileDialog::OnButtonClicked](#onbuttonclicked)|按一下按鈕時呼叫。|
|[CFileDialog::OnCheckButtonToggled](#oncheckbuttontoggled)|已勾選/未核取核取方塊時呼叫。|
|[CFileDialog::OnControlActivating](#oncontrolactivating)|當控制項處於作用中狀態時呼叫。|
|[CFileDialog::OnFileNameChange](#onfilenamechange)|處理 WM_NOTIFY CDN_SELCHANGE 訊息。|
|[CFileDialog::OnFileNameOK](#onfilenameok)|驗證在對話方塊中輸入的檔案名。|
|[CFileDialog::OnFolderChange](#onfolderchange)|處理 WM_NOTIFY CDN_FOLDERCHANGE 訊息。|
|[CFileDialog::OnInitDone](#oninitdone)|處理 WM_NOTIFY CDN_INITDONE 訊息。|
|[CFileDialog::OnItemSelected](#onitemselected)|當選取容器專案時呼叫。|
|[CFileDialog::OnLBSelChangedNotify](#onlbselchangednotify)|可讓您在檔案選取變更時執行自訂動作。|
|[CFileDialog::OnShareViolation](#onshareviolation)|處理共用違規。|
|[CFileDialog::OnTypeChange](#ontypechange)|處理 WM_NOTIFY CDN_TYPECHANGE 訊息。|

### <a name="public-data-members"></a>公用資料成員

|名稱|說明|
|----------|-----------------|
|[CFileDialog::m_ofn](#m_ofn)|Windows `OPENFILENAME`結構。 提供基本檔案對話方塊參數的存取權。|

## <a name="remarks"></a>備註

一般檔案對話方塊可讓您以與 Windows 標準一致的方式, 執行檔案選擇對話方塊, 例如**開啟**檔案並**另存**新檔。

您可以使用`CFileDialog`所提供的函式, 也可以從`CFileDialog`衍生您自己的對話方塊類別, 並撰寫符合您需求的函式。 不論是哪一種情況, 這些對話方塊的行為都像標準 MFC 對話方塊, 因為它們衍生自[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)。 `CFileDialog`依賴 COMMDLG。包含在 Windows 中的 DLL 檔案。

`CFileDialog`與 windows Vista 或更新版本的外觀和功能, 與舊版 windows 不同。 如果程式`CFileDialog`是在 Windows vista 或更新版本下編譯和執行, 則預設會自動使用新的 Windows Vista 或更新版本的樣式, 而不會變更程式碼。 在此函式中使用*bVistaStyle*參數, 以手動覆寫此自動更新。 自動更新的例外狀況是自訂的對話方塊。 它們將不會轉換成新的樣式。 如需有關此函數的詳細資訊, 請參閱[CFileDialog:: CFileDialog](#cfiledialog)。

> [!NOTE]
>  當您使用`CFileDialog`時, 控制項識別碼系統在 windows Vista 或更新版本中與舊版 windows 不同。 您必須先更新程式碼`CFileDialog`中控制項的所有參考, 然後才能從舊版 Windows 移植您的專案。

Windows `CFileDialog` Vista 或更新版本不支援某些方法。 請檢查個別的方法主題, 以取得是否支援該方法的相關資訊。 此外, Windows Vista 或更新版本下不支援下列繼承函式:

- [CDialog::OnInitDialog](../../mfc/reference/cdialog-class.md#oninitdialog)

- [CDialog::OnSetFont](../../mfc/reference/cdialog-class.md#onsetfont)

`CFileDialog`類別的 windows 訊息會根據您使用的作業系統而有所不同。 例如, Windows XP 不支援類別`CFileDialog`的[CDialog:: OnCancel](../../mfc/reference/cdialog-class.md#oncancel)和[CDialog:: OnOK](../../mfc/reference/cdialog-class.md#onok) 。 不過, Windows Vista 和更新版本的作業系統支援它們。 如需所產生之不同訊息和接收順序的詳細資訊, 請參閱[CFileDialog 範例:記錄事件順序](../../overview/visual-cpp-samples.md)。

若要使用`CFileDialog`物件, 請先使用此`CFileDialog`函式建立物件。 在結構化對話方塊之後, 您可以設定或修改[CFileDialog:: m_ofn](#m_ofn)結構中的任何值, 以初始化對話方塊控制項的值或狀態。 結構的類型`OPENFILENAME`為。 `m_ofn` 如需詳細資訊, 請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

初始化對話方塊控制項之後, 請呼叫[CFileDialog::D omodal](#domodal)方法來顯示對話方塊, 讓使用者可以輸入路徑和檔案名。 `DoModal`傳回使用者是否已按一下 [確定] (IDOK) 或 [取消] (IDCANCEL) 按鈕。 如果`DoModal`傳回 IDOK, 您可以使用其中一個`CFileDialog`公用成員函式來抓取使用者所放入的資訊。

> [!NOTE]
> 在 Windows Vista 或更新版本中, 對[IFileDialog:: SetFileTypes](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialog-setfiletypes)的多次呼叫會造成錯誤。 `SetFileTypes`針對任何實例`CFileDialog`的第二個呼叫會在 Windows Vista 或更新版本中傳回 E_UNEXPECTED。 某些`CFileDialog`方法函數會`SetFileTypes`呼叫。 例如, `CFileDialog::DoModal`針對相同實例 `CFileDialog`的兩個呼叫會產生[判斷提示](diagnostic-services.md#assert)。

`CFileDialog`包含數個受保護的成員, 可讓您進行共用違規、檔案名驗證和清單方塊變更通知的自訂處理。 這些受保護的成員是回呼函式, 大部分的應用程式都不需要使用, 因為預設處理會自動執行。 這些函式的訊息對應專案並不是必要的, 因為它們都是標準虛擬函數。

您可以使用 Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror)函式來判斷對話方塊初始化期間是否發生錯誤, 並深入瞭解錯誤。

`CFileDialog`物件的銷毀會自動處理。 您不需要呼叫[CDialog:: EndDialog](../../mfc/reference/cdialog-class.md#enddialog)。

若要讓使用者選取多個檔案, 請在呼叫`DoModal`之前設定 OFN_ALLOWMULTISELECT 旗標。 您必須提供自己的檔案名緩衝區, 以容納傳回的多個檔案名清單。 若要這麼做`m_ofn.lpstrFile` , 請將取代為您已配置之緩衝區的指標, 在`CFileDialog`您建立之後, 但`DoModal`在呼叫之前。

此外, 您必須使用`m_ofn.nMaxFile`所指向`m_ofn.lpstrFile`之緩衝區中的字元數來設定。 如果您設定要選取`n`的檔案數目上限, 則所需的緩衝區大小為。 `n * (_MAX_PATH + 1) + 1` 緩衝區中傳回的第一個專案是選取檔案之資料夾的路徑。 針對 Windows Vista 或更新版本的對話方塊, 目錄和檔案名字串會以 null 結束, 最後一個檔案名後面會有額外的 null 字元。 此格式可讓 Explorer 樣式的對話方塊傳回包含空格的長檔名。 若是舊樣式的對話方塊, 目錄和檔案名字串會以空格分隔, 而函式會使用短檔案名來表示檔案名加上空格。

下列範例示範如何使用緩衝區來取出和列出多個檔案名。

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

若要變更緩衝區大小以回應使用者選取多個檔案名, 您必須從`CFileDialog`衍生新的類別, 並覆寫[CFileDialog:: OnFileNameChange](#onfilenamechange)方法。

如果您從`CFileDialog`衍生新的類別, 您可以使用訊息對應來處理任何訊息。 若要擴充預設訊息處理, 請從`CFileDialog`衍生類別, 將訊息對應加入至新的類別, 並提供新訊息的成員函式。 您不需要提供攔截函式來自訂對話方塊。

若要自訂對話方塊、從`CFileDialog`衍生類別, 請提供自訂對話方塊範本, 並加入訊息對應以處理來自擴充控制項的通知訊息。 將任何未處理的訊息傳遞至基類。 您不需要自訂攔截函式。

當您使用的 Windows Vista 或更新版本的`CFileDialog`樣式時, 無法使用訊息對應和對話方塊範本。 相反地, 您必須使用 COM 介面來進行類似的功能。

如需如何使用`CFileDialog`的詳細資訊, 請參閱[通用對話方塊類別](../../mfc/common-dialog-classes.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CDialog](../../mfc/reference/cdialog-class.md)

[CCommonDialog](../../mfc/reference/ccommondialog-class.md)

`CFileDialog`

## <a name="requirements"></a>需求

**標頭:** afxdlgs。h

##  <a name="addcheckbutton"></a>CFileDialog:: AddCheckButton

將核取按鈕新增至對話方塊。

```
HRESULT AddCheckButton(
    DWORD dwIDCtl,
    const CString& strLabel,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之複選按鈕的識別碼。

*strLabel*<br/>
核取按鈕名稱。

*bChecked*<br/>
布林值, 指出核取按鈕的目前狀態。 若已核取, 則為 TRUE;否則為 FALSE

### <a name="remarks"></a>備註

##  <a name="addcombobox"></a>CFileDialog:: AddComboBox

將下拉式方塊加入至對話方塊。

```
HRESULT AddComboBox(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之下拉式方塊的識別碼。

### <a name="remarks"></a>備註

##  <a name="addcontrolitem"></a>CFileDialog:: AddControlItem

將專案加入至對話方塊中的容器控制項。

```
HRESULT AddControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入專案的容器控制項識別碼。

*dwIDItem*<br/>
專案的識別碼。

*strLabel*<br/>
專案的文字。

### <a name="remarks"></a>備註

##  <a name="addeditbox"></a>CFileDialog:: AddEditBox

將編輯方塊新增至對話方塊。

```
HRESULT AddEditBox(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之編輯方塊的識別碼。

*strText*<br/>
編輯方塊名稱。

### <a name="remarks"></a>備註

##  <a name="addmenu"></a>CFileDialog:: AddMenu

將功能表加入至對話方塊。

```
HRESULT AddMenu(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之功能表的識別碼。

*strLabel*<br/>
功能表名稱。

### <a name="remarks"></a>備註

##  <a name="addplace"></a>CFileDialog:: AddPlace

將資料夾新增至可讓使用者開啟或儲存專案的位置清單。

```
void AddPlace(
    LPCWSTR lpszFolder,
    FDAP fdap = FDAP_TOP) throw();

void AddPlace(
    IShellItem* psi,
    FDAP fdap = FDAP_TOP) throw();
```

### <a name="parameters"></a>參數

*lpszFolder*<br/>
可供使用者使用之資料夾的路徑。 這只能是資料夾。

*fdap*<br/>
指定資料夾放在清單中的位置。

*psi*<br/>
代表要提供給使用者之資料夾的 IShellItem 指標。 這只能是資料夾。

### <a name="remarks"></a>備註

##  <a name="addpushbutton"></a>CFileDialog:: AddPushButton

將按鈕加入至對話方塊。

```
HRESULT AddPushButton(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之按鈕的識別碼。

*strLabel*<br/>
按鈕名稱。

### <a name="remarks"></a>備註

##  <a name="addradiobuttonlist"></a>CFileDialog:: AddRadioButtonList

將選項按鈕 (也稱為選項按鈕) 群組新增至對話方塊。

```
HRESULT AddRadioButtonList(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之選項按鈕群組的識別碼。

### <a name="remarks"></a>備註

##  <a name="addseparator"></a>CFileDialog:: AddSeparator

在對話方塊中加入分隔符號。

```
HRESULT AddSeparator(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
加入分隔符號的識別碼。

### <a name="remarks"></a>備註

##  <a name="addtext"></a>CFileDialog:: Shapes.addtext

將文字加入至對話方塊。

```
HRESULT AddText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要加入之文字的識別碼。

*strText*<br/>
文字名稱。

### <a name="remarks"></a>備註

##  <a name="applyofntoshelldialog"></a>  CFileDialog::ApplyOFNToShellDialog

根據儲存在`m_ofn`資料結構中的值, 更新[CFileDialog](../../mfc/reference/cfiledialog-class.md)的目前狀態。

```
void ApplyOFNToShellDialog();
```

### <a name="remarks"></a>備註

在 Windows Vista 之前的 Windows 版本中, 成員[OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\))資料結構會持續與的狀態`CFileDialog`同步處理。 [M_ofn](#m_ofn)成員變數的任何變更都會立即反映在對話方塊的狀態中。 此外, 對對話方塊狀態所做的任何變更都會立即更新`m_ofn`成員變數。

在 Windows Vista 或更新版本中, `m_ofn`成員變數中的值和的狀態`CFileDialog`不保證會進行同步處理。 此函式會強制更新的`CFileDialog`狀態, 以`m_ofn`符合結構。 Windows 會在 CFileDialog 期間自動呼叫此函式[::D omodal](#domodal)。

如需如何在 Windows Vista 或更新`CFileDialog`版本中使用類別的詳細資訊, 請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

  請參閱[CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog)的範例。

##  <a name="cfiledialog"></a>CFileDialog:: CFileDialog

呼叫此函式可建立標準 Windows 檔案對話方塊。

```
explicit CFileDialog(
    BOOL bOpenFileDialog,
    LPCTSTR lpszDefExt = NULL,
    LPCTSTR lpszFileName = NULL,
    DWORD dwFlags = OFN_HIDEREADONLY | OFN_OVERWRITEPROMPT,
    LPCTSTR lpszFilter = NULL,
    CWnd* pParentWnd = NULL,
    DWORD dwSize = 0,
    BOOL bVistaStyle = TRUE);
```

### <a name="parameters"></a>參數

*bOpenFileDialog*<br/>
在參數, 指定要建立哪種類型的對話方塊。 將它設定為 TRUE, 以建立 [**開啟**檔案] 對話方塊。 將它設定為 FALSE, 以建立 [檔案**另存**新檔] 對話方塊。

*lpszDefExt*<br/>
在預設的副檔名。 如果使用者在 [檔案名] 方塊中未包含已知的擴充功能 (與使用者電腦具有關聯性的延伸模組), 則*lpszDefExt*所指定的副檔名會自動附加至檔案名。 如果此參數為 Null, 則不會附加任何延伸模組。

*lpszFileName*<br/>
在出現在 [檔案名] 方塊中的初始檔案名。 如果是 Null, 則不會顯示初始檔案名。

*dwFlags*<br/>
在一或多個旗標的組合, 可讓您用來自訂對話方塊。 如需這些旗標的說明, 請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。 如果您修改`m_ofn.Flags`結構成員, 請在您的變更中使用位 or 運算子, 讓預設行為保持不變。

*lpszFilter*<br/>
在一系列字串組, 指定您可以套用至檔案的篩選準則。 如果您指定檔案篩選, 檔案清單中只會顯示符合篩選準則的檔案。 如需如何使用檔案篩選器的詳細資訊, 請參閱備註一節。

*pParentWnd*<br/>
在[檔案] 對話方塊的父代或擁有者視窗的指標。

*dwSize*<br/>
在`OPENFILENAME`結構的大小。 此值取決於作業系統版本。 MFC 使用此參數來決定要建立的適當類型對話方塊。 預設的大小為 0, 表示 MFC 程式碼會根據程式執行所在的作業系統版本, 決定要使用的正確對話方塊大小。

*bVistaStyle*<br/>
在**注意**此參數可在 Visual Studio 2008 和更新版本中使用, 而且只有在 Windows Vista 或更新版本中執行時, 才會使用新樣式的對話方塊。

指定檔案對話方塊樣式的參數。 將它設定為 TRUE, 以使用新的 Vista 樣式檔案對話方塊。 否則, 將會使用舊樣式的對話方塊。 如需在 Vista 底下執行的詳細資訊, 請參閱備註一節。

### <a name="remarks"></a>備註

視*bOpenFileDialog*的值而定, 會建立 [檔案**開啟**] 或 [檔案**另存**新檔] 對話方塊。

使用*lpszDefExt*指定預設延伸模組可能不會產生您所預期的行為, 因為它不太容易預測哪些擴充功能在使用者的電腦上有檔案關聯。 如果您需要更充分掌控預設延伸模組的附加, 您可以從`CFileDialog`衍生您自己的類別, 並覆`CFileDialog::OnFileNameOK`寫方法來執行您自己的擴充功能處理。

若要讓使用者選取多個檔案, 請在呼叫[DoModal](#domodal)之前設定 OFN_ALLOWMULTISELECT 旗標。 您必須提供自己的檔案名緩衝區來儲存多個檔案名的傳回清單。 若要這麼做`m_ofn.lpstrFile` , 請將取代為您已配置之緩衝區的指標 (在您建立[CFileDialog](../../mfc/reference/cfiledialog-class.md)之後, 但`DoModal`在呼叫之前)。 此外, 您必須使用`m_ofn.nMaxFile`所指向之緩衝區中的字元數`m_ofn.lpstrFile`來設定。 如果您將選取的檔案數目上限設定為*n*, 則必要的緩衝區大小為`n`* (_MAX_PATH + 1) + 1。 例如：

[!code-cpp[NVC_MFCFiles#23](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_1.cpp)]

若要讓使用者可以使用滑鼠或鍵盤來調整 [Explorer 樣式] 對話方塊的大小, 請設定 OFN_ENABLESIZING 旗標。 只有當您提供攔截程式或自訂範本時, 才需要設定此旗標。 旗標僅適用于 Explorer 樣式的對話方塊;舊樣式的對話方塊無法調整大小。

*LpszFilter*參數是用來判斷檔案必須要顯示在檔案清單中的檔案名類型。 字串配對中的第一個字串描述篩選準則;第二個字串表示要使用的檔案名副檔名。 您可以使用分號 ('; ' 字元) 做為分隔符號來指定多個擴充功能。 字串以兩個 '&#124;' 字元結尾, 後面接著 Null 字元。 您也可以針對此參數使用[CString](../../atl-mfc-shared/using-cstring.md)物件。

例如, Microsoft Excel 可讓使用者開啟副檔名為 xlc (chart) 或 .xls (工作表) 的檔案。 Excel 的篩選準則可以撰寫為:

[!code-cpp[NVC_MFCFiles#24](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_2.cpp)]

不過, 如果您打算使用此字串直接更新`OPENFILENAME`結構, 則應使用 null 字元 ' \ 0 ' (而不是分隔號 ('&#124;')) 來分隔字串。

只有在 Windows Vista 或更新版本底下執行時, *bVistaStyle*參數才適用。 在舊版的 Windows 下, 會忽略這個參數。 如果*bVistaStyle*設定為 TRUE, 則當您編譯具有 Visual Studio 2008 或更新版本的程式時, 將會使用 [新的 Vista 樣式檔案 **] 對話方塊**。 否則, 將會使用先前的 [MFC 樣式檔案 **] 對話方塊**。

對話方塊範本在以*bVistaStyle*為基礎的對話上不受支援

### <a name="example"></a>範例

  請參閱[CFileDialog::D omodal](#domodal)的範例。

##  <a name="domodal"></a>CFileDialog::D oModal

呼叫此函式以顯示 [Windows 通用檔案] 對話方塊, 並允許使用者流覽檔案和目錄, 然後輸入檔案名。

```
virtual INT_PTR DoModal();
```

### <a name="return-value"></a>傳回值

IDOK 或 IDCANCEL。 如果傳回 IDCANCEL, 請呼叫 Windows [CommDlgExtendedError](/windows/desktop/api/commdlg/nf-commdlg-commdlgextendederror)函數來判斷是否發生錯誤。

IDOK 和 IDCANCEL 是常數, 指出使用者是否選取 [確定] 或 [取消] 按鈕。

### <a name="remarks"></a>備註

如果您想要藉由設定`m_ofn`結構的成員來初始化各種 [檔案] 對話方塊選項, 您應該在呼叫`DoModal`之前執行此動作, 但在構造對話方塊物件之後。

例如, 如果您想要允許使用者選取多個檔案, 請在呼叫`DoModal`之前設定 OFN_ALLOWMULTISELECT 旗標, 如本主題中的程式碼範例所示。

當使用者按一下對話方塊的 [確定] 或 [取消] 按鈕, 或從對話方塊的 [控制項] 功能表中選取 [關閉] 選項時, 控制項就會傳回給您的應用程式。 接著, 您可以呼叫其他成員函式, 以抓取使用者在對話方塊中輸入的設定或資訊。

`DoModal`是從類別`CDialog`覆寫的虛擬函式。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCFiles#25](../../atl-mfc-shared/reference/codesnippet/cpp/cfiledialog-class_3.cpp)]

##  <a name="enableopendropdown"></a>CFileDialog:: EnableOpenDropDown

啟用對話方塊中 [開啟] 或 [儲存] 按鈕上的下拉式清單。

```
HRESULT EnableOpenDropDown(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
下拉式清單的識別碼。

### <a name="remarks"></a>備註

##  <a name="endvisualgroup"></a>CFileDialog:: EndVisualGroup

停止將專案新增至對話方塊中的視覺效果群組。

```
HRESULT EndVisualGroup();
```

### <a name="return-value"></a>傳回值

如果成功, 則傳回 S_OK;否則為錯誤值。

### <a name="remarks"></a>備註

##  <a name="getcheckbuttonstate"></a>CFileDialog:: GetCheckButtonState

抓取對話方塊中複選按鈕 (核取方塊) 的目前狀態。

```
HRESULT GetCheckButtonState(
    DWORD dwIDCtl,
    BOOL& bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
核取方塊的狀態。 TRUE 表示已核取;FALSE 表示未核取。

### <a name="remarks"></a>備註

##  <a name="getcontrolitemstate"></a>CFileDialog:: GetControlItemState

在對話方塊中找到的容器控制項內, 抓取專案的目前狀態。

```
HRESULT GetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
專案的識別碼。

*dwState*<br/>
變數的參考, 會從指出控制項目前狀態的 CDCONTROLSTATE 列舉中, 接收一個以上的值。

### <a name="remarks"></a>備註

##  <a name="getcontrolstate"></a>CFileDialog:: GetControlState

抓取指定控制項的目前可見度和已啟用狀態。

```
HRESULT GetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF& dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的識別碼。

*dwState*<br/>
變數的參考, 從指出控制項目前狀態的 CDCONTROLSTATE 列舉中接收一或多個值。

### <a name="remarks"></a>備註

##  <a name="geteditboxtext"></a>CFileDialog:: GetEditBoxText

抓取編輯方塊控制項中的目前文字。

```
HRESULT GetEditBoxText(
    DWORD dwIDCtl,
    CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
編輯方塊的識別碼。

*strText*<br/>
文字值。

### <a name="remarks"></a>備註

##  <a name="getfileext"></a>CFileDialog:: GetFileExt

呼叫此函式可抓取在對話方塊中輸入之檔案名的副檔名。

```
CString GetFileExt() const;
```

### <a name="return-value"></a>傳回值

檔案名的副檔名。

### <a name="remarks"></a>備註

例如, 如果輸入的檔案名是 DATA。Txt, `GetFileExt`傳回 "TXT"。

如果`m_ofn.Flags`已設定 OFN_ALLOWMULTISELECT 旗標, 此字串會包含一連串以 null 結束的字串, 其中第一個字串為所選取檔案群組的目錄路徑, 後面接著使用者選取的所有檔案的名稱。 若要取出檔案路徑路徑, 請使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式。

##  <a name="getfilename"></a>CFileDialog:: GetFileName

呼叫此函式可抓取在對話方塊中輸入的檔案名。

```
CString GetFileName() const;
```

### <a name="return-value"></a>傳回值

檔案的檔名。

### <a name="remarks"></a>備註

檔案的名稱同時包含前置詞和副檔名。 例如, `GetFileName`會傳回「文字」。「DAT」 (適用于 file C:\FILES\TEXT.DAT.)

如果`m_ofn.Flags`已設定旗標，您應該呼叫 [GetStartPosition](#getstartposition) 和 [GetNextPathName](#getnextpathname) 來取出檔案路徑名稱。`OFN_ALLOWMULTISELECT`

##  <a name="getfiletitle"></a>CFileDialog:: GetFileTitle

呼叫此函式可抓取對話方塊中所輸入之檔案的標題。

```
CString GetFileTitle() const;
```

### <a name="return-value"></a>傳回值

檔案的標題。

### <a name="remarks"></a>備註

檔案的標題只包含其前置詞, 不含路徑或副檔名。 例如, `GetFileTitle`將會傳回檔案 C:\FILES\TEXT.DAT. 的 "TEXT"

如果`m_ofn.Flags`已設定 OFN_ALLOWMULTISELECT 旗標, 此字串會包含一連串以 null 結束的字串, 其中第一個字串為所選取檔案群組的目錄路徑, 後面接著使用者選取的所有檔案的名稱。 基於這個理由, 請使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式來取出清單中的下一個檔案名。

### <a name="example"></a>範例

  請參閱[CFileDialog::D omodal](#domodal)的範例。

##  <a name="getfolderpath"></a>CFileDialog:: GetFolderPath

呼叫這個成員函式可抓取目前開啟的資料夾或目錄的路徑, 以取得 Explorer 樣式的開啟或另存為通用對話方塊。

```
CString GetFolderPath() const;
```

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件, 其中包含目前開啟的資料夾或目錄。

### <a name="remarks"></a>備註

必須使用 OFN_EXPLORER 樣式建立對話方塊;否則, 此方法將會失敗並產生判斷提示。

只有在顯示對話方塊時, 才可以呼叫此方法。 在關閉對話方塊之後, 此函式將不再有效, 而且方法將會失敗並產生判斷提示。

##  <a name="getifiledialogcustomize"></a>CFileDialog:: GetIFileDialogCustomize

針對給定的[CFileDialog](../../mfc/reference/cfiledialog-class.md), 抓取內部 COM 物件的指標。

```
IFileDialogCustomize* GetIFileDialogCustomize();
```

### <a name="return-value"></a>傳回值

之內部 COM 物件`CFileDialog`的指標。 您必須負責適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 或更新版本中使用此函式, 並將*bVistaStyle*設定為 TRUE 的物件。 如果您在*bVistaStyle*為 FALSE 時使用此函式, 它會在發行模式中傳回 Null, 並在 debug 模式中擲回判斷提示。

如需`IFileDialogCustomize`介面的詳細資訊, 請參閱[IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

### <a name="example"></a>範例

這個範例會抓取內部 COM 物件。 若要執行這個程式碼範例, 您必須在 Windows Vista 或更新版本中進行編譯。

[!code-cpp[NVC_MFC_CFileDialog#4](../../mfc/reference/codesnippet/cpp/cfiledialog-class_4.cpp)]

##  <a name="getifileopendialog"></a>CFileDialog:: GetIFileOpenDialog

針對指定`CFileDialog`的, 抓取內部 COM 物件的指標。

```
IFileOpenDialog* GetIFileOpenDialog();
```

### <a name="return-value"></a>傳回值

之內部 COM 物件`CFileDialog`的指標。 您必須負責適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 或更新版本中使用此函式, 並將*bVistaStyle*設定為 TRUE 的物件。 如果不是`CFileDialog` **開啟**的對話方塊, 或*bVistaStyle*設定為 FALSE, 則此函式會傳回 Null。 在這最後一個案例中, 函式只會在發行模式中傳回 Null-在 debug 模式中, 它會擲回判斷提示。

如需`IFileOpenDialog`介面的詳細資訊, 請參閱[IFileOpenDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifileopendialog)。

### <a name="example"></a>範例

這個範例會抓取內部 COM 物件。 若要執行此程式碼, 您必須在 Windows Vista 或更新版本中進行編譯。

[!code-cpp[NVC_MFC_CFileDialog#2](../../mfc/reference/codesnippet/cpp/cfiledialog-class_5.cpp)]

##  <a name="getifilesavedialog"></a>CFileDialog:: GetIFileSaveDialog

針對指定`CFileDialog`的, 抓取內部 COM 物件的指標。

```
IFileSaveDialog* GetIFileSaveDialog();
```

### <a name="return-value"></a>傳回值

之內部 COM 物件`CFileDialog`的指標。 您必須負責適當地釋放此指標。

### <a name="remarks"></a>備註

僅在 Windows Vista 或更新版本中使用此函式, 並將*bVistaStyle*設定為 TRUE 的物件。 如果不是 [ `CFileDialog` **儲存**] 對話方塊, 或*bVistaStyle*設定為 FALSE, 則此函式會傳回 Null。 在這最後一個案例中, 函式只會在發行模式中傳回 Null-在 debug 模式中, 它會擲回判斷提示。

如需`IFileSaveDialog`介面的詳細資訊, 請參閱[IFileSaveDialog](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifilesavedialog)。

### <a name="example"></a>範例

這個範例會抓取內部 COM 物件。 若要執行這個程式碼範例, 您必須在 Windows Vista 或更新版本中進行編譯。

[!code-cpp[NVC_MFC_CFileDialog#3](../../mfc/reference/codesnippet/cpp/cfiledialog-class_6.cpp)]

##  <a name="getnextpathname"></a>CFileDialog:: GetNextPathName

呼叫此函式, 以從對話方塊中選取的群組抓取下一個檔案名。

```
CString GetNextPathName(POSITION& pos) const;
```

### <a name="parameters"></a>參數

*採購*<br/>
先前`GetNextPathName` 或`GetStartPosition`函式呼叫所傳回之位置值的參考。 如果已到達清單的結尾, 則為 Null。

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔案名的路徑包含檔案的標題加上整個目錄路徑。 例如, `GetNextPathName`會傳回 "C:\FILES\TEXT。「DAT」 (適用于 file C:\FILES\TEXT.DAT.) 如果您使用`GetNextPathName`的呼叫來`GetStartPosition`建立初始位置, 則可以在正向反復專案迴圈中使用。

如果選取專案只包含一個檔案, 就會傳回該檔案名。

##  <a name="getofn"></a>CFileDialog:: GetOFN

捕獲關聯`OPENFILENAME`的結構。

```
const OPENFILENAME& GetOFN() const;

OPENFILENAME& GetOFN();
```

### <a name="return-value"></a>傳回值

[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

### <a name="remarks"></a>備註

使用此函式的第二個版本, 在結構化之後但在`DoModal`顯示成員函式之前, 初始化檔案**開啟**或檔案**另存**新檔對話方塊的外觀。 例如, 您可以將的`lpstrTitle` `m_ofn`成員設定為您要對話方塊擁有的標題。

##  <a name="getpathname"></a>CFileDialog:: GetPathName

呼叫此函式可取得在對話方塊中輸入之檔案的完整路徑。

```
CString GetPathName() const;
```

### <a name="return-value"></a>傳回值

檔案的完整路徑。

### <a name="remarks"></a>備註

檔案名的路徑包含檔案的標題加上整個目錄路徑。 例如, `GetPathName`會傳回 "C:\FILES\TEXT。「DAT」 (適用于 file C:\FILES\TEXT.DAT.)

如果`m_ofn.Flags`已設定 OFN_ALLOWMULTISELECT 旗標, 則此字串包含一連串的 teminated 字串, 其中第一個字串為所選取檔案群組的目錄路徑, 後面接著使用者選取的所有檔案的名稱。 基於這個理由, 請使用[GetStartPosition](#getstartposition)和[GetNextPathName](#getnextpathname)成員函式來取出清單中的下一個檔案名。

### <a name="example"></a>範例

  請參閱[CFileDialog::D omodal](#domodal)的範例。

##  <a name="getreadonlypref"></a>CFileDialog:: GetReadOnlyPref

呼叫此函式可判斷 [Windows 標準檔案] [開啟] 和 [檔案另存新檔] 對話方塊中是否已選取 [唯讀] 核取方塊。

```
BOOL GetReadOnlyPref() const;
```

### <a name="return-value"></a>傳回值

如果已選取對話方塊中的 [唯讀] 核取方塊, 則為非零;否則為0。

### <a name="remarks"></a>備註

您可以藉由在函式中`CFileDialog`設定 OFN_HIDEREADONLY 樣式, 隱藏 [唯讀] 核取方塊。

> [!NOTE]
> Windows Vista 或更新版本`CFileDialog`的樣式物件不支援此功能。 嘗試在 Windows Vista 或更新版本的樣式`CFileDialog`上使用此函數將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。

##  <a name="getresult"></a>CFileDialog:: GetResult

抓取使用者在對話方塊中所做的選擇。

```
IShellItem* GetResult() throw();
```

### <a name="return-value"></a>傳回值

代表使用者選擇之 IShellItem 的指標。

### <a name="remarks"></a>備註

##  <a name="getresults"></a>CFileDialog:: GetResults

在允許多重選取的對話方塊中, 抓取使用者的選擇。

```
IShellItemArray* GetResults() throw();
```

### <a name="return-value"></a>傳回值

可存取在對話方塊中選取的專案之 IShellItemArray 的指標。

### <a name="remarks"></a>備註

##  <a name="getselectedcontrolitem"></a>CFileDialog:: GetSelectedControlItem

從對話方塊中指定的容器控制項, 抓取特定專案。

```
HRESULT GetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD& dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
使用者在控制項中選取之專案的識別碼。

### <a name="remarks"></a>備註

##  <a name="getstartposition"></a>CFileDialog:: GetStartPosition

如果`m_ofn.Flags`已設定 OFN_ALLOWMULTISELECT 旗標, 請呼叫此成員函式來抓取清單中第一個檔案路徑名稱的位置。

```
POSITION GetStartPosition() const;
```

### <a name="return-value"></a>傳回值

可以用於反復專案的位置值;如果清單是空的, 則為 Null。

##  <a name="hidecontrol"></a>CFileDialog:: HideControl

呼叫這個成員函式可在 Explorer 樣式的 [開啟] 或 [另存為通用] 對話方塊中隱藏指定的控制項。

```
void HideControl(int nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
要隱藏之控制項的識別碼。

### <a name="remarks"></a>備註

必須使用 OFN_EXPLORER 樣式建立對話方塊;否則, 此函式會失敗並產生判斷提示。

##  <a name="ispickfoldersmode"></a>CFileDialog:: IsPickFoldersMode

判斷目前的對話是否處於資料夾選擇器模式。

```
BOOL IsPickFoldersMode() const;
```

### <a name="return-value"></a>傳回值

如果對話方塊在資料夾選擇器模式中, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="m_ofn"></a>CFileDialog:: m_ofn

`m_ofn`是類型`OPENFILENAME`的結構。 此結構中的資料代表的目前狀態`CFileDialog`。

### <a name="remarks"></a>備註

在您加以建立之後, 但在使用[DoModal](#domodal)方法顯示之前, 請使用這個結構來初始化 [檔案**開啟**] 或 [檔案**另存**新檔] 對話方塊的外觀。 例如, 您可以將的*lpstrTitle*成員`m_ofn`設定為您要對話方塊擁有的標題。

使用 Windows Vista 或更新版本的[CFileDialog](../../mfc/reference/cfiledialog-class.md)樣式時`m_ofn` , 不保證一定會符合對話方塊的狀態。 它會與舊版 Windows 中的對話方塊進行同步處理。 `CFileDialog`如需`m_ofn`有關在 Windows Vista 或更新版本下同步處理結構和狀態的詳細資訊, 請參閱[CFileDialog:: ApplyOFNToShellDialog](#applyofntoshelldialog)和[CFileDialog:: UpdateOFNFromShellDialog](#updateofnfromshelldialog) 。

Windows Vista 或更新版本的樣式檔案對話方塊不支援的`CFileDialog`某些成員和旗標。 因此, 這些不會有任何作用。

以下是 Windows Vista 或更新版本不支援的成員清單:

- `lpstrCustomFilter`

- `lpstrInitialDir`

- `lCustData`

- `lpfnHook`

- `lpTemplateName`

下列旗標不受支援, 因此當您使用 Windows Vista 或更新版本的`CFileDialog`樣式時, 不會有任何作用:

- OFN_ENABLEHOOK

- OFN_ENABLEINCLUDENOTIFY

- OFN_ENABLETEMPLATE

- OFN_ENABLETEMPLATEHANDLE

- OFN_EXPLORER

- OFN_EXTENSIONDIFFERENT

- OFN_HIDEREADONLY

- Windows Vista 或更新版本中的 OFN_LONGNAMES-有效 always on

- Windows Vista 或更新版本中的 OFN_NOLONGNAMES-有效率

- Windows Vista 或更新版本中的 OFN_NONETWORKBUTTON-有效 always on

- OFN_READONLY

- OFN_SHOWHELP

如需此結構的詳細資訊, 請參閱 Windows SDK 中的[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構。

##  <a name="makeprominent"></a>CFileDialog:: MakeProminent

將控制項放在對話方塊中, 以便與其他控制項相對應。

```
HRESULT MakeProminent(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的識別碼。

### <a name="remarks"></a>備註

##  <a name="onbuttonclicked"></a>  CFileDialog::OnButtonClicked

按一下按鈕時呼叫。

```
virtual void OnButtonClicked(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
按鈕的識別碼。

### <a name="remarks"></a>備註

##  <a name="oncheckbuttontoggled"></a>CFileDialog:: OnCheckButtonToggled

核取方塊已核取或取消選取時呼叫。

```
virtual void OnCheckButtonToggled(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
Checked 或 unchecked。

### <a name="remarks"></a>備註

##  <a name="oncontrolactivating"></a>CFileDialog:: OnControlActivating

當控制項啟動時呼叫。

```
virtual void OnControlActivating(DWORD dwIDCtl);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的識別碼。

### <a name="remarks"></a>備註

##  <a name="onfilenamechange"></a>CFileDialog:: OnFileNameChange

如果您想要處理 WM_NOTIFY CDN_SELCHANGE 訊息, 請覆寫這個方法。

```
virtual void OnFileNameChange();
```

### <a name="remarks"></a>備註

當使用者在 [**開啟**] 或 [**另存**新檔] 對話方塊的 [檔案] 清單中選取新的檔案或資料夾時, 系統會傳送 CDN_SELCHANGE 訊息。 如果您想要執行任何動作來回應此訊息, 請覆寫這個方法。

只有在已開啟 [OFN_EXPLORER] 旗標的情況下建立對話方塊時, 系統才會傳送此訊息。 如需有關通知的詳細資訊, 請參閱[CDN_SELCHANGE](/windows/desktop/dlgbox/cdn-selchange)。 如需 OFN_EXPLORER 旗標的詳細資訊, 請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構和[開啟和另存](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)新檔對話方塊。

##  <a name="onfilenameok"></a>  CFileDialog::OnFileNameOK

只有當您想要提供自訂驗證以輸入 [一般檔案] 對話方塊中的檔案名時, 才覆寫此函數。

```
virtual BOOL OnFileNameOK();
```

### <a name="return-value"></a>傳回值

如果檔案名不是有效的檔案名, 則為 1;否則為0。

### <a name="remarks"></a>備註

此函式可讓您拒絕任何應用程式特定原因的檔案名。 一般來說, 您不需要使用此函式, 因為架構會提供檔案名的預設驗證, 如果輸入的檔案名無效, 則會顯示訊息方塊。

如果傳回 1, 則會持續顯示對話方塊, 讓使用者輸入另一個檔案名。 如果傳回的是 0, 則對話方塊程式會關閉對話方塊。 其他非零的傳回值目前已保留, 因此不應使用。

##  <a name="onfolderchange"></a>CFileDialog:: OnFolderChange

覆寫此函式以處理 WM_NOTIFYCDN_FOLDERCHANGE 訊息。

```
virtual void OnFolderChange();
```

### <a name="remarks"></a>備註

在 [開啟] 或 [另存新檔] 對話方塊中開啟新資料夾時, 就會傳送通知訊息。

只有在使用 OFN_EXPLORER 樣式建立對話方塊時, 才會傳送通知。 如需有關通知的詳細資訊, 請參閱[CDN_FOLDERCHANGE](/windows/desktop/dlgbox/cdn-folderchange)。 如需 OFN_EXPLORER 樣式的詳細資訊, 請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構和 [[開啟] 和 [另存新檔] 對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

##  <a name="oninitdone"></a>CFileDialog:: OnInitDone

覆寫此函式以處理 WM_NOTIFY CDN_INITDONE 訊息。

```
virtual void OnInitDone();
```

### <a name="remarks"></a>備註

系統會在系統完成 [**開啟**] 或 [**另存**新檔] 對話方塊中的控制項排列時傳送此通知訊息, 以騰出空間給子對話方塊的控制項。

只有在使用 OFN_EXPLORER 樣式建立對話方塊時, 系統才會傳送此程式。 如需有關通知的詳細資訊, 請參閱[CDN_INITDONE](/windows/desktop/dlgbox/cdn-initdone)。 如需 OFN_EXPLORER 樣式的詳細資訊, 請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構和 [[開啟] 和 [另存新檔] 對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

> [!NOTE]
> Windows Vista 或更新版本的樣式檔案對話方塊不支援此功能。 嘗試在 Windows Vista 或更新版本的樣式檔案對話方塊上使用此函式, 將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。

##  <a name="onitemselected"></a>  CFileDialog::OnItemSelected

在選取容器專案時呼叫。

```
virtual void OnItemSelected(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
專案的識別碼。

### <a name="remarks"></a>備註

##  <a name="onlbselchangednotify"></a>CFileDialog:: OnLBSelChangedNotify

每當清單方塊中目前的選取範圍即將變更時, 就會呼叫這個函式。

```
virtual void OnLBSelChangedNotify(
    UINT nIDBox,
    UINT iCurSel,
    UINT nCode);
```

### <a name="parameters"></a>參數

*nIDBox*<br/>
發生選取範圍之清單方塊或下拉式方塊的識別碼。

*iCurSel*<br/>
目前選取範圍的索引。

*nCode*<br/>
控制項通知代碼。 這個參數必須具有下列其中一個值:

- CD_LBSELCHANGE 指定*iCurSel*是單一挑選清單框中選取的專案。

- CD_LBSELSUB 指定不會再于 multiselection 清單方塊中選取*iCurSel* 。

- CD_LBSELADD 指定在 multiselection 清單方塊中選取*iCurSel* 。

- CD_LBSELNOITEMS 指定 multiselection 清單方塊中沒有任何選取專案。

### <a name="remarks"></a>備註

覆寫此函式, 以在清單方塊中提供選取範圍變更的自訂處理。 例如, 您可以使用此函式來顯示使用者選取之每個檔案的存取權限或上次修改日期。

##  <a name="onshareviolation"></a>CFileDialog:: OnShareViolation

覆寫此函數以提供共用違規的自訂處理。

```
virtual UINT OnShareViolation(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>參數

*lpszPathName*<br/>
發生共用違規之檔案的路徑。

### <a name="return-value"></a>傳回值

下列其中一個值：

- OFN_SHAREFALLTHROUGH 會從對話方塊傳回檔案名。

- OFN_SHARENOWARN 不需要採取進一步的動作。

- OFN_SHAREWARN 使用者會收到此錯誤的標準警告訊息。

### <a name="remarks"></a>備註

一般來說, 您不需要使用此函式, 因為架構會提供共用違規的預設檢查, 並在發生共用違規時顯示訊息方塊。

如果您想要停用共用違規檢查, 請使用位 OR 運算子結合旗標 OFN_SHAREAWARE 與`m_ofn.Flags`。

##  <a name="ontypechange"></a>CFileDialog:: OnTypeChange

覆寫此函式以處理 WM_NOTIFYCDN_TYPECHANGE 訊息。

```
virtual void OnTypeChange();
```

### <a name="remarks"></a>備註

當使用者從 [開啟] 或 [另存新檔] 對話方塊的檔案類型清單中選取新的檔案類型時, 就會傳送通知訊息。

只有在使用 OFN_EXPLORER 樣式建立對話方塊時, 才會傳送通知。 如需有關通知的詳細資訊, 請參閱[CDN_TYPECHANGE](/windows/desktop/dlgbox/cdn-typechange)。 如需 OFN_EXPLORER 樣式的詳細資訊, 請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)結構和 [[開啟] 和 [另存新檔] 對話方塊](/windows/desktop/dlgbox/open-and-save-as-dialog-boxes)。

##  <a name="removecontrolitem"></a>  CFileDialog::RemoveControlItem

從對話方塊中的容器控制項移除專案。

```
HRESULT RemoveControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
要從中移除專案的容器控制項識別碼。

*dwIDItem*<br/>
專案的識別碼。

### <a name="remarks"></a>備註

##  <a name="setcheckbuttonstate"></a>  CFileDialog::SetCheckButtonState

設定對話方塊中複選按鈕 (核取方塊) 的目前狀態。

```
HRESULT SetCheckButtonState(
    DWORD dwIDCtl,
    BOOL bChecked);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
核取方塊的識別碼。

*bChecked*<br/>
核取方塊的狀態。 TRUE 表示已核取;FALSE 表示未核取。

### <a name="remarks"></a>備註

##  <a name="setcontrolitemstate"></a>CFileDialog:: SetControlItemState

設定在對話方塊中找到之容器控制項內專案的目前狀態。

```
HRESULT SetControlItemState(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
專案的識別碼。

*dwState*<br/>
CDCONTROLSTATE 列舉中的一或多個值, 表示控制項的新狀態。

### <a name="remarks"></a>備註

##  <a name="setcontrolitemtext"></a>  CFileDialog::SetControlItemText

設定控制項專案的文字。 例如, 出現在功能表中的選項按鈕或專案的文字。

```
HRESULT SetControlItemText(
    DWORD dwIDCtl,
    DWORD dwIDItem,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
專案的識別碼。

*strLabel*<br/>
專案的文字。

### <a name="remarks"></a>備註

##  <a name="setcontrollabel"></a>CFileDialog:: SetControlLabel

設定與控制項相關聯的文字, 例如按鈕文字或編輯方塊標籤。

```
HRESULT SetControlLabel(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的識別碼。

*strLabel*<br/>
控制項名稱。

### <a name="remarks"></a>備註

##  <a name="setcontrolstate"></a>CFileDialog:: SetControlState

設定指定控制項的目前可見度和已啟用狀態。

```
HRESULT SetControlState(
    DWORD dwIDCtl,
    CDCONTROLSTATEF dwState);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
控制項的識別碼。

*dwState*<br/>
來自 CDCONTROLSTATE 列舉的一個或多個值, 指出控制項的目前狀態。

### <a name="remarks"></a>備註

##  <a name="setcontroltext"></a>CFileDialog:: SetControlText

呼叫這個方法, 即可在 [Explorer 樣式的**開啟**] 或 [**另存**新檔] 對話方塊中, 設定指定之控制項的文字。

```
void SetControlText(
    int nID,
    LPCSTR lpsz);

void SetControlText(
    int nID,
    const wchar_t *lpsz);
```

### <a name="parameters"></a>參數

*nID*<br/>
在要設定文字之控制項的識別碼。

*lpsz*<br/>
在字串的指標, 其中包含要為控制項設定的文字。

### <a name="remarks"></a>備註

此函式的兩個版本對於使用 Unicode 的應用程式而言是有效的。 不過, 只有具有 LPCSTR 類型的版本對使用 ANSI 的應用程式有效。

若要使用這個方法, 您必須使用 OFN_EXPLORER 樣式來建立對話方塊。 否則, 此函式會失敗並產生判斷提示。

##  <a name="setdefext"></a>CFileDialog:: SetDefExt

呼叫此函式可設定 Explorer 樣式開啟或 [另存為通用] 對話方塊的預設副檔名。

```
void SetDefExt(LPCSTR lpsz);
```

### <a name="parameters"></a>參數

*lpsz*<br/>
字串的指標, 其中包含要用於對話方塊物件的預設延伸模組。 這個字串不能包含句號 (.)。

### <a name="remarks"></a>備註

必須使用 OFN_EXPLORER 樣式建立對話方塊;否則, 此函式會失敗並產生判斷提示。

##  <a name="seteditboxtext"></a>CFileDialog:: SetEditBoxText

設定編輯方塊控制項中的目前文字。

```
HRESULT SetEditBoxText(
    DWORD dwIDCtl,
    const CString& strText);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
編輯方塊的識別碼。

*strText*<br/>
文字值。

### <a name="remarks"></a>備註

##  <a name="setproperties"></a>CFileDialog:: SetProperties

提供屬性儲存區，可定義要用於所儲存之項目的預設值。

```
BOOL SetProperties(LPCWSTR lpszPropList);
```

### <a name="parameters"></a>參數

*lpszPropList*<br/>
預先定義的屬性清單，以 ";" 分隔。 如需旗標的清單, 請參閱[OPENFILENAME](/windows/win32/api/commdlg/ns-commdlg-openfilenamew)的**旗標**一節。

### <a name="remarks"></a>備註

##  <a name="setselectedcontrolitem"></a>CFileDialog:: SetSelectedControlItem

設定選項按鈕群組中特定專案的選取狀態, 或在對話方塊中找到的下拉式方塊。

```
HRESULT SetSelectedControlItem(
    DWORD dwIDCtl,
    DWORD dwIDItem);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
容器控制項的識別碼。

*dwIDItem*<br/>
使用者在控制項中選取之專案的識別碼。

### <a name="remarks"></a>備註

##  <a name="settemplate"></a>CFileDialog:: SetTemplate

設定[CFileDialog](../../mfc/reference/cfiledialog-class.md)物件的對話方塊範本。

```
void SetTemplate(
    UINT nWin3ID,
    UINT nWin4ID);

void SetTemplate(
    LPCTSTR lpWin3ID,
    LPCTSTR lpWin4ID);
```

### <a name="parameters"></a>參數

*nWin3ID*<br/>
在包含非 Explorer `CFileDialog`物件之範本資源的 ID 編號。 此範本僅適用于 Windows NT 3.51, 或不存在 OFN_EXPLORER 樣式時。

*nWin4ID*<br/>
在包含 Explorer `CFileDialog`物件之範本資源的 ID 編號。 此範本僅適用于 Windows NT 4.0 和更新版本、Windows 95 和更新版本, 或存在 OFN_EXPLORER 樣式時。

*lpWin3ID*<br/>
在包含非 Explorer `CFileDialog`物件的範本資源名稱。 此範本僅適用于 Windows NT 3.51, 或不存在 OFN_EXPLORER 樣式時。

*lpWin4ID*<br/>
在包含 Explorer `CFileDialog`物件的範本資源名稱。 此範本僅適用于 Windows NT 4.0 和更新版本、Windows 95 和更新版本, 或存在 OFN_EXPLORER 樣式時。

### <a name="remarks"></a>備註

系統將只會使用其中一個指定的範本。 系統會根據 OFN_EXPLORER 樣式和應用程式執行所在的作業系統, 決定要使用哪一個範本。 藉由指定非 Explorer 和 Explorer 樣式的範本, 就可以輕鬆地支援 Windows NT 3.51、Windows NT 4.0 和更新版本, 以及 Windows 95 和更新版本。

> [!NOTE]
> Windows Vista 或更新版本的樣式檔案對話方塊不支援此功能。 嘗試在 Windows Vista 或更新版本的 [樣式檔案] 對話方塊中使用此功能, 將會擲回[CNotSupportedException](../../mfc/reference/cnotsupportedexception-class.md)。 另一種方式是使用自訂的對話方塊。 如需使用自訂`CFileDialog`的詳細資訊, 請參閱[IFileDialogCustomize](/windows/desktop/api/shobjidl_core/nn-shobjidl_core-ifiledialogcustomize)。

##  <a name="startvisualgroup"></a>CFileDialog:: StartVisualGroup

在對話方塊中宣告視覺效果群組。 後續呼叫任何 "add" 方法會將這些元素新增至此群組。

```
HRESULT StartVisualGroup(
    DWORD dwIDCtl,
    const CString& strLabel);
```

### <a name="parameters"></a>參數

*dwIDCtl*<br/>
視覺效果群組的識別碼。

*strLabel*<br/>
組名。

### <a name="remarks"></a>備註

##  <a name="updateofnfromshelldialog"></a>CFileDialog:: UpdateOFNFromShellDialog

根據內部`m_ofn`物件的目前狀態, 更新[CFileDialog](../../mfc/reference/cfiledialog-class.md)的資料結構。

```
void UpdateOFNFromShellDialog();
```

### <a name="remarks"></a>備註

在 Windows Vista 之前的 Windows 版本中, 成員[OPENFILENAME](/previous-versions/windows/embedded/ms911906\(v=msdn.10\))資料結構會持續與的狀態`CFileDialog`同步處理。 對[m_ofn](#m_ofn)成員變數所做的任何變更都會直接影響對話方塊的狀態。 此外, 對對話方塊狀態所做的任何變更都會立即更新 m_ofn 成員變數。

在 Windows Vista 或更新版本中`m_ofn` , 資料結構不會自動更新。 若要保證`m_ofn`成員變數中資料的精確度, 您應該在存取資料之前`UpdateOFNFromShellDialog`呼叫函數。 在處理[IFileDialog:: OnFileOK](/windows/desktop/api/shobjidl_core/nf-shobjidl_core-ifiledialogevents-onfileok)時, Windows 會自動呼叫此函式。

如需如何在 Windows Vista 或更新`CFileDialog`版本中使用類別的詳細資訊, 請參閱[CFileDialog 類別](../../mfc/reference/cfiledialog-class.md)。

### <a name="example"></a>範例

這個範例會先`CFileDialog`更新, 再顯示它。 在更新`m_ofn`成員變數之前, 我們需要將它同步處理到對話方塊的目前狀態。

[!code-cpp[NVC_MFC_CFileDialog#1](../../mfc/reference/codesnippet/cpp/cfiledialog-class_7.cpp)]

## <a name="see-also"></a>另請參閱

[CCommonDialog 類別](../../mfc/reference/ccommondialog-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)
