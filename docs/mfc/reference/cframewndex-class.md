---
title: CFrameWndEx 類別
ms.date: 11/04/2016
f1_keywords:
- CFrameWndEx
- AFXFRAMEWNDEX/CFrameWndEx
- AFXFRAMEWNDEX/CFrameWndEx::ActiveItemRecalcLayout
- AFXFRAMEWNDEX/CFrameWndEx::AddPane
- AFXFRAMEWNDEX/CFrameWndEx::AdjustDockingLayout
- AFXFRAMEWNDEX/CFrameWndEx::DelayUpdateFrameMenu
- AFXFRAMEWNDEX/CFrameWndEx::DockPane
- AFXFRAMEWNDEX/CFrameWndEx::DockPaneLeftOf
- AFXFRAMEWNDEX/CFrameWndEx::EnableAutoHidePanes
- AFXFRAMEWNDEX/CFrameWndEx::EnableDocking
- AFXFRAMEWNDEX/CFrameWndEx::EnableFullScreenMainMenu
- AFXFRAMEWNDEX/CFrameWndEx::EnableFullScreenMode
- AFXFRAMEWNDEX/CFrameWndEx::EnableLoadDockState
- AFXFRAMEWNDEX/CFrameWndEx::EnablePaneMenu
- AFXFRAMEWNDEX/CFrameWndEx::GetActivePopup
- AFXFRAMEWNDEX/CFrameWndEx::GetDefaultResId
- AFXFRAMEWNDEX/CFrameWndEx::GetDockingManager
- AFXFRAMEWNDEX/CFrameWndEx::GetMenuBar
- AFXFRAMEWNDEX/CFrameWndEx::GetPane
- AFXFRAMEWNDEX/CFrameWndEx::GetRibbonBar
- AFXFRAMEWNDEX/CFrameWndEx::GetTearOffBars
- AFXFRAMEWNDEX/CFrameWndEx::GetToolbarButtonToolTipText
- AFXFRAMEWNDEX/CFrameWndEx::InsertPane
- AFXFRAMEWNDEX/CFrameWndEx::IsFullScreen
- AFXFRAMEWNDEX/CFrameWndEx::IsMenuBarAvailable
- AFXFRAMEWNDEX/CFrameWndEx::IsPointNearDockSite
- AFXFRAMEWNDEX/CFrameWndEx::IsPrintPreview
- AFXFRAMEWNDEX/CFrameWndEx::LoadFrame
- AFXFRAMEWNDEX/CFrameWndEx::NegotiateBorderSpace
- AFXFRAMEWNDEX/CFrameWndEx::OnActivate
- AFXFRAMEWNDEX/CFrameWndEx::OnActivateApp
- AFXFRAMEWNDEX/CFrameWndEx::OnChangeVisualManager
- AFXFRAMEWNDEX/CFrameWndEx::OnClose
- AFXFRAMEWNDEX/CFrameWndEx::OnCloseDockingPane
- AFXFRAMEWNDEX/CFrameWndEx::OnCloseMiniFrame
- AFXFRAMEWNDEX/CFrameWndEx::OnClosePopupMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnCmdMsg
- AFXFRAMEWNDEX/CFrameWndEx::OnContextHelp
- AFXFRAMEWNDEX/CFrameWndEx::OnCreate
- AFXFRAMEWNDEX/CFrameWndEx::OnDestroy
- AFXFRAMEWNDEX/CFrameWndEx::OnDrawMenuImage
- AFXFRAMEWNDEX/CFrameWndEx::OnDrawMenuLogo
- AFXFRAMEWNDEX/CFrameWndEx::OnDWMCompositionChanged
- AFXFRAMEWNDEX/CFrameWndEx::OnExitSizeMove
- AFXFRAMEWNDEX/CFrameWndEx::OnGetMinMaxInfo
- AFXFRAMEWNDEX/CFrameWndEx::OnIdleUpdateCmdUI
- AFXFRAMEWNDEX/CFrameWndEx::OnLButtonDown
- AFXFRAMEWNDEX/CFrameWndEx::OnLButtonUp
- AFXFRAMEWNDEX/CFrameWndEx::OnMenuButtonToolHitTest
- AFXFRAMEWNDEX/CFrameWndEx::OnMenuChar
- AFXFRAMEWNDEX/CFrameWndEx::OnMouseMove
- AFXFRAMEWNDEX/CFrameWndEx::OnMoveMiniFrame
- AFXFRAMEWNDEX/CFrameWndEx::OnNcActivate
- AFXFRAMEWNDEX/CFrameWndEx::OnNcCalcSize
- AFXFRAMEWNDEX/CFrameWndEx::OnNcHitTest
- AFXFRAMEWNDEX/CFrameWndEx::OnNcMouseMove
- AFXFRAMEWNDEX/CFrameWndEx::OnNcPaint
- AFXFRAMEWNDEX/CFrameWndEx::OnPaneCheck
- AFXFRAMEWNDEX/CFrameWndEx::OnPostPreviewFrame
- AFXFRAMEWNDEX/CFrameWndEx::OnPowerBroadcast
- AFXFRAMEWNDEX/CFrameWndEx::OnSetMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnSetPreviewMode
- AFXFRAMEWNDEX/CFrameWndEx::OnSetText
- AFXFRAMEWNDEX/CFrameWndEx::OnShowCustomizePane
- AFXFRAMEWNDEX/CFrameWndEx::OnShowPanes
- AFXFRAMEWNDEX/CFrameWndEx::OnShowPopupMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnSize
- AFXFRAMEWNDEX/CFrameWndEx::OnSizing
- AFXFRAMEWNDEX/CFrameWndEx::OnSysColorChange
- AFXFRAMEWNDEX/CFrameWndEx::OnTearOffMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnToolbarContextMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnToolbarCreateNew
- AFXFRAMEWNDEX/CFrameWndEx::OnToolbarDelete
- AFXFRAMEWNDEX/CFrameWndEx::OnUpdateFrameMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnUpdateFrameTitle
- AFXFRAMEWNDEX/CFrameWndEx::OnUpdatePaneMenu
- AFXFRAMEWNDEX/CFrameWndEx::OnWindowPosChanged
- AFXFRAMEWNDEX/CFrameWndEx::PaneFromPoint
- AFXFRAMEWNDEX/CFrameWndEx::PreTranslateMessage
- AFXFRAMEWNDEX/CFrameWndEx::RecalcLayout
- AFXFRAMEWNDEX/CFrameWndEx::RemovePaneFromDockManager
- AFXFRAMEWNDEX/CFrameWndEx::SetDockState
- AFXFRAMEWNDEX/CFrameWndEx::SetPrintPreviewFrame
- AFXFRAMEWNDEX/CFrameWndEx::SetupToolbarMenu
- AFXFRAMEWNDEX/CFrameWndEx::ShowFullScreen
- AFXFRAMEWNDEX/CFrameWndEx::ShowPane
- AFXFRAMEWNDEX/CFrameWndEx::UpdateCaption
- AFXFRAMEWNDEX/CFrameWndEx::WinHelp
helpviewer_keywords:
- CFrameWndEx [MFC], ActiveItemRecalcLayout
- CFrameWndEx [MFC], AddPane
- CFrameWndEx [MFC], AdjustDockingLayout
- CFrameWndEx [MFC], DelayUpdateFrameMenu
- CFrameWndEx [MFC], DockPane
- CFrameWndEx [MFC], DockPaneLeftOf
- CFrameWndEx [MFC], EnableAutoHidePanes
- CFrameWndEx [MFC], EnableDocking
- CFrameWndEx [MFC], EnableFullScreenMainMenu
- CFrameWndEx [MFC], EnableFullScreenMode
- CFrameWndEx [MFC], EnableLoadDockState
- CFrameWndEx [MFC], EnablePaneMenu
- CFrameWndEx [MFC], GetActivePopup
- CFrameWndEx [MFC], GetDefaultResId
- CFrameWndEx [MFC], GetDockingManager
- CFrameWndEx [MFC], GetMenuBar
- CFrameWndEx [MFC], GetPane
- CFrameWndEx [MFC], GetRibbonBar
- CFrameWndEx [MFC], GetTearOffBars
- CFrameWndEx [MFC], GetToolbarButtonToolTipText
- CFrameWndEx [MFC], InsertPane
- CFrameWndEx [MFC], IsFullScreen
- CFrameWndEx [MFC], IsMenuBarAvailable
- CFrameWndEx [MFC], IsPointNearDockSite
- CFrameWndEx [MFC], IsPrintPreview
- CFrameWndEx [MFC], LoadFrame
- CFrameWndEx [MFC], NegotiateBorderSpace
- CFrameWndEx [MFC], OnActivate
- CFrameWndEx [MFC], OnActivateApp
- CFrameWndEx [MFC], OnChangeVisualManager
- CFrameWndEx [MFC], OnClose
- CFrameWndEx [MFC], OnCloseDockingPane
- CFrameWndEx [MFC], OnCloseMiniFrame
- CFrameWndEx [MFC], OnClosePopupMenu
- CFrameWndEx [MFC], OnCmdMsg
- CFrameWndEx [MFC], OnContextHelp
- CFrameWndEx [MFC], OnCreate
- CFrameWndEx [MFC], OnDestroy
- CFrameWndEx [MFC], OnDrawMenuImage
- CFrameWndEx [MFC], OnDrawMenuLogo
- CFrameWndEx [MFC], OnDWMCompositionChanged
- CFrameWndEx [MFC], OnExitSizeMove
- CFrameWndEx [MFC], OnGetMinMaxInfo
- CFrameWndEx [MFC], OnIdleUpdateCmdUI
- CFrameWndEx [MFC], OnLButtonDown
- CFrameWndEx [MFC], OnLButtonUp
- CFrameWndEx [MFC], OnMenuButtonToolHitTest
- CFrameWndEx [MFC], OnMenuChar
- CFrameWndEx [MFC], OnMouseMove
- CFrameWndEx [MFC], OnMoveMiniFrame
- CFrameWndEx [MFC], OnNcActivate
- CFrameWndEx [MFC], OnNcCalcSize
- CFrameWndEx [MFC], OnNcHitTest
- CFrameWndEx [MFC], OnNcMouseMove
- CFrameWndEx [MFC], OnNcPaint
- CFrameWndEx [MFC], OnPaneCheck
- CFrameWndEx [MFC], OnPostPreviewFrame
- CFrameWndEx [MFC], OnPowerBroadcast
- CFrameWndEx [MFC], OnSetMenu
- CFrameWndEx [MFC], OnSetPreviewMode
- CFrameWndEx [MFC], OnSetText
- CFrameWndEx [MFC], OnShowCustomizePane
- CFrameWndEx [MFC], OnShowPanes
- CFrameWndEx [MFC], OnShowPopupMenu
- CFrameWndEx [MFC], OnSize
- CFrameWndEx [MFC], OnSizing
- CFrameWndEx [MFC], OnSysColorChange
- CFrameWndEx [MFC], OnTearOffMenu
- CFrameWndEx [MFC], OnToolbarContextMenu
- CFrameWndEx [MFC], OnToolbarCreateNew
- CFrameWndEx [MFC], OnToolbarDelete
- CFrameWndEx [MFC], OnUpdateFrameMenu
- CFrameWndEx [MFC], OnUpdateFrameTitle
- CFrameWndEx [MFC], OnUpdatePaneMenu
- CFrameWndEx [MFC], OnWindowPosChanged
- CFrameWndEx [MFC], PaneFromPoint
- CFrameWndEx [MFC], PreTranslateMessage
- CFrameWndEx [MFC], RecalcLayout
- CFrameWndEx [MFC], RemovePaneFromDockManager
- CFrameWndEx [MFC], SetDockState
- CFrameWndEx [MFC], SetPrintPreviewFrame
- CFrameWndEx [MFC], SetupToolbarMenu
- CFrameWndEx [MFC], ShowFullScreen
- CFrameWndEx [MFC], ShowPane
- CFrameWndEx [MFC], UpdateCaption
- CFrameWndEx [MFC], WinHelp
ms.assetid: 5830aca8-4a21-4f31-91f1-dd5477ffcc8d
ms.openlocfilehash: 6073feb5cad5bda5e20f3ff5c16e1ed6d380bca7
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373767"
---
# <a name="cframewndex-class"></a>CFrameWndEx 類別

實作 Windows 單一文件介面 (SDI) 重疊或快顯框架視窗的功能，並提供管理視窗的成員。 它擴展了[CFrameWnd](../../mfc/reference/cframewnd-class.md)類。

## <a name="syntax"></a>語法

```
class CFrameWndEx : public CFrameWnd
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CFramewndEx::活動專案Recalc佈局](#activeitemrecalclayout)|調整 OLE 用戶端項的佈局和幀的工作區。|
|`CFrameWndEx::AddDockSite`|沒有使用這個方法。|
|[CFramewndEx::添加窗格](#addpane)|向停靠管理器註冊控制欄。|
|[CFramewndEx::調整擴展佈局](#adjustdockinglayout)|重新計算停靠到框架視窗的所有窗格的佈局。|
|[CFramewndEx::D更新框架功能表](#delayupdateframemenu)|設置幀功能表,然後在命令處理空閒時更新它。|
|[CFramewndEx::DockPane](#dockpane)|將指定的窗格停靠到框架視窗。|
|[CframewndEx::D奧克帕內左側](#dockpaneleftof)|將窗格停駐在另一個窗格的左邊。|
|[CFramewndEx:啟用自動隱藏窗格](#enableautohidepanes)|當窗格停靠在主框架視窗的指定邊時,啟用它們自動隱藏模式。|
|[CFramewndEx::啟用停靠](#enabledocking)|啟用屬於框架視窗的窗格的停靠。|
|[CFramewndEx:啟用全屏主功能表](#enablefullscreenmainmenu)|在全螢幕模式下顯示或隱藏主菜單。|
|[CFramewndEx::啟用全屏模式](#enablefullscreenmode)|啟用框架視窗的全屏模式。|
|[CFramewndEx::啟用LoadDockState](#enableloaddockstate)|啟用或禁用停靠狀態的載入。|
|[CFramewndEx::啟用PaneMenu](#enablepanemenu)|啟用或禁用窗格功能表的自動處理。|
|[CFramewndEx:取得活動彈出](#getactivepopup)|返回指向當前顯示的彈出式功能表的指標。|
|[CFramewndEx:取得預設ResId](#getdefaultresid)|返回框架載入框架視窗時指定的資源 ID。|
|[CFramewndEx::獲取對接管理器](#getdockingmanager)|檢索框架視窗的[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md)物件。|
|[CFramewndEx::獲取功能表欄](#getmenubar)|將指標傳回到附加在框架視窗的功能表列物件。|
|[CFramewndEx::獲取窗格](#getpane)|返回指向具有指定 ID 的窗格的指標。|
|[CFramewndEx::獲取功能列](#getribbonbar)|檢索框架的功能區條控制項。|
|[CFramewndEx::獲取關閉條形](#gettearoffbars)|傳回分割狀態的窗格物件清單。|
|[CFramewndEx::取得工具列按鈕工具提示文字](#gettoolbarbuttontooltiptext)|當應用程式顯示工具列按鈕的工具提示時,由框架調用。|
|[CFrameWndEx::InsertPane](#insertpane)|向停靠管理器註冊窗格。|
|[CFramewndEx::全屏](#isfullscreen)|確定框架視窗是否處於全屏模式。|
|[CFramewndEx::IsMenuBar可用](#ismenubaravailable)|確定指向功能表欄物件的指標是否有效。|
|[CFramewndEx::IsPointNearDockSite](#ispointneardocksite)|指示點是否位於對齊區域中。|
|[CFramewndEx::是列印預覽](#isprintpreview)|指示框架視窗是否處於列印預覽模式。|
|[CFramewndEx::載入幀](#loadframe)|在建構後調用此方法以創建幀視窗並載入其資源。|
|[CFramewndEx::談判邊界空間](#negotiateborderspace)|實現 OLE 客戶端邊界協商。|
|[CFramewndEx::打開啟動](#onactivate)|當使用者輸入切換到或遠離幀時,框架調用此方法。|
|[CFramewndEx:打開ActivateApp](#onactivateapp)|在選擇或取消選擇應用程式時由框架呼叫。|
|[CFramewndEx::打開視覺管理器](#onchangevisualmanager)|當對框架的更改需要更改視覺管理器時,由框架調用。|
|[CFramewndEx::關閉](#onclose)|框架調用此方法以關閉幀。|
|[CFramewndEx::關閉對接窗格](#onclosedockingpane)|當用戶按下停靠窗格上的 **「關閉**」按鈕時,由框架呼叫。|
|[CFramewndEx::在關閉迷你框架上](#oncloseminiframe)|當用戶按下浮動迷你框架視窗中的 **「關閉**」按鈕時,由框架呼叫。|
|[CFramewndEx::在關閉彈出功能表](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[CFramewndEx::OnCmdMsg](#oncmdmsg)|調度命令消息。|
|[CFramewndEx::在上下文説明](#oncontexthelp)|由框架調用以顯示上下文相關説明。|
|[CFramewndEx::打開創建](#oncreate)|創建框架後由框架調用。|
|[CFramewndEx::On銷毀](#ondestroy)|框架被銷毀時由框架調用。|
|[CFramewndEx::在DrawMenu圖像](#ondrawmenuimage)|當應用程式繪製與功能表項關聯的圖像時,由框架調用。|
|[CFramewndEx::在DrawMenuLogo](#ondrawmenulogo)|當`CMFCPopupMenu`物件處理[WM_PAINT](/windows/win32/gdi/wm-paint)消息時,由框架調用。|
|[CFramewndEx:onDWM 組合已更改](#ondwmcompositionchanged)|當桌面視窗管理員 (DWM) 組合已啟用或禁用時,由框架呼叫。|
|[CFramewndEx:打開退出大小移動](#onexitsizemove)|當框架停止移動或調整大小時,由框架調用。|
|[CFramewndEx::OnGetminMaxinfo](#ongetminmaxinfo)|當框架調整大小以設置視窗尺寸限制時,由框架調用。|
|[CFramewndEx::上線更新CmdUI](#onidleupdatecmdui)|當命令處理處於空閒狀態時,框架調用以更新幀顯示。|
|[CFramewndEx::打開按鈕](#onlbuttondown)|當使用者按下滑鼠左鍵時,框架將調用此方法。|
|[CFramewndEx::OnLButtonUp](#onlbuttonup)|當使用者釋放滑鼠左鍵時,框架將調用此方法。|
|[CFramewndEx::在MenuButton工具命中測試](#onmenubuttontoolhittest)|當`CMFCToolBarButton`物件處理WM_NCHITTEST消息時,由框架調用。|
|[CFramewndEx::在MenuChar](#onmenuchar)|當顯示功能表並且使用者按下與命令不對應的鍵時,由框架調用。|
|[CFramewndEx::滑鼠移動](#onmousemove)|當指標移動時,框架調用此方法。|
|[CFramewndEx::在移動迷你框架](#onmoveminiframe)|當窗格窗口移動時由框架調用。|
|[CFramewndEx::打開NcActivate](#onncactivate)|當必須重新繪製框架的非工作區以指示活動狀態的更改時,框架調用框架。|
|[CFramewndEx:在NcCalcsize上](#onnccalcsize)|當必須計算工作區的大小和位置時,由框架調用。|
|[CFramewndEx::OnNcHitTest](#onnchittest)|當指標移動或按下或釋放滑鼠按鈕時,框架調用。|
|[CFramewndEx::在NcMouseMove上](#onncmousemove)|當指標在非工作區中移動時,由框架調用。|
|[CFramewndEx:onNcPaint](#onncpaint)|當必須繪製非工作區時,框架調用。|
|[CFramewndEx::在窗格檢查](#onpanecheck)|由框架調用以控制窗格的可見性。|
|[CFramewndEx:在後預覽幀上](#onpostpreviewframe)|當使用者更改列印預覽模式時,由框架調用。|
|[CFramewndEx::在功率廣播](#onpowerbroadcast)|發生電源管理事件時由框架調用。|
|[CFramewndEx::打開選單](#onsetmenu)|由框架調用以替換框架視窗功能表。|
|[CFramewndEx::打開預覽模式](#onsetpreviewmode)|由框架調用,以設置框架的列印預覽模式。|
|[CFramewndEx::打開文字](#onsettext)|由框架調用以設置視窗的文字。|
|[CFramewndEx::在顯示自訂窗格](#onshowcustomizepane)|啟用快速自定義窗格時由框架呼叫。|
|[CFramewndEx::在顯示窗格](#onshowpanes)|由框架呼叫以顯示或隱藏窗格。|
|[CFramewndEx::在顯示彈出功能表](#onshowpopupmenu)|啟用彈出式功能表時由框架呼叫。|
|[CFramewndEx::打開尺寸](#onsize)|框架在幀大小更改後調用此方法。|
|[CFramewndEx::打開](#onsizing)|當用戶調整幀大小時,框架將調用此方法。|
|[CFramewndEx::SysColorChange](#onsyscolorchange)|當系統顏色發生變化時由框架調用。|
|[CFramewndEx::在TearoffMenu上](#ontearoffmenu)|啟用具有撕開條的功能表時,由框架調用。|
|[CFramewndEx::在工具列上下文菜單上](#ontoolbarcontextmenu)|由框架調用以生成工具列上下文菜單。|
|[CFramewndEx::在工具列創建新](#ontoolbarcreatenew)|框架呼叫此方法以創建新工具列。|
|[CFramewndEx::打開工具列刪除](#ontoolbardelete)|刪除工具列時由框架調用。|
|[CFramewndEx::更新框架功能表](#onupdateframemenu)|由框架調用以設置框架功能表。|
|[CFramewndEx::更新幀標題](#onupdateframetitle)|框架呼叫此方法以更新框架視窗的標題列。|
|[CFramewndEx::更新窗格功能表](#onupdatepanemenu)|由框架調用以更新窗格功能表。|
|[CFramewndEx::在視窗Pos上](#onwindowposchanged)|當幀大小、位置或 z 順序因調用視窗管理方法而發生更改時,由框架調用。|
|[CFramewndEx::P從點](#panefrompoint)|返回包含指定點的停靠窗格。|
|[CFramewndEx::P重新翻譯訊息](#pretranslatemessage)|在調度特定視窗消息之前處理它們。|
|[CFramewndEx:recalclayout](#recalclayout)|調整框架及其子窗口的佈局。|
|[CFramewndEx::從Dock管理器中刪除Pane](#removepanefromdockmanager)|取消註冊窗格並將其從停靠管理器的內部清單中刪除。|
|[CFramewndEx::SetDockstate](#setdockstate)|將停靠佈局還原到存儲在註冊表中的停靠狀態。|
|[CFramewndEx::設定列印預覽框架](#setprintpreviewframe)|設置列印預覽框架視窗。|
|[CFramewndEx::設定工具列選單](#setuptoolbarmenu)|將使用者定義的命令插入工具列功能表。|
|[CFramewndEx::顯示全屏](#showfullscreen)|在全屏和常規模式之間切換主框架。|
|[CFramewndEx::顯示窗格](#showpane)|顯示或隱藏指定的窗格。|
|[CFramewndEx::更新標題](#updatecaption)|由框架調用以更新視窗框架標題。|
|[CFramewndEx::贏説明](#winhelp)|調用`WinHelp`應用程式或上下文相關的説明。|

## <a name="example"></a>範例

下面的示例演示如何從`CFrameWndEx`類繼承類。 此範例展示子類別的方法, 以及如何重寫該方法`OnShowPopupMenu`。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#3](../../mfc/reference/codesnippet/cpp/cframewndex-class_1.h)]
[!code-cpp[NVC_MFC_WordPad#4](../../mfc/reference/codesnippet/cpp/cframewndex-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CFrameWndEx](../../mfc/reference/cframewndex-class.md)

## <a name="requirements"></a>需求

**標頭：** afxframewndex.h

## <a name="cframewndexactiveitemrecalclayout"></a><a name="activeitemrecalclayout"></a>CFramewndEx::活動專案Recalc佈局

調整 OLE 用戶端項的佈局和幀的工作區。

```
void ActiveItemRecalcLayout();
```

### <a name="remarks"></a>備註

## <a name="cframewndexaddpane"></a><a name="addpane"></a>CFramewndEx::添加窗格

向停靠管理器註冊控制欄。

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail=TRUE);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]要註冊的控制列列窗格。

*b泰爾*<br/>
[在]如果要將控制列列窗格添加到清單的末尾,則為 TRUE;如果要將控制件欄窗格添加到清單的末尾,則為 TRUE。否則。

### <a name="return-value"></a>傳回值

如果控制欄已成功註冊,則為 TRUE;否則。

## <a name="cframewndexadjustdockinglayout"></a><a name="adjustdockinglayout"></a>CFramewndEx::調整擴展佈局

重新計算停靠到框架視窗的所有窗格的佈局。

```
virtual void AdjustDockingLayout(HDWP hdwp=NULL);
```

### <a name="parameters"></a>參數

*hdwp*<br/>
包含多個視窗位置的結構的句柄。 .

### <a name="remarks"></a>備註

hdwp 結構由[BeginDeferWindowPos](/windows/win32/api/winuser/nf-winuser-begindeferwindowpos)方法初始化。

## <a name="cframewndexdelayupdateframemenu"></a><a name="delayupdateframemenu"></a>CFramewndEx::D更新框架功能表

設置幀功能表,然後在命令處理空閒時更新它。

```
virtual void DelayUpdateFrameMenu(HMENU hMenuAlt);
```

### <a name="parameters"></a>參數

*哈梅內阿爾特*<br/>
[在]處理備用功能表。

### <a name="remarks"></a>備註

## <a name="cframewndexdockpane"></a><a name="dockpane"></a>CFramewndEx::DockPane

將指定的窗格停靠到框架視窗。

```
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID=0,
    LPCRECT lpRect=NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要停靠的控制欄的指標。

*nDockBarID*<br/>
[在]要停靠到的幀視窗一側的 ID。

*lpRect*<br/>
[在]指向常量整流結構的指標,用於指定視窗的螢幕位置和大小。

### <a name="remarks"></a>備註

*nDockBarID*參數可以具有以下值之一:

- AFX_IDW_DOCKBAR_TOP

- AFX_IDW_DOCKBAR_BOTTOM

- AFX_IDW_DOCKBAR_LEFT

- AFX_IDW_DOCKBAR_RIGHT

## <a name="cframewndexdockpaneleftof"></a><a name="dockpaneleftof"></a>CframewndEx::D奧克帕內左側

將指定的窗格停靠到另一個窗格的左側。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要停靠的窗格物件的指標。

*左撇子*<br/>
[在]指向左側窗格的指標,用於停靠*pBar*指定的窗格。

### <a name="return-value"></a>傳回值

如果*pBar*已成功停靠,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

該方法採用*pBar*參數指定的工具列,並將其停靠在*pLeftOf*參數指定的工具列左側。

## <a name="cframewndexenableautohidepanes"></a><a name="enableautohidepanes"></a>CFramewndEx:啟用自動隱藏窗格

當窗格停靠在主框架視窗的指定一側時,該窗格啟用自動隱藏模式。

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDock 風格*<br/>
[在]指定要停靠窗格的主框架視窗的一側。

### <a name="return-value"></a>傳回值

如果條形窗格成功停靠到*dwDockStyle*指定的幀視窗側,則為 TRUE,否則。

### <a name="remarks"></a>備註

*dwDockStyle*可以具有以下值之一:

- CBRS_ALIGN_TOP:允許控制欄停靠到框架視窗的工作區的頂部。

- CBRS_ALIGN_BOTTOM:允許控制欄停靠到框架視窗的工作區的底部。

- CBRS_ALIGN_LEFT:允許控制欄停靠到框架視窗的工作區左側。

- CBRS_ALIGN_RIGHT:允許控制欄停靠到框架視窗的工作區的右側。

## <a name="cframewndexenabledocking"></a><a name="enabledocking"></a>CFramewndEx::啟用停靠

啟用框架視窗窗格的停靠。

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDock 風格*<br/>
[在]指定窗格列停靠的主框架視窗的一側。

### <a name="return-value"></a>傳回值

如果條形窗格可以成功停靠在指定端,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

*dwDockStyle*參數可以具有以下值之一:

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

## <a name="cframewndexenablefullscreenmainmenu"></a><a name="enablefullscreenmainmenu"></a>CFramewndEx:啟用全屏主功能表

在全螢幕模式下顯示或隱藏主菜單。

```
void EnableFullScreenMainMenu(BOOL bEnableMenu);
```

### <a name="parameters"></a>參數

*b啟用選單*<br/>
[在]TRUE 以全螢幕模式顯示主選單,否則為 FALSE。

## <a name="cframewndexenablefullscreenmode"></a><a name="enablefullscreenmode"></a>CFramewndEx::啟用全屏模式

啟用框架視窗的全屏模式。

```
void EnableFullScreenMode(UINT uiFullScreenCmd);
```

### <a name="parameters"></a>參數

*ui 全螢幕Cmd*<br/>
[在]啟用和禁用全螢幕模式的命令的 ID。

### <a name="remarks"></a>備註

在全螢幕模式下,所有停靠控制欄、工具列和功能表都隱藏,活動視圖將調整大小以佔據全屏。

啟用全螢幕模式時,必須指定啟用或禁用全螢幕模式的命令的 ID。 可以從主框架`EnableFullScreenMode`的功能`OnCreate`調用。 當框架視窗切換到全屏模式時,框架將創建一個浮動工具列,其中一個按鈕具有指定的命令 ID。

如果要將主選單保留在螢幕上,請致電[CFrameWndEx::啟用全螢幕主選單](#enablefullscreenmainmenu)。

## <a name="cframewndexenableloaddockstate"></a><a name="enableloaddockstate"></a>CFramewndEx::啟用LoadDockState

啟用或禁用停靠狀態的載入。

```
void EnableLoadDockState(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 要啟用停靠狀態的載入,FALSE 將禁用停靠狀態的載入。

## <a name="cframewndexenablepanemenu"></a><a name="enablepanemenu"></a>CFramewndEx::啟用PaneMenu

啟用或禁用窗格功能表的自動處理。

```
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly=FALSE,
    BOOL bViewMenuShowsToolbarsOnly=FALSE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 可自動處理控制欄彈出式功能表;FALSE 以禁用控制欄彈出式功能表的自動處理。

*ui 客製化Cmd*<br/>
[在]**「自訂」** 選單項的命令 ID。

*str定製標籤*<br/>
[在]**要為「自訂」** 選單項目顯示的標籤

*uiView 工具列選單入口ID*<br/>
[在]在控制列中打開彈出功能表的工具列功能表項的 ID。

*bContextMenu 只顯示工具列*<br/>
[在]如果為 TRUE,則控制欄上下文菜單僅顯示工具列清單。 如果 FALSE,功能表將顯示工具列和停靠欄的清單。

*b 只檢視選單顯示工具列*<br/>
[在]如果為 TRUE,則控制欄選單僅顯示工具列的清單。 如果 FALSE,功能表將顯示工具列和停靠欄的清單。

## <a name="cframewndexgetactivepopup"></a><a name="getactivepopup"></a>CFramewndEx:取得活動彈出

返回指向當前顯示的彈出式功能表的指標。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>傳回值

指向當前顯示的彈出式功能表的指標;否則 NULL。

## <a name="cframewndexgetdefaultresid"></a><a name="getdefaultresid"></a>CFramewndEx:取得預設ResId

返回框架載入框架視窗時指定的資源 ID。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>傳回值

使用者在框架載入框架視窗時指定的資源 ID 值。 如果框架窗口沒有功能表欄,則為零。

## <a name="cframewndexgetdockingmanager"></a><a name="getdockingmanager"></a>CFramewndEx::獲取對接管理器

檢索框架視窗的[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md)物件。

```
CDockingManager* GetDockingManager();
```

### <a name="return-value"></a>傳回值

指向[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md)的指標。

### <a name="remarks"></a>備註

框架窗口創建並使用[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md)物件來管理子視窗停靠。

## <a name="cframewndexgetmenubar"></a><a name="getmenubar"></a>CFramewndEx::獲取功能表欄

將指標傳回到附加在框架視窗的功能表列物件。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

指向附加到框架視窗的功能表欄物件的指標。

## <a name="cframewndexgetpane"></a><a name="getpane"></a>CFramewndEx::獲取窗格

返回指向具有指定 ID 的窗格的指標。

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]控件識別碼。

### <a name="return-value"></a>傳回值

指向具有指定 ID 的窗格的指標。 NULL,如果沒有此類窗格。

## <a name="cframewndexgetribbonbar"></a><a name="getribbonbar"></a>CFramewndEx::獲取功能列

檢索框架的功能區條控制項。

```
CMFCRibbonBar* GetRibbonBar();
```

### <a name="return-value"></a>傳回值

指向框架的[CMFCRibbonBar 類別](../../mfc/reference/cmfcribbonbar-class.md)。

### <a name="remarks"></a>備註

## <a name="cframewndexgettearoffbars"></a><a name="gettearoffbars"></a>CFramewndEx::獲取關閉條形

傳回分割狀態的窗格物件清單。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>傳回值

對`CObList`包含指向處於分淚狀態的窗格物件的指標集合的物件的引用。

## <a name="cframewndexgettoolbarbuttontooltiptext"></a><a name="gettoolbarbuttontooltiptext"></a>CFramewndEx::取得工具列按鈕工具提示文字

當應用程式顯示工具列按鈕的工具提示時,由框架調用。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列按鈕的指標。

*斯特特文字*<br/>
[在]要顯示按鈕的工具提示文本。

### <a name="return-value"></a>傳回值

如果已顯示工具提示,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。 如果要顯示工具列按鈕的工具提示,則重寫此方法。

## <a name="cframewndexinsertpane"></a><a name="insertpane"></a>CFramewndEx::插入窗格

將窗格插入控制列清單中，並向停駐的管理員註冊此窗格。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter=TRUE);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
要插入控制列清單，以及向停駐的管理員註冊的控制列指標。

*p 目標*<br/>
控制列指標，在其前後插入窗格。

*b 後*<br/>
如果想在*pTarget*之後插入*pControlBar,* 則為 TRUE,否則。

### <a name="return-value"></a>傳回值

如果控制欄已成功插入和註冊,則為 TRUE,否則為 FALSE。

### <a name="remarks"></a>備註

您必須使用 [CDockingManager Class](../../mfc/reference/cdockingmanager-class.md) 參與停駐的配置，註冊每個控制列。

## <a name="cframewndexisfullscreen"></a><a name="isfullscreen"></a>CFramewndEx::全屏

確定框架視窗是否處於全屏模式。

```
BOOL IsFullScreen() const;
```

### <a name="return-value"></a>傳回值

如果幀視窗處於全屏模式,則為 TRUE;如果幀視窗處於全屏模式,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

您可以通過調用[CFrameWndEx::啟用全屏模式](#enablefullscreenmode)方法來設置全屏模式。

## <a name="cframewndexismenubaravailable"></a><a name="ismenubaravailable"></a>CFramewndEx::IsMenuBar可用

確定指向功能表欄物件的指標是否有效。

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>傳回值

如果框架視窗具有功能表欄,則為 TRUE;如果框架視窗具有功能表欄。否則 FALSE。

## <a name="cframewndexispointneardocksite"></a><a name="ispointneardocksite"></a>CFramewndEx::IsPointNearDockSite

確定點是否位於對齊區域中。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]點的位置。

*dwBaralignment*<br/>
[出]點對齊的位置。 有關可能的值,請參閱備註部分中的表。

*bouterEdge*<br/>
[出]如果點位於靠近框架邊框的位置,則為 TRUE;如果點位於框架邊框附近,則為 TRUE。如果點位於工作區中,則 FALSE。

### <a name="return-value"></a>傳回值

如果點位於對齊區域中,則為 TRUE;如果點位於對齊區域中,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

下表列出了*dwBarAlignment*參數的可能值。

|||
|-|-|
|CBRS_ALIGN_TOP|對齊到頂部。  |
|CBRS_ALIGN_RIGHT|向右對齊。  |
|CBRS_ALIGN_BOTTOM|與底部對齊。  |
|CBRS_ALIGN_LEFT|向左對齊。  |

## <a name="cframewndexisprintpreview"></a><a name="isprintpreview"></a>CFramewndEx::是列印預覽

確定框架視窗是否處於列印預覽模式。

```
BOOL IsPrintPreview();
```

### <a name="return-value"></a>傳回值

如果幀視窗處於列印預覽模式,則為 TRUE;如果框架視窗處於列印預覽模式,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexloadframe"></a><a name="loadframe"></a>CFramewndEx::載入幀

在建構後調用此方法以創建幀視窗並載入其資源。

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*nID資源*<br/>
[在]用於載入所有幀資源的資源 ID。

*dwDefault 樣式*<br/>
[在]默認框架視窗樣式。

*pparentwnd*<br/>
[在]指向框架的父視窗。

*pContext*<br/>
[在]指向框架在應用程式創建期間使用的[CCreateContext 結構](../../mfc/reference/ccreatecontext-structure.md)類的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexnegotiateborderspace"></a><a name="negotiateborderspace"></a>CFramewndEx::談判邊界空間

實現 OLE 客戶端邊界協商。

```
virtual BOOL NegotiateBorderSpace(
    UINT nBorderCmd,
    LPRECT lpRectBorder);
```

### <a name="parameters"></a>參數

*nBorderCmd*<br/>
[在]邊界協商命令。 有關可能的值,請參閱備註部分。

*lprect邊框*<br/>
[進出]邊框的尺寸。

### <a name="return-value"></a>傳回值

如果必須重新計算佈局,則為 TRUE;如果必須重新計算佈局,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

下表列出了*nBorderCmd*參數的可能值。

*邊框取得*<br/>
獲取可用的 OLE 客戶端空間。

*邊框要求*<br/>
請求 OLE 客戶端空間。

*邊框集*<br/>
設置 OLE 用戶端空間。

## <a name="cframewndexonactivate"></a><a name="onactivate"></a>CFramewndEx::打開啟動

當使用者輸入切換到或遠離幀時,框架調用此方法。

```
afx_msg void OnActivate(
    UINT nState,
    CWnd* pWndOther,
    BOOL bMinimized);
```

### <a name="parameters"></a>參數

*n州*<br/>
[在]幀是活動還是非活動。 有關可能的值,請參閱備註部分中的表。

*pWnd 其他*<br/>
[在]指向使用當前窗口切換使用者輸入的另一個視窗。

*b 最小化*<br/>
[在]幀的最小化狀態。 如果幀最小化,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

下表列出了*nState*參數的可能值。

|||
|-|-|
|WA_ACTIVE|框架由滑鼠按一下以外的方法選擇。  |
|WA_CLICKACTIVE|按下滑鼠即可選擇框架。  |
|WA_INACTIVE|未選擇框架。  |

## <a name="cframewndexonactivateapp"></a><a name="onactivateapp"></a>CFramewndEx:打開ActivateApp

在選擇或取消選擇應用程式時由框架呼叫。

```
afx_msg void OnActivateApp(
    BOOL bActive,
    DWORD dwThreadID);
```

### <a name="parameters"></a>參數

*b 活動*<br/>
[在]如果選擇了應用程式,則為 TRUE;如果選擇了"真"。如果未選擇應用程式,則 FALSE。

*dwThreadID*<br/>
[在]不使用此參數。

### <a name="remarks"></a>備註

## <a name="cframewndexonchangevisualmanager"></a><a name="onchangevisualmanager"></a>CFramewndEx::打開視覺管理器

當對框架的更改需要更改視覺管理器時,由框架調用。

```
afx_msg LRESULT OnChangeVisualManager(
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*wParam*<br/>
[在]不使用此參數。

*lParam*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

永遠傳回 0。

### <a name="remarks"></a>備註

## <a name="cframewndexonclose"></a><a name="onclose"></a>CFramewndEx::關閉

框架調用此方法以關閉幀。

```
afx_msg void OnClose();
```

### <a name="remarks"></a>備註

如果框架處於列印預覽模式,則會發送 Windows 消息以關閉列印預覽;如果框架處於列印預覽狀態,則會發送 Windows 消息以關閉列印預覽。否則,如果幀承載 OLE 用戶端,則用戶端將停用。

## <a name="cframewndexonclosedockingpane"></a><a name="onclosedockingpane"></a>CFramewndEx::關閉對接窗格

當用戶按下停靠窗格上的 **「關閉**」按鈕時,由框架呼叫。

```
virtual BOOL OnCloseDockingPane(CDockablePane* pPane);
```

### <a name="return-value"></a>傳回值

如果停靠條可以關閉,則為 TRUE。 否則

### <a name="remarks"></a>備註

預設實現不執行任何操作。 如果要處理停靠欄的隱藏,則重寫此方法。

## <a name="cframewndexoncloseminiframe"></a><a name="oncloseminiframe"></a>CFramewndEx::在關閉迷你框架上

當用戶按下浮動迷你框架視窗中的 **「關閉**」按鈕時,由框架呼叫。

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd* pWnd);
```

### <a name="return-value"></a>傳回值

如果可以關閉浮動迷你框架視窗,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作。 如果要處理浮動迷你框架視窗的隱藏,則重寫此方法。

## <a name="cframewndexonclosepopupmenu"></a><a name="onclosepopupmenu"></a>CFramewndEx::在關閉彈出功能表

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
指向彈出功能表的指標。

### <a name="remarks"></a>備註

框架在即將關閉視窗時發送WM_DESTROY消息。 如果要處理`CMFCPopupMenu`物件在處理框架在關閉視窗時`CMFCPopupMenu`發送 WM_DESTROY消息時屬於框架視窗的物件的通知,則重寫此方法。

## <a name="cframewndexoncmdmsg"></a><a name="oncmdmsg"></a>CFramewndEx::OnCmdMsg

調度命令消息。

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]命令識別碼。

*n代碼*<br/>
[在]命令消息類別。

*pExtra*<br/>
[進出]指向命令物件的指標。

*pHandlerInfo*<br/>
[進出]指向命令處理程序結構的指標。

### <a name="return-value"></a>傳回值

如果處理命令消息,則為 TRUE;如果已處理命令消息,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexoncontexthelp"></a><a name="oncontexthelp"></a>CFramewndEx::在上下文説明

由框架調用以顯示與上下文相關的説明。

```
afx_msg void OnContextHelp();
```

### <a name="remarks"></a>備註

## <a name="cframewndexoncreate"></a><a name="oncreate"></a>CFramewndEx::打開創建

創建框架後由框架調用。

```
afx_msg int OnCreate(LPCREATESTRUCT lpCreateStruct);
```

### <a name="parameters"></a>參數

*lpCreatestruct*<br/>
[在]指向新幀的[「創建結構」](/windows/win32/api/winuser/ns-winuser-createstructw)的指標。

### <a name="return-value"></a>傳回值

0 繼續創建幀;-1 摧毀框架。

### <a name="remarks"></a>備註

## <a name="cframewndexondestroy"></a><a name="ondestroy"></a>CFramewndEx::On銷毀

框架被銷毀時由框架調用。

```
afx_msg void OnDestroy();
```

### <a name="remarks"></a>備註

加速器表和所有視窗都已銷毀。

## <a name="cframewndexondrawmenuimage"></a><a name="ondrawmenuimage"></a>CFramewndEx::在DrawMenu圖像

當應用程式繪製與功能表項關聯的圖像時,由框架調用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pMenu 按鈕*<br/>
[在]指向正在渲染其圖像的功能表按鈕的指標。

*rectImage*<br/>
[在]指向指定影像的`Rect`螢幕位置和大小的結構的指標。

### <a name="return-value"></a>傳回值

如果框架成功呈現圖像,則為 TRUE;如果框架成功呈現圖像,則為 TRUE。否則。

### <a name="remarks"></a>備註

如果要為屬於`CFrameWndEx`派生對象擁有的功能表欄的功能表項自定義圖像渲染,請重寫此方法。

## <a name="cframewndexondrawmenulogo"></a><a name="ondrawmenulogo"></a>CFramewndEx::在DrawMenuLogo

當`CMFCPopupMenu`物件處理WM_PAINT消息時,由框架調用。

```
virtual void OnDrawMenuLogo(
    CDC* pDC,
    CMFCPopupMenu* pMenu,
    const CRect& rectLogo);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pMenu*<br/>
[在]指向功能表項的指標。

*雷科洛格*<br/>
[在]對指定選單標誌標的`CRect`螢幕位置和大小的常量結構的引用。

### <a name="remarks"></a>備註

如果要在屬於`CFrameWndEx`派生對象擁有的功能表欄的彈出式功能表上顯示徽標,則重寫此函數。

## <a name="cframewndexondwmcompositionchanged"></a><a name="ondwmcompositionchanged"></a>CFramewndEx:onDWM 組合已更改

當桌面視窗管理員 (DWM) 組合已啟用或禁用時,由框架呼叫。

```
afx_msg LRESULT OnDWMCompositionChanged(
    WPARAM wp,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]不使用此參數。

*lp*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

永遠傳回 0。

### <a name="remarks"></a>備註

## <a name="cframewndexonexitsizemove"></a><a name="onexitsizemove"></a>CFramewndEx:打開退出大小移動

當框架停止移動或調整大小時,由框架調用。

```
LRESULT OnExitSizeMove(
    WPARAM wp,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]不使用此參數。

*lp*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

永遠傳回 0。

### <a name="remarks"></a>備註

## <a name="cframewndexongetminmaxinfo"></a><a name="ongetminmaxinfo"></a>CFramewndEx::OnGetminMaxinfo

當框架調整大小以設置視窗尺寸限制時,由框架調用。

```
afx_msg void OnGetMinMaxInfo(MINMAXINFO FAR* lpMMI);
```

### <a name="parameters"></a>參數

*lpMMI*<br/>
[在]指向[MINMAXINFO](/windows/win32/api/winuser/ns-winuser-minmaxinfo)結構的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexonidleupdatecmdui"></a><a name="onidleupdatecmdui"></a>CFramewndEx::上線更新CmdUI

當命令處理處於空閒狀態時,框架調用以更新幀顯示。

```
afx_msg LRESULT OnIdleUpdateCmdUI(
    WPARAM wParam = 0,
    LPARAM lParam = 0);
```

### <a name="parameters"></a>參數

*wParam*<br/>
[在]不使用此參數。

*lParam*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

永遠傳回 0。

### <a name="remarks"></a>備註

## <a name="cframewndexonlbuttondown"></a><a name="onlbuttondown"></a>CFramewndEx::打開按鈕

當使用者按下滑鼠左鍵時,框架將調用此方法。

```
afx_msg void OnLButtonDown(
    UINT nFlags,
    CPoint point);
```

### <a name="parameters"></a>參數

*nFlags*<br/>
[在]指示使用者是否按下修改器鍵。 有關可能的值,請參閱[WM_LBUTTONDOWN通知](/windows/win32/inputdev/wm-lbuttondown)中的參數*wParam。*

*點*<br/>
[在]指定指標相對於視窗左上角的 x 和 y 座標。

### <a name="remarks"></a>備註

## <a name="cframewndexonlbuttonup"></a><a name="onlbuttonup"></a>CFramewndEx::OnLButtonUp

當使用者釋放滑鼠左鍵時,框架將調用此方法。

```
afx_msg void OnLButtonUp(
    UINT nFlags,
    CPoint point);
```

### <a name="parameters"></a>參數

*nFlags*<br/>
[在]指示使用者是否按下修改器鍵。 有關可能的值,請參閱[WM_LBUTTONUP通知](/windows/win32/inputdev/wm-lbuttonup)中的參數*wParam。*

*點*<br/>
[在]指定指標相對於視窗左上角的 x 和 y 座標。

### <a name="remarks"></a>備註

## <a name="cframewndexonmenubuttontoolhittest"></a><a name="onmenubuttontoolhittest"></a>CFramewndEx::在MenuButton工具命中測試

當`CMFCToolBarButton`物件處理WM_NCHITTEST消息時,由框架調用。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列按鈕的指標。

*Pti*<br/>
[出]指向工具資訊結構的指標。

### <a name="return-value"></a>傳回值

如果應用程式填充*pTI*參數,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

如果要提供有關特定功能表項的工具提示資訊,請重寫此方法。

## <a name="cframewndexonmenuchar"></a><a name="onmenuchar"></a>CFramewndEx::在MenuChar

當顯示功能表並且使用者按下與命令不對應的鍵時,由框架調用。

```
afx_msg LRESULT OnMenuChar(
    UINT nChar,
    UINT nFlags,
    CMenu* pMenu);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
[在]按鍵的字元代碼。

*nFlags*<br/>
[在]如果顯示的功能表是子功能表,則包含MF_POPUP標誌;如果顯示的功能表是控件功能表,則包含MF_SYSMENU標誌。

*pMenu*<br/>
[在]指向功能表的指標。

### <a name="return-value"></a>傳回值

高階單詞必須是以下值之一。

|||
|-|-|
`0` | 框架應忽略擊鍵。
`1`  | 框架應關閉功能表。
`2`  | 框架應選擇功能表中顯示的專案之一。 低階單詞包含要選擇的命令的 ID。

## <a name="cframewndexonmousemove"></a><a name="onmousemove"></a>CFramewndEx::滑鼠移動

當指標移動時,框架調用此方法。

```
afx_msg void OnMouseMove(
    UINT nFlags,
    CPoint point);
```

### <a name="parameters"></a>參數

*nFlags*<br/>
[在]指示使用者是否按下修改器鍵。 有關可能的值,請參閱[WM_MOUSEMOVE通知](/windows/win32/inputdev/wm-mousemove)中的參數*wParam。*

*點*<br/>
[在]指定指標相對於視窗左上角的 x 和 y 座標。

### <a name="remarks"></a>備註

## <a name="cframewndexonmoveminiframe"></a><a name="onmoveminiframe"></a>CFramewndEx::在移動迷你框架

當窗格窗口移動時由框架調用。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
[在]指向[CPaneFramewnd 類](../../mfc/reference/cpaneframewnd-class.md)窗格視窗。

### <a name="return-value"></a>傳回值

如果窗格視窗未停靠,則為 TRUE;如果窗格視窗已停靠,則 FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexonncactivate"></a><a name="onncactivate"></a>CFramewndEx::打開NcActivate

當必須重新繪製框架的非工作區以指示活動狀態的更改時,框架調用框架。

```
afx_msg BOOL OnNcActivate(BOOL bActive);
```

### <a name="parameters"></a>參數

*b 活動*<br/>
[在]TRUE 以啟動幀;FALSE 以將幀繪製為非活動狀態。

### <a name="return-value"></a>傳回值

非零繼續默認處理;0 以防止非工作區停用。

### <a name="remarks"></a>備註

## <a name="cframewndexonnccalcsize"></a><a name="onnccalcsize"></a>CFramewndEx:在NcCalcsize上

當必須計算工作區的大小和位置時,由框架調用。

```
afx_msg void OnNcCalcSize(
    BOOL bCalcValidRects,
    NCCALCSIZE_PARAMS FAR* lpncsp);
```

### <a name="parameters"></a>參數

*bCalcValidrects*<br/>
[在]當應用程式必須指定有效的工作區時為 TRUE;否則,FALSE。

*lpncsp*<br/>
[在]指向包含幀`NCCALCSIZE_PARAMS`尺寸更改的結構的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexonnchittest"></a><a name="onnchittest"></a>CFramewndEx::OnNcHitTest

當指標移動或按下或釋放滑鼠按鈕時,框架調用。

```
afx_msg LRESULT OnNcHitTest(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]指標在螢幕座標中的位置。

### <a name="return-value"></a>傳回值

指標命中枚舉值。 有關可能值的清單,請參閱[WM_NCHITTEST通知](/windows/win32/inputdev/wm-nchittest)。

### <a name="remarks"></a>備註

## <a name="cframewndexonncmousemove"></a><a name="onncmousemove"></a>CFramewndEx::在NcMouseMove上

當指標在非工作區中移動時,由框架調用。

```
afx_msg void OnNcMouseMove(
    UINT nHitTest,
    CPoint point);
```

### <a name="parameters"></a>參數

*nHitTest*<br/>
[在]指標命中枚舉值。 有關可能值的清單,請參閱[WM_NCHITTEST通知](/windows/win32/inputdev/wm-nchittest)。

*點*<br/>
[在]指標在螢幕座標中的位置。

### <a name="remarks"></a>備註

## <a name="cframewndexonncpaint"></a><a name="onncpaint"></a>CFramewndEx:onNcPaint

當必須繪製非工作區時,框架調用。

```
afx_msg void OnNcPaint();
```

### <a name="remarks"></a>備註

## <a name="cframewndexonpanecheck"></a><a name="onpanecheck"></a>CFramewndEx::在窗格檢查

由框架調用以控制窗格的可見性。

```
afx_msg BOOL OnPaneCheck(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]窗格的控制 ID。

### <a name="return-value"></a>傳回值

如果處理命令,則為 TRUE;如果已處理命令,則為 TRUE。FALSE 繼續處理命令。

### <a name="remarks"></a>備註

## <a name="cframewndexonpostpreviewframe"></a><a name="onpostpreviewframe"></a>CFramewndEx:在後預覽幀上

當使用者更改列印預覽模式時,由框架調用。

```
afx_msg LRESULT OnPostPreviewFrame(
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*wParam*<br/>
[在]不使用此參數。

*lParam*<br/>
[在]當幀處於列印預覽模式時為 TRUE;如果幀處於列印預覽模式,則為 TRUE。列印預覽模式關閉時 FALSE。

### <a name="return-value"></a>傳回值

永遠傳回 0。

### <a name="remarks"></a>備註

## <a name="cframewndexonpowerbroadcast"></a><a name="onpowerbroadcast"></a>CFramewndEx::在功率廣播

發生電源管理事件時由框架調用。

```
afx_msg LRESULT OnPowerBroadcast(
    WPARAM wp,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]電源管理事件。 有關可能值的清單,請參閱[WM_POWERBROADCAST訊息](/windows/win32/Power/wm-powerbroadcast)。

*lp*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

調用預設視窗過程的結果。

### <a name="remarks"></a>備註

## <a name="cframewndexonsetmenu"></a><a name="onsetmenu"></a>CFramewndEx::打開選單

由框架調用以替換框架視窗功能表。

```
afx_msg LRESULT OnSetMenu(
    WPARAM wp,
    LPARAM lp);

BOOL OnSetMenu(HMENU hmenu);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]處理新的框架視窗功能表。

*lp*<br/>
[在]處理新視窗功能表。

*赫梅努*<br/>
[在]處理新的框架視窗功能表。

### <a name="return-value"></a>傳回值

LRESULT 是調用默認視窗過程的結果。

如果事件已處理,BOOL 為 TRUE;如果事件已處理,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexonsetpreviewmode"></a><a name="onsetpreviewmode"></a>CFramewndEx::打開預覽模式

由框架調用,以設置框架的列印預覽模式。

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

*b預覽*<br/>
[在]TRUE 以啟用列印預覽;FALSE 以禁用列印預覽。

*pState*<br/>
[在]指向幀狀態`CPrintPreviewState`結構的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexonsettext"></a><a name="onsettext"></a>CFramewndEx::打開文字

由框架調用以設置視窗的文字。

```
afx_msg LRESULT OnSetText(
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*wParam*<br/>
[在]不使用此參數。

*lParam*<br/>
[在]指向視窗的文本。

### <a name="return-value"></a>傳回值

從呼叫傳回值到[DefWindowProc](/windows/win32/api/winuser/nf-winuser-defwindowprocw)。

### <a name="remarks"></a>備註

## <a name="cframewndexonshowcustomizepane"></a><a name="onshowcustomizepane"></a>CFramewndEx::在顯示自訂窗格

當框架顯示`QuickCustomizePane`時 ,它被調用。

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>參數

*pMenuPane*<br/>
[在]指向快速自定義窗格的指標。

*uiToolbarID*<br/>
[在]要自定義的工具列的控制 ID。

### <a name="return-value"></a>傳回值

此方法始終返回 TRUE。

### <a name="remarks"></a>備註

快速自訂選單是單擊工具列的自訂按鈕時出現的彈出式選單

## <a name="cframewndexonshowpanes"></a><a name="onshowpanes"></a>CFramewndEx::在顯示窗格

由框架呼叫以顯示或隱藏窗格。

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]如果應用程式顯示窗格,則為 TRUE;如果應用程式顯示窗格,則為 TRUE。否則。

### <a name="return-value"></a>傳回值

此方法始終返回 FALSE。

### <a name="remarks"></a>備註

如果*bShow*為 TRUE,並且窗格處於隱藏狀態,或者*bShow*為 FALSE 並且窗格可見,則默認實現將顯示窗格。

如果*bShow*為 TRUE,並且窗格可見,或者*bShow*為 FALSE 並且窗格處於隱藏狀態,則默認實現將隱藏窗格。

在派生類中重寫此方法,在框架顯示或隱藏窗格時執行自定義代碼。

## <a name="cframewndexonshowpopupmenu"></a><a name="onshowpopupmenu"></a>CFramewndEx::在顯示彈出功能表

當框架顯示彈出式功能表時,由它調用。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu* pMenu);
```

### <a name="parameters"></a>參數

*pMenu*<br/>
[在]指向彈出功能表的指標。

### <a name="return-value"></a>傳回值

如果彈出式功能表可見,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

在派生類中重寫此方法,在框架顯示彈出功能表時執行自定義代碼。 例如,重寫此方法以更改彈出功能表中命令的背景顏色。

## <a name="cframewndexonsize"></a><a name="onsize"></a>CFramewndEx::打開尺寸

框架大小更改後由框架調用。

```
afx_msg void OnSize(
    UINT nType,
    int cx,
    int cy);
```

### <a name="parameters"></a>參數

*nType*<br/>
[在]調整大小的類型。 有關可能的值,請參閱[WM_SIZE通知](/windows/win32/winmsg/wm-size)中的參數*wParam。*

*殘雪*<br/>
[在]以像素為單位的幀新寬度。

*cy*<br/>
[在]以像素為單位的幀的新高度。

### <a name="remarks"></a>備註

## <a name="cframewndexonsizing"></a><a name="onsizing"></a>CFramewndEx::打開

當用戶調整框架的大小時,由框架調用。

```
afx_msg void OnSizing(
    UINT fwSide,
    LPRECT pRect);
```

### <a name="parameters"></a>參數

*fwSide*<br/>
[在]移動的幀邊緣。 請參閱[WM_SIZING通知](/windows/win32/winmsg/wm-sizing)中的參數*wParam。*

*普雷克*<br/>
[進出]指向包含幀座標的[CRect](../../atl-mfc-shared/reference/crect-class.md)或[RECT](/windows/win32/api/windef/ns-windef-rect)結構的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexonsyscolorchange"></a><a name="onsyscolorchange"></a>CFramewndEx::SysColorChange

當系統顏色發生變化時由框架調用。

```
void OnSysColorChange();
```

### <a name="remarks"></a>備註

## <a name="cframewndexontearoffmenu"></a><a name="ontearoffmenu"></a>CFramewndEx::在TearoffMenu上

當應用程式顯示具有撕開條的菜單時,由框架調用。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向彈出功能表的指標。

*pBar*<br/>
[在]指向撕裂條的指標。

### <a name="return-value"></a>傳回值

如果啟用了帶撕開條的彈出功能表,則為 TRUE;如果啟用了帶撕下條的彈出功能表。否則 FALSE。

### <a name="remarks"></a>備註

在派生類中重寫此方法,在框架顯示控制欄時執行自定義代碼。

預設實現不執行任何操作,並返回 TRUE。

## <a name="cframewndexontoolbarcontextmenu"></a><a name="ontoolbarcontextmenu"></a>CFramewndEx::在工具列上下文菜單上

由框架調用以生成工具列彈出式功能表。

```
afx_msg LRESULT OnToolbarContextMenu(
    WPARAM wp,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]不使用此參數。

*lp*<br/>
[在]不使用此參數。

### <a name="return-value"></a>傳回值

始終返回 1。

### <a name="remarks"></a>備註

## <a name="cframewndexontoolbarcreatenew"></a><a name="ontoolbarcreatenew"></a>CFramewndEx::在工具列創建新

框架呼叫此方法以創建新工具列。

```
afx_msg LRESULT OnToolbarCreateNew(
    WPARAM wp,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*Wp*<br/>
[在]不使用此參數。

*lp*<br/>
[在]指向工具列標題列的文字。

### <a name="return-value"></a>傳回值

指向新工具列的指標;如果未建立工具列,則為 NULL。

### <a name="remarks"></a>備註

## <a name="cframewndexontoolbardelete"></a><a name="ontoolbardelete"></a>CFramewndEx::打開工具列刪除

刪除工具列時由框架調用。

```
afx_msg LRESULT OnToolbarDelete(
    WPARAM /* unused */,
    LPARAM lp);
```

### <a name="parameters"></a>參數

*閒置*<br/>
[在]不使用此參數。

*lp*<br/>
[在]指向工具列的指標。

### <a name="return-value"></a>傳回值

如果工具列已刪除,則為 TRUE;如果工具列已刪除,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexonupdateframemenu"></a><a name="onupdateframemenu"></a>CFramewndEx::更新框架功能表

由框架調用以設置框架功能表。

```
virtual void OnUpdateFrameMenu(HMENU hMenuAlt);
```

### <a name="parameters"></a>參數

*哈梅內阿爾特*<br/>
[在]處理備用功能表。

### <a name="remarks"></a>備註

## <a name="cframewndexonupdateframetitle"></a><a name="onupdateframetitle"></a>CFramewndEx::更新幀標題

框架呼叫此方法以更新框架視窗的標題列。

```
virtual void OnUpdateFrameTitle(BOOL bAddToTitle);
```

### <a name="parameters"></a>參數

*bAddToTitle*<br/>
[在]TRUE 將活動文檔標題添加到框架窗口標題列;否則 FALSE。

### <a name="remarks"></a>備註

## <a name="cframewndexonupdatepanemenu"></a><a name="onupdatepanemenu"></a>CFramewndEx::更新窗格功能表

由框架調用以更新窗格功能表。

```
afx_msg void OnUpdatePaneMenu(CCmdUI* pCmdUI);
```

### <a name="parameters"></a>參數

*pCmdUI*<br/>
[在]指向窗格用戶介面物件的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexonwindowposchanged"></a><a name="onwindowposchanged"></a>CFramewndEx::在視窗Pos上

當幀大小、位置或 z 順序因調用視窗管理方法而發生更改時,由框架調用。

```
afx_msg void OnWindowPosChanged(WINDOWPOS FAR* lpwndpos);
```

### <a name="parameters"></a>參數

*lpwndpos*<br/>
[在]指向包含新大小和位置的[WINDOWPOS](/windows/win32/api/winuser/ns-winuser-windowpos)結構的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexpanefrompoint"></a><a name="panefrompoint"></a>CFramewndEx::P從點

搜索每個窗格的給定點。

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]要檢查的點的螢幕座標。

*nSensitivity*<br/>
[在]搜索點時,按此量展開每個控制列欄的邊界矩形。

*bExactBar*<br/>
[在]TRUE 忽略*n 敏感參數*;否則,FALSE。

*pRTCBar 類型*<br/>
[在]如果不是 NULL,該方法將僅搜尋指定類型的控制列。

*dwalignment*<br/>
[出]如果成功,此參數包含最接近指定點的控制欄的一側。 否則,不會初始化此參數。

### <a name="return-value"></a>傳回值

指向包含點的控制欄的*指標*;如果未找到控制項,則為 NULL。

### <a name="remarks"></a>備註

此方法搜尋應用程式中的所有控制列以搜尋*點*。

使用*nSensitivity*可增加搜尋區域的大小。 使用*pRTCBarType*限制方法搜索的控制欄的類型。

## <a name="cframewndexpretranslatemessage"></a><a name="pretranslatemessage"></a>CFramewndEx::P重新翻譯訊息

在調度特定視窗消息之前處理它們。

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>參數

*pMsg*<br/>
[在]指向包含要處理的消息的[MSG](/windows/win32/api/winuser/ns-winuser-msg)結構的指標。

### <a name="return-value"></a>傳回值

如果消息已處理且不應調度,則為非零;0 如果消息未處理,則應調度。

### <a name="remarks"></a>備註

## <a name="cframewndexrecalclayout"></a><a name="recalclayout"></a>CFramewndEx:recalclayout

調整框架及其子窗口的佈局。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

*b 通知*<br/>
[在]指定是否通知 OLE 客戶端項有關佈局更改。

### <a name="remarks"></a>備註

當框架視窗的大小已更改或顯示或隱藏控制欄時,將調用此方法。

## <a name="cframewndexremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>CFramewndEx::從Dock管理器中刪除Pane

取消註冊窗格並從停靠管理器中刪除它。

```
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]指向要刪除的控制欄窗格的指標。

*b破壞*<br/>
[在]TRUE 在卸下控制條后將其銷毀;否則。

*b 調整佈局*<br/>
[在]TRUE 調整停靠佈局;否則。

*bAutoHide*<br/>
[在]如果控制欄處於自動隱藏模式,則為 TRUE;否則。

*pBar 取代*<br/>
[在]指向替換已刪除窗格的窗格的指標。

### <a name="remarks"></a>備註

使用此方法從框架視窗的停靠佈局中刪除控制欄。

[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md)處理控制欄的佈局。 您必須使用[CFrameWndEx::addPane](#addpane)方法或[CFrameWndEx:::插入窗格](#insertpane)方法向停靠管理器註冊每個控制欄。

## <a name="cframewndexsetdockstate"></a><a name="setdockstate"></a>CFramewndEx::SetDockstate

將停靠佈局還原到存儲在註冊表中的停靠狀態。

```
void SetDockState(const CDockState& state);
```

### <a name="parameters"></a>參數

*state*<br/>
停靠狀態。 此參數會被忽略。

## <a name="cframewndexsetprintpreviewframe"></a><a name="setprintpreviewframe"></a>CFramewndEx::設定列印預覽框架

設置列印預覽框架視窗。

```
void SetPrintPreviewFrame(CFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向列印預覽框架視窗的指標。

### <a name="remarks"></a>備註

## <a name="cframewndexsetuptoolbarmenu"></a><a name="setuptoolbarmenu"></a>CFramewndEx::設定工具列選單

將使用者定義的命令插入工具列功能表。

```
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>參數

*選單*<br/>
[在]要`CMenu`修改的物件。

*uiViewUserToolbarCmdFirst*<br/>
[在]第一個使用者定義的命令。

*uiViewUserToolbarCmdLast*<br/>
[在]最後一個使用者定義的命令。

### <a name="remarks"></a>備註

框架將使用者定義的命令存儲在清單中。 使用*uiViewUserToolbarCmdFirst*和*uiViewUserToolbarCmdList*指定要插入的命令的索引。

## <a name="cframewndexshowfullscreen"></a><a name="showfullscreen"></a>CFramewndEx::顯示全屏

在全螢幕模式和常規模式之間切換主框架。

```
void ShowFullScreen();
```

## <a name="cframewndexshowpane"></a><a name="showpane"></a>CFramewndEx::顯示窗格

顯示或隱藏指定的窗格。

```
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要顯示或隱藏的控制欄的指標。

*b 顯示*<br/>
[在]如果為 TRUE,則應用程式將顯示控制欄。 否則,應用程式將隱藏控制欄。

*bDelay*<br/>
[在]如果為 TRUE,請延遲停靠佈局的調整,直到框架呼叫[CFrameWndEx::調整停靠佈局](#adjustdockinglayout)。 否則,立即重新計算停靠佈局。

*b 啟動*<br/>
[在]如果為 TRUE,則使控制欄處於活動狀態。 否則,將控制欄顯示為非活動狀態。

## <a name="cframewndexupdatecaption"></a><a name="updatecaption"></a>CFramewndEx::更新標題

由框架調用以更新視窗框架標題。

```
void UpdateCaption();
```

### <a name="remarks"></a>備註

## <a name="cframewndexwinhelp"></a><a name="winhelp"></a>CFramewndEx::贏説明

調用 WinHelp 應用程式或上下文相關説明。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>參數

*dwData*<br/>
依賴於*nCmd*參數的數據。 有關可能值的清單,請參閱[WinHelp](/windows/win32/api/winuser/nf-winuser-winhelpw)。

*nCmd*<br/>
説明命令。 有關可能值的清單,請參閱[WinHelp](/windows/win32/api/winuser/nf-winuser-winhelpw)。

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CFrameWnd](../../mfc/reference/cframewnd-class.md)
