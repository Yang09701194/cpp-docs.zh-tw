---
title: CHtmlView 類別
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 5c7204f5207b85e4b9ada4b68e9feedaf83deccd
ms.sourcegitcommit: 46d24d6e70c03e05484923d9efc6ed5150e96a64
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/09/2019
ms.locfileid: "68916223"
---
# <a name="chtmlview-class"></a>CHtmlView 類別

在 MFC 的文件/檢視架構內容中提供 WebBrowser 控制項的功能。

## <a name="syntax"></a>語法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|說明|
|----------|-----------------|
|[CHtmlView::Create](#create)|建立 WebBrowser 控制項。|
|[CHtmlView::CreateControlSite](#createcontrolsite)|可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。|
|[CHtmlView::ExecFormsCommand](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法執行指定的命令。|
|[CHtmlView::ExecWB](#execwb)|執行命令。|
|[CHtmlView::GetAddressBar](#getaddressbar)|決定是否顯示 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetApplication](#getapplication)|擷取代表應用程式的應用程式物件，此應用程式包含 Internet Explorer 應用程式目前的執行個體。|
|[CHtmlView::GetBusy](#getbusy)|擷取指出下載或其他活動是否仍在進行中的值。|
|[CHtmlView::GetContainer](#getcontainer)|擷取 WebBrowser 控制項的容器。|
|[CHtmlView::GetFullName](#getfullname)|擷取顯示在網頁瀏覽器中的資源完整名稱，包括路徑。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetFullScreen](#getfullscreen)|指出 WebBrowser 控制項是在全螢幕模式或標準視窗模式中操作。|
|[CHtmlView::GetHeight](#getheight)|擷取 Internet Explorer 主視窗的高度。|
|[CHtmlView::GetHtmlDocument](#gethtmldocument)|擷取使用中的 HTML 文件。|
|[CHtmlView::GetLeft](#getleft)|擷取 Internet Explorer 主視窗左邊緣的螢幕座標。|
|[CHtmlView::GetLocationName](#getlocationname)|擷取 WebBrowser 目前顯示的資源名稱。|
|[CHtmlView::GetLocationURL](#getlocationurl)|擷取 WebBrowser 目前顯示的資源 URL。|
|[CHtmlView::GetMenuBar](#getmenubar)|擷取決定是否顯示功能表列的值。|
|[CHtmlView::GetOffline](#getoffline)|擷取決定控制項是否離線的值。|
|[CHtmlView::GetParentBrowser](#getparentbrowser)|擷取 `IDispatch` 介面的指標。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView::GetProperty](#getproperty)|擷取與指定物件相關聯屬性目前的值。|
|[CHtmlView::GetReadyState](#getreadystate)|擷取網頁瀏覽器物件的就緒狀態。|
|[CHtmlView::GetRegisterAsBrowser](#getregisterasbrowser)|指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器進行。|
|[CHtmlView::GetRegisterAsDropTarget](#getregisterasdroptarget)|指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView::GetSilent](#getsilent)|指出是否可顯示所有對話方塊。|
|[CHtmlView::GetSource](#getsource)|網頁的 HTML 原始程式碼。|
|[CHtmlView::GetStatusBar](#getstatusbar)|指出是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetTheaterMode](#gettheatermode)|指出 WebBrowser 控制項是否為劇場模式。|
|[CHtmlView::GetToolBar](#gettoolbar)|擷取決定是否顯示工具列的值。|
|[CHtmlView::GetTop](#gettop)|擷取 Internet Explorer 主視窗上邊緣的螢幕座標。|
|[CHtmlView::GetTopLevelContainer](#gettoplevelcontainer)|擷取值，指出目前的物件是否為 WebBrowser 控制項的最上層容器。|
|[CHtmlView::GetType](#gettype)|擷取文件物件的類型名稱。|
|[CHtmlView::GetVisible](#getvisible)|擷取指出物件為顯示或隱藏的值。|
|[CHtmlView::GetWidth](#getwidth)|擷取 Internet Explorer 主視窗的寬度。|
|[CHtmlView::GoBack](#goback)|在歷程清單中巡覽至上一個項目。|
|[CHtmlView::GoForward](#goforward)|在歷程清單中巡覽至下一個項目。|
|[CHtmlView::GoHome](#gohome)|巡覽至目前的首頁或起始頁面。|
|[CHtmlView::GoSearch](#gosearch)|巡覽至目前的搜尋頁面。|
|[CHtmlView::LoadFromResource](#loadfromresource)|載入 WebBrowser 控制項的資源。|
|[CHtmlView::Navigate](#navigate)|巡覽至依 URL 找到的資源。|
|[CHtmlView::Navigate2](#navigate2)|巡覽至依 URL 找到的資源或依完整路徑找到的檔案。|
|[CHtmlView::OnBeforeNavigate2](#onbeforenavigate2)|在給定的 WebBrowser 中發生巡覽前呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView::OnCommandStateChange](#oncommandstatechange)|呼叫以通知應用程式， 網頁瀏覽器命令啟用的狀態已經變更。|
|[CHtmlView::OnDocumentComplete](#ondocumentcomplete)|呼叫以通知應用程式, 檔已達到 READYSTATE_COMPLETE 狀態。|
|[CHtmlView::OnDocWindowActivate](#ondocwindowactivate)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::OnDocWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)呼叫，這會在容器文件視窗啟用或停用時，通知使用中的就地物件。|
|[CHtmlView::OnDownloadBegin](#ondownloadbegin)|呼叫以通知應用程式，巡覽作業已經啟動。|
|[CHtmlView::OnDownloadComplete](#ondownloadcomplete)|當巡覽作業結束、暫止或失敗時呼叫。|
|[CHtmlView::OnEnableModeless](#onenablemodeless)|當容器建立或終結強制回應對話方塊時，呼叫以啟用或停用非強制回應對話方塊。|
|[CHtmlView::OnFilterDataObject](#onfilterdataobject)|Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。|
|[CHtmlView::OnFrameWindowActivate](#onframewindowactivate)|從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。|
|[CHtmlView::OnFullScreen](#onfullscreen)|當 FullScreen 屬性變更時呼叫。|
|[CHtmlView::OnGetDropTarget](#ongetdroptarget)|當它用做為置放目標，讓主機提供另一個 [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnGetExternal](#ongetexternal)|由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。|
|[CHtmlView::OnGetHostInfo](#ongethostinfo)|擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。|
|[CHtmlView::OnGetOptionKeyPath](#ongetoptionkeypath)|傳回 Internet Explorer 或 MSHTML 儲存使用者喜好設定的登錄機碼。|
|[CHtmlView::OnHideUI](#onhideui)|當 Internet Explorer 或 MSHTML 移除其功能表與工具列時呼叫。|
|[CHtmlView::OnMenuBar](#onmenubar)|當 MenuBar 屬性變更時呼叫。|
|[CHtmlView::OnNavigateComplete2](#onnavigatecomplete2)|超連結的巡覽完畢後呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView::OnNavigateError](#onnavigateerror)|巡覽至超連結失敗時，由架構呼叫。|
|[CHtmlView::OnNewWindow2](#onnewwindow2)|當為顯示資源而建立新視窗時呼叫。|
|[CHtmlView::OnProgressChange](#onprogresschange)|呼叫以通知應用程式，下載作業的進度已經更新。|
|[CHtmlView::OnPropertyChange](#onpropertychange)|呼叫以通知應用程式， [PutProperty](#putproperty) 方法已經變更屬性的值。|
|[CHtmlView::OnQuit](#onquit)|呼叫以通知應用程式，Internet Explorer 應用程式已經可以結束。 (僅限 Internet Explorer)|
|[CHtmlView::OnResizeBorder](#onresizeborder)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。|
|[CHtmlView::OnShowContextMenu](#onshowcontextmenu)|當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnShowUI](#onshowui)|在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。|
|[CHtmlView::OnStatusBar](#onstatusbar)|當 StatusBar 屬性變更時呼叫。|
|[CHtmlView::OnStatusTextChange](#onstatustextchange)|呼叫以通知應用程式，和 WebBrowser 控制項相關的狀態列文字已經變更。|
|[CHtmlView::OnTheaterMode](#ontheatermode)|當 TheaterMode 屬性變更時呼叫。|
|[CHtmlView::OnTitleChange](#ontitlechange)|呼叫以通知應用程式，WebBrowser 控制項中文件的標題是否變成可用或變更。|
|[CHtmlView::OnToolBar](#ontoolbar)|當 ToolBar 屬性變更時呼叫。|
|[CHtmlView::OnTranslateAccelerator](#ontranslateaccelerator)|當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnTranslateUrl](#ontranslateurl)|由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。|
|[CHtmlView::OnUpdateUI](#onupdateui)|通知主機命令狀態已變更。|
|[CHtmlView::OnVisible](#onvisible)|當 WebBrowser 控制項的視窗必須顯示/隱藏時呼叫。|
|[CHtmlView::PutProperty](#putproperty)|設定與指定物件相關聯屬性的值。|
|[CHtmlView::QueryFormsCommand](#queryformscommand)|查詢使用者介面事件所產生之一或多個命令的狀態。|
|[CHtmlView::QueryStatusWB](#querystatuswb)|查詢 WebBrowser 控制項處理中的命令狀態。|
|[CHtmlView::Refresh](#refresh)|重新載入目前的檔案。|
|[CHtmlView::Refresh2](#refresh2)|重新載入目前的檔案，並選擇性地防止傳送 `pragma:nocache` 標頭。|
|[CHtmlView::SetAddressBar](#setaddressbar)|顯示或隱藏 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetFullScreen](#setfullscreen)|設定值以決定控制項在全螢幕模式或標準視窗模式中操作。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetHeight](#setheight)|設定 Internet Explorer 主視窗的高度。|
|[CHtmlView::SetLeft](#setleft)|設定 Internet Explorer 主視窗的水平位置。|
|[CHtmlView::SetMenuBar](#setmenubar)|設定決定是否顯示控制項功能表列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetOffline](#setoffline)|設定決定控制項是否離線的值。|
|[CHtmlView::SetRegisterAsBrowser](#setregisterasbrowser)|設定值，指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器。|
|[CHtmlView::SetRegisterAsDropTarget](#setregisterasdroptarget)|設定值，指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView::SetSilent](#setsilent)|設定決定控制項是否顯示對話方塊的值。|
|[CHtmlView::SetStatusBar](#setstatusbar)|設定值，決定是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetTheaterMode](#settheatermode)|設定指出 WebBrowser 控制項是否為劇場模式的值。|
|[CHtmlView::SetToolBar](#settoolbar)|設定決定是否顯示控制項工具列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetTop](#settop)|設定 Internet Explorer 主視窗的垂直位置。|
|[CHtmlView::SetVisible](#setvisible)|設定指出物件為顯示或隱藏的值。|
|[CHtmlView::SetWidth](#setwidth)|設定 Internet Explorer 主視窗的寬度。|
|[CHtmlView::Stop](#stop)|停止開啟檔案。|

## <a name="remarks"></a>備註

WebBrowser 控制項是一個視窗，使用者在這裡可以瀏覽全球資訊網的網站，以及本機檔案系統和網路上的資料夾。 WebBrowser 控制項支援超連結和統一資源定位器 (URL) 巡覽，以及維護歷程記錄清單。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>使用 MFC 應用程式的 CHtmlView 類別

在標準的 MFC 架構應用程式中 (SDI 或 MDI 型)，檢視物件通常衍生自一組特製的類別。 這些類別全都衍生自 `CView`，除 `CView`提供的功能之外，還提供特製的功能。

以 `CHtmlView` 當做應用程式檢視類別的基礎，可以提供附有 WebBrowser 控制項的檢視。 這能讓應用程式變成網頁瀏覽器。 建立網頁瀏覽器型應用程式的慣用方法，是使用 [MFC 應用程式精靈]，指定 `CHtmlView` 為檢視類別。 如需在 MFC 應用程式中實作及使用 WebBrowser 控制項的詳細資訊，請參閱 [建立網頁瀏覽器型的應用程式](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
>  WebBrowser ActiveX 控制項 (亦即 `CHtmlView`) 僅適用於已安裝 Internet Explorer 4.0 或更新版本的 Windows NT 4.0 或更新版本中所執行的程式。

`CHtmlView` 是為存取 Web (和/或 HTML 文件) 的應用程式所設計。 下列 `CHtmlView` 成員函式僅適用於 Internet Explorer 應用程式。 WebBrowser 控制項沿用這些函式，但作用不明顯。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>需求

**Header:** afxhtml.h

##  <a name="create"></a>CHtmlView:: Create

呼叫這個成員函式, 為 Internet Explorer 可執行檔建立 WebBrowser 控制項或容器。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*lpszClassName*<br/>
指向以 null 結束的字元字串, 其命名為 Windows 類別。 類別名稱可以是任何向[AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass)全域函式或`RegisterClass` Windows 函式註冊的名稱。 如果是 Null, 則會使用預先定義的預設[CFrameWnd](../../mfc/reference/cframewnd-class.md)屬性。

*lpszWindowName*<br/>
指向表示視窗名稱的以 null 結束的字元字串。

*dwStyle*<br/>
指定視窗樣式屬性。 根據預設, 會設定 WS_VISIBLE 和 WS_CHILD Windows 樣式。

*rect*<br/>
[矩形](/previous-versions/dd162897\(v=vs.85\))結構的參考, 指定視窗的大小和位置。 *RectDefault*值可讓 Windows 指定新視窗的大小和位置。

*pParentWnd*<br/>
控制項父視窗的指標。

*nID*<br/>
視圖的 ID 編號。 根據預設, 設定為 AFX_IDW_PANE_FIRST。

*pContext*<br/>
指向[CCreateCoNtext](../../mfc/reference/ccreatecontext-structure.md)的指標。 預設值為 Null。

##  <a name="createcontrolsite"></a>CHtmlView:: CreateControlSite

可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>參數

*pContainer*<br/>
包含控制項之[COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md)物件的指標。

*ppSite*<br/>
指向[COleControlSite](../../mfc/reference/colecontrolsite-class.md)物件指標的指標, 提供控制項的網站。

*nID*<br/>
要主控之控制項的識別碼。

*clsid*<br/>
要主控之控制項的 CLSID

### <a name="return-value"></a>傳回值

成功時傳回 TRUE, 失敗時傳回 FALSE。

### <a name="remarks"></a>備註

您可以覆寫這個成員函式, 以傳回您自己的控制項網站類別的實例。

##  <a name="execformscommand"></a>CHtmlView:: ExecFormsCommand

使用 `IOleCommandTarget::Exec` 方法執行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
要執行的命令。 此命令必須屬於 CMDSETID3_Forms3 群組。

*pVarIn*<br/>
包含輸入自`VARIANT`變數之結構的指標。 可以是 Null。

*pVarOut*<br/>
接收命令輸出`VARIANT`之結構的指標。 可以是 Null。

### <a name="return-value"></a>傳回值

標準的 HRESULT 值。 如需可能值的完整清單, 請參閱 Windows SDK 中的[IOleCommandTarget:: Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec) 。

### <a name="remarks"></a>備註

`ExecFormsCommand`[執行 IOleCommandTarget:: Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec)方法的行為。

##  <a name="execwb"></a>  CHtmlView::ExecWB

呼叫這個成員函式, 在 WebBrowser 或 Internet Explorer 中執行命令。

```
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>參數

*cmdID*<br/>
要執行的命令。

*cmdexecopt*<br/>
為執行命令所設定的選項。

*pvaIn*<br/>
用來指定命令輸入引數的 variant。

*pvaOut*<br/>
用來指定命令輸出引數的 variant。

### <a name="remarks"></a>備註

請參閱 Windows SDK 中的[IWebBrowser2:: ExecWB](/previous-versions//aa752117\(v=vs.85\)) 。

##  <a name="getaddressbar"></a>CHtmlView:: GetAddressBar

呼叫這個成員函式可抓取 Internet Explorer 的網址列。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>傳回值

如果網址列可見, 則為非零值;否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="getapplication"></a>  CHtmlView::GetApplication

呼叫這個成員函式, 以取出包含 WebBrowser 控制項之應用程式所支援的 automation 物件。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>傳回值

活動文檔物件`IDispatch`介面的指標。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getbusy"></a>CHtmlView:: GetBusy

呼叫這個成員函式, 以判斷 WebBrowser 控制項是否參與流覽或下載作業。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>傳回值

如果網頁瀏覽器忙碌, 則為非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getcontainer"></a>CHtmlView:: GetContainer

呼叫這個成員函式, 以抓取評估為 web 瀏覽器容器的物件。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>傳回值

活動文檔物件`IDispatch`介面的指標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getfullname"></a>CHtmlView:: 問題

呼叫這個成員函式, 以取得 Internet Explorer 目前顯示之檔案的完整路徑。

```
CString GetFullName() const;
```

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件, 其中包含目前所顯示檔案的路徑和名稱。 如果路徑和檔案名不存在, `GetFullName`則會傳回`CString`空的。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="getfullscreen"></a>CHtmlView:: GetFullScreen

呼叫這個成員函式, 以判斷 WebBrowser 控制項是否以全螢幕模式或標準視窗模式運作。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>傳回值

如果 WebBrowser 以全螢幕模式運作, 則為非零值;否則為零。

### <a name="remarks"></a>備註

在全螢幕模式中, Internet Explorer 主視窗會最大化, 而狀態列、工具列、功能表列和標題列則會隱藏起來。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getheight"></a>CHtmlView:: GetHeight

呼叫這個成員函式可抓取 WebBrowser 控制項框架視窗的高度 (以圖元為單位)。

```
long GetHeight() const;
```

### <a name="return-value"></a>傳回值

控制項的框架視窗高度 (以圖元為單位)。

##  <a name="gethtmldocument"></a>CHtmlView:: GetHtmlDocument

呼叫這個成員函式, 以取得使用中檔的 HTML 檔案。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>傳回值

活動文檔物件`IDispatch`介面的指標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getleft"></a>  CHtmlView::GetLeft

呼叫這個成員函式, 以抓取 WebBrowser 控制項的內部左邊緣和其容器左邊緣之間的距離。

```
long GetLeft() const;
```

### <a name="return-value"></a>傳回值

左邊緣距離 (以圖元為單位)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getlocationname"></a>CHtmlView:: GetLocationName

呼叫這個成員函式, 以取得顯示在 WebBrowser 中的資源名稱。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件, 其中包含 WebBrowser 中目前顯示的資源名稱。

### <a name="remarks"></a>備註

如果資源是萬維網上的 HTML 網頁, 此名稱就是該網頁的標題。 如果資源是網路或本機電腦上的資料夾或檔案, 則名稱會是資料夾或檔案的 UNC 或完整路徑。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getlocationurl"></a>CHtmlView:: GetLocationURL

呼叫這個成員函式, 以抓取 WebBrowser 控制項目前顯示的資源 URL。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件, 其中包含 WebBrowser 中目前顯示之資源的 URL。

### <a name="remarks"></a>備註

如果資源是網路或本機電腦上的資料夾或檔案, 則名稱會是資料夾或檔案的 UNC 或完整路徑。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getmenubar"></a>CHtmlView:: GetMenuBar

呼叫這個成員函式, 以判斷是否顯示功能表列。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

如果功能表列為可見, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getoffline"></a>  CHtmlView::GetOffline

呼叫這個成員函式, 以判斷 web 瀏覽器是否離線運作。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>傳回值

如果網頁瀏覽器目前離線, 則為非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getparentbrowser"></a>CHtmlView:: GetParentBrowser

呼叫這個成員函式可抓取 WebBrowser 控制項父物件的指標。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>傳回值

物件`IDispatch`介面的指標, 該物件為 WebBrowser 控制項的父系。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getproperty"></a>CHtmlView:: GetProperty

呼叫這個成員函式, 以取得目前與控制項相關聯之屬性的值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
字串的指標, 其中包含要抓取的屬性。

*strValue*<br/>
[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的參考, 這個物件會接收屬性的目前值。

### <a name="return-value"></a>傳回值

在第一個版本中, 如果成功完成, 則為非零;否則為零。 在第二個版本中, 是[COleVariant](../../mfc/reference/colevariant-class.md)物件。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getreadystate"></a>  CHtmlView::GetReadyState

呼叫這個成員函式, 以取得 WebBrowser 物件的就緒狀態。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>傳回值

[READYSTATE](/previous-versions//aa768362\(v=vs.85\))值, 如 Windows SDK 中所述。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasbrowser"></a>CHtmlView:: GetRegisterAsBrowser

呼叫這個成員函式, 以判斷 WebBrowser 物件是否註冊為目標名稱解析的最上層瀏覽器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>傳回值

如果瀏覽器註冊為最上層瀏覽器, 則為非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasdroptarget"></a>CHtmlView:: GetRegisterAsDropTarget

呼叫這個成員函式, 以判斷 WebBrowser 控制項是否註冊為導覽的放置目標。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>傳回值

如果瀏覽器註冊為放置目標, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getsilent"></a>CHtmlView:: GetSilent

呼叫這個成員函式, 以判斷是否可以在 WebBrowser 控制項中顯示任何對話方塊。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>傳回值

如果無法從 WebBrowser 控制項顯示對話方塊, 則為非零值。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getsource"></a>  CHtmlView::GetSource

呼叫這個成員函式, 以取得網頁的 HTML 原始程式碼。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="parameters"></a>參數

*refString*<br/>
將保存原始程式碼的[CString](../../atl-mfc-shared/reference/cstringt-class.md) 。

### <a name="remarks"></a>備註

此函式相當於 Internet Explorer 中的 "View Source" 命令, 不同之處在于原始碼會在中`CString`傳回。

##  <a name="getstatusbar"></a>CHtmlView:: GetStatusBar

呼叫這個成員函式, 以判斷 WebBrowser 控制項是否顯示狀態列。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>傳回值

如果可以顯示狀態列, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="gettheatermode"></a>CHtmlView:: GetTheaterMode

呼叫這個成員函式, 以判斷 web 瀏覽器是否處於劇院模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>傳回值

如果網頁瀏覽器處於劇院模式, 則為非零值;否則為零。

### <a name="remarks"></a>備註

當網頁瀏覽器處於劇院模式時, 瀏覽器主視窗會填滿整個畫面, 其中會顯示一組最少的導覽工具, 而狀態列會出現在畫面的右上角。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettoolbar"></a>CHtmlView:: GetToolBar

呼叫這個成員函式, 以判斷工具列是否可見。

```
int GetToolBar() const;
```

### <a name="return-value"></a>傳回值

值, 指出工具列是否可見。 如果工具列為可見, 則為非零值;否則為零。

##  <a name="gettop"></a>CHtmlView:: Vemap.gettop

呼叫這個成員函式可抓取 WebBrowser 控制項主視窗上邊緣的螢幕座標。

```
long GetTop() const;
```

### <a name="return-value"></a>傳回值

接收主視窗上邊緣之螢幕座標的變數位址。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettoplevelcontainer"></a>CHtmlView:: GetTopLevelContainer

呼叫這個成員函式, 以判斷 Internet Explorer 是否為 WebBrowser 控制項的最上層容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>傳回值

非零: 容器是最上層容器;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettype"></a>CHtmlView:: GetType

呼叫這個成員函式來抓取包含的使用中檔的型別名稱。

```
CString GetType() const;
```

### <a name="return-value"></a>傳回值

[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件, 其中包含所包含之使用中的檔案的類型名稱。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getvisible"></a>CHtmlView:: GetVisible

呼叫這個成員函式, 以判斷包含的物件是否為可見的。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>傳回值

如果物件為可見, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getwidth"></a>CHtmlView:: GetWidth

擷取 Internet Explorer 主視窗的寬度。

```
long GetWidth() const;
```

### <a name="return-value"></a>傳回值

目前視窗的寬度 (以圖元為單位)。

##  <a name="goback"></a>CHtmlView:: GoBack

在歷程記錄清單中向後導覽一個專案。

```
void GoBack();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="goforward"></a>CHtmlView:: GoForward

在歷程記錄清單中向前導覽一個專案。

```
void GoForward();
```

##  <a name="gohome"></a>CHtmlView:: GoHome

巡覽至目前的首頁或起始頁，這是在 Internet Explorer [網際網路選項] 對話方塊或 [網際網路內容] 對話方塊中指定，從控制台存取。

```
void GoHome();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gosearch"></a>CHtmlView:: GoSearch

流覽至目前的 [搜尋] 頁面 (如 Internet Explorer [網際網路選項] 對話方塊或 [網際網路內容] 對話方塊中所指定), 並從 [控制台] 存取。

```
void GoSearch();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="loadfromresource"></a>CHtmlView:: LoadFromResource

呼叫這個成員函式, 將指定的資源載入 WebBrowser 控制項。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>參數

*lpszResource*<br/>
字串的指標, 其中包含要載入之資源的名稱。

*nRes*<br/>
緩衝區的識別碼, 其中包含要載入之資源的名稱。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="navigate"></a>CHtmlView:: 導覽

呼叫這個成員函式, 以流覽至 URL 所識別的資源。

```
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>參數

*URL*<br/>
呼叫端配置的字串, 其中包含要流覽的 URL, 或是要顯示之檔案的完整路徑。

*dwFlags*<br/>
變數的旗標, 指定是否要將資源加入至歷程記錄清單、是否要讀取或寫入快取, 以及是否要在新視窗中顯示資源。 變數可以是[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))列舉所定義之值的組合。

*lpszTargetFrameName*<br/>
字串的指標, 其中包含要在其中顯示資源的框架名稱。

*lpszHeaders*<br/>
值的指標, 指定要傳送至伺服器的 HTTP 標頭。 這些標頭會新增至預設的 Internet Explorer 標頭。 標頭可以指定伺服器所需的動作、要傳遞至伺服器的資料類型, 或狀態碼等專案。 如果*URL*不是 HTTP url, 則會忽略這個參數。

*lpvPostData*<br/>
要與 HTTP POST 交易一起傳送之資料的指標。 例如, POST transaction 是用來傳送 HTML 表單所收集的資料。 如果此參數未指定任何張貼資料, `Navigate`則會發出 HTTP GET 交易。 如果*URL*不是 HTTP url, 則會忽略這個參數。

*dwPostDataLen*<br/>
要與 HTTP POST 交易一起傳送的資料。 例如, POST transaction 是用來傳送 HTML 表單所收集的資料。 如果此參數未指定任何張貼資料, `Navigate`則會發出 HTTP GET 交易。 如果*URL*不是 HTTP url, 則會忽略這個參數。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="navigate2"></a>  CHtmlView::Navigate2

呼叫這個成員函式, 以流覽至 URL 所識別的資源, 或導覽至完整路徑所識別的檔案。

```
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>參數

*pIDL*<br/>
[ITEMIDLIST](/windows/desktop/api/shtypes/ns-shtypes-itemidlist)結構的指標。

*dwFlags*<br/>
變數的旗標, 指定是否要將資源加入至歷程記錄清單、是否要讀取或寫入快取, 以及是否要在新視窗中顯示資源。 變數可以是[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))列舉所定義之值的組合。

*lpszTargetFrameName*<br/>
字串的指標, 其中包含要在其中顯示資源的框架名稱。

*lpszURL*<br/>
包含 URL 之字串的指標。

*lpvPostData*<br/>
要與 HTTP POST 交易一起傳送的資料。 例如, POST transaction 是用來傳送 HTML 表單所收集的資料。 如果此參數未指定任何張貼資料, `Navigate2`則會發出 HTTP GET 交易。 如果*url*不是 HTTP 或 HTTPS url, 則會忽略這個參數。

*dwPostDataLen*<br/>
*LpvPostData*參數所指向的資料長度 (以位元組為單位)。

*lpszHeaders*<br/>
值的指標, 指定要傳送至伺服器的 HTTP 或 HTTPS 標頭。 這些標頭會新增至預設的 Internet Explorer 標頭。 標頭可以指定伺服器所需的動作、要傳遞至伺服器的資料類型, 或狀態碼等專案。 如果*url*不是 HTTP 或 HTTPS url, 則會忽略這個參數。

*baPostedData*<br/>
[CByteArray](../../mfc/reference/cbytearray-class.md)物件的參考。

### <a name="remarks"></a>備註

此成員函式會`Navigate`藉由支援流覽以*pIDL*參數所表示的特殊資料夾 (例如 Desktop 和我的電腦) 來擴充成員函式。

適用於 Internet Explorer 和 WebBrowser。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

##  <a name="onbeforenavigate2"></a>CHtmlView:: OnBeforeNavigate2

此成員函式是由架構呼叫, 以在瀏覽器發生流覽之前引發事件。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
字串的指標, 其中包含要流覽的 URL。

*nFlags*<br/>
保留供未來使用。

*lpszTargetFrameName*<br/>
字串, 包含要在其中顯示資源的框架名稱, 如果沒有任何命名的框架是以資源為目標, 則為 Null。

*baPostedData*<br/>
`CByteArray`物件的參考, 如果正在使用 HTTP POST 交易, 則包含要傳送至伺服器的資料。

*lpszHeaders*<br/>
字串的指標, 其中包含要傳送至伺服器的其他 HTTP 標頭 (僅限 HTTP Url)。 標頭可以指定伺服器所需的動作、要傳遞至伺服器的資料類型, 或狀態碼等專案。

*pbCancel*<br/>
取消旗標的指標。 應用程式可以將此參數設定為非零, 以取消導覽作業, 或設為零以允許它繼續進行。

##  <a name="oncommandstatechange"></a>CHtmlView:: OnCommandStateChange

此成員函式會由架構呼叫, 以通知應用程式 web 瀏覽器命令的啟用狀態已變更。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>參數

*nCommand*<br/>
已變更其已啟用狀態的命令識別碼。

*bEnable*<br/>
[已啟用] 狀態。 如果已啟用命令, 此參數為非零, 如果已停用則為零。

##  <a name="ondocumentcomplete"></a>CHtmlView:: OnDocumentComplete

此成員函式會由架構呼叫, 以通知應用程式檔已達到 READYSTATE_COMPLETE 狀態。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
字串的指標, 其會評估為流覽至的 URL、UNC 檔案名, 或 PIDL (專案識別碼清單的指標)。

### <a name="remarks"></a>備註

並非每個畫面格都會引發此事件, 但引發[OnDownloadBegin](#ondownloadbegin)事件的每個畫面格都會`OnDocumentComplete`引發對應的事件。

*LpszURL*所指出的 url 可能與瀏覽器被告知要流覽的 url 不同, 因為此 url 是正式且完整的 url。 例如, 如果應用程式在對[導覽](#navigate)或[Navigate2](#navigate2)的呼叫中指定 "www.microsoft.com" 的 url, 則傳遞的`OnNavigateComplete2` url 將會是 "<http://www.microsoft.com/>"。 此外, 如果伺服器已將瀏覽器重新導向至不同的 URL, 重新導向的 URL 將會反映在這裡。

##  <a name="ondocwindowactivate"></a>  CHtmlView::OnDocWindowActivate

從 Internet Explorer 或 MSHTML 的`IOleInPlaceActiveObject::OnDocWindowActivate`執行呼叫, 這會在容器的文件視窗啟動或停用時, 通知作用中的就地物件。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*fActivate*<br/>
指出文件視窗的狀態。 如果此值為非零, 則會啟動視窗。 如果此值為零, 則會停用視窗。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnDocWindowActivate`寫以回應 Microsoft `OnDocWindowActivate` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: ondocwindowactivate 呼叫](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\))。

##  <a name="ondownloadbegin"></a>CHtmlView:: OnDownloadBegin

此成員函式是由架構呼叫, 以開始下載檔案。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>備註

除非流覽已取消, 否則在[OnBeforeNavigate2](#onbeforenavigate2)事件之後很快就會引發此事件。 容器需要顯示的任何動畫或「忙碌」指示都應該連接到此事件。

##  <a name="ondownloadcomplete"></a>CHtmlView:: OnDownloadComplete

此成員函式是由架構呼叫, 表示導覽作業已完成、已停止或失敗。

```
virtual void OnDownloadComplete();
```

##  <a name="onenablemodeless"></a>CHtmlView:: OnEnableModeless

當 Internet Explorer 或 MSHTML 顯示強制回應 UI 時呼叫。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>參數

*fEnable*<br/>
指出主機的非強制回應對話方塊為啟用或停用。 如果這個值不是零, 則會啟用非強制回應對話方塊。 如果此值為零, 則會停用非強制回應對話方塊。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

當容器建立或終結強制回應對話方塊時, 啟用或停用非強制回應對話方塊。 覆`OnEnableModeless`寫以回應 Microsoft `EnableModeless` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: EnableModeless](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\)) 。

##  <a name="onfilterdataobject"></a>CHtmlView:: OnFilterDataObject

Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>參數

*pDataObject*<br/>
Internet Explorer 或 MSHTML 所提供的[IDataObject](/windows/desktop/api/objidl/nn-objidl-idataobject)介面位址。

*ppDataObject*<br/>
接收主機所提供`IDataObject`之介面指標的位址。 即使方法失敗, 此參數的內容也應一律初始化為 Null。

### <a name="return-value"></a>傳回值

如果已取代資料物件, 則為 S_OK, 如果未取代資料物件, 則為 S_FALSE, 如果發生錯誤則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnFilterDataObject`寫以回應 Microsoft `FilterDataObject` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: FilterDataObject](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\)) 。

##  <a name="onframewindowactivate"></a>CHtmlView:: Onframewindowactivate 呼叫

從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*fActivate*<br/>
表示容器最上層框架視窗的狀態。 如果此值為非零, 則會啟動視窗。 如果此值為零, 則會停用視窗。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnFrameWindowActivate`寫以回應 Microsoft `OnFrameWindowActivate` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: onframewindowactivate 呼叫](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\))。

##  <a name="onfullscreen"></a>CHtmlView:: OnFullScreen

當[全螢幕](/previous-versions/aa752119\(v=vs.85\))屬性變更時, 架構會呼叫這個成員函式。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>參數

*bFullScreen*<br/>
如果 Internet Explorer 處於全螢幕模式, 則為非零;否則為零。

##  <a name="ongetdroptarget"></a>  CHtmlView::OnGetDropTarget

當它用做為置放目標，讓主機提供另一個 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>參數

*pDropTarget*<br/>
[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)建議使用 Internet Explorer 或 MSHTML。

*ppDropTarget*<br/>
接收主機想`IDropTarget`要提供之介面指標的位址。`IDropTarget`

### <a name="return-value"></a>傳回值

如需傳回碼的清單, 請參閱 Windows SDK 中的[IDocHostUIHandler:: GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) 。

### <a name="remarks"></a>備註

覆`OnGetDropTarget`寫以回應 Microsoft `GetDropTarget` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) 。

##  <a name="ongetexternal"></a>CHtmlView:: OnGetExternal

由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>參數

*lppDispatch*<br/>
接收主應用程式`IDispatch`介面指標之位址的指標。 如果主機公開自動化介面, 它可以透過此參數提供對 Internet Explorer 或 MSHTML 的參照。 即使方法失敗, 此參數的內容也應一律初始化為 Null。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnGetExternal`寫以回應 Microsoft `GetExternal` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: GetExternal](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\)) 。

##  <a name="ongethostinfo"></a>CHtmlView:: OnGetHostInfo

擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>參數

*pInfo*<br/>
接收主機 UI 功能之[DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnGetHostInfo`寫以回應 Microsoft `GetHostInfo` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: GetHostInfo](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\)) 。

##  <a name="ongetoptionkeypath"></a>  CHtmlView::OnGetOptionKeyPath

呼叫這個成員函式, 以取得 Internet Explorer 或 MSHTML 用來儲存使用者喜好設定的登錄機碼。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>參數

*pchKey*<br/>
的位址, 它會接收登錄子機碼字串, 其中主機會儲存其預設選項。 `LPOLESTR` 這個子機碼將會在 HKEY_CURRENT_USER 金鑰之下。 使用[CoTaskMemAlloc](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc)配置此記憶體。 呼叫應用程式會負責使用[CoTaskMemFree](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree)釋放此記憶體。 即使方法失敗, 此參數也應一律初始化為 Null。

*dwReserved*<br/>
保留供未來使用。 目前未使用。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 S_FALSE。 如果是 S_FALSE, Internet Explorer 或 MSHTML 會預設為它自己的使用者選項。

### <a name="remarks"></a>備註

覆`OnGetOptionKeyPath`寫以回應 Microsoft `GetOptionKeyPath` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: GetOptionKeyPath](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\)) 。

##  <a name="onhideui"></a>CHtmlView:: OnHideUI

當 Internet Explorer 或 MSHTML 移除其功能表和工具列時, 架構會呼叫這個成員函式。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnHideUI`寫以回應 Microsoft `HideUI` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: HideUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\)) 。

##  <a name="onmenubar"></a>CHtmlView:: OnMenuBar

當[MenuBar](/previous-versions/aa752131\(v=vs.85\))屬性變更時, 架構會呼叫這個成員函式。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>參數

*bMenuBar*<br/>
如果 Internet Explorer 功能表列為可見, 則為非零。否則為零。

##  <a name="onnavigatecomplete2"></a>CHtmlView:: OnNavigateComplete2

此成員函式會在導覽至超連結完成 (在視窗或框架專案上) 之後, 由架構呼叫。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>參數

*strURL*<br/>
評估為流覽至之 URL、UNC 檔案名或 PIDL (專案識別碼清單的指標) 的字串運算式。

### <a name="remarks"></a>備註

如果沒有 URL 標記法的 shell name space 實體, 則 URL 參數可以是 PIDL。

請注意, *strURL*中包含的 url 可能會與瀏覽器被告知要導覽的 url 不同, 因為此 url 是正式且完整的 url。 例如, 如果應用程式在對[導覽](#navigate)或[Navigate2](#navigate2)的呼叫中指定 "www.microsoft.com" 的 url, 則傳遞的`OnNavigateComplete2` url 將會是 "<http://www.microsoft.com/>"。 此外, 如果伺服器已將瀏覽器重新導向至不同的 URL, 重新導向的 URL 將會反映在這裡。

##  <a name="onnavigateerror"></a>CHtmlView:: OnNavigateError

巡覽至超連結失敗時，由架構呼叫。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
流覽失敗的 URL。

*lpszFrame*<br/>
要在其中顯示資源的框架名稱, 如果沒有任何命名的框架是以資源為目標, 則為 Null。

*dwError*<br/>
錯誤狀態碼 (如果有的話)。 如需可能的 HRESULT 和 HTTP 狀態碼的清單, 請參閱[NavigateError 事件狀態碼。](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\))

*pbCancel*<br/>
指定是否要取消導覽至錯誤頁面或任何進一步的 autosearch。 如果為 TRUE (預設值), 請繼續導覽至錯誤頁面或 autosearch。如果為 FALSE, 則取消導覽至錯誤頁面或 autosearch。

### <a name="remarks"></a>備註

覆寫這個方法, 以提供自訂導覽錯誤處理。

如需詳細資訊, 請參閱[DWebBrowserEvents2:: NavigateError](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

##  <a name="onnewwindow2"></a>CHtmlView:: OnNewWindow2

建立新視窗以顯示資源時, 架構會呼叫這個成員函式。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>參數

*ppDisp*<br/>
介面指標的指標, 可選擇性地接收新的 WebBrowser `IDispatch`或 Internet Explorer 物件的介面指標。

*取消*<br/>
取消旗標的指標。 應用程式可以將此參數設定為非零, 以取消導覽作業, 或設為零以允許它繼續進行。

### <a name="remarks"></a>備註

這個事件會在 WebBrowser 中建立新的視窗之前。

##  <a name="onprogresschange"></a>CHtmlView:: OnProgressChange

此成員函式會由架構呼叫, 以通知應用程式已更新下載作業的進度。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>參數

*nProgress*<br/>
要顯示的總進度數, 或在完成進度時為-1。

*nProgressMax*<br/>
最大進度值。

### <a name="remarks"></a>備註

容器可以使用此事件所提供的資訊, 顯示到目前為止下載的位元組數, 或更新進度指示器。

##  <a name="onpropertychange"></a>CHtmlView:: OnPropertyChange

此成員函式會由架構呼叫, 以通知應用程式[PutProperty](#putproperty)已變更屬性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
包含屬性名稱之字串的指標。

##  <a name="onquit"></a>CHtmlView:: OnQuit

此成員函式會由架構呼叫, 以通知應用程式 Internet Explorer 應用程式已準備好結束。

```
virtual void OnQuit();
```

##  <a name="onresizeborder"></a>CHtmlView:: OnResizeBorder

從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>參數

*prcBorder*<br/>
框線空間的新外部矩形。

*pUIWindow*<br/>
框架或文件視窗物件的介面指標, 其框線已變更。

*fFrameWindow*<br/>
如果框架視窗呼叫[IOleInPlaceActiveObject:: resizeborder 呼叫](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder), 則為 TRUE, 否則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnResizeBorder`寫以回應 Microsoft `ResizeBorder` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: resizeborder 呼叫](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\))。

##  <a name="onshowcontextmenu"></a>CHtmlView:: OnShowCoNtextMenu

當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>參數

*dwID*<br/>
要顯示之內容功能表的識別碼。 如`IDocHostUIHandler::ShowContextMenu`需值清單, 請參閱 Windows SDK 中的。

*ppt*<br/>
功能表的螢幕座標。

*pcmdtReserved*<br/>
[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)介面, 用來查詢此物件上的命令狀態和執行命令。

*pdispReserved*<br/>
位於螢幕座標之物件的 IDispatch 介面。 這可讓主機區分特定物件, 以提供更具體的內容。

### <a name="return-value"></a>傳回值

如需值清單, 請參閱 Windows SDK 中的[IDocHostUIHandler:: ShowCoNtextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) 。

### <a name="remarks"></a>備註

覆`OnShowContextMenu`寫以回應 Microsoft `ShowContextMenu` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: ShowCoNtextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) 。

##  <a name="onshowui"></a>CHtmlView:: OnShowUI

在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>參數

*dwID*<br/>
保留供未來使用。

*pActiveObject*<br/>
目前現用物件的[IOleInPlaceActiveObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceactiveobject)介面。

*pCommandTarget*<br/>
物件的[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)介面。

*pFrame*<br/>
物件的[IOleInPlaceFrame](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceframe)介面。 這是功能表和工具列的必要程式。

*pDoc*<br/>
物件的[IOleInPlaceUIWindow](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceuiwindow)介面。 這是工具列的必要程式。

### <a name="return-value"></a>傳回值

如需值清單, 請參閱 Windows SDK 中的[IDocHostUIHandler:: ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) 。

### <a name="remarks"></a>備註

覆`OnShowUI`寫以回應 Microsoft `ShowUI` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) 。

##  <a name="onstatusbar"></a>CHtmlView:: OnStatusBar

當[狀態列](/previous-versions//aa768270\(v=vs.85\))屬性變更時, 架構會呼叫這個成員函式。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>參數

*bStatusBar*<br/>
如果顯示 Internet Explorer 的狀態列, 則為非零, 否則為零。

##  <a name="onstatustextchange"></a>CHtmlView:: OnStatusTextChange

架構會呼叫這個成員函式, 以通知應用程式, 與 WebBrowser 控制項相關聯的狀態列文字已經變更。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
包含新狀態列文字的字串。

##  <a name="ontheatermode"></a>CHtmlView:: OnTheaterMode

當[TheaterMode](/previous-versions/aa768273\(v=vs.85\))屬性變更時, 架構會呼叫這個成員函式。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>參數

*bTheaterMode*<br/>
如果 Internet Explorer 處於劇院模式, 則為非零值;否則為零。

##  <a name="ontitlechange"></a>CHtmlView:: OnTitleChange

此成員函式會由架構呼叫, 以在 WebBrowser 控制項中的檔標題變成可用或變更時通知應用程式。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
新的檔標題。

### <a name="remarks"></a>備註

若為 HTML, 標題可能會變更;當 HTML 仍在下載時, 會將檔的 URL 設定為標題。 從 HTML 剖析真實的標題 (如果有的話) 之後, 標題會變更以反映實際的標題。

##  <a name="ontoolbar"></a>CHtmlView:: OnToolBar

當[ToolBar](/previous-versions/aa768274\(v=vs.85\))屬性變更時, 架構會呼叫這個成員函式。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>參數

*bToolBar*<br/>
如果 Internet Explorer 工具列為可見, 則為非零, 否則為零。

##  <a name="ontranslateaccelerator"></a>CHtmlView:: OnTranslateAccelerator

當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
指向可能需要轉譯的訊息。

*pguidCmdGroup*<br/>
命令群組識別碼。

*nCmdID*<br/>
命令識別碼。

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 S_FALSE。

### <a name="remarks"></a>備註

覆`OnTranslateAccelerator`寫以回應 Microsoft `TranslateAccelerator` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: TranslateAccelerator](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\)) 。

##  <a name="ontranslateurl"></a>CHtmlView:: OnTranslateUrl

由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>參數

*dwTranslate*<br/>
保留供未來使用。

*pchURLIn*<br/>
由 Internet Explorer 或 MSHTML 提供的字串位址, 代表要轉譯的 URL。

*ppchURLOut*<br/>
接收翻譯 URL 位址的字串指標的位址。 主機會使用工作記憶體配置器來配置緩衝區。 即使未轉譯 URL 或方法失敗, 此參數的內容也應該一律初始化為 Null。

### <a name="return-value"></a>傳回值

`S_OK`如果 URL 已轉譯, 則為 S_FALSE, 如果 URL 未轉譯, 則為 S_FALSE, 如果發生錯誤則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

覆`OnTranslateUrl`寫以回應 Microsoft `TranslateUrl` Web Browser 控制項的通知。 如需詳細資訊, 請參閱 Windows SDK 中的[IDocHostUIHandler:: TranslateUrl](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) 。

##  <a name="onupdateui"></a>CHtmlView:: OnUpdateUI

通知主機命令狀態已變更。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>傳回值

如果成功, 則為 S_OK, 否則為 OLE 定義的錯誤碼。

### <a name="remarks"></a>備註

主機應該會更新工具列按鈕的狀態。 無論的傳回值`ShowUI`為何, 都會呼叫這個方法。 覆`OnUpdateUI`寫以回應 Microsoft `UpdateUI` Web Browser 控制項的通知。

##  <a name="onvisible"></a>CHtmlView:: OnVisible

當 WebBrowser 的視窗應該顯示或隱藏時, 架構會呼叫這個成員函式。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>參數

*bVisible*<br/>
如果物件為可見, 則為非零, 否則為零。

### <a name="remarks"></a>備註

這可讓 [物件控制主機] 視窗的行為, 與 Internet Explorer 視窗的行為方式相同。

##  <a name="putproperty"></a>CHtmlView::P utProperty

呼叫這個成員函式, 以設定與指定物件相關聯的屬性。

```
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
字串, 包含要設定的屬性。

*vtValue*<br/>
*LpszProperty*所指示之屬性的新值。

*lpszPropertyName*<br/>
字串的指標, 其中包含要設定的屬性名稱。

*dValue*<br/>
屬性的新值。

*lValue*<br/>
屬性的新值。

*lpszValue*<br/>
包含屬性新值之字串的指標。

*nValue*<br/>
屬性的新值。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="queryformscommand"></a>CHtmlView:: QueryFormsCommand

查詢使用者介面事件所產生之一或多個命令的狀態。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
正在查詢之命令的識別碼。

*pbSupported*<br/>
布林值的指標, 指定是否支援命令 (由*dwCommandID*識別)。 若為 TRUE, 則支援命令;否則為 FALSE。

*pbEnabled*<br/>
布林值的指標, 指定是否啟用命令 (由*dwCommandID*識別)。 若為 TRUE, 則支援命令;否則為 FALSE。

*pbChecked*<br/>
布林值的指標, 指定是否檢查命令 (由*dwCommandID*識別)。 若為 TRUE, 則支援命令;否則為 FALSE。

### <a name="return-value"></a>傳回值

標準的 HRESULT 值。 如需可能值的完整清單, 請參閱 Windows SDK 中的[IOleCommandTarget:: QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus) 。

### <a name="remarks"></a>備註

`QueryFormsCommand`[執行 IOleCommandTarget:: QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行為。

##  <a name="querystatuswb"></a>CHtmlView:: QueryStatusWB

呼叫這個成員函式來查詢命令狀態。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>參數

*cmdID*<br/>
呼叫端需要其狀態資訊之命令的[OLECMDID](/windows/desktop/api/docobj/ne-docobj-olecmdid)值。

### <a name="return-value"></a>傳回值

接收命令狀態之[OLECMDF](/windows/desktop/api/docobj/ne-docobj-olecmdf)值的位址。

### <a name="remarks"></a>備註

`QueryStatusWB`[執行 IOleCommandTarget:: QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行為。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="refresh"></a>  CHtmlView::Refresh

重載網頁瀏覽器目前顯示的 URL 或檔案。

```
void Refresh();
```

### <a name="remarks"></a>備註

`Refresh`不包含用於設定重新整理層級的參數。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="refresh2"></a>  CHtmlView::Refresh2

重載 Internet Explorer 目前顯示的檔案。

```
void Refresh2(int nLevel);
```

### <a name="parameters"></a>參數

*nLevel*<br/>
指定重新整理層級之變數的位址。 可能的變數定義于[RefreshConstants](/previous-versions/aa768363\(v=vs.85\))中的 Windows SDK。

### <a name="remarks"></a>備註

與[refresh](#refresh)不同`Refresh2`的是, 包含指定重新整理層級的參數。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setaddressbar"></a>  CHtmlView::SetAddressBar

呼叫這個成員函式, 以顯示或隱藏 Internet Explorer 物件的網址列。

```
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零以顯示網址列;否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="setfullscreen"></a>CHtmlView:: SetFullScreen

呼叫這個成員函式, 將 Internet Explorer 設定為全螢幕或一般視窗模式。

```
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
全螢幕模式為非零值;否則為零。

### <a name="remarks"></a>備註

在全螢幕模式中, Internet Explorer 主視窗會最大化, 而狀態列、工具列、功能表列和標題列則會隱藏起來。

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="setheight"></a>CHtmlView:: SetHeight

呼叫這個成員函式可設定 Internet Explorer 主視窗的高度。

```
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
主視窗的高度 (以圖元為單位)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setleft"></a>  CHtmlView::SetLeft

設定 Internet Explorer 主視窗的水平位置。

```
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
主視窗左邊緣的螢幕座標。

##  <a name="setmenubar"></a>CHtmlView:: SetMenuBar

呼叫這個成員函式, 以顯示或隱藏 Internet Explorer 功能表列。

```
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
要顯示功能表列的非零值;否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="setoffline"></a>  CHtmlView::SetOffline

呼叫這個成員函式來設定值, 指出 WebBrowser 控制項目前是否以離線模式運作。

```
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
從本機快取讀取非零值;否則為零。

### <a name="remarks"></a>備註

在離線模式中, 瀏覽器會從本機快取讀取 HTML 頁面, 而不是從來源文件。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasbrowser"></a>CHtmlView:: SetRegisterAsBrowser

呼叫這個成員函式來設定值, 指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器。

```
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
決定 Internet Explorer 是否註冊為最上層瀏覽器。 如果是非零值, 則會將網頁瀏覽器註冊為最上層瀏覽器;如果為零, 則不是最上層瀏覽器。 預設值是零。

### <a name="remarks"></a>備註

最上層瀏覽器是在登錄中設定為預設瀏覽器的瀏覽器。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasdroptarget"></a>CHtmlView:: SetRegisterAsDropTarget

呼叫這個成員函式來設定值, 指出 WebBrowser 控制項是否註冊為導覽的放置目標。

```
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
判斷 WebBrowser 控制項是否註冊為導覽的放置目標。 如果是非零值, 則會將物件註冊為放置目標;如果為零, 則不是放置目標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setsilent"></a>CHtmlView:: SetSilent

呼叫這個成員函式來設定值, 指出是否可以顯示任何對話方塊。

```
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
如果是非零值, 則不會顯示對話方塊;如果為零, 則會顯示對話方塊。 預設值是零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setstatusbar"></a>CHtmlView:: SetStatusBar

呼叫這個成員函式以顯示狀態列。

```
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
如果狀態列可見, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="settheatermode"></a>CHtmlView:: SetTheaterMode

呼叫這個成員函式來設定值, 指出 WebBrowser 控制項是否處於劇院模式。

```
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零值, 將 WebBrowser 控制項設定為劇院模式;否則為零。 預設值是零。

### <a name="remarks"></a>備註

當網頁瀏覽器處於劇院模式時, 瀏覽器主視窗會填滿整個畫面, 其中會顯示一組最少的導覽工具, 而狀態列會出現在畫面的右上角。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="settoolbar"></a>CHtmlView:: SetToolBar

呼叫這個成員函式, 以顯示或隱藏 Internet Explorer 工具列。

```
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
指出是否要顯示工具列。 如果要顯示工具列, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用于 Internet Explorer。 如果您使用此呼叫搭配 WebBrowser 控制項, 它將不會傳回任何錯誤, 但會忽略此呼叫。

##  <a name="settop"></a>CHtmlView:: SetTop

呼叫這個成員函式, 設定 WebBrowser 控制項的內部邊緣和其容器的上邊緣之間的距離。

```
void SetTop(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
主視窗上邊緣的螢幕座標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setvisible"></a>CHtmlView:: SetVisible

呼叫這個成員函式可設定 WebBrowser 控制項的可見度狀態。

```
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
如果控制項為可見, 則為非零。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setwidth"></a>CHtmlView:: SetWidth

設定 Internet Explorer 主視窗的寬度。

```
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
Internet Explorer 主視窗的寬度 (以圖元為單位)。

##  <a name="stop"></a>CHtmlView:: Stop

呼叫這個成員函式可取消任何暫止的流覽或下載作業, 並停止任何動態頁面元素, 例如背景音效和動畫。

```
void Stop();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>另請參閱

[MFC 範例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView 類別](../../mfc/reference/cformview-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/desktop/api/exdisp/nn-exdisp-iwebbrowser2)
