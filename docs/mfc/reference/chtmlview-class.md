---
title: CHtmlView 類別
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 14f92e51ecf776aad5312335dade7dfcd154c3eb
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81352042"
---
# <a name="chtmlview-class"></a>CHtmlView 類別

在 MFC 的文件/檢視架構內容中提供 WebBrowser 控制項的功能。

## <a name="syntax"></a>語法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CHtmlView:建立](#create)|建立 WebBrowser 控制項。|
|[CHtmlView:建立控制網站](#createcontrolsite)|可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。|
|[CHtmlView::執行形式指令](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法執行指定的命令。|
|[CHtmlView::執行WB](#execwb)|執行命令。|
|[CHtmlView:抓取位址列](#getaddressbar)|決定是否顯示 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:抓取應用程式](#getapplication)|擷取代表應用程式的應用程式物件，此應用程式包含 Internet Explorer 應用程式目前的執行個體。|
|[CHtmlView:取得忙碌](#getbusy)|擷取指出下載或其他活動是否仍在進行中的值。|
|[CHtmlView:抓取容器](#getcontainer)|擷取 WebBrowser 控制項的容器。|
|[CHtmlView:取得全名](#getfullname)|擷取顯示在網頁瀏覽器中的資源完整名稱，包括路徑。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:抓取全螢幕](#getfullscreen)|指出 WebBrowser 控制項是在全螢幕模式或標準視窗模式中操作。|
|[CHtmlView:取得高度](#getheight)|擷取 Internet Explorer 主視窗的高度。|
|[CHtmlView:取得 Html 文件](#gethtmldocument)|擷取使用中的 HTML 文件。|
|[CHtmlView:取得左](#getleft)|擷取 Internet Explorer 主視窗左邊緣的螢幕座標。|
|[CHtmlView:取得位置名稱](#getlocationname)|擷取 WebBrowser 目前顯示的資源名稱。|
|[CHtmlView:取得位置網址](#getlocationurl)|擷取 WebBrowser 目前顯示的資源 URL。|
|[CHtmlView:取得選單列](#getmenubar)|擷取決定是否顯示功能表列的值。|
|[CHtmlView:離線](#getoffline)|擷取決定控制項是否離線的值。|
|[CHtmlView:抓取父瀏覽器](#getparentbrowser)|擷取 `IDispatch` 介面的指標。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView:抓取屬性](#getproperty)|擷取與指定物件相關聯屬性目前的值。|
|[CHtmlView::準備狀態](#getreadystate)|擷取網頁瀏覽器物件的就緒狀態。|
|[CHtmlView:取得註冊瀏覽器](#getregisterasbrowser)|指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器進行。|
|[CHtmlView::取得註冊作為刪除目標](#getregisterasdroptarget)|指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView:獲得沉默](#getsilent)|指出是否可顯示所有對話方塊。|
|[CHtmlView:取得來源](#getsource)|網頁的 HTML 原始程式碼。|
|[CHtmlView:取得狀態列](#getstatusbar)|指出是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:取得劇場模式](#gettheatermode)|指出 WebBrowser 控制項是否為劇場模式。|
|[CHtmlView:抓取工具列](#gettoolbar)|擷取決定是否顯示工具列的值。|
|[CHtmlView:取得頂端](#gettop)|擷取 Internet Explorer 主視窗上邊緣的螢幕座標。|
|[CHtmlView:取得頂層](#gettoplevelcontainer)|擷取值，指出目前的物件是否為 WebBrowser 控制項的最上層容器。|
|[CHtmlView:取得類型](#gettype)|擷取文件物件的類型名稱。|
|[CHtmlView:取得可見](#getvisible)|擷取指出物件為顯示或隱藏的值。|
|[CHtmlView:取得寬度](#getwidth)|擷取 Internet Explorer 主視窗的寬度。|
|[CHtmlView:傳回](#goback)|在歷程清單中巡覽至上一個項目。|
|[CHtmlView:前進](#goforward)|在歷程清單中巡覽至下一個項目。|
|[CHtmlView::GoHome](#gohome)|巡覽至目前的首頁或起始頁面。|
|[CHtmlView:GoSearch](#gosearch)|巡覽至目前的搜尋頁面。|
|[CHtmlView:從資源載入](#loadfromresource)|載入 WebBrowser 控制項的資源。|
|[CHtmlView:導覽](#navigate)|巡覽至依 URL 找到的資源。|
|[CHtmlView:導航2](#navigate2)|巡覽至依 URL 找到的資源或依完整路徑找到的檔案。|
|[CHtmlView::在導航前2](#onbeforenavigate2)|在給定的 WebBrowser 中發生巡覽前呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView:在命令狀態變更](#oncommandstatechange)|呼叫以通知應用程式， 網頁瀏覽器命令啟用的狀態已經變更。|
|[CHtmlView:在文件完成](#ondocumentcomplete)|調用 以通知應用程式文件已達到READYSTATE_COMPLETE狀態。|
|[CHtmlView:在DocWindow啟動](#ondocwindowactivate)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::OnDocWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)呼叫，這會在容器文件視窗啟用或停用時，通知使用中的就地物件。|
|[CHtmlView::下載開始](#ondownloadbegin)|呼叫以通知應用程式，巡覽作業已經啟動。|
|[CHtmlView:下載完成](#ondownloadcomplete)|當巡覽作業結束、暫止或失敗時呼叫。|
|[CHtmlView:啟用無模式](#onenablemodeless)|當容器建立或終結強制回應對話方塊時，呼叫以啟用或停用非強制回應對話方塊。|
|[CHtmlView:在篩選資料物件上](#onfilterdataobject)|Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。|
|[CHtmlView:在框架視窗啟動](#onframewindowactivate)|從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。|
|[CHtmlView:全屏](#onfullscreen)|當 FullScreen 屬性變更時呼叫。|
|[CHtmlView::OnGetDropTarget](#ongetdroptarget)|當它用做為置放目標，讓主機提供另一個 [IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::開啟外部](#ongetexternal)|由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。|
|[CHtmlView::OngetHostinfo](#ongethostinfo)|擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。|
|[CHtmlView::在取得選項關鍵路徑](#ongetoptionkeypath)|傳回 Internet Explorer 或 MSHTML 儲存使用者喜好設定的登錄機碼。|
|[CHtmlView::打開隱藏UI](#onhideui)|當 Internet Explorer 或 MSHTML 移除其功能表與工具列時呼叫。|
|[CHtmlView::在Menubar上](#onmenubar)|當 MenuBar 屬性變更時呼叫。|
|[CHtmlView::導航完成2](#onnavigatecomplete2)|超連結的巡覽完畢後呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView:在瀏覽錯誤](#onnavigateerror)|巡覽至超連結失敗時，由架構呼叫。|
|[CHtmlView::開啟新視窗2](#onnewwindow2)|當為顯示資源而建立新視窗時呼叫。|
|[CHtmlView::在進度更改上](#onprogresschange)|呼叫以通知應用程式，下載作業的進度已經更新。|
|[CHtmlView::在屬性變更上](#onpropertychange)|呼叫以通知應用程式， [PutProperty](#putproperty) 方法已經變更屬性的值。|
|[CHtmlView::開啟](#onquit)|呼叫以通知應用程式，Internet Explorer 應用程式已經可以結束。 (僅限 Internet Explorer)|
|[CHtmlView:在重調整邊界](#onresizeborder)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。|
|[CHtmlView::在顯示上下文選單](#onshowcontextmenu)|當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::在ShowUI上](#onshowui)|在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。|
|[CHtmlView:"打開狀態列"](#onstatusbar)|當 StatusBar 屬性變更時呼叫。|
|[CHtmlView::在狀態文字變更上](#onstatustextchange)|呼叫以通知應用程式，和 WebBrowser 控制項相關的狀態列文字已經變更。|
|[CHtmlView:在劇場模式](#ontheatermode)|當 TheaterMode 屬性變更時呼叫。|
|[CHtmlView::開啟標題變更](#ontitlechange)|呼叫以通知應用程式，WebBrowser 控制項中文件的標題是否變成可用或變更。|
|[CHtmlView::在工具列上](#ontoolbar)|當 ToolBar 屬性變更時呼叫。|
|[CHtmlView:翻譯加速器上](#ontranslateaccelerator)|當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView:翻譯上](#ontranslateurl)|由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。|
|[CHtmlView:關於更新的資訊](#onupdateui)|通知主機命令狀態已變更。|
|[CHtmlView::在可見](#onvisible)|當 WebBrowser 控制項的視窗必須顯示/隱藏時呼叫。|
|[CHtmlView::P](#putproperty)|設定與指定物件相關聯屬性的值。|
|[CHtmlView::查詢表單命令](#queryformscommand)|查詢使用者介面事件所產生之一或多個命令的狀態。|
|[CHtmlView:查詢狀態WB](#querystatuswb)|查詢 WebBrowser 控制項處理中的命令狀態。|
|[CHtmlView:刷新](#refresh)|重新載入目前的檔案。|
|[CHtmlView:刷新2](#refresh2)|重新載入目前的檔案，並選擇性地防止傳送 `pragma:nocache` 標頭。|
|[CHtmlView:設定位址列](#setaddressbar)|顯示或隱藏 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:設定全螢幕](#setfullscreen)|設定值以決定控制項在全螢幕模式或標準視窗模式中操作。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:設定高度](#setheight)|設定 Internet Explorer 主視窗的高度。|
|[CHtmlView::設定左](#setleft)|設定 Internet Explorer 主視窗的水平位置。|
|[CHtmlView:設定選單列](#setmenubar)|設定決定是否顯示控制項功能表列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::設定離線](#setoffline)|設定決定控制項是否離線的值。|
|[CHtmlView::設定註冊瀏覽器](#setregisterasbrowser)|設定值，指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器。|
|[CHtmlView::設定註冊作為刪除目標](#setregisterasdroptarget)|設定值，指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView:設定靜音](#setsilent)|設定決定控制項是否顯示對話方塊的值。|
|[CHtmlView:設定狀態列](#setstatusbar)|設定值，決定是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView:設定劇場模式](#settheatermode)|設定指出 WebBrowser 控制項是否為劇場模式的值。|
|[CHtmlView:設定工具列](#settoolbar)|設定決定是否顯示控制項工具列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::設定頂部](#settop)|設定 Internet Explorer 主視窗的垂直位置。|
|[CHtmlView::設定可見](#setvisible)|設定指出物件為顯示或隱藏的值。|
|[CHtmlView::設定寬度](#setwidth)|設定 Internet Explorer 主視窗的寬度。|
|[CHtmlView:停止](#stop)|停止開啟檔案。|

## <a name="remarks"></a>備註

WebBrowser 控制項是一個視窗，使用者在這裡可以瀏覽全球資訊網的網站，以及本機檔案系統和網路上的資料夾。 WebBrowser 控制項支援超連結和統一資源定位器 (URL) 巡覽，以及維護歷程記錄清單。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>使用 MFC 應用程式的 CHtmlView 類別

在標準的 MFC 架構應用程式中 (SDI 或 MDI 型)，檢視物件通常衍生自一組特製的類別。 這些類別全都衍生自 `CView`，除 `CView`提供的功能之外，還提供特製的功能。

以 `CHtmlView` 當做應用程式檢視類別的基礎，可以提供附有 WebBrowser 控制項的檢視。 這能讓應用程式變成網頁瀏覽器。 建立網頁瀏覽器型應用程式的慣用方法，是使用 [MFC 應用程式精靈]，指定 `CHtmlView` 為檢視類別。 如需在 MFC 應用程式中實作及使用 WebBrowser 控制項的詳細資訊，請參閱 [建立網頁瀏覽器型的應用程式](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
> WebBrowser ActiveX 控制項 (亦即 `CHtmlView`) 僅適用於已安裝 Internet Explorer 4.0 或更新版本的 Windows NT 4.0 或更新版本中所執行的程式。

`CHtmlView` 是為存取 Web (和/或 HTML 文件) 的應用程式所設計。 下列 `CHtmlView` 成員函式僅適用於 Internet Explorer 應用程式。 WebBrowser 控制項沿用這些函式，但作用不明顯。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>需求

**Header:** afxhtml.h

## <a name="chtmlviewcreate"></a><a name="create"></a>CHtmlView:建立

呼叫此成員函數為 Internet 資源管理員執行檔建立 Web 瀏覽器控制元件或容器。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*lpszClass 名稱*<br/>
指向命名 Windows 類的 null 連接字串。 類名稱可以是註冊到[AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass)全域函數`RegisterClass`或 Windows 函數的任何名稱。 如果為 NULL,則使用預定義的預設[CFramewnd](../../mfc/reference/cframewnd-class.md)屬性。

*lpsz 視窗名稱*<br/>
指向表示視窗名稱的 null 連接字串。

*dwStyle*<br/>
指定視窗樣式屬性。 默認情況下,將設置WS_VISIBLE和WS_CHILD Windows 樣式。

*矩形*<br/>
對[RECT](/previous-versions/dd162897\(v=vs.85\))結構的引用,指定視窗的大小和位置。 *rectDefault*值允許 Windows 指定新視窗的大小和位置。

*pparentwnd*<br/>
指向控件的父視窗的指標。

*nID*<br/>
視圖的 ID 號。 默認情況下,設置為AFX_IDW_PANE_FIRST。

*pContext*<br/>
指向[CCreateContext](../../mfc/reference/ccreatecontext-structure.md)的指標。 預設情況下為 NULL。

## <a name="chtmlviewcreatecontrolsite"></a><a name="createcontrolsite"></a>CHtmlView:建立控制網站

可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>參數

*pContainer*<br/>
指向包含控制項的[COleControl 容器](../../mfc/reference/colecontrolcontainer-class.md)物件的指標。

*ppSite*<br/>
指向[指向 COleControlSite](../../mfc/reference/colecontrolsite-class.md)物件的指標,為控制項提供網站。

*nID*<br/>
要託管的控件的標識符。

*Clsid*<br/>
要託管的控制項的 CLSID

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

您可以重寫此成員函數以返回您自己的控制件網站類的實例。

## <a name="chtmlviewexecformscommand"></a><a name="execformscommand"></a>CHtmlView::執行形式指令

使用 `IOleCommandTarget::Exec` 方法執行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
要執行的命令。 此命令必須屬於CMDSETID3_Forms3組。

*普瓦林*<br/>
指向包含輸入`VARIANT`參數的結構的指標。 可以是 NULL。

*pVarOut*<br/>
指向接收`VARIANT`命令輸出的結構的指標。 可以是 NULL。

### <a name="return-value"></a>傳回值

標準 HRESULT 值。 有關可能值的完整清單,請參閱[IOleCommandTarget::執行](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec)在 Windows SDK 中。

### <a name="remarks"></a>備註

`ExecFormsCommand`實現[IOleCommandTarget::Exec](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-exec)方法的行為。

## <a name="chtmlviewexecwb"></a><a name="execwb"></a>CHtmlView::執行WB

呼叫此成員函數以在 Web 瀏覽器或 Internet 資源管理器中執行命令。

```
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>參數

*cmdID*<br/>
要執行的命令。

*cmdexecopt*<br/>
用於執行命令的選項集。

*普瓦因*<br/>
用於指定命令輸入參數的變體。

*pvaOut*<br/>
用於指定命令輸出參數的變體。

### <a name="remarks"></a>備註

請參閱[IWeb 瀏覽器2::在](/previous-versions//aa752117\(v=vs.85\))Windows SDK 中執行WB。

## <a name="chtmlviewgetaddressbar"></a><a name="getaddressbar"></a>CHtmlView:抓取位址列

呼叫此成員函數以檢索 Internet 資源管理員的位址列。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>傳回值

如果位址欄可見,則非零;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewgetapplication"></a><a name="getapplication"></a>CHtmlView:抓取應用程式

調用此成員函數以檢索包含 WebBrowser 控制件的應用程式支援的自動化物件。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>傳回值

指向活動文件物件的`IDispatch`介面的指標。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetbusy"></a><a name="getbusy"></a>CHtmlView:取得忙碌

調用此成員函數以確定 WebBrowser 控制件是否參與導航或下載操作。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>傳回值

如果 Web 瀏覽器繁忙,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetcontainer"></a><a name="getcontainer"></a>CHtmlView:抓取容器

調用此成員函數以檢索評估到 Web 瀏覽器容器的物件。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>傳回值

指向活動文件物件的`IDispatch`介面的指標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetfullname"></a><a name="getfullname"></a>CHtmlView:取得全名

呼叫此成員函數以檢索 Internet 資源管理員當前顯示的檔的完整路徑。

```
CString GetFullName() const;
```

### <a name="return-value"></a>傳回值

包含目前顯示檔的路徑和名稱的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件。 如果不存在路徑與檔案名稱,`GetFullName`請傳`CString`回空 。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewgetfullscreen"></a><a name="getfullscreen"></a>CHtmlView:抓取全螢幕

調用此成員函數以確定 WebBrowser 控件是在全螢幕模式下還是在正常視窗模式下運行。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>傳回值

如果 Web 瀏覽器在全螢幕模式下運行,則非零;否則為零。

### <a name="remarks"></a>備註

在全螢幕模式下,Internet Explorer 主視窗最大化,並隱藏狀態列、工具列、功能表列和標題列。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetheight"></a><a name="getheight"></a>CHtmlView:取得高度

調用此成員函數以檢索 WebBrowser 控件的幀視窗的高度(以像素為單位)。

```
long GetHeight() const;
```

### <a name="return-value"></a>傳回值

控件的幀視窗高度(以像素為單位)。

## <a name="chtmlviewgethtmldocument"></a><a name="gethtmldocument"></a>CHtmlView:取得 Html 文件

呼叫此成員函數以檢索活動文件的 HTML 文件。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>傳回值

指向活動文件物件的`IDispatch`介面的指標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetleft"></a><a name="getleft"></a>CHtmlView:取得左

調用此成員函數以檢索 WebBrowser 控件的內部左邊緣與其容器左邊緣之間的距離。

```
long GetLeft() const;
```

### <a name="return-value"></a>傳回值

左邊緣距離(以像素為單位)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationname"></a><a name="getlocationname"></a>CHtmlView:取得位置名稱

呼叫此成員函數以獲取 Web 瀏覽器中顯示的資源的名稱。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>傳回值

包含當前在 Web 瀏覽器中顯示的資源名稱的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件。

### <a name="remarks"></a>備註

如果資源是萬維網上的 HTML 頁,則名稱是該頁的標題。 如果資源是網路或本地電腦上的資料夾或檔,則名稱是 UNC 或資料夾或檔的完整路徑。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetlocationurl"></a><a name="getlocationurl"></a>CHtmlView:取得位置網址

呼叫此成員函數以檢索 WebBrowser 控制件目前顯示的資源的網址。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>傳回值

包含目前顯示在 Web 瀏覽器中的資源的網址的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件。

### <a name="remarks"></a>備註

如果資源是網路或本地電腦上的資料夾或檔,則名稱是 UNC 或資料夾或檔的完整路徑。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetmenubar"></a><a name="getmenubar"></a>CHtmlView:取得選單列

調用此成員函數以確定功能表欄是否可見。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

如果功能表欄可見,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetoffline"></a><a name="getoffline"></a>CHtmlView:離線

調用此成員函數以確定 Web 瀏覽器是否離線執行。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>傳回值

如果 Web 瀏覽器當前處於離線狀態,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetparentbrowser"></a><a name="getparentbrowser"></a>CHtmlView:抓取父瀏覽器

調用此成員函數以檢索指向 WebBrowser 控件的父物件的指標。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>傳回值

指向物件`IDispatch`介面的指標,該介面是 WebBrowser 控件的父級。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetproperty"></a><a name="getproperty"></a>CHtmlView:抓取屬性

調用此成員函數獲取當前與控制項關聯的屬性的值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpsz屬性*<br/>
指向包含要檢索的屬性的字串的指標。

*strValue*<br/>
對接收屬性的當前值的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的引用。

### <a name="return-value"></a>傳回值

在第一個版本中,如果成功完成,則非零;否則為零。 在第二個版本中,一個[COleVariant](../../mfc/reference/colevariant-class.md)物件。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetreadystate"></a><a name="getreadystate"></a>CHtmlView::準備狀態

調用此成員函數以檢索 Web 瀏覽器物件的就緒狀態。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>傳回值

如 Windows SDK 中所述的[READYSTATE](/previous-versions//aa768362\(v=vs.85\))值。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasbrowser"></a><a name="getregisterasbrowser"></a>CHtmlView:取得註冊瀏覽器

呼叫此成員函數以確定 WebBrowser 物件是否註冊為目標名稱解析的頂級瀏覽器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>傳回值

如果瀏覽器註冊為頂級瀏覽器,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetregisterasdroptarget"></a><a name="getregisterasdroptarget"></a>CHtmlView::取得註冊作為刪除目標

調用此成員函數以確定 WebBrowser 控件是否註冊為導航放置目標。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>傳回值

如果瀏覽器註冊為放置目標,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsilent"></a><a name="getsilent"></a>CHtmlView:獲得沉默

呼叫此成員函數以確定是否可以在 Web 瀏覽器控制項中顯示任何對話方塊。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>傳回值

如果無法從 Web 瀏覽器控件顯示對話框,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetsource"></a><a name="getsource"></a>CHtmlView:取得來源

呼叫此成員函數以檢索網頁的 HTML 原始碼。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="parameters"></a>參數

*refString*<br/>
將保存原始碼的[CString。](../../atl-mfc-shared/reference/cstringt-class.md)

### <a name="remarks"></a>備註

此功能等效於 Internet 資源管理器中的「檢視來源」命令,只不過原始碼在`CString`中返回。

## <a name="chtmlviewgetstatusbar"></a><a name="getstatusbar"></a>CHtmlView:取得狀態列

呼叫此成員函數以確定 Web 瀏覽器控制項是否顯示狀態列。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>傳回值

如果可以顯示狀態列,則非零;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewgettheatermode"></a><a name="gettheatermode"></a>CHtmlView:取得劇場模式

調用此成員函數以確定 Web 瀏覽器是否處於影院模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>傳回值

如果 Web 瀏覽器處於影院模式,則非零;否則為零。

### <a name="remarks"></a>備註

當 Web 瀏覽器處於影院模式時,瀏覽器主視窗將填滿整個螢幕,此時將顯示一個工具列,其中將顯示一組最少的導航工具,並且狀態列將顯示在螢幕的右上角。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoolbar"></a><a name="gettoolbar"></a>CHtmlView:抓取工具列

調用此成員函數以確定工具列是否可見。

```
int GetToolBar() const;
```

### <a name="return-value"></a>傳回值

指示工具列是否可見的值。 如果工具列可見,則非零;否則為零。

## <a name="chtmlviewgettop"></a><a name="gettop"></a>CHtmlView:取得頂端

調用此成員函數以檢索 WebBrowser 控制件主視窗頂邊緣的螢幕座標。

```
long GetTop() const;
```

### <a name="return-value"></a>傳回值

接收主視窗頂邊緣的螢幕座標的變數的位址。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettoplevelcontainer"></a><a name="gettoplevelcontainer"></a>CHtmlView:取得頂層

呼叫此成員函數以確定 Internet Explorer 是否是 Web 瀏覽器控制項的頂級容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>傳回值

非零容器是頂級容器;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgettype"></a><a name="gettype"></a>CHtmlView:取得類型

呼叫此成員函數以檢索包含的活動文件的類型名稱。

```
CString GetType() const;
```

### <a name="return-value"></a>傳回值

包含包含活動文件的類型名稱的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetvisible"></a><a name="getvisible"></a>CHtmlView:取得可見

調用此成員函數以確定包含的物件是否可見。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>傳回值

如果對象可見,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgetwidth"></a><a name="getwidth"></a>CHtmlView:取得寬度

擷取 Internet Explorer 主視窗的寬度。

```
long GetWidth() const;
```

### <a name="return-value"></a>傳回值

視窗的當前寬度(以像素為單位)。

## <a name="chtmlviewgoback"></a><a name="goback"></a>CHtmlView:傳回

在歷史記錄清單中向後導航一個專案。

```
void GoBack();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgoforward"></a><a name="goforward"></a>CHtmlView:前進

向前導航歷史記錄清單中的一個專案。

```
void GoForward();
```

## <a name="chtmlviewgohome"></a><a name="gohome"></a>CHtmlView:GoHome

巡覽至目前的首頁或起始頁，這是在 Internet Explorer [網際網路選項] 對話方塊或 [網際網路內容] 對話方塊中指定，從控制台存取。

```
void GoHome();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewgosearch"></a><a name="gosearch"></a>CHtmlView:GoSearch

導航到當前搜尋頁,如"Internet Explorer Internet 選項"對話框或"Internet 屬性"對話框中指定的"Internet 屬性"對話框中從"控制面板"訪問。

```
void GoSearch();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewloadfromresource"></a><a name="loadfromresource"></a>CHtmlView:從資源載入

調用此成員函數將指定的資源載入到 Web 瀏覽器控制項中。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>參數

*lpsz資源*<br/>
指向包含要載入的資源名稱的字串的指標。

*nRes*<br/>
包含要載入的資源名稱的緩衝區的 ID。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate"></a><a name="navigate"></a>CHtmlView:導覽

呼叫此成員函數以導航到 URL 標識的資源。

```
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>參數

*URL*<br/>
包含要瀏覽到的網址的呼叫者分配的字串,或要顯示的檔案的完整路徑。

*dwFlags*<br/>
變數的標誌,用於指定是將資源添加到歷史記錄清單、是讀取還是寫入緩存,以及是否在新視窗中顯示資源。 變數可以是[瀏覽器導航常點](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚舉定義的值的組合。

*lpsz目標的名稱*<br/>
指向字串的指標,其中包含要在其中顯示資源的框架的名稱。

*lpszHeaders*<br/>
指向指定要發送到伺服器的 HTTP 標頭的值的指標。 這些標頭將添加到預設的 Internet 資源管理器標頭中。 標頭可以指定伺服器所需的操作、傳遞給伺服器的數據類型或狀態代碼等內容。 如果*URL*不是 HTTP URL,則忽略此參數。

*lpvPostData*<br/>
指向要隨 HTTP POST 事務發送的數據的指標。 例如,POST 事務用於發送 HTML 表單收集的數據。 如果此參數未指定任何發佈數據,則`Navigate`發出 HTTP GET 事務。 如果*URL*不是 HTTP URL,則忽略此參數。

*德沃斯特數據倫*<br/>
與 HTTP POST 事務一起發送的數據。 例如,POST 事務用於發送 HTML 表單收集的數據。 如果此參數未指定任何發佈數據,則`Navigate`發出 HTTP GET 事務。 如果*URL*不是 HTTP URL,則忽略此參數。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewnavigate2"></a><a name="navigate2"></a>CHtmlView:導航2

呼叫此成員函數以導航到 URL 標識的資源或完整路徑標識的檔。

```
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>參數

*pIDL*<br/>
指向[ITEMIDLIST](/windows/win32/api/shtypes/ns-shtypes-itemidlist)結構的指標。

*dwFlags*<br/>
變數的標誌,用於指定是將資源添加到歷史記錄清單、是讀取還是寫入緩存,以及是否在新視窗中顯示資源。 變數可以是[瀏覽器導航常點](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))枚舉定義的值的組合。

*lpsz目標的名稱*<br/>
指向字串的指標,其中包含要在其中顯示資源的框架的名稱。

*lpszURL*<br/>
指向包含 URL 的字串的指標。

*lpvPostData*<br/>
與 HTTP POST 事務一起發送的數據。 例如,POST 事務用於發送 HTML 表單收集的數據。 如果此參數未指定任何發佈數據,則`Navigate2`發出 HTTP GET 事務。 如果*URL*不是 HTTP 或 HTTPS URL,則忽略此參數。

*德沃斯特數據倫*<br/>
*lpvPostData*參數指向的數據的長度(以位元組為單位)。

*lpszHeaders*<br/>
指向指定要發送到伺服器的 HTTP 或 HTTPS 標頭的值的指標。 這些標頭將添加到預設的 Internet 資源管理器標頭中。 標頭可以指定伺服器所需的操作、傳遞給伺服器的數據類型或狀態代碼等內容。 如果*URL*不是 HTTP 或 HTTPS URL,則忽略此參數。

*baPostedData*<br/>
對[CByteArray](../../mfc/reference/cbytearray-class.md)物件的引用。

### <a name="remarks"></a>備註

此成員函數透過支援`Navigate`在參數*pIDL*表示的特殊資料夾(如桌面和我的電腦)上瀏覽來擴展成員功能。

適用於 Internet Explorer 和 WebBrowser。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

## <a name="chtmlviewonbeforenavigate2"></a><a name="onbeforenavigate2"></a>CHtmlView::在導航前2

框架將調用此成員函數,以在 Web 瀏覽器中發生導航之前觸發事件。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
指向包含要導航到的 URL 的字串的指標。

*nFlags*<br/>
保留供未來使用。

*lpsz目標的名稱*<br/>
包含要在其中顯示資源的框架名稱的字串;如果資源沒有指定幀,則 NULL。

*baPostedData*<br/>
對包含要發送到`CByteArray`伺服器的物件的引用,如果正在使用 HTTP POST 事務。

*lpszHeaders*<br/>
指向包含要發送到伺服器的其他 HTTP 標頭的字串的指標(僅限 HTTP URL)。 標頭可以指定伺服器所需的操作、傳遞給伺服器的數據類型或狀態代碼等內容。

*pb取消*<br/>
指向取消標誌的指標。 應用程式可以將此參數設置為非零以取消導航操作,也可以設置為零以允許它繼續。

## <a name="chtmlviewoncommandstatechange"></a><a name="oncommandstatechange"></a>CHtmlView:在命令狀態變更

框架調用此成員函數以通知應用程式 Web 瀏覽器命令的啟用狀態已更改。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>參數

*nCommand*<br/>
已啟用狀態已更改的命令的標識碼。

*b 啟用*<br/>
已啟用狀態。 如果啟用了命令,則此參數為非零;如果禁用該參數,則為零。

## <a name="chtmlviewondocumentcomplete"></a><a name="ondocumentcomplete"></a>CHtmlView:在文件完成

框架調用此成員函數以通知應用程式文件已達到READYSTATE_COMPLETE狀態。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
指向計算到 URL、UNC 檔名或導航到的 PIDL(指向項識別符清單的指標)的字串的指標。

### <a name="remarks"></a>備註

並不是每個幀都會觸發此事件,但觸發[OnDownloadBegin](#ondownloadbegin)事件的每個幀都將觸`OnDocumentComplete`發相應的 事件。

*lpszURL*指示的 URL 可能不同於瀏覽器被告知要導航到的 URL,因為此 URL 是規範化且限定的 URL。 例如,如果應用程式在導`"www.microsoft.com"`[覽或導航2](#navigate2)的呼叫[Navigate](#navigate)中指定的網址,`OnNavigateComplete2`則`"<https://www.microsoft.com/>"`傳遞的網址將為 。 此外,如果伺服器將瀏覽器重定向到其他 URL,則重定向的 URL 將在此處反映出來。

## <a name="chtmlviewondocwindowactivate"></a><a name="ondocwindowactivate"></a>CHtmlView:在DocWindow啟動

從的 Internet Explorer 或`IOleInPlaceActiveObject::OnDocWindowActivate`MSHTML 實現呼叫 ,當啟動或停用容器的文件視窗時,該實現會通知活動就地物件。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*f 啟動*<br/>
指示文件窗口的狀態。 如果此值為非零,則視窗正在啟動。 如果此值為零,則視窗將停用。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnDocWindowActivate`以回應`OnDocWindowActivate`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) SDK 中的 OnDocWindow 啟動。

## <a name="chtmlviewondownloadbegin"></a><a name="ondownloadbegin"></a>CHtmlView::下載開始

框架調用此成員函數以開始下載文檔。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>備註

除非取消導航,否則此事件在[On前導航2](#onbeforenavigate2)事件後不久觸發。 容器需要顯示的任何動畫或"忙"指示都應連接到此事件。

## <a name="chtmlviewondownloadcomplete"></a><a name="ondownloadcomplete"></a>CHtmlView:下載完成

框架調用此成員函數以指示導航操作已完成、已停止或失敗。

```
virtual void OnDownloadComplete();
```

## <a name="chtmlviewonenablemodeless"></a><a name="onenablemodeless"></a>CHtmlView:啟用無模式

當 Internet 資源管理員或 MSHTML 顯示模式 UI 時呼叫。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>參數

*f 開啟*<br/>
指示主機的無模式對話方塊是啟用還是禁用。 如果此值是非零,則啟用無模式對話方塊。 如果此值為零,則禁用無模式對話方塊。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

當容器創建或銷毀模式對話框時,啟用或禁用無模式對話方塊。 覆蓋`OnEnableModeless`以回應`EnableModeless`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler::在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\))Windows SDK 中啟用無模式。

## <a name="chtmlviewonfilterdataobject"></a><a name="onfilterdataobject"></a>CHtmlView:在篩選資料物件上

Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>參數

*pDataObject*<br/>
由 Internet 資源管理員或 MSHTML 提供的[IDataObject](/windows/win32/api/objidl/nn-objidl-idataobject)介面的位址。

*ppDataObject*<br/>
接收主機提供的`IDataObject`介面指標的位址。 此參數的內容應始終初始化為 NULL,即使該方法失敗也是如此。

### <a name="return-value"></a>傳回值

S_OK如果替換了資料物件,則S_FALSE未替換數據物件,或者發生錯誤時使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnFilterDataObject`以回應`FilterDataObject`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler::在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\))Windows SDK 中篩選數據物件。

## <a name="chtmlviewonframewindowactivate"></a><a name="onframewindowactivate"></a>CHtmlView:在框架視窗啟動

從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*f 啟動*<br/>
指示容器的頂層框架視窗的狀態。 如果此值為非零,則視窗正在啟動。 如果此值為零,則視窗將停用。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnFrameWindowActivate`以回應`OnFrameWindowActivate`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:Windows SDK 中的「幀窗口啟動](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\))」。

## <a name="chtmlviewonfullscreen"></a><a name="onfullscreen"></a>CHtmlView:全屏

[當 FullScreen](/previous-versions/aa752119\(v=vs.85\))屬性發生更改時,框架將調用此成員函數。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>參數

*b 螢幕*<br/>
如果 Internet 資源管理器處於全屏模式,則非零;零否則。

## <a name="chtmlviewongetdroptarget"></a><a name="ongetdroptarget"></a>CHtmlView::OnGetDropTarget

當它用做為置放目標，讓主機提供另一個 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>參數

*pDropTarget*<br/>
[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)互聯網瀏覽器或MSHTML建議使用。

*ppDrop目標*<br/>
`IDropTarget`接收主機希望提供的`IDropTarget`介面指標的位址。

### <a name="return-value"></a>傳回值

有關返回代碼的清單,請參閱[IDocHostUIHandler:獲取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\))Windows SDK 中的 DropTarget。

### <a name="remarks"></a>備註

覆蓋`OnGetDropTarget`以回應`GetDropTarget`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:獲取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\))Windows SDK 中的DropTarget。

## <a name="chtmlviewongetexternal"></a><a name="ongetexternal"></a>CHtmlView::開啟外部

由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>參數

*lppDispatch*<br/>
指向接收主機應用程式的`IDispatch`介面指標的位址的指標。 如果主機公開了自動化介面,則可以通過此參數提供對 Internet 資源管理器或 MSHTML 的引用。 此參數的內容應始終初始化為 NULL,即使該方法失敗也是如此。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnGetExternal`以回應`GetExternal`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:獲取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\))Windows SDK 中的外部資訊。

## <a name="chtmlviewongethostinfo"></a><a name="ongethostinfo"></a>CHtmlView::OngetHostinfo

擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>參數

*pInfo*<br/>
接收主機 UI 功能的[DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnGetHostInfo`以回應`GetHostInfo`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:獲取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\))Windows SDK 中的HostInfo。

## <a name="chtmlviewongetoptionkeypath"></a><a name="ongetoptionkeypath"></a>CHtmlView::在取得選項關鍵路徑

呼叫此成員函數獲取 Internet 資源管理員或 MSHTML 儲存使用者首選項的註冊表項。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>參數

*pchKey*<br/>
`LPOLESTR`接收主機儲存其預設選項的註冊表子鍵字串的位址。 此子鍵將HKEY_CURRENT_USER鍵下。 使用[CoTaskMeaalloc](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemalloc)分配此記憶體。 呼叫應用程式負責釋放此記憶體使用[CoTaskMemFree](/windows/win32/api/combaseapi/nf-combaseapi-cotaskmemfree)。 應始終將此參數初始化為 NULL,即使該方法失敗也是如此。

*dw 保留*<br/>
保留供未來使用。 目前無法使用。

### <a name="return-value"></a>傳回值

S_OK成功,或S_FALSE。 如果S_FALSE,Internet 資源管理器或 MSHTML 將預設為其自己的使用者選項。

### <a name="remarks"></a>備註

覆蓋`OnGetOptionKeyPath`以回應`GetOptionKeyPath`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:獲取](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\))Windows SDK 中的OptionKeyPath。

## <a name="chtmlviewonhideui"></a><a name="onhideui"></a>CHtmlView::打開隱藏UI

當 Internet 資源管理員或 MSHTML 刪除其選單和工具列時,框架將呼叫此成員函數。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnHideUI`以回應`HideUI`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler::在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\))Windows SDK 中隱藏 UI。

## <a name="chtmlviewonmenubar"></a><a name="onmenubar"></a>CHtmlView::在Menubar上

當[MenuBar](/previous-versions/aa752131\(v=vs.85\))屬性發生更改時,框架將調用此成員函數。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>參數

*bMenuBar*<br/>
如果 Internet Explorer 功能表欄可見,則非零;零否則。

## <a name="chtmlviewonnavigatecomplete2"></a><a name="onnavigatecomplete2"></a>CHtmlView::導航完成2

在導航到超連結(在視窗或框架集元素上)后,框架將調用此成員函數。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>參數

*strURL*<br/>
計算到導覽到的網址、UNC 檔名或 PIDL(指向項識別元清單的指標)的字串運算式。

### <a name="remarks"></a>備註

對於沒有 URL 表示形式的 shell 名稱空間實體,URL 參數可以是 PIDL。

請注意 *,strURL*中包含的 URL 可能不同於瀏覽器被告知要導航到的 URL,因為此 URL 是規範化且限定的 URL。 例如,如果應用程式在導`"www.microsoft.com"`[覽或導航2](#navigate2)的呼叫[Navigate](#navigate)中指定的網址,`OnNavigateComplete2`則`"<https://www.microsoft.com/>"`傳遞的網址將為 。 此外,如果伺服器將瀏覽器重定向到其他 URL,則重定向的 URL 將在此處反映出來。

## <a name="chtmlviewonnavigateerror"></a><a name="onnavigateerror"></a>CHtmlView:在瀏覽錯誤

巡覽至超連結失敗時，由架構呼叫。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
導航失敗的 URL。

*lpsz框架*<br/>
要顯示資源的幀的名稱,如果資源沒有指定幀,則為 NULL。

*dwError*<br/>
錯誤狀態代碼(如果可用)。 有關可能的 HRESULT 與 HTTP 狀態代碼的清單,請參閱[瀏覽錯誤事件狀態代碼。 .](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\))

*pb取消*<br/>
指定是取消對錯誤頁的導航還是任何進一步的自動搜索。 如果 TRUE(預設值),請繼續導航到錯誤頁或自動搜索;如果 FALSE,則取消對錯誤頁面的導航或自動搜索。

### <a name="remarks"></a>備註

重寫此方法以提供自定義導航錯誤處理。

有關詳細資訊,請參閱[DWeb 瀏覽器事件2::導航錯誤](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

## <a name="chtmlviewonnewwindow2"></a><a name="onnewwindow2"></a>CHtmlView::開啟新視窗2

當為顯示資源而創建新視窗時,框架將調用此成員函數。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>參數

*ppDisp*<br/>
指向介面指標的指標,該指標可以選擇接收新 WebBrowser`IDispatch`或 Internet 資源管理器物件的介面指標。

*取消*<br/>
指向取消標誌的指標。 應用程式可以將此參數設置為非零以取消導航操作,也可以設置為零以允許它繼續。

### <a name="remarks"></a>備註

此事件先於從 Web 瀏覽器中創建新視窗。

## <a name="chtmlviewonprogresschange"></a><a name="onprogresschange"></a>CHtmlView::在進度更改上

框架調用此成員函數以通知應用程式下載操作的進度已更新。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>參數

*n進步*<br/>
要顯示的總進度量,或進度完成後的 -1。

*n進步馬克斯*<br/>
最大進度值。

### <a name="remarks"></a>備註

容器可以使用此事件提供的資訊來顯示到目前為止下載的位元組數或更新進度指示器。

## <a name="chtmlviewonpropertychange"></a><a name="onpropertychange"></a>CHtmlView::在屬性變更上

框架呼叫此成員函數以通知應用程式[PutProperty](#putproperty)已更改屬性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpsz屬性*<br/>
指向包含屬性名稱的字串的指標。

## <a name="chtmlviewonquit"></a><a name="onquit"></a>CHtmlView::開啟

框架調用此成員函數以通知應用程式 Internet Explorer 應用程式已準備好退出。

```
virtual void OnQuit();
```

## <a name="chtmlviewonresizeborder"></a><a name="onresizeborder"></a>CHtmlView:在重調整邊界

從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>參數

*prc邊界*<br/>
邊框空間的新外部矩形。

*pUI 視窗*<br/>
指向邊框已更改的框架或文檔視窗物件的介面的指標。

*fFrame 視窗*<br/>
如果幀視窗正在調用[IOleInPlace 活動物件::調整邊框大小](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder),否則為 FALSE。

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnResizeBorder`以回應`ResizeBorder`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler::調整](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\))Windows SDK 中的邊框大小。

## <a name="chtmlviewonshowcontextmenu"></a><a name="onshowcontextmenu"></a>CHtmlView::在顯示上下文選單

當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>參數

*dwID*<br/>
要顯示的上下文菜單的標識符。 有關`IDocHostUIHandler::ShowContextMenu`值清單,請參閱 Windows SDK。

*Ppt*<br/>
功能表的螢幕座標。

*pcmdt 保留*<br/>
[IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget)介面用於查詢命令狀態並在此物件上執行命令。

*pdisp 保留*<br/>
螢幕座標處物件的 IDispatch 介面。 這允許主機區分特定物件以提供更具體的上下文。

### <a name="return-value"></a>傳回值

有關值清單,請參閱[IDocHostUIHandler::](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\))在 Windows SDK 中顯示上下文選單。

### <a name="remarks"></a>備註

覆蓋`OnShowContextMenu`以回應`ShowContextMenu`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:在](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\))Windows SDK 中顯示上下文菜單。

## <a name="chtmlviewonshowui"></a><a name="onshowui"></a>CHtmlView::在ShowUI上

在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>參數

*dwID*<br/>
保留供未來使用。

*p 活動物件*<br/>
[當前活動物件的IOleInPlace活動物件](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceactiveobject)介面。

*pCommand目標*<br/>
[物件的 IOleCommandTarget](/windows/win32/api/docobj/nn-docobj-iolecommandtarget)介面。

*pFrame*<br/>
[物件的 IOleInPlaceFrame](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceframe)介面。 功能表和工具列需要這樣做。

*pDoc*<br/>
[物件的 IOleInPlaceUI 視窗](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceuiwindow)介面。 工具欄需要這樣做。

### <a name="return-value"></a>傳回值

有關值清單,請參閱[IDocHostUIHandler::](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\))在 Windows SDK 中顯示 UI。

### <a name="remarks"></a>備註

覆蓋`OnShowUI`以回應`ShowUI`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) SDK 中的顯示 UI。

## <a name="chtmlviewonstatusbar"></a><a name="onstatusbar"></a>CHtmlView:"打開狀態列"

當[StatusBar](/previous-versions//aa768270\(v=vs.85\))屬性發生更改時,框架將調用此成員函數。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>參數

*bStatusBar*<br/>
如果 Internet Explorer 的狀態列可見或為零,則非零。

## <a name="chtmlviewonstatustextchange"></a><a name="onstatustextchange"></a>CHtmlView::在狀態文字變更上

框架調用此成員函數以通知應用程式與 WebBrowser 控制件關聯的狀態列的文本已更改。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
包含新狀態列文字的字串。

## <a name="chtmlviewontheatermode"></a><a name="ontheatermode"></a>CHtmlView:在劇場模式

當[TheaterMode](/previous-versions/aa768273\(v=vs.85\))屬性發生更改時,框架將調用此成員函數。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>參數

*bTheater 模式*<br/>
如果 Internet 資源管理器處於影院模式,則非零;零否則。

## <a name="chtmlviewontitlechange"></a><a name="ontitlechange"></a>CHtmlView::開啟標題變更

如果 WebBrowser 控制件中的文件標題可用或更改,則框架將呼叫此成員函數以通知應用程式。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
新文件標題。

### <a name="remarks"></a>備註

對於 HTML,標題可能會更改;對於 HTML,標題可能會更改。當 HTML 仍在下載時,文件的 URL 設定為標題。 從 HTML 解析真實標題(如果有)後,將更改標題以反映實際標題。

## <a name="chtmlviewontoolbar"></a><a name="ontoolbar"></a>CHtmlView::在工具列上

[當工具列](/previous-versions/aa768274\(v=vs.85\))屬性發生更改時,框架將調用此成員函數。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>參數

*bToolBar*<br/>
如果 Internet Explorer 的工具列可見或為零,則非零。

## <a name="chtmlviewontranslateaccelerator"></a><a name="ontranslateaccelerator"></a>CHtmlView:翻譯加速器上

當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/win32/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
指向可能需要翻譯的消息。

*普吉德集團*<br/>
命令組識別碼。

*nCmdID*<br/>
命令識別碼。

### <a name="return-value"></a>傳回值

S_OK成功,或S_FALSE。

### <a name="remarks"></a>備註

覆蓋`OnTranslateAccelerator`以回應`TranslateAccelerator`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:翻譯](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\))Windows SDK 中的加速器。

## <a name="chtmlviewontranslateurl"></a><a name="ontranslateurl"></a>CHtmlView:翻譯上

由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>參數

*dwTranslate*<br/>
保留供未來使用。

*普喬林*<br/>
Internet Explorer 或 MSHTML 提供的字串的位址,該字串表示要翻譯的 URL。

*ppchURLOut*<br/>
接收已翻譯 URL 位址的字串指標的位址。 主機使用任務記憶體分配器分配緩衝區。 此參數的內容應始終初始化為 NULL,即使 URL 未翻譯或方法失敗也是如此。

### <a name="return-value"></a>傳回值

`S_OK`如果 URL 已翻譯,則S_FALSE未翻譯 URL,如果發生錯誤,則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

覆蓋`OnTranslateUrl`以回應`TranslateUrl`來自 Microsoft Web 瀏覽器控制項的通知。 有關詳細資訊[,請參閱 IDocHostUIHandler:翻譯 Windows](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) SDK 中的 Url。

## <a name="chtmlviewonupdateui"></a><a name="onupdateui"></a>CHtmlView:關於更新的資訊

通知主機命令狀態已變更。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>傳回值

S_OK如果成功,或否則使用 OLE 定義的錯誤代碼。

### <a name="remarks"></a>備註

主機應更新工具列按鈕的狀態。 無論返回`ShowUI`值如何,都將調用此方法。 覆蓋`OnUpdateUI`以回應`UpdateUI`來自 Microsoft Web 瀏覽器控制項的通知。

## <a name="chtmlviewonvisible"></a><a name="onvisible"></a>CHtmlView::在可見

當顯示或隱藏 Web 瀏覽器的視窗時,框架將調用此成員函數。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>參數

*b 可見*<br/>
如果物件可見或為零,則非零。

### <a name="remarks"></a>備註

這允許物件控制項主機視窗的做同 Internet 資源管理器視窗的一樣。

## <a name="chtmlviewputproperty"></a><a name="putproperty"></a>CHtmlView::P

調用此成員函數以設置與給定對象關聯的屬性。

```
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>參數

*lpsz屬性*<br/>
包含要設定的屬性的字串。

*vtValue*<br/>
*lpszProperty*指示的屬性的新值。

*lpsz 屬性名稱*<br/>
指向要設置的屬性名稱的字串的指標。

*dValue*<br/>
屬性的新值。

*lValue*<br/>
屬性的新值。

*lpszValue*<br/>
指向包含屬性新值的字串的指標。

*n值*<br/>
屬性的新值。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewqueryformscommand"></a><a name="queryformscommand"></a>CHtmlView::查詢表單命令

查詢使用者介面事件所產生之一或多個命令的狀態。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
要查詢的命令的標識碼。

*pb 支援*<br/>
指向 BOOL 的指標,指定命令(由*dwCommandID*標識)是否受支援。 如果為 TRUE,則支援該命令;如果為 TRUE,則為該命令。否則 FALSE。

*pb 啟用*<br/>
指向 BOOL 的指標,指定命令(由*dwCommandID*標識)是否啟用。 如果為 TRUE,則支援該命令;如果為 TRUE,則為該命令。否則 FALSE。

*pbChecked*<br/>
指向 BOOL 的指標,指定是否選中命令(由*dwCommandID*標識)。 如果為 TRUE,則支援該命令;如果為 TRUE,則為該命令。否則 FALSE。

### <a name="return-value"></a>傳回值

標準 HRESULT 值。 有關可能值的完整清單,請參閱[IOleCommandTarget::Windows](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus) SDK 中的查詢狀態。

### <a name="remarks"></a>備註

`QueryFormsCommand`實現[IOleCommandTarget::查詢狀態](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行為。

## <a name="chtmlviewquerystatuswb"></a><a name="querystatuswb"></a>CHtmlView:查詢狀態WB

調用此成員函數以查詢命令狀態。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>參數

*cmdID*<br/>
調用方需要狀態資訊的命令的[OLECMDID](/windows/win32/api/docobj/ne-docobj-olecmdid)值。

### <a name="return-value"></a>傳回值

接收命令狀態的[OLECMDF](/windows/win32/api/docobj/ne-docobj-olecmdf)值的位址。

### <a name="remarks"></a>備註

`QueryStatusWB`實現[IOleCommandTarget::查詢狀態](/windows/win32/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法的行為。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh"></a><a name="refresh"></a>CHtmlView:刷新

重新載入 Web 瀏覽器目前顯示的網址或檔案。

```
void Refresh();
```

### <a name="remarks"></a>備註

`Refresh`不包含用於設置刷新級別的參數。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewrefresh2"></a><a name="refresh2"></a>CHtmlView:刷新2

重新載入網際網路資源管理員目前顯示的檔案。

```
void Refresh2(int nLevel);
```

### <a name="parameters"></a>參數

*n 等級*<br/>
指定刷新等級的變數的位址。 可能的變數在 Windows SDK 中「[刷新常點」](/previous-versions/aa768363\(v=vs.85\))中定義。

### <a name="remarks"></a>備註

與[刷新](#refresh)`Refresh2`不同 ,包含指定刷新等級的參數。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetaddressbar"></a><a name="setaddressbar"></a>CHtmlView:設定位址列

呼叫此成員函數以顯示或隱藏 Internet Explorer 物件的位址列。

```
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
非零顯示位址欄;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewsetfullscreen"></a><a name="setfullscreen"></a>CHtmlView:設定全螢幕

呼叫此成員函數將 Internet 資源管理員設置為全屏或正常視窗模式。

```
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
全屏模式的非零;否則為零。

### <a name="remarks"></a>備註

在全螢幕模式下,Internet Explorer 主視窗最大化,並隱藏狀態列、工具列、功能表列和標題列。

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewsetheight"></a><a name="setheight"></a>CHtmlView:設定高度

呼叫此成員函數以設置 Internet 資源管理器主視窗的高度。

```
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>參數

*n 新值*<br/>
主視窗的高度(以像素為單位)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetleft"></a><a name="setleft"></a>CHtmlView::設定左

設定 Internet Explorer 主視窗的水平位置。

```
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>參數

*n 新值*<br/>
主視窗左邊緣的螢幕座標。

## <a name="chtmlviewsetmenubar"></a><a name="setmenubar"></a>CHtmlView:設定選單列

呼叫此成員函數以顯示或隱藏 Internet Explorer 選單欄。

```
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
非零顯示功能表欄;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewsetoffline"></a><a name="setoffline"></a>CHtmlView::設定離線

呼叫此成員函數以設定指示 WebBrowser 控制項當前是否處於離線模式的值。

```
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
從本地緩存讀取的非零;否則為零。

### <a name="remarks"></a>備註

在離線模式下,瀏覽器從本地快取而不是源文件讀取 HTML 頁面。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasbrowser"></a><a name="setregisterasbrowser"></a>CHtmlView::設定註冊瀏覽器

調用此成員函數以設置一個值,指示 WebBrowser 控件是否已註冊為目標名稱解析的頂級瀏覽器。

```
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
確定 Internet 資源管理員是否註冊為頂級瀏覽器。 如果為非零,則 Web 瀏覽器將註冊為頂級瀏覽器;如果為非零,則將 Web 瀏覽器註冊為頂級瀏覽器。如果為零,則它不是頂級瀏覽器。 預設值為零。

### <a name="remarks"></a>備註

頂級瀏覽器是註冊表中設置為默認瀏覽器的瀏覽器。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetregisterasdroptarget"></a><a name="setregisterasdroptarget"></a>CHtmlView::設定註冊作為刪除目標

調用此成員函數以設置一個值,指示 WebBrowser 控件是否已註冊為導航放置目標。

```
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
確定 WebBrowser 控件是否註冊為導航的放置目標。 如果非零,則物件註冊為放置目標;如果為非零,則對象將註冊為放置目標。如果為零,則它不是放置目標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetsilent"></a><a name="setsilent"></a>CHtmlView:設定靜音

呼叫此成員函數以設置指示是否可以顯示任何對話框的值。

```
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
如果未為零,將不會顯示對話方塊;如果為零,則不會顯示對話方塊。如果為零,將顯示對話方塊。 預設值為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetstatusbar"></a><a name="setstatusbar"></a>CHtmlView:設定狀態列

調用此成員函數以顯示狀態列。

```
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
如果狀態欄可見,則非零;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewsettheatermode"></a><a name="settheatermode"></a>CHtmlView:設定劇場模式

調用此成員函數以設置指示 Web 瀏覽器控件是否處於影院模式的值。

```
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
將 Web 瀏覽器控件設置為影院模式的非零;否則為零。 預設值為零。

### <a name="remarks"></a>備註

當 Web 瀏覽器處於影院模式時,瀏覽器主視窗將填滿整個螢幕,此時將顯示一個工具列,其中將顯示一組最少的導航工具,並且狀態列將顯示在螢幕的右上角。

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsettoolbar"></a><a name="settoolbar"></a>CHtmlView:設定工具列

呼叫此成員函數以顯示或隱藏 Internet Explorer 工具列。

```
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>參數

*n 新值*<br/>
指示是否顯示工具列。 如果要顯示工具列,則非零;否則為零。

### <a name="remarks"></a>備註

適用於互聯網瀏覽器。 如果使用此調用與 Web 瀏覽器控制件一起,它將不會返回任何錯誤,但它將忽略此調用。

## <a name="chtmlviewsettop"></a><a name="settop"></a>CHtmlView::設定頂部

呼叫此成員函數以設定 Web 瀏覽器控制程式的內部上邊緣與其容器頂部邊緣之間的距離

```
void SetTop(long nNewValue);
```

### <a name="parameters"></a>參數

*n 新值*<br/>
主視窗上邊緣的螢幕座標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetvisible"></a><a name="setvisible"></a>CHtmlView::設定可見

調用此成員函數以設置 Web 瀏覽器控制件的可見性狀態。

```
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*b 新值*<br/>
如果控件可見,則非零;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="chtmlviewsetwidth"></a><a name="setwidth"></a>CHtmlView::設定寬度

設定 Internet Explorer 主視窗的寬度。

```
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>參數

*n 新值*<br/>
Internet 資源管理器主視窗的寬度(以像素為單位)。

## <a name="chtmlviewstop"></a><a name="stop"></a>CHtmlView:停止

調用此成員函數以取消任何掛起的導航或下載操作,並停止任何動態頁面元素,如背景聲音和動畫。

```
void Stop();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>另請參閱

[MFC 範例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView 類別](../../mfc/reference/cformview-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/win32/api/exdisp/nn-exdisp-iwebbrowser2)
