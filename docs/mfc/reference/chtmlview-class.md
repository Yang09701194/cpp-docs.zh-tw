---
title: CHtmlView 類別
ms.date: 11/04/2016
f1_keywords:
- CHtmlView
- AFXHTML/CHtmlView
- AFXHTML/CHtmlView::Create
- AFXHTML/CHtmlView::CreateControlSite
- AFXHTML/CHtmlView::ExecFormsCommand
- AFXHTML/CHtmlView::ExecWB
- AFXHTML/CHtmlView::GetAddressBar
- AFXHTML/CHtmlView::GetApplication
- AFXHTML/CHtmlView::GetBusy
- AFXHTML/CHtmlView::GetContainer
- AFXHTML/CHtmlView::GetFullName
- AFXHTML/CHtmlView::GetFullScreen
- AFXHTML/CHtmlView::GetHeight
- AFXHTML/CHtmlView::GetHtmlDocument
- AFXHTML/CHtmlView::GetLeft
- AFXHTML/CHtmlView::GetLocationName
- AFXHTML/CHtmlView::GetLocationURL
- AFXHTML/CHtmlView::GetMenuBar
- AFXHTML/CHtmlView::GetOffline
- AFXHTML/CHtmlView::GetParentBrowser
- AFXHTML/CHtmlView::GetProperty
- AFXHTML/CHtmlView::GetReadyState
- AFXHTML/CHtmlView::GetRegisterAsBrowser
- AFXHTML/CHtmlView::GetRegisterAsDropTarget
- AFXHTML/CHtmlView::GetSilent
- AFXHTML/CHtmlView::GetSource
- AFXHTML/CHtmlView::GetStatusBar
- AFXHTML/CHtmlView::GetTheaterMode
- AFXHTML/CHtmlView::GetToolBar
- AFXHTML/CHtmlView::GetTop
- AFXHTML/CHtmlView::GetTopLevelContainer
- AFXHTML/CHtmlView::GetType
- AFXHTML/CHtmlView::GetVisible
- AFXHTML/CHtmlView::GetWidth
- AFXHTML/CHtmlView::GoBack
- AFXHTML/CHtmlView::GoForward
- AFXHTML/CHtmlView::GoHome
- AFXHTML/CHtmlView::GoSearch
- AFXHTML/CHtmlView::LoadFromResource
- AFXHTML/CHtmlView::Navigate
- AFXHTML/CHtmlView::Navigate2
- AFXHTML/CHtmlView::OnBeforeNavigate2
- AFXHTML/CHtmlView::OnCommandStateChange
- AFXHTML/CHtmlView::OnDocumentComplete
- AFXHTML/CHtmlView::OnDocWindowActivate
- AFXHTML/CHtmlView::OnDownloadBegin
- AFXHTML/CHtmlView::OnDownloadComplete
- AFXHTML/CHtmlView::OnEnableModeless
- AFXHTML/CHtmlView::OnFilterDataObject
- AFXHTML/CHtmlView::OnFrameWindowActivate
- AFXHTML/CHtmlView::OnFullScreen
- AFXHTML/CHtmlView::OnGetDropTarget
- AFXHTML/CHtmlView::OnGetExternal
- AFXHTML/CHtmlView::OnGetHostInfo
- AFXHTML/CHtmlView::OnGetOptionKeyPath
- AFXHTML/CHtmlView::OnHideUI
- AFXHTML/CHtmlView::OnMenuBar
- AFXHTML/CHtmlView::OnNavigateComplete2
- AFXHTML/CHtmlView::OnNavigateError
- AFXHTML/CHtmlView::OnNewWindow2
- AFXHTML/CHtmlView::OnProgressChange
- AFXHTML/CHtmlView::OnPropertyChange
- AFXHTML/CHtmlView::OnQuit
- AFXHTML/CHtmlView::OnResizeBorder
- AFXHTML/CHtmlView::OnShowContextMenu
- AFXHTML/CHtmlView::OnShowUI
- AFXHTML/CHtmlView::OnStatusBar
- AFXHTML/CHtmlView::OnStatusTextChange
- AFXHTML/CHtmlView::OnTheaterMode
- AFXHTML/CHtmlView::OnTitleChange
- AFXHTML/CHtmlView::OnToolBar
- AFXHTML/CHtmlView::OnTranslateAccelerator
- AFXHTML/CHtmlView::OnTranslateUrl
- AFXHTML/CHtmlView::OnUpdateUI
- AFXHTML/CHtmlView::OnVisible
- AFXHTML/CHtmlView::PutProperty
- AFXHTML/CHtmlView::QueryFormsCommand
- AFXHTML/CHtmlView::QueryStatusWB
- AFXHTML/CHtmlView::Refresh
- AFXHTML/CHtmlView::Refresh2
- AFXHTML/CHtmlView::SetAddressBar
- AFXHTML/CHtmlView::SetFullScreen
- AFXHTML/CHtmlView::SetHeight
- AFXHTML/CHtmlView::SetLeft
- AFXHTML/CHtmlView::SetMenuBar
- AFXHTML/CHtmlView::SetOffline
- AFXHTML/CHtmlView::SetRegisterAsBrowser
- AFXHTML/CHtmlView::SetRegisterAsDropTarget
- AFXHTML/CHtmlView::SetSilent
- AFXHTML/CHtmlView::SetStatusBar
- AFXHTML/CHtmlView::SetTheaterMode
- AFXHTML/CHtmlView::SetToolBar
- AFXHTML/CHtmlView::SetTop
- AFXHTML/CHtmlView::SetVisible
- AFXHTML/CHtmlView::SetWidth
- AFXHTML/CHtmlView::Stop
helpviewer_keywords:
- CHtmlView [MFC], Create
- CHtmlView [MFC], CreateControlSite
- CHtmlView [MFC], ExecFormsCommand
- CHtmlView [MFC], ExecWB
- CHtmlView [MFC], GetAddressBar
- CHtmlView [MFC], GetApplication
- CHtmlView [MFC], GetBusy
- CHtmlView [MFC], GetContainer
- CHtmlView [MFC], GetFullName
- CHtmlView [MFC], GetFullScreen
- CHtmlView [MFC], GetHeight
- CHtmlView [MFC], GetHtmlDocument
- CHtmlView [MFC], GetLeft
- CHtmlView [MFC], GetLocationName
- CHtmlView [MFC], GetLocationURL
- CHtmlView [MFC], GetMenuBar
- CHtmlView [MFC], GetOffline
- CHtmlView [MFC], GetParentBrowser
- CHtmlView [MFC], GetProperty
- CHtmlView [MFC], GetReadyState
- CHtmlView [MFC], GetRegisterAsBrowser
- CHtmlView [MFC], GetRegisterAsDropTarget
- CHtmlView [MFC], GetSilent
- CHtmlView [MFC], GetSource
- CHtmlView [MFC], GetStatusBar
- CHtmlView [MFC], GetTheaterMode
- CHtmlView [MFC], GetToolBar
- CHtmlView [MFC], GetTop
- CHtmlView [MFC], GetTopLevelContainer
- CHtmlView [MFC], GetType
- CHtmlView [MFC], GetVisible
- CHtmlView [MFC], GetWidth
- CHtmlView [MFC], GoBack
- CHtmlView [MFC], GoForward
- CHtmlView [MFC], GoHome
- CHtmlView [MFC], GoSearch
- CHtmlView [MFC], LoadFromResource
- CHtmlView [MFC], Navigate
- CHtmlView [MFC], Navigate2
- CHtmlView [MFC], OnBeforeNavigate2
- CHtmlView [MFC], OnCommandStateChange
- CHtmlView [MFC], OnDocumentComplete
- CHtmlView [MFC], OnDocWindowActivate
- CHtmlView [MFC], OnDownloadBegin
- CHtmlView [MFC], OnDownloadComplete
- CHtmlView [MFC], OnEnableModeless
- CHtmlView [MFC], OnFilterDataObject
- CHtmlView [MFC], OnFrameWindowActivate
- CHtmlView [MFC], OnFullScreen
- CHtmlView [MFC], OnGetDropTarget
- CHtmlView [MFC], OnGetExternal
- CHtmlView [MFC], OnGetHostInfo
- CHtmlView [MFC], OnGetOptionKeyPath
- CHtmlView [MFC], OnHideUI
- CHtmlView [MFC], OnMenuBar
- CHtmlView [MFC], OnNavigateComplete2
- CHtmlView [MFC], OnNavigateError
- CHtmlView [MFC], OnNewWindow2
- CHtmlView [MFC], OnProgressChange
- CHtmlView [MFC], OnPropertyChange
- CHtmlView [MFC], OnQuit
- CHtmlView [MFC], OnResizeBorder
- CHtmlView [MFC], OnShowContextMenu
- CHtmlView [MFC], OnShowUI
- CHtmlView [MFC], OnStatusBar
- CHtmlView [MFC], OnStatusTextChange
- CHtmlView [MFC], OnTheaterMode
- CHtmlView [MFC], OnTitleChange
- CHtmlView [MFC], OnToolBar
- CHtmlView [MFC], OnTranslateAccelerator
- CHtmlView [MFC], OnTranslateUrl
- CHtmlView [MFC], OnUpdateUI
- CHtmlView [MFC], OnVisible
- CHtmlView [MFC], PutProperty
- CHtmlView [MFC], QueryFormsCommand
- CHtmlView [MFC], QueryStatusWB
- CHtmlView [MFC], Refresh
- CHtmlView [MFC], Refresh2
- CHtmlView [MFC], SetAddressBar
- CHtmlView [MFC], SetFullScreen
- CHtmlView [MFC], SetHeight
- CHtmlView [MFC], SetLeft
- CHtmlView [MFC], SetMenuBar
- CHtmlView [MFC], SetOffline
- CHtmlView [MFC], SetRegisterAsBrowser
- CHtmlView [MFC], SetRegisterAsDropTarget
- CHtmlView [MFC], SetSilent
- CHtmlView [MFC], SetStatusBar
- CHtmlView [MFC], SetTheaterMode
- CHtmlView [MFC], SetToolBar
- CHtmlView [MFC], SetTop
- CHtmlView [MFC], SetVisible
- CHtmlView [MFC], SetWidth
- CHtmlView [MFC], Stop
ms.assetid: 904976af-73de-4aba-84ac-cfae8e2be09a
ms.openlocfilehash: 5ea7b59ccb95078324ae85bbf04c11c537f0f525
ms.sourcegitcommit: ecf274bcfe3a977c48745aaa243e5e731f1fdc5f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/04/2019
ms.locfileid: "66503556"
---
# <a name="chtmlview-class"></a>CHtmlView 類別

在 MFC 的文件/檢視架構內容中提供 WebBrowser 控制項的功能。

## <a name="syntax"></a>語法

```
class CHtmlView : public CFormView
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CHtmlView::Create](#create)|建立 WebBrowser 控制項。|
|[CHtmlView::CreateControlSite](#createcontrolsite)|可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。|
|[CHtmlView::ExecFormsCommand](#execformscommand)|使用 `IOleCommandTarget::Exec` 方法執行指定的命令。|
|[CHtmlView::ExecWB](#execwb)|執行命令。|
|[CHtmlView::GetAddressBar](#getaddressbar)|決定是否顯示 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetApplication](#getapplication)|擷取代表應用程式的應用程式物件，此應用程式包含 Internet Explorer 應用程式目前的執行個體。|
|[CHtmlView::GetBusy](#getbusy)|擷取指出下載或其他活動是否仍在進行中的值。|
|[CHtmlView::GetContainer](#getcontainer)|擷取 WebBrowser 控制項的容器。|
|[CHtmlView::GetFullName](#getfullname)|擷取顯示在網頁瀏覽器中的資源完整名稱，包括路徑。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetFullScreen](#getfullscreen)|指出 WebBrowser 控制項是在全螢幕模式或標準視窗模式中操作。|
|[CHtmlView::GetHeight](#getheight)|擷取 Internet Explorer 主視窗的高度。|
|[CHtmlView::GetHtmlDocument](#gethtmldocument)|擷取使用中的 HTML 文件。|
|[CHtmlView::GetLeft](#getleft)|擷取 Internet Explorer 主視窗左邊緣的螢幕座標。|
|[CHtmlView::GetLocationName](#getlocationname)|擷取 WebBrowser 目前顯示的資源名稱。|
|[CHtmlView::GetLocationURL](#getlocationurl)|擷取 WebBrowser 目前顯示的資源 URL。|
|[CHtmlView::GetMenuBar](#getmenubar)|擷取決定是否顯示功能表列的值。|
|[CHtmlView::GetOffline](#getoffline)|擷取決定控制項是否離線的值。|
|[CHtmlView::GetParentBrowser](#getparentbrowser)|擷取 `IDispatch` 介面的指標。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。|
|[CHtmlView::GetProperty](#getproperty)|擷取與指定物件相關聯屬性目前的值。|
|[CHtmlView::GetReadyState](#getreadystate)|擷取網頁瀏覽器物件的就緒狀態。|
|[CHtmlView::GetRegisterAsBrowser](#getregisterasbrowser)|指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器進行。|
|[CHtmlView::GetRegisterAsDropTarget](#getregisterasdroptarget)|指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView::GetSilent](#getsilent)|指出是否可顯示所有對話方塊。|
|[CHtmlView::GetSource](#getsource)|網頁的 HTML 原始程式碼。|
|[CHtmlView::GetStatusBar](#getstatusbar)|指出是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::GetTheaterMode](#gettheatermode)|指出 WebBrowser 控制項是否為劇場模式。|
|[CHtmlView::GetToolBar](#gettoolbar)|擷取決定是否顯示工具列的值。|
|[CHtmlView::GetTop](#gettop)|擷取 Internet Explorer 主視窗上邊緣的螢幕座標。|
|[CHtmlView::GetTopLevelContainer](#gettoplevelcontainer)|擷取值，指出目前的物件是否為 WebBrowser 控制項的最上層容器。|
|[CHtmlView::GetType](#gettype)|擷取文件物件的類型名稱。|
|[CHtmlView::GetVisible](#getvisible)|擷取指出物件為顯示或隱藏的值。|
|[CHtmlView::GetWidth](#getwidth)|擷取 Internet Explorer 主視窗的寬度。|
|[CHtmlView::GoBack](#goback)|在歷程清單中巡覽至上一個項目。|
|[CHtmlView::GoForward](#goforward)|在歷程清單中巡覽至下一個項目。|
|[CHtmlView::GoHome](#gohome)|巡覽至目前的首頁或起始頁面。|
|[CHtmlView::GoSearch](#gosearch)|巡覽至目前的搜尋頁面。|
|[CHtmlView::LoadFromResource](#loadfromresource)|載入 WebBrowser 控制項的資源。|
|[CHtmlView::Navigate](#navigate)|巡覽至依 URL 找到的資源。|
|[CHtmlView::Navigate2](#navigate2)|巡覽至依 URL 找到的資源或依完整路徑找到的檔案。|
|[CHtmlView::OnBeforeNavigate2](#onbeforenavigate2)|在給定的 WebBrowser 中發生巡覽前呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView::OnCommandStateChange](#oncommandstatechange)|呼叫以通知應用程式， 網頁瀏覽器命令啟用的狀態已經變更。|
|[CHtmlView::OnDocumentComplete](#ondocumentcomplete)|呼叫以通知應用程式的文件到達 READYSTATE_COMPLETE 狀態。|
|[CHtmlView::OnDocWindowActivate](#ondocwindowactivate)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::OnDocWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-ondocwindowactivate)呼叫，這會在容器文件視窗啟用或停用時，通知使用中的就地物件。|
|[CHtmlView::OnDownloadBegin](#ondownloadbegin)|呼叫以通知應用程式，巡覽作業已經啟動。|
|[CHtmlView::OnDownloadComplete](#ondownloadcomplete)|當巡覽作業結束、暫止或失敗時呼叫。|
|[CHtmlView::OnEnableModeless](#onenablemodeless)|當容器建立或終結強制回應對話方塊時，呼叫以啟用或停用非強制回應對話方塊。|
|[CHtmlView::OnFilterDataObject](#onfilterdataobject)|Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。|
|[CHtmlView::OnFrameWindowActivate](#onframewindowactivate)|從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。|
|[CHtmlView::OnFullScreen](#onfullscreen)|當 FullScreen 屬性變更時呼叫。|
|[CHtmlView::OnGetDropTarget](#ongetdroptarget)|當它用做為置放目標，讓主機提供另一個 [IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnGetExternal](#ongetexternal)|由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。|
|[CHtmlView::OnGetHostInfo](#ongethostinfo)|擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。|
|[CHtmlView::OnGetOptionKeyPath](#ongetoptionkeypath)|傳回 Internet Explorer 或 MSHTML 儲存使用者喜好設定的登錄機碼。|
|[CHtmlView::OnHideUI](#onhideui)|當 Internet Explorer 或 MSHTML 移除其功能表與工具列時呼叫。|
|[CHtmlView::OnMenuBar](#onmenubar)|當 MenuBar 屬性變更時呼叫。|
|[CHtmlView::OnNavigateComplete2](#onnavigatecomplete2)|超連結的巡覽完畢後呼叫 (無論是在視窗或框架項目上)。|
|[CHtmlView::OnNavigateError](#onnavigateerror)|巡覽至超連結失敗時，由架構呼叫。|
|[CHtmlView::OnNewWindow2](#onnewwindow2)|當為顯示資源而建立新視窗時呼叫。|
|[CHtmlView::OnProgressChange](#onprogresschange)|呼叫以通知應用程式，下載作業的進度已經更新。|
|[CHtmlView::OnPropertyChange](#onpropertychange)|呼叫以通知應用程式， [PutProperty](#putproperty) 方法已經變更屬性的值。|
|[CHtmlView::OnQuit](#onquit)|呼叫以通知應用程式，Internet Explorer 應用程式已經可以結束。 (僅限 Internet Explorer)|
|[CHtmlView::OnResizeBorder](#onresizeborder)|從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。|
|[CHtmlView::OnShowContextMenu](#onshowcontextmenu)|當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnShowUI](#onshowui)|在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。|
|[CHtmlView::OnStatusBar](#onstatusbar)|當 StatusBar 屬性變更時呼叫。|
|[CHtmlView::OnStatusTextChange](#onstatustextchange)|呼叫以通知應用程式，和 WebBrowser 控制項相關的狀態列文字已經變更。|
|[CHtmlView::OnTheaterMode](#ontheatermode)|當 TheaterMode 屬性變更時呼叫。|
|[CHtmlView::OnTitleChange](#ontitlechange)|呼叫以通知應用程式，WebBrowser 控制項中文件的標題是否變成可用或變更。|
|[CHtmlView::OnToolBar](#ontoolbar)|當 ToolBar 屬性變更時呼叫。|
|[CHtmlView::OnTranslateAccelerator](#ontranslateaccelerator)|當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。|
|[CHtmlView::OnTranslateUrl](#ontranslateurl)|由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。|
|[CHtmlView::OnUpdateUI](#onupdateui)|通知主機命令狀態已變更。|
|[CHtmlView::OnVisible](#onvisible)|當 WebBrowser 控制項的視窗必須顯示/隱藏時呼叫。|
|[CHtmlView::PutProperty](#putproperty)|設定與指定物件相關聯屬性的值。|
|[CHtmlView::QueryFormsCommand](#queryformscommand)|查詢使用者介面事件所產生之一或多個命令的狀態。|
|[CHtmlView::QueryStatusWB](#querystatuswb)|查詢 WebBrowser 控制項處理中的命令狀態。|
|[CHtmlView::Refresh](#refresh)|重新載入目前的檔案。|
|[CHtmlView::Refresh2](#refresh2)|重新載入目前的檔案，並選擇性地防止傳送 `pragma:nocache` 標頭。|
|[CHtmlView::SetAddressBar](#setaddressbar)|顯示或隱藏 Internet Explorer 物件的網址列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetFullScreen](#setfullscreen)|設定值以決定控制項在全螢幕模式或標準視窗模式中操作。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetHeight](#setheight)|設定 Internet Explorer 主視窗的高度。|
|[CHtmlView::SetLeft](#setleft)|設定 Internet Explorer 主視窗的水平位置。|
|[CHtmlView::SetMenuBar](#setmenubar)|設定決定是否顯示控制項功能表列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetOffline](#setoffline)|設定決定控制項是否離線的值。|
|[CHtmlView::SetRegisterAsBrowser](#setregisterasbrowser)|設定值，指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器。|
|[CHtmlView::SetRegisterAsDropTarget](#setregisterasdroptarget)|設定值，指出 WebBrowser 控制項是否註冊為巡覽的置放目標。|
|[CHtmlView::SetSilent](#setsilent)|設定決定控制項是否顯示對話方塊的值。|
|[CHtmlView::SetStatusBar](#setstatusbar)|設定值，決定是否顯示 Internet Explorer 狀態列。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetTheaterMode](#settheatermode)|設定指出 WebBrowser 控制項是否為劇場模式的值。|
|[CHtmlView::SetToolBar](#settoolbar)|設定決定是否顯示控制項工具列的值。 (忽略　WebBrowser 控制項，僅限 Internet Explorer。)|
|[CHtmlView::SetTop](#settop)|設定 Internet Explorer 主視窗的垂直位置。|
|[CHtmlView::SetVisible](#setvisible)|設定指出物件為顯示或隱藏的值。|
|[CHtmlView::SetWidth](#setwidth)|設定 Internet Explorer 主視窗的寬度。|
|[CHtmlView::Stop](#stop)|停止開啟檔案。|

## <a name="remarks"></a>備註

WebBrowser 控制項是一個視窗，使用者在這裡可以瀏覽全球資訊網的網站，以及本機檔案系統和網路上的資料夾。 WebBrowser 控制項支援超連結和統一資源定位器 (URL) 巡覽，以及維護歷程記錄清單。

## <a name="using-the-chtmlview-class-in-an-mfc-application"></a>使用 MFC 應用程式的 CHtmlView 類別

在標準的 MFC 架構應用程式中 (SDI 或 MDI 型)，檢視物件通常衍生自一組特製的類別。 這些類別全都衍生自 `CView`，除 `CView`提供的功能之外，還提供特製的功能。

以 `CHtmlView` 當做應用程式檢視類別的基礎，可以提供附有 WebBrowser 控制項的檢視。 這能讓應用程式變成網頁瀏覽器。 建立網頁瀏覽器型應用程式的慣用方法，是使用 [MFC 應用程式精靈]，指定 `CHtmlView` 為檢視類別。 如需在 MFC 應用程式中實作及使用 WebBrowser 控制項的詳細資訊，請參閱 [建立網頁瀏覽器型的應用程式](../../mfc/reference/creating-a-web-browser-style-mfc-application.md)。

> [!NOTE]
>  WebBrowser ActiveX 控制項 (亦即 `CHtmlView`) 僅適用於已安裝 Internet Explorer 4.0 或更新版本的 Windows NT 4.0 或更新版本中所執行的程式。

`CHtmlView` 是為存取 Web (和/或 HTML 文件) 的應用程式所設計。 下列 `CHtmlView` 成員函式僅適用於 Internet Explorer 應用程式。 WebBrowser 控制項沿用這些函式，但作用不明顯。

- [GetAddressBar](#getaddressbar)

- [GetFullName](#getfullname)

- [GetStatusBar](#getstatusbar)

- [SetAddressBar](#setaddressbar)

- [SetFullScreen](#setfullscreen)

- [SetMenuBar](#setmenubar)

- [SetStatusBar](#setstatusbar)

- [SetToolBar](#settoolbar)

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CView](../../mfc/reference/cview-class.md)

[CScrollView](../../mfc/reference/cscrollview-class.md)

[CFormView](../../mfc/reference/cformview-class.md)

`CHtmlView`

## <a name="requirements"></a>需求

**Header:** afxhtml.h

##  <a name="create"></a>  CHtmlView::Create

呼叫此成員函式，建立 WebBrowser 控制項或容器的 Internet Explorer 可執行檔。

```
virtual BOOL Create(
    LPCTSTR lpszClassName,
    LPCTSTR lpszWindowName,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*lpszClassName*<br/>
指向以 null 結束的字元字串，可命名 Windows 類別。 類別名稱可以是任何名稱向[AfxRegisterWndClass](../../mfc/reference/application-information-and-management.md#afxregisterwndclass)全域函式或`RegisterClass`Windows 函式。 如果是 NULL，會使用預先定義的預設[CFrameWnd](../../mfc/reference/cframewnd-class.md)屬性。

*lpszWindowName*<br/>
指向以 null 結束的字元字串，表示視窗名稱。

*dwStyle*<br/>
指定視窗的樣式屬性。 根據預設，會設定 WS_VISIBLE 和 WS_CHILD Windows 樣式。

*rect*<br/>
參考[RECT](/previous-versions/dd162897\(v=vs.85\))結構，指定的大小和視窗的位置。 *RectDefault*值允許指定的大小和位置的新視窗中的 Windows。

*pParentWnd*<br/>
控制項的父視窗指標。

*nID*<br/>
檢視的識別碼。 根據預設，設定為 AFX_IDW_PANE_FIRST。

*pContext*<br/>
指標[CCreateContext](../../mfc/reference/ccreatecontext-structure.md)。 預設為 NULL。

##  <a name="createcontrolsite"></a>  CHtmlView::CreateControlSite

可覆寫，用來建立主控表單上之控制項的控制項網站執行個體。

```
virtual BOOL CreateControlSite(
    COleControlContainer* pContainer,
    COleControlSite** ppSite,
    UINT nID,
    REFCLSID clsid);
```

### <a name="parameters"></a>參數

*pContainer*<br/>
指標[COleControlContainer](../../mfc/reference/colecontrolcontainer-class.md)包含控制項的物件。

*ppSite*<br/>
指標的指標[COleControlSite](../../mfc/reference/colecontrolsite-class.md)物件，並提供控制項的站台。

*nID*<br/>
裝載控制項的識別項。

*clsid*<br/>
裝載控制項的 CLSID

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

您可以覆寫此成員函式，以傳回您自己的控制項站台類別的執行個體。

##  <a name="execformscommand"></a>  CHtmlView::ExecFormsCommand

使用 `IOleCommandTarget::Exec` 方法執行指定的命令。

```
HRESULT ExecFormsCommand(
    DWORD dwCommandID,
    VARIANT* pVarIn,
    VARIANT* pVarOut);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
要執行的命令。 此命令必須屬於 CMDSETID3_Forms3 群組。

*pVarIn*<br/>
指標`VARIANT`結構，其中包含輸入引數。 可以是 NULL。

*pVarOut*<br/>
指標`VARIANT`接收命令輸出的結構。 可以是 NULL。

### <a name="return-value"></a>傳回值

標準的 HRESULT 值。 如需可能值的完整清單，請參閱 < [IOleCommandTarget::Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec) Windows SDK 中。

### <a name="remarks"></a>備註

`ExecFormsCommand` 實作的行為[IOleCommandTarget::Exec](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-exec)方法。

##  <a name="execwb"></a>  CHtmlView::ExecWB

呼叫此成員函式，WebBrowser 或 Internet Explorer 中執行命令。

```
void ExecWB(
    OLECMDID cmdID,
    OLECMDEXECOPT cmdexecopt,
    VARIANT* pvaIn,
    VARIANT* pvaOut);
```

### <a name="parameters"></a>參數

*cmdID*<br/>
要執行的命令。

*cmdexecopt*<br/>
設定執行命令的選項。

*pvaIn*<br/>
Variant，用來指定命令的輸入引數。

*pvaOut*<br/>
Variant，用來指定命令的輸出引數。

### <a name="remarks"></a>備註

請參閱[IWebBrowser2::ExecWB](/previous-versions//aa752117\(v=vs.85\)) Windows SDK 中。

##  <a name="getaddressbar"></a>  CHtmlView::GetAddressBar

呼叫此成員函式可擷取 Internet Explorer 網址列。

```
BOOL GetAddressBar() const;
```

### <a name="return-value"></a>傳回值

非零值，如果 [網址] 列是可見的。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="getapplication"></a>  CHtmlView::GetApplication

呼叫此成員函式，來擷取包含 WebBrowser 控制項的應用程式所支援的 automation 物件。

```
LPDISPATCH GetApplication() const;
```

### <a name="return-value"></a>傳回值

指標`IDispatch`主動式文件物件的介面。 如需詳細資訊，請參閱 [Implementing the IDispatch Interface](/previous-versions/windows/desktop/automat/implementing-the-idispatch-interface)。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getbusy"></a>  CHtmlView::GetBusy

呼叫此成員函式，以判斷 WebBrowser 控制項是否參與瀏覽或下載作業。

```
BOOL GetBusy() const;
```

### <a name="return-value"></a>傳回值

網頁瀏覽器忙碌中; 如果為非零否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getcontainer"></a>  CHtmlView::GetContainer

呼叫此成員函式，來擷取容器的 web 瀏覽器會評估物件。

```
LPDISPATCH GetContainer() const;
```

### <a name="return-value"></a>傳回值

指標`IDispatch`主動式文件物件的介面。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getfullname"></a>  CHtmlView::GetFullName

呼叫此成員函式可擷取 Internet Explorer 目前顯示之檔案的完整路徑。

```
CString GetFullName() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，包含目前所顯示的檔案名稱與路徑。 如果沒有路徑和檔案名稱存在，請`GetFullName`會傳回空白`CString`。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="getfullscreen"></a>  CHtmlView::GetFullScreen

呼叫此成員函式，來判斷 WebBrowser 控制項是否在全螢幕模式或標準視窗模式中運作。

```
BOOL GetFullScreen() const;
```

### <a name="return-value"></a>傳回值

WebBrowser 正以全螢幕模式; 如果為非零否則為零。

### <a name="remarks"></a>備註

在全螢幕模式中，Internet Explorer 主視窗最大化，並會隱藏狀態列、 工具列、 功能表列和標題列。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getheight"></a>  CHtmlView::GetHeight

呼叫此成員函式可擷取的高度，單位為像素 WebBrowser 控制項的框架視窗。

```
long GetHeight() const;
```

### <a name="return-value"></a>傳回值

控制項的框架視窗高度，單位為像素。

##  <a name="gethtmldocument"></a>  CHtmlView::GetHtmlDocument

呼叫此成員函式，來擷取使用中文件的 HTML 文件。

```
LPDISPATCH GetHtmlDocument() const;
```

### <a name="return-value"></a>傳回值

指標`IDispatch`主動式文件物件的介面。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getleft"></a>  CHtmlView::GetLeft

呼叫此成員函式可擷取 WebBrowser 控制項內部左邊的緣和其容器左邊的緣之間的距離。

```
long GetLeft() const;
```

### <a name="return-value"></a>傳回值

左邊緣的距離，單位為像素。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getlocationname"></a>  CHtmlView::GetLocationName

呼叫此成員函式，以取得所顯示的 WebBrowser 中的資源名稱。

```
CString GetLocationName() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，包含資源的 WebBrowser 中目前顯示的名稱。

### <a name="remarks"></a>備註

如果資源是全球資訊網上的 HTML 網頁，則名稱會是該頁面的標題。 如果資源是資料夾或網路或本機電腦上的檔案，名稱會是 UNC 或資料夾或檔案的完整路徑。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getlocationurl"></a>  CHtmlView::GetLocationURL

呼叫此成員函式可擷取目前顯示在 WebBrowser 控制項的資源 URL。

```
CString GetLocationURL() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，包含目前顯示的 WebBrowser 中資源的 URL。

### <a name="remarks"></a>備註

如果資源是資料夾或網路或本機電腦上的檔案，名稱會是 UNC 或資料夾或檔案的完整路徑。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getmenubar"></a>  CHtmlView::GetMenuBar

呼叫此成員函式，以判斷是否顯示功能表列。

```
BOOL GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

非零值，如果在功能表列是可見的。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getoffline"></a>  CHtmlView::GetOffline

呼叫此成員函式，來判斷是否要離線運作的 web 瀏覽器。

```
BOOL GetOffline() const;
```

### <a name="return-value"></a>傳回值

非零值，當網頁瀏覽器目前離線;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getparentbrowser"></a>  CHtmlView::GetParentBrowser

呼叫此成員函式可擷取 WebBrowser 控制項的父物件的指標。

```
LPDISPATCH GetParentBrowser() const;
```

### <a name="return-value"></a>傳回值

指標`IDispatch`WebBrowser 控制項的父物件的介面。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getproperty"></a>  CHtmlView::GetProperty

呼叫此成員函式，以取得目前與控制項相關聯的屬性值。

```
BOOL GetProperty(
    LPCTSTR lpszProperty,
    CString& strValue);

COleVariant GetProperty(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
包含要擷取之屬性的字串指標。

*strValue*<br/>
參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)接收屬性的目前值的物件。

### <a name="return-value"></a>傳回值

在第一個版本中，如果順利完成，非零值。否則為零。 在第二個版本中， [COleVariant](../../mfc/reference/colevariant-class.md)物件。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getreadystate"></a>  CHtmlView::GetReadyState

呼叫此成員函式可擷取 WebBrowser 物件的就緒狀態。

```
READYSTATE GetReadyState() const;
```

### <a name="return-value"></a>傳回值

A [READYSTATE](/previous-versions//aa768362\(v=vs.85\))值，在 Windows SDK 中所述。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasbrowser"></a>  CHtmlView::GetRegisterAsBrowser

呼叫此成員函式，以判斷是否要將 WebBrowser 物件登錄為目標的名稱解析的最上層瀏覽器。

```
BOOL GetRegisterAsBrowser() const;
```

### <a name="return-value"></a>傳回值

如果瀏覽器會註冊為最上層的瀏覽器中，為非零否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getregisterasdroptarget"></a>  CHtmlView::GetRegisterAsDropTarget

呼叫此成員函式，以判斷是否要將 WebBrowser 控制項註冊為巡覽的置放目標。

```
BOOL GetRegisterAsDropTarget() const;
```

### <a name="return-value"></a>傳回值

非零值，如果瀏覽器登錄為置放目標;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getsilent"></a>  CHtmlView::GetSilent

呼叫此成員函式，以判斷是否可以在 WebBrowser 控制項中顯示任何對話方塊。

```
BOOL GetSilent() const;
```

### <a name="return-value"></a>傳回值

如果無法從 WebBrowser 控制項中，顯示對話方塊，非零值。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getsource"></a>  CHtmlView::GetSource

呼叫此成員函式，來擷取 web 網頁的 HTML 原始程式碼。

```
BOOL GetSource(CString& strRef);
```

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="parameters"></a>參數

*refString*<br/>
A [CString](../../atl-mfc-shared/reference/cstringt-class.md)將保留的原始程式碼。

### <a name="remarks"></a>備註

此函式相當於 [檢視來源] 命令，在 Internet Explorer 中，不同之處在於會傳入原始碼`CString`。

##  <a name="getstatusbar"></a>  CHtmlView::GetStatusBar

呼叫此成員函式，以判斷 WebBrowser 控制項是否顯示狀態列。

```
BOOL GetStatusBar() const;
```

### <a name="return-value"></a>傳回值

如果可以顯示狀態列，為非零否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="gettheatermode"></a>  CHtmlView::GetTheaterMode

呼叫此成員函式，以判斷網頁瀏覽器是否為劇場模式。

```
BOOL GetTheaterMode() const;
```

### <a name="return-value"></a>傳回值

網頁瀏覽器為劇場模式; 如果為非零否則為零。

### <a name="remarks"></a>備註

劇場模式的 web 瀏覽器時，瀏覽器的主視窗填滿整個畫面，包含導覽工具的最少的工具列會出現，而狀態列會出現在畫面右上角。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettoolbar"></a>  CHtmlView::GetToolBar

呼叫此成員函式，以判斷工具列是否可見。

```
int GetToolBar() const;
```

### <a name="return-value"></a>傳回值

值，指出工具列是否可見。 如果工具列為可見;，非零值。否則為零。

##  <a name="gettop"></a>  CHtmlView::GetTop

呼叫此成員函式可擷取 WebBrowser 控制項的主視窗的上邊緣的螢幕座標。

```
long GetTop() const;
```

### <a name="return-value"></a>傳回值

此變數會接收的主視窗的上邊緣的螢幕座標的位址。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettoplevelcontainer"></a>  CHtmlView::GetTopLevelContainer

呼叫此成員函式，以判斷 Internet Explorer 是否為 WebBrowser 控制項的最上層的容器。

```
BOOL GetTopLevelContainer() const;
```

### <a name="return-value"></a>傳回值

非零值是容器的最上層的容器;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gettype"></a>  CHtmlView::GetType

呼叫此成員函式，來擷取包含使用中文件的型別名稱。

```
CString GetType() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md)物件，其中包含所包含的使用中文件的型別名稱。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getvisible"></a>  CHtmlView::GetVisible

呼叫此成員函式，以判斷所包含的物件是否可見。

```
BOOL GetVisible() const;
```

### <a name="return-value"></a>傳回值

非零值，如果物件是可見的。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="getwidth"></a>  CHtmlView::GetWidth

擷取 Internet Explorer 主視窗的寬度。

```
long GetWidth() const;
```

### <a name="return-value"></a>傳回值

目前的視窗中，單位為像素寬度。

##  <a name="goback"></a>  CHtmlView::GoBack

瀏覽歷程記錄清單中的向後一個項目。

```
void GoBack();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="goforward"></a>  CHtmlView::GoForward

瀏覽歷程記錄清單的正向一個項目。

```
void GoForward();
```

##  <a name="gohome"></a>  CHtmlView::GoHome

巡覽至目前的首頁或起始頁，這是在 Internet Explorer [網際網路選項] 對話方塊或 [網際網路內容] 對話方塊中指定，從控制台存取。

```
void GoHome();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="gosearch"></a>  CHtmlView::GoSearch

瀏覽至目前搜尋頁面上，在 Internet Explorer [網際網路選項] 對話方塊或 [網際網路內容] 對話方塊中，指定從控制台存取。

```
void GoSearch();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="loadfromresource"></a>  CHtmlView::LoadFromResource

呼叫此成員函式，將指定的資源載入 WebBrowser 控制項。

```
BOOL LoadFromResource(LPCTSTR lpszResource);
BOOL LoadFromResource(UINT nRes);
```

### <a name="parameters"></a>參數

*lpszResource*<br/>
包含要載入的資源名稱的字串指標。

*nRes*<br/>
載入包含的資源名稱之緩衝區的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="navigate"></a>  CHtmlView::Navigate

呼叫此成員函式，以巡覽至依 URL 找到的資源。

```
void Navigate(
    LPCTSTR URL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);
```

### <a name="parameters"></a>參數

*URL*<br/>
呼叫端配置的字串，包含要瀏覽至的 URL 或要顯示之檔案的完整路徑。

*dwFlags*<br/>
此變數會指定是否要將資源新增至歷程記錄清單、 是否要從快取中，若要讀取或寫入以及是否要在新視窗顯示資源的旗標。 變數可以是所定義之值的組合[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))列舉型別。

*lpszTargetFrameName*<br/>
包含要在其中顯示該資源的框架名稱的字串指標。

*lpszHeaders*<br/>
指定要傳送至伺服器的 HTTP 標頭值的指標。 這些標頭新增至預設的 Internet Explorer 標頭。 標頭可以指定等項目，做為所需的伺服器，也就是傳遞至伺服器或狀態碼的資料類型的動作。 如果這個參數就會忽略*URL*不是 HTTP URL。

*lpvPostData*<br/>
要與 HTTP POST 交易傳送的資料指標。 例如，POST 交易用來傳送 HTML 格式所收集的資料。 如果這個參數未指定任何張貼的資料，`Navigate`發出 HTTP GET 的交易。 如果這個參數就會忽略*URL*不是 HTTP URL。

*dwPostDataLen*<br/>
要與 HTTP POST 交易傳送的資料。 例如，POST 交易用來傳送 HTML 格式所收集的資料。 如果這個參數未指定任何張貼的資料，`Navigate`發出 HTTP GET 的交易。 如果這個參數就會忽略*URL*不是 HTTP URL。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="navigate2"></a>  CHtmlView::Navigate2

呼叫此成員函式以巡覽至依 URL 找到的資源或完整路徑所識別的檔案。

```
void Navigate2(
    LPITEMIDLIST pIDL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags = 0,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeaders = NULL,
    LPVOID lpvPostData = NULL,
    DWORD dwPostDataLen = 0);

void Navigate2(
    LPCTSTR lpszURL,
    DWORD dwFlags,
    CByteArray& baPostedData,
    LPCTSTR lpszTargetFrameName = NULL,
    LPCTSTR lpszHeader = NULL);
```

### <a name="parameters"></a>參數

*pIDL*<br/>
指標[ITEMIDLIST](/windows/desktop/api/shtypes/ns-shtypes-_itemidlist)結構。

*dwFlags*<br/>
此變數會指定是否要將資源新增至歷程記錄清單、 是否要從快取中，若要讀取或寫入以及是否要在新視窗顯示資源的旗標。 變數可以是所定義之值的組合[BrowserNavConstants](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768360\(v=vs.85\))列舉型別。

*lpszTargetFrameName*<br/>
包含要在其中顯示該資源的框架名稱的字串指標。

*lpszURL*<br/>
字串，包含 URL 的指標。

*lpvPostData*<br/>
要與 HTTP POST 交易傳送的資料。 例如，POST 交易用來傳送 HTML 格式所收集的資料。 如果這個參數未指定任何張貼的資料，`Navigate2`發出 HTTP GET 的交易。 如果這個參數就會忽略*URL*並不是 HTTP 或 HTTPS URL。

*dwPostDataLen*<br/>
所指向之資料的位元組長度*lpvPostData*參數。

*lpszHeaders*<br/>
指定要傳送至伺服器的 HTTP 或 HTTPS 標頭值的指標。 這些標頭新增至預設的 Internet Explorer 標頭。 標頭可以指定等項目，做為所需的伺服器，也就是傳遞至伺服器或狀態碼的資料類型的動作。 如果這個參數就會忽略*URL*並不是 HTTP 或 HTTPS URL。

*baPostedData*<br/>
參考[CByteArray](../../mfc/reference/cbytearray-class.md)物件。

### <a name="remarks"></a>備註

此成員函式會擴充`Navigate`成員函式，藉由支援上特殊資料夾，例如桌上型電腦和我的電腦，表示參數的瀏覽*pIDL*。

適用於 Internet Explorer 和 WebBrowser。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCHtmlHttp#7](../../mfc/reference/codesnippet/cpp/chtmlview-class_1.cpp)]

##  <a name="onbeforenavigate2"></a>  CHtmlView::OnBeforeNavigate2

此成員函式是在 web 瀏覽器中發生巡覽前引發事件的架構所呼叫。

```
virtual void OnBeforeNavigate2(
    LPCTSTR lpszURL,
    DWORD nFlags,
    LPCTSTR lpszTargetFrameName,
    CByteArray& baPostedData,
    LPCTSTR lpszHeaders,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
字串，包含要巡覽至 URL 的指標。

*nFlags*<br/>
保留供未來使用。

*lpszTargetFrameName*<br/>
字串，其中包含要顯示的資源，或如果沒有具名的畫面格以資源為目標，則為 NULL 的框架名稱。

*baPostedData*<br/>
參考`CByteArray`物件，其中包含要傳送至伺服器，如果正在使用 HTTP POST 交易的資料。

*lpszHeaders*<br/>
包含傳送到伺服器 (HTTP Url) 的其他 HTTP 標頭的字串指標。 標頭可以指定等項目，做為所需的伺服器，也就是傳遞至伺服器或狀態碼的資料類型的動作。

*pbCancel*<br/>
取消旗標的指標。 應用程式可以將這個參數設定為非零值，以取消瀏覽作業，或為零，以允許它繼續。

##  <a name="oncommandstatechange"></a>  CHtmlView::OnCommandStateChange

此成員函式會通知應用程式的 web 瀏覽器命令啟用的狀態已變更的架構所呼叫。

```
virtual void OnCommandStateChange(
    long nCommand,
    BOOL bEnable);
```

### <a name="parameters"></a>參數

*nCommand*<br/>
其已啟用的狀態已變更的命令識別碼。

*bEnable*<br/>
啟用的狀態。 如果命令已啟用，或如果已停用則為零，則此參數為非零值。

##  <a name="ondocumentcomplete"></a>  CHtmlView::OnDocumentComplete

此成員函式會通知應用程式的文件到達 READYSTATE_COMPLETE 狀態的架構所呼叫。

```
virtual void OnDocumentComplete(LPCTSTR lpszURL);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
評估為 URL，也就是 UNC 字串的指標檔案的名稱，或巡覽至的 PIDL （項目識別項清單指標）。

### <a name="remarks"></a>備註

並非每個畫面格會引發此事件，但每個畫面格，就會引發[OnDownloadBegin](#ondownloadbegin)事件就會引發對應`OnDocumentComplete`事件。

所指定的 URL *lpszURL*可能會不同於瀏覽器已告知瀏覽至，因為此 URL 是正式化和完整 URL 的 URL。 比方說，如果應用程式指定 URL 的"www.microsoft.com"的呼叫中要[Navigate](#navigate)或[Navigate2](#navigate2)，傳遞的 URL`OnNavigateComplete2`將會 「<http://www.microsoft.com/>"。 此外，如果伺服器已被瀏覽器重新導向至不同的 URL，重新導向的 URL 將會反映這裡。

##  <a name="ondocwindowactivate"></a>  CHtmlView::OnDocWindowActivate

從 Internet Explorer 或 MSHTML 實作的呼叫`IOleInPlaceActiveObject::OnDocWindowActivate`，這會在容器文件視窗啟用或停用時通知作用中的就地物件。

```
virtual HRESULT OnDocWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*fActivate*<br/>
表示文件視窗的狀態。 如果此值為非零值，正在啟動視窗。 如果此值為零，會在視窗已停用。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnDocWindowActivate`回應`OnDocWindowActivate`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::OnDocWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753261\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="ondownloadbegin"></a>  CHtmlView::OnDownloadBegin

開始下載文件的架構會呼叫此成員函式。

```
virtual void OnDownloadBegin();
```

### <a name="remarks"></a>備註

時會引發此事件後不久[OnBeforeNavigate2](#onbeforenavigate2)事件，除非則會取消巡覽。 任何動畫或 「 忙碌 」 的容器需要顯示的指示，都應該連接到此事件。

##  <a name="ondownloadcomplete"></a>  CHtmlView::OnDownloadComplete

表示巡覽作業結束、 暫止或失敗，架構會呼叫此成員函式。

```
virtual void OnDownloadComplete();
```

##  <a name="onenablemodeless"></a>  CHtmlView::OnEnableModeless

當 Internet Explorer 或 MSHTML 顯示強制回應 UI 時呼叫。

```
virtual HRESULT OnEnableModeless(BOOL fEnable);
```

### <a name="parameters"></a>參數

*fEnable*<br/>
指出主機的非強制回應對話方塊已啟用或停用。 如果此值為非零值，則會啟用非強制回應對話方塊。 如果此值為零，則會停用非強制回應對話方塊。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

啟用或停用非強制回應對話方塊，當容器建立或終結強制回應對話方塊。 覆寫`OnEnableModeless`回應`EnableModeless`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::EnableModeless](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753253\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onfilterdataobject"></a>  CHtmlView::OnFilterDataObject

Internet Explorer 或 MSHTML 在主機上呼叫，允許主機替換 Internet Explorer 或 MSHTML 的資料物件。

```
virtual HRESULT OnFilterDataObject(
    LPDATAOBJECT pDataObject,
    LPDATAOBJECT* ppDataObject);
```

### <a name="parameters"></a>參數

*pDataObject*<br/>
位址[IDataObject](/windows/desktop/api/objidl/nn-objidl-idataobject) Internet Explorer 或 MSHTML 所提供的介面。

*ppDataObject*<br/>
接收的地址`IDataObject`主應用程式提供的介面指標。 此參數的內容應該一律先初始化為 NULL，即使方法失敗。

### <a name="return-value"></a>傳回值

如果資料物件會被取代，為 S_OK、 S_FALSE，如果資料物件不會被取代或 OLE 定義的錯誤程式碼發生錯誤。

### <a name="remarks"></a>備註

覆寫`OnFilterDataObject`回應`FilterDataObject`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::FilterDataObject](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753254\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onframewindowactivate"></a>  CHtmlView::OnFrameWindowActivate

從 [IOleInPlaceActiveObject::OnFrameWindowActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-onframewindowactivate) 呼叫，在容器的最上層框架視窗啟用或停用時通知物件。

```
virtual HRESULT OnFrameWindowActivate(BOOL fActivate);
```

### <a name="parameters"></a>參數

*fActivate*<br/>
表示容器的最上層框架視窗的狀態。 如果此值為非零值，正在啟動視窗。 如果此值為零，會在視窗已停用。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnFrameWindowActivate`回應`OnFrameWindowActivate`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::OnFrameWindowActivate](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753262\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onfullscreen"></a>  CHtmlView::OnFullScreen

此成員函式由架構呼叫時[全螢幕](/previous-versions/aa752119\(v=vs.85\))屬性已變更。

```
virtual void OnFullScreen(BOOL bFullScreen);
```

### <a name="parameters"></a>參數

*bFullScreen*<br/>
如果 Internet Explorer 為全螢幕模式，為非零否則為零。

##  <a name="ongetdroptarget"></a>  CHtmlView::OnGetDropTarget

當它用做為置放目標，讓主機提供另一個 `IDropTarget`。

```
virtual HRESULT OnGetDropTarget(
    LPDROPTARGET pDropTarget,
    LPDROPTARGET* ppDropTarget);
```

### <a name="parameters"></a>參數

*pDropTarget*<br/>
[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget) Internet Explorer 或 MSHTML 建議使用。

*ppDropTarget*<br/>
位址`IDropTarget`接收`IDropTarget`主機想要提供的介面指標。

### <a name="return-value"></a>傳回值

請參閱[IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) Windows SDK，如需傳回碼的清單中。

### <a name="remarks"></a>備註

覆寫`OnGetDropTarget`回應`GetDropTarget`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::GetDropTarget](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753255\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="ongetexternal"></a>  CHtmlView::OnGetExternal

由 Internet Explorer 或 MSHTML 呼叫，以取得主機的 `IDispatch` 介面。

```
virtual HRESULT OnGetExternal(LPDISPATCH* lppDispatch);
```

### <a name="parameters"></a>參數

*lppDispatch*<br/>
收到的位址指標`IDispatch`主應用程式的介面指標。 如果主應用程式公開 Automation 介面，它可以提供 Internet Explorer 或 MSHTML 透過此參數的參考。 此參數的內容應該一律先初始化為 NULL，即使方法失敗。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnGetExternal`回應`GetExternal`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::GetExternal](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753256\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="ongethostinfo"></a>  CHtmlView::OnGetHostInfo

擷取 Internet Explorer 或 MSHTML 主機的 UI 功能。

```
virtual HRESULT OnGetHostInfo(DOCHOSTUIINFO* pInfo);
```

### <a name="parameters"></a>參數

*pInfo*<br/>
位址[DOCHOSTUIINFO](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa770044\(v=vs.85\))接收主機的 UI 功能的結構。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnGetHostInfo`回應`GetHostInfo`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::GetHostInfo](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753257\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="ongetoptionkeypath"></a>  CHtmlView::OnGetOptionKeyPath

呼叫此成員函式，以取得在其下，Internet Explorer 或 MSHTML 儲存使用者喜好設定的登錄機碼。

```
virtual HRESULT OnGetOptionKeyPath(
    LPOLESTR* pchKey,
    DWORD dwReserved);
```

### <a name="parameters"></a>參數

*pchKey*<br/>
解決的`LPOLESTR`接收主機儲存它的預設選項的位置的登錄子機碼字串。 這個子機碼會在 HKEY_CURRENT_USER 機碼底下。 配置此記憶體使用[CoTaskMemAlloc](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemalloc)。 釋放這個記憶體使用的呼叫端的應用程式負責[CoTaskMemFree](/windows/desktop/api/combaseapi/nf-combaseapi-cotaskmemfree)。 這個參數應該一律先初始化為 NULL，即使方法失敗。

*dwReserved*<br/>
保留供未來使用。 目前無法使用。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或否則為 S_FALSE。 如果 S_FALSE、 Internet Explorer 或 MSHTML 會預設為它自己的使用者選項。

### <a name="remarks"></a>備註

覆寫`OnGetOptionKeyPath`回應`GetOptionKeyPath`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::GetOptionKeyPath](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753258\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onhideui"></a>  CHtmlView::OnHideUI

當 Internet Explorer 或 MSHTML 移除其功能表與工具列時，此成員函式是由架構呼叫。

```
virtual HRESULT OnHideUI();
```

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnHideUI`回應`HideUI`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::HideUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753259\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onmenubar"></a>  CHtmlView::OnMenuBar

此成員函式由架構呼叫時[MenuBar](/previous-versions/aa752131\(v=vs.85\))屬性已變更。

```
virtual void OnMenuBar(BOOL bMenuBar);
```

### <a name="parameters"></a>參數

*bMenuBar*<br/>
非零值，如果 Internet Explorer 的功能表列是可見的。否則為零。

##  <a name="onnavigatecomplete2"></a>  CHtmlView::OnNavigateComplete2

（無論是視窗或框架項目） 上的超連結巡覽完畢後，此成員函式是由架構呼叫。

```
virtual void OnNavigateComplete2(LPCTSTR strURL);
```

### <a name="parameters"></a>參數

*strURL*<br/>
字串運算式評估為 URL，UNC 檔案名稱或巡覽至的 PIDL （項目識別項清單指標）。

### <a name="remarks"></a>備註

URL 參數可以是在沒有 URL 表示法是殼層名稱空間實體的情況下 PIDL。

請注意，URL 中包含*strURL*可能會不同於瀏覽器已告知瀏覽至，因為此 URL 是正式化和完整 URL 的 URL。 比方說，如果應用程式指定 URL 的"www.microsoft.com"的呼叫中要[Navigate](#navigate)或[Navigate2](#navigate2)，傳遞的 URL`OnNavigateComplete2`將會 「<http://www.microsoft.com/>"。 此外，如果伺服器已被瀏覽器重新導向至不同的 URL，重新導向的 URL 將會反映這裡。

##  <a name="onnavigateerror"></a>  CHtmlView::OnNavigateError

巡覽至超連結失敗時，由架構呼叫。

```
virtual void OnNavigateError(
    LPCTSTR lpszURL,
    LPCTSTR lpszFrame,
    DWORD dwError,
    BOOL* pbCancel);
```

### <a name="parameters"></a>參數

*lpszURL*<br/>
無法瀏覽 URL。

*lpszFrame*<br/>
要顯示，則為 NULL，如果沒有具名的畫面格的目標資源之資源的框架名稱。

*dwError*<br/>
錯誤狀態碼，如果有的話。 如需可能的 HRESULT 和 HTTP 狀態碼的清單，請參閱 < [NavigateError 事件狀態碼](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768365\(v=vs.85\))。

*pbCancel*<br/>
指定是否要取消瀏覽到錯誤頁面或任何進一步的自動搜尋。 如果為 TRUE （預設值），請繼續瀏覽到錯誤頁面或自動搜尋;如果為 FALSE，則取消瀏覽到錯誤頁面或自動搜尋。

### <a name="remarks"></a>備註

覆寫這個方法，以提供自訂的瀏覽的錯誤處理。

如需詳細資訊，請參閱[DWebBrowserEvents2::NavigateError](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa768286\(v=vs.85\))

##  <a name="onnewwindow2"></a>  CHtmlView::OnNewWindow2

為顯示資源建立新的視窗時，此成員函式是由架構呼叫。

```
virtual void OnNewWindow2(
    LPDISPATCH* ppDisp,
    BOOL* Cancel);
```

### <a name="parameters"></a>參數

*ppDisp*<br/>
可選擇性地接收的介面指標的指標`IDispatch`新 WebBrowser 或 Internet Explorer 物件的介面指標。

*取消*<br/>
取消旗標的指標。 應用程式可以將這個參數設定為非零值，以取消瀏覽作業，或為零，以允許它繼續。

### <a name="remarks"></a>備註

此事件在之前建立從 WebBrowser 中新的視窗。

##  <a name="onprogresschange"></a>  CHtmlView::OnProgressChange

此成員函式會通知應用程式，下載作業的進度已經更新的架構所呼叫。

```
virtual void OnProgressChange(
    long nProgress,
    long nProgressMax);
```

### <a name="parameters"></a>參數

*nProgress*<br/>
顯示，或-1 的進度完成時的整體進度數量。

*nProgressMax*<br/>
最大的進度值。

### <a name="remarks"></a>備註

容器可以使用這個事件所提供的資訊，以顯示到目前為止下載的位元組數目，或更新進度列指示器。

##  <a name="onpropertychange"></a>  CHtmlView::OnPropertyChange

此成員函式會呼叫以通知應用程式的架構可[PutProperty](#putproperty)已變更屬性的值。

```
virtual void OnPropertyChange(LPCTSTR lpszProperty);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
包含屬性名稱的字串指標。

##  <a name="onquit"></a>  CHtmlView::OnQuit

此成員函式呼叫來告知 Internet Explorer 應用程式已經可以結束應用程式架構。

```
virtual void OnQuit();
```

##  <a name="onresizeborder"></a>  CHtmlView::OnResizeBorder

從 Internet Explorer 或 MSHTML 實作的 [IOleInPlaceActiveObject::ResizeBorder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)呼叫，警示物件它需要調整框線空間的大小。

```
virtual HRESULT OnResizeBorder(
    LPCRECT prcBorder,
    LPOLEINPLACEUIWINDOW pUIWindow,
    BOOL fFrameWindow);
```

### <a name="parameters"></a>參數

*prcBorder*<br/>
框線空間的新外部矩形。

*pUIWindow*<br/>
已變更其框線框架或文件視窗物件的介面指標。

*fFrameWindow*<br/>
如果框架視窗呼叫，則為 TRUE [ioleinplaceactiveobject:: Resizeborder](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-resizeborder)，否則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

覆寫`OnResizeBorder`回應`ResizeBorder`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::ResizeBorder](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753263\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onshowcontextmenu"></a>  CHtmlView::OnShowContextMenu

當它正要顯示內容功能表時，從 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnShowContextMenu(
    DWORD dwID,
    LPPOINT ppt,
    LPUNKNOWN pcmdtReserved,
    LPDISPATCH pdispReserved);
```

### <a name="parameters"></a>參數

*dwID*<br/>
要顯示的內容功能表的識別碼。 請參閱`IDocHostUIHandler::ShowContextMenu`值清單的 Windows SDK 中。

*ppt*<br/>
功能表的螢幕座標。

*pcmdtReserved*<br/>
[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)介面用來查詢命令狀態，並在此物件上執行命令。

*pdispReserved*<br/>
在螢幕座標之物件的 IDispatch 介面。 這可讓主機區分特定的物件，以提供更特定的內容。

### <a name="return-value"></a>傳回值

請參閱[IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\))值清單的 Windows SDK 中。

### <a name="remarks"></a>備註

覆寫`OnShowContextMenu`回應`ShowContextMenu`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::ShowContextMenu](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753264\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onshowui"></a>  CHtmlView::OnShowUI

在 Internet Explorer 或 MSHTML 顯示其功能表與工具列之前呼叫。

```
virtual HRESULT OnShowUI(
    DWORD dwID,
    LPOLEINPLACEACTIVEOBJECT pActiveObject,
    LPOLECOMMANDTARGET pCommandTarget,
    LPOLEINPLACEFRAME pFrame,
    LPOLEINPLACEUIWINDOW pDoc);
```

### <a name="parameters"></a>參數

*dwID*<br/>
保留供未來使用。

*pActiveObject*<br/>
[和](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceactiveobject)目前作用中物件的介面。

*pCommandTarget*<br/>
[IOleCommandTarget](/windows/desktop/api/docobj/nn-docobj-iolecommandtarget)物件的介面。

*pFrame*<br/>
[IOleInPlaceFrame](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceframe)物件的介面。 這被必要的功能表和工具列。

*pDoc*<br/>
[IOleInPlaceUIWindow](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceuiwindow)物件介面。 這被必要的工具列。

### <a name="return-value"></a>傳回值

請參閱[IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\))值清單的 Windows SDK 中。

### <a name="remarks"></a>備註

覆寫`OnShowUI`回應`ShowUI`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::ShowUI](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753265\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onstatusbar"></a>  CHtmlView::OnStatusBar

此成員函式由架構呼叫時[StatusBar](/previous-versions//aa768270\(v=vs.85\))屬性已變更。

```
virtual void OnStatusBar(BOOL bStatusBar);
```

### <a name="parameters"></a>參數

*bStatusBar*<br/>
如果 Internet Explorer 的 [狀態] 列會顯示為非零或否則為零。

##  <a name="onstatustextchange"></a>  CHtmlView::OnStatusTextChange

通知的應用程式，WebBrowser 控制項相關聯的狀態列文字已經變更，架構會呼叫此成員函式。

```
virtual void OnStatusTextChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
包含新的狀態列文字的字串。

##  <a name="ontheatermode"></a>  CHtmlView::OnTheaterMode

此成員函式由架構呼叫時[TheaterMode](/previous-versions/aa768273\(v=vs.85\))屬性已變更。

```
virtual void OnTheaterMode(BOOL bTheaterMode);
```

### <a name="parameters"></a>參數

*bTheaterMode*<br/>
Internet Explorer 為劇場模式; 如果為非零否則為零。

##  <a name="ontitlechange"></a>  CHtmlView::OnTitleChange

WebBrowser 控制項中文件的標題就會變成可用時，通知應用程式的架構或變更會呼叫此成員函式。

```
virtual void OnTitleChange(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*lpszText*<br/>
新的文件標題。

### <a name="remarks"></a>備註

Html，可能會變更標題;雖然 HTML 仍在下載中，文件的 URL 會設為標題。 實際的標題 （如果有的話） 從剖析 HTML 之後，標題會變更以反映實際的標題。

##  <a name="ontoolbar"></a>  CHtmlView::OnToolBar

此成員函式由架構呼叫時[工具列](/previous-versions/aa768274\(v=vs.85\))屬性已變更。

```
virtual void OnToolBar(BOOL bToolBar);
```

### <a name="parameters"></a>參數

*bToolBar*<br/>
如果 Internet Explorer 工具列為可見，非零值。 否則為零。

##  <a name="ontranslateaccelerator"></a>  CHtmlView::OnTranslateAccelerator

當呼叫 [IOleInPlaceActiveObject::TranslateAccelerator](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceactiveobject-translateaccelerator) 或 [IOleControlSite::TranslateAccelerator](/windows/desktop/api/ocidl/nf-ocidl-iolecontrolsite-translateaccelerator) 處理來自容器訊息佇列的功能表快速鍵訊息時，由 Internet Explorer 或 MSHTML 呼叫。

```
virtual HRESULT OnTranslateAccelerator(
    LPMSG lpMsg,
    const GUID* pguidCmdGroup,
    DWORD nCmdID);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
指向的訊息，可能需要轉譯。

*pguidCmdGroup*<br/>
命令群組識別碼。

*nCmdID*<br/>
命令識別碼。

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或否則為 S_FALSE。

### <a name="remarks"></a>備註

覆寫`OnTranslateAccelerator`回應`TranslateAccelerator`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::TranslateAccelerator](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753266\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="ontranslateurl"></a>  CHtmlView::OnTranslateUrl

由 Internet Explorer 或 MSHTML 呼叫，讓主機有機會修改要載入的 URL。

```
virtual HRESULT OnTranslateUrl(
    DWORD dwTranslate,
    OLECHAR* pchURLIn,
    OLECHAR** ppchURLOut);
```

### <a name="parameters"></a>參數

*dwTranslate*<br/>
保留供未來使用。

*pchURLIn*<br/>
提供的 Internet Explorer 或 mshtml 呼叫，表示要轉譯的 URL 字串的位址。

*ppchURLOut*<br/>
接收轉譯的 URL 位址的字串指標的位址。 主機會配置緩衝區使用的工作記憶體配置器。 此參數的內容應該一律先初始化為 NULL，即使不會轉譯 URL 或方法失敗。

### <a name="return-value"></a>傳回值

`S_OK` 如果 URL 已轉譯，如果 URL 不翻譯，S_FALSE 或 OLE 定義的錯誤程式碼如果發生錯誤。

### <a name="remarks"></a>備註

覆寫`OnTranslateUrl`回應`TranslateUrl`從 Microsoft 網頁瀏覽器控制項的通知。 請參閱[IDocHostUIHandler::TranslateUrl](/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753267\(v=vs.85\)) Windows sdk for 的詳細資訊。

##  <a name="onupdateui"></a>  CHtmlView::OnUpdateUI

通知主機命令狀態已變更。

```
virtual HRESULT OnUpdateUI();
```

### <a name="return-value"></a>傳回值

如果成功，為 S_OK 或 OLE 定義的錯誤程式碼，否則。

### <a name="remarks"></a>備註

主機應該更新工具列按鈕的狀態。 這個方法會呼叫從傳回的值為何`ShowUI`。 覆寫`OnUpdateUI`回應`UpdateUI`從 Microsoft 網頁瀏覽器控制項的通知。

##  <a name="onvisible"></a>  CHtmlView::OnVisible

當 WebBrowser 的視窗應該要顯示或隱藏，此成員函式是由架構呼叫。

```
virtual void OnVisible(BOOL bVisible);
```

### <a name="parameters"></a>參數

*bVisible*<br/>
如果物件為可見，非零值。 否則為零。

### <a name="remarks"></a>備註

這可讓物件控制主機視窗，以其運作方式與 Internet Explorer 視窗以相同方式運作。

##  <a name="putproperty"></a>  CHtmlView::PutProperty

呼叫此成員函式，若要設定與指定物件相關聯的屬性。

```
void PutProperty(
    LPCTSTR lpszProperty,
    const VARIANT& vtValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    double dValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    long lValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    LPCTSTR lpszValue);

void PutProperty(
    LPCTSTR lpszPropertyName,
    short nValue);
```

### <a name="parameters"></a>參數

*lpszProperty*<br/>
字串，包含要設定的屬性。

*vtValue*<br/>
新屬性的值由*lpszProperty*。

*lpszPropertyName*<br/>
包含要設定的屬性名稱的字串指標。

*dValue*<br/>
屬性的新值。

*lValue*<br/>
屬性的新值。

*lpszValue*<br/>
包含屬性的新值的字串指標。

*nValue*<br/>
屬性的新值。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="queryformscommand"></a>  CHtmlView::QueryFormsCommand

查詢使用者介面事件所產生之一或多個命令的狀態。

```
HRESULT QueryFormsCommand(
    DWORD dwCommandID,
    BOOL* pbSupported,
    BOOL* pbEnabled,
    BOOL* pbChecked);
```

### <a name="parameters"></a>參數

*dwCommandID*<br/>
要查詢的命令識別項。

*pbSupported*<br/>
指標，BOOL，指定如果命令 (由*dwCommandID*) 支援。 如果為 TRUE，支援的命令;否則為 FALSE。

*pbEnabled*<br/>
指標，BOOL，指定如果命令 (由*dwCommandID*) 已啟用。 如果為 TRUE，支援的命令;否則為 FALSE。

*pbChecked*<br/>
指標，BOOL，指定如果命令 (由*dwCommandID*) 核取。 如果為 TRUE，支援的命令;否則為 FALSE。

### <a name="return-value"></a>傳回值

標準的 HRESULT 值。 如需可能值的完整清單，請參閱 < [IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus) Windows SDK 中。

### <a name="remarks"></a>備註

`QueryFormsCommand` 實作的行為[IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法。

##  <a name="querystatuswb"></a>  CHtmlView::QueryStatusWB

呼叫此成員函式來查詢命令狀態。

```
OLECMDF QueryStatusWB(OLECMDID cmdID) const;
```

### <a name="parameters"></a>參數

*cmdID*<br/>
[OLECMDID](/windows/desktop/api/docobj/ne-docobj-olecmdid) ，呼叫端需要狀態資訊的命令的值。

### <a name="return-value"></a>傳回值

地址[OLECMDF](/windows/desktop/api/docobj/ne-docobj-olecmdf)接收命令的狀態的值。

### <a name="remarks"></a>備註

`QueryStatusWB` 實作的行為[IOleCommandTarget::QueryStatus](/windows/desktop/api/docobj/nf-docobj-iolecommandtarget-querystatus)方法。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="refresh"></a>  CHtmlView::Refresh

重新載入的 URL 或網頁瀏覽器目前顯示的檔案。

```
void Refresh();
```

### <a name="remarks"></a>備註

`Refresh` 不含任何參數，來設定重新整理層級。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="refresh2"></a>  CHtmlView::Refresh2

重新載入 Internet Explorer 目前顯示的檔案。

```
void Refresh2(int nLevel);
```

### <a name="parameters"></a>參數

*nLevel*<br/>
指定的重新整理層級變數的位址。 可能的變數中定義[RefreshConstants](/previous-versions/aa768363\(v=vs.85\))，Windows SDK 中。

### <a name="remarks"></a>備註

不同於[重新整理](#refresh)，`Refresh2`包含指定的重新整理層級的參數。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setaddressbar"></a>  CHtmlView::SetAddressBar

呼叫此成員函式，以顯示或隱藏 Internet Explorer 物件的 [網址] 列。

```
void SetAddressBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零值，以顯示網址 列中;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="setfullscreen"></a>  CHtmlView::SetFullScreen

呼叫此成員函式，將 Internet Explorer 設定為任一種全螢幕] 或 [標準視窗模式。

```
void SetFullScreen(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零代表全螢幕模式;否則為零。

### <a name="remarks"></a>備註

在全螢幕模式中，Internet Explorer 主視窗最大化，並會隱藏狀態列、 工具列、 功能表列和標題列。

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="setheight"></a>  CHtmlView::SetHeight

呼叫此成員函式，來設定 Internet Explorer 主視窗的高度。

```
void SetHeight(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
像素為單位，在主視窗的高度。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setleft"></a>  CHtmlView::SetLeft

設定 Internet Explorer 主視窗的水平位置。

```
void SetLeft(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
主視窗左邊緣的螢幕座標。

##  <a name="setmenubar"></a>  CHtmlView::SetMenuBar

呼叫此成員函式，以顯示或隱藏 Internet Explorer 的功能表列。

```
void SetMenuBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零值，以顯示功能表列;否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="setoffline"></a>  CHtmlView::SetOffline

呼叫此成員函式，來設定值，指出 WebBrowser 控制項目前在離線模式中作業。

```
void SetOffline(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
若要從本機快取中; 讀取 Nonzero否則為零。

### <a name="remarks"></a>備註

在離線模式中，瀏覽器會讀取 HTML 頁面，從本機快取，而不是從來源文件。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasbrowser"></a>  CHtmlView::SetRegisterAsBrowser

呼叫此成員函式，來設定值，指出 WebBrowser 控制項是否註冊為目標名稱解析的最上層瀏覽器。

```
void SetRegisterAsBrowser(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
判斷是否要將 Internet Explorer 登錄做為最上層的瀏覽器。 如果是非零值，網頁瀏覽器會註冊為最上層的瀏覽器;如果是零，它不是最上層的瀏覽器。 預設值是零。

### <a name="remarks"></a>備註

最上層的瀏覽器是在登錄中的預設瀏覽器設定的瀏覽器。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setregisterasdroptarget"></a>  CHtmlView::SetRegisterAsDropTarget

呼叫此成員函式，來設定值，指出 WebBrowser 控制項是否註冊為巡覽的置放目標。

```
void SetRegisterAsDropTarget(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
決定如果 WebBrowser 控制項是否註冊為巡覽的置放目標。 如果是非零值，該物件會註冊為置放目標;如果是零，它不是置放目標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setsilent"></a>  CHtmlView::SetSilent

呼叫此成員函式設定值，指出是否可以顯示任何對話方塊。

```
void SetSilent(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
如果是非零值，將不會顯示對話方塊。如果是零，則會顯示對話方塊。 預設值是零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setstatusbar"></a>  CHtmlView::SetStatusBar

呼叫此成員函式，以顯示 [狀態] 列。

```
void SetStatusBar(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零值，如果 [狀態] 列是可見的。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="settheatermode"></a>  CHtmlView::SetTheaterMode

呼叫此成員函式設定值，指出 WebBrowser 控制項是否為劇場模式。

```
void SetTheaterMode(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零的值設為劇場模式; 的 WebBrowser 控制項否則為零。 預設值是零。

### <a name="remarks"></a>備註

劇場模式的 web 瀏覽器時，瀏覽器的主視窗填滿整個畫面，包含導覽工具的最少的工具列會出現，而狀態列會出現在畫面右上角。

適用於 Internet Explorer 和 WebBrowser。

##  <a name="settoolbar"></a>  CHtmlView::SetToolBar

呼叫此成員函式，以顯示或隱藏 Internet Explorer 工具列。

```
void SetToolBar(int nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
指出是否要顯示工具列。 如果工具列顯示; 為非零否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer。 如果您使用 WebBrowser 控制項使用這個呼叫，它會傳回任何錯誤，但它將會忽略這個呼叫。

##  <a name="settop"></a>  CHtmlView::SetTop

呼叫此成員函式設定的 WebBrowser 控制項內部的上邊緣和其容器頂端之間的距離

```
void SetTop(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
在主視窗的上邊緣的螢幕座標。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setvisible"></a>  CHtmlView::SetVisible

呼叫此成員函式設定 WebBrowser 控制項的可見性狀態。

```
void SetVisible(BOOL bNewValue);
```

### <a name="parameters"></a>參數

*bNewValue*<br/>
非零值，如果控制項為可見的。否則為零。

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

##  <a name="setwidth"></a>  CHtmlView::SetWidth

設定 Internet Explorer 主視窗的寬度。

```
void SetWidth(long nNewValue);
```

### <a name="parameters"></a>參數

*nNewValue*<br/>
寬度，單位為像素的 Internet Explorer 主視窗。

##  <a name="stop"></a>  CHtmlView::Stop

呼叫此成員函式，以取消任何暫止的瀏覽或下載作業，並停止任何動態頁面項目，例如背景聲音和動畫。

```
void Stop();
```

### <a name="remarks"></a>備註

適用於 Internet Explorer 和 WebBrowser。

## <a name="see-also"></a>另請參閱

[MFC 範例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CFormView 類別](../../mfc/reference/cformview-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[IWebBrowser2](/windows/desktop/api/exdisp/nn-exdisp-iwebbrowser2)
