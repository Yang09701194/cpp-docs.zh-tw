---
title: CListCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CListCtrl
- AFXCMN/CListCtrl
- AFXCMN/CListCtrl::CListCtrl
- AFXCMN/CListCtrl::ApproximateViewRect
- AFXCMN/CListCtrl::Arrange
- AFXCMN/CListCtrl::CancelEditLabel
- AFXCMN/CListCtrl::Create
- AFXCMN/CListCtrl::CreateDragImage
- AFXCMN/CListCtrl::CreateEx
- AFXCMN/CListCtrl::DeleteAllItems
- AFXCMN/CListCtrl::DeleteColumn
- AFXCMN/CListCtrl::DeleteItem
- AFXCMN/CListCtrl::DrawItem
- AFXCMN/CListCtrl::EditLabel
- AFXCMN/CListCtrl::EnableGroupView
- AFXCMN/CListCtrl::EnsureVisible
- AFXCMN/CListCtrl::FindItem
- AFXCMN/CListCtrl::GetBkColor
- AFXCMN/CListCtrl::GetBkImage
- AFXCMN/CListCtrl::GetCallbackMask
- AFXCMN/CListCtrl::GetCheck
- AFXCMN/CListCtrl::GetColumn
- AFXCMN/CListCtrl::GetColumnOrderArray
- AFXCMN/CListCtrl::GetColumnWidth
- AFXCMN/CListCtrl::GetCountPerPage
- AFXCMN/CListCtrl::GetEditControl
- AFXCMN/CListCtrl::GetEmptyText
- AFXCMN/CListCtrl::GetExtendedStyle
- AFXCMN/CListCtrl::GetFirstSelectedItemPosition
- AFXCMN/CListCtrl::GetFocusedGroup
- AFXCMN/CListCtrl::GetGroupCount
- AFXCMN/CListCtrl::GetGroupInfo
- AFXCMN/CListCtrl::GetGroupInfoByIndex
- AFXCMN/CListCtrl::GetGroupMetrics
- AFXCMN/CListCtrl::GetGroupRect
- AFXCMN/CListCtrl::GetGroupState
- AFXCMN/CListCtrl::GetHeaderCtrl
- AFXCMN/CListCtrl::GetHotCursor
- AFXCMN/CListCtrl::GetHotItem
- AFXCMN/CListCtrl::GetHoverTime
- AFXCMN/CListCtrl::GetImageList
- AFXCMN/CListCtrl::GetInsertMark
- AFXCMN/CListCtrl::GetInsertMarkColor
- AFXCMN/CListCtrl::GetInsertMarkRect
- AFXCMN/CListCtrl::GetItem
- AFXCMN/CListCtrl::GetItemCount
- AFXCMN/CListCtrl::GetItemData
- AFXCMN/CListCtrl::GetItemIndexRect
- AFXCMN/CListCtrl::GetItemPosition
- AFXCMN/CListCtrl::GetItemRect
- AFXCMN/CListCtrl::GetItemSpacing
- AFXCMN/CListCtrl::GetItemState
- AFXCMN/CListCtrl::GetItemText
- AFXCMN/CListCtrl::GetNextItem
- AFXCMN/CListCtrl::GetNextItemIndex
- AFXCMN/CListCtrl::GetNextSelectedItem
- AFXCMN/CListCtrl::GetNumberOfWorkAreas
- AFXCMN/CListCtrl::GetOrigin
- AFXCMN/CListCtrl::GetOutlineColor
- AFXCMN/CListCtrl::GetSelectedColumn
- AFXCMN/CListCtrl::GetSelectedCount
- AFXCMN/CListCtrl::GetSelectionMark
- AFXCMN/CListCtrl::GetStringWidth
- AFXCMN/CListCtrl::GetSubItemRect
- AFXCMN/CListCtrl::GetTextBkColor
- AFXCMN/CListCtrl::GetTextColor
- AFXCMN/CListCtrl::GetTileInfo
- AFXCMN/CListCtrl::GetTileViewInfo
- AFXCMN/CListCtrl::GetToolTips
- AFXCMN/CListCtrl::GetTopIndex
- AFXCMN/CListCtrl::GetView
- AFXCMN/CListCtrl::GetViewRect
- AFXCMN/CListCtrl::GetWorkAreas
- AFXCMN/CListCtrl::HasGroup
- AFXCMN/CListCtrl::HitTest
- AFXCMN/CListCtrl::InsertColumn
- AFXCMN/CListCtrl::InsertGroup
- AFXCMN/CListCtrl::InsertGroupSorted
- AFXCMN/CListCtrl::InsertItem
- AFXCMN/CListCtrl::InsertMarkHitTest
- AFXCMN/CListCtrl::IsGroupViewEnabled
- AFXCMN/CListCtrl::IsItemVisible
- AFXCMN/CListCtrl::MapIDToIndex
- AFXCMN/CListCtrl::MapIndexToID
- AFXCMN/CListCtrl::MoveGroup
- AFXCMN/CListCtrl::MoveItemToGroup
- AFXCMN/CListCtrl::RedrawItems
- AFXCMN/CListCtrl::RemoveAllGroups
- AFXCMN/CListCtrl::RemoveGroup
- AFXCMN/CListCtrl::Scroll
- AFXCMN/CListCtrl::SetBkColor
- AFXCMN/CListCtrl::SetBkImage
- AFXCMN/CListCtrl::SetCallbackMask
- AFXCMN/CListCtrl::SetCheck
- AFXCMN/CListCtrl::SetColumn
- AFXCMN/CListCtrl::SetColumnOrderArray
- AFXCMN/CListCtrl::SetColumnWidth
- AFXCMN/CListCtrl::SetExtendedStyle
- AFXCMN/CListCtrl::SetGroupInfo
- AFXCMN/CListCtrl::SetGroupMetrics
- AFXCMN/CListCtrl::SetHotCursor
- AFXCMN/CListCtrl::SetHotItem
- AFXCMN/CListCtrl::SetHoverTime
- AFXCMN/CListCtrl::SetIconSpacing
- AFXCMN/CListCtrl::SetImageList
- AFXCMN/CListCtrl::SetInfoTip
- AFXCMN/CListCtrl::SetInsertMark
- AFXCMN/CListCtrl::SetInsertMarkColor
- AFXCMN/CListCtrl::SetItem
- AFXCMN/CListCtrl::SetItemCount
- AFXCMN/CListCtrl::SetItemCountEx
- AFXCMN/CListCtrl::SetItemData
- AFXCMN/CListCtrl::SetItemIndexState
- AFXCMN/CListCtrl::SetItemPosition
- AFXCMN/CListCtrl::SetItemState
- AFXCMN/CListCtrl::SetItemText
- AFXCMN/CListCtrl::SetOutlineColor
- AFXCMN/CListCtrl::SetSelectedColumn
- AFXCMN/CListCtrl::SetSelectionMark
- AFXCMN/CListCtrl::SetTextBkColor
- AFXCMN/CListCtrl::SetTextColor
- AFXCMN/CListCtrl::SetTileInfo
- AFXCMN/CListCtrl::SetTileViewInfo
- AFXCMN/CListCtrl::SetToolTips
- AFXCMN/CListCtrl::SetView
- AFXCMN/CListCtrl::SetWorkAreas
- AFXCMN/CListCtrl::SortGroups
- AFXCMN/CListCtrl::SortItems
- AFXCMN/CListCtrl::SortItemsEx
- AFXCMN/CListCtrl::SubItemHitTest
- AFXCMN/CListCtrl::Update
helpviewer_keywords:
- CListCtrl [MFC], CListCtrl
- CListCtrl [MFC], ApproximateViewRect
- CListCtrl [MFC], Arrange
- CListCtrl [MFC], CancelEditLabel
- CListCtrl [MFC], Create
- CListCtrl [MFC], CreateDragImage
- CListCtrl [MFC], CreateEx
- CListCtrl [MFC], DeleteAllItems
- CListCtrl [MFC], DeleteColumn
- CListCtrl [MFC], DeleteItem
- CListCtrl [MFC], DrawItem
- CListCtrl [MFC], EditLabel
- CListCtrl [MFC], EnableGroupView
- CListCtrl [MFC], EnsureVisible
- CListCtrl [MFC], FindItem
- CListCtrl [MFC], GetBkColor
- CListCtrl [MFC], GetBkImage
- CListCtrl [MFC], GetCallbackMask
- CListCtrl [MFC], GetCheck
- CListCtrl [MFC], GetColumn
- CListCtrl [MFC], GetColumnOrderArray
- CListCtrl [MFC], GetColumnWidth
- CListCtrl [MFC], GetCountPerPage
- CListCtrl [MFC], GetEditControl
- CListCtrl [MFC], GetEmptyText
- CListCtrl [MFC], GetExtendedStyle
- CListCtrl [MFC], GetFirstSelectedItemPosition
- CListCtrl [MFC], GetFocusedGroup
- CListCtrl [MFC], GetGroupCount
- CListCtrl [MFC], GetGroupInfo
- CListCtrl [MFC], GetGroupInfoByIndex
- CListCtrl [MFC], GetGroupMetrics
- CListCtrl [MFC], GetGroupRect
- CListCtrl [MFC], GetGroupState
- CListCtrl [MFC], GetHeaderCtrl
- CListCtrl [MFC], GetHotCursor
- CListCtrl [MFC], GetHotItem
- CListCtrl [MFC], GetHoverTime
- CListCtrl [MFC], GetImageList
- CListCtrl [MFC], GetInsertMark
- CListCtrl [MFC], GetInsertMarkColor
- CListCtrl [MFC], GetInsertMarkRect
- CListCtrl [MFC], GetItem
- CListCtrl [MFC], GetItemCount
- CListCtrl [MFC], GetItemData
- CListCtrl [MFC], GetItemIndexRect
- CListCtrl [MFC], GetItemPosition
- CListCtrl [MFC], GetItemRect
- CListCtrl [MFC], GetItemSpacing
- CListCtrl [MFC], GetItemState
- CListCtrl [MFC], GetItemText
- CListCtrl [MFC], GetNextItem
- CListCtrl [MFC], GetNextItemIndex
- CListCtrl [MFC], GetNextSelectedItem
- CListCtrl [MFC], GetNumberOfWorkAreas
- CListCtrl [MFC], GetOrigin
- CListCtrl [MFC], GetOutlineColor
- CListCtrl [MFC], GetSelectedColumn
- CListCtrl [MFC], GetSelectedCount
- CListCtrl [MFC], GetSelectionMark
- CListCtrl [MFC], GetStringWidth
- CListCtrl [MFC], GetSubItemRect
- CListCtrl [MFC], GetTextBkColor
- CListCtrl [MFC], GetTextColor
- CListCtrl [MFC], GetTileInfo
- CListCtrl [MFC], GetTileViewInfo
- CListCtrl [MFC], GetToolTips
- CListCtrl [MFC], GetTopIndex
- CListCtrl [MFC], GetView
- CListCtrl [MFC], GetViewRect
- CListCtrl [MFC], GetWorkAreas
- CListCtrl [MFC], HasGroup
- CListCtrl [MFC], HitTest
- CListCtrl [MFC], InsertColumn
- CListCtrl [MFC], InsertGroup
- CListCtrl [MFC], InsertGroupSorted
- CListCtrl [MFC], InsertItem
- CListCtrl [MFC], InsertMarkHitTest
- CListCtrl [MFC], IsGroupViewEnabled
- CListCtrl [MFC], IsItemVisible
- CListCtrl [MFC], MapIDToIndex
- CListCtrl [MFC], MapIndexToID
- CListCtrl [MFC], MoveGroup
- CListCtrl [MFC], MoveItemToGroup
- CListCtrl [MFC], RedrawItems
- CListCtrl [MFC], RemoveAllGroups
- CListCtrl [MFC], RemoveGroup
- CListCtrl [MFC], Scroll
- CListCtrl [MFC], SetBkColor
- CListCtrl [MFC], SetBkImage
- CListCtrl [MFC], SetCallbackMask
- CListCtrl [MFC], SetCheck
- CListCtrl [MFC], SetColumn
- CListCtrl [MFC], SetColumnOrderArray
- CListCtrl [MFC], SetColumnWidth
- CListCtrl [MFC], SetExtendedStyle
- CListCtrl [MFC], SetGroupInfo
- CListCtrl [MFC], SetGroupMetrics
- CListCtrl [MFC], SetHotCursor
- CListCtrl [MFC], SetHotItem
- CListCtrl [MFC], SetHoverTime
- CListCtrl [MFC], SetIconSpacing
- CListCtrl [MFC], SetImageList
- CListCtrl [MFC], SetInfoTip
- CListCtrl [MFC], SetInsertMark
- CListCtrl [MFC], SetInsertMarkColor
- CListCtrl [MFC], SetItem
- CListCtrl [MFC], SetItemCount
- CListCtrl [MFC], SetItemCountEx
- CListCtrl [MFC], SetItemData
- CListCtrl [MFC], SetItemIndexState
- CListCtrl [MFC], SetItemPosition
- CListCtrl [MFC], SetItemState
- CListCtrl [MFC], SetItemText
- CListCtrl [MFC], SetOutlineColor
- CListCtrl [MFC], SetSelectedColumn
- CListCtrl [MFC], SetSelectionMark
- CListCtrl [MFC], SetTextBkColor
- CListCtrl [MFC], SetTextColor
- CListCtrl [MFC], SetTileInfo
- CListCtrl [MFC], SetTileViewInfo
- CListCtrl [MFC], SetToolTips
- CListCtrl [MFC], SetView
- CListCtrl [MFC], SetWorkAreas
- CListCtrl [MFC], SortGroups
- CListCtrl [MFC], SortItems
- CListCtrl [MFC], SortItemsEx
- CListCtrl [MFC], SubItemHitTest
- CListCtrl [MFC], Update
ms.assetid: fe08a1ca-4b05-4ff7-a12a-ee4c765a2197
ms.openlocfilehash: 850c16420606452414cbe284c5f9f25031859c93
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/04/2019
ms.locfileid: "57304518"
---
# <a name="clistctrl-class"></a>CListCtrl 類別

封裝「清單檢視控制項」的功能，顯示項目集合，其中每個項目是由圖示 (來自影像清單) 和標籤所組成的。

## <a name="syntax"></a>語法

```
class CListCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CListCtrl::CListCtrl](#clistctrl)|建構 `CListCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CListCtrl::ApproximateViewRect](#approximateviewrect)|決定顯示清單檢視控制項的項目所需的高度與寬度。|
|[CListCtrl::Arrange](#arrange)|對齊格線中的項目。|
|[CListCtrl::CancelEditLabel](#canceleditlabel)|取消編輯作業的項目文字。|
|[CListCtrl::Create](#create)|建立清單控制項，並將它附加至`CListCtrl`物件。|
|[CListCtrl::CreateDragImage](#createdragimage)|建立指定的項目拖曳影像清單。|
|[CListCtrl::CreateEx](#createex)|使用指定的 Windows 延伸樣式中建立清單控制項，並將它附加至`CListCtrl`物件。|
|[CListCtrl::DeleteAllItems](#deleteallitems)|從控制項中刪除所有項目。|
|[CListCtrl::DeleteColumn](#deletecolumn)|從清單檢視控制項中刪除資料行。|
|[CListCtrl::DeleteItem](#deleteitem)|從控制項中刪除的項目。|
|[CListCtrl::DrawItem](#drawitem)|當主控描繪控制項變更的視覺外觀時呼叫。|
|[CListCtrl::EditLabel](#editlabel)|開始進行就地編輯的項目文字。|
|[CListCtrl::EnableGroupView](#enablegroupview)|啟用或停用是否顯示為群組的清單檢視控制項中的項目。|
|[CListCtrl::EnsureVisible](#ensurevisible)|可確保項目為可見。|
|[CListCtrl::FindItem](#finditem)|搜尋具有指定特性的清單檢視項目。|
|[CListCtrl::GetBkColor](#getbkcolor)|擷取清單檢視控制項的背景色彩。|
|[CListCtrl::GetBkImage](#getbkimage)|擷取目前的背景影像的清單檢視控制項。|
|[CListCtrl::GetCallbackMask](#getcallbackmask)|擷取清單檢視控制項的回呼遮罩。|
|[CListCtrl::GetCheck](#getcheck)|擷取目前的項目相關聯之狀態影像的顯示狀態。|
|[CListCtrl::GetColumn](#getcolumn)|擷取控制項的資料行的屬性。|
|[CListCtrl::GetColumnOrderArray](#getcolumnorderarray)|擷取清單檢視控制項的資料行順序 （由左到右）。|
|[CListCtrl::GetColumnWidth](#getcolumnwidth)|擷取報表檢視] 或 [清單檢視中的資料行的寬度。|
|[CListCtrl::GetCountPerPage](#getcountperpage)|計算可以垂直放入清單檢視控制項中的項目數目。|
|[CListCtrl::GetEditControl](#geteditcontrol)|擷取用來編輯項目的文字編輯控制項的控制代碼。|
|[CListCtrl::GetEmptyText](#getemptytext)|擷取要顯示目前的清單檢視控制項為空字串。|
|[CListCtrl::GetExtendedStyle](#getextendedstyle)|擷取目前的延伸的樣式的清單檢視控制項。|
|[CListCtrl::GetFirstSelectedItemPosition](#getfirstselecteditemposition)|擷取清單檢視控制項中的第一個選取的清單檢視項目位置。|
|[CListCtrl::GetFocusedGroup](#getfocusedgroup)|擷取具有鍵盤焦點在目前的清單檢視控制項中的群組。|
|[CListCtrl::GetGroupCount](#getgroupcount)|擷取目前的清單檢視控制項中的群組數目。|
|[CListCtrl::GetGroupInfo](#getgroupinfo)|取得一組指定的清單檢視控制項中的資訊。|
|[CListCtrl::GetGroupInfoByIndex](#getgroupinfobyindex)|擷取目前的清單檢視控制項中的指定群組的相關資訊。|
|[CListCtrl::GetGroupMetrics](#getgroupmetrics)|擷取群組的計量。|
|[CListCtrl::GetGroupRect](#getgrouprect)|擷取目前的清單檢視控制項中的指定群組的周框矩形。|
|[CListCtrl::GetGroupState](#getgroupstate)|擷取目前的清單檢視控制項中的指定群組的狀態。|
|[CListCtrl::GetHeaderCtrl](#getheaderctrl)|擷取的標頭控制項的清單檢視控制項。|
|[CListCtrl::GetHotCursor](#gethotcursor)|擷取清單檢視控制項中啟用熱追蹤時所用的游標。|
|[CListCtrl::GetHotItem](#gethotitem)|擷取目前游標下的清單檢視項目。|
|[CListCtrl::GetHoverTime](#gethovertime)|擷取清單檢視控制項的目前滑鼠停留時間。|
|[CListCtrl::GetImageList](#getimagelist)|擷取用於繪圖的清單檢視項目的影像清單的控制代碼。|
|[CListCtrl::GetInsertMark](#getinsertmark)|擷取目前的插入標記的位置。|
|[CListCtrl::GetInsertMarkColor](#getinsertmarkcolor)|擷取目前的插入標記的色彩。|
|[CListCtrl::GetInsertMarkRect](#getinsertmarkrect)|擷取矩形界限的插入點。|
|[CListCtrl::GetItem](#getitem)|擷取清單檢視項目的屬性。|
|[CListCtrl::GetItemCount](#getitemcount)|擷取清單檢視控制項中的項目數。|
|[CListCtrl::GetItemData](#getitemdata)|擷取項目相關聯的應用程式特定值。|
|[CListCtrl::GetItemIndexRect](#getitemindexrect)|擷取週框的全部或部分中目前的清單檢視控制項的子項目。|
|[CListCtrl::GetItemPosition](#getitemposition)|擷取清單檢視項目的位置。|
|[CListCtrl::GetItemRect](#getitemrect)|擷取項目的週框。|
|[CListCtrl::GetItemSpacing](#getitemspacing)|計算目前的清單檢視控制項中的項目之間的間距。|
|[CListCtrl::GetItemState](#getitemstate)|擷取清單檢視項目的狀態。|
|[CListCtrl::GetItemText](#getitemtext)|擷取清單檢視項目或子項目的文字。|
|[CListCtrl::GetNextItem](#getnextitem)|使用指定的屬性和指定的項目指定關聯性的清單檢視項目搜尋。|
|[CListCtrl::GetNextItemIndex](#getnextitemindex)|擷取具有指定的屬性集的目前清單檢視控制項中項目的索引。|
|[CListCtrl::GetNextSelectedItem](#getnextselecteditem)|擷取清單檢視項目位置，並重複存取下一步 的選取的清單檢視項目的位置索引。|
|[CListCtrl::GetNumberOfWorkAreas](#getnumberofworkareas)|擷取工作區域的清單檢視控制項的目前數目。|
|[CListCtrl::GetOrigin](#getorigin)|擷取目前的檢視原始的清單檢視控制項。|
|[CListCtrl::GetOutlineColor](#getoutlinecolor)|擷取清單檢視控制項的框線色彩。|
|[CListCtrl::GetSelectedColumn](#getselectedcolumn)|擷取在清單控制項中目前選取之資料行的索引。|
|[CListCtrl::GetSelectedCount](#getselectedcount)|擷取清單檢視控制項中選取的項目數目。|
|[CListCtrl::GetSelectionMark](#getselectionmark)|擷取清單檢視控制項的選取範圍標記。|
|[CListCtrl::GetStringWidth](#getstringwidth)|決定要顯示所有指定的字串所需的最小的資料行寬度。|
|[CListCtrl::GetSubItemRect](#getsubitemrect)|擷取清單檢視控制項中項目的週框。|
|[CListCtrl::GetTextBkColor](#gettextbkcolor)|擷取清單檢視控制項的文字背景色彩。|
|[CListCtrl::GetTextColor](#gettextcolor)|擷取清單檢視控制項的文字色彩。|
|[CListCtrl::GetTileInfo](#gettileinfo)|擷取清單檢視控制項中的圖格的相關資訊。|
|[CListCtrl::GetTileViewInfo](#gettileviewinfo)|擷取清單檢視控制項中並排顯示檢視的相關資訊。|
|[CListCtrl::GetToolTips](#gettooltips)|擷取要顯示工具提示的清單檢視控制項使用的工具提示控制項。|
|[CListCtrl::GetTopIndex](#gettopindex)|擷取最上層的可見項目的索引。|
|[CListCtrl::GetView](#getview)|取得清單檢視控制項的檢視。|
|[CListCtrl::GetViewRect](#getviewrect)|擷取清單檢視控制項中的所有項目的週框。|
|[CListCtrl::GetWorkAreas](#getworkareas)|擷取目前的工作區域的清單檢視控制項。|
|[CListCtrl::HasGroup](#hasgroup)|判斷清單檢視控制項是否具有指定的群組。|
|[CListCtrl::HitTest](#hittest)|決定哪個清單檢視項目位於指定的位置。|
|[CListCtrl::InsertColumn](#insertcolumn)|在清單檢視控制項中插入新的資料行。|
|[CListCtrl::InsertGroup](#insertgroup)|插入清單檢視控制項中的群組。|
|[CListCtrl::InsertGroupSorted](#insertgroupsorted)|插入群組的排序清單中指定的群組。|
|[CListCtrl::InsertItem](#insertitem)|在清單檢視控制項中插入新項目。|
|[CListCtrl::InsertMarkHitTest](#insertmarkhittest)|擷取最接近指定點的插入點。|
|[CListCtrl::IsGroupViewEnabled](#isgroupviewenabled)|判斷是否啟用清單檢視控制項的檢視。|
|[CListCtrl::IsItemVisible](#isitemvisible)|指出目前的清單檢視控制項中指定的項目是否可見。|
|[CListCtrl::MapIDToIndex](#mapidtoindex)|將目前的清單檢視控制項中項目的唯一識別碼對應至索引。|
|[CListCtrl::MapIndexToID](#mapindextoid)|將目前的清單檢視控制項中項目的索引對應至唯一的識別碼。|
|[CListCtrl::MoveGroup](#movegroup)|將指定的群組移動。|
|[CListCtrl::MoveItemToGroup](#moveitemtogroup)|移動指定群組，來指定零起始的索引清單檢視控制項。|
|[CListCtrl::RedrawItems](#redrawitems)|強制重新繪製的項目範圍的清單檢視控制項。|
|[CListCtrl::RemoveAllGroups](#removeallgroups)|從清單檢視控制項中移除所有群組。|
|[CListCtrl::RemoveGroup](#removegroup)|從清單檢視控制項中移除指定的群組。|
|[CListCtrl::Scroll](#scroll)|捲動清單檢視控制項的內容。|
|[CListCtrl::SetBkColor](#setbkcolor)|設定清單檢視控制項的背景色彩。|
|[CListCtrl::SetBkImage](#setbkimage)|設定目前的背景影像的清單檢視控制項。|
|[CListCtrl::SetCallbackMask](#setcallbackmask)|設定清單檢視控制項的回呼遮罩。|
|[CListCtrl::SetCheck](#setcheck)|設定目前顯示的項目相關聯之狀態影像的狀態。|
|[CListCtrl::SetColumn](#setcolumn)|設定清單檢視資料行的屬性。|
|[CListCtrl::SetColumnOrderArray](#setcolumnorderarray)|設定清單檢視控制項的資料行順序 （由左到右）。|
|[CListCtrl::SetColumnWidth](#setcolumnwidth)|變更報表檢視] 或 [清單檢視中的資料行的寬度。|
|[CListCtrl::SetExtendedStyle](#setextendedstyle)|設定目前的延伸的樣式的清單檢視控制項。|
|[CListCtrl::SetGroupInfo](#setgroupinfo)|設定為指定的清單檢視控制項群組的資訊。|
|[CListCtrl::SetGroupMetrics](#setgroupmetrics)|設定群組的計量清單檢視控制項。|
|[CListCtrl::SetHotCursor](#sethotcursor)|設定已啟用熱追蹤，清單檢視控制項時所使用的游標。|
|[CListCtrl::SetHotItem](#sethotitem)|設定清單檢視控制項的目前作用的項目。|
|[CListCtrl::SetHoverTime](#sethovertime)|設定目前暫留時間的清單檢視控制項。|
|[CListCtrl::SetIconSpacing](#seticonspacing)|設定清單檢視控制項中的圖示之間的間距。|
|[CListCtrl::SetImageList](#setimagelist)|將影像清單指派給 清單檢視控制項。|
|[CListCtrl::SetInfoTip](#setinfotip)|設定工具提示文字。|
|[CListCtrl::SetInsertMark](#setinsertmark)|將插入點設定為定義的位置。|
|[CListCtrl::SetInsertMarkColor](#setinsertmarkcolor)|將插入點的色彩設定。|
|[CListCtrl::SetItem](#setitem)|設定部分或全部的清單檢視項目的屬性。|
|[CListCtrl::SetItemCount](#setitemcount)|準備新增大量的項目清單檢視控制項。|
|[CListCtrl::SetItemCountEx](#setitemcountex)|設定虛擬清單檢視控制項的項目計數。|
|[CListCtrl::SetItemData](#setitemdata)|設定項目的應用程式特定值。|
|[CListCtrl::SetItemIndexState](#setitemindexstate)|在目前的清單檢視控制項中設定項目的狀態。|
|[CListCtrl::SetItemPosition](#setitemposition)|將項目移至 清單檢視控制項中的指定位置。|
|[CListCtrl::SetItemState](#setitemstate)|變更清單檢視控制項中項目的狀態。|
|[CListCtrl::SetItemText](#setitemtext)|變更清單檢視項目或子項目的文字。|
|[CListCtrl::SetOutlineColor](#setoutlinecolor)|設定清單檢視控制項的框線色彩。|
|[CListCtrl::SetSelectedColumn](#setselectedcolumn)|設定選取的資料行的清單檢視控制項。|
|[CListCtrl::SetSelectionMark](#setselectionmark)|設定的選取範圍標記的清單檢視控制項。|
|[CListCtrl::SetTextBkColor](#settextbkcolor)|清單檢視控制項中設定文字的背景色彩。|
|[CListCtrl::SetTextColor](#settextcolor)|設定清單檢視控制項的文字色彩。|
|[CListCtrl::SetTileInfo](#settileinfo)|設定圖格的清單檢視控制項的資訊。|
|[CListCtrl::SetTileViewInfo](#settileviewinfo)|設定中並排顯示檢視清單檢視控制項使用的資訊。|
|[CListCtrl::SetToolTips](#settooltips)|設定工具提示控制項的清單檢視控制項將用來顯示工具提示。|
|[CListCtrl::SetView](#setview)|設定清單檢視控制項的檢視。|
|[CListCtrl::SetWorkAreas](#setworkareas)|設定位置顯示圖示，在清單檢視控制項中的區域。|
|[CListCtrl::SortGroups](#sortgroups)|排序清單的群組檢視的使用者定義函式的控制項。|
|[CListCtrl::SortItems](#sortitems)|使用應用程式定義的比較函式的清單檢視項目進行排序。|
|[CListCtrl::SortItemsEx](#sortitemsex)|使用應用程式定義的比較函式的清單檢視項目進行排序。|
|[CListCtrl::SubItemHitTest](#subitemhittest)|如果有任何項目，是在給定的位置，請判斷哪個清單檢視項目。|
|[CListCtrl::Update](#update)|強制重新繪製指定的項目控制項。|

## <a name="remarks"></a>備註

除了圖示和標籤中，每個項目可以顯示在右邊的圖示和標籤資料行中的資訊。 這個控制項 (並因此`CListCtrl`類別) 僅適用於 Windows 95/98 和 Windows NT 版 3.51 下執行的程式和更新版本。

以下是簡短概觀`CListCtrl`類別。 如需詳細的概念性的討論，請參閱[使用 CListCtrl](../../mfc/using-clistctrl.md)並[控制項](../../mfc/controls-mfc.md)。

## <a name="views"></a>檢視

清單檢視控制項可以顯示其內容以四種不同的方式，稱為 「 檢視 」。

- 圖示檢視

   每個項目會顯示為全螢幕圖示 （32 x 32 像素） 其下方的標籤。 使用者可以將項目拖曳到清單的 [檢視] 視窗中的任何位置。

- 小圖示檢視

   每個項目在具有右邊標籤就會顯示為小圖示 （16 x 16 像素為單位）。 使用者可以將項目拖曳到清單的 [檢視] 視窗中的任何位置。

- 清單檢視

   每個項目會顯示為小圖示右邊的標籤。 項目會排列在資料行，並無法拖曳至 [清單檢視] 視窗中的任何位置。

- 報表檢視

   排列在右邊的資料行中的其他資訊的那一行中，會顯示每個項目。 最左邊的資料行包含的小圖示和標籤，而且後續的資料行包含應用程式所指定的子項目。 為內嵌的標題控制項 (類別[CHeaderCtrl](../../mfc/reference/cheaderctrl-class.md)) 會實作這些資料行。 如需有關標題控制項和報表檢視中的資料行的詳細資訊，請參閱[使用 CListCtrl:將資料行加入至控制項 （報表檢視）](../../mfc/adding-columns-to-the-control-report-view.md)。

目前清單檢視控制項的樣式會判斷目前的檢視。 如需有關這些樣式和其使用方式的詳細資訊，請參閱[使用 CListCtrl:變更清單控制項樣式](../../mfc/changing-list-control-styles.md)。

## <a name="extended-styles"></a>延伸的樣式

除了標準清單樣式類別`CListCtrl`支援一組大型的延伸樣式，提供豐富的功能。 這項功能的一些範例包括：

- 將滑鼠移至 選取項目

   啟用時，可讓自動選取項目時的一段時間的資料指標仍然會放在項目。

- 虛擬清單檢視

   啟用時，可讓您控制，可支援最多 DWORD 項目。 這可能是加上管理應用程式上的項目資料的額外負荷。 除了項目選取範圍和焦點的資訊，必須由應用程式管理所有項目資訊。 如需詳細資訊，請參閱[使用 CListCtrl:虛擬清單控制項](../../mfc/virtual-list-controls.md)。

- 按一下一個和兩個啟用

   啟用時，可讓 （自動反白顯示的項目文字） 的熱追蹤和一個或兩個按一下啟動的反白顯示的項目。

- 將拖放資料行排序

   啟用時，可讓拖放時重新排列清單檢視控制項中的資料行。 只有在報表檢視中。

如需使用這些新的資訊延伸樣式，請參閱[使用 CListCtrl:變更清單控制項樣式](../../mfc/changing-list-control-styles.md)。

## <a name="items-and-subitems"></a>項目和子項目

清單檢視控制項中的每個項目是由圖示 （來自影像清單）、 一個標籤，為目前的狀態，以及應用程式定義的值 （稱為 「 項目資料 」） 所組成。 一個以上的子項目也可以產生關聯與每個項目。 「 子項目 」 是一個字串，在報表檢視中，可以顯示在右邊的項目的圖示和標籤資料行。 清單檢視控制項中的所有項目必須具有相同數目的子項目。

類別`CListCtrl`插入、 刪除、 尋找、 及修改這些項目提供數個函數。 如需詳細資訊，請參閱 < [clistctrl:: Getitem](#getitem)， [CListCtrl::InsertItem](#insertitem)，並[CListCtrl::FindItem](#finditem)，[將項目加入至控制項](../adding-items-to-the-control.md)，並[捲動、 排列、 排序和尋找在清單控制項中](../scrolling-arranging-sorting-and-finding-in-list-controls.md)。

根據預設，清單檢視控制項負責儲存項目的圖示和文字屬性。 不過，這些項目類型中，除了類別`CListCtrl`支援 「 回呼項目。 」 「 回呼項目 」 是清單檢視項目，為其應用程式，而不是控制項 — 儲存文字、 圖示或兩者。 回呼遮罩用來指定應用程式所提供的項目屬性 （文字及/或圖示）。 如果應用程式會使用回呼項目，它必須能夠提供隨選的文字及/或圖示的屬性。 當您的應用程式已經會維護某幾項資訊很有幫助回呼項目。 如需詳細資訊，請參閱[使用 CListCtrl:回呼項目和回呼遮罩](../callback-items-and-the-callback-mask.md)。

## <a name="image-lists"></a>影像清單

圖示、 標頭項目影像和應用程式定義狀態的清單檢視項目包含在數個映像清單中 (由類別實作[CImageList](cimagelist-class.md))，您建立並指派給清單檢視控制項。 每個清單檢視控制項可以有最多四個不同的類型的映像清單：

- 大圖示

   在圖示檢視用於完整大小的圖示。

- 小圖示

   在小圖示、 清單和報表檢視用於圖示檢視中使用的圖示的較小版本。

- 應用程式定義的狀態

   包含狀態影像，以指出應用程式定義的狀態項目的圖示旁邊會顯示。

- 標頭項目

   在 [報表] 檢視用於每個標頭控制項項目中出現的小型影像。

根據預設，清單檢視控制項終結時終結; 指派給它的映像清單不過，開發人員可以自訂此行為由終結每個映像清單，不會再使用時，由應用程式。 如需詳細資訊，請參閱[使用 CListCtrl:清單項目和影像清單](../list-items-and-image-lists.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](cobject-class.md)

[CCmdTarget](ccmdtarget-class.md)

[CWnd](cwnd-class.md)

`CListCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

## <a name="approximateviewrect"></a>  CListCtrl::ApproximateViewRect

決定顯示清單檢視控制項的項目所需的高度與寬度。

```
CSize ApproximateViewRect(
    CSize sz = CSize(-1,
-1),
    int iCount = -1) const;
```

### <a name="parameters"></a>參數

*sz*<br/>
建議的維度的控制項，像素為單位。 如果未指定的維度，架構會使用控制項的目前寬度或高度值。

*iCount*<br/>
要在控制項中顯示的項目數目。 如果這個參數是-1，架構會使用項目的總數目前控制項中。

### <a name="return-value"></a>傳回值

A`CSize`物件，包含大約寬度和高度所需的項目，顯示像素為單位。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_ApproximateViewRect](/windows/desktop/api/commctrl/nf-commctrl-listview_approximateviewrect)、 Windows SDK 中所述。

## <a name="arrange"></a>  CListCtrl::Arrange

重新置放在圖示檢視中的項目，使它們對齊方格。

```
BOOL Arrange(UINT nCode);
```

### <a name="parameters"></a>參數

*nCode*<br/>
指定項目的對齊樣式。 它可以是下列值之一：

- LVA_ALIGNLEFT 對齊項目左邊緣處的視窗。

- LVA_ALIGNTOP 對齊項目上邊緣處的視窗。

- 根據清單檢視的目前對齊樣式 （預設值） LVA_DEFAULT 對齊的項目。

- LVA_SNAPTOGRID 齊最接近的格線位置的所有圖示。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

*則 nCode*參數指定的對齊樣式。

### <a name="example"></a>範例

```cpp
    // Align all of the list view control items along the top
    // of the window (the list view control must be in icon or
    // small icon mode).
    m_myListCtrl.Arrange(LVA_ALIGNTOP);
```

## <a name="canceleditlabel"></a>  CListCtrl::CancelEditLabel

取消編輯作業的項目文字。

```
void CancelEditLabel();
```

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_CANCELEDITLABEL](/windows/desktop/Controls/lvm-canceleditlabel)訊息、 Windows SDK 中所述。

## <a name="clistctrl"></a>  CListCtrl::CListCtrl

建構 `CListCtrl` 物件。

```
CListCtrl();
```

## <a name="create"></a>  CListCtrl::Create

建立清單控制項，並將它附加至`CListCtrl`物件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定清單控制項的樣式。 套用至控制項的清單控制項樣式的任何組合。 請參閱[清單檢視的視窗樣式](/windows/desktop/Controls/list-view-window-styles)如需完整清單，這些樣式的 Windows SDK 中。 設定擴充特定控制項使用的樣式[SetExtendedStyle](#setextendedstyle)。

*rect*<br/>
指定清單控制項的大小和位置。 它可以是`CRect`物件或[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構。

*pParentWnd*<br/>
指定清單控制項的父視窗，通常`CDialog`。 它必須不是 NULL。

*nID*<br/>
指定清單控制項的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

您建構`CListCtrl`兩個步驟。 首先，呼叫建構函式，然後呼叫`Create`，這會建立清單檢視控制項，並將它附加至`CListCtrl`物件。

若要擴充 Windows 將樣式套用至清單控制項物件，呼叫[CreateEx](#createex)而不是`Create`。

### <a name="example"></a>範例

```cpp
    m_myListCtrl.Create(
        WS_CHILD|WS_VISIBLE|WS_BORDER|LVS_REPORT|LVS_EDITLABELS,
        CRect(10,10,400,200), pParentWnd, IDD_MYLISTCTRL);
```

## <a name="createex"></a>  CListCtrl::CreateEx

建立控制項 （子視窗），並將它與關聯`CListCtrl`物件。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定正在建立之控制項的延伸的樣式。 如需延伸的 Windows 樣式的清單，請參閱 < *dwExStyle*參數[CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) Windows SDK 中。

*dwStyle*<br/>
指定清單控制項的樣式。 套用至控制項的清單控制項樣式的任何組合。 這些樣式的完整清單，請參閱[清單檢視的視窗樣式](/windows/desktop/Controls/list-view-window-styles)Windows SDK 中。

*rect*<br/>
參考[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構描述的大小和位置，在中建立工作區座標中的視窗*pParentWnd*。

*pParentWnd*<br/>
是控制項的父視窗的指標。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而非[建立](#create)套用延伸的 Windows 樣式，由 Windows 延伸的樣式前置詞**WS_EX_**。

`CreateEx` 建立具有所指定的擴充 Windows 樣式的控制項*dwExStyle*。 若要設定特定延伸的樣式至控制項，呼叫[SetExtendedStyle](#setextendedstyle)。 例如，使用`CreateEx`將這類樣式設定為 WS_EX_CONTEXTHELP，但使用`SetExtendedStyle`將這類樣式設定為 LVS_EX_FULLROWSELECT。 如需詳細資訊，請參閱本主題中所述的樣式[擴充清單檢視樣式](/windows/desktop/Controls/extended-list-view-styles)Windows SDK 中。

## <a name="createdragimage"></a>  CListCtrl::CreateDragImage

建立指定的項目拖曳影像清單*nItem*。

```
CImageList* CreateDragImage(
    int nItem,
    LPPOINT lpPoint);
```

### <a name="parameters"></a>參數

*nItem*<br/>
若要建立其拖曳影像清單的項目索引。

*lpPoint*<br/>
位址[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)接收的映像，左上角的初始位置的結構檢視中協調。

### <a name="return-value"></a>傳回值

如果成功則拖曳影像清單的指標否則為 NULL。

### <a name="remarks"></a>備註

`CImageList`物件是永久的而且您必須將它完成時刪除。 例如: 

```cpp
        CImageList* pImageList = m_myListCtrl.CreateDragImage(nItem, &point);

        // do something

        delete pImageList;
```

## <a name="deleteallitems"></a>  CListCtrl::DeleteAllItems

從清單檢視控制項中刪除所有項目。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Delete all of the items from the list view control.
    m_myListCtrl.DeleteAllItems();
    ASSERT(m_myListCtrl.GetItemCount() == 0);
```

## <a name="deletecolumn"></a>  CListCtrl::DeleteColumn

從清單檢視控制項中刪除資料行。

```
BOOL DeleteColumn(int nCol);
```

### <a name="parameters"></a>參數

*nCol*<br/>
要刪除的資料行索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        int nColumnCount = m_myListCtrl.GetHeaderCtrl()->GetItemCount();

        // Delete all of the columns.
        for (int i=0; i < nColumnCount; i++)
        {
            m_myListCtrl.DeleteColumn(0);
        }
```

## <a name="deleteitem"></a>  CListCtrl::DeleteItem

從清單檢視控制項中刪除項目。

```
BOOL DeleteItem(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
指定要刪除之項目的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        int nCount = m_myListCtrl.GetItemCount();

        // Delete all of the items from the list view control.
        for (int i=0; i < nCount; i++)
        {
            m_myListCtrl.DeleteItem(0);
        }
```

## <a name="drawitem"></a>  CListCtrl::DrawItem

由架構的視覺外觀的主控描繪清單檢視控制項變更時呼叫。

```
virtual void DrawItem(LPDRAWITEMSTRUCT lpDrawItemStruct);
```

### <a name="parameters"></a>參數

*lpDrawItemStruct*<br/>
長指標`DRAWITEMSTRUCT`結構，其中包含的所需的繪圖類型的相關資訊。

### <a name="remarks"></a>備註

`itemAction`隸屬[DRAWITEMSTRUCT](/windows/desktop/api/winuser/ns-winuser-tagdrawitemstruct)結構會定義要執行的繪圖動作。

根據預設，此成員函式沒有任何作用。 覆寫此成員函式，來實作活動，抽獎獲得主控描繪`CListCtrl`物件。

應用程式應該還原選取的顯示內容中提供所有的圖形裝置介面 (GDI) 物件*lpDrawItemStruct*之前此成員函式會結束。

## <a name="editlabel"></a>  CListCtrl::EditLabel

開始進行就地編輯的項目文字。

```
CEdit* EditLabel(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要編輯之清單檢視項目的索引。

### <a name="return-value"></a>傳回值

如果成功，指標`CEdit`用來編輯項目文字的物件; 否則為 NULL。

### <a name="remarks"></a>備註

具有 LVS_EDITLABELS 視窗樣式的清單檢視控制項可讓使用者編輯進行中的項目標籤。 使用者開始編輯，方法是按一下具有焦點之項目的標籤。

使用此函式開始進行就地編輯指定的清單檢視項目的文字。

### <a name="example"></a>範例

```cpp
        // Make sure the focus is set to the list view control.
        m_myListCtrl.SetFocus();

        // Show the edit control on the label of the first
        // item in the list view control.
        CEdit* pmyEdit = m_myListCtrl.EditLabel(1);
        ASSERT(pmyEdit != NULL);
```

## <a name="enablegroupview"></a>  CListCtrl::EnableGroupView

啟用或停用是否顯示為群組的清單檢視控制項中的項目。

```
LRESULT EnableGroupView(BOOL fEnable);
```

### <a name="parameters"></a>參數

*fEnable*<br/>
指出是否要啟用群組的 listview 控制項顯示的項目。 若要啟用群組;，則為 TRUE如果為 false，則將它停用。

### <a name="return-value"></a>傳回值

會傳回下列值之一：

- **0**能夠顯示清單檢視項目，因為群組已啟用或停用。

- **1**已成功變更控制項的狀態。

- **-1**作業失敗。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_ENABLEGROUPVIEW](/windows/desktop/Controls/lvm-enablegroupview)訊息、 Windows SDK 中所述。

## <a name="ensurevisible"></a>  CListCtrl::EnsureVisible

確保至少部分可見的清單檢視項目。

```
BOOL EnsureVisible(
    int nItem,
    BOOL bPartialOK);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要顯示之清單檢視項目的索引。

*bPartialOK*<br/>
指定是否可接受部分的可見性。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如有必要，就會捲動清單檢視控制項。 如果*bPartialOK*參數為非零值，不捲動發生項目是否可見部分。

### <a name="example"></a>範例

```cpp
        // Ensure that the last item is visible.
        int nCount = m_myListCtrl.GetItemCount();
        if (nCount > 0)
            m_myListCtrl.EnsureVisible(nCount-1, FALSE);
```

## <a name="finditem"></a>  CListCtrl::FindItem

搜尋具有指定特性的清單檢視項目。

```
int FindItem(
    LVFINDINFO* pFindInfo,
    int nStart = -1) const;
```

### <a name="parameters"></a>參數

*pFindInfo*<br/>
指標[LVFINDINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvfindinfoa)結構，其中包含要搜尋項目的相關資訊。

*nStart*<br/>
若要開始，搜尋的項目或是-1，從頭開始的索引。 在項目*n*如果從搜尋結果中排除*n*不等於-1。

### <a name="return-value"></a>傳回值

如果成功的項目或否則為-1 的索引。

### <a name="remarks"></a>備註

*PFindInfo*參數所指向`LVFINDINFO`結構，其中包含用來搜尋清單檢視項目的資訊。

### <a name="example"></a>範例

```cpp
        LVFINDINFO info;
        int nIndex;

        info.flags = LVFI_PARTIAL|LVFI_STRING;
        info.psz = _T("item");

        // Delete all of the items that begin with the string.
        while ((nIndex = m_myListCtrl.FindItem(&info)) != -1)
        {
            m_myListCtrl.DeleteItem(nIndex);
        }
```

## <a name="getbkcolor"></a>  CListCtrl::GetBkColor

擷取清單檢視控制項的背景色彩。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

32 位元值，用來指定的 RGB 色彩。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::SetBkColor](#setbkcolor)。

## <a name="getbkimage"></a>  CListCtrl::GetBkImage

擷取目前的背景影像的清單檢視控制項。

```
BOOL GetBkImage(LVBKIMAGE* plvbkImage) const;
```

### <a name="parameters"></a>參數

*plvbkImage*<br/>
指標`LVBKIMAGE`結構，包含目前的背景影像的清單檢視。

### <a name="return-value"></a>傳回值

傳回非零值，如果成功或零，否則為。

### <a name="remarks"></a>備註

這個方法會實作行為的 Win32 巨集[ListView_GetBkImage](/windows/desktop/api/commctrl/nf-commctrl-listview_getbkimage)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        LVBKIMAGE bki;

        // If no background image is set for the list view control use
        // the Microsoft homepage image as the background image.
        if (m_myListCtrl.GetBkImage(&bki) && (bki.ulFlags == LVBKIF_SOURCE_NONE))
        {
            m_myListCtrl.SetBkImage(
                _T("http://www.microsoft.com/library/images/gifs/homepage/microsoft.gif"),
                TRUE);
        }
```

## <a name="getcallbackmask"></a>  CListCtrl::GetCallbackMask

擷取清單檢視控制項的回呼遮罩。

```
UINT GetCallbackMask() const;
```

### <a name="return-value"></a>傳回值

清單檢視控制項的回呼遮罩。

### <a name="remarks"></a>備註

「 回呼項目 」 是清單檢視項目，為其應用程式，而不是控制項 — 儲存文字、 圖示或兩者。 雖然清單檢視控制項可以讓您儲存這些屬性，您可能想要使用回呼項目，如果您的應用程式已在維護某幾項資訊。 回呼遮罩可讓您指定的項目狀態位元會維護應用程式，並將它套用整個控制項，而不是特定的項目。 回呼遮罩預設為零，表示控制項正在追蹤所有項目的狀態。 如果應用程式會使用回呼項目，或指定非零的回呼遮罩，它必須能夠提供隨選的清單檢視項目屬性。

### <a name="example"></a>範例

  範例，請參閱[clistctrl:: Setcallbackmask](#setcallbackmask)。

## <a name="getcheck"></a>  CListCtrl::GetCheck

擷取目前的項目相關聯之狀態影像的顯示狀態。

```
BOOL GetCheck(int nItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
清單控制項項目以零為起始的索引。

### <a name="return-value"></a>傳回值

非零值，如果選取的項目，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetCheckState](/windows/desktop/api/commctrl/nf-commctrl-listview_getcheckstate)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::SetCheck](#setcheck)。

## <a name="getcolumn"></a>  CListCtrl::GetColumn

擷取清單檢視控制項的資料行的屬性。

```
BOOL GetColumn(
    int nCol,
    LVCOLUMN* pColumn) const;
```

### <a name="parameters"></a>參數

*nCol*<br/>
要擷取其屬性的資料行的索引。

*pColumn*<br/>
位址[LVCOLUMN](/windows/desktop/api/commctrl/ns-commctrl-taglvcolumna)結構，指定要擷取之資訊，並且接收到的資料行的相關資訊。 `mask`成員可讓您指定哪個資料行屬性來擷取。 如果`mask`成員指定 LVCF_TEXT 值`pszText`成員必須包含接收項目文字的緩衝區的位址和`cchTextMax`成員必須指定緩衝區的大小。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

`LVCOLUMN`結構包含在報表檢視資料行的相關資訊。

### <a name="example"></a>範例

```cpp
        LVCOLUMN col;

        col.mask = LVCF_WIDTH;

        // Double the column width of the first column.
        if (m_myListCtrl.GetColumn(0, &col))
        {
            col.cx *= 2;
            m_myListCtrl.SetColumn(0, &col);
        }
```

## <a name="getcolumnorderarray"></a>  CListCtrl::GetColumnOrderArray

擷取清單檢視控制項的資料行順序 （由左到右）。

```
BOOL GetColumnOrderArray(
    LPINT piArray,
    int iCount = -1);
```

### <a name="parameters"></a>參數

*piArray*<br/>
將包含在清單檢視控制項中的資料行的索引值的緩衝區指標。 緩衝區必須夠大，無法包含在清單檢視控制項中的資料行總數。

*iCount*<br/>
在清單檢視控制項中的資料行數目。 如果這個參數是-1，framework 自動擷取的資料行數目。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetColumnOrderArray](/windows/desktop/api/commctrl/nf-commctrl-listview_getcolumnorderarray)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        // Reverse the order of the columns in the list view control
        // (i.e. make the first column the last, the last column
        // the first, and so on...).
        CHeaderCtrl* pHeaderCtrl = m_myListCtrl.GetHeaderCtrl();

        if (pHeaderCtrl != NULL)
        {
            int  nColumnCount = pHeaderCtrl->GetItemCount();
            LPINT pnOrder = (LPINT) malloc(nColumnCount*sizeof(int));
            ASSERT(pnOrder != NULL);
m_myListCtrl.GetColumnOrderArray(pnOrder, nColumnCount);

            int i, j, nTemp;
            for (i = 0, j = nColumnCount-1; i < j; i++, j--)
            {
                nTemp = pnOrder[i];
                pnOrder[i] = pnOrder[j];
                pnOrder[j] = nTemp;
            }

            m_myListCtrl.SetColumnOrderArray(nColumnCount, pnOrder);
            free(pnOrder);
        }
```

## <a name="getcolumnwidth"></a>  CListCtrl::GetColumnWidth

擷取報表檢視] 或 [清單檢視中的資料行的寬度。

```
int GetColumnWidth(int nCol) const;
```

### <a name="parameters"></a>參數

*nCol*<br/>
指定要擷取其寬度的資料行索引。

### <a name="return-value"></a>傳回值

寬度，單位為像素指定之資料行*nCol*。

### <a name="example"></a>範例

```cpp
        // Increase the column width of the second column by 20.
        int nWidth = m_myListCtrl.GetColumnWidth(1);
        m_myListCtrl.SetColumnWidth(1, 20 + nWidth);
```

## <a name="getcountperpage"></a>  CListCtrl::GetCountPerPage

計算可以納入垂直清單檢視控制項的可見區域時在清單檢視或報表檢視的項目數目。

```
int GetCountPerPage() const;
```

### <a name="return-value"></a>傳回值

可以納入垂直清單檢視控制項的可見區域時在清單檢視或報表檢視的項目數目。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetTopIndex](#gettopindex)。

## <a name="geteditcontrol"></a>  CListCtrl::GetEditControl

擷取用來編輯清單檢視項目的文字編輯控制項的控制代碼。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

如果成功，指標[CEdit](cedit-class.md)用來編輯項目文字的物件; 否則為 NULL。

### <a name="example"></a>範例

```cpp
        // The string replacing the text in the edit control.
        LPCTSTR lpszmyString = _T("custom label!");

        // If possible, replace the text in the label edit control.
        CEdit* pEdit = m_myListCtrl.GetEditControl();

        if (pEdit != NULL)
        {
            pEdit->SetWindowText(lpszmyString);
        }
```

## <a name="getemptytext"></a>  CListCtrl::GetEmptyText

擷取要顯示目前的清單檢視控制項為空字串。

```
CString GetEmptyText() const;
```

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/reference/cstringt-class.md) ，其中包含要顯示如果控制項是空的文字。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETEMPTYTEXT](/windows/desktop/Controls/lvm-getemptytext)訊息，Windows SDK 中所述。

## <a name="getextendedstyle"></a>  CListCtrl::GetExtendedStyle

擷取目前的延伸的樣式的清單檢視控制項。

```
DWORD GetExtendedStyle();
```

### <a name="return-value"></a>傳回值

目前使用的清單中的延伸樣式的組合檢視控制項。 如需這些延伸樣式的描述性清單，請參閱[延伸的清單檢視樣式](/windows/desktop/Controls/extended-list-view-styles)Windows SDK 中的主題。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetExtendedListViewStyle](/windows/desktop/api/commctrl/nf-commctrl-listview_getextendedlistviewstyle)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::SetExtendedStyle](#setextendedstyle)。

## <a name="getfirstselecteditemposition"></a>  CListCtrl::GetFirstSelectedItemPosition

取得清單檢視控制項中的第一個選取的項目位置。

```
POSITION GetFirstSelectedItemPosition() const;
```

### <a name="return-value"></a>傳回值

位置值，可用來反覆項目或物件指標擷取、如果已不選取任何項目，則為 NULL。

### <a name="example"></a>範例

下列程式碼範例示範如何使用此函式。

```cpp
        POSITION pos = m_myListCtrl.GetFirstSelectedItemPosition();
        if (pos == NULL)
        {
            TRACE(_T("No items were selected!\n"));
        }
        else
        {
            while (pos)
            {
                int nItem = m_myListCtrl.GetNextSelectedItem(pos);
                TRACE(_T("Item %d was selected!\n"), nItem);
                // you could do your own processing on nItem here
            }
        }
```

## <a name="getfocusedgroup"></a>  CListCtrl::GetFocusedGroup

擷取具有鍵盤焦點在目前的清單檢視控制項中的群組。

```
int GetFocusedGroup() const;
```

### <a name="return-value"></a>傳回值

如果沒有這類群組;，其狀態會是 LVGS_FOCUSED，群組的索引否則為-1。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETFOCUSEDGROUP](/windows/desktop/Controls/lvm-getfocusedgroup)訊息，Windows SDK 中所述。 如需詳細資訊，請參閱 LVGS_FOCUSED 值`state`隸屬[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構。

## <a name="getgroupcount"></a>  CListCtrl::GetGroupCount

擷取目前的清單檢視控制項中的群組數目。

```
int GetGroupCount()const;
```

### <a name="return-value"></a>傳回值

在清單檢視控制項中的群組數目。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETGROUPCOUNT](/windows/desktop/Controls/lvm-getgroupcount) --> Windows SDK 中所述的訊息。

## <a name="getgroupinfo"></a>  CListCtrl::GetGroupInfo

取得一組指定的清單檢視控制項中的資訊。

```
int GetGroupInfo(
    int iGroupId,
    PLVGROUP pgrp) const;
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要擷取其資訊的群組識別碼。

*pgrp*<br/>
指標[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)包含指定群組的相關資訊。

### <a name="return-value"></a>傳回值

否則會傳回群組中，如果成功，則為-1 的識別碼。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETGROUPINFO](/windows/desktop/Controls/lvm-getgroupinfo)訊息、 Windows SDK 中所述。

## <a name="getgroupinfobyindex"></a>  CListCtrl::GetGroupInfoByIndex

擷取目前的清單檢視控制項中的指定群組的相關資訊。

```
BOOL GetGroupInfoByIndex(
    int iIndex,
    PLVGROUP pGroup) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iIndex*|[in]群組的以零為起始的索引。|
|*pGroup*|[out]指標[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)接收所指定之群組的相關資訊的結構*iIndex*參數。<br /><br /> 呼叫端負責初始化的成員[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構。 設定`cbSize`成員的結構，大小和旗標`mask`來指定要擷取之資訊的成員。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETGROUPINFOBYINDEX](https://msdn.microsoft.com/library/windows/desktop/bb774933) --> Windows SDK 中所述的訊息。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_listCtrl`，也就是用來存取目前的清單檢視控制項。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

下列程式碼範例示範`GetGroupInfoByIndex`方法。 在先前章節中的這段程式碼範例中我們建立的清單檢視控制項，會顯示報表檢視中標題為"ClientID"和"Grade"的兩個資料行。 如果這類群組存在，下列程式碼範例會擷取其索引為 0，群組的相關資訊。
```cpp
    // GetGroupInfoByIndex
    const int GROUP_HEADER_BUFFER_SIZE = 40;

// Initialize the structure
    LVGROUP gInfo = {0};
    gInfo.cbSize = sizeof(LVGROUP);
    wchar_t wstrHeadGet[GROUP_HEADER_BUFFER_SIZE] = {0};
    gInfo.cchHeader = GROUP_HEADER_BUFFER_SIZE;
    gInfo.pszHeader = wstrHeadGet;
    gInfo.mask = (LVGF_ALIGN | LVGF_STATE | LVGF_HEADER | LVGF_GROUPID);
    gInfo.state = LVGS_NORMAL;
    gInfo.uAlign  = LVGA_HEADER_LEFT;

    BOOL bRet = m_listCtrl.GetGroupInfoByIndex( 0, &gInfo );
    if (bRet == TRUE) {
        CString strHeader = CString( gInfo.pszHeader );
        CString str;
        str.Format(_T("Header: '%s'"), strHeader);
        AfxMessageBox(str, MB_ICONINFORMATION);
    }
    else
    {
        AfxMessageBox(_T("No group information was retrieved."));
    }
```

## <a name="getgroupmetrics"></a>  CListCtrl::GetGroupMetrics

擷取群組的計量。

```
void GetGroupMetrics(PLVGROUPMETRICS pGroupMetrics) const;
```

### <a name="parameters"></a>參數

*pGroupMetrics*<br/>
指標[LVGROUPMETRICS](/windows/desktop/api/commctrl/ns-commctrl-taglvgroupmetrics)包含群組度量資訊。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETGROUPMETRICS](/windows/desktop/Controls/lvm-getgroupmetrics)訊息、 Windows SDK 中所述。

## <a name="getgrouprect"></a>  CListCtrl::GetGroupRect

擷取目前的清單檢視控制項中的指定群組的周框矩形。

```
BOOL GetGroupRect(
    int iGroupId,
    LPRECT lpRect,
    int iCoords = LVGGR_GROUP) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iGroupId*|[in]指定群組。|
|*lpRect*|[in、 out]指標[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構。 如果這個方法成功，結構會接收群組所指定的矩形座標*iGroupId*。|
|*iCoords*|[in]指定要擷取的矩形座標。 使用下列值之一：<br /><br /> -LVGGR_GROUP-整個已展開群組 （預設值） 座標。<br />-LVGGR_HEADER-僅標頭 （摺疊的群組） 的座標。<br />-LVGGR_SUBSETLINK-座標只子集連結 （標記子集）。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

呼叫端會負責配置[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)所指向結構*pRect*參數。

這個方法會傳送[LVM_GETGROUPRECT](/windows/desktop/Controls/lvm-getgrouprect)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_listCtrl`，也就是用來存取目前的清單檢視控制項。 下一個範例中會使用此變數。
```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

下列程式碼範例示範`GetGroupRect`方法。 在先前章節中的 這個程式碼範例，我們會建立顯示標題為"ClientID"及"Grade"報表檢視中的兩個資料行的清單檢視控制項。 下列程式碼範例 3D 周圍繪製矩形的群組，其索引為 0，如果存在這類的群組。

```cpp
    // GetGroupRect

    // Get the graphics rectangle that surrounds group 0.
    CRect rect;
    BOOL bRet = m_listCtrl.GetGroupRect( 0, &rect, LVGGR_GROUP);
    // Draw a blue rectangle around group 0.
    if (bRet == TRUE) {
        m_listCtrl.GetDC()->Draw3dRect( &rect, RGB(0, 0, 255), RGB(0, 0, 255));
    }
    else {
        AfxMessageBox(_T("No group information was retrieved."), MB_ICONINFORMATION);
    }
```

## <a name="getgroupstate"></a>  CListCtrl::GetGroupState

擷取目前的清單檢視控制項中的指定群組的狀態。

```
UINT GetGroupState(
    int iGroupId,
    DWORD dwMask) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iGroupId*|[in]群組的以零為起始的索引。|
|*dwMask*|[in]指定狀態来擷取之值所指定群組的遮罩。 如需詳細資訊，請參閱 <<c0> `mask` 隸屬[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構。|

### <a name="return-value"></a>傳回值

指定的群組，或 0，如果找不到群組要求的狀態。

### <a name="remarks"></a>備註

傳回值是位元的 AND 運算的結果上*dwMask*參數和值`state`隸屬[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構，表示目前的清單檢視控制項。

這個方法會傳送[LVM_GETGROUPSTATE](/windows/desktop/Controls/lvm-getgroupstate)訊息，Windows SDK 中所述。 如需詳細資訊，請參閱 < [ListView_GetGroupState](/windows/desktop/api/commctrl/nf-commctrl-listview_getgroupstate)巨集。

## <a name="getheaderctrl"></a>  CListCtrl::GetHeaderCtrl

擷取的標頭控制項的清單檢視控制項。

```
CHeaderCtrl* GetHeaderCtrl();
```

### <a name="return-value"></a>傳回值

使用清單檢視控制項之標頭控制項指標。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetHeader](/windows/desktop/api/commctrl/nf-commctrl-listview_getheader)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetColumnOrderArray](#getcolumnorderarray)。

## <a name="gethotcursor"></a>  CListCtrl::GetHotCursor

擷取清單檢視控制項中啟用熱追蹤時所用的游標。

```
HCURSOR GetHotCursor();
```

### <a name="return-value"></a>傳回值

目前正由清單檢視控制項的最忙碌的游標資源控制代碼。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetHotCursor](/windows/desktop/api/commctrl/nf-commctrl-listview_gethotcursor)、 Windows SDK 中所述。 當游標經過任何清單檢視項目，則會出現熱資料指標，啟用暫留時的選取項目時，只顯示。 藉由設定延伸樣式 LVS_EX_TRACKSELECT 啟用暫留時選取。

### <a name="example"></a>範例

```cpp
        // Set the hot cursor to be the system app starting cursor.
        HCURSOR hCursor = ::LoadCursor(NULL, IDC_APPSTARTING);
        m_myListCtrl.SetHotCursor(hCursor);
        ASSERT(m_myListCtrl.GetHotCursor() == hCursor);
```

## <a name="gethotitem"></a>  CListCtrl::GetHotItem

擷取目前游標下的清單檢視項目。

```
int GetHotItem();
```

### <a name="return-value"></a>傳回值

清單檢視控制項的目前作用的項目索引。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetHotItem](/windows/desktop/api/commctrl/nf-commctrl-listview_gethotitem)、 Windows SDK 中所述。 經常性存取的項目定義為已啟用目前選取的項目，在經常性存取追蹤 （與將滑鼠移至 選取項目）。

如果已啟用熱追蹤，當使用者停留在清單檢視項目，項目標籤會自動反白顯示而不使用滑鼠按鈕。

### <a name="example"></a>範例

```cpp
    // Set the hot item to the first item only if no other item is
    // highlighted.
    if (m_myListCtrl.GetHotItem() == -1)
        m_myListCtrl.SetHotItem(0);
```

## <a name="gethovertime"></a>  CListCtrl::GetHoverTime

擷取清單檢視控制項的目前滑鼠停留時間。

```
DWORD GetHoverTime() const;
```

### <a name="return-value"></a>傳回值

傳回的延遲，以毫秒為單位，滑鼠資料指標必須留在項目之前加以選取。 如果傳回的值為-1，暫留時的時間就會是預設的停留時間。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetHoverTime](/windows/desktop/api/commctrl/nf-commctrl-listview_gethovertime)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        // If the hover time is the default set to 1 sec.
        DWORD dwTime = m_myListCtrl.GetHoverTime();
        if (dwTime == -1)
            m_myListCtrl.SetHoverTime(1000);
```

## <a name="getimagelist"></a>  CListCtrl::GetImageList

擷取用於繪圖的清單檢視項目的影像清單的控制代碼。

```
CImageList* GetImageList(int nImageList) const;
```

### <a name="parameters"></a>參數

*nImageList*<br/>
值，指定要擷取的映像清單。 它可以是下列值之一：

- 使用大圖示 LVSIL_NORMAL 映像清單。

- 使用小圖示的 LVSIL_SMALL 映像清單。

- 狀態影像 LVSIL_STATE 映像清單。

### <a name="return-value"></a>傳回值

用於繪製清單檢視項目影像清單的指標。

### <a name="example"></a>範例

```cpp
        ASSERT(m_myListCtrl.GetImageList(LVSIL_NORMAL) == NULL);
m_myListCtrl.SetImageList(&m_lcImageList, LVSIL_NORMAL);
        ASSERT(m_myListCtrl.GetImageList(LVSIL_NORMAL) == &m_lcImageList);
```

## <a name="getinsertmark"></a>  CListCtrl::GetInsertMark

擷取目前的插入標記的位置。

```
BOOL GetInsertMark(LPLVINSERTMARK lvim) const;
```

### <a name="parameters"></a>參數

*lvim*<br/>
指標[LVINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-lvinsertmark)結構，包含插入標記的資訊。

### <a name="return-value"></a>傳回值

否則傳回如果成功，則為 TRUE 或 FALSE。 如果傳回 FALSE 的大小`cbSize`隸屬`LVINSERTMARK`結構不等於結構的實際大小。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETINSERTMARK](/windows/desktop/Controls/lvm-getinsertmark)訊息、 Windows SDK 中所述。

## <a name="getinsertmarkcolor"></a>  CListCtrl::GetInsertMarkColor

擷取目前的插入標記的色彩。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

傳回[COLORREF](/windows/desktop/gdi/colorref)結構，包含插入點的色彩。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETINSERTMARKCOLOR](/windows/desktop/Controls/lvm-getinsertmarkcolor)訊息、 Windows SDK 中所述。

## <a name="getinsertmarkrect"></a>  CListCtrl::GetInsertMarkRect

擷取矩形界限的插入點。

```
int GetInsertMarkRect(LPRECT pRect) const;
```

### <a name="parameters"></a>參數

*pRect*<br/>
指標`RECT`結構，其中包含之界限的插入點的矩形的座標。

### <a name="return-value"></a>傳回值

會傳回下列值之一：

- **0**找不到插入點。

- **1**找到插入點。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETINSERTMARKRECT](/windows/desktop/Controls/lvm-getinsertmarkrect)訊息、 Windows SDK 中所述。

## <a name="getitem"></a>  CListCtrl::GetItem

擷取部分或全部的清單檢視項目的屬性。

```
BOOL GetItem(LVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
指標[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)收到的項目屬性的結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

`LVITEM`結構會指定或接收的清單檢視項目屬性。

## <a name="getitemcount"></a>  CListCtrl::GetItemCount

擷取清單檢視控制項中的項目數。

```
int GetItemCount() const;
```

### <a name="return-value"></a>傳回值

在清單檢視控制項中的項目數目。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::DeleteItem](#deleteitem)。

## <a name="getitemdata"></a>  CListCtrl::GetItemData

擷取與指定的項目相關聯的 32 位元應用程式專屬值`nItem`。

```
DWORD_PTR GetItemData(int nItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
其資料是要擷取之清單項目的索引。

### <a name="return-value"></a>傳回值

使用指定的項目相關聯的 32 位元應用程式特定值。

### <a name="remarks"></a>備註

這個值是`lParam`隸屬[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，在 Windows SDK 中所述

### <a name="example"></a>範例

```cpp
    // If any item's data is equal to zero then reset it to -1.
    for (int i=0; i < m_myListCtrl.GetItemCount(); i++)
    {
        if (m_myListCtrl.GetItemData(i) == 0)
        {
            m_myListCtrl.SetItemData(i, (DWORD) -1);
        }
    }
```

## <a name="getitemindexrect"></a>  CListCtrl::GetItemIndexRect

擷取週框的全部或部分中目前的清單檢視控制項的子項目。

```
BOOL GetItemIndexRect(
    PLVITEMINDEX pItemIndex,
    int iColumn,
    int rectType,
    LPRECT pRect) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItemIndex*|[in]指標[LVITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb774762)結構子項目的父項目。<br /><br /> 呼叫端會負責配置和設定的成員[LVITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb774762)結構。 這個參數不能是 NULL。|
|*iColumn*|[in]控制項中的資料行的以零為起始索引。|
|*rectType*|[in]要為其擷取周框的清單檢視子項目的部分。 指定下列其中一個值：<br /><br /> LVIR_BOUNDS-傳回整個子項目，包括圖示和標籤的週框矩形。<br /><br /> LVIR_ICON-傳回圖示或小圖示子項目的週框。<br /><br /> LVIR_LABEL-傳回子項目文字的週框矩形。|
|*pRect*|[out]指標[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)接收子項目的週框矩形的相關資訊的結構。<br /><br /> 呼叫端會負責配置[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構。 這個參數不能是 NULL。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETITEMINDEXRECT](/windows/desktop/Controls/lvm-getitemindexrect)訊息，Windows SDK 中所述。 如需詳細資訊，請參閱 < [ListView_GetItemIndexRect 巨集](/windows/desktop/api/commctrl/nf-commctrl-listview_getitemindexrect)。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_listCtrl`，也就是用來存取目前的清單檢視控制項。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

下列程式碼範例示範`GetGroupRect`方法。 進入此程式碼之前我們建立的清單檢視控制項的範例會顯示名為"ClientID"和"Grade"報表檢視中的兩個資料行。 下列程式碼範例會繪製在第二個的子項目周圍的 3D 矩形這兩個資料行中。

```cpp
    // GetItemIndexRect
    // Get the rectangle that bounds the second item in the first group.
    LVITEMINDEX lvItemIndex;
    lvItemIndex.iGroup = 0;
    lvItemIndex.iItem = 1;
    CRect rect;
    BOOL bRet = m_listCtrl.GetItemIndexRect(
        &lvItemIndex, 0, LVIR_BOUNDS, &rect);

    // Draw a red rectangle around the item.
    m_listCtrl.GetDC()->Draw3dRect( &rect, RGB(255, 0, 0), RGB(255, 0, 0) );
```

## <a name="getitemposition"></a>  CListCtrl::GetItemPosition

擷取清單檢視項目的位置。

```
BOOL GetItemPosition(
    int nItem,
    LPPOINT lpPoint) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要擷取其位置的項目索引。

*lpPoint*<br/>
位址[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)檢視中協調收到的項目左上角的位置的結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        POINT pt;

        // Move all items in the list control 100 pixels to the right.
        UINT i, nCount = m_myListCtrl.GetItemCount();

        for (i=0; i < nCount; i++)
        {
            m_myListCtrl.GetItemPosition(i, &pt);
            pt.x += 100;
            m_myListCtrl.SetItemPosition(i, pt);
        }
```

## <a name="getitemrect"></a>  CListCtrl::GetItemRect

擷取週框的全部或部分的目前檢視中的項目。

```
BOOL GetItemRect(
    int nItem,
    LPRECT lpRect,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要擷取其位置的項目索引。

*lpRect*<br/>
位址[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)接收的週框的結構。

*nCode*<br/>
清單檢視項目，要擷取周框的部分。 它可以是下列值之一：

- LVIR_BOUNDS 傳回整個項目，包括圖示和標籤的週框矩形。

- LVIR_ICON 傳回圖示或小圖示的週框矩形。

- LVIR_LABEL 傳回項目文字的週框矩形。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
// OnClick is the handler for the NM_CLICK notification
void CListCtrlDlg::OnClick(NMHDR* pNMHDR, LRESULT* pResult)
{
    UNREFERENCED_PARAMETER(pResult);
LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;

    // Get the current mouse location and convert it to client
    // coordinates.
    CPoint pos( ::GetMessagePos() );
    ScreenToClient(&pos);

    // Get indexes of the first and last visible items in
    // the listview control.
    int index = m_myListCtrl.GetTopIndex();
    int last_visible_index = index + m_myListCtrl.GetCountPerPage();
    if (last_visible_index > m_myListCtrl.GetItemCount())
        last_visible_index = m_myListCtrl.GetItemCount();

    // Loop until number visible items has been reached.
    while (index <= last_visible_index)
    {
        // Get the bounding rectangle of an item. If the mouse
        // location is within the bounding rectangle of the item,
        // you know you have found the item that was being clicked.
        CRect r;
        m_myListCtrl.GetItemRect(index, &r, LVIR_BOUNDS);
        if (r.PtInRect(pia->ptAction))
        {
            UINT flag = LVIS_SELECTED | LVIS_FOCUSED;
            m_myListCtrl.SetItemState(index, flag, flag);
            break;
        }

        // Get the next item in listview control.
        index++;
    }
}
```

## <a name="getitemspacing"></a>  CListCtrl::GetItemSpacing

計算目前的清單檢視控制項中的項目之間的間距。

```
BOOL GetItemSpacing(
    BOOL fSmall,
    int* pnHorzSpacing,
    int* pnVertSpacing) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*fSmall*|[in]要擷取的項目間距的檢視。 小圖示檢視中，或圖示檢視，則為 FALSE，則指定 TRUE。|
|*pnHorzSpacing*|[out]包含項目之間的水平間距。|
|*pnVertSpacing*|[out]包含項目之間的垂直間距。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_GETITEMSPACING](/windows/desktop/Controls/lvm-getitemspacing)訊息，Windows SDK 中所述。

## <a name="getitemstate"></a>  CListCtrl::GetItemState

擷取清單檢視項目的狀態。

```
UINT GetItemState(
    int nItem,
    UINT nMask) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要擷取其狀態的項目索引。

*nMask*<br/>
指定要傳回其中一個項目的狀態旗標的遮罩。

### <a name="return-value"></a>傳回值

狀態旗標，指定清單檢視項目。

### <a name="remarks"></a>備註

所指定項目的狀態`state`隸屬[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，在 Windows SDK 中所述。 當您指定或變更項目的狀態`stateMask`成員指定您想要變更的哪些狀態位元。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetTopIndex](#gettopindex)。

## <a name="getitemtext"></a>  CListCtrl::GetItemText

擷取清單檢視項目或子項目的文字。

```
int GetItemText(
    int nItem,
    int nSubItem,
    LPTSTR lpszText,
    int nLen) const;

CString GetItemText(
    int nItem,
    int nSubItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要擷取其文字的項目索引。

*nSubItem*<br/>
指定的文字是要擷取的子項目。

*lpszText*<br/>
要接收項目文字的字串指標。

*nLen*<br/>
所指向緩衝區的長度*lpszText*。

### <a name="return-value"></a>傳回值

傳回的版本**int**傳回擷取字串的長度。

傳回的版本`CString`傳回項目文字。

### <a name="remarks"></a>備註

如果*nSubItem*為零，此函式會擷取項目標籤; 如果*nSubItem*為非零值，它會擷取子項目的文字。 如需有關子項目的引數的詳細資訊，請參閱討論[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema) Windows SDK 中的結構。

## <a name="getnextitem"></a>  CListCtrl::GetNextItem

如需清單的搜尋檢視項目具有指定的屬性，而且，與給定項目指定的關聯性。

```
int GetNextItem(
    int nItem,
    int nFlags) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
若要開始使用，搜尋的項目或-1 表示找到第一個項目符合指定的旗標的索引。 從搜尋中排除指定的項目本身。

*nFlags*<br/>
指定的項目，並要求項目的狀態要求項目的幾何的關聯性。 幾何的關聯性可以是下列值之一：

- LVNI_ABOVE 搜尋指定的項目上方的項目。

- LVNI_ALL 搜尋後續的項目，依索引 （預設值）。

- LVNI_BELOW 搜尋指定的項目下方的項目。

- LVNI_TOLEFT 搜尋至指定的項目左邊的項目。

- LVNI_TORIGHT 搜尋指定的項目右邊的項目。

此狀態可能是零，或者它可以是下列其中一個或多個這些值：

- LVNI_DROPHILITED 項目有 LVIS_DROPHILITED 狀態旗標設定。

- LVNI_FOCUSED 項目有 LVIS_FOCUSED 狀態旗標設定。

- LVNI_SELECTED 項目有 LVIS_SELECTED 狀態旗標設定。

如果項目未包含所有指定的狀態旗標集，就會繼續搜尋下一個項目。

### <a name="return-value"></a>傳回值

下一個項目，如果成功，否則為-1 的索引。

## <a name="getnextitemindex"></a>  CListCtrl::GetNextItemIndex

擷取具有指定的屬性集的目前清單檢視控制項中項目的索引。

```
BOOL GetNextItemIndex(
    PLVITEMINDEX pItemIndex,
    int nFlags) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItemIndex*|[in、 out]指標[LVITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb774762)結構描述項目開始搜尋或-1 表示找到第一個符合項目，中的旗標*nFlags*參數。<br /><br /> 如果這個方法成功，`LVITEMINDEX`結構描述的搜尋作業找到的項目。|
|*nFlags*|[in]位元組合 (OR) 旗標，指定如何執行搜尋。<br /><br /> 搜尋可能取決於索引、 狀態或外觀的目標項目，或以指定目標項目的實體位置，相對於項目*pItemIndex*參數。 如需詳細資訊，請參閱 <<c0>  *旗標*中的參數[LVM_GETNEXTITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761059)訊息。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

呼叫端會負責配置和設定的成員`LVITEMINDEX`結構所指*pItemIndex*參數。

這個方法會傳送[LVM_GETNEXTITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761059)訊息，Windows SDK 中所述。

## <a name="getnextselecteditem"></a>  CListCtrl::GetNextSelectedItem

取得索引所識別之清單項目的*pos*，然後設定*pos*位置值。

```
int GetNextSelectedItem(POSITION& pos) const;
```

### <a name="parameters"></a>參數

*pos*<br/>
先前呼叫所傳回的位置值的參考`GetNextSelectedItem`或`GetFirstSelectedItemPosition`。 這個呼叫是下一個位置來更新此值。

### <a name="return-value"></a>傳回值

所識別之清單項目的索引*pos*。

### <a name="remarks"></a>備註

您可以使用`GetNextSelectedItem`向前反覆項目迴圈，如果您建立的初始位置，藉由呼叫`GetFirstSelectedItemPosition`。

您必須確定您位置的值無效。 如果無效，偵錯版本的 Mfc 程式庫判斷提示。

### <a name="example"></a>範例

下列程式碼範例示範如何使用此函式。

```cpp
        POSITION pos = m_myListCtrl.GetFirstSelectedItemPosition();
        if (pos == NULL)
        {
            TRACE(_T("No items were selected!\n"));
        }
        else
        {
            while (pos)
            {
                int nItem = m_myListCtrl.GetNextSelectedItem(pos);
                TRACE(_T("Item %d was selected!\n"), nItem);
                // you could do your own processing on nItem here
            }
        }
```

## <a name="getnumberofworkareas"></a>  CListCtrl::GetNumberOfWorkAreas

擷取工作區域的清單檢視控制項的目前數目。

```
UINT GetNumberOfWorkAreas() const;
```

### <a name="return-value"></a>傳回值

不使用這一次。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetNumberOfWorkAreas](/windows/desktop/api/commctrl/nf-commctrl-listview_getnumberofworkareas)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        UINT i, uCount = m_myListCtrl.GetNumberOfWorkAreas();
        LPRECT lpRects = (LPRECT) malloc(uCount*sizeof(RECT));

        if (lpRects != NULL)
        {
            // Dump all of the work area dimensions.
            m_myListCtrl.GetWorkAreas(uCount, lpRects);

            for (i=0; i < uCount; i++)
            {
                TRACE(_T("Work area %d; left = %d, top = %d, right = %d, ")
                    _T("bottom = %d\r\n"),
                    i, lpRects[i].left, lpRects[i].top, lpRects[i].right,
                    lpRects[i].bottom);
            }

            free(lpRects);
        }
        else
        {
            TRACE(_T("Couldn't allocate enough memory!"));
        }
```

## <a name="getoutlinecolor"></a>  CListCtrl::GetOutlineColor

擷取清單檢視控制項的框線色彩。

```
COLORREF GetOutlineColor() const;
```

### <a name="return-value"></a>傳回值

傳回[COLORREF](/windows/desktop/gdi/colorref)結構，其中包含外框色彩。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETOUTLINECOLOR](/windows/desktop/Controls/lvm-getoutlinecolor)訊息、 Windows SDK 中所述。

## <a name="getorigin"></a>  CListCtrl::GetOrigin

擷取目前的檢視原始的清單檢視控制項。

```
BOOL GetOrigin(LPPOINT lpPoint) const;
```

### <a name="parameters"></a>參數

*lpPoint*<br/>
位址[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)接收檢視原始的結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。 不過，如果控制項是在報表檢視中，傳回值永遠為零。

## <a name="getselectedcolumn"></a>  CListCtrl::GetSelectedColumn

擷取在清單控制項中目前選取的資料行的索引。

```
UINT GetSelectedColumn() const;
```

### <a name="return-value"></a>傳回值

所選資料行索引。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETSELECTEDCOLUMN](/windows/desktop/Controls/lvm-getselectedcolumn)訊息、 Windows SDK 中所述。

## <a name="getselectedcount"></a>  CListCtrl::GetSelectedCount

擷取清單檢視控制項中選取的項目數目。

```
UINT GetSelectedCount() const;
```

### <a name="return-value"></a>傳回值

在清單檢視控制項中選取的項目數目。

### <a name="example"></a>範例

```cpp
        UINT i, uSelectedCount = m_myListCtrl.GetSelectedCount();
        int  nItem = -1;

        // Update all of the selected items.
        if (uSelectedCount > 0)
        {
            for (i=0; i < uSelectedCount; i++)
            {
                nItem = m_myListCtrl.GetNextItem(nItem, LVNI_SELECTED);
                ASSERT(nItem != -1);
                m_myListCtrl.Update(nItem);
            }
        }
```

## <a name="getselectionmark"></a>  CListCtrl::GetSelectionMark

擷取清單檢視控制項的選取範圍標記。

```
int GetSelectionMark();
```

### <a name="return-value"></a>傳回值

以零為起始的選取標記或如果沒有選取範圍標記為-1。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetSelectionMark](/windows/desktop/api/commctrl/nf-commctrl-listview_getselectionmark)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Set the selection mark to the first item only if no other item is
    // selected.
    if (m_myListCtrl.GetSelectionMark() == -1)
        m_myListCtrl.SetSelectionMark(0);
```

## <a name="getstringwidth"></a>  CListCtrl::GetStringWidth

決定要顯示所有指定的字串所需的最小的資料行寬度。

```
int GetStringWidth(LPCTSTR lpsz) const;
```

### <a name="parameters"></a>參數

*lpsz*<br/>
Null 終止的字串，其寬度是要判斷位址。

### <a name="return-value"></a>傳回值

寬度，單位為像素所指向的字串*lpsz*。

### <a name="remarks"></a>備註

傳回的寬度會考慮到控制項的目前字型和資料行邊界，但不是包括小圖示的寬度。

### <a name="example"></a>範例

```cpp
        CString strColumn;
        int nWidth;

        // Insert six columns in the list view control. Make the width of
        // the column be the width of the column header plus 50%.
        for (int i = 0; i < 6; i++)
        {
            strColumn.Format(_T("column %d"), i);
            nWidth = 3*m_myListCtrl.GetStringWidth(strColumn)/2;
            m_myListCtrl.InsertColumn(i, strColumn, LVCFMT_LEFT, nWidth);
        }
```

## <a name="getsubitemrect"></a>  CListCtrl::GetSubItemRect

擷取清單檢視控制項中項目的週框。

```
BOOL GetSubItemRect(
    int iItem,
    int iSubItem,
    int nArea,
    CRect& ref);
```

### <a name="parameters"></a>參數

*iItem*<br/>
子項目父項目的索引。

*iSubItem*<br/>
子項目的以一為基的索引。

*nArea*<br/>
要擷取決定週框 （清單檢視子項目） 的部分。 指定週框矩形的部分 （圖示、 標籤，或兩者） 將位元的 OR 運算子套用至一或多個下列值：

- LVIR_BOUNDS 傳回整個項目，包括圖示和標籤的週框矩形。

- LVIR_ICON 傳回圖示或小圖示的週框矩形。

- LVIR_LABEL 傳回整個項目，包括圖示和標籤的週框矩形。 這是 LVIR_BOUNDS 完全相同。

*ref*<br/>
若要參考[CRect](../../atl-mfc-shared/reference/crect-class.md)物件，其中包含的子項目座標的週框矩形。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetSubItemRect](/windows/desktop/api/commctrl/nf-commctrl-listview_getsubitemrect)、 Windows SDK 中所述。

## <a name="gettextbkcolor"></a>  CListCtrl::GetTextBkColor

擷取清單檢視控制項的文字背景色彩。

```
COLORREF GetTextBkColor() const;
```

### <a name="return-value"></a>傳回值

32 位元值，用來指定的 RGB 色彩。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::SetTextBkColor](#settextbkcolor)。

## <a name="gettextcolor"></a>  CListCtrl::GetTextColor

擷取清單檢視控制項的文字色彩。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

32 位元值，用來指定的 RGB 色彩。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::SetTextColor](#settextcolor)。

## <a name="gettileinfo"></a>  CListCtrl::GetTileInfo

擷取清單檢視控制項中的圖格的相關資訊。

```
BOOL GetTileInfo(PLVTILEINFO pti) const;
```

### <a name="parameters"></a>參數

*pti*<br/>
指標[LVTILEINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvtileinfo)接收 圖格資訊的結構。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETTILEINFO](/windows/desktop/Controls/lvm-gettileinfo)訊息、 Windows SDK 中所述。

## <a name="gettileviewinfo"></a>  CListCtrl::GetTileViewInfo

擷取清單檢視控制項中並排顯示檢視的相關資訊。

```
BOOL GetTileViewInfo(PLVTILEVIEWINFO ptvi) const;
```

### <a name="parameters"></a>參數

*ptvi*<br/>
指標[LVTILEVIEWINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvtileviewinfo)結構會接收所擷取的資訊。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETTILEVIEWINFO](/windows/desktop/Controls/lvm-gettileviewinfo)訊息、 Windows SDK 中所述。

## <a name="gettooltips"></a>  CListCtrl::GetToolTips

擷取要顯示工具提示的清單檢視控制項使用的工具提示控制項。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

指標[CToolTipCtrl](ctooltipctrl-class.md)清單控制項所使用的物件。 如果[建立](#create)成員函式會使用樣式 LVS_NOTOOLTIPS、 使用任何工具提示，並會傳回 NULL。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[LVM_GETTOOLTIPS](/windows/desktop/Controls/lvm-gettooltips)、 Windows SDK 中所述。 MFC 實作`GetToolTips`傳回`CToolTipCtrl`物件，它會使用清單控制項，而不是工具提示控制項的控制代碼。

### <a name="example"></a>範例

```cpp
        CToolTipCtrl* pTip = m_myListCtrl.GetToolTips();
        if (NULL != pTip)
        {
            pTip->UpdateTipText(_T("I'm a list view!"), &m_myListCtrl,
                IDD_MYLISTCTRL);
        }
```

## <a name="gettopindex"></a>  CListCtrl::GetTopIndex

在 清單檢視或報表檢視中擷取最上層的可見項目的索引。

```
int GetTopIndex() const;
```

### <a name="return-value"></a>傳回值

最上層的可見項目的索引。

### <a name="example"></a>範例

```cpp
        // Make sure the focus is set to the list view control.
        m_myListCtrl.SetFocus();

        // Select all of the items that are completely visible.
        int n = m_myListCtrl.GetTopIndex();
        int nLast = n + m_myListCtrl.GetCountPerPage();

        for (; n < nLast; n++)
        {
            m_myListCtrl.SetItemState(n, LVIS_SELECTED, LVIS_SELECTED);
            ASSERT(m_myListCtrl.GetItemState(n, LVIS_SELECTED) == LVIS_SELECTED);
        }
```

## <a name="getview"></a>  CListCtrl::GetView

取得清單檢視控制項的檢視。

```
DWORD GetView() const;
```

### <a name="return-value"></a>傳回值

清單檢視控制項目前的檢視。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_GETVIEW](/windows/desktop/Controls/lvm-getview)訊息、 Windows SDK 中所述。

## <a name="getviewrect"></a>  CListCtrl::GetViewRect

擷取清單檢視控制項中的所有項目的週框。

```
BOOL GetViewRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
位址[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

清單檢視中必須是檢視圖示或小圖示檢視中。

## <a name="getworkareas"></a>  CListCtrl::GetWorkAreas

擷取目前的工作區域的清單檢視控制項。

```
void GetWorkAreas(
    int nWorkAreas,
    LPRECT prc) const;
```

### <a name="parameters"></a>參數

*nWorkAreas*<br/>
數目`RECT`中所包含的結構*中華人民共和國*陣列。

*prc*<br/>
陣列的指標`RECT`結構 (或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件)，接收工作區域的清單檢視控制項。 在這些架構中的值為在工作區座標。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_GetWorkAreas](/windows/desktop/api/commctrl/nf-commctrl-listview_getworkareas)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetNumberOfWorkAreas](#getnumberofworkareas)。

## <a name="hasgroup"></a>  CListCtrl::HasGroup

判斷清單檢視控制項是否具有指定的群組。

```
BOOL HasGroup(int iGroupId) const;
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
所要求之群組的識別碼。

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_HASGROUP](/windows/desktop/Controls/lvm-hasgroup)訊息、 Windows SDK 中所述。

## <a name="hittest"></a>  CListCtrl::HitTest

如果有任何項目，是在指定的位置，請判斷哪個清單檢視項目。

```
int HitTest(LVHITTESTINFO* pHitTestInfo) const;

int HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;
```

### <a name="parameters"></a>參數

*pHitTestInfo*<br/>
位址`LVHITTESTINFO`結構，其中包含要進行點擊測試，位置接收的點擊測試結果的相關資訊。

*pt*<br/>
要測試的點。

*pFlags*<br/>
接收的測試結果的相關資訊的整數指標。 請參閱說明`flags`隸屬[LVHITTESTINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvhittestinfo) Windows SDK 中的結構。

### <a name="return-value"></a>傳回值

所指定的位置處的項目索引*pHitTestInfo*，若有的話，否則為-1。

### <a name="remarks"></a>備註

您可以使用的結構 LVHT_ABOVE、 LVHT_BELOW、 LVHT_TOLEFT 和 LVHT_TORIGHT 值`flag`成員來決定是否要捲動清單檢視控制項的內容。 這些旗標的兩個可以結合，例如，如果位置上方和左邊的 工作區。

您可以測試的結構 LVHT_ONITEM 值`flag`成員來判定透過清單檢視項目是否為給定的位置。 這個值是結構的 LVHT_ONITEMICON、 LVHT_ONITEMLABEL 和 LVHT_ONITEMSTATEICON 值的位元 OR 作業`flag`成員。

### <a name="example"></a>範例

```cpp
void CListCtrlDlg::OnRClick(NMHDR* pNMHDR, LRESULT* pResult)
{
    LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;
    CPoint point(pia->ptAction);

    // Select the item the user clicked on.
    UINT uFlags;
    int nItem = m_myListCtrl.HitTest(point, &uFlags);

    if (uFlags & LVHT_ONITEMLABEL)
    {
        m_myListCtrl.SetItem(nItem, 0, LVIF_STATE, NULL, 0, LVIS_SELECTED,
            LVIS_SELECTED, 0);
    }

    *pResult = 0;
}
```

## <a name="insertcolumn"></a>  CListCtrl::InsertColumn

在清單檢視控制項中插入新的資料行。

```
int InsertColumn(
    int nCol,
    const LVCOLUMN* pColumn);

int InsertColumn(
    int nCol,
    LPCTSTR lpszColumnHeading,
    int nFormat = LVCFMT_LEFT,
    int nWidth = -1,
    int nSubItem = -1);
```

### <a name="parameters"></a>參數

*nCol*<br/>
新的資料行的索引。

*pColumn*<br/>
位址`LVCOLUMN`結構，其中包含新的資料行的屬性。

*lpszColumnHeading*<br/>
字串，包含資料行標題的位址。

*nFormat*<br/>
整數，指定資料行的對齊方式。 它可以是下列值之一：LVCFMT_LEFT、 LVCFMT_RIGHT 或 LVCFMT_CENTER。

*nWidth*<br/>
資料行，單位為像素寬度。 此參數為-1，如果未設定資料行寬度。

*nSubItem*<br/>
索引資料行相關聯的子項目。 如果這個參數是-1，任何子項目不是資料行相關聯。

### <a name="return-value"></a>傳回值

新的資料行，如果成功則為-1 則索引。

### <a name="remarks"></a>備註

清單檢視控制項中的最左邊資料行必須是靠左對齊。

[LVCOLUMN](/windows/desktop/api/commctrl/ns-commctrl-taglvcolumna)結構包含在報表檢視中的資料行的屬性。 它也用來接收資料行的相關資訊。 此結構是 Windows SDK 中所述。

## <a name="insertgroup"></a>  CListCtrl::InsertGroup

插入清單檢視控制項中的群組。

```
LRESULT InsertGroup(
    int index,
    PLVGROUP pgrp);
```

### <a name="parameters"></a>參數

*index*<br/>
群組是要插入之項目的索引。

*pgrp*<br/>
指標[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構，其中包含要加入的群組。

### <a name="return-value"></a>傳回值

如果作業失敗，則傳回群組已加入的項目則為-1 的索引。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_INSERTGROUP](/windows/desktop/Controls/lvm-insertgroup)訊息、 Windows SDK 中所述。

## <a name="insertgroupsorted"></a>  CListCtrl::InsertGroupSorted

插入群組的排序清單中指定的群組。

```
LRESULT InsertGroupSorted(PLVINSERTGROUPSORTED pStructInsert);
```

### <a name="parameters"></a>參數

*pStructInsert*<br/>
指標[LVINSERTGROUPSORTED](/windows/desktop/api/commctrl/ns-commctrl-taglvinsertgroupsorted)結構，其中包含要插入的群組。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_INSERTGROUPSORTED](/windows/desktop/Controls/lvm-insertgroupsorted)訊息、 Windows SDK 中所述。

## <a name="insertitem"></a>  CListCtrl::InsertItem

將項目插入清單檢視控制項。

```
int InsertItem(const LVITEM* pItem);

int InsertItem(
    int nItem,
    LPCTSTR lpszItem);

int InsertItem(
    int nItem,
    LPCTSTR lpszItem,
    int nImage);

int InsertItem(
    UINT nMask,
    int nItem,
    LPCTSTR lpszItem,
    UINT nState,
    UINT nStateMask,
    int nImage,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
指標[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，指定項目的屬性，在 Windows SDK 中所述。

*nItem*<br/>
要插入之項目的索引。

*lpszItem*<br/>
字串，包含項目的標籤或 LPSTR_TEXTCALLBACK，如果項目回呼項目的位址。 回呼項目上的資訊，請參閱[clistctrl:: Getcallbackmask](#getcallbackmask)。

*nImage*<br/>
項目的映像，或 I_IMAGECALLBACK 如果項目回呼項目的索引。 回呼項目上的資訊，請參閱[clistctrl:: Getcallbackmask](#getcallbackmask)。

*nMask*<br/>
*NMask*參數會指定哪一個項目做為參數傳遞的屬性都有效。 它可以是其中一或多個遮罩值中所述[LVITEM 結構](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)Windows SDK 中。 有效的值可以與位元的 OR 運算子結合。

*nState*<br/>
表示項目的狀態、 狀態影像和覆疊影像。 請參閱 Windows SDK 主題[LVITEM 結構](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)如需詳細資訊並[清單檢視項目狀態](/windows/desktop/Controls/list-view-item-states)如需有效的旗標的清單。

*nStateMask*<br/>
指示的狀態成員會擷取或修改。 請參閱[LVITEM 結構](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)Windows sdk for 的詳細資訊。

*lParam*<br/>
項目相關聯的 32 位元應用程式特定值。 如果指定此參數，您必須設定*nMask*屬性 LVIF_PARAM。

### <a name="return-value"></a>傳回值

新的項目，如果成功則為-1 則索引。

### <a name="remarks"></a>備註

呼叫這個方法可能會導致 LVM_INSERTITEM 訊息傳送至您的控制項視窗。 設定項目文字 （例如使用例如 LVS_OWNERDRAW 的視窗樣式） 的特定情況下，控制項的相關聯的訊息處理常式可能會失敗。 如需有關這些條件的詳細資訊，請參閱[LVM_INSERTITEM](/windows/desktop/Controls/lvm-insertitem) Windows SDK 中。

### <a name="example"></a>範例

```cpp
        CString strText;
        int nColumnCount = m_myListCtrl.GetHeaderCtrl()->GetItemCount();

        // Insert 10 items in the list view control.
        for (int i = 0; i < 10; i++)
        {
            strText.Format(TEXT("item %d"), i);

            // Insert the item, select every other item.
            m_myListCtrl.InsertItem(LVIF_TEXT | LVIF_STATE, i, strText,
                (i % 2) == 0 ? LVIS_SELECTED : 0, LVIS_SELECTED, 0, 0);

            // Initialize the text of the subitems.
            for (int j = 1; j < nColumnCount; j++)
            {
                strText.Format(TEXT("sub-item %d %d"), i, j);
                m_myListCtrl.SetItemText(i, j, strText);
            }
        }
```

## <a name="insertmarkhittest"></a>  CListCtrl::InsertMarkHitTest

擷取最接近指定點的插入點。

```
int InsertMarkHitTest(
    LPPOINT pPoint,
    LPLVINSERTMARK lvim) const;
```

### <a name="parameters"></a>參數

*pPoint*<br/>
指標[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)結構，包含點擊的測試的座標，相對於清單控制項的用戶端區域。

*lvim*<br/>
指標[LVINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-lvinsertmark)結構，指定最接近座標點參數所定義的插入點。

### <a name="return-value"></a>傳回值

最近的插入點至指定點。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_INSERTMARKHITTEST](/windows/desktop/Controls/lvm-insertmarkhittest)訊息、 Windows SDK 中所述。

## <a name="isgroupviewenabled"></a>  CListCtrl::IsGroupViewEnabled

判斷是否啟用清單檢視控制項的檢視。

```
BOOL IsGroupViewEnabled() const;
```

### <a name="return-value"></a>傳回值

否則傳回 TRUE，如果已啟用的群組檢視或 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_ISGROUPVIEWENABLED](/windows/desktop/Controls/lvm-isgroupviewenabled)訊息、 Windows SDK 中所述。

## <a name="isitemvisible"></a>  CListCtrl::IsItemVisible

指出目前的清單檢視控制項中指定的項目是否可見。

```
BOOL IsItemVisible(int index) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*index*|[in]目前的清單檢視控制項中項目的以零為起始的索引。|

### <a name="return-value"></a>傳回值

如果指定的項目可為可見; 否則為 FALSE，則為 TRUE。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_ISITEMVISIBLE](/windows/desktop/Controls/lvm-isitemvisible)訊息，Windows SDK 中所述。

## <a name="mapidtoindex"></a>  CListCtrl::MapIDToIndex

將目前的清單檢視控制項中項目的唯一識別碼對應至索引。

```
UINT MapIDToIndex(UINT id) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*id*|[in]項目的唯一識別碼。|

### <a name="return-value"></a>傳回值

目前的索引，做為指定的識別碼。

### <a name="remarks"></a>備註

清單檢視控制項在內部追蹤索引的項目。 這可以呈現問題，因為索引可能會變更控制項的存留期間。 建立項目，而且您可以使用此識別碼，以保證唯一性的清單檢視控制項的存留期間時，清單檢視控制項可以標記識別碼的項目。

請注意，在多執行緒環境中的索引保證只有在裝載清單檢視控制項，不是在背景執行緒上的執行緒。

這個方法會傳送[LVM_MAPIDTOINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761137)訊息，Windows SDK 中所述。

## <a name="mapindextoid"></a>  CListCtrl::MapIndexToID

將目前的清單檢視控制項中項目的索引對應至唯一的識別碼。

```
UINT MapIndexToID(UINT index) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*index*|[in]項目的以零為起始的索引。|

### <a name="return-value"></a>傳回值

指定的項目唯一識別碼。

### <a name="remarks"></a>備註

清單檢視控制項在內部追蹤索引的項目。 這可以呈現問題，因為索引可能會變更控制項的存留期間。 建立項目時，清單檢視控制項可以標記識別碼的項目。 您可以使用此識別碼的清單檢視控制項的存留期內存取特定的項目。

請注意，在多執行緒環境中的索引保證只有在裝載清單檢視控制項，不是在背景執行緒上的執行緒。

這個方法會傳送[LVM_MAPINDEXTOID](/windows/desktop/Controls/lvm-mapindextoid)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_listCtrl`，也就是用來存取目前的清單檢視控制項。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

下列程式碼範例示範`MapIndexToID`方法。 在先前章節中的 這個程式碼範例，我們會建立顯示標題為"ClientID"及"Grade"報表檢視中的兩個資料行的清單檢視控制項。 下列範例會將每個清單檢視項目的索引對應到身分證號碼，並接著會擷取每個識別碼的索引。 最後，此範例會報告是否已擷取原始的索引。

```cpp
    // MapIndexToID
    int iCount = m_listCtrl.GetItemCount();
    UINT nId = 0;
    UINT nIndex = 0;
    for (int iIndexOriginal = 0; iIndexOriginal < iCount; iIndexOriginal++)
    {
        // Map index to ID.
        nId = m_listCtrl.MapIndexToID((UINT)iIndexOriginal);

        // Map ID to index.
        nIndex = m_listCtrl.MapIDToIndex(nId);

        if (nIndex != (UINT)(iIndexOriginal))
        {
            CString str;
            str.Format(_T("Mapped index (%d) is not equal to original index (%d)"),
                nIndex, (UINT)(iIndexOriginal));
            AfxMessageBox(str);
            return;
        }
    }
    AfxMessageBox(_T("The mapped indexes and original indexes are equal."),
        MB_ICONINFORMATION);
```

## <a name="movegroup"></a>  CListCtrl::MoveGroup

移動指定群組，來指定零起始的索引清單檢視控制項。

```
LRESULT MoveGroup(
    int iGroupId,
    int toIndex);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要移動之群組的識別碼。

*toIndex*<br/>
要移動這些群組的以零起始的索引。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_MOVEGROUP](/windows/desktop/Controls/lvm-movegroup)訊息、 Windows SDK 中所述。

## <a name="moveitemtogroup"></a>  CListCtrl::MoveItemToGroup

將指定的項目移到指定的群組。

```
void MoveItemToGroup(
    int idItemFrom,
    int idGroupTo);
```

### <a name="parameters"></a>參數

*idItemFrom*<br/>
[in]要移動之項目的索引。

*idGroupTo*<br/>
[in]群組的識別項的項目將會移至。

### <a name="remarks"></a>備註

> [!NOTE]
>  這個方法目前未實作。

這個方法會模擬[LVM_MOVEITEMTOGROUP](/windows/desktop/Controls/lvm-moveitemtogroup)訊息、 Windows SDK 中所述。

## <a name="redrawitems"></a>  CListCtrl::RedrawItems

強制重新繪製的項目範圍的清單檢視控制項。

```
BOOL RedrawItems(
    int nFirst,
    int nLast);
```

### <a name="parameters"></a>參數

*nFirst*<br/>
要重新繪製的第一個項目索引。

*nLast*<br/>
要重新繪製的最後一個項目索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

[清單] 檢視視窗接收 WM_PAINT 訊息前，不會實際繪製指定的項目。 若要立即重繪，呼叫 Windows [UpdateWindow](/windows/desktop/api/winuser/nf-winuser-updatewindow)之後使用此函式的函式。

## <a name="removeallgroups"></a>  CListCtrl::RemoveAllGroups

從清單檢視控制項中移除所有群組。

```
void RemoveAllGroups();
```

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_REMOVEALLGROUPS](/windows/desktop/Controls/lvm-removeallgroups)訊息、 Windows SDK 中所述。

## <a name="removegroup"></a>  CListCtrl::RemoveGroup

從清單檢視控制項中移除指定的群組。

```
LRESULT RemoveGroup(int iGroupId);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要移除之群組的識別碼。

### <a name="return-value"></a>傳回值

否則會傳回群組中，如果成功，則為-1 的索引。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_REMOVEGROUP](/windows/desktop/Controls/lvm-removegroup)訊息、 Windows SDK 中所述。

## <a name="scroll"></a>  CListCtrl::Scroll

捲動清單檢視控制項的內容。

```
BOOL Scroll(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
A`CSize`物件，指定水平和垂直捲動，像素為單位的數量。 `y`隸屬*大小*除以高度，單位為像素的清單檢視控制項的列，並捲動所產生的行數。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="setbkcolor"></a>  CListCtrl::SetBkColor

設定清單檢視控制項的背景色彩。

```
BOOL SetBkColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*cr*<br/>
若要設定，背景色彩或 CLR_NONE 值沒有背景色彩。 使用背景色彩的清單檢視控制項重繪本身大幅速度快於沒有背景色彩。 如需資訊，請參閱[COLORREF](/windows/desktop/gdi/colorref) Windows SDK 中。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        // Use the 3D button face color for the background.
        COLORREF crBkColor = ::GetSysColor(COLOR_3DFACE);
        m_myListCtrl.SetBkColor(crBkColor);
        ASSERT(m_myListCtrl.GetBkColor() == crBkColor);
```

## <a name="setbkimage"></a>  CListCtrl::SetBkImage

設定清單檢視控制項的背景的影像。

```
BOOL SetBkImage(LVBKIMAGE* plvbkImage);

BOOL SetBkImage(
    HBITMAP hbm,
    BOOL fTile = TRUE,
    int xOffsetPercent = 0,
    int yOffsetPercent = 0);

BOOL SetBkImage(
    LPTSTR pszUrl,
    BOOL fTile = TRUE,
    int xOffsetPercent = 0,
    int yOffsetPercent = 0);
```

### <a name="parameters"></a>參數

*plvbkImage*<br/>
位址`LVBKIMAGE`結構，包含新的背景映像資訊。

*hbm*<br/>
點陣圖的控制代碼。

*pszUrl*<br/>
以 NULL 結尾的字串，包含背景影像的 URL。

*fTile*<br/>
並排顯示在清單檢視控制項之背景影像時，非零值。否則為 0。

*xOffsetPercent*<br/>
位移，單位為像素映像的左邊緣，從清單檢視控制項的原點。

*yOffsetPercent*<br/>
位移，單位為像素影像的上邊緣，從清單檢視控制項的原點。

### <a name="return-value"></a>傳回值

傳回非零值，如果成功或零，否則為。

### <a name="remarks"></a>備註

> [!NOTE]
>  因為`CListCtrl::SetBkImage`會使用 OLE COM 功能，必須先初始化 OLE 程式庫使用`SetBkImage`。 最好是初始化應用程式時初始化 COM 程式庫和應用程式終止時，解除初始化程式庫。 這是自動在 MFC 應用程式，讓使用 ActiveX 技術、 OLE Automation、 OLE 連結/內嵌或 ODBC/DAO 的作業。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetBkImage](#getbkimage)。

## <a name="setcallbackmask"></a>  CListCtrl::SetCallbackMask

設定清單檢視控制項的回呼遮罩。

```
BOOL SetCallbackMask(UINT nMask);
```

### <a name="parameters"></a>參數

*nMask*<br/>
回呼遮罩的新值。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Set the callback mask so that only the selected and focused states
    // are stored for each item.
    m_myListCtrl.SetCallbackMask(LVIS_SELECTED|LVIS_FOCUSED);
    ASSERT(m_myListCtrl.GetCallbackMask() ==
        (LVIS_SELECTED|LVIS_FOCUSED));
```

## <a name="setcheck"></a>  CListCtrl::SetCheck

判斷清單控制項項目的狀態影像是否可見。

```
BOOL SetCheck(
    int nItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*nItem*<br/>
清單控制項項目以零為起始的索引。

*fCheck*<br/>
指定是否狀態影像的項目是否應該顯示。 根據預設， *fCheck*為 TRUE，且狀態影像為可見。 如果*fCheck*為 FALSE 時，看不到。

### <a name="return-value"></a>傳回值

非零值，如果勾選此項目，否則為 0。

### <a name="example"></a>範例

```cpp
        int nCount = m_myListCtrl.GetItemCount();
        BOOL fCheck = FALSE;

        // Set the check state of every other item to TRUE and
        // all others to FALSE.
        for (int i = 0; i < nCount; i++)
        {
            m_myListCtrl.SetCheck(i, fCheck);
            ASSERT((m_myListCtrl.GetCheck(i) && fCheck) ||
                (!m_myListCtrl.GetCheck(i) && !fCheck));
            fCheck = !fCheck;
        }
```

## <a name="setcolumn"></a>  CListCtrl::SetColumn

設定清單檢視資料行的屬性。

```
BOOL SetColumn(
    int nCol,
    const LVCOLUMN* pColumn);
```

### <a name="parameters"></a>參數

*nCol*<br/>
若要設定其屬性的資料行的索引。

*pColumn*<br/>
位址[LVCOLUMN](/windows/desktop/api/commctrl/ns-commctrl-taglvcolumna)結構，其中包含新的資料行屬性，如 Windows SDK 中所述。 結構的`mask`成員可讓您指定哪個資料行屬性來設定。 如果`mask`成員指定 LVCF_TEXT 值，此結構的`pszText`成員是以 null 結束的字串和結構的位址`cchTextMax`成員會被忽略。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetColumn](#getcolumn)。

## <a name="setcolumnorderarray"></a>  CListCtrl::SetColumnOrderArray

設定清單檢視控制項的資料行順序 （由左到右）。

```
BOOL SetColumnOrderArray(
    int iCount,
    LPINT piArray);
```

### <a name="parameters"></a>參數

*piArray*<br/>
包含 （從左到右） 的清單檢視控制項中的資料行的索引值之緩衝區的指標。 緩衝區必須夠大，無法包含在清單檢視控制項中的資料行總數。

*iCount*<br/>
在清單檢視控制項中的資料行數目。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetColumnOrderArray](/windows/desktop/api/commctrl/nf-commctrl-listview_setcolumnorderarray)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetColumnOrderArray](#getcolumnorderarray)。

## <a name="setcolumnwidth"></a>  CListCtrl::SetColumnWidth

變更報表檢視] 或 [清單檢視中的資料行的寬度。

```
BOOL SetColumnWidth(
    int nCol,
    int cx);
```

### <a name="parameters"></a>參數

*nCol*<br/>
寬度為其設定的資料行索引。 在清單檢視中，這個參數必須是 0。

*cx*<br/>
新資料行的寬度。 不一定需要 LVSCW_AUTOSIZE LVSCW_AUTOSIZE_USEHEADER，如中所述[LVM_SETCOLUMNWIDTH](/windows/desktop/Controls/lvm-setcolumnwidth) Windows SDK 中。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="setextendedstyle"></a>  CListCtrl::SetExtendedStyle

設定目前的延伸的樣式的清單檢視控制項。

```
DWORD SetExtendedStyle(DWORD dwNewStyle);
```

### <a name="parameters"></a>參數

*dwNewStyle*<br/>
清單檢視控制項所使用的延伸樣式的組合。 如需描述性這些樣式清單，請參閱[擴充清單檢視樣式](/windows/desktop/Controls/extended-list-view-styles)Windows SDK 中的主題。

### <a name="return-value"></a>傳回值

先前的延伸樣式，清單檢視控制項所使用的組合。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetExtendedListViewStyle](/windows/desktop/api/commctrl/nf-commctrl-listview_setextendedlistviewstyle)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Allow the header controls item to be movable by the user.
    m_myListCtrl.SetExtendedStyle
        (m_myListCtrl.GetExtendedStyle()|LVS_EX_HEADERDRAGDROP);
```

## <a name="setgroupinfo"></a>  CListCtrl::SetGroupInfo

設定描述目前的清單檢視控制項的指定的群組的資訊。

```
int SetGroupInfo(
    int iGroupId,
    PLVGROUP pgrp);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
設定其資訊群組的識別碼。

*pgrp*<br/>
指標[LVGROUP](/windows/desktop/api/commctrl/ns-commctrl-taglvgroup)結構，其中包含要設定的資訊。 呼叫端負責配置這個結構，並設定其成員。

### <a name="return-value"></a>傳回值

如果方法成功，群組的識別碼否則為-1。

### <a name="remarks"></a>備註

這個方法會傳送[LVM_SETGROUPINFO](/windows/desktop/Controls/lvm-setgroupinfo)訊息，Windows SDK 中所述。

## <a name="setgroupmetrics"></a>  CListCtrl::SetGroupMetrics

設定群組的計量清單檢視控制項。

```
void SetGroupMetrics(PLVGROUPMETRICS pGroupMetrics);
```

### <a name="parameters"></a>參數

*pGroupMetrics*<br/>
指標[LVGROUPMETRICS](/windows/desktop/api/commctrl/ns-commctrl-taglvgroupmetrics)結構，其中包含設群組度量資訊。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETGROUPMETRICS](/windows/desktop/Controls/lvm-setgroupmetrics)訊息、 Windows SDK 中所述。

## <a name="sethotcursor"></a>  CListCtrl::SetHotCursor

設定已啟用熱追蹤，清單檢視控制項時所使用的游標。

```
HCURSOR SetHotCursor(HCURSOR hc);
```

### <a name="parameters"></a>參數

*hc*<br/>
用來代表最忙碌的游標游標資源控制代碼。

### <a name="return-value"></a>傳回值

清單檢視控制項正在使用與上一個最忙碌的游標資源控制代碼。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetHotCursor](/windows/desktop/api/commctrl/nf-commctrl-listview_sethotcursor)、 Windows SDK 中所述。

熱資料指標，只顯示啟用暫留時的選取項目時，會顯示為指標通過任何清單檢視項目。 藉由設定延伸樣式 LVS_EX_TRACKSELECT 啟用暫留時選取。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetHotCursor](#gethotcursor)。

## <a name="sethotitem"></a>  CListCtrl::SetHotItem

設定清單檢視控制項的目前作用的項目。

```
int SetHotItem(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
要設定為經常性存取的項目之項目的以零為起始的索引。

### <a name="return-value"></a>傳回值

先前的作用的項目以零為起始的索引。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetHotItem](/windows/desktop/api/commctrl/nf-commctrl-listview_sethotitem)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetHotItem](#gethotitem)。

## <a name="sethovertime"></a>  CListCtrl::SetHoverTime

設定目前暫留時間的清單檢視控制項。

```
DWORD SetHoverTime(DWORD dwHoverTime = (DWORD)-1);
```

### <a name="parameters"></a>參數

*dwHoverTime*<br/>
新的延遲，以毫秒為單位，滑鼠資料指標必須留在項目之前加以選取。 如果傳遞的預設值，則時間設為預設的停留時間。

### <a name="return-value"></a>傳回值

上一個滑鼠停留時間 （毫秒）。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetHoverTime](/windows/desktop/api/commctrl/nf-commctrl-listview_sethovertime)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetHoverTime](#gethovertime)。

## <a name="seticonspacing"></a>  CListCtrl::SetIconSpacing

設定清單檢視控制項中的圖示之間的間距。

```
CSize SetIconSpacing(
    int cx,
    int cy);

CSize SetIconSpacing(CSize size);
```

### <a name="parameters"></a>參數

*cx*<br/>
在 x 軸 圖示之間距離 （以像素為單位）。

*cy*<br/>
Y 軸 圖示之間距離 （以像素為單位）。

*size*<br/>
A`CSize`物件，指定圖示，在 x 軸和 y 軸之間的距離 （以像素為單位）。

### <a name="return-value"></a>傳回值

A [CSize](../../atl-mfc-shared/reference/csize-class.md)物件，包含圖示間距的上一個值。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetIconSpacing](/windows/desktop/api/commctrl/nf-commctrl-listview_seticonspacing)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Leave lots of space between icons.
    m_myListCtrl.SetIconSpacing(CSize(100, 100));
```

## <a name="setimagelist"></a>  CListCtrl::SetImageList

將影像清單指派給 清單檢視控制項。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
若要將指派的影像清單的指標。

*nImageListType*<br/>
影像清單的類型。 它可以是下列值之一：

- 使用大圖示 LVSIL_NORMAL 映像清單。

- 使用小圖示的 LVSIL_SMALL 映像清單。

- 狀態影像 LVSIL_STATE 映像清單。

### <a name="return-value"></a>傳回值

先前的映像清單的指標。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetImageList](#getimagelist)。

## <a name="setinfotip"></a>  CListCtrl::SetInfoTip

設定工具提示文字。

```
BOOL SetInfoTip(PLVSETINFOTIP plvInfoTip);
```

### <a name="parameters"></a>參數

*plvInfoTip*<br/>
指標[LVFSETINFOTIP](/windows/desktop/api/commctrl/ns-commctrl-taglvsetinfotip)結構，其中包含要設定的資訊。

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETINFOTIP](/windows/desktop/Controls/lvm-setinfotip)訊息、 Windows SDK 中所述。

## <a name="setinsertmark"></a>  CListCtrl::SetInsertMark

將插入點設定為定義的位置。

```
BOOL SetInsertMark(LPLVINSERTMARK lvim);
```

### <a name="parameters"></a>參數

*lvim*<br/>
指標[LVINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-lvinsertmark)結構，指定要設定插入點的位置。

### <a name="return-value"></a>傳回值

否則傳回如果成功，則為 TRUE 或 FALSE。 如果傳回 FALSE 的大小`cbSize`的成員`LVINSERTMARK`結構不等於實際大小結構的一部分，或插入點的時不會套用在目前的檢視。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETINSERTMARK](/windows/desktop/Controls/lvm-setinsertmark)訊息、 Windows SDK 中所述。

## <a name="setinsertmarkcolor"></a>  CListCtrl::SetInsertMarkColor

將插入點的色彩設定。

```
COLORREF SetInsertMarkColor(COLORREF color);
```

### <a name="parameters"></a>參數

*color*<br/>
A [COLORREF](/windows/desktop/gdi/colorref)結構，指定要設定插入點的色彩。

### <a name="return-value"></a>傳回值

傳回`COLORREF`結構，包含前一個色彩。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETINSERTMARKCOLOR](/windows/desktop/Controls/lvm-setinsertmarkcolor)訊息、 Windows SDK 中所述。

## <a name="setitem"></a>  CListCtrl::SetItem

設定部分或全部的清單檢視項目的屬性。

```
BOOL SetItem(const LVITEM* pItem);

BOOL SetItem(
    int nItem,
    int nSubItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);

BOOL SetItem(
    int nItem,
    int nSubItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    int nIndent);
```

### <a name="parameters"></a>參數

*pItem*<br/>
位址[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，其中包含新的項目屬性，如 Windows SDK 中所述。 結構的`iItem`並`iSubItem`成員識別項目或子項目，且結構的`mask`成員指定要設定的屬性。 如需詳細資訊`mask`成員，請參閱 <<c2>  **備註**。

*nItem*<br/>
重新設定其屬性的項目索引。

*nSubItem*<br/>
其屬性會設定子項目的索引。

*nMask*<br/>
指定的屬性來設定 （請參閱 < 備註 >）。

*lpszItem*<br/>
指定項目的標籤的 null 終止字串的位址。

*nImage*<br/>
映像清單中的項目影像的索引。

*nState*<br/>
指定的狀態變更 （請參閱 < 備註 >）。

*nStateMask*<br/>
指定的狀態變更 （請參閱 < 備註 >）。

*lParam*<br/>
要與項目相關聯的 32 位元應用程式特定值。

*nIndent*<br/>
寬度，單位為像素的縮排。 如果*nIndent*小於比系統定莪最小寬度，新的寬度設定為系統定義的最小值

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

`iItem`並`iSubItem`的成員`LVITEM`結構和*nItem*並*nSubItem*參數會識別此項目和子項目，其屬性會設定。

`mask`隸屬`LVITEM`結構並*nMask*參數指定哪一個項目屬性會設為：

- LVIF_TEXT`pszText`成員或*lpszItem*參數是以 null 結束的字串位址;`cchTextMax`成員會被忽略。

- LVIF_STATE`stateMask`成員或*nStateMask*參數指定哪一個項目狀態變更而`state`成員或是*nState*參數會包含這些狀態的值。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::HitTest](#hittest)。

## <a name="setitemcount"></a>  CListCtrl::SetItemCount

準備新增大量的項目清單檢視控制項。

```
void SetItemCount(int nItems);
```

### <a name="parameters"></a>參數

*nItems*<br/>
最後會包含控制項的項目數目。

### <a name="remarks"></a>備註

若要設定的虛擬清單檢視控制項的項目計數，請參閱[CListCtrl::SetItemCountEx](#setitemcountex)。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetItemCount](/windows/desktop/api/commctrl/nf-commctrl-listview_setitemcount)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        CString str;

        // Add 1024 items to the list view control.
        m_myListCtrl.SetItemCount(1024);

        for (int i = 0; i < 1024; i++)
        {
            str.Format(TEXT("item %d"), i);
            m_myListCtrl.InsertItem(i, str);
        }
```

## <a name="setitemcountex"></a>  CListCtrl::SetItemCountEx

設定虛擬清單檢視控制項的項目計數。

```
BOOL SetItemCountEx(
    int iCount,
    DWORD dwFlags = LVSICF_NOINVALIDATEALL);
```

### <a name="parameters"></a>參數

*iCount*<br/>
最後會包含控制項的項目數目。

*dwFlags*<br/>
重設項目計數之後指定清單檢視控制項的行為。 這個值可以是下列組合：

- LVSICF_NOINVALIDATEALL 清單檢視控制項將會重新繪製視窗除非受影響的項目目前檢視中。 這是預設值。

- LVSICF_NOSCROLL 清單檢視控制項在項目計數的變更時，不會變更捲軸位置。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetItemCountEx](/windows/desktop/api/commctrl/nf-commctrl-listview_setitemcountex)，如中所述 Windows SDKand 應該只呼叫虛擬清單檢視。

### <a name="example"></a>範例

```cpp
        CString str;

        // Add 1024 items to the list view control.

        // Force my virtual list view control to allocate
        // enough memory for my 1024 items.
        m_myVirtualListCtrl.SetItemCountEx(1024, LVSICF_NOSCROLL|
            LVSICF_NOINVALIDATEALL);

        for (int i = 0; i < 1024; i++)
        {
            str.Format(TEXT("item %d"), i);
            m_myVirtualListCtrl.InsertItem(i, str);
        }
```

## <a name="setitemdata"></a>  CListCtrl::SetItemData

設定與指定的項目相關聯的 32 位元應用程式專屬值*nItem*。

```
BOOL SetItemData(int nItem, DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*nItem*<br/>
設定為其資料之清單項目的索引。

*dwData*<br/>
要與項目相關聯的 32 位元值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

這個值是`lParam`隸屬[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，在 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Set the data of each item to be equal to its index.
    for (int i = 0; i < m_myListCtrl.GetItemCount(); i++)
    {
        m_myListCtrl.SetItemData(i, i);
    }
```

## <a name="setitemindexstate"></a>  CListCtrl::SetItemIndexState

在目前的清單檢視控制項中設定項目的狀態。

```
BOOL SetItemIndexState(
    PLVITEMINDEX pItemIndex,
    DWORD dwState,
    DWORD dwMask) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItemIndex*|[in]指標[LVITEMINDEX](https://msdn.microsoft.com/library/windows/desktop/bb774762)該結構描述項目。 呼叫端負責配置這個結構，並設定其成員。|
|*dwState*|[in]若要設定項目，狀態即的位元組合[清單檢視項目狀態](/windows/desktop/Controls/list-view-item-states)。 指定 0 時可重設，或其中一個狀態設定。|
|*dwMask*|[in]所指定的狀態的有效位元遮罩*dwState*參數。 指定的位元組合 (OR)[清單檢視項目狀態](/windows/desktop/Controls/list-view-item-states)。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如需詳細資訊*dwState*參數，請參閱[清單檢視項目狀態](/windows/desktop/Controls/list-view-item-states)。

如需詳細資訊*dwMask*參數，請參閱*stateMask*的成員[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構。

這個方法會傳送[LVM_SETITEMINDEXSTATE](/windows/desktop/Controls/lvm-setitemindexstate)訊息，Windows SDK 中所述。

## <a name="setitemposition"></a>  CListCtrl::SetItemPosition

將項目移至 清單檢視控制項中的指定位置。

```
BOOL SetItemPosition(
    int nItem,
    POINT pt);
```

### <a name="parameters"></a>參數

*nItem*<br/>
若要設定其位置的項目索引。

*pt*<br/>
A[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)結構，指定檢視中的新位置座標，此項目的左上角。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

控制項必須是圖示或小圖示檢視中。

如果清單檢視控制項有 LVS_AUTOARRANGE 樣式，設定項目的位置之後，會排列清單檢視。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetItemPosition](#getitemposition)。

## <a name="setitemstate"></a>  CListCtrl::SetItemState

變更清單檢視控制項中項目的狀態。

```
BOOL SetItemState(
    int nItem,
    LVITEM* pItem);

BOOL SetItemState(
    int nItem,
    UINT nState,
    UINT nMask);
```

### <a name="parameters"></a>參數

*nItem*<br/>
若要設定其狀態的項目索引。

*pItem*<br/>
位址[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構，在 Windows SDK 中所述。 結構的`stateMask`成員可讓您指定哪些狀態位元變更，並將結構的`state`成員包含那些位元的新值。 其他成員會被忽略。

*nState*<br/>
新的狀態位元的值。 如需可能值的清單，請參閱 < [CListCtrl::GetNextItem](#getnextitem)並[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)狀態成員。

*nMask*<br/>
指定要變更的哪些狀態位元遮罩。 這個值會對應至的 stateMask 成員[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

項目的 「 狀態 」 是指定的項目可用性、 指出使用者動作或否則反映出的項目狀態的值。 清單檢視控制項變更狀態位元，例如當使用者選取項目。 應用程式可能會變更其他狀態的位元來停用或隱藏項目，或指定重疊影像或狀態影像。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetTopIndex](#gettopindex)。

## <a name="setitemtext"></a>  CListCtrl::SetItemText

變更清單檢視項目或子項目的文字。

```
BOOL SetItemText(
    int nItem,
    int nSubItem,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*nItem*<br/>
若要設定其文字的項目索引。

*nSubItem*<br/>
若要設定項目標籤子項目，則為零的索引。

*lpszText*<br/>
包含新的項目文字的字串指標。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

這個方法不適合使用與包含 LVS_OWNERDATA 視窗樣式的控制項 （事實上，這會導致判斷提示在偵錯組建）。 如需有關此清單控制項樣式的詳細資訊，請參閱[清單檢視控制項概觀](/windows/desktop/Controls/list-view-controls-overview)。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::InsertItem](#insertitem)。

## <a name="setoutlinecolor"></a>  CListCtrl::SetOutlineColor

如果設定的清單檢視控制項的框線色彩[LVS_EX_BORDERSELECT](/windows/desktop/Controls/list-view-window-styles)延伸的視窗樣式設定。

```
COLORREF SetOutlineColor(COLORREF color);
```

### <a name="parameters"></a>參數

*color*<br/>
新[COLORREF](/windows/desktop/gdi/colorref)結構，其中包含外框色彩。

### <a name="return-value"></a>傳回值

上一個`COLORREF`結構，其中包含外框色彩

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETOUTLINECOLOR](/windows/desktop/Controls/lvm-setoutlinecolor)訊息、 Windows SDK 中所述。

## <a name="setselectedcolumn"></a>  CListCtrl::SetSelectedColumn

設定選取的資料行的清單檢視控制項。

```
LRESULT SetSelectedColumn(int iCol);
```

### <a name="parameters"></a>參數

*iCol*<br/>
要選取的資料行索引。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETSELECTEDCOLUMN](/windows/desktop/Controls/lvm-setselectedcolumn)訊息、 Windows SDK 中所述。

## <a name="setselectionmark"></a>  CListCtrl::SetSelectionMark

設定的選取範圍標記的清單檢視控制項。

```
int SetSelectionMark(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
多個選取範圍中第一個項目以零為起始的索引。

### <a name="return-value"></a>傳回值

先前選取的標記或如果沒有選取範圍標記為-1。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetSelectionMark](/windows/desktop/api/commctrl/nf-commctrl-listview_setselectionmark)、 Windows SDK 中所述。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetSelectionMark](#getselectionmark)。

## <a name="settextbkcolor"></a>  CListCtrl::SetTextBkColor

清單檢視控制項中設定文字的背景色彩。

```
BOOL SetTextBkColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*cr*<br/>
COLORREF，指定新的文字背景色彩。 如需資訊，請參閱[COLORREF](/windows/desktop/gdi/colorref) Windows SDK 中。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        // Use the 3D button face color for the background.
        COLORREF crBkColor = ::GetSysColor(COLOR_3DFACE);
        m_myListCtrl.SetTextBkColor(crBkColor);
        ASSERT(m_myListCtrl.GetTextBkColor() == crBkColor);
```

## <a name="settextcolor"></a>  CListCtrl::SetTextColor

設定清單檢視控制項的文字色彩。

```
BOOL SetTextColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*cr*<br/>
COLORREF，指定新的文字色彩。 如需資訊，請參閱[COLORREF](/windows/desktop/gdi/colorref) Windows SDK 中。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Use the window text color for
    // the item text of the list view control.
    COLORREF crTextColor = ::GetSysColor(COLOR_WINDOWTEXT);
    m_myListCtrl.SetTextColor(crTextColor);
    ASSERT(m_myListCtrl.GetTextColor() == crTextColor);
```

## <a name="settileinfo"></a>  CListCtrl::SetTileInfo

設定圖格的清單檢視控制項的資訊。

```
BOOL SetTileInfo(PLVTILEINFO pti);
```

### <a name="parameters"></a>參數

*pti*<br/>
指標[LVTILEINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvtileinfo)結構，其中包含要設定的資訊。

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETTILEINFO](/windows/desktop/Controls/lvm-settileinfo)訊息、 Windows SDK 中所述。

## <a name="settileviewinfo"></a>  CListCtrl::SetTileViewInfo

設定中並排顯示檢視清單檢視控制項使用的資訊。

```
BOOL SetTileViewInfo(PLVTILEVIEWINFO ptvi);
```

### <a name="parameters"></a>參數

*ptvi*<br/>
指標[LVTILEVIEWINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvtileviewinfo)結構，其中包含要設定的資訊。

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETTILEVIEWINFO](/windows/desktop/Controls/lvm-settileviewinfo)訊息、 Windows SDK 中所述。

## <a name="settooltips"></a>  CListCtrl::SetToolTips

設定工具提示控制項的清單檢視控制項將用來顯示工具提示。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pWndTip*<br/>
指標`CToolTipCtrl`清單控制項將使用的物件。

### <a name="return-value"></a>傳回值

指標[CToolTipCtrl](ctooltipctrl-class.md)物件，其中包含工具提示，就如同先前不使用任何工具提示一樣，先前使用控制項，則為 NULL。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[LVM_SETTOOLTIPS](/windows/desktop/Controls/lvm-settooltips)、 Windows SDK 中所述。

若要不使用工具提示，指出當您建立的 LVS_NOTOOLTIPS 樣式`CListCtrl`物件。

## <a name="setview"></a>  CListCtrl::SetView

設定清單檢視控制項的檢視。

```
DWORD SetView(int iView);
```

### <a name="parameters"></a>參數

*iView*<br/>
要選取的檢視。

### <a name="return-value"></a>傳回值

否則傳回 1，如果成功，則為-1。 例如，如果檢視是無效，則傳回-1。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SETVIEW](/windows/desktop/Controls/lvm-setview)訊息、 Windows SDK 中所述。

## <a name="setworkareas"></a>  CListCtrl::SetWorkAreas

設定位置顯示圖示，在清單檢視控制項中的區域。

```
void SetWorkAreas(
    int nWorkAreas,
    LPRECT lpRect);
```

### <a name="parameters"></a>參數

*nWorkAreas*<br/>
數目`RECT`結構 (或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件) 中所指陣列*lpRect*。

*lpRect*<br/>
陣列的地址`RECT`結構 (或`CRect`物件)，以指定新的工作區域的清單檢視控制項。 必須在工作區座標中指定這些區域。 如果此參數為 NULL，[工作] 區域將控制項的工作區。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SetWorkAreas](/windows/desktop/api/commctrl/nf-commctrl-listview_setworkareas)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Remove all working areas.
    m_myListCtrl.SetWorkAreas(0, NULL);
```

## <a name="sortgroups"></a>  CListCtrl::SortGroups

您可以使用應用程式定義的比較函式，排序清單檢視控制項中的群組識別碼。

```
BOOL SortGroups(
    PFNLVGROUPCOMPARE _pfnGroupCompare,
    LPVOID _plv);
```

### <a name="parameters"></a>參數

*_pfnGroupCompare*<br/>
群組比較函式的指標。

*_plv*<br/>
Void 的指標。

### <a name="return-value"></a>傳回值

如果成功，則傳回 TRUE 失敗則為 FALSE。

### <a name="remarks"></a>備註

此成員函式會模擬[LVM_SORTGROUPS](/windows/desktop/Controls/lvm-sortgroups)訊息、 Windows SDK 中所述。

## <a name="sortitems"></a>  CListCtrl::SortItems

使用應用程式定義的比較函式，以排序清單檢視項目。

```
BOOL SortItems(
    PFNLVCOMPARE pfnCompare,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*pfnCompare*<br/>
[in]應用程式定義的比較函式的位址。

排序作業會呼叫比較函式每次需要判斷兩個清單項目的相對順序。 比較函式必須是靜態成員的類別，或是獨立的函式不是任何類別的成員。

*dwData*<br/>
[in]應用程式定義的值傳遞給比較函式。

### <a name="return-value"></a>傳回值

如果方法成功，否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會變更以反映新的順序的每個項目的索引。

比較函式*pfnCompare*，具有下列格式：

```
int CALLBACK CompareFunc(LPARAM lParam1,
    LPARAM lParam2,
    LPARAM lParamSort);
```
比較函式必須傳回的負數的值，如果第一個項目之前，應該還有第二個，正數的值，如果第一個項目應該遵循第二個或零，如果兩個項目相等。

*LParam1*參數是 32 位元相關聯的值與第一個項目相比較，而*lParam2*參數是第二個項目相關聯的值。 以下是中所指定的值*lParam*成員的項目[LVITEM](/windows/desktop/api/commctrl/ns-commctrl-taglvitema)結構時它們插入至清單。 *LParamSort*參數是與相同*dwData*值。

這個方法會傳送[LVM_SORTITEMS](/windows/desktop/Controls/lvm-sortitems)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

以下是簡單的比較函式會導致正在排序的項目及其*lParam*值。

```cpp
// Sort items by associated lParam
int CALLBACK CListCtrlDlg::MyCompareProc(LPARAM lParam1, LPARAM lParam2,
    LPARAM lParamSort)
{
    UNREFERENCED_PARAMETER(lParamSort);
return (int)(lParam1 - lParam2);
}
```

```cpp
// Sort the items by passing in the comparison function.
void CListCtrlDlg::Sort()
{
    m_myListCtrl.SortItems(&CListCtrlDlg::MyCompareProc, 0);
}
```

## <a name="sortitemsex"></a>  CListCtrl::SortItemsEx

目前的清單檢視控制項的項目排序所使用的應用程式定義的比較函式。

```
BOOL SortItemsEx(
    PFNLVCOMPARE pfnCompare,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pfnCompare*|[in]應用程式定義的比較函式的位址。<br /><br /> 排序作業會呼叫比較函式每次需要判斷兩個清單項目的相對順序。 比較函式必須是靜態成員的類別，或是獨立的函式不是任何類別的成員。|
|*dwData*|[in]應用程式定義的值傳遞給比較函式。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會變更以反映新的順序的每個項目的索引。

比較函式*pfnCompare*，具有下列格式：

```
int CALLBACK CompareFunc(LPARAM lParam1,
    LPARAM lParam2,
    LPARAM lParamSort);
```
此訊息就像是[LVM_SORTITEMS](/windows/desktop/Controls/lvm-sortitems)，除了的資訊類型傳遞至的比較函式。 在  [LVM_SORTITEMS](/windows/desktop/Controls/lvm-sortitems)， *lParam1*並*lParam2*是項目，即可比較的值。 在  [LVM_SORTITEMSEX](/windows/desktop/Controls/lvm-sortitemsex)， *lParam1*是目前的索引，要比較的第一個項目並*lParam2*是目前的索引，第二個項目。 您可以傳送[LVM_GETITEMTEXT](/windows/desktop/Controls/lvm-getitemtext)訊息，以擷取項目的詳細資訊。

比較函式必須傳回的負數的值，如果第一個項目之前，應該還有第二個，正數的值，如果第一個項目應該遵循第二個或零，如果兩個項目相等。

> [!NOTE]
>  在排序過程中，清單檢視內容是不穩定的。 如果回呼函式會傳送任何訊息至清單檢視控制項以外[LVM_GETITEM](/windows/desktop/Controls/lvm-getitem)，是無法預期的結果。

這個方法會傳送[LVM_SORTITEMSEX](/windows/desktop/Controls/lvm-sortitemsex)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_listCtrl`，也就是用來存取目前的清單檢視控制項。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

下列程式碼範例示範`SortItemEx`方法。 在先前章節中的 這個程式碼範例，我們會建立顯示標題為"ClientID"及"Grade"報表檢視中的兩個資料行的清單檢視控制項。 下列程式碼範例會藉由使用中"Grade"資料行的值排序資料表。

```cpp
// The ListCompareFunc() method is a global function used by SortItemEx().
int CALLBACK ListCompareFunc(
                             LPARAM lParam1,
                             LPARAM lParam2,
                             LPARAM lParamSort)
{
    CListCtrl* pListCtrl = (CListCtrl*) lParamSort;
    CString    strItem1 = pListCtrl->GetItemText(static_cast<int>(lParam1), 1);
    CString    strItem2 = pListCtrl->GetItemText(static_cast<int>(lParam2), 1)
    int x1 = _tstoi(strItem1.GetBuffer());
    int x2 = _tstoi(strItem2.GetBuffer());
    int result = 0;
    if ((x1 - x2) < 0)
        result = -1;
    else if ((x1 - x2) == 0)
        result = 0;
    else
        result = 1;

    return result;
}

void CCListCtrl_s2Dlg::OnBnClickedButton1()
{
    // SortItemsEx
    m_listCtrl.SortItemsEx( ListCompareFunc, (LPARAM)&m_listCtrl );
}
```

## <a name="subitemhittest"></a>  CListCtrl::SubItemHitTest

如果有任何項目，是在給定的位置，請判斷哪個清單檢視項目。

```
int SubItemHitTest(LPLVHITTESTINFO pInfo);
```

### <a name="parameters"></a>參數

*pInfo*<br/>
指標[LVHITTESTINFO](/windows/desktop/api/commctrl/ns-commctrl-taglvhittestinfo)結構。

### <a name="return-value"></a>傳回值

以一為索引的項目，或子項目、 要進行測試 （如果有的話），否則為-1。

### <a name="remarks"></a>備註

此成員函式實作 Win32 巨集的行為[ListView_SubItemHitTest](/windows/desktop/api/commctrl/nf-commctrl-listview_subitemhittest)、 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
void CListCtrlDlg::OnDblClk(NMHDR* pNMHDR, LRESULT* pResult)
{
    UNREFERENCED_PARAMETER(pResult);
LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;
    LVHITTESTINFO lvhti;

    // Clear the subitem text the user clicked on.
    lvhti.pt = pia->ptAction;
    m_myListCtrl.SubItemHitTest(&lvhti);

    if (lvhti.flags & LVHT_ONITEMLABEL)
    {
        m_myListCtrl.SetItemText(lvhti.iItem, lvhti.iSubItem, NULL);
    }
}
```

## <a name="update"></a>  CListCtrl::Update

強制重新繪製所指定的項目在清單檢視控制項*nItem*。

```
BOOL Update(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要更新之項目的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此函式也會排列清單檢視控制項是否 LVS_AUTOARRANGE 樣式。

### <a name="example"></a>範例

  範例，請參閱[CListCtrl::GetSelectedCount](#getselectedcount)。

## <a name="see-also"></a>另請參閱

[MFC 範例 ROWLIST](../../visual-cpp-samples.md)<br/>
[CWnd 類別](cwnd-class.md)<br/>
[階層架構圖表](../hierarchy-chart.md)<br/>
[CImageList 類別](cimagelist-class.md)
