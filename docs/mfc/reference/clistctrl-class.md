---
title: CListCtrl 類別
ms.date: 06/13/2019
f1_keywords:
- CListCtrl
- AFXCMN/CListCtrl
- AFXCMN/CListCtrl::CListCtrl
- AFXCMN/CListCtrl::ApproximateViewRect
- AFXCMN/CListCtrl::Arrange
- AFXCMN/CListCtrl::CancelEditLabel
- AFXCMN/CListCtrl::Create
- AFXCMN/CListCtrl::CreateDragImage
- AFXCMN/CListCtrl::CreateEx
- AFXCMN/CListCtrl::DeleteAllItems
- AFXCMN/CListCtrl::DeleteColumn
- AFXCMN/CListCtrl::DeleteItem
- AFXCMN/CListCtrl::DrawItem
- AFXCMN/CListCtrl::EditLabel
- AFXCMN/CListCtrl::EnableGroupView
- AFXCMN/CListCtrl::EnsureVisible
- AFXCMN/CListCtrl::FindItem
- AFXCMN/CListCtrl::GetBkColor
- AFXCMN/CListCtrl::GetBkImage
- AFXCMN/CListCtrl::GetCallbackMask
- AFXCMN/CListCtrl::GetCheck
- AFXCMN/CListCtrl::GetColumn
- AFXCMN/CListCtrl::GetColumnOrderArray
- AFXCMN/CListCtrl::GetColumnWidth
- AFXCMN/CListCtrl::GetCountPerPage
- AFXCMN/CListCtrl::GetEditControl
- AFXCMN/CListCtrl::GetEmptyText
- AFXCMN/CListCtrl::GetExtendedStyle
- AFXCMN/CListCtrl::GetFirstSelectedItemPosition
- AFXCMN/CListCtrl::GetFocusedGroup
- AFXCMN/CListCtrl::GetGroupCount
- AFXCMN/CListCtrl::GetGroupInfo
- AFXCMN/CListCtrl::GetGroupInfoByIndex
- AFXCMN/CListCtrl::GetGroupMetrics
- AFXCMN/CListCtrl::GetGroupRect
- AFXCMN/CListCtrl::GetGroupState
- AFXCMN/CListCtrl::GetHeaderCtrl
- AFXCMN/CListCtrl::GetHotCursor
- AFXCMN/CListCtrl::GetHotItem
- AFXCMN/CListCtrl::GetHoverTime
- AFXCMN/CListCtrl::GetImageList
- AFXCMN/CListCtrl::GetInsertMark
- AFXCMN/CListCtrl::GetInsertMarkColor
- AFXCMN/CListCtrl::GetInsertMarkRect
- AFXCMN/CListCtrl::GetItem
- AFXCMN/CListCtrl::GetItemCount
- AFXCMN/CListCtrl::GetItemData
- AFXCMN/CListCtrl::GetItemIndexRect
- AFXCMN/CListCtrl::GetItemPosition
- AFXCMN/CListCtrl::GetItemRect
- AFXCMN/CListCtrl::GetItemSpacing
- AFXCMN/CListCtrl::GetItemState
- AFXCMN/CListCtrl::GetItemText
- AFXCMN/CListCtrl::GetNextItem
- AFXCMN/CListCtrl::GetNextItemIndex
- AFXCMN/CListCtrl::GetNextSelectedItem
- AFXCMN/CListCtrl::GetNumberOfWorkAreas
- AFXCMN/CListCtrl::GetOrigin
- AFXCMN/CListCtrl::GetOutlineColor
- AFXCMN/CListCtrl::GetSelectedColumn
- AFXCMN/CListCtrl::GetSelectedCount
- AFXCMN/CListCtrl::GetSelectionMark
- AFXCMN/CListCtrl::GetStringWidth
- AFXCMN/CListCtrl::GetSubItemRect
- AFXCMN/CListCtrl::GetTextBkColor
- AFXCMN/CListCtrl::GetTextColor
- AFXCMN/CListCtrl::GetTileInfo
- AFXCMN/CListCtrl::GetTileViewInfo
- AFXCMN/CListCtrl::GetToolTips
- AFXCMN/CListCtrl::GetTopIndex
- AFXCMN/CListCtrl::GetView
- AFXCMN/CListCtrl::GetViewRect
- AFXCMN/CListCtrl::GetWorkAreas
- AFXCMN/CListCtrl::HasGroup
- AFXCMN/CListCtrl::HitTest
- AFXCMN/CListCtrl::InsertColumn
- AFXCMN/CListCtrl::InsertGroup
- AFXCMN/CListCtrl::InsertGroupSorted
- AFXCMN/CListCtrl::InsertItem
- AFXCMN/CListCtrl::InsertMarkHitTest
- AFXCMN/CListCtrl::IsGroupViewEnabled
- AFXCMN/CListCtrl::IsItemVisible
- AFXCMN/CListCtrl::MapIDToIndex
- AFXCMN/CListCtrl::MapIndexToID
- AFXCMN/CListCtrl::MoveGroup
- AFXCMN/CListCtrl::MoveItemToGroup
- AFXCMN/CListCtrl::RedrawItems
- AFXCMN/CListCtrl::RemoveAllGroups
- AFXCMN/CListCtrl::RemoveGroup
- AFXCMN/CListCtrl::Scroll
- AFXCMN/CListCtrl::SetBkColor
- AFXCMN/CListCtrl::SetBkImage
- AFXCMN/CListCtrl::SetCallbackMask
- AFXCMN/CListCtrl::SetCheck
- AFXCMN/CListCtrl::SetColumn
- AFXCMN/CListCtrl::SetColumnOrderArray
- AFXCMN/CListCtrl::SetColumnWidth
- AFXCMN/CListCtrl::SetExtendedStyle
- AFXCMN/CListCtrl::SetGroupInfo
- AFXCMN/CListCtrl::SetGroupMetrics
- AFXCMN/CListCtrl::SetHotCursor
- AFXCMN/CListCtrl::SetHotItem
- AFXCMN/CListCtrl::SetHoverTime
- AFXCMN/CListCtrl::SetIconSpacing
- AFXCMN/CListCtrl::SetImageList
- AFXCMN/CListCtrl::SetInfoTip
- AFXCMN/CListCtrl::SetInsertMark
- AFXCMN/CListCtrl::SetInsertMarkColor
- AFXCMN/CListCtrl::SetItem
- AFXCMN/CListCtrl::SetItemCount
- AFXCMN/CListCtrl::SetItemCountEx
- AFXCMN/CListCtrl::SetItemData
- AFXCMN/CListCtrl::SetItemIndexState
- AFXCMN/CListCtrl::SetItemPosition
- AFXCMN/CListCtrl::SetItemState
- AFXCMN/CListCtrl::SetItemText
- AFXCMN/CListCtrl::SetOutlineColor
- AFXCMN/CListCtrl::SetSelectedColumn
- AFXCMN/CListCtrl::SetSelectionMark
- AFXCMN/CListCtrl::SetTextBkColor
- AFXCMN/CListCtrl::SetTextColor
- AFXCMN/CListCtrl::SetTileInfo
- AFXCMN/CListCtrl::SetTileViewInfo
- AFXCMN/CListCtrl::SetToolTips
- AFXCMN/CListCtrl::SetView
- AFXCMN/CListCtrl::SetWorkAreas
- AFXCMN/CListCtrl::SortGroups
- AFXCMN/CListCtrl::SortItems
- AFXCMN/CListCtrl::SortItemsEx
- AFXCMN/CListCtrl::SubItemHitTest
- AFXCMN/CListCtrl::Update
helpviewer_keywords:
- CListCtrl [MFC], CListCtrl
- CListCtrl [MFC], ApproximateViewRect
- CListCtrl [MFC], Arrange
- CListCtrl [MFC], CancelEditLabel
- CListCtrl [MFC], Create
- CListCtrl [MFC], CreateDragImage
- CListCtrl [MFC], CreateEx
- CListCtrl [MFC], DeleteAllItems
- CListCtrl [MFC], DeleteColumn
- CListCtrl [MFC], DeleteItem
- CListCtrl [MFC], DrawItem
- CListCtrl [MFC], EditLabel
- CListCtrl [MFC], EnableGroupView
- CListCtrl [MFC], EnsureVisible
- CListCtrl [MFC], FindItem
- CListCtrl [MFC], GetBkColor
- CListCtrl [MFC], GetBkImage
- CListCtrl [MFC], GetCallbackMask
- CListCtrl [MFC], GetCheck
- CListCtrl [MFC], GetColumn
- CListCtrl [MFC], GetColumnOrderArray
- CListCtrl [MFC], GetColumnWidth
- CListCtrl [MFC], GetCountPerPage
- CListCtrl [MFC], GetEditControl
- CListCtrl [MFC], GetEmptyText
- CListCtrl [MFC], GetExtendedStyle
- CListCtrl [MFC], GetFirstSelectedItemPosition
- CListCtrl [MFC], GetFocusedGroup
- CListCtrl [MFC], GetGroupCount
- CListCtrl [MFC], GetGroupInfo
- CListCtrl [MFC], GetGroupInfoByIndex
- CListCtrl [MFC], GetGroupMetrics
- CListCtrl [MFC], GetGroupRect
- CListCtrl [MFC], GetGroupState
- CListCtrl [MFC], GetHeaderCtrl
- CListCtrl [MFC], GetHotCursor
- CListCtrl [MFC], GetHotItem
- CListCtrl [MFC], GetHoverTime
- CListCtrl [MFC], GetImageList
- CListCtrl [MFC], GetInsertMark
- CListCtrl [MFC], GetInsertMarkColor
- CListCtrl [MFC], GetInsertMarkRect
- CListCtrl [MFC], GetItem
- CListCtrl [MFC], GetItemCount
- CListCtrl [MFC], GetItemData
- CListCtrl [MFC], GetItemIndexRect
- CListCtrl [MFC], GetItemPosition
- CListCtrl [MFC], GetItemRect
- CListCtrl [MFC], GetItemSpacing
- CListCtrl [MFC], GetItemState
- CListCtrl [MFC], GetItemText
- CListCtrl [MFC], GetNextItem
- CListCtrl [MFC], GetNextItemIndex
- CListCtrl [MFC], GetNextSelectedItem
- CListCtrl [MFC], GetNumberOfWorkAreas
- CListCtrl [MFC], GetOrigin
- CListCtrl [MFC], GetOutlineColor
- CListCtrl [MFC], GetSelectedColumn
- CListCtrl [MFC], GetSelectedCount
- CListCtrl [MFC], GetSelectionMark
- CListCtrl [MFC], GetStringWidth
- CListCtrl [MFC], GetSubItemRect
- CListCtrl [MFC], GetTextBkColor
- CListCtrl [MFC], GetTextColor
- CListCtrl [MFC], GetTileInfo
- CListCtrl [MFC], GetTileViewInfo
- CListCtrl [MFC], GetToolTips
- CListCtrl [MFC], GetTopIndex
- CListCtrl [MFC], GetView
- CListCtrl [MFC], GetViewRect
- CListCtrl [MFC], GetWorkAreas
- CListCtrl [MFC], HasGroup
- CListCtrl [MFC], HitTest
- CListCtrl [MFC], InsertColumn
- CListCtrl [MFC], InsertGroup
- CListCtrl [MFC], InsertGroupSorted
- CListCtrl [MFC], InsertItem
- CListCtrl [MFC], InsertMarkHitTest
- CListCtrl [MFC], IsGroupViewEnabled
- CListCtrl [MFC], IsItemVisible
- CListCtrl [MFC], MapIDToIndex
- CListCtrl [MFC], MapIndexToID
- CListCtrl [MFC], MoveGroup
- CListCtrl [MFC], MoveItemToGroup
- CListCtrl [MFC], RedrawItems
- CListCtrl [MFC], RemoveAllGroups
- CListCtrl [MFC], RemoveGroup
- CListCtrl [MFC], Scroll
- CListCtrl [MFC], SetBkColor
- CListCtrl [MFC], SetBkImage
- CListCtrl [MFC], SetCallbackMask
- CListCtrl [MFC], SetCheck
- CListCtrl [MFC], SetColumn
- CListCtrl [MFC], SetColumnOrderArray
- CListCtrl [MFC], SetColumnWidth
- CListCtrl [MFC], SetExtendedStyle
- CListCtrl [MFC], SetGroupInfo
- CListCtrl [MFC], SetGroupMetrics
- CListCtrl [MFC], SetHotCursor
- CListCtrl [MFC], SetHotItem
- CListCtrl [MFC], SetHoverTime
- CListCtrl [MFC], SetIconSpacing
- CListCtrl [MFC], SetImageList
- CListCtrl [MFC], SetInfoTip
- CListCtrl [MFC], SetInsertMark
- CListCtrl [MFC], SetInsertMarkColor
- CListCtrl [MFC], SetItem
- CListCtrl [MFC], SetItemCount
- CListCtrl [MFC], SetItemCountEx
- CListCtrl [MFC], SetItemData
- CListCtrl [MFC], SetItemIndexState
- CListCtrl [MFC], SetItemPosition
- CListCtrl [MFC], SetItemState
- CListCtrl [MFC], SetItemText
- CListCtrl [MFC], SetOutlineColor
- CListCtrl [MFC], SetSelectedColumn
- CListCtrl [MFC], SetSelectionMark
- CListCtrl [MFC], SetTextBkColor
- CListCtrl [MFC], SetTextColor
- CListCtrl [MFC], SetTileInfo
- CListCtrl [MFC], SetTileViewInfo
- CListCtrl [MFC], SetToolTips
- CListCtrl [MFC], SetView
- CListCtrl [MFC], SetWorkAreas
- CListCtrl [MFC], SortGroups
- CListCtrl [MFC], SortItems
- CListCtrl [MFC], SortItemsEx
- CListCtrl [MFC], SubItemHitTest
- CListCtrl [MFC], Update
ms.assetid: fe08a1ca-4b05-4ff7-a12a-ee4c765a2197
ms.openlocfilehash: 19939ce7dacc1b826e0a2f067c43fc65db328a54
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370157"
---
# <a name="clistctrl-class"></a>CListCtrl 類別

封裝「清單檢視控制項」的功能，顯示項目集合，其中每個項目是由圖示 (來自影像清單) 和標籤所組成的。

## <a name="syntax"></a>語法

```
class CListCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CListCtrl::CListCtrl](#clistctrl)|建構 `CListCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CListCtrl::近似檢視重新](#approximateviewrect)|確定顯示列表檢視控制項項所需的寬度和高度。|
|[CListCtrl:排列](#arrange)|對齊網格上的專案。|
|[CListCtrl:: 取消編輯標籤](#canceleditlabel)|取消項目文字編輯操作。|
|[CListCtrl:建立](#create)|創建清單控制項並將其附加到`CListCtrl`物件。|
|[CListCtrl:: 建立拖動影像](#createdragimage)|為指定項目創建拖動影像清單。|
|[CListCtrl::建立Ex](#createex)|使用指定的 Windows 擴充樣式創建清單控制項,並將`CListCtrl`其附加到 物件。|
|[CListCtrl::DeleteAll專案](#deleteallitems)|從控制項中刪除所有項。|
|[CListCtrl::DeleteColumn](#deletecolumn)|從清單檢視控制項中移除欄位。|
|[CListCtrl::Delete專案](#deleteitem)|從控制項中刪除項。|
|[CListCtrl::D原始專案](#drawitem)|當所有者繪製控件的可視方面發生更改時調用。|
|[CListCtrl::編輯標籤](#editlabel)|開始就地編輯專案的文本。|
|[CListCtrl::啟用群組檢視](#enablegroupview)|啟用或停用清單檢視控制項中的項目是否顯示為群組。|
|[CListCtrl::確保可見](#ensurevisible)|確保項可見。|
|[CListCtrl::尋找專案](#finditem)|搜尋具有指定特徵的列表檢視項。|
|[CListCtrl:getBkColor](#getbkcolor)|檢索清單檢視控制項的背景顏色。|
|[CListCtrl::GetBkImage](#getbkimage)|檢索清單檢視控制項的當前背景影像。|
|[CListCtrl::取得回撥掩碼](#getcallbackmask)|檢索清單檢視控件的回調掩碼。|
|[CListCtrl:抓取檢查](#getcheck)|檢索與項目關聯的狀態圖像的當前顯示狀態。|
|[CListCtrl:取得欄位](#getcolumn)|檢索控件列的屬性。|
|[CListCtrl::取得列柱順序陣列](#getcolumnorderarray)|檢索清單檢視控制件的列順序(從左至右)。|
|[CListCtrl:取得縱桿寬度](#getcolumnwidth)|檢索報表檢視或清單檢視中列的寬度。|
|[CListCtrl::取得計數Perpage](#getcountperpage)|計算可垂直適合清單檢視控制項的項目數。|
|[CListCtrl:取得編輯控制](#geteditcontrol)|檢索用於編輯項目文本的編輯控制項的句柄。|
|[CListCtrl:取得空文字](#getemptytext)|檢索要顯示的字串,如果當前列表視圖控制項為空。|
|[CListCtrl::取得式延伸樣式](#getextendedstyle)|檢索清單檢視控制項的目前擴展樣式。|
|[CListCtrl:取得第一選擇項目位置](#getfirstselecteditemposition)|檢索清單檢視控制項中第一個選定清單檢視項目的位置。|
|[CListCtrl:取得焦點群組](#getfocusedgroup)|檢索目前清單檢視控制項中具有鍵盤焦點的組。|
|[CListCtrl::取得群數](#getgroupcount)|檢索目前清單檢視控制項中的元件中的元件。|
|[CListCtrl:取得群資訊](#getgroupinfo)|獲取清單檢視控制件的指定組的資訊。|
|[CListCtrl:取得群資訊索引](#getgroupinfobyindex)|檢索目前清單檢視控制項中指定組的資訊。|
|[CListCtrl:取得集團指標](#getgroupmetrics)|檢索組的指標。|
|[CListCtrl::取得群組](#getgrouprect)|檢索目前清單檢視控制項中指定群組的邊界矩形。|
|[CListCtrl::取得群組狀態](#getgroupstate)|檢索目前清單檢視控制項中指定組的狀態。|
|[CListCtrl::取得頭Ctrl](#getheaderctrl)|檢索清單檢視控制項的標頭控制項。|
|[CListCtrl:獲取霍伯庫伯](#gethotcursor)|檢索為清單檢視控制項啟用熱追蹤時使用的游標。|
|[CListCtrl:取得 Hot 專案](#gethotitem)|檢索當前在游標下的列表視圖項。|
|[CListCtrl::取得懸停時間](#gethovertime)|檢索清單檢視控制項的當前懸停時間。|
|[CListCtrl:抓取圖片清單](#getimagelist)|檢索用於繪製清單檢視項的圖像清單的句柄。|
|[CListCtrl::取得插入標記](#getinsertmark)|檢索插入標記的當前位置。|
|[CListCtrl::取得插入標記顏色](#getinsertmarkcolor)|檢索插入標記的當前顏色。|
|[CListCtrl::取得插入標記](#getinsertmarkrect)|檢索綁定插入點的矩形。|
|[CListCtrl:取得項目](#getitem)|檢索清單檢視項的屬性。|
|[CListCtrl::取得項目計數](#getitemcount)|檢索清單檢視控制項中的項目數。|
|[CListCtrl:抓取項目資料](#getitemdata)|檢索與項關聯的特定於應用程式的值。|
|[CListCtrl::取得項目索引重新完成](#getitemindexrect)|檢索當前清單檢視控制項中全部或部分子項的邊界矩形。|
|[CListCtrl:取得項目位置](#getitemposition)|檢索清單檢視項的位置。|
|[CListCtrl::取得項目重新完成](#getitemrect)|檢索項的邊界矩形。|
|[CListCtrl:取得項目間距](#getitemspacing)|計算目前清單檢視控制項中的項目之間的間距。|
|[CListCtrl::取得項目狀態](#getitemstate)|檢索清單檢視項的狀態。|
|[CListCtrl::取得項目文字](#getitemtext)|檢索清單檢視項或子項的文字。|
|[CListCtrl::取得下一個專案](#getnextitem)|搜尋具有指定屬性且與給定項具有指定關係的列表檢視項。|
|[CListCtrl::取得下一個項目索引](#getnextitemindex)|檢索具有指定屬性集的當前列表檢視控制項中的項目的索引。|
|[CListCtrl::取得下一個選定專案](#getnextselecteditem)|檢索清單檢視項位置的索引,以及下一個選定列表視圖項用於反覆運算的位置。|
|[CListctrl:取得工作範圍](#getnumberofworkareas)|檢索清單檢視控制項的目前工作區數。|
|[CListCtrl:取得原點](#getorigin)|檢索清單檢視控制項的目前檢視來源。|
|[CListCtrl::取得大綱顏色](#getoutlinecolor)|檢索清單檢視控制項的邊框的顏色。|
|[CListCtrl:取得精選欄位](#getselectedcolumn)|檢索清單控制項中目前選定列的索引。|
|[CListCtrl:取得精選計數](#getselectedcount)|檢索清單檢視控制項中選定項數量。|
|[CListCtrl:取得選擇標記](#getselectionmark)|檢索清單檢視控制項的選擇標記。|
|[CListCtrl::取得字串寬度](#getstringwidth)|確定顯示所有給定字串所需的最小列寬度。|
|[CListCtrl::抓取子項目重新完成](#getsubitemrect)|檢索清單檢視控制項中項的邊界矩形。|
|[CListCtrl:取得文字BkColor](#gettextbkcolor)|檢索清單檢視控制項的文字背景顏色。|
|[CListCtrl:取得文字顏色](#gettextcolor)|檢索清單檢視控制項的文字顏色。|
|[CListCtrl::取得Tileinfo](#gettileinfo)|檢索有關清單檢視控制項中磁貼的資訊。|
|[CListCtrl::取得TileViewInfo](#gettileviewinfo)|檢索有關磁貼檢視中的清單檢視控制項資訊。|
|[CListCtrl:抓取工具提示](#gettooltips)|檢索清單檢視控制項用於顯示工具提示的工具提示控制項。|
|[CListCtrl:取得Topindex](#gettopindex)|檢索最頂層可見項的索引。|
|[CListCtrl:取得檢視](#getview)|獲取清單檢視控制件的檢視。|
|[CListCtrl::取得檢視Rect](#getviewrect)|檢索清單檢視控制項中所有項的邊界矩形。|
|[CListCtrl::取得工作領域](#getworkareas)|檢索清單檢視控制項的當前工作區。|
|[CListCtrl::哈斯集團](#hasgroup)|確定清單檢視控制項是否具有指定的組。|
|[CListCtrl:hitTest](#hittest)|確定哪個清單檢視項位於指定位置。|
|[CListCtrl::插入欄位](#insertcolumn)|在清單檢視控制項中插入新欄。|
|[CListCtrl::插入群組](#insertgroup)|將群組插入到清單檢視控制項中。|
|[CListCtrl::插入群組排序](#insertgroupsorted)|將指定的群組插入有序的組清單中。|
|[CListCtrl::插入項目](#insertitem)|在清單檢視控制項中插入新項。|
|[CListCtrl::插入馬克希特測試](#insertmarkhittest)|檢索最接近指定點的插入點。|
|[CListCtrl:是否啟用了群檢視](#isgroupviewenabled)|確定是否為清單檢視控制項啟用組檢視。|
|[CListCtrl:是可分割的](#isitemvisible)|指示當前清單檢視控制項中的指定項是否可見。|
|[CListctrl:mapIDToindex](#mapidtoindex)|將當前清單檢視控制項中項的唯一 ID 映射到索引。|
|[CListctrl::映射索引TOID](#mapindextoid)|將當前清單檢視控制項中的項目索引映射到唯一 ID。|
|[CListCtrl:: 移動群組](#movegroup)|移動指定的組。|
|[CListctrl::移動專案群組](#moveitemtogroup)|將指定的組移到列表檢視控制項指定基於零的索引。|
|[CListCtrl::重繪項目](#redrawitems)|強制清單檢視控制項重新繪製一系列項。|
|[CListCtrl:: 刪除所有群組](#removeallgroups)|從清單檢視控制項中移除所有組。|
|[CListCtrl::刪除群組](#removegroup)|從清單檢視控制項中移除指定的群組。|
|[CListCtrl::滾動](#scroll)|滾動清單檢視控制件的內容。|
|[CListCtrl::SetBkColor](#setbkcolor)|設定清單檢視控制項的背景顏色。|
|[CListCtrl::SetBkImage](#setbkimage)|設置清單檢視控制項的當前背景影像。|
|[CListCtrl::設定回撥遮罩](#setcallbackmask)|設置清單檢視控制件的回調掩碼。|
|[CListCtrl::設定檢查](#setcheck)|設置與專案關聯的狀態圖像的當前顯示狀態。|
|[CListCtrl::設定欄](#setcolumn)|設置清單檢視列的屬性。|
|[CListCtrl::設定欄陣陣列](#setcolumnorderarray)|設置清單檢視控制件的列順序(從左至右)。|
|[CListCtrl::設定欄寬](#setcolumnwidth)|更改報表檢視或清單檢視中列的寬度。|
|[CListCtrl::設定延伸樣式](#setextendedstyle)|設置清單檢視控制項的目前擴展樣式。|
|[CListCtrl::SetGroupInfo](#setgroupinfo)|設定清單檢視控制件的指定組的資訊。|
|[CListCtrl::設定組指標](#setgroupmetrics)|設置清單檢視控制件的元件。|
|[CListCtrl::設定HotCursor](#sethotcursor)|設置為清單檢視控制項啟用熱追蹤時使用的遊標。|
|[CListCtrl::設定Hot專案](#sethotitem)|設置清單檢視控制件的當前熱項。|
|[CListCtrl::設定懸停時間](#sethovertime)|設置清單檢視控制件的當前懸停時間。|
|[CListCtrl::設定圖示](#seticonspacing)|設置清單檢視控制件中圖示之間的間距。|
|[CListCtrl::設定影像清單](#setimagelist)|將影像清單分配給清單檢視控制項。|
|[CListCtrl::設定資訊提示](#setinfotip)|設定工具提示文字。|
|[CListCtrl::設定插入標記](#setinsertmark)|將插入點設置到定義的位置。|
|[CListCtrl::設定插入標記顏色](#setinsertmarkcolor)|設置插入點的顏色。|
|[CListCtrl:設定項目](#setitem)|設置清單檢視項的部分或全部屬性。|
|[CListCtrl::設定項目計數](#setitemcount)|準備列表檢視控制項以添加大量項。|
|[CListCtrl::設定項目計數Ex](#setitemcountex)|設定虛擬清單檢視控制項的項目計數。|
|[CListCtrl::設定項目資料](#setitemdata)|設置項的應用程式特定值。|
|[CListCtrl::設定項目索引狀態](#setitemindexstate)|設定當前清單檢視控制項中項的狀態。|
|[CListCtrl::設定項目位置](#setitemposition)|將項目移至列表檢視控制檔中的指定位置。|
|[CListCtrl::設定項目狀態](#setitemstate)|更改清單檢視控制項中項的狀態。|
|[CListCtrl::設定項目文字](#setitemtext)|變更列表檢視項目或子項目的文字。|
|[CListCtrl::設定大綱顏色](#setoutlinecolor)|設定清單檢視控制件的邊框顏色。|
|[CListCtrl::設定選擇欄位](#setselectedcolumn)|設置清單檢視控制項的選定欄。|
|[CListCtrl::設定選擇標記](#setselectionmark)|設置清單檢視控制件的選擇標記。|
|[CListCtrl::設定文字BkColor](#settextbkcolor)|設定清單檢視控制項中文字的背景顏色。|
|[CListCtrl::設定文字顏色](#settextcolor)|設定清單檢視控制項的文字顏色。|
|[CListCtrl::SetTileInfo](#settileinfo)|設置清單檢視控制件的磁貼的資訊。|
|[CListCtrl::SetTileViewInfo](#settileviewinfo)|設定清單檢視控制檔在磁貼檢視中使用的資訊。|
|[CListCtrl::設定工具提示](#settooltips)|設定清單檢視控制項將用於顯示工具提示的工具提示控制項。|
|[CListCtrl::SetView](#setview)|設置清單檢視控制件的檢視。|
|[CListCtrl::設定工作區域](#setworkareas)|設定圖示可以在清單檢視控制項中顯示的區域。|
|[CListCtrl::排序組](#sortgroups)|使用使用者定義的函數對列表檢視控制件的組進行排序。|
|[CListCtrl::排序專案](#sortitems)|使用應用程式定義的比較函數對列表檢視項進行排序。|
|[CListCtrl::排序專案Ex](#sortitemsex)|使用應用程式定義的比較函數對列表檢視項進行排序。|
|[CListCtrl::子項目命中測試](#subitemhittest)|確定哪個清單檢視項(如果有)位於給定位置。|
|[CListCtrl::更新](#update)|強制控件重新繪製指定的項。|

## <a name="remarks"></a>備註

除了圖示和標籤之外,每個專案都可以在圖示和標籤右側的列中顯示資訊。 此控制項(因此該`CListCtrl`類別)僅適用於在 Windows 95/98 和 Windows NT 版本 3.51 及更高版本下運行的程式。

以下是`CListCtrl`該類的簡要概述。 有關詳細的概念討論,請參閱[使用 CListCtrl](../../mfc/using-clistctrl.md)和[控制項](../../mfc/controls-mfc.md)。

## <a name="views"></a>檢視

清單視圖控件可以通過四種不同的方式顯示其內容,稱為"視圖"。

- 圖示檢視

   每個項目都顯示為全尺寸圖示(32 x 32 圖元),下方有一個標籤。 用戶可以將專案拖動到清單檢視視窗中的任何位置。

- 小圖示檢視

   每個項目都顯示為一個小圖示(16 x 16 像素),標籤在它的右側。 用戶可以將專案拖動到清單檢視視窗中的任何位置。

- [清單] 檢視

   每個項目都顯示為一個小圖示,其右側有一個標籤。 專案以列方式排列,無法拖動到清單檢視視窗中的任何位置。

- 報表檢視

   每個專案都出現在自己的行上,其他資訊排列在右側的列中。 最左邊的列包含小圖示和標籤,後續列包含應用程式指定的子項。 嵌入的標頭控制件 (類[CHeaderCtrl)](../../mfc/reference/cheaderctrl-class.md)實現這些列。 有關報表檢視中的標頭控制件和列的詳細資訊,請參閱[使用 CListCtrl:向控制項添加列(報表檢視)。](../../mfc/adding-columns-to-the-control-report-view.md)

控制項目前清單檢視的樣式確定目前檢視。 有關這些樣式及其用法的詳細資訊,請參閱使用[CListCtrl:更改清單控制項樣式](../../mfc/changing-list-control-styles.md)。

## <a name="extended-styles"></a>擴充樣式

除了標準清單樣式外,類`CListCtrl`還支援大量擴展樣式,提供豐富的功能。 此功能的一些範例包括:

- 暫停選擇

   啟用後,當游標在專案上保留一段時間時,允許自動選擇項。

- 虛擬清單檢視

   啟用後,允許控件最多支援 DWORD 項。 這可以通過將管理項數據的開銷放在應用程式上來。 除項目選擇和焦點資訊外,所有專案資訊必須由應用程式管理。 有關詳細資訊,請參閱使用[CListCtrl:虛擬清單控制件](../../mfc/virtual-list-controls.md)。

- 一鍵與雙擊啟動

   啟用後,允許熱跟蹤(專案文本的自動突出顯示)和突出顯示項的一次或兩次單擊啟動。

- 拖放列順序

   啟用後,允許在清單檢視控制項中拖放重新排序列。 僅在報表視圖中可用。

有關使用這些新的擴充樣式的資訊,請參考[CListCtrl:變更清單控制元件樣式](../../mfc/changing-list-control-styles.md)。

## <a name="items-and-subitems"></a>專案與子項目

清單檢視控制件中的每個項都由圖示(從圖像清單中)、標籤、當前狀態和應用程式定義值(稱為"項數據")組成。 也可以與每個項目關聯一個或多個子項。 "子項"是一個字串,在報表視圖中,可以在項圖示和標籤右側的列中顯示。 清單檢視控制項中的所有項目必須具有相同的子項數。

類別`CListCtrl`提供了多個用於插入、刪除、尋找和修改這些專案的功能。 有關詳細資訊,請參閱[CListCtrl::取得專案](#getitem)[、CListCtrl::插入專案](#insertitem),和[CListCtrl:尋找專案](#finditem),[將專案加入到控制項](../adding-items-to-the-control.md),並在[清單控制項中捲動、排列、排序和尋找](../scrolling-arranging-sorting-and-finding-in-list-controls.md)。

預設情況下,清單檢視控制項負責儲存項的圖示和文本屬性。 但是,除了這些項類型之外,類`CListCtrl`還支援"回調項"。 "回檔項"是應用程式(而不是控制項)儲存文本、圖示或兩者的清單視圖項。 回調遮罩遮罩用於指定應用程式提供的項目屬性(文本和/或圖示)。 如果應用程式使用回調項,它必須能夠按需提供文本和/或圖示屬性。 當應用程式已維護某些此資訊時,回調項非常有用。 有關詳細資訊,請參閱使用[CListCtrl:回檔項目和回檔遮罩](../callback-items-and-the-callback-mask.md)。

## <a name="image-lists"></a>影像清單

清單檢視項的圖示、標題項圖像和應用程式定義狀態包含在多個影像清單中(由類[CImageList](cimagelist-class.md)實現),您創建這些列表檢視項並將其分配給清單檢視控制項。 每個清單檢視控制項最多可以有四種不同類型的影像清單:

- 大圖示

   在全尺寸圖示的圖示檢視中使用。

- 小圖示

   在圖示檢視中使用的較小版本的圖示的小圖示、清單和報表視圖中使用。

- 應用程式定義狀態

   包含狀態圖像,這些圖像顯示在項的圖示旁邊,以指示應用程式定義的狀態。

- 標頭項目

   在報表檢視中用於出現在每個標頭控制項中的小圖像。

預設情況下,清單檢視控制項元件銷毀分配給它的圖像清單;因此,清單檢視控制項會銷毀分配給它的圖像清單。但是,開發人員可以通過在不再使用每個映射清單時(由應用程式確定)來自定義此行為。 有關詳細資訊,請參閱使用[CListCtrl:清單項目和影像清單](../list-items-and-image-lists.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](cobject-class.md)

[CCmdTarget](ccmdtarget-class.md)

[CWnd](cwnd-class.md)

`CListCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

## <a name="clistctrlapproximateviewrect"></a><a name="approximateviewrect"></a>CListCtrl::近似檢視重新

確定顯示列表檢視控制項項所需的寬度和高度。

```
CSize ApproximateViewRect(
    CSize sz = CSize(-1, -1),
    int iCount = -1) const;
```

### <a name="parameters"></a>參數

*深圳*<br/>
控件的擬議尺寸(以像素為單位)。 如果未指定尺寸,則框架將使用控制項的當前寬度或高度值。

*i. Count*<br/>
要在控件中顯示的項數。 如果此參數為 -1,則框架將使用控制項中當前項的總數。

### <a name="return-value"></a>傳回值

包含`CSize`以像素為單位顯示專案所需的近似寬度和高度的物件。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_ApproximateViewRect](/windows/win32/api/commctrl/nf-commctrl-listview_approximateviewrect)的行為,如 Windows SDK 中所述。

## <a name="clistctrlarrange"></a><a name="arrange"></a>CListCtrl:排列

重新定位圖示檢視中的專案,使其在網格上對齊。

```
BOOL Arrange(UINT nCode);
```

### <a name="parameters"></a>參數

*n代碼*<br/>
指定項的對齊樣式。 它可能是下列其中一個值：

- LVA_ALIGNLEFT沿視窗左邊緣對齊專案。

- LVA_ALIGNTOP沿視窗的上邊緣對齊專案。

- LVA_DEFAULT根據清單檢視的當前對齊樣式(預設值)對齊項。

- LVA_SNAPTOGRID將所有圖示捕捉到最近的網格位置。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

*nCode*參數指定對齊樣式。

### <a name="example"></a>範例

```cpp
    // Align all of the list view control items along the top
    // of the window (the list view control must be in icon or
    // small icon mode).
    m_myListCtrl.Arrange(LVA_ALIGNTOP);
```

## <a name="clistctrlcanceleditlabel"></a><a name="canceleditlabel"></a>CListCtrl:: 取消編輯標籤

取消項目文字編輯操作。

```
void CancelEditLabel();
```

### <a name="remarks"></a>備註

此成員函數類比[LVM_CANCELEDITLABEL](/windows/win32/Controls/lvm-canceleditlabel)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlclistctrl"></a><a name="clistctrl"></a>CListCtrl::CListCtrl

建構 `CListCtrl` 物件。

```
CListCtrl();
```

## <a name="clistctrlcreate"></a><a name="create"></a>CListCtrl:建立

創建清單控制項並將其附加到`CListCtrl`物件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定清單控制項樣式。 將清單控制樣式的任意組合應用於控制項。 有關這些樣式的完整清單,請參閱 Windows SDK 中的[清單檢視視窗樣式](/windows/win32/Controls/list-view-window-styles)。 使用[Set 擴充樣式](#setextendedstyle)設定特定於控制項的擴充樣式。

*矩形*<br/>
指定清單控制項大小和位置。 它可以是`CRect`物件或[RECT](/previous-versions/dd162897\(v=vs.85\))結構。

*pparentwnd*<br/>
指定清單控制檔的父視窗(通常為`CDialog`。 它不得為 NULL。

*nID*<br/>
指定清單控制項的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

在兩個步驟`CListCtrl`中構造 一個。 首先調用構造函數,然後調用`Create`,這將創建列表檢視控制項並將其附加到`CListCtrl`物件。

要將延伸的 Windows 樣式應用於清單控制件物件,請`Create`呼叫[CreateEx](#createex)而不是 。

### <a name="example"></a>範例

```cpp
    m_myListCtrl.Create(
        WS_CHILD|WS_VISIBLE|WS_BORDER|LVS_REPORT|LVS_EDITLABELS,
        CRect(10,10,400,200), pParentWnd, IDD_MYLISTCTRL);
```

## <a name="clistctrlcreateex"></a><a name="createex"></a>CListCtrl::建立Ex

創建控制項(子視窗),並將其與`CListCtrl`物件關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要創建的控制項的擴充樣式。 有關擴展 Windows 樣式的清單,請參閱 Windows SDK 中[創建 WindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定清單控制項樣式。 將清單控制樣式的任意組合應用於控制項。 有關這些樣式的完整清單,請參閱 Windows SDK 中的[清單檢視視窗樣式](/windows/win32/Controls/list-view-window-styles)。

*矩形*<br/>
對[RECT](/previous-versions/dd162897\(v=vs.85\))結構的引用,描述要創建的視窗的大小和位置,在*pParentWnd*的用戶端座標中。

*pparentwnd*<br/>
指向控件的父視窗的指標。

*nID*<br/>
控制項的子視窗 ID。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而不是[「創建](#create)」來應用擴展的 Windows 樣式,該樣式由 Windows 擴充樣式前言**WS_EX_** 指定。

`CreateEx`使用*dwExStyle*指定的擴展 Windows 樣式創建控制項。 要設定特定於控制器的擴充樣式,請呼叫[Set 延伸樣式](#setextendedstyle)。 例如,用於`CreateEx`將此類樣式設置為WS_EX_CONTEXTHELP,但用於`SetExtendedStyle`將此類樣式設置為LVS_EX_FULLROWSELECT。 有關詳細資訊,請參閱 Windows SDK 中的[「擴展列表檢視樣式](/windows/win32/Controls/extended-list-view-styles)」一文中描述的樣式。

## <a name="clistctrlcreatedragimage"></a><a name="createdragimage"></a>CListCtrl:: 建立拖動影像

為*nItem*指定的項目建立拖動影像清單。

```
CImageList* CreateDragImage(
    int nItem,
    LPPOINT lpPoint);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要創建其拖動圖像清單的項索引。

*lpPoint*<br/>
在檢視座標中接收影像左上角的初始位置的[POINT](/previous-versions/dd162805\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

如果成功,指向拖動圖像清單的指標;否則 NULL。

### <a name="remarks"></a>備註

該`CImageList`對像是永久性的,您必須在完成該物件後將其刪除。 例如：

```cpp
        CImageList* pImageList = m_myListCtrl.CreateDragImage(nItem, &point);

        // do something

        delete pImageList;
```

## <a name="clistctrldeleteallitems"></a><a name="deleteallitems"></a>CListCtrl::DeleteAll專案

從清單檢視控制項中刪除所有項。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Delete all of the items from the list view control.
    m_myListCtrl.DeleteAllItems();
    ASSERT(m_myListCtrl.GetItemCount() == 0);
```

## <a name="clistctrldeletecolumn"></a><a name="deletecolumn"></a>CListCtrl::DeleteColumn

從清單檢視控制項中移除欄位。

```
BOOL DeleteColumn(int nCol);
```

### <a name="parameters"></a>參數

*nCol*<br/>
要刪除的列的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        int nColumnCount = m_myListCtrl.GetHeaderCtrl()->GetItemCount();

        // Delete all of the columns.
        for (int i=0; i < nColumnCount; i++)
        {
            m_myListCtrl.DeleteColumn(0);
        }
```

## <a name="clistctrldeleteitem"></a><a name="deleteitem"></a>CListCtrl::Delete專案

從清單檢視控制項中刪除項。

```
BOOL DeleteItem(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
指定要刪除的項目的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        int nCount = m_myListCtrl.GetItemCount();

        // Delete all of the items from the list view control.
        for (int i=0; i < nCount; i++)
        {
            m_myListCtrl.DeleteItem(0);
        }
```

## <a name="clistctrldrawitem"></a><a name="drawitem"></a>CListCtrl::D原始專案

當擁有者繪製列表檢視控制件的可視方面發生更改時,由框架調用。

```
virtual void DrawItem(LPDRAWITEMSTRUCT lpDrawItemStruct);
```

### <a name="parameters"></a>參數

*lpDraw 專案已結*<br/>
指向包含所需繪圖類型`DRAWITEMSTRUCT`資訊的結構的長指標。

### <a name="remarks"></a>備註

`itemAction` [DRAWITEMSTRUCT](/windows/win32/api/winuser/ns-winuser-drawitemstruct)結構的成員定義要執行的繪圖操作。

默認情況下,此成員函數不執行任何操作。 重寫此成員函數以擁有擁有者繪製物件的繪圖`CListCtrl`。

應用程式應還原在此成員函數終止之前為*lpDrawItemStruct*中提供的顯示上下文選擇的所有圖形設備介面 (GDI) 物件。

## <a name="clistctrleditlabel"></a><a name="editlabel"></a>CListCtrl::編輯標籤

開始就地編輯專案的文本。

```
CEdit* EditLabel(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要編輯的清單檢視項的索引。

### <a name="return-value"></a>傳回值

如果成功,則指向用於編輯`CEdit`專案文本的物件的指標;如果成功,則指向用於編輯專案文本的物件。否則 NULL。

### <a name="remarks"></a>備註

具有LVS_EDITLABELS視窗樣式的清單檢視控制項使用戶能夠就地編輯項目標籤。 用戶通過單擊具有焦點的項目的標籤開始編輯。

使用此函數開始就地編輯指定的清單檢視項的文本。

### <a name="example"></a>範例

```cpp
        // Make sure the focus is set to the list view control.
        m_myListCtrl.SetFocus();

        // Show the edit control on the label of the first
        // item in the list view control.
        CEdit* pmyEdit = m_myListCtrl.EditLabel(1);
        ASSERT(pmyEdit != NULL);
```

## <a name="clistctrlenablegroupview"></a><a name="enablegroupview"></a>CListCtrl::啟用群組檢視

啟用或停用清單檢視控制項中的項目是否顯示為群組。

```
LRESULT EnableGroupView(BOOL fEnable);
```

### <a name="parameters"></a>參數

*f 開啟*<br/>
指示是否啟用清單檢視控制項對顯示的項目進行分組。 TRUE 以啟用分組;FALSE 禁用它。

### <a name="return-value"></a>傳回值

傳回下列其中一值：

- **0**已啟用或禁用將列表檢視項顯示為組的能力。

- **1**控制項的狀態已成功更改。

- **-1**操作失敗。

### <a name="remarks"></a>備註

此成員函數類比[LVM_ENABLEGROUPVIEW](/windows/win32/Controls/lvm-enablegroupview)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlensurevisible"></a><a name="ensurevisible"></a>CListCtrl::確保可見

確保清單檢視項至少部分可見。

```
BOOL EnsureVisible(
    int nItem,
    BOOL bPartialOK);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要可見的清單檢視項的索引。

*b 部份OK*<br/>
指定部分可見性是否可以接受。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如有必要,將滾動清單視圖控件。 如果*bPartialOK*參數是非零,則如果專案部分可見,則不會發生滾動。

### <a name="example"></a>範例

```cpp
        // Ensure that the last item is visible.
        int nCount = m_myListCtrl.GetItemCount();
        if (nCount > 0)
            m_myListCtrl.EnsureVisible(nCount-1, FALSE);
```

## <a name="clistctrlfinditem"></a><a name="finditem"></a>CListCtrl::尋找專案

搜尋具有指定特徵的列表檢視項。

```
int FindItem(
    LVFINDINFO* pFindInfo,
    int nStart = -1) const;
```

### <a name="parameters"></a>參數

*pFindInfo*<br/>
指向[LVFINDINFO](/windows/win32/api/commctrl/ns-commctrl-lvfindinfow)結構的指標,其中包含有關要搜索的項的資訊。

*N 開始*<br/>
要開始搜索的項的索引,或從開頭開始的 -1。 如果*nStart*不等於 -1,則從搜索中排除*nStart*處的專案。

### <a name="return-value"></a>傳回值

如果成功或 -1,則項的索引。

### <a name="remarks"></a>備註

*pFindInfo*參數指向一`LVFINDINFO`個 結構,該結構包含用於搜索列表檢視項的資訊。

### <a name="example"></a>範例

```cpp
        LVFINDINFO info;
        int nIndex;

        info.flags = LVFI_PARTIAL|LVFI_STRING;
        info.psz = _T("item");

        // Delete all of the items that begin with the string.
        while ((nIndex = m_myListCtrl.FindItem(&info)) != -1)
        {
            m_myListCtrl.DeleteItem(nIndex);
        }
```

## <a name="clistctrlgetbkcolor"></a><a name="getbkcolor"></a>CListCtrl:getBkColor

檢索清單檢視控制項的背景顏色。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

用於指定 RGB 顏色的 32 位值。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:setBkColor](#setbkcolor)。

## <a name="clistctrlgetbkimage"></a><a name="getbkimage"></a>CListCtrl::GetBkImage

檢索清單檢視控制項的當前背景影像。

```
BOOL GetBkImage(LVBKIMAGE* plvbkImage) const;
```

### <a name="parameters"></a>參數

*plvbk影像*<br/>
指向包含清單檢視`LVBKIMAGE`的當前背景圖像的結構的指標。

### <a name="return-value"></a>傳回值

如果成功,則返回非零,否則返回零。

### <a name="remarks"></a>備註

此方法實現 Win32 宏[ListView_GetBkImage](/windows/win32/api/commctrl/nf-commctrl-listview_getbkimage)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        LVBKIMAGE bki;

        // If no background image is set for the list view control use
        // the Microsoft homepage image as the background image.
        if (m_myListCtrl.GetBkImage(&bki) && (bki.ulFlags == LVBKIF_SOURCE_NONE))
        {
            m_myListCtrl.SetBkImage(
                _T("https://www.microsoft.com/library/images/gifs/homepage/microsoft.gif"),
                TRUE);
        }
```

## <a name="clistctrlgetcallbackmask"></a><a name="getcallbackmask"></a>CListCtrl::取得回撥掩碼

檢索清單檢視控件的回調掩碼。

```
UINT GetCallbackMask() const;
```

### <a name="return-value"></a>傳回值

清單視圖控制件的回調掩碼。

### <a name="remarks"></a>備註

"回檔項"是應用程式(而不是控制項)儲存文本、圖示或兩者的清單視圖項。 儘管清單檢視控制項可以為您儲存這些屬性,但如果應用程式已維護某些此資訊,則可能需要使用回調項。 回調遮罩指定應用程式維護的項狀態位,它適用於整個控制項,而不是特定項。 回呼遮罩預設為零，表示控制項正在追蹤所有項目的狀態。 如果應用程式使用回調項或指定非零回調掩碼,則必須能夠按需提供列表視圖項屬性。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::設定回撥遮罩](#setcallbackmask)。

## <a name="clistctrlgetcheck"></a><a name="getcheck"></a>CListCtrl:抓取檢查

檢索與項目關聯的狀態圖像的當前顯示狀態。

```
BOOL GetCheck(int nItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
清單控制項項的零基索引。

### <a name="return-value"></a>傳回值

如果選中專案,則非零,否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetCheckState](/windows/win32/api/commctrl/nf-commctrl-listview_getcheckstate)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:SetCheck](#setcheck)。

## <a name="clistctrlgetcolumn"></a><a name="getcolumn"></a>CListCtrl:取得欄位

檢索清單檢視控制件列的屬性。

```
BOOL GetColumn(
    int nCol,
    LVCOLUMN* pColumn) const;
```

### <a name="parameters"></a>參數

*nCol*<br/>
要檢索其屬性的列的索引。

*pColumn*<br/>
[LVCOLUMN](/windows/win32/api/commctrl/ns-commctrl-lvcolumnw)結構的位址,用於指定要檢索和接收有關列的資訊的資訊。 成員`mask`指定要檢索的列屬性。 如果`mask`成員指定LVCF_TEXT值`pszText`, 則成員必須包含接收項文本的緩衝區的`cchTextMax`位址, 並且成員必須指定緩衝區的大小。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

結構`LVCOLUMN`包含有關報表視圖中的列的資訊。

### <a name="example"></a>範例

```cpp
        LVCOLUMN col;

        col.mask = LVCF_WIDTH;

        // Double the column width of the first column.
        if (m_myListCtrl.GetColumn(0, &col))
        {
            col.cx *= 2;
            m_myListCtrl.SetColumn(0, &col);
        }
```

## <a name="clistctrlgetcolumnorderarray"></a><a name="getcolumnorderarray"></a>CListCtrl::取得列柱順序陣列

檢索清單檢視控制件的列順序(從左至右)。

```
BOOL GetColumnOrderArray(
    LPINT piArray,
    int iCount = -1);
```

### <a name="parameters"></a>參數

*皮拉裡*<br/>
指向緩衝區的指標,該緩衝區將包含列表檢視控制項中列的索引值。 緩衝區必須足夠大,以包含列表視圖控制件中的列總數。

*i. Count*<br/>
清單檢視控制項中的欄位。 如果此參數為 -1,則框架會自動檢索列數。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetColumnOrderArray](/windows/win32/api/commctrl/nf-commctrl-listview_getcolumnorderarray)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        // Reverse the order of the columns in the list view control
        // (i.e. make the first column the last, the last column
        // the first, and so on...).
        CHeaderCtrl* pHeaderCtrl = m_myListCtrl.GetHeaderCtrl();

        if (pHeaderCtrl != NULL)
        {
            int  nColumnCount = pHeaderCtrl->GetItemCount();
            LPINT pnOrder = (LPINT) malloc(nColumnCount*sizeof(int));
            ASSERT(pnOrder != NULL);
            m_myListCtrl.GetColumnOrderArray(pnOrder, nColumnCount);

            int i, j, nTemp;
            for (i = 0, j = nColumnCount-1; i < j; i++, j--)
            {
                nTemp = pnOrder[i];
                pnOrder[i] = pnOrder[j];
                pnOrder[j] = nTemp;
            }

            m_myListCtrl.SetColumnOrderArray(nColumnCount, pnOrder);
            free(pnOrder);
        }
```

## <a name="clistctrlgetcolumnwidth"></a><a name="getcolumnwidth"></a>CListCtrl:取得縱桿寬度

檢索報表檢視或清單檢視中列的寬度。

```
int GetColumnWidth(int nCol) const;
```

### <a name="parameters"></a>參數

*nCol*<br/>
指定要檢索其寬度的列的索引。

### <a name="return-value"></a>傳回值

*nCol*指定的列的寬度(以像素為單位)。

### <a name="example"></a>範例

```cpp
        // Increase the column width of the second column by 20.
        int nWidth = m_myListCtrl.GetColumnWidth(1);
        m_myListCtrl.SetColumnWidth(1, 20 + nWidth);
```

## <a name="clistctrlgetcountperpage"></a><a name="getcountperpage"></a>CListCtrl::取得計數Perpage

計算在清單檢視或報表檢視中時可垂直適合清單檢視控制元件可見區域的項目。

```
int GetCountPerPage() const;
```

### <a name="return-value"></a>傳回值

在清單檢視或報表檢視中時,可以垂直適合列表檢視控制項的可見區域的項目。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::getTopIndex](#gettopindex)。

## <a name="clistctrlgeteditcontrol"></a><a name="geteditcontrol"></a>CListCtrl:取得編輯控制

檢索用於編輯列表檢視項文字的編輯控制項的句柄。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

如果成功,則指向用於編輯專案文本的 CEdit 物件的指標;如果成功,則指向[CEdit](cedit-class.md)物件。否則 NULL。

### <a name="example"></a>範例

```cpp
        // The string replacing the text in the edit control.
        LPCTSTR lpszmyString = _T("custom label!");

        // If possible, replace the text in the label edit control.
        CEdit* pEdit = m_myListCtrl.GetEditControl();

        if (pEdit != NULL)
        {
            pEdit->SetWindowText(lpszmyString);
        }
```

## <a name="clistctrlgetemptytext"></a><a name="getemptytext"></a>CListCtrl:取得空文字

檢索要顯示的字串,如果當前列表視圖控制項為空。

```
CString GetEmptyText() const;
```

### <a name="return-value"></a>傳回值

包含控制項為空時要顯示的文本的[CString。](../../atl-mfc-shared/reference/cstringt-class.md)

### <a name="remarks"></a>備註

此方法發送[LVM_GETEMPTYTEXT](/windows/win32/Controls/lvm-getemptytext)訊息,這在 Windows SDK 中介紹。

## <a name="clistctrlgetextendedstyle"></a><a name="getextendedstyle"></a>CListCtrl::取得式延伸樣式

檢索清單檢視控制項的目前擴展樣式。

```
DWORD GetExtendedStyle();
```

### <a name="return-value"></a>傳回值

清單檢視控制項目前正在使用的擴充樣式的組合。 有關這些擴展樣式的描述性清單,請參閱 Windows SDK 中的[擴展清單檢視樣式](/windows/win32/Controls/extended-list-view-styles)一文。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_GetExtendedListViewStyle](/windows/win32/api/commctrl/nf-commctrl-listview_getextendedlistviewstyle),如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:設定延伸樣式](#setextendedstyle)。

## <a name="clistctrlgetfirstselecteditemposition"></a><a name="getfirstselecteditemposition"></a>CListCtrl:取得第一選擇項目位置

獲取清單檢視控制項中第一個選定項目的位置。

```
POSITION GetFirstSelectedItemPosition() const;
```

### <a name="return-value"></a>傳回值

可用於反覆運算或對象指標檢索的定位值;如果未選擇任何項目,則為 NULL。

### <a name="example"></a>範例

以下代碼示例演示了此函數的用法。

```cpp
        POSITION pos = m_myListCtrl.GetFirstSelectedItemPosition();
        if (pos == NULL)
        {
            TRACE(_T("No items were selected!\n"));
        }
        else
        {
            while (pos)
            {
                int nItem = m_myListCtrl.GetNextSelectedItem(pos);
                TRACE(_T("Item %d was selected!\n"), nItem);
                // you could do your own processing on nItem here
            }
        }
```

## <a name="clistctrlgetfocusedgroup"></a><a name="getfocusedgroup"></a>CListCtrl:取得焦點群組

檢索目前清單檢視控制項中具有鍵盤焦點的組。

```
int GetFocusedGroup() const;
```

### <a name="return-value"></a>傳回值

其狀態為LVGS_FOCUSED的組的索引(如果有這樣的組);否則,-1。

### <a name="remarks"></a>備註

此方法發送[LVM_GETFOCUSEDGROUP](/windows/win32/Controls/lvm-getfocusedgroup)訊息,這在 Windows SDK 中介紹。 有關詳細資訊,請參閱`state`[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構成員LVGS_FOCUSED值。

## <a name="clistctrlgetgroupcount"></a><a name="getgroupcount"></a>CListCtrl::取得群數

檢索目前清單檢視控制項中的元件中的元件。

```
int GetGroupCount()const;
```

### <a name="return-value"></a>傳回值

清單檢視控制件中的元件中陣。

### <a name="remarks"></a>備註

此方法發送[LVM_GETGROUPCOUNT](/windows/win32/Controls/lvm-getgroupcount)消息,這在 Windows SDK > 中描述。

## <a name="clistctrlgetgroupinfo"></a><a name="getgroupinfo"></a>CListCtrl:取得群資訊

獲取清單檢視控制件的指定組的資訊。

```
int GetGroupInfo(
    int iGroupId,
    PLVGROUP pgrp) const;
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要檢索其資訊的組的標識符。

*pgrp*<br/>
指向[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)的指標,其中包含指定組的資訊。

### <a name="return-value"></a>傳回值

如果成功,則返回組的 ID,否則返回 -1。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETGROUPINFO](/windows/win32/Controls/lvm-getgroupinfo)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetgroupinfobyindex"></a><a name="getgroupinfobyindex"></a>CListCtrl:取得群資訊索引

檢索目前清單檢視控制項中指定組的資訊。

```
BOOL GetGroupInfoByIndex(
    int iIndex,
    PLVGROUP pGroup) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iIndex*|[在]組的零索引。|
|*p組*|[出]指向接收*iIndex*參數指定的組資訊的[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構的指標。<br /><br /> 調用者負責初始化[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構的成員。 將`cbSize`成員設置為結構的大小,並將`mask`成員的標誌設置為指定要檢索的資訊。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[LVM_GETGROUPINFOBYINDEX](/windows/win32/controls/lvm-getgroupinfobyindex)訊息,該消息在 Windows SDK 中描述 ,>。

### <a name="example"></a>範例

以下代碼範`m_listCtrl`例定義用於存取目前列表檢視 控制項的變數 。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

以下代碼範例展示該方法`GetGroupInfoByIndex`。 在此代碼示例的較早部分中,我們創建了一個列表視圖控件,該控件在報表視圖中顯示兩列標題為"ClientID"和"分級"。 以下代碼示例檢索有關索引為 0 的組的資訊(如果存在此類組)。

```cpp
    // GetGroupInfoByIndex
    const int GROUP_HEADER_BUFFER_SIZE = 40;

// Initialize the structure
    LVGROUP gInfo = {0};
    gInfo.cbSize = sizeof(LVGROUP);
    wchar_t wstrHeadGet[GROUP_HEADER_BUFFER_SIZE] = {0};
    gInfo.cchHeader = GROUP_HEADER_BUFFER_SIZE;
    gInfo.pszHeader = wstrHeadGet;
    gInfo.mask = (LVGF_ALIGN | LVGF_STATE | LVGF_HEADER | LVGF_GROUPID);
    gInfo.state = LVGS_NORMAL;
    gInfo.uAlign  = LVGA_HEADER_LEFT;

    BOOL bRet = m_listCtrl.GetGroupInfoByIndex( 0, &gInfo );
    if (bRet == TRUE) {
        CString strHeader = CString( gInfo.pszHeader );
        CString str;
        str.Format(_T("Header: '%s'"), strHeader);
        AfxMessageBox(str, MB_ICONINFORMATION);
    }
    else
    {
        AfxMessageBox(_T("No group information was retrieved."));
    }
```

## <a name="clistctrlgetgroupmetrics"></a><a name="getgroupmetrics"></a>CListCtrl:取得集團指標

檢索組的指標。

```
void GetGroupMetrics(PLVGROUPMETRICS pGroupMetrics) const;
```

### <a name="parameters"></a>參數

*P 組元指標*<br/>
指向包含組指標資訊的[LVGROUPMETRICS](/windows/win32/api/commctrl/ns-commctrl-lvgroupmetrics)的指標。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETGROUPMETRICS](/windows/win32/Controls/lvm-getgroupmetrics)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetgrouprect"></a><a name="getgrouprect"></a>CListCtrl::取得群組

檢索目前清單檢視控制項中指定群組的邊界矩形。

```
BOOL GetGroupRect(
    int iGroupId,
    LPRECT lpRect,
    int iCoords = LVGGR_GROUP) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iGroupId*|[在]指定群組。|
|*lpRect*|[進出]指向[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標。 如果此方法成功,則結構將接收*iGroupId*指定的組的矩形座標。|
|*iCoords*|[在]指定要檢索的矩形座標。 使用以下值之一:<br /><br /> - LVGGR_GROUP - (預設)整個展開的組的座標。<br />- LVGGR_HEADER - 僅座標的標頭(摺疊組)。<br />- LVGGR_SUBSETLINK - 僅座標子集連結(標記子集)。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

調用方負責分配*pRect*參數指向的[RECT](/previous-versions/dd162897\(v=vs.85\))結構。

此方法發送[LVM_GETGROUPRECT](/windows/win32/Controls/lvm-getgrouprect)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範`m_listCtrl`例定義用於存取目前列表檢視 控制項的變數 。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

以下代碼範例展示該方法`GetGroupRect`。 在此代碼示例的較早部分中,我們創建了一個列表視圖控件,該控件在報表視圖中顯示兩列標題為"ClientID"和"分級"。 以下代碼示例圍繞索引為 0 的組(如果存在)繪製一個 3D 矩形。

```cpp
    // GetGroupRect

    // Get the graphics rectangle that surrounds group 0.
    CRect rect;
    BOOL bRet = m_listCtrl.GetGroupRect( 0, &rect, LVGGR_GROUP);
    // Draw a blue rectangle around group 0.
    if (bRet == TRUE) {
        m_listCtrl.GetDC()->Draw3dRect( &rect, RGB(0, 0, 255), RGB(0, 0, 255));
    }
    else {
        AfxMessageBox(_T("No group information was retrieved."), MB_ICONINFORMATION);
    }
```

## <a name="clistctrlgetgroupstate"></a><a name="getgroupstate"></a>CListCtrl::取得群組狀態

檢索目前清單檢視控制項中指定組的狀態。

```
UINT GetGroupState(
    int iGroupId,
    DWORD dwMask) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iGroupId*|[在]組的零索引。|
|*dwMask*|[在]指定要指定組檢索的狀態值的掩碼。 有關詳細資訊,`mask`請參閱[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構的成員。|

### <a name="return-value"></a>傳回值

指定組的請求狀態,如果找不到組,則為 0。

### <a name="remarks"></a>備註

返回值是對*dwMask*參數的位和操作的結果,以及表示當前列表視圖控制`state`項的[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構成員的值。

此方法發送[LVM_GETGROUPSTATE](/windows/win32/Controls/lvm-getgroupstate)消息,這在 Windows SDK 中介紹。 有關詳細資訊,請參閱[ListView_GetGroupState](/windows/win32/api/commctrl/nf-commctrl-listview_getgroupstate)宏。

## <a name="clistctrlgetheaderctrl"></a><a name="getheaderctrl"></a>CListCtrl::取得頭Ctrl

檢索清單檢視控制項的標頭控制項。

```
CHeaderCtrl* GetHeaderCtrl();
```

### <a name="return-value"></a>傳回值

指向標題控制項的指標,由清單檢視控制項使用。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetHeader](/windows/win32/api/commctrl/nf-commctrl-listview_getheader)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::抓取欄位順序](#getcolumnorderarray)。

## <a name="clistctrlgethotcursor"></a><a name="gethotcursor"></a>CListCtrl:獲取霍伯庫伯

檢索為清單檢視控制項啟用熱追蹤時使用的游標。

```
HCURSOR GetHotCursor();
```

### <a name="return-value"></a>傳回值

清單檢視控制項正在使用的目前熱遊標資源的句柄。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetHotCursor](/windows/win32/api/commctrl/nf-commctrl-listview_gethotcursor)的行為,如 Windows SDK 中所述。 僅當游標經過任何列表視圖項時,才會顯示熱游標,僅在啟用懸停選擇時才可見。 通過設置擴展樣式LVS_EX_TRACKSELECT啟用懸停選擇。

### <a name="example"></a>範例

```cpp
        // Set the hot cursor to be the system app starting cursor.
        HCURSOR hCursor = ::LoadCursor(NULL, IDC_APPSTARTING);
        m_myListCtrl.SetHotCursor(hCursor);
        ASSERT(m_myListCtrl.GetHotCursor() == hCursor);
```

## <a name="clistctrlgethotitem"></a><a name="gethotitem"></a>CListCtrl:取得 Hot 專案

檢索當前在游標下的列表視圖項。

```
int GetHotItem();
```

### <a name="return-value"></a>傳回值

清單檢視控制項的目前熱項的索引。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetHotItem](/windows/win32/api/commctrl/nf-commctrl-listview_gethotitem)的行為,如 Windows SDK 中所述。 啟用熱跟蹤(和懸停選擇)時,熱項定義為當前選定的項。

如果啟用了熱跟蹤,當使用者暫停列表視圖項時,則項目標籤將自動突出顯示,而無需使用滑鼠按鈕。

### <a name="example"></a>範例

```cpp
    // Set the hot item to the first item only if no other item is
    // highlighted.
    if (m_myListCtrl.GetHotItem() == -1)
        m_myListCtrl.SetHotItem(0);
```

## <a name="clistctrlgethovertime"></a><a name="gethovertime"></a>CListCtrl::取得懸停時間

檢索清單檢視控制項的當前懸停時間。

```
DWORD GetHoverTime() const;
```

### <a name="return-value"></a>傳回值

返回延遲(以毫秒為單位),滑鼠游標必須在選擇之前將延遲懸停在專案上。 如果返回值為 -1,則懸停時間是預設懸停時間。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetHoverTime](/windows/win32/api/commctrl/nf-commctrl-listview_gethovertime)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        // If the hover time is the default set to 1 sec.
        DWORD dwTime = m_myListCtrl.GetHoverTime();
        if (dwTime == -1)
            m_myListCtrl.SetHoverTime(1000);
```

## <a name="clistctrlgetimagelist"></a><a name="getimagelist"></a>CListCtrl:抓取圖片清單

檢索用於繪製清單檢視項的圖像清單的句柄。

```
CImageList* GetImageList(int nImageList) const;
```

### <a name="parameters"></a>參數

*n 影像清單*<br/>
指定要檢索的影像清單的值。 其可以是下列其中一個值：

- LVSIL_NORMAL具有大圖示的圖像清單。

- LVSIL_SMALL帶有小圖標的圖像清單。

- LVSIL_STATE圖像清單與狀態圖像。

### <a name="return-value"></a>傳回值

指向用於繪製清單檢視項的圖像清單的指標。

### <a name="example"></a>範例

```cpp
        ASSERT(m_myListCtrl.GetImageList(LVSIL_NORMAL) == NULL);
        m_myListCtrl.SetImageList(&m_lcImageList, LVSIL_NORMAL);
        ASSERT(m_myListCtrl.GetImageList(LVSIL_NORMAL) == &m_lcImageList);
```

## <a name="clistctrlgetinsertmark"></a><a name="getinsertmark"></a>CListCtrl::取得插入標記

檢索插入標記的當前位置。

```
BOOL GetInsertMark(LPLVINSERTMARK plvim) const;
```

### <a name="parameters"></a>參數

*plvim*<br/>
指向[LVINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-lvinsertmark)結構的指標,其中包含插入標記的資訊。

### <a name="return-value"></a>傳回值

如果成功,則返回 TRUE,否則返回 FALSE。 如果`cbSize``LVINSERTMARK`結構成員中的大小不等於結構的實際大小,則返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETINSERTMARK](/windows/win32/Controls/lvm-getinsertmark)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CListCtrl::取得插入標記顏色

檢索插入標記的當前顏色。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

返回包含插入點顏色的[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETINSERTMARKCOLOR](/windows/win32/Controls/lvm-getinsertmarkcolor)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetinsertmarkrect"></a><a name="getinsertmarkrect"></a>CListCtrl::取得插入標記

檢索綁定插入點的矩形。

```
int GetInsertMarkRect(LPRECT pRect) const;
```

### <a name="parameters"></a>參數

*普雷克*<br/>
指向`RECT`包含綁定插入點的矩形座標的結構的指標。

### <a name="return-value"></a>傳回值

傳回下列其中一值：

- **0**未找到插入點。

- **找到 1**插入點。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETINSERTMARKRECT](/windows/win32/Controls/lvm-getinsertmarkrect)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetitem"></a><a name="getitem"></a>CListCtrl:取得項目

檢索清單檢視項的部分或全部屬性。

```
BOOL GetItem(LVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
指向接收項屬性的[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

結構`LVITEM`指定或接收清單檢視項的屬性。

## <a name="clistctrlgetitemcount"></a><a name="getitemcount"></a>CListCtrl::取得項目計數

檢索清單檢視控制項中的項目數。

```
int GetItemCount() const;
```

### <a name="return-value"></a>傳回值

清單檢視控制項中的項目數。

### <a name="example"></a>範例

請參閱[CListCtrl::Delete 專案](#deleteitem)的範例。

## <a name="clistctrlgetitemdata"></a><a name="getitemdata"></a>CListCtrl:抓取項目資料

檢索與 指定`nItem`的項關聯的 32 位元應用程式特定值。

```
DWORD_PTR GetItemData(int nItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要檢索其數據的清單項的索引。

### <a name="return-value"></a>傳回值

與指定項關聯的 32 位元應用程式特定值。

### <a name="remarks"></a>備註

此值是`lParam` [LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的成員,如 Windows SDK 中所述

### <a name="example"></a>範例

```cpp
    // If any item's data is equal to zero then reset it to -1.
    for (int i=0; i < m_myListCtrl.GetItemCount(); i++)
    {
        if (m_myListCtrl.GetItemData(i) == 0)
        {
            m_myListCtrl.SetItemData(i, (DWORD) -1);
        }
    }
```

## <a name="clistctrlgetitemindexrect"></a><a name="getitemindexrect"></a>CListCtrl::取得項目索引重新完成

檢索當前清單檢視控制項中全部或部分子項的邊界矩形。

```
BOOL GetItemIndexRect(
    PLVITEMINDEX pItemIndex,
    int iColumn,
    int rectType,
    LPRECT pRect) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItem索引*|[在]指向子項的父項的[LVITEMINDEX](/windows/win32/api/commctrl/ns-commctrl-lvitemindex)結構的指標。<br /><br /> 調用方負責分配和設置[LVITEMINDEX](/windows/win32/api/commctrl/ns-commctrl-lvitemindex)結構的成員。 此參數不可以是 NULL。|
|*iColumn*|[在]控件中列的零基索引。|
|*整流型態*|[在]檢索邊界矩形的列表檢視子項的一部分。 指定下列其中一個值：<br /><br /> LVIR_BOUNDS - 返回整個子項的邊界矩形,包括圖示和標籤。<br /><br /> LVIR_ICON - 返回圖示的邊界矩形或子項的小圖示。<br /><br /> LVIR_LABEL - 返回子項文字的邊界矩形。|
|*普雷克*|[出]指向[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標,該結構接收有關子項的邊界矩形的資訊。<br /><br /> 調用方負責分配[RECT](/previous-versions/dd162897\(v=vs.85\))結構。 此參數不可以是 NULL。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[LVM_GETITEMINDEXRECT](/windows/win32/Controls/lvm-getitemindexrect)消息,這在 Windows SDK 中介紹。 有關詳細資訊,請參閱[ListView_GetItemIndexRect宏](/windows/win32/api/commctrl/nf-commctrl-listview_getitemindexrect)。

### <a name="example"></a>範例

以下代碼範`m_listCtrl`例定義用於存取目前列表檢視 控制項的變數 。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

以下代碼範例展示該方法`GetGroupRect`。 在輸入此代碼示例之前,我們創建了一個列表視圖控件,在報表視圖中顯示兩列標題為"用戶端ID"和"分級"。 以下代碼示例圍繞兩列中的第二個子項繪製一個 3D 矩形。

```cpp
    // GetItemIndexRect
    // Get the rectangle that bounds the second item in the first group.
    LVITEMINDEX lvItemIndex;
    lvItemIndex.iGroup = 0;
    lvItemIndex.iItem = 1;
    CRect rect;
    BOOL bRet = m_listCtrl.GetItemIndexRect(
        &lvItemIndex, 0, LVIR_BOUNDS, &rect);

    // Draw a red rectangle around the item.
    m_listCtrl.GetDC()->Draw3dRect( &rect, RGB(255, 0, 0), RGB(255, 0, 0) );
```

## <a name="clistctrlgetitemposition"></a><a name="getitemposition"></a>CListCtrl:取得項目位置

檢索清單檢視項的位置。

```
BOOL GetItemPosition(
    int nItem,
    LPPOINT lpPoint) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要檢索其位置的項的索引。

*lpPoint*<br/>
在檢視座標中接收專案左上角位置的[POINT](/previous-versions/dd162805\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        POINT pt;

        // Move all items in the list control 100 pixels to the right.
        UINT i, nCount = m_myListCtrl.GetItemCount();

        for (i=0; i < nCount; i++)
        {
            m_myListCtrl.GetItemPosition(i, &pt);
            pt.x += 100;
            m_myListCtrl.SetItemPosition(i, pt);
        }
```

## <a name="clistctrlgetitemrect"></a><a name="getitemrect"></a>CListCtrl::取得項目重新完成

檢索當前檢視中全部或部分項的邊界矩形。

```
BOOL GetItemRect(
    int nItem,
    LPRECT lpRect,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要檢索其位置的項的索引。

*lpRect*<br/>
接收邊界矩形的[RECT](/previous-versions/dd162897\(v=vs.85\))結構的位址。

*n代碼*<br/>
要為其檢索邊界矩形的列表視圖項的一部分。 其可以是下列其中一個值：

- LVIR_BOUNDS返回整個項目的邊界矩形,包括圖示和標籤。

- LVIR_ICON返回圖示或小圖示的邊界矩形。

- LVIR_LABEL返回項目文本的邊界矩形。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
// OnClick is the handler for the NM_CLICK notification
void CListCtrlDlg::OnClick(NMHDR* pNMHDR, LRESULT* pResult)
{
    UNREFERENCED_PARAMETER(pResult);
    LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;

    // Get the current mouse location and convert it to client
    // coordinates.
    CPoint pos( ::GetMessagePos() );
    ScreenToClient(&pos);

    // Get indexes of the first and last visible items in
    // the listview control.
    int index = m_myListCtrl.GetTopIndex();
    int last_visible_index = index + m_myListCtrl.GetCountPerPage();
    if (last_visible_index > m_myListCtrl.GetItemCount())
        last_visible_index = m_myListCtrl.GetItemCount();

    // Loop until number visible items has been reached.
    while (index <= last_visible_index)
    {
        // Get the bounding rectangle of an item. If the mouse
        // location is within the bounding rectangle of the item,
        // you know you have found the item that was being clicked.
        CRect r;
        m_myListCtrl.GetItemRect(index, &r, LVIR_BOUNDS);
        if (r.PtInRect(pia->ptAction))
        {
            UINT flag = LVIS_SELECTED | LVIS_FOCUSED;
            m_myListCtrl.SetItemState(index, flag, flag);
            break;
        }

        // Get the next item in listview control.
        index++;
    }
}
```

## <a name="clistctrlgetitemspacing"></a><a name="getitemspacing"></a>CListCtrl:取得項目間距

計算目前清單檢視控制項中的項目之間的間距。

```
BOOL GetItemSpacing(
    BOOL fSmall,
    int* pnHorzSpacing,
    int* pnVertSpacing) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*fSmall*|[在]查看要為其檢索專案間距的視圖。 為小圖示檢視指定 TRUE,為圖示檢視指定 FALSE。|
|*pnHorzspacing*|[出]包含項之間的水準間距。|
|*pnVertspacing*|[出]包含項之間的垂直間距。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[LVM_GETITEMSPACING](/windows/win32/Controls/lvm-getitemspacing)訊息,這在 Windows SDK 中介紹。

## <a name="clistctrlgetitemstate"></a><a name="getitemstate"></a>CListCtrl::取得項目狀態

檢索清單檢視項的狀態。

```
UINT GetItemState(
    int nItem,
    UINT nMask) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要檢索其狀態的項的索引。

*nMask*<br/>
蒙版指定要返回哪個項的狀態標誌。

### <a name="return-value"></a>傳回值

指定清單檢視項目的狀態標誌。

### <a name="remarks"></a>備註

專案的狀態由`state`[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的成員指定,如 Windows SDK 中所述。 指定或更改項目的狀態時,`stateMask`成員將指定要更改的狀態位。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::getTopIndex](#gettopindex)。

## <a name="clistctrlgetitemtext"></a><a name="getitemtext"></a>CListCtrl::取得項目文字

檢索清單檢視項或子項的文字。

```
int GetItemText(
    int nItem,
    int nSubItem,
    LPTSTR lpszText,
    int nLen) const;

CString GetItemText(
    int nItem,
    int nSubItem) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要檢索其文本的項的索引。

*n 子項目*<br/>
指定要檢索其文本的子項。

*lpszText*<br/>
指向要接收項文本的字串的指標。

*nLen*<br/>
*lpszText*指向的緩衝區的長度。

### <a name="return-value"></a>傳回值

返回**int**的版本返回檢索的字串的長度。

返回的版本`CString`返回項文本。

### <a name="remarks"></a>備註

如果 nSubItem 為零,則此函數將檢索項標籤;如果*nSubItem*為零,則此函數將檢索物料標籤。如果*nSubItem*是非零,它將檢索子項的文本。 有關子項參數的詳細資訊,請參閱 Windows SDK 中有關[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的討論。

## <a name="clistctrlgetnextitem"></a><a name="getnextitem"></a>CListCtrl::取得下一個專案

搜尋具有指定屬性且與給定項具有指定關係的列表檢視項。

```
int GetNextItem(
    int nItem,
    int nFlags) const;
```

### <a name="parameters"></a>參數

*nItem*<br/>
要開始搜索的項的索引,或 -1 以查找與指定標誌匹配的第一個項。 指定的項本身從搜索中排除。

*nFlags*<br/>
請求項與指定項的幾何關係以及請求項的狀態。 幾何關係可以是以下值之一:

- LVNI_ABOVE 搜索高於指定項的項。

- LVNI_ALL按索引(預設值)搜索後續項。

- LVNI_BELOW搜索指定項下方的項。

- LVNI_TOLEFT 在指定項的左側搜索項。

- LVNI_TORIGHT 搜索指定項右側的項。

狀態可以是零,也可以是以下一個或多個值:

- LVNI_DROPHILITED 項已設置LVIS_DROPHILITED狀態標誌。

- LVNI_FOCUSED 項已設置LVIS_FOCUSED狀態標誌。

- LVNI_SELECTED 項已設置LVIS_SELECTED狀態標誌。

如果項未設置所有指定狀態標誌,則搜索將繼續執行下一個專案。

### <a name="return-value"></a>傳回值

下一項的索引(如果成功)或 -1 否則。

## <a name="clistctrlgetnextitemindex"></a><a name="getnextitemindex"></a>CListCtrl::取得下一個項目索引

檢索具有指定屬性集的當前列表檢視控制項中的項目的索引。

```
BOOL GetNextItemIndex(
    PLVITEMINDEX pItemIndex,
    int nFlags) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItem索引*|[進出]指向描述搜尋開始項的[LVITEMINDEX](/windows/win32/api/commctrl/ns-commctrl-lvitemindex)結構的指標,或 -1 以尋找與*nFlags*參數中的標誌匹配的第一個項。<br /><br /> 如果此方法成功,則`LVITEMINDEX`結構將描述搜索找到的項。|
|*nFlags*|[在]指定如何執行搜尋的標誌的位元群組 (OR)。<br /><br /> 搜索可以取決於目標項的索引、狀態或外觀,或者目標項相對於*pItemIndex*參數指定的項的物理位置。 有關詳細資訊,請參閱[LVM_GETNEXTITEMINDEX](/windows/win32/controls/lvm-getnextitemindex)消息中*的標誌*參數。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

呼叫者設定分配和設定*pItemIndex*參數`LVITEMINDEX`指向的結構成員。

此方法發送[LVM_GETNEXTITEMINDEX](/windows/win32/controls/lvm-getnextitemindex)消息,這在 Windows SDK 中介紹。

## <a name="clistctrlgetnextselecteditem"></a><a name="getnextselecteditem"></a>CListCtrl::取得下一個選定專案

取得*pos*識別的清單項目的索引,然後將*位置*設定到「位置」 值。

```
int GetNextSelectedItem(POSITION& pos) const;
```

### <a name="parameters"></a>參數

*Pos*<br/>
對以前調用`GetNextSelectedItem``GetFirstSelectedItemPosition`或返回的"位置"值的引用。 此調用將該值更新為下一個位置。

### <a name="return-value"></a>傳回值

*由 pos*標識的清單項的索引。

### <a name="remarks"></a>備註

如果使用`GetNextSelectedItem`調`GetFirstSelectedItemPosition`用 建立初始位置,則可以在轉發反覆運算迴圈中使用。

您必須確保您的「位置」 值有效。 如果無效,則Microsoft基礎類庫的調試版本斷言。

### <a name="example"></a>範例

以下代碼示例演示了此函數的用法。

```cpp
        POSITION pos = m_myListCtrl.GetFirstSelectedItemPosition();
        if (pos == NULL)
        {
            TRACE(_T("No items were selected!\n"));
        }
        else
        {
            while (pos)
            {
                int nItem = m_myListCtrl.GetNextSelectedItem(pos);
                TRACE(_T("Item %d was selected!\n"), nItem);
                // you could do your own processing on nItem here
            }
        }
```

## <a name="clistctrlgetnumberofworkareas"></a><a name="getnumberofworkareas"></a>CListctrl:取得工作範圍

檢索清單檢視控制項的目前工作區數。

```
UINT GetNumberOfWorkAreas() const;
```

### <a name="return-value"></a>傳回值

此時未使用。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetNumberOfWorkAreas](/windows/win32/api/commctrl/nf-commctrl-listview_getnumberofworkareas)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        UINT i, uCount = m_myListCtrl.GetNumberOfWorkAreas();
        LPRECT lpRects = (LPRECT) malloc(uCount*sizeof(RECT));

        if (lpRects != NULL)
        {
            // Dump all of the work area dimensions.
            m_myListCtrl.GetWorkAreas(uCount, lpRects);

            for (i=0; i < uCount; i++)
            {
                TRACE(_T("Work area %d; left = %d, top = %d, right = %d, ")
                    _T("bottom = %d\r\n"),
                    i, lpRects[i].left, lpRects[i].top, lpRects[i].right,
                    lpRects[i].bottom);
            }

            free(lpRects);
        }
        else
        {
            TRACE(_T("Couldn't allocate enough memory!"));
        }
```

## <a name="clistctrlgetoutlinecolor"></a><a name="getoutlinecolor"></a>CListCtrl::取得大綱顏色

檢索清單檢視控制項的邊框的顏色。

```
COLORREF GetOutlineColor() const;
```

### <a name="return-value"></a>傳回值

返回包含輪廓顏色的[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETOUTLINECOLOR](/windows/win32/Controls/lvm-getoutlinecolor)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetorigin"></a><a name="getorigin"></a>CListCtrl:取得原點

檢索清單檢視控制項的目前檢視來源。

```
BOOL GetOrigin(LPPOINT lpPoint) const;
```

### <a name="parameters"></a>參數

*lpPoint*<br/>
接收檢視來源的[POINT](/previous-versions/dd162805\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。 但是,如果控件位於報表視圖中,則返回值始終為零。

## <a name="clistctrlgetselectedcolumn"></a><a name="getselectedcolumn"></a>CListCtrl:取得精選欄位

檢索清單控制項中目前選定列的索引。

```
UINT GetSelectedColumn() const;
```

### <a name="return-value"></a>傳回值

所選列的索引。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETSELECTEDCOLUMN](/windows/win32/Controls/lvm-getselectedcolumn)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetselectedcount"></a><a name="getselectedcount"></a>CListCtrl:取得精選計數

檢索清單檢視控制項中選定項數量。

```
UINT GetSelectedCount() const;
```

### <a name="return-value"></a>傳回值

清單檢視控制項中所選項的數量。

### <a name="example"></a>範例

```cpp
        UINT i, uSelectedCount = m_myListCtrl.GetSelectedCount();
        int  nItem = -1;

        // Update all of the selected items.
        if (uSelectedCount > 0)
        {
            for (i=0; i < uSelectedCount; i++)
            {
                nItem = m_myListCtrl.GetNextItem(nItem, LVNI_SELECTED);
                ASSERT(nItem != -1);
                m_myListCtrl.Update(nItem);
            }
        }
```

## <a name="clistctrlgetselectionmark"></a><a name="getselectionmark"></a>CListCtrl:取得選擇標記

檢索清單檢視控制項的選擇標記。

```
int GetSelectionMark();
```

### <a name="return-value"></a>傳回值

零基選擇標記,如果沒有選擇標記,則為 -1。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetSelectionMark](/windows/win32/api/commctrl/nf-commctrl-listview_getselectionmark)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Set the selection mark to the first item only if no other item is
    // selected.
    if (m_myListCtrl.GetSelectionMark() == -1)
        m_myListCtrl.SetSelectionMark(0);
```

## <a name="clistctrlgetstringwidth"></a><a name="getstringwidth"></a>CListCtrl::取得字串寬度

確定顯示所有給定字串所需的最小列寬度。

```
int GetStringWidth(LPCTSTR lpsz) const;
```

### <a name="parameters"></a>參數

*lpsz*<br/>
要確定寬度的 null 終止字串的位址。

### <a name="return-value"></a>傳回值

以*lpsz*指向的字串的寬度(以像素為單位)。

### <a name="remarks"></a>備註

返回的寬度會考慮控件的當前字體和列邊距,但不考慮小圖示的寬度。

### <a name="example"></a>範例

```cpp
        CString strColumn;
        int nWidth;

        // Insert six columns in the list view control. Make the width of
        // the column be the width of the column header plus 50%.
        for (int i = 0; i < 6; i++)
        {
            strColumn.Format(_T("column %d"), i);
            nWidth = 3*m_myListCtrl.GetStringWidth(strColumn)/2;
            m_myListCtrl.InsertColumn(i, strColumn, LVCFMT_LEFT, nWidth);
        }
```

## <a name="clistctrlgetsubitemrect"></a><a name="getsubitemrect"></a>CListCtrl::抓取子項目重新完成

檢索清單檢視控制項中項的邊界矩形。

```
BOOL GetSubItemRect(
    int iItem,
    int iSubItem,
    int nArea,
    CRect& ref);
```

### <a name="parameters"></a>參數

*iItem*<br/>
子項的父項的索引。

*i子項目*<br/>
子項的一個基於的索引。

*nArea*<br/>
確定要檢索的邊界矩形(清單視圖子項)的部分。 邊界矩形的部分(圖示、標籤或兩者)通過將位或運算符應用於以下一個或多個值來指定:

- LVIR_BOUNDS返回整個項目的邊界矩形,包括圖示和標籤。

- LVIR_ICON返回圖示或小圖示的邊界矩形。

- LVIR_LABEL返回整個項目的邊界矩形,包括圖示和標籤。 這與LVIR_BOUNDS相同。

*ref*<br/>
對包含子項邊界矩形座標的[CRect](../../atl-mfc-shared/reference/crect-class.md)物件的引用。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_GetSubItemRect](/windows/win32/api/commctrl/nf-commctrl-listview_getsubitemrect)的行為,如 Windows SDK 中所述。

## <a name="clistctrlgettextbkcolor"></a><a name="gettextbkcolor"></a>CListCtrl:取得文字BkColor

檢索清單檢視控制項的文字背景顏色。

```
COLORREF GetTextBkColor() const;
```

### <a name="return-value"></a>傳回值

用於指定 RGB 顏色的 32 位值。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::設定文字BkColor](#settextbkcolor)。

## <a name="clistctrlgettextcolor"></a><a name="gettextcolor"></a>CListCtrl:取得文字顏色

檢索清單檢視控制項的文字顏色。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

用於指定 RGB 顏色的 32 位值。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::設定文字顏色](#settextcolor)。

## <a name="clistctrlgettileinfo"></a><a name="gettileinfo"></a>CListCtrl::取得Tileinfo

檢索有關清單檢視控制項中磁貼的資訊。

```
BOOL GetTileInfo(PLVTILEINFO plvti) const;
```

### <a name="parameters"></a>參數

*普夫蒂*<br/>
指向接收切片資訊的[LVTILEINFO](/windows/win32/api/commctrl/ns-commctrl-lvtileinfo)結構的指標。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETTILEINFO](/windows/win32/Controls/lvm-gettileinfo)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgettileviewinfo"></a><a name="gettileviewinfo"></a>CListCtrl::取得TileViewInfo

檢索有關磁貼檢視中的清單檢視控制項資訊。

```
BOOL GetTileViewInfo(PLVTILEVIEWINFO ptvi) const;
```

### <a name="parameters"></a>參數

*普特維*<br/>
指向接收檢索資訊的[LVTILEVIEWINFO](/windows/win32/api/commctrl/ns-commctrl-lvtileviewinfo)結構的指標。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETTILEVIEWINFO](/windows/win32/Controls/lvm-gettileviewinfo)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgettooltips"></a><a name="gettooltips"></a>CListCtrl:抓取工具提示

檢索清單檢視控制項用於顯示工具提示的工具提示控制項。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

指向清單控制項使用的[CToolTipCtrl](ctooltipctrl-class.md)物件的指標。 如果[「創建](#create)成員」函數使用樣式LVS_NOTOOLTIPS,則不使用工具提示,並且傳回 NULL。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[LVM_GETTOOLTIPS](/windows/win32/Controls/lvm-gettooltips)的行為,如 Windows SDK 中所述。 的`GetToolTips`MFC`CToolTipCtrl`實現傳回 由清單控制件使用的物件,而不是工具提示控制項的句柄。

### <a name="example"></a>範例

```cpp
        CToolTipCtrl* pTip = m_myListCtrl.GetToolTips();
        if (NULL != pTip)
        {
            pTip->UpdateTipText(_T("I'm a list view!"), &m_myListCtrl,
                IDD_MYLISTCTRL);
        }
```

## <a name="clistctrlgettopindex"></a><a name="gettopindex"></a>CListCtrl:取得Topindex

在清單檢視或報表檢視中檢視中檢視中檢視中圖表中的索引。

```
int GetTopIndex() const;
```

### <a name="return-value"></a>傳回值

最頂層可見項的索引。

### <a name="example"></a>範例

```cpp
        // Make sure the focus is set to the list view control.
        m_myListCtrl.SetFocus();

        // Select all of the items that are completely visible.
        int n = m_myListCtrl.GetTopIndex();
        int nLast = n + m_myListCtrl.GetCountPerPage();

        for (; n < nLast; n++)
        {
            m_myListCtrl.SetItemState(n, LVIS_SELECTED, LVIS_SELECTED);
            ASSERT(m_myListCtrl.GetItemState(n, LVIS_SELECTED) == LVIS_SELECTED);
        }
```

## <a name="clistctrlgetview"></a><a name="getview"></a>CListCtrl:取得檢視

獲取清單檢視控制件的檢視。

```
DWORD GetView() const;
```

### <a name="return-value"></a>傳回值

清單檢視控制項的目前檢視。

### <a name="remarks"></a>備註

此成員函數類比[LVM_GETVIEW](/windows/win32/Controls/lvm-getview)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlgetviewrect"></a><a name="getviewrect"></a>CListCtrl::取得檢視Rect

檢索清單檢視控制項中所有項的邊界矩形。

```
BOOL GetViewRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
[RECT](/previous-versions/dd162897\(v=vs.85\))結構的位址。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

清單檢視必須位於圖示檢視或小圖示檢視中。

## <a name="clistctrlgetworkareas"></a><a name="getworkareas"></a>CListCtrl::取得工作領域

檢索清單檢視控制項的當前工作區。

```
void GetWorkAreas(
    int nWorkAreas,
    LPRECT pRect) const;
```

### <a name="parameters"></a>參數

*n工作領域*<br/>
`RECT` *pRect*陣列中包含的結構數。

*普雷克*<br/>
指向接收清單檢視控制項工作區`RECT`的結構(或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件)陣列的指標。 這些結構中的值位於客戶端座標中。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_GetWorkAreas](/windows/win32/api/commctrl/nf-commctrl-listview_getworkareas),如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:抓取工作範圍的數量](#getnumberofworkareas)。

## <a name="clistctrlhasgroup"></a><a name="hasgroup"></a>CListCtrl::哈斯集團

確定清單檢視控制項是否具有指定的組。

```
BOOL HasGroup(int iGroupId) const;
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要請求的組的標識符。

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_HASGROUP](/windows/win32/Controls/lvm-hasgroup)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlhittest"></a><a name="hittest"></a>CListCtrl:hitTest

確定哪個清單檢視項(如果有)位於指定位置。

```
int HitTest(LVHITTESTINFO* pHitTestInfo) const;

int HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;
```

### <a name="parameters"></a>參數

*pHitTestInfo*<br/>
包含命中測試`LVHITTESTINFO`位置並接收命中測試結果資訊的結構的位址。

*pt*<br/>
要測試的點。

*pFlags*<br/>
指向接收有關測試結果資訊的整數的指標。 請參閱 Windows SDK`flags`中[LVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-lvhittestinfo)結構成員的說明。

### <a name="return-value"></a>傳回值

*pHitTestInfo*指定位置的專案索引(如果有)或 -1。

### <a name="remarks"></a>備註

您可以使用結構`flag`成員LVHT_ABOVE、LVHT_BELOW、LVHT_TOLEFT和LVHT_TORIGHT值來確定是否滾動清單視圖控件的內容。 例如,如果位置位於工作區的上方和左側,則可以組合其中兩個標誌。

您可以測試結構`flag`成員LVHT_ONITEM值,以確定給定位置是否超過列表檢視項。 此值是對結構成員LVHT_ONITEMICON、LVHT_ONITEMLABEL和LVHT_ONITEMSTATEICON值的`flag`一點-OR 操作。

### <a name="example"></a>範例

```cpp
void CListCtrlDlg::OnRClick(NMHDR* pNMHDR, LRESULT* pResult)
{
    LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;
    CPoint point(pia->ptAction);

    // Select the item the user clicked on.
    UINT uFlags;
    int nItem = m_myListCtrl.HitTest(point, &uFlags);

    if (uFlags & LVHT_ONITEMLABEL)
    {
        m_myListCtrl.SetItem(nItem, 0, LVIF_STATE, NULL, 0, LVIS_SELECTED,
            LVIS_SELECTED, 0);
    }

    *pResult = 0;
}
```

## <a name="clistctrlinsertcolumn"></a><a name="insertcolumn"></a>CListCtrl::插入欄位

在清單檢視控制項中插入新欄。

```
int InsertColumn(
    int nCol,
    const LVCOLUMN* pColumn);

int InsertColumn(
    int nCol,
    LPCTSTR lpszColumnHeading,
    int nFormat = LVCFMT_LEFT,
    int nWidth = -1,
    int nSubItem = -1);
```

### <a name="parameters"></a>參數

*nCol*<br/>
新列的索引。

*pColumn*<br/>
包含新列`LVCOLUMN`屬性的結構的位址。

*lpszColumnheading*<br/>
包含欄位標題的字串的位址。

*nFormat*<br/>
指定列對齊的整數。 它可以是這些值之一:LVCFMT_LEFT、LVCFMT_RIGHT或LVCFMT_CENTER。

*n 寬度*<br/>
列的寬度,以像素為單位。 如果此參數為 -1,則不設置列寬度。

*n 子項目*<br/>
與列關聯的子項的索引。 如果此參數為 -1,則沒有子項與列關聯。

### <a name="return-value"></a>傳回值

如果成功或 -1,則新列的索引。

### <a name="remarks"></a>備註

清單檢視控制項中最左側的列必須左對齊。

[LVCOLUMN](/windows/win32/api/commctrl/ns-commctrl-lvcolumnw)結構包含報表檢視中列的屬性。 它還用於接收有關列的資訊。 此結構在 Windows SDK 中描述。

## <a name="clistctrlinsertgroup"></a><a name="insertgroup"></a>CListCtrl::插入群組

將群組插入到清單檢視控制項中。

```
LRESULT InsertGroup(
    int index,
    PLVGROUP pgrp);
```

### <a name="parameters"></a>參數

*指數*<br/>
要插入組的項的索引。

*pgrp*<br/>
指向[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構的指標,其中包含要添加的組。

### <a name="return-value"></a>傳回值

返回組添加到的項的索引,如果操作失敗,則返回 -1。

### <a name="remarks"></a>備註

此成員函數類比[LVM_INSERTGROUP](/windows/win32/Controls/lvm-insertgroup)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlinsertgroupsorted"></a><a name="insertgroupsorted"></a>CListCtrl::插入群組排序

將指定的群組插入有序的組清單中。

```
LRESULT InsertGroupSorted(PLVINSERTGROUPSORTED pStructInsert);
```

### <a name="parameters"></a>參數

*pStructInsert*<br/>
指向包含要插入的組的[LVINSERTGROUPSORTED 結構](/windows/win32/api/commctrl/ns-commctrl-lvinsertgroupsorted)的指標。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[LVM_INSERTGROUPSORTED](/windows/win32/Controls/lvm-insertgroupsorted)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlinsertitem"></a><a name="insertitem"></a>CListCtrl::插入項目

將項目插入到列表檢視控制項中。

```
int InsertItem(const LVITEM* pItem);

int InsertItem(
    int nItem,
    LPCTSTR lpszItem);

int InsertItem(
    int nItem,
    LPCTSTR lpszItem,
    int nImage);

int InsertItem(
    UINT nMask,
    int nItem,
    LPCTSTR lpszItem,
    UINT nState,
    UINT nStateMask,
    int nImage,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
指向[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的指標,該結構指定專案的屬性,如 Windows SDK 中所述。

*nItem*<br/>
要插入的項的索引。

*lpszItem*<br/>
包含項標籤的字串的位址,如果項是回調項,則LPSTR_TEXTCALLBACK。 有關回檔項目的資訊,請參閱[CListCtrl::取得回檔遮罩](#getcallbackmask)。

*n 影像*<br/>
如果項是回調項,則I_IMAGECALLBACK索引。 有關回檔項目的資訊,請參閱[CListCtrl::取得回檔遮罩](#getcallbackmask)。

*nMask*<br/>
*nMask*參數指定作為參數傳遞的項屬性有效。 它可以是 Windows SDK 中的[LVITEM 結構](/windows/win32/api/commctrl/ns-commctrl-lvitemw)中描述的一個或多個掩碼值。 有效值可以與位或運算符組合。

*n州*<br/>
指示項目的狀態、狀態圖像和疊加圖像。 有關詳細資訊,請參閱 Windows SDK 主題[LVITEM 結構和](/windows/win32/api/commctrl/ns-commctrl-lvitemw)[列表查看項目狀態](/windows/win32/Controls/list-view-item-states),瞭解有效標誌的清單。

*nStateMask*<br/>
指示將檢索或修改狀態成員的哪些位。 有關詳細資訊,請參閱 Windows SDK 中的[LVITEM 結構](/windows/win32/api/commctrl/ns-commctrl-lvitemw)。

*lParam*<br/>
與項關聯的 32 位元應用程式特定值。 如果指定此參數,則必須將*nMask*屬性LVIF_PARAM。

### <a name="return-value"></a>傳回值

如果成功或 -1,則新專案的索引。

### <a name="remarks"></a>備註

調用此方法可能會導致LVM_INSERTITEM消息發送到控制項視窗。 控制項的關聯訊息處理程式可能無法在某些情況下設定項文本(例如使用視窗樣式,如LVS_OWNERDRAW)。 有關這些條件的詳細資訊,請參閱 Windows SDK 中的[LVM_INSERTITEM。](/windows/win32/Controls/lvm-insertitem)

### <a name="example"></a>範例

```cpp
        CString strText;
        int nColumnCount = m_myListCtrl.GetHeaderCtrl()->GetItemCount();

        // Insert 10 items in the list view control.
        for (int i = 0; i < 10; i++)
        {
            strText.Format(TEXT("item %d"), i);

            // Insert the item, select every other item.
            m_myListCtrl.InsertItem(LVIF_TEXT | LVIF_STATE, i, strText,
                (i % 2) == 0 ? LVIS_SELECTED : 0, LVIS_SELECTED, 0, 0);

            // Initialize the text of the subitems.
            for (int j = 1; j < nColumnCount; j++)
            {
                strText.Format(TEXT("sub-item %d %d"), i, j);
                m_myListCtrl.SetItemText(i, j, strText);
            }
        }
```

## <a name="clistctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a>CListCtrl::插入馬克希特測試

檢索最接近指定點的插入點。

```
int InsertMarkHitTest(
    LPPOINT pPoint,
    LPLVINSERTMARK plvim) const;
```

### <a name="parameters"></a>參數

*pPoint*<br/>
指向 POINT[結構的](/previous-versions/dd162805\(v=vs.85\))指標,該結構包含命中測試座標,相對於清單控制項的工作區區域。

*plvim*<br/>
指向[LVINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-lvinsertmark)結構的指標,用於指定最接近點參數定義的座標的插入點。

### <a name="return-value"></a>傳回值

最接近指定點的插入點。

### <a name="remarks"></a>備註

此成員函數類比[LVM_INSERTMARKHITTEST](/windows/win32/Controls/lvm-insertmarkhittest)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlisgroupviewenabled"></a><a name="isgroupviewenabled"></a>CListCtrl:是否啟用了群檢視

確定是否為清單檢視控制項啟用組檢視。

```
BOOL IsGroupViewEnabled() const;
```

### <a name="return-value"></a>傳回值

如果啟用了組視圖,則返回 TRUE,否則返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_ISGROUPVIEWENABLED](/windows/win32/Controls/lvm-isgroupviewenabled)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlisitemvisible"></a><a name="isitemvisible"></a>CListCtrl:是可分割的

指示當前清單檢視控制項中的指定項是否可見。

```
BOOL IsItemVisible(int index) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*指數*|[在]當前清單檢視控制項中項的零基索引。|

### <a name="return-value"></a>傳回值

如果指定的項可見,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[LVM_ISITEMVISIBLE](/windows/win32/Controls/lvm-isitemvisible)訊息,這在 Windows SDK 中介紹。

## <a name="clistctrlmapidtoindex"></a><a name="mapidtoindex"></a>CListctrl:mapIDToindex

將當前清單檢視控制項中項的唯一 ID 映射到索引。

```
UINT MapIDToIndex(UINT id) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*id*|[在]項的唯一 ID。|

### <a name="return-value"></a>傳回值

指定 ID 的目前索引。

### <a name="remarks"></a>備註

清單檢視控制項以索引在內部追蹤項。 這可能會帶來問題,因為索引可以在控件的生存期內更改。 清單檢視控制項可以在建立項時使用 ID 標籤項,並且您可以使用此 ID 來保證列表檢視控制項的生存期內的唯一性。

請注意,在多線程環境中,索引僅在承載清單視圖控件的線程上得到保證,而在後台線程上。

此方法發送[LVM_MAPIDTOINDEX](/windows/win32/controls/lvm-mapidtoindex)訊息,這在 Windows SDK 中介紹。

## <a name="clistctrlmapindextoid"></a><a name="mapindextoid"></a>CListctrl::映射索引TOID

將當前清單檢視控制項中的項目索引映射到唯一 ID。

```
UINT MapIndexToID(UINT index) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*指數*|[在]項的零基索引。|

### <a name="return-value"></a>傳回值

指定項的唯一 ID。

### <a name="remarks"></a>備註

清單檢視控制項以索引在內部追蹤項。 這可能會帶來問題,因為索引可以在控件的生存期內更改。 建立項時,清單檢視控制項可以使用 ID 標籤項目。 可以使用此 ID 訪問列表檢視控制件生存期內的特定項。

請注意,在多線程環境中,索引僅在承載清單視圖控件的線程上得到保證,而在後台線程上。

此方法發送[LVM_MAPINDEXTOID](/windows/win32/Controls/lvm-mapindextoid)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範`m_listCtrl`例定義用於存取目前列表檢視 控制項的變數 。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

以下代碼範例展示該方法`MapIndexToID`。 在此代碼示例的較早部分中,我們創建了一個列表視圖控件,該控件在報表視圖中顯示兩列標題為"ClientID"和"分級"。 下面的範例將每個清單檢視項的索引映射到標識號,然後檢索每個標識號的索引。 最後,該示例報告是否檢索了原始索引。

```cpp
    // MapIndexToID
    int iCount = m_listCtrl.GetItemCount();
    UINT nId = 0;
    UINT nIndex = 0;
    for (int iIndexOriginal = 0; iIndexOriginal < iCount; iIndexOriginal++)
    {
        // Map index to ID.
        nId = m_listCtrl.MapIndexToID((UINT)iIndexOriginal);

        // Map ID to index.
        nIndex = m_listCtrl.MapIDToIndex(nId);

        if (nIndex != (UINT)(iIndexOriginal))
        {
            CString str;
            str.Format(_T("Mapped index (%d) is not equal to original index (%d)"),
                nIndex, (UINT)(iIndexOriginal));
            AfxMessageBox(str);
            return;
        }
    }
    AfxMessageBox(_T("The mapped indexes and original indexes are equal."),
        MB_ICONINFORMATION);
```

## <a name="clistctrlmovegroup"></a><a name="movegroup"></a>CListCtrl:: 移動群組

將指定的組移到列表檢視控制項指定基於零的索引。

```
LRESULT MoveGroup(
    int iGroupId,
    int toIndex);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要移動的組的標識符。

*到索引*<br/>
要移動組的零基索引。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[LVM_MOVEGROUP](/windows/win32/Controls/lvm-movegroup)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlmoveitemtogroup"></a><a name="moveitemtogroup"></a>CListctrl::移動專案群組

將指定的項移到指定的群組中。

```
void MoveItemToGroup(
    int idItemFrom,
    int idGroupTo);
```

### <a name="parameters"></a>參數

*idItem 來自*<br/>
[在]要移動的項的索引。

*idGroupto*<br/>
[在]要移動到的組的標識符。

### <a name="remarks"></a>備註

> [!NOTE]
> 此方法當前未實現。

此方法類比[LVM_MOVEITEMTOGROUP](/windows/win32/Controls/lvm-moveitemtogroup)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlredrawitems"></a><a name="redrawitems"></a>CListCtrl::重繪項目

強制清單檢視控制項重新繪製一系列項。

```
BOOL RedrawItems(
    int nFirst,
    int nLast);
```

### <a name="parameters"></a>參數

*n第一*<br/>
要重新繪製的第一個專案的索引。

*n 上次*<br/>
要重新繪製的最後一個專案的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

在清單檢視視窗收到WM_PAINT消息之前,實際上不會重新繪製指定的專案。 要立即重新繪製,請使用此功能後調用 Windows[更新視窗](/windows/win32/api/winuser/nf-winuser-updatewindow)功能。

## <a name="clistctrlremoveallgroups"></a><a name="removeallgroups"></a>CListCtrl:: 刪除所有群組

從清單檢視控制項中移除所有組。

```
void RemoveAllGroups();
```

### <a name="remarks"></a>備註

此成員函數類比[LVM_REMOVEALLGROUPS](/windows/win32/Controls/lvm-removeallgroups)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlremovegroup"></a><a name="removegroup"></a>CListCtrl::刪除群組

從清單檢視控制項中移除指定的群組。

```
LRESULT RemoveGroup(int iGroupId);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
要刪除的組的標識碼。

### <a name="return-value"></a>傳回值

如果成功,則返回組的索引,否則返回 -1。

### <a name="remarks"></a>備註

此成員函數類比[LVM_REMOVEGROUP](/windows/win32/Controls/lvm-removegroup)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlscroll"></a><a name="scroll"></a>CListCtrl::滾動

滾動清單檢視控制件的內容。

```
BOOL Scroll(CSize size);
```

### <a name="parameters"></a>參數

*大小*<br/>
指定`CSize`水平和垂直滾動量(以像素為單位)的物件。 大小`y`成員*size*除 以清單檢視控制項列的高度(以像素為單位),控制項按生成的行數滾動。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="clistctrlsetbkcolor"></a><a name="setbkcolor"></a>CListCtrl::SetBkColor

設定清單檢視控制項的背景顏色。

```
BOOL SetBkColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*鉻*<br/>
要設置的背景顏色,或無背景顏色的CLR_NONE值。 具有背景顏色的清單檢視控制項比沒有背景顏色的控制項重繪速度明顯快。 有關詳細資訊,請參閱 Windows SDK 中的[COLORREF。](/windows/win32/gdi/colorref)

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        // Use the 3D button face color for the background.
        COLORREF crBkColor = ::GetSysColor(COLOR_3DFACE);
        m_myListCtrl.SetBkColor(crBkColor);
        ASSERT(m_myListCtrl.GetBkColor() == crBkColor);
```

## <a name="clistctrlsetbkimage"></a><a name="setbkimage"></a>CListCtrl::SetBkImage

設置清單檢視控制件的背景圖像。

```
BOOL SetBkImage(LVBKIMAGE* plvbkImage);

BOOL SetBkImage(
    HBITMAP hBitmap,
    BOOL fTile = TRUE,
    int xOffsetPercent = 0,
    int yOffsetPercent = 0);

BOOL SetBkImage(
    LPTSTR pszUrl,
    BOOL fTile = TRUE,
    int xOffsetPercent = 0,
    int yOffsetPercent = 0);
```

### <a name="parameters"></a>參數

*plvbk影像*<br/>
`LVBKIMAGE`包含新背景圖像資訊的結構的位址。

*hBitmap*<br/>
處理點陣圖。

*pszUrl*<br/>
包含背景影像網址的 NULL 終止字串。

*fTile*<br/>
如果要在列表視圖控件的後台平鋪圖像,則非零;否則 0。

*x 位移百分比*<br/>
圖像左邊緣的偏移量(以像素為單位),與列表檢視控制項的原點。

*yOffset%*<br/>
圖像上邊緣的偏移量(以像素為單位)來自列表檢視控制項的原點。

### <a name="return-value"></a>傳回值

如果成功,則返回非零,否則返回零。

### <a name="remarks"></a>備註

> [!NOTE]
> 由於`CListCtrl::SetBkImage`使用 OLE COM 功能,`SetBkImage`因此在使用 之前必須初始化 OLE 庫。 最好在應用程式初始化時初始化 COM 庫,並在應用程式終止時取消初始化庫。 這可在使用 ActiveX 技術、OLE 自動化、OLE 連結/ 嵌入或 ODBC/DAO 操作的 MFC 應用程式中自動完成。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:getBkImage](#getbkimage)。

## <a name="clistctrlsetcallbackmask"></a><a name="setcallbackmask"></a>CListCtrl::設定回撥遮罩

設置清單檢視控制件的回調掩碼。

```
BOOL SetCallbackMask(UINT nMask);
```

### <a name="parameters"></a>參數

*nMask*<br/>
回調掩碼的新值。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Set the callback mask so that only the selected and focused states
    // are stored for each item.
    m_myListCtrl.SetCallbackMask(LVIS_SELECTED|LVIS_FOCUSED);
    ASSERT(m_myListCtrl.GetCallbackMask() ==
        (LVIS_SELECTED|LVIS_FOCUSED));
```

## <a name="clistctrlsetcheck"></a><a name="setcheck"></a>CListCtrl::設定檢查

確定清單控制項項目的狀態影像是否可見。

```
BOOL SetCheck(
    int nItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*nItem*<br/>
清單控制項項的零基索引。

*f檢查*<br/>
指定項目的狀態圖像是否應可見。 預設情況下 *,fCheck*為 TRUE,狀態圖像可見。 如果*fCheck*是 FALSE,則它不可見。

### <a name="return-value"></a>傳回值

如果選中專案,則非零,否則為 0。

### <a name="example"></a>範例

```cpp
        int nCount = m_myListCtrl.GetItemCount();
        BOOL fCheck = FALSE;

        // Set the check state of every other item to TRUE and
        // all others to FALSE.
        for (int i = 0; i < nCount; i++)
        {
            m_myListCtrl.SetCheck(i, fCheck);
            ASSERT((m_myListCtrl.GetCheck(i) && fCheck) ||
                (!m_myListCtrl.GetCheck(i) && !fCheck));
            fCheck = !fCheck;
        }
```

## <a name="clistctrlsetcolumn"></a><a name="setcolumn"></a>CListCtrl::設定欄

設置清單檢視列的屬性。

```
BOOL SetColumn(
    int nCol,
    const LVCOLUMN* pColumn);
```

### <a name="parameters"></a>參數

*nCol*<br/>
要設置其屬性的列的索引。

*pColumn*<br/>
包含新列屬性的[LVCOLUMN](/windows/win32/api/commctrl/ns-commctrl-lvcolumnw)結構的位址,如 Windows SDK 中所述。 結構的成員`mask`指定要設置的列屬性。 如果`mask`成員指定LVCF_TEXT值,則結構的`pszText`成員 是 null 終止字串的位址,`cchTextMax`並且忽略結構的成員。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

請參閱[CListCtrl 的範例::獲取列。](#getcolumn)

## <a name="clistctrlsetcolumnorderarray"></a><a name="setcolumnorderarray"></a>CListCtrl::設定欄陣陣列

設置清單檢視控制件的列順序(從左至右)。

```
BOOL SetColumnOrderArray(
    int iCount,
    LPINT piArray);
```

### <a name="parameters"></a>參數

*皮拉裡*<br/>
指向包含清單檢視控制項中列的索引值的緩衝區的指標(從左至右)。 緩衝區必須足夠大,以包含列表視圖控制件中的列總數。

*i. Count*<br/>
清單檢視控制項中的欄位。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetColumnOrderArray](/windows/win32/api/commctrl/nf-commctrl-listview_setcolumnorderarray)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::抓取欄位順序](#getcolumnorderarray)。

## <a name="clistctrlsetcolumnwidth"></a><a name="setcolumnwidth"></a>CListCtrl::設定欄寬

更改報表檢視或清單檢視中列的寬度。

```
BOOL SetColumnWidth(
    int nCol,
    int cx);
```

### <a name="parameters"></a>參數

*nCol*<br/>
要為其設置寬度的列的索引。 在清單檢視中,此參數必須為 0。

*殘雪*<br/>
資料行的新寬度。 可以是LVSCW_AUTOSIZE也可以LVSCW_AUTOSIZE_USEHEADER,如 Windows SDK[中LVM_SETCOLUMNWIDTH](/windows/win32/Controls/lvm-setcolumnwidth)所述。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="clistctrlsetextendedstyle"></a><a name="setextendedstyle"></a>CListCtrl::設定延伸樣式

設置清單檢視控制項的目前擴展樣式。

```
DWORD SetExtendedStyle(DWORD dwNewStyle);
```

### <a name="parameters"></a>參數

*dwNewStyle*<br/>
清單檢視控制項使用的擴充樣式的組合。 有關這些樣式的描述性清單,請參閱 Windows SDK 中的[擴展清單檢視樣式](/windows/win32/Controls/extended-list-view-styles)主題。

### <a name="return-value"></a>傳回值

清單檢視控制項使用以前的擴展樣式的組合。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetExtendedListViewStyle](/windows/win32/api/commctrl/nf-commctrl-listview_setextendedlistviewstyle)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Allow the header controls item to be movable by the user.
    m_myListCtrl.SetExtendedStyle
        (m_myListCtrl.GetExtendedStyle()|LVS_EX_HEADERDRAGDROP);
```

## <a name="clistctrlsetgroupinfo"></a><a name="setgroupinfo"></a>CListCtrl::SetGroupInfo

設定描述當前清單檢視控制項的指定組的資訊。

```
int SetGroupInfo(
    int iGroupId,
    PLVGROUP pgrp);
```

### <a name="parameters"></a>參數

*iGroupId*<br/>
其資訊集組的標識符。

*pgrp*<br/>
指向包含要設置的資訊的[LVGROUP](/windows/win32/api/commctrl/ns-commctrl-lvgroup)結構的指標。 調用方負責分配此結構並設置其成員。

### <a name="return-value"></a>傳回值

如果方法成功,則組的 ID;否則,-1。

### <a name="remarks"></a>備註

此方法發送[LVM_SETGROUPINFO](/windows/win32/Controls/lvm-setgroupinfo)消息,這在 Windows SDK 中介紹。

## <a name="clistctrlsetgroupmetrics"></a><a name="setgroupmetrics"></a>CListCtrl::設定組指標

設置清單檢視控制件的元件。

```
void SetGroupMetrics(PLVGROUPMETRICS pGroupMetrics);
```

### <a name="parameters"></a>參數

*P 組元指標*<br/>
指向[LVGROUPMETRICS](/windows/win32/api/commctrl/ns-commctrl-lvgroupmetrics)結構的指標,其中包含要設置的組指標資訊。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETGROUPMETRICS](/windows/win32/Controls/lvm-setgroupmetrics)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsethotcursor"></a><a name="sethotcursor"></a>CListCtrl::設定HotCursor

設置為清單檢視控制項啟用熱追蹤時使用的遊標。

```
HCURSOR SetHotCursor(HCURSOR hc);
```

### <a name="parameters"></a>參數

*Hc*<br/>
游標資源的句柄,用於表示熱遊標。

### <a name="return-value"></a>傳回值

清單檢視控制項正在使用以前的熱遊標資源的句柄。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetHotCursor](/windows/win32/api/commctrl/nf-commctrl-listview_sethotcursor)的行為,如 Windows SDK 中所述。

熱游標(僅在啟用懸停選擇時可見)出現在游標經過任何列表視圖項時。 通過設置擴展樣式LVS_EX_TRACKSELECT啟用懸停選擇。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::取得 HotCursor](#gethotcursor)。

## <a name="clistctrlsethotitem"></a><a name="sethotitem"></a>CListCtrl::設定Hot專案

設置清單檢視控制件的當前熱項。

```
int SetHotItem(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
要設置為熱項的項的零基索引。

### <a name="return-value"></a>傳回值

以前熱項的零基索引。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_SetHotItem](/windows/win32/api/commctrl/nf-commctrl-listview_sethotitem),如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:取得 HotItem](#gethotitem)。

## <a name="clistctrlsethovertime"></a><a name="sethovertime"></a>CListCtrl::設定懸停時間

設置清單檢視控制件的當前懸停時間。

```
DWORD SetHoverTime(DWORD dwHoverTime = (DWORD)-1);
```

### <a name="parameters"></a>參數

*dwHover時間*<br/>
新的延遲(以毫秒為單位),滑鼠游標必須在選擇專案之前將其懸停在專案上。 如果傳遞預設值,則時間設置為預設懸停時間。

### <a name="return-value"></a>傳回值

上一個懸停時間,以毫秒為單位。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetHoverTime](/windows/win32/api/commctrl/nf-commctrl-listview_sethovertime)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::抓取時間 。](#gethovertime)

## <a name="clistctrlseticonspacing"></a><a name="seticonspacing"></a>CListCtrl::設定圖示

設置清單檢視控制件中圖示之間的間距。

```
CSize SetIconSpacing(
    int cx,
    int cy);

CSize SetIconSpacing(CSize size);
```

### <a name="parameters"></a>參數

*殘雪*<br/>
x 軸圖示之間的距離(以像素為單位)。

*cy*<br/>
y 軸圖示之間的距離(以像素為單位)。

*大小*<br/>
指定`CSize`x 軸和 y 軸圖示之間的距離(以像素為單位)的物件。

### <a name="return-value"></a>傳回值

包含圖示間距的先前值的[CSize](../../atl-mfc-shared/reference/csize-class.md)物件。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetIconSpacing](/windows/win32/api/commctrl/nf-commctrl-listview_seticonspacing)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Leave lots of space between icons.
    m_myListCtrl.SetIconSpacing(CSize(100, 100));
```

## <a name="clistctrlsetimagelist"></a><a name="setimagelist"></a>CListCtrl::設定影像清單

將影像清單分配給清單檢視控制項。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指向要分配的圖像清單的指標。

*n 影像清單類型*<br/>
圖像清單的類型。 其可以是下列其中一個值：

- LVSIL_NORMAL具有大圖示的圖像清單。

- LVSIL_SMALL帶有小圖標的圖像清單。

- LVSIL_STATE圖像清單與狀態圖像。

### <a name="return-value"></a>傳回值

指向上一個圖像清單的指標。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::抓取影像清單](#getimagelist)。

## <a name="clistctrlsetinfotip"></a><a name="setinfotip"></a>CListCtrl::設定資訊提示

設定工具提示文字。

```
BOOL SetInfoTip(PLVSETINFOTIP plvInfoTip);
```

### <a name="parameters"></a>參數

*PlvInfo提示*<br/>
指向[LVFSETINFOTIP](/windows/win32/api/commctrl/ns-commctrl-lvsetinfotip)結構的指標,其中包含要設置的資訊。

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETINFOTIP](/windows/win32/Controls/lvm-setinfotip)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetinsertmark"></a><a name="setinsertmark"></a>CListCtrl::設定插入標記

將插入點設置到定義的位置。

```
BOOL SetInsertMark(LPLVINSERTMARK plvim);
```

### <a name="parameters"></a>參數

*plvim*<br/>
指向[LVINSERTMARK](/windows/win32/api/commctrl/ns-commctrl-lvinsertmark)結構的指標,指定在何處設置插入點。

### <a name="return-value"></a>傳回值

如果成功,則返回 TRUE,否則返回 FALSE。 如果`cbSize``LVINSERTMARK`結構成員中的大小不等於結構的實際大小,或者插入點不應用於當前視圖中,則返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETINSERTMARK](/windows/win32/Controls/lvm-setinsertmark)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CListCtrl::設定插入標記顏色

設置插入點的顏色。

```
COLORREF SetInsertMarkColor(COLORREF color);
```

### <a name="parameters"></a>參數

*顏色*<br/>
指定顏色以設定插入點的[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="return-value"></a>傳回值

返回包含`COLORREF`前一種顏色的結構。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETINSERTMARKCOLOR](/windows/win32/Controls/lvm-setinsertmarkcolor)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetitem"></a><a name="setitem"></a>CListCtrl:設定項目

設置清單檢視項的部分或全部屬性。

```
BOOL SetItem(const LVITEM* pItem);

BOOL SetItem(
    int nItem,
    int nSubItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);

BOOL SetItem(
    int nItem,
    int nSubItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    int nIndent);
```

### <a name="parameters"></a>參數

*pItem*<br/>
包含新項目屬性的[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的位址,如 Windows SDK 中所述。 結構的成員`iItem``iSubItem`標識項或子項,`mask`結構的成員指定要設置的屬性。 有關成員的詳細資訊,`mask`請參考**備註**。

*nItem*<br/>
要設置其屬性的項的索引。

*n 子項目*<br/>
要設置其屬性的子項的索引。

*nMask*<br/>
指定要設置的屬性(請參閱備註)。

*lpszItem*<br/>
指定項目標籤的 null 結束字串的位址。

*n 影像*<br/>
專案圖像在圖像清單中的索引。

*n州*<br/>
指定要更改狀態的值(請參閱備註)。

*nStateMask*<br/>
指定要更改哪些狀態(請參閱備註)。

*lParam*<br/>
要與項關聯的 32 位應用程式特定值。

*n 因登特*<br/>
縮進的寬度(以像素為單位)。 如果*nIndent*小於系統定義的最小寬度,則新寬度將設定為系統定義的最小寬度

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

`LVITEM`結構`iItem`的`iSubItem`和成員以及*nItem*和*nSubItem*參數標識要設置其屬性的項和子項。

結構和`mask``LVITEM` *nMask*參數的成員指定要設定的項目屬性:

- LVIF_TEXT`pszText`成員或*lpszItem*參數是 null 終止字串的位址;將`cchTextMax`忽略該成員。

- LVIF_STATE`stateMask`成員或*nStateMask*參數指定要更改`state`的項狀態 ,並且成員或*nState*參數包含這些狀態的值。

### <a name="example"></a>範例

請參閱[CListCtrl 的範例::hitTest](#hittest)。

## <a name="clistctrlsetitemcount"></a><a name="setitemcount"></a>CListCtrl::設定項目計數

準備列表檢視控制項以添加大量項。

```
void SetItemCount(int nItems);
```

### <a name="parameters"></a>參數

*n 專案*<br/>
控件最終將包含的項數。

### <a name="remarks"></a>備註

要設定虛擬清單檢視控制的項目計數,請參閱[CListCtrl::setItemCountEx](#setitemcountex)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_SetItemCount](/windows/win32/api/commctrl/nf-commctrl-listview_setitemcount),如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
        CString str;

        // Add 1024 items to the list view control.
        m_myListCtrl.SetItemCount(1024);

        for (int i = 0; i < 1024; i++)
        {
            str.Format(TEXT("item %d"), i);
            m_myListCtrl.InsertItem(i, str);
        }
```

## <a name="clistctrlsetitemcountex"></a><a name="setitemcountex"></a>CListCtrl::設定項目計數Ex

設定虛擬清單檢視控制項的項目計數。

```
BOOL SetItemCountEx(
    int iCount,
    DWORD dwFlags = LVSICF_NOINVALIDATEALL);
```

### <a name="parameters"></a>參數

*i. Count*<br/>
控件最終將包含的項數。

*dwFlags*<br/>
指定重置項目計數后列表檢視控制項的行為。 這個值可以是以下因素的組合:

- LVSICF_NOINVALIDATEALL 除非受影響的項當前在視圖中,否則列表視圖控件不會重新繪製。 這是預設值。

- LVSICF_NOSCROLL 當項目計數更改時,列表檢視控制項不會更改滾動位置。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetItemCountEx](/windows/win32/api/commctrl/nf-commctrl-listview_setitemcountex)的行為,如 Windows SDKand 中所述,應僅調用虛擬清單視圖。

### <a name="example"></a>範例

```cpp
        CString str;

        // Add 1024 items to the list view control.

        // Force my virtual list view control to allocate
        // enough memory for my 1024 items.
        m_myVirtualListCtrl.SetItemCountEx(1024, LVSICF_NOSCROLL|
            LVSICF_NOINVALIDATEALL);

        for (int i = 0; i < 1024; i++)
        {
            str.Format(TEXT("item %d"), i);
            m_myVirtualListCtrl.InsertItem(i, str);
        }
```

## <a name="clistctrlsetitemdata"></a><a name="setitemdata"></a>CListCtrl::設定項目資料

設置與*nItem*指定的項關聯的 32 位元應用程式特定值。

```
BOOL SetItemData(int nItem, DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要設置其數據的清單項的索引。

*dwData*<br/>
要與項關聯的 32 位值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此值是`lParam` [LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的成員,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Set the data of each item to be equal to its index.
    for (int i = 0; i < m_myListCtrl.GetItemCount(); i++)
    {
        m_myListCtrl.SetItemData(i, i);
    }
```

## <a name="clistctrlsetitemindexstate"></a><a name="setitemindexstate"></a>CListCtrl::設定項目索引狀態

設定當前清單檢視控制項中項的狀態。

```
BOOL SetItemIndexState(
    PLVITEMINDEX pItemIndex,
    DWORD dwState,
    DWORD dwMask) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pItem索引*|[在]指向描述項的[LVITEMINDEX](/windows/win32/api/commctrl/ns-commctrl-lvitemindex)結構的指標。 調用方負責分配此結構並設置其成員。|
|*德沃州*|[在]要設置項的狀態,這是[列表視圖項狀態](/windows/win32/Controls/list-view-item-states)的位組合。 指定要重置的零或要設置的狀態。|
|*dwMask*|[在]*dwState*參數指定的狀態的有效位的掩碼。 指定[清單檢視項目狀態](/windows/win32/Controls/list-view-item-states)的位元群組 (OR)。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

關於*dwState*參數的詳細資訊,請參考[清單檢視項目狀態](/windows/win32/Controls/list-view-item-states)。

有關*dwMask*參數的詳細資訊,請參閱[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構*的狀態掩碼*成員。

此方法發送[LVM_SETITEMINDEXSTATE](/windows/win32/Controls/lvm-setitemindexstate)消息,這在 Windows SDK 中介紹。

## <a name="clistctrlsetitemposition"></a><a name="setitemposition"></a>CListCtrl::設定項目位置

將項目移至列表檢視控制檔中的指定位置。

```
BOOL SetItemPosition(
    int nItem,
    POINT pt);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要設置其位置的項的索引。

*pt*<br/>
指定專案左上角的新位置(在檢視座標中)的[POINT](/previous-versions/dd162805\(v=vs.85\))結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

控件必須位於圖示或小圖示檢視中。

如果清單檢視控制項具有LVS_AUTOARRANGE樣式,則清單檢視在設置專案位置後進行排列。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::抓取項目位置](#getitemposition)。

## <a name="clistctrlsetitemstate"></a><a name="setitemstate"></a>CListCtrl::設定項目狀態

更改清單檢視控制項中項的狀態。

```
BOOL SetItemState(
    int nItem,
    LVITEM* pItem);

BOOL SetItemState(
    int nItem,
    UINT nState,
    UINT nMask);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要設置其狀態的項的索引。

*pItem*<br/>
[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的位址,如Windows SDK中所述。 結構的成員`stateMask`指定要更改的狀態位,並且結構的`state`成員 包含這些位的新值。 其他成員將被忽略。

*n州*<br/>
狀態位的新值。 有關可能值的清單,請參閱[CListCtrl:getNextItem](#getnextitem)和[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)狀態成員。

*nMask*<br/>
蒙版指定要更改的狀態位。 此值對應於[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的狀態掩碼成員。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

項的「狀態」是指定項的可用性、指示使用者操作或以其他方式反映項狀態的值。 清單檢視控制項會更改某些狀態位,例如當使用者選擇項時。 應用程式可能會更改其他狀態位以禁用或隱藏該專案,或指定疊加圖像或狀態圖像。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::getTopIndex](#gettopindex)。

## <a name="clistctrlsetitemtext"></a><a name="setitemtext"></a>CListCtrl::設定項目文字

變更列表檢視項目或子項目的文字。

```
BOOL SetItemText(
    int nItem,
    int nSubItem,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要設置其文本的項的索引。

*n 子項目*<br/>
子項的索引,或用於設置項標籤的零。

*lpszText*<br/>
指向包含新項目文本的字串的指標。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此方法不適用於包含LVS_OWNERDATA視窗樣式的控件(實際上,這將導致調試版本中的斷言)。 有關此清單控制項樣式的詳細資訊,請參考[清單檢視控制元件概述](/windows/win32/Controls/list-view-controls-overview)。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:插入項目](#insertitem)。

## <a name="clistctrlsetoutlinecolor"></a><a name="setoutlinecolor"></a>CListCtrl::設定大綱顏色

如果設置了[LVS_EX_BORDERSELECT](/windows/win32/Controls/list-view-window-styles)擴展視窗樣式,則設置列表檢視控制項的邊框顏色。

```
COLORREF SetOutlineColor(COLORREF color);
```

### <a name="parameters"></a>參數

*顏色*<br/>
包含輪廓顏色的新[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="return-value"></a>傳回值

包含輪`COLORREF`廓顏色的前一個結構

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETOUTLINECOLOR](/windows/win32/Controls/lvm-setoutlinecolor)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetselectedcolumn"></a><a name="setselectedcolumn"></a>CListCtrl::設定選擇欄位

設置清單檢視控制項的選定欄。

```
LRESULT SetSelectedColumn(int iCol);
```

### <a name="parameters"></a>參數

*iCol*<br/>
要選擇的列的索引。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETSELECTEDCOLUMN](/windows/win32/Controls/lvm-setselectedcolumn)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetselectionmark"></a><a name="setselectionmark"></a>CListCtrl::設定選擇標記

設置清單檢視控制件的選擇標記。

```
int SetSelectionMark(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
多個選定中第一項的零基索引。

### <a name="return-value"></a>傳回值

上一個選擇標記,如果沒有選擇標記,則為 -1。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_SetSelectionMark](/windows/win32/api/commctrl/nf-commctrl-listview_setselectionmark),如 Windows SDK 中所述。

### <a name="example"></a>範例

請參考[CListCtrl 的範例::取得選擇標籤](#getselectionmark)。

## <a name="clistctrlsettextbkcolor"></a><a name="settextbkcolor"></a>CListCtrl::設定文字BkColor

設定清單檢視控制項中文字的背景顏色。

```
BOOL SetTextBkColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*鉻*<br/>
指定新文字背景顏色的 COLORREF。 有關詳細資訊,請參閱 Windows SDK 中的[COLORREF。](/windows/win32/gdi/colorref)

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
        // Use the 3D button face color for the background.
        COLORREF crBkColor = ::GetSysColor(COLOR_3DFACE);
        m_myListCtrl.SetTextBkColor(crBkColor);
        ASSERT(m_myListCtrl.GetTextBkColor() == crBkColor);
```

## <a name="clistctrlsettextcolor"></a><a name="settextcolor"></a>CListCtrl::設定文字顏色

設定清單檢視控制項的文字顏色。

```
BOOL SetTextColor(COLORREF cr);
```

### <a name="parameters"></a>參數

*鉻*<br/>
指定新文字顏色的 COLORREF。 有關詳細資訊,請參閱 Windows SDK 中的[COLORREF。](/windows/win32/gdi/colorref)

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="example"></a>範例

```cpp
    // Use the window text color for
    // the item text of the list view control.
    COLORREF crTextColor = ::GetSysColor(COLOR_WINDOWTEXT);
    m_myListCtrl.SetTextColor(crTextColor);
    ASSERT(m_myListCtrl.GetTextColor() == crTextColor);
```

## <a name="clistctrlsettileinfo"></a><a name="settileinfo"></a>CListCtrl::SetTileInfo

設置清單檢視控制件的磁貼的資訊。

```
BOOL SetTileInfo(PLVTILEINFO pTileInfo);
```

### <a name="parameters"></a>參數

*pTileInfo*<br/>
指向[LVTILEINFO](/windows/win32/api/commctrl/ns-commctrl-lvtileinfo)結構的指標,其中包含要設置的資訊。

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETTILEINFO](/windows/win32/Controls/lvm-settileinfo)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsettileviewinfo"></a><a name="settileviewinfo"></a>CListCtrl::SetTileViewInfo

設定清單檢視控制檔在磁貼檢視中使用的資訊。

```
BOOL SetTileViewInfo(PLVTILEVIEWINFO ptvi);
```

### <a name="parameters"></a>參數

*普特維*<br/>
指向[LVTILEVIEWINFO](/windows/win32/api/commctrl/ns-commctrl-lvtileviewinfo)結構的指標,其中包含要設置的資訊。

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETTILEVIEWINFO](/windows/win32/Controls/lvm-settileviewinfo)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsettooltips"></a><a name="settooltips"></a>CListCtrl::設定工具提示

設定清單檢視控制項將用於顯示工具提示的工具提示控制項。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pwndTip*<br/>
指向清單控制項將使用`CToolTipCtrl`的物件的指標。

### <a name="return-value"></a>傳回值

指向包含控制項以前使用的工具提示的[CToolTipCtrl](ctooltipctrl-class.md)物件的指標,如果以前未使用工具提示,則指向 NULL。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[LVM_SETTOOLTIPS](/windows/win32/Controls/lvm-settooltips)的行為,如 Windows SDK 中所述。

要不使用工具提示,請指示創建`CListCtrl`物件時LVS_NOTOOLTIPS樣式。

## <a name="clistctrlsetview"></a><a name="setview"></a>CListCtrl::SetView

設置清單檢視控制件的檢視。

```
DWORD SetView(int iView);
```

### <a name="parameters"></a>參數

*iView*<br/>
要選擇的視圖。

### <a name="return-value"></a>傳回值

如果成功,則返回 1,否則返回 -1。 例如,如果檢視無效,則返回 -1。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SETVIEW](/windows/win32/Controls/lvm-setview)消息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsetworkareas"></a><a name="setworkareas"></a>CListCtrl::設定工作區域

設定圖示可以在清單檢視控制項中顯示的區域。

```
void SetWorkAreas(
    int nWorkAreas,
    LPRECT lpRect);
```

### <a name="parameters"></a>參數

*n工作領域*<br/>
`RECT` *lpRect*指向的陣列中的結構(或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件)的數量。

*lpRect*<br/>
指定清單檢視控制元件的新工作`RECT`區域的結構(`CRect`或物件)陣列的位址。 這些區域必須在用戶端座標中指定。 如果此參數為 NULL,則工作區將設置為控制項的工作區。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[ListView_SetWorkAreas](/windows/win32/api/commctrl/nf-commctrl-listview_setworkareas)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
    // Remove all working areas.
    m_myListCtrl.SetWorkAreas(0, NULL);
```

## <a name="clistctrlsortgroups"></a><a name="sortgroups"></a>CListCtrl::排序組

使用應用程式定義的比較函數按列表檢視控制項中的 ID 對組進行排序。

```
BOOL SortGroups(
    PFNLVGROUPCOMPARE _pfnGroupCompare,
    LPVOID _plv);
```

### <a name="parameters"></a>參數

*_pfnGroupCompare*<br/>
指向組比較函數的指標。

*_plv*<br/>
虛空指標。

### <a name="return-value"></a>傳回值

成功時返回 TRUE,在失敗時返回 FALSE。

### <a name="remarks"></a>備註

此成員函數類比[LVM_SORTGROUPS](/windows/win32/Controls/lvm-sortgroups)訊息的功能,如 Windows SDK 中所述。

## <a name="clistctrlsortitems"></a><a name="sortitems"></a>CListCtrl::排序專案

使用應用程式定義的比較函數對列表檢視項進行排序。

```
BOOL SortItems(
    PFNLVCOMPARE pfnCompare,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*普芬比較*<br/>
[在]應用程式定義的比較函數的位址。

每次需要確定兩個清單項的相對順序時,排序操作都會調用比較函數。 比較函數必須是類的靜態成員,或者不是任何類成員的獨立函數。

*dwData*<br/>
[在]傳遞給比較函數的應用程式定義值。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法更改每個項的索引以反映新序列。

比較函數*pfn 比較*具有以下形式:

```
int CALLBACK CompareFunc(LPARAM lParam1,
    LPARAM lParam2,
    LPARAM lParamSort);
```

如果第一個項應位於第二個項之前,則比較函數必須返回負值;如果第一個項應遵循第二個項,則返回正值;如果兩個項相等,則比較函數必須返回負值。

*lParam1*參數是與比較的第一個項關聯的 32 位值 *,lParam2*參數是與第二個項關聯的值。 這些是在專案[LVITEM](/windows/win32/api/commctrl/ns-commctrl-lvitemw)結構的*lParam*成員中指定的值,當這些值插入到清單中時。 *lParamSort*參數與*dwData*值相同。

此方法發送[LVM_SORTITEMS](/windows/win32/Controls/lvm-sortitems)訊息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

下面是一個簡單的比較函數,它會導致按其*lParam*值對項進行排序。

```cpp
// Sort items by associated lParam
int CALLBACK CListCtrlDlg::MyCompareProc(LPARAM lParam1, LPARAM lParam2,
    LPARAM lParamSort)
{
    UNREFERENCED_PARAMETER(lParamSort);
    return (int)(lParam1 - lParam2);
}
```

```cpp
// Sort the items by passing in the comparison function.
void CListCtrlDlg::Sort()
{
    m_myListCtrl.SortItems(&CListCtrlDlg::MyCompareProc, 0);
}
```

## <a name="clistctrlsortitemsex"></a><a name="sortitemsex"></a>CListCtrl::排序專案Ex

使用應用程式定義的比較函數對當前列表檢視控制項的項進行排序。

```
BOOL SortItemsEx(
    PFNLVCOMPARE pfnCompare,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*普芬比較*|[在]應用程式定義的比較函數的位址。<br /><br /> 每次需要確定兩個清單項的相對順序時,排序操作都會調用比較函數。 比較函數必須是類的靜態成員,或者不是任何類成員的獨立函數。|
|*dwData*|[在]應用程式定義的值傳遞給比較函數。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法更改每個項的索引以反映新序列。

比較函數*pfn 比較*具有以下形式:

```
int CALLBACK CompareFunc(LPARAM lParam1,
    LPARAM lParam2,
    LPARAM lParamSort);
```

此消息類似於[LVM_SORTITEMS,](/windows/win32/Controls/lvm-sortitems)但傳遞給比較函數的資訊類型除外。 在[LVM_SORTITEMS](/windows/win32/Controls/lvm-sortitems)*LVM_SORTITEMS,lParam1*和*lParam2*是要比較的項目的值。 在[LVM_SORTITEMSEX](/windows/win32/Controls/lvm-sortitemsex)中 *,lParam1*是比較的第一個專案的當前索引,*而lParam2*是第二個專案的當前索引。 您可以發送[LVM_GETITEMTEXT](/windows/win32/Controls/lvm-getitemtext)訊息來檢索有關項目的詳細資訊。

如果第一個項應位於第二個項之前,則比較函數必須返回負值;如果第一個項應遵循第二個項,則返回正值;如果兩個項相等,則比較函數必須返回負值。

> [!NOTE]
> 在排序過程中,清單視圖內容不穩定。 如果回調函數向清單檢視控制件發送[LVM_GETITEM以外的任何消息](/windows/win32/Controls/lvm-getitem),則結果不可預測。

此方法發送[LVM_SORTITEMSEX](/windows/win32/Controls/lvm-sortitemsex)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範`m_listCtrl`例定義用於存取目前列表檢視 控制項的變數 。 下一個範例中會使用此變數。

```cpp
public:
    // Variable used to access the list control.
    CListCtrl m_listCtrl;
```

### <a name="example"></a>範例

以下代碼範例展示該方法`SortItemEx`。 在此代碼示例的較早部分中,我們創建了一個列表視圖控件,該控件在報表視圖中顯示兩列標題為"ClientID"和"分級"。 以下代碼示例使用「坡度」欄中的值對表進行排序。

```cpp
// The ListCompareFunc() method is a global function used by SortItemEx().
int CALLBACK ListCompareFunc(
                             LPARAM lParam1,
                             LPARAM lParam2,
                             LPARAM lParamSort)
{
    CListCtrl* pListCtrl = (CListCtrl*) lParamSort;
    CString    strItem1 = pListCtrl->GetItemText(static_cast<int>(lParam1), 1);
    CString    strItem2 = pListCtrl->GetItemText(static_cast<int>(lParam2), 1)
    int x1 = _tstoi(strItem1.GetBuffer());
    int x2 = _tstoi(strItem2.GetBuffer());
    int result = 0;
    if ((x1 - x2) < 0)
        result = -1;
    else if ((x1 - x2) == 0)
        result = 0;
    else
        result = 1;

    return result;
}

void CCListCtrl_s2Dlg::OnBnClickedButton1()
{
    // SortItemsEx
    m_listCtrl.SortItemsEx( ListCompareFunc, (LPARAM)&m_listCtrl );
}
```

## <a name="clistctrlsubitemhittest"></a><a name="subitemhittest"></a>CListCtrl::子項目命中測試

確定哪個清單檢視項(如果有)位於給定位置。

```
int SubItemHitTest(LPLVHITTESTINFO pInfo);
```

### <a name="parameters"></a>參數

*pInfo*<br/>
指向[LVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-lvhittestinfo)結構的指標。

### <a name="return-value"></a>傳回值

正在測試的項或子項的基於一個索引(如果有),否則為 -1。

### <a name="remarks"></a>備註

此成員函數實現 Win32 宏[的行為,ListView_SubItemHitTest](/windows/win32/api/commctrl/nf-commctrl-listview_subitemhittest),如 Windows SDK 中所述。

### <a name="example"></a>範例

```cpp
void CListCtrlDlg::OnDblClk(NMHDR* pNMHDR, LRESULT* pResult)
{
    UNREFERENCED_PARAMETER(pResult);
    LPNMITEMACTIVATE pia = (LPNMITEMACTIVATE)pNMHDR;
    LVHITTESTINFO lvhti;

    // Clear the subitem text the user clicked on.
    lvhti.pt = pia->ptAction;
    m_myListCtrl.SubItemHitTest(&lvhti);

    if (lvhti.flags & LVHT_ONITEMLABEL)
    {
        m_myListCtrl.SetItemText(lvhti.iItem, lvhti.iSubItem, NULL);
    }
}
```

## <a name="clistctrlupdate"></a><a name="update"></a>CListCtrl::更新

強制清單檢視控制項重新繪製*nItem*指定的項目。

```
BOOL Update(int nItem);
```

### <a name="parameters"></a>參數

*nItem*<br/>
要更新的項的索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果清單檢視控制項具有LVS_AUTOARRANGE樣式,則此功能還會排列清單檢視控制項。

### <a name="example"></a>範例

請參考[CListCtrl 的範例:取得選擇計數](#getselectedcount)。

## <a name="see-also"></a>另請參閱

[MFC 樣品 ROWLIST](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](cwnd-class.md)<br/>
[階層架構圖表](../hierarchy-chart.md)<br/>
[CImageList 類別](cimagelist-class.md)
