---
title: CMDIFrameWndEx 類別
ms.date: 11/04/2016
f1_keywords:
- CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ActiveItemRecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AddPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustClientArea
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AdjustDockingLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::AreMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ControlBarToTabbedDocument
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateDocumentWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::CreateNewWindow
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::DockPaneLeftOf
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableAutoHidePanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableDocking
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMainMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableFullScreenMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableLoadDockState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabbedGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableMDITabsLastActiveActivation
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnablePaneMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::EnableWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetActivePopup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetDefaultResId
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabGroups
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabs
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMDITabsContextMenuAllowedItems
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetMenuBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetRibbonBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetTearOffBars
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::GetToolbarButtonToolTipText
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::InsertPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMDITabbedGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMemberOfMDITabGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsMenuBarAvailable
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPointNearDockSite
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::IsPrintPreview
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::LoadMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabMoveToNextGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::MDITabNewGroup
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::NegotiateBorderSpace
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseDockingPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCloseMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnClosePopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnCmdMsg
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuImage
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnDrawMenuLogo
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnEraseMDIClientBackground
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMenuButtonToolHitTest
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnMoveMiniFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSetPreviewMode
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowCustomizePane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowMDITabContextMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPanes
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnShowPopupMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnSizeMDIClient
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnTearOffMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::OnUpdateFrameMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::PaneFromPoint
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RecalcLayout
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::RemovePaneFromDockManager
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SaveMDIState
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetPrintPreviewFrame
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::SetupToolbarMenu
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowFullScreen
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowPane
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::ShowWindowsDialog
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::TabbedDocumentToControlBar
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateCaption
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::UpdateMDITabbedBarsIcons
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::WinHelp
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bCanCovertControlBarToMDIChild
- AFXMDIFRAMEWNDEX/CMDIFrameWndEx::m_bDisableSetRedraw
helpviewer_keywords:
- CMDIFrameWndEx [MFC], ActiveItemRecalcLayout
- CMDIFrameWndEx [MFC], AddPane
- CMDIFrameWndEx [MFC], AdjustClientArea
- CMDIFrameWndEx [MFC], AdjustDockingLayout
- CMDIFrameWndEx [MFC], AreMDITabs
- CMDIFrameWndEx [MFC], CanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], ControlBarToTabbedDocument
- CMDIFrameWndEx [MFC], CreateDocumentWindow
- CMDIFrameWndEx [MFC], CreateNewWindow
- CMDIFrameWndEx [MFC], DockPane
- CMDIFrameWndEx [MFC], DockPaneLeftOf
- CMDIFrameWndEx [MFC], EnableAutoHidePanes
- CMDIFrameWndEx [MFC], EnableDocking
- CMDIFrameWndEx [MFC], EnableFullScreenMainMenu
- CMDIFrameWndEx [MFC], EnableFullScreenMode
- CMDIFrameWndEx [MFC], EnableLoadDockState
- CMDIFrameWndEx [MFC], EnableMDITabbedGroups
- CMDIFrameWndEx [MFC], EnableMDITabs
- CMDIFrameWndEx [MFC], EnableMDITabsLastActiveActivation
- CMDIFrameWndEx [MFC], EnablePaneMenu
- CMDIFrameWndEx [MFC], EnableWindowsDialog
- CMDIFrameWndEx [MFC], GetActivePopup
- CMDIFrameWndEx [MFC], GetPane
- CMDIFrameWndEx [MFC], GetDefaultResId
- CMDIFrameWndEx [MFC], GetMDITabGroups
- CMDIFrameWndEx [MFC], GetMDITabs
- CMDIFrameWndEx [MFC], GetMDITabsContextMenuAllowedItems
- CMDIFrameWndEx [MFC], GetMenuBar
- CMDIFrameWndEx [MFC], GetRibbonBar
- CMDIFrameWndEx [MFC], GetTearOffBars
- CMDIFrameWndEx [MFC], GetToolbarButtonToolTipText
- CMDIFrameWndEx [MFC], InsertPane
- CMDIFrameWndEx [MFC], IsFullScreen
- CMDIFrameWndEx [MFC], IsMDITabbedGroup
- CMDIFrameWndEx [MFC], IsMemberOfMDITabGroup
- CMDIFrameWndEx [MFC], IsMenuBarAvailable
- CMDIFrameWndEx [MFC], IsPointNearDockSite
- CMDIFrameWndEx [MFC], IsPrintPreview
- CMDIFrameWndEx [MFC], LoadFrame
- CMDIFrameWndEx [MFC], LoadMDIState
- CMDIFrameWndEx [MFC], MDITabMoveToNextGroup
- CMDIFrameWndEx [MFC], MDITabNewGroup
- CMDIFrameWndEx [MFC], NegotiateBorderSpace
- CMDIFrameWndEx [MFC], OnCloseDockingPane
- CMDIFrameWndEx [MFC], OnCloseMiniFrame
- CMDIFrameWndEx [MFC], OnClosePopupMenu
- CMDIFrameWndEx [MFC], OnCmdMsg
- CMDIFrameWndEx [MFC], OnDrawMenuImage
- CMDIFrameWndEx [MFC], OnDrawMenuLogo
- CMDIFrameWndEx [MFC], OnEraseMDIClientBackground
- CMDIFrameWndEx [MFC], OnMenuButtonToolHitTest
- CMDIFrameWndEx [MFC], OnMoveMiniFrame
- CMDIFrameWndEx [MFC], OnSetPreviewMode
- CMDIFrameWndEx [MFC], OnShowCustomizePane
- CMDIFrameWndEx [MFC], OnShowMDITabContextMenu
- CMDIFrameWndEx [MFC], OnShowPanes
- CMDIFrameWndEx [MFC], OnShowPopupMenu
- CMDIFrameWndEx [MFC], OnSizeMDIClient
- CMDIFrameWndEx [MFC], OnTearOffMenu
- CMDIFrameWndEx [MFC], OnUpdateFrameMenu
- CMDIFrameWndEx [MFC], PaneFromPoint
- CMDIFrameWndEx [MFC], RecalcLayout
- CMDIFrameWndEx [MFC], RemovePaneFromDockManager
- CMDIFrameWndEx [MFC], SaveMDIState
- CMDIFrameWndEx [MFC], SetPrintPreviewFrame
- CMDIFrameWndEx [MFC], SetupToolbarMenu
- CMDIFrameWndEx [MFC], ShowFullScreen
- CMDIFrameWndEx [MFC], ShowPane
- CMDIFrameWndEx [MFC], ShowWindowsDialog
- CMDIFrameWndEx [MFC], TabbedDocumentToControlBar
- CMDIFrameWndEx [MFC], UpdateCaption
- CMDIFrameWndEx [MFC], UpdateMDITabbedBarsIcons
- CMDIFrameWndEx [MFC], WinHelp
- CMDIFrameWndEx [MFC], m_bCanCovertControlBarToMDIChild
- CMDIFrameWndEx [MFC], m_bDisableSetRedraw
ms.assetid: dbcafcb3-9a7a-4f11-9dfe-ba57565c81d0
ms.openlocfilehash: e5b571ee677dab447075abb632cc013c9cd58d44
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81370039"
---
# <a name="cmdiframewndex-class"></a>CMDIFrameWndEx 類別

擴展[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)的功能,Windows 多文檔介面 (MDI) 框架視窗。

## <a name="syntax"></a>語法

```
class CMDIFrameWndEx : public CMDIFrameWnd
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMDIFramewndEx::活動專案Recalc佈局](#activeitemrecalclayout)|重新計算活動項的佈局。|
|`CMDIFrameWndEx::AddDockSite`|沒有使用這個方法。|
|[CMDIFramewndEx::添加窗格](#addpane)|向停靠管理器註冊窗格。|
|[CMDIFramewndEx::調整客戶區域](#adjustclientarea)|減小工作區以允許邊框。|
|[CMDIFramewndEx::調整擴展佈局](#adjustdockinglayout)|重新計算所有停靠窗格的佈局。|
|[CMDIFramewndEx::AreMDITabs](#aremditabs)|確定是否啟用了 MDI 選項卡功能或 MDI 選項卡群組功能。|
|[CMDIframewndEx::可隱藏控制巴托迪兒童](#cancovertcontrolbartomdichild)|框架呼叫以確定框架視窗是否可以將停靠窗格轉換為選項卡式文件。|
|[CMDIFramewndEx::控制巴托塔貝德檔](#controlbartotabbeddocument)|將指定的停靠窗格轉換為選項卡式文檔。|
|[CMDIFramewndEx::建立文件視窗](#createdocumentwindow)|創建子文件視窗。|
|[CMDIFramewndEx::創建新視窗](#createnewwindow)|由框架調用以創建新視窗。|
|`CMDIFrameWndEx::CreateObject`|由建立此類別類型的動態執行個體架構所使用。|
|[CMDIFramewndEx::DockPane](#dockpane)|將指定的窗格停靠到框架視窗。|
|[CMDIframewndEx::D奧克帕內左側](#dockpaneleftof)|將窗格停駐在另一個窗格的左邊。|
|[CMDIFramewndEx:啟用自動隱藏窗格](#enableautohidepanes)|當窗格停靠在主框架視窗的指定邊時,為窗格啟用自動隱藏模式。|
|[CMDIFramewndEx::啟用對接](#enabledocking)|啟用屬於 MDI 框架視窗的窗格的停靠。|
|[CMDIFrameWndEx::EnableFullScreenMainMenu](#enablefullscreenmainmenu)|在全螢幕模式下顯示或隱藏主菜單。|
|[CMDIFrameWndEx::EnableFullScreenMode](#enablefullscreenmode)|為框架視窗啟用全屏模式。|
|[CMDIFrameWndEx::EnableLoadDockState](#enableloaddockstate)|啟用或禁用停靠狀態的載入。|
|[CMDIFramewndEx::啟用MDITabbed群組](#enablemditabbedgroups)|啟用或禁用 MDI 選項卡式群組功能。|
|[CMDIFramewndEx:啟用MDITabs](#enablemditabs)|啟用或禁用 MDI 選項卡功能。 啟用後,框架視窗將顯示每個 MDI 子視窗的選項卡。|
|[CMDIFramewndEx:啟用MDITabs上次啟動](#enablemditabslastactiveactivation)|指定在使用者關閉當前選項卡時是否應啟動最後一個活動選項卡。|
|[CMDIFramewndEx::啟用PaneMenu](#enablepanemenu)|啟用或禁用自動建立和管理彈出式窗格功能表,該功能表顯示應用程式窗格的清單。  .|
|[CMDIFramewndEx::啟用Windows對話](#enablewindowsdialog)|插入其命令 ID 調用[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)對話方塊的選單項。|
|[CMDIFramewndEx:獲取主動彈出](#getactivepopup)|將指標傳回到目前顯示的快顯功能表。|
|[CMDIFramewndEx::獲取窗格](#getpane)|返回指向具有指定控制項 ID 的窗格的指標。|
|[CMDIFramewndEx:取得預設 Resid](#getdefaultresid)|返回 MDI 框架視窗的分享資源的識別碼。|
|[CMDIFramewndEx:getMDITab組](#getmditabgroups)|傳回 MDI 選項卡式視窗的清單。|
|[CMDIFramewndEx:GetMDITabs](#getmditabs)|返回對帶下劃線選項卡視窗的引用。|
|[CMDIFramewndEx:取得MDITabs上下文選單允許專案](#getmditabscontextmenualloweditems)|返回一個標誌組合,確定啟用 MDI 選項卡式組功能時,哪些上下文菜單項有效。|
|[CMDIFramewndEx::獲取功能表欄](#getmenubar)|返回指向附加到框架視窗的功能表欄物件的指標。|
|[CMDIFrameWndEx::GetRibbonBar](#getribbonbar)|檢索框架的功能區條控制項。|
|[CMDIFramewndEx::獲取關閉條形](#gettearoffbars)|返回處於拆解狀態的[CPane](../../mfc/reference/cpane-class.md)派生物件的清單。|
|`CMDIFrameWndEx::GetThisClass`|由框架呼叫以獲取指向與此類類型關聯的[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)物件的指標。|
|[CMDIFrameWndEx::GetToolbarButtonToolTipText](#gettoolbarbuttontooltiptext)|當應用程式顯示工具列按鈕的工具提示時,由框架調用。|
|[CMDIFramewndEx::插入窗格](#insertpane)|向停靠管理器註冊指定的窗格。|
|[CMDIFrameWndEx::IsFullScreen](#isfullscreen)|確定框架視窗是否處於全屏模式。|
|[CMDIFramewndEx:IsMDITab貝德集團](#ismditabbedgroup)|確定是否啟用了 MDI 選項卡式組功能。|
|[CMDIframewndEx:是MDITab集團的成員](#ismemberofmditabgroup)|確定指定的選項卡式視窗是否位於 MDI 選項卡式組中的視窗清單中。|
|[CMDIFramewndEx::IsMenuBar可用](#ismenubaravailable)|確定框架視窗是否具有功能表列。|
|[CMDIFramewndEx::IsPointNearDockSite](#ispointneardocksite)|確定指定點是否靠近停靠網站。|
|[CMDIFrameWndEx::IsPrintPreview](#isprintpreview)|確定框架視窗是否處於列印預覽模式。|
|[CMDIFramewndEx::載入幀](#loadframe)|從資源資訊創建框架視窗。 (覆寫 `CMDIFrameWnd::LoadFrame`。)|
|[CMDIFramewndEx::載入MDIState](#loadmdistate)|載入 MDI 選項卡群組的指定佈局和以前打開的文件清單。|
|[CMDIFramewndEx::MDITabmoveToNextGroup](#mditabmovetonextgroup)|將活動選項卡從當前活動的選項卡式窗口移動到下一個或上一個選項卡式選項卡組。|
|[CMDIFramewndEx::MDITabNewGroup](#mditabnewgroup)|建立具有單個視窗的新選項卡式組。|
|[CMDIFramewndEx::談判邊界空間](#negotiateborderspace)|在 OLE 就地激活期間協商框架視窗中的邊框空間。|
|[CMDIFramewndEx::關閉對接窗格](#onclosedockingpane)|當用戶按下可停靠窗格上的 **「關閉**」按鈕時,由框架呼叫。|
|[CMDIFramewndEx::在關閉迷你框架上](#oncloseminiframe)|當用戶按下浮動迷你框架視窗中的 **「關閉**」按鈕時,由框架呼叫。|
|[CMDIFramewndEx::在關閉彈出功能表](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[CMDIFramewndEx::在CmdMsg上](#oncmdmsg)|由框架呼叫以路由和調度命令訊息並更新命令使用者介面物件。|
|[CMDIFramewndEx::在畫上功能表圖像](#ondrawmenuimage)|架構在繪製與功能表項目相關聯的映像時所呼叫。|
|[CMDIFramewndEx::在DrawMenulogo上](#ondrawmenulogo)|當[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)處理WM_PAINT消息時,由框架調用。|
|[CMDIFramewndEx::在EraseMDI用戶端背景上](#onerasemdiclientbackground)|當 MDI 幀視窗處理WM_ERASEBKGND消息時,由框架調用。|
|[CMDIFramewndEx::在MenuButton工具命中測試](#onmenubuttontoolhittest)|當[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理WM_NCHITTEST消息時,由框架調用。|
|[CMDIFramewndEx::移動迷你框架](#onmoveminiframe)|由框架調用以移動微型框架視窗。|
|[CMDIFramewndEx::打開預覽模式](#onsetpreviewmode)|設置應用程式的主框架視窗列印預覽模式。 (覆寫 [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。)|
|[CMDIFramewndEx::在顯示自定義窗格](#onshowcustomizepane)|啟動"快速自定義"窗格時,由框架調用。|
|[CMDIFramewndEx:上秀MDITab上下文菜單](#onshowmditabcontextmenu)|當上下文菜單應顯示在其中一個選項卡上時,由框架調用。 (僅適用於 MDI 選項卡式組。|
|[CMDIFramewndEx::在顯示窗格](#onshowpanes)|由框架呼叫以顯示或隱藏窗格。|
|[CMDIFramewndEx::在顯示彈出菜單](#onshowpopupmenu)|架構在啟動快顯功能表時所呼叫。|
|[CMDIFrameWndEx::OnSizeMDIClient](#onsizemdiclient)|當用戶端 MDI 視窗的大小發生變化時,由框架調用。|
|[CMDIFramewndEx::在TearoffMenu上](#ontearoffmenu)|架構在啟動有分割列的功能表時所呼叫。|
|[CMDIFramewndEx::更新框架功能表](#onupdateframemenu)|由框架調用以更新框架功能表。 (覆寫 `CMDIFrameWnd::OnUpdateFrameMenu`。)|
|[CMDIFramewndEx::P從點](#panefrompoint)|返回包含指定點的停靠窗格。|
|`CMDIFrameWndEx::PreTranslateMessage`|[CWinApp](../../mfc/reference/cwinapp-class.md) 類別用來轉譯分派至 [TranslateMessage](/windows/win32/api/winuser/nf-winuser-translatemessage) 和 [DispatchMessage](/windows/win32/api/winuser/nf-winuser-dispatchmessage) Windows 函式之前的視窗訊息。  (覆寫 `CMDIFrameWnd::PreTranslateMessage`。)|
|[CMDIFramewndEx:recalclayout](#recalclayout)|由框架調用以重新計算框架視窗的佈局。 (覆蓋[CFramewnd:recalclayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[CMDIFramewndEx::從Dock管理器中刪除Pane](#removepanefromdockmanager)|取消註冊窗格並從停靠管理器中刪除它。|
|[CMDIFramewndEx::保存MDIState](#savemdistate)|儲存 MDI 選項卡群組的當前佈局和以前打開的文件清單。|
|[CMDIFrameWndEx::SetPrintPreviewFrame](#setprintpreviewframe)|設置列印預覽框架視窗。|
|[CMDIFramewndEx::設定工具列選單](#setuptoolbarmenu)|藉由搜尋虛設項目並替換成指定的使用者定義項目，修改工具列物件。|
|[CMDIFrameWndEx::ShowFullScreen](#showfullscreen)|將主幀從常規模式切換到全屏模式。|
|[CMDIFramewndEx::顯示窗格](#showpane)|顯示或隱藏指定的窗格。|
|[CMDIFramewndEx::顯示視窗對話](#showwindowsdialog)|創建一個[CMFCWindowsManager對話框](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)並打開它。|
|[CMDIFramewndEx::Tabbed文檔到控制欄](#tabbeddocumenttocontrolbar)|將指定的選項卡式文件轉換為停靠窗格。|
|[CMDIFrameWndEx::UpdateCaption](#updatecaption)|由框架調用以更新視窗框架標題。|
|[CMDIFramewndEx::更新MDITab貝德巴圖示](#updatemditabbedbarsicons)|設置每個 MDI 選項卡式窗格的圖示。|
|[CMDIFramewndEx::贏説明](#winhelp)|架構所呼叫以起始 WinHelp 應用程式或內容說明。 (涵蓋[CWnd:winHelp](../../mfc/reference/cwnd-class.md#winhelp).)|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMDIFramewndEx::m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)|確定停靠窗格是否可以轉換為 MDI 子視窗。|
|[CMDIFramewndEx::m_bDisableSetRedraw](#m_bdisablesetredraw)|啟用或禁用 MDI 子視窗的重繪優化。|

## <a name="remarks"></a>備註

要利用 MDI 應用程式中的擴展自定義功能,`CMDIFrameWndEx`請`CMDIFrameWnd`從 而不是派生應用程式的 MDI 框架視窗類。

## <a name="example"></a>範例

下面的範例派生類別`CMDIFrameWndEx`。 此程式碼段來自[DrawClient 範例:基於 MFC 功能區的 OLE 物件繪圖應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_DrawClient#1](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_1.h)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)

[CMDIFrameWndEx](../../mfc/reference/cmdiframewndex-class.md)

## <a name="requirements"></a>需求

**標題:** afxMDIFrameWndEx.h

## <a name="cmdiframewndexactiveitemrecalclayout"></a><a name="activeitemrecalclayout"></a>CMDIFramewndEx::活動專案Recalc佈局

重新計算活動項的佈局。

```
void ActiveItemRecalcLayout();
```

## <a name="cmdiframewndexaddpane"></a><a name="addpane"></a>CMDIFramewndEx::添加窗格

向停靠管理器註冊窗格。

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail=TRUE);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]指向要註冊的窗格。

*b泰爾*<br/>
[在]指定是否將此窗格加入到清單的末尾。

### <a name="return-value"></a>傳回值

如果窗格已成功註冊,則返回非零值。 如果窗格已註冊到停靠管理器,則返回 0。

### <a name="remarks"></a>備註

每個窗格都必須註冊到[CDockingManager 類](../../mfc/reference/cdockingmanager-class.md),然後才能參與擴展佈局。 使用此方法可通知停靠管理器要停靠特定窗格。 註冊該窗格后,停靠管理器將根據其對齊設置和停靠管理器維護的窗格列表中的位置將其對齊。

## <a name="cmdiframewndexadjustclientarea"></a><a name="adjustclientarea"></a>CMDIFramewndEx::調整客戶區域

減小工作區以允許邊框。

```
virtual void AdjustClientArea();
```

## <a name="cmdiframewndexadjustdockinglayout"></a><a name="adjustdockinglayout"></a>CMDIFramewndEx::調整擴展佈局

重新計算所有停靠窗格的佈局。

```
virtual void AdjustDockingLayout(HDWP hdwp=NULL);
```

### <a name="parameters"></a>參數

*hdwp*<br/>
[在]標識多視窗位置結構。 您可以通過呼`BeginDeferWindowPos`叫 獲得此值。

### <a name="remarks"></a>備註

調用此成員函數以重新計算停靠到框架視窗的所有窗格的佈局。

## <a name="cmdiframewndexaremditabs"></a><a name="aremditabs"></a>CMDIFramewndEx::AreMDITabs

確定是否啟用了 MDI 選項卡功能或 MDI 選項卡群組功能。

```
BOOL AreMDITabs(int* pnMDITabsType=NULL) const;
```

### <a name="parameters"></a>參數

*pnMDITabs 類型*<br/>
[出]指向整數變數的指標,指示啟用了哪些要素:

- 0: 停用所有功能。

- 1: 啟用 MDI 選項卡。

- 2: 啟用 MDI 選項卡群組。

### <a name="return-value"></a>傳回值

如果啟用了 MDI 選項卡或 MDI 選項卡組,則傳回 TRUE。

如果未啟用上述功能,則返回 FALSE。

### <a name="remarks"></a>備註

使用此函數可確定是否為框架視窗啟用了 MDI 選項卡或 MDI 選項卡組。 使用[CMDIFrameWndEx:啟用MDITabs](#enablemditabs)以啟用或禁用 MDI 選項卡功能。

使用[CMDIFrameWndEx::啟用 MDI 標籤組](#enablemditabbedgroups)以啟用或禁用 MDI 選項卡式組功能。

## <a name="cmdiframewndexcancovertcontrolbartomdichild"></a><a name="cancovertcontrolbartomdichild"></a>CMDIframewndEx::可隱藏控制巴托迪兒童

框架呼叫以決定框架視窗是否可以將停靠窗格轉換為選項卡式文件

```
virtual BOOL CanCovertControlBarToMDIChild();
```

### <a name="return-value"></a>傳回值

如果框架視窗可以將停靠窗格轉換為選項卡式文檔,則返回 TRUE;否則返回 FALSE。

### <a name="remarks"></a>備註

在派生類中重寫此方法並返回 TRUE,以便將停靠窗格轉換為選項卡式文檔。 或者,您可以將[CMDIFrameWndEx:::m_bCanCovertControlBarToMDIChild](#m_bcancovertcontrolbartomdichild)設置為 TRUE。

## <a name="cmdiframewndexcontrolbartotabbeddocument"></a><a name="controlbartotabbeddocument"></a>CMDIFramewndEx::控制巴托塔貝德檔

將指定的停靠窗格轉換為選項卡式文檔。

```
virtual CMDIChildWndEx* ControlBarToTabbedDocument(CDockablePane* pBar);
```

### <a name="parameters"></a>參數

*pBar*<br/>
指向要轉換的停靠窗格的指標。

### <a name="return-value"></a>傳回值

返回指向包含停靠窗格的新 MDI 子視窗的指標。

### <a name="remarks"></a>備註

此方法將停靠窗格轉換為選項卡式文檔。 呼叫此方法時,框架將創建一個[CMDIChildWndEx 類](../../mfc/reference/cmdichildwndex-class.md)物件,從停靠管理器中刪除停靠窗格,並將停靠窗格添加到新的 MDI 子視窗。 MDI 子視窗調整停靠窗格的大小以覆寫整個工作區

## <a name="cmdiframewndexcreatedocumentwindow"></a><a name="createdocumentwindow"></a>CMDIFramewndEx::建立文件視窗

創建子文件視窗。

```
virtual CMDIChildWndEx* CreateDocumentWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>參數

*lpcszDoc 名稱*<br/>
[在]包含文件識別碼的文字字串。 通常,它是文檔檔的完整路徑。

*pObj*<br/>
[在]指向使用者定義物件的指標。 例如,開發人員可以創建描述文件的應用程式特定數據結構,並告訴如何在啟動時初始化文檔。

### <a name="return-value"></a>傳回值

`CMDIChildWndEx` 的指標。

### <a name="remarks"></a>備註

當框架載入以前保存在註冊表中的文件清單時,它將調用此方法。

重寫此方法,以便在從註冊表載入文檔時創建文檔。

### <a name="example"></a>範例

下面的範例顯示如何在`CreateDocumentWindow` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

在此範例中,`g_strStartViewName`可以是實際上不是從磁碟檔載入的「虛擬文檔」(例如「起始頁」)的名稱。 因此,我們需要特殊處理來處理這種情況。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexcreatenewwindow"></a><a name="createnewwindow"></a>CMDIFramewndEx::創建新視窗

由框架調用以創建新視窗。

```
virtual CMDIChildWndEx* CreateNewWindow(
    LPCTSTR lpcszDocName,
    CObject* pObj);
```

### <a name="parameters"></a>參數

*lpcszDoc 名稱*<br/>
[在]文檔名稱。

*pObj*<br/>
[在]保留以供將來使用。

### <a name="return-value"></a>傳回值

指向新視窗的指標。

## <a name="cmdiframewndexdockpane"></a><a name="dockpane"></a>CMDIFramewndEx::DockPane

將指定的窗格停靠到框架視窗。

```
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID=0,
    LPCRECT lpRect=NULL);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要停靠的窗格的指標。

*nDockBarID*<br/>
[在]指定要停靠的幀視窗的哪一側。

*lpRect*<br/>
[在]未使用。

### <a name="remarks"></a>備註

此方法將指定的窗格停靠到框架視窗的一側,該邊是在[CBasePane::啟用停靠](../../mfc/reference/cbasepane-class.md#enabledocking)和[CMDIFrameWndEx::啟用停靠](#enabledocking)時指定的。

### <a name="example"></a>範例

下列範例示範 `DockPane` 方法的用法。 此程式碼段來自[VisualStudioDemo 範例:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#4](../../mfc/codesnippet/cpp/cmdiframewndex-class_3.cpp)]

## <a name="cmdiframewndexdockpaneleftof"></a><a name="dockpaneleftof"></a>CMDIframewndEx::D奧克帕內左側

將窗格停駐在另一個窗格的左邊。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向停靠窗格的指標。

*左撇子*<br/>
[在]指向用作停靠網站的窗格的指標。 .

### <a name="return-value"></a>傳回值

如果操作成功,則返回 TRUE。 否則傳回 FALSE。

### <a name="remarks"></a>備註

調用此方法以預定義的順序停靠多個窗格物件。 此方法將*pBar*指定的窗格停靠到*pLeftOf*指定的窗格的左側。

### <a name="example"></a>範例

下面的範例顯示了如何在`DockPaneLeftOf`[VisualStudioDemo 示例:MFC 可視化工作室應用程式中](../../overview/visual-cpp-samples.md)使用該方法。

[!code-cpp[NVC_MFC_VisualStudioDemo#5](../../mfc/codesnippet/cpp/cmdiframewndex-class_4.cpp)]

## <a name="cmdiframewndexenableautohidepanes"></a><a name="enableautohidepanes"></a>CMDIFramewndEx:啟用自動隱藏窗格

當窗格停靠在主框架視窗的指定邊時,為窗格啟用自動隱藏模式。

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDock 風格*<br/>
[在]指定將啟用的主框架視窗的兩側。 使用以下一個或多個標誌。

- CBRS_ALIGN_LEFT

- CBRS_ALIGN_RIGHT

- CBRS_ALIGN_TOP

- CBRS_ALIGN_BOTTOM

### <a name="return-value"></a>傳回值

呼叫此函數,以便在窗格停靠在主框架視窗的指定邊時啟用自動隱藏模式。

### <a name="example"></a>範例

下面的範例顯示了如何在`EnableAutoHidePanes`[VisualStudioDemo 示例:MFC 可視化工作室應用程式中](../../overview/visual-cpp-samples.md)使用該方法。

[!code-cpp[NVC_MFC_VisualStudioDemo#6](../../mfc/codesnippet/cpp/cmdiframewndex-class_5.cpp)]

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenabledocking"></a><a name="enabledocking"></a>CMDIFramewndEx::啟用對接

啟用屬於 MDI 框架視窗的窗格的停靠。

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

*dwDock 風格*<br/>
[在]指定要應用的停靠樣式。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

呼叫此函數以啟用屬於物件的窗格的`CMDIFrameWndEx`停靠。

### <a name="example"></a>範例

下面的範例顯示了如何在`EnableDocking`[VisualStudioDemo 示例:MFC 可視化工作室應用程式中](../../overview/visual-cpp-samples.md)使用該方法。

[!code-cpp[NVC_MFC_VisualStudioDemo#7](../../mfc/codesnippet/cpp/cmdiframewndex-class_6.cpp)]

## <a name="cmdiframewndexenablefullscreenmainmenu"></a><a name="enablefullscreenmainmenu"></a>CMDIFramewndEx:啟用全屏主功能表

在全螢幕模式下顯示或隱藏主菜單。

```
void EnableFullScreenMainMenu(BOOL bEnableMenu);
```

### <a name="parameters"></a>參數

*b啟用選單*<br/>
[在]TRUE 以全螢幕模式顯示主選單,或 FALSE 以隱藏主選單。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenablefullscreenmode"></a><a name="enablefullscreenmode"></a>CMDIFramewndEx::啟用全屏模式

為框架視窗啟用全屏模式。

```
void EnableFullScreenMode(UINT uiFullScreenCmd);
```

### <a name="parameters"></a>參數

*ui 全螢幕Cmd*<br/>
[在]啟用或停用全螢幕模式的命令的 ID。

### <a name="remarks"></a>備註

在全螢幕模式下,所有停靠控制欄、工具列和功能表都隱藏,活動視圖將調整大小以佔據全屏。啟用全螢幕模式時,必須指定啟用或禁用該命令的命令的 ID。 可以從主框架`EnableFullScreenMode`的功能`OnCreate`調用。 當框架視窗切換到全屏模式時,框架將創建一個浮動工具列,其中一個按鈕具有指定的命令 ID。如果要將主選單保留在螢幕上,請致電[CMDIFrameWndEx::啟用全螢幕主選單](#enablefullscreenmainmenu)。

## <a name="cmdiframewndexenableloaddockstate"></a><a name="enableloaddockstate"></a>CMDIFramewndEx::啟用LoadDockState

啟用或禁用停靠狀態的載入。

```
void EnableLoadDockState(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 要啟用停靠狀態的載入,FALSE 將禁用停靠狀態的載入。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexenablemditabbedgroups"></a><a name="enablemditabbedgroups"></a>CMDIFramewndEx::啟用MDITabbed群組

啟用或關閉框架視窗的 MDI 選項卡式群組功能。

```
void EnableMDITabbedGroups(
    BOOL bEnable,
    const CMDITabInfo& params);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]如果為 TRUE,則啟用 MDI 選項卡式群組功能;如果為 TRUE,則啟用 MDI 選項卡式組功能。如果 FALSE,則禁用 MDI 選項卡式組功能。

*params*<br/>
[在]指定框架應用於在 MDI 工作區中建立的子視窗的參數。

### <a name="remarks"></a>備註

使用此方法可啟用或禁用 MDI 選項卡式群組功能。 此功能使 MDI 應用程式能夠將子視窗顯示為在 MDI 工作區內垂直或水平對齊的選項卡式視窗。 索引視窗會以分隔器分隔。 用戶可以使用分割器調整選項卡式組的大小。

- 使用者可以:

- 在組之間拖動單個選項卡。

- 將各個選項卡拖動到視窗邊緣以創建新組。

- 使用快捷選單移動選項卡或創建新組。

- 應用程式可以儲存選項卡式視窗的當前佈局和當前打開的文檔清單。

如果將此方法稱為*bEnable 設定為*FALSE,則*會忽略參數*。

即使已啟用 MDI 選項卡式組,您也可以再次呼叫此方法以修改子視窗的設定。 將*bEnable*設定為 TRUE 的方法呼叫該`CMDITabInfo`方法,並修改*參數*參數指定的物件成員。

有關如何使用 MDI 選項卡式群組的詳細資訊,請參閱[MDI 選項卡式群組](../../mfc/mdi-tabbed-groups.md)。

### <a name="example"></a>範例

下面的範例顯示如何在`EnableMDITabbedGroups` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#8](../../mfc/codesnippet/cpp/cmdiframewndex-class_7.cpp)]

## <a name="cmdiframewndexenablemditabs"></a><a name="enablemditabs"></a>CMDIFramewndEx:啟用MDITabs

啟用或關閉 MDI 框架視窗的 MDI 選項卡功能。 啟用後,框架視窗將顯示每個 MDI 子視窗的選項卡。

```
void EnableMDITabs(
    BOOL bEnable=TRUE,
    BOOL bIcons=TRUE,
    CMFCTabCtrl::Location tabLocation=CMFCTabCtrl::LOCATION_BOTTOM,
    BOOL bTabCloseButton=FALSE,
    CMFCTabCtrl::Style style=CMFCTabCtrl::STYLE_3D_SCROLLED,
    BOOL bTabCustomTooltips=FALSE,
    BOOL bActiveTabCloseButton=FALSE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
指定是否啟用了選項卡。

*b圖示*<br/>
指定是否應在選項卡上顯示圖示。

*選項卡位置*<br/>
指定選項卡標籤的位置。

*bTab 關閉按鈕*<br/>
指定是否顯示選項卡關閉按鈕。

*風格*<br/>
指定選項卡的樣式。 對常規選項卡或 STYLE_3D_ONENOTE對 Microsoft OneNote 選項卡使用STYLE_3D_SCROLLED。

*bTab 自訂工具提示*<br/>
指定是否啟用了自訂工具提示。

*使用這個作用分頁關閉按鈕*<br/>
如果為 TRUE,則「**關閉**」按鈕將顯示在活動選項卡上,而不是選項卡區域的右角。

### <a name="remarks"></a>備註

呼叫此方法以啟用或禁用 MDI 框架視窗的 MDI 選項卡功能。 啟用後,所有子視窗都顯示為選項卡。

選項卡標籤可以位於框架的頂部或底部,具體取決於參數*選項卡"位置"* 的設置。 您可以指定`CMFCTabCtrl::LOCATION_BOTTOM`(預設設定)`CMFCTabCtrl::LOCATION_TOP`或 。

如果*bTabCustomTool 提示*為 TRUE,則會向主框架視窗發送AFX_WM_ON_GET_TAB_TOOLTIP消息。 您的代碼可以處理此消息,並為框架提供 MDI 選項卡的自定義工具提示。

### <a name="example"></a>範例

下面的範例顯示如何在`EnableMDITabs` [MDITabsDemo 範例中使用:MFC 選項卡式 MDI 應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_MDITabsDemo#3](../../mfc/reference/codesnippet/cpp/cmdiframewndex-class_8.cpp)]

## <a name="cmdiframewndexenablemditabslastactiveactivation"></a><a name="enablemditabslastactiveactivation"></a>CMDIFramewndEx:啟用MDITabs上次啟動

指定在使用者關閉當前選項卡時是否應打開最後一個活動選項卡。

```
void EnableMDITabsLastActiveActivation(BOOL bLastActiveTab=TRUE);
```

### <a name="parameters"></a>參數

*bLastActiveTab*<br/>
[在]如果為 TRUE,則啟用啟動最後一個活動選項卡。如果 FALSE,則禁用最後一個活動選項卡的啟動。

### <a name="remarks"></a>備註

關閉作用選項卡時,有兩種方法可以開啟選項卡:

- 啟動下一個選項卡。

- 啟動以前處於活動狀態的選項卡。

預設實現使用第一種方式。

用於`EnableMDITabsLastActiveActivation`啟用第二種選項卡啟動方式。 它類比 Windows 打開 MDI 子視窗的方式。

## <a name="cmdiframewndexenablepanemenu"></a><a name="enablepanemenu"></a>CMDIFramewndEx::啟用PaneMenu

啟用或禁用自動建立和管理彈出式窗格功能表,該功能表顯示應用程式窗格的清單。

```
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly=FALSE,
    BOOL bViewMenuShowsToolbarsOnly=FALSE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]如果為 TRUE,則啟用窗格功能表的自動處理;如果為 TRUE,則啟用窗格功能表的自動處理。如果 FALSE,則禁用自動處理。

*ui 客製化Cmd*<br/>
[在]**「自訂」** 選單項的命令 ID。 此選單項目通常加入窗格清單的末尾。

*str定製標籤*<br/>
[在]要為 **「自訂」** 選單項(用於本地化)顯示的文本。

*uiView 工具列選單入口ID*<br/>
[在]指定開啟窗格選單的工具列選單項的 ID。 通常這是 **「視圖」** 選單的**工具列**子功能表。

*bContextMenu 只顯示工具列*<br/>
[在]如果為 TRUE,窗格功能表僅顯示工具列清單。 如果 FALSE,功能表將顯示工具列和停靠條的清單。

*b 只檢視選單顯示工具列*<br/>
[在]如果為 TRUE,窗格功能表僅顯示工具列清單。 如果 FALSE,功能表將顯示工具列和停靠條的清單。

### <a name="remarks"></a>備註

彈出窗格選單顯示應用程式窗格的清單,並允許使用者顯示或隱藏單個窗格。

### <a name="example"></a>範例

下面的範例顯示如何在`EnablePaneMenu` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#9](../../mfc/codesnippet/cpp/cmdiframewndex-class_9.cpp)]

## <a name="cmdiframewndexenablewindowsdialog"></a><a name="enablewindowsdialog"></a>CMDIFramewndEx::啟用Windows對話

插入其命令 ID 調用[CMFCWindowsManagerDialog](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)對話方塊的選單項。

```
void EnableWindowsDialog(
    UINT uiMenuId,
    LPCTSTR lpszMenuText,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);

void EnableWindowsDialog(
    UINT uiMenuId,
    UINT uiMenuTextResId,
    BOOL bShowAllways=FALSE,
    BOOL bShowHelpButton=FALSE);
```

### <a name="parameters"></a>參數

*烏伊梅奈*<br/>
[在]指定選單的資源識別碼。

*lpszMenuText*<br/>
[在]指定項目的文字。

*B 顯示說明按鈕*<br/>
[在]指定是否在視窗管理對話框上顯示 **「説明**」 按鈕。

*uiMenuTextResId*<br/>
[在]包含項目字串的字串資源識別碼。

### <a name="remarks"></a>備註

使用此方法插入其指令調用 MDI 子視窗管理對話框[(CMFCWindows ManagerDialog 類](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)) 的選單項。 新專案將插入到*uiMenuId*指定的選單中。 處理`EnableWindowsDialog`WM_CREATE消息時調用。

### <a name="example"></a>範例

下面的範例顯示如何在`EnableWindowsDialog` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#10](../../mfc/codesnippet/cpp/cmdiframewndex-class_10.cpp)]

## <a name="cmdiframewndexgetactivepopup"></a><a name="getactivepopup"></a>CMDIFramewndEx:獲取主動彈出

將指標傳回到目前顯示的快顯功能表。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>傳回值

指向活動彈出功能表的指標;如果沒有彈出視窗功能表處於活動狀態,則為 NULL。

### <a name="remarks"></a>備註

使用此函數可以獲取指向當前顯示的[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標。

## <a name="cmdiframewndexgetdefaultresid"></a><a name="getdefaultresid"></a>CMDIFramewndEx:取得預設 Resid

返回 MDI 框架視窗的分享資源的識別碼。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>傳回值

資源識別碼值。 如果框架視窗沒有功能表欄,則為 0。

### <a name="remarks"></a>備註

此方法傳回 CFramewnd 載入 MDI 畫面視窗時指定的資源[ID::LoadFrame](../../mfc/reference/cframewnd-class.md#loadframe)。

## <a name="cmdiframewndexgetmditabgroups"></a><a name="getmditabgroups"></a>CMDIFramewndEx:getMDITab組

傳回 MDI 選項卡式視窗的清單。

```
const CObList& GetMDITabGroups() const;
```

### <a name="return-value"></a>傳回值

對包含選項卡式視窗清單的[CObList 類](../../mfc/reference/coblist-class.md)物件的引用。 不要存儲或修改清單。

### <a name="remarks"></a>備註

使用此方法可以訪問選項卡式視窗的清單。 如果要更改或查詢各個選項卡式視窗的某些參數,則可能會有所説明。

## <a name="cmdiframewndexgetmditabs"></a><a name="getmditabs"></a>CMDIFramewndEx:GetMDITabs

返回對帶下劃線選項卡視窗的引用。

```
CMFCTabCtrl& GetMDITabs();
```

### <a name="return-value"></a>傳回值

對帶下劃線選項卡視窗的引用。

## <a name="cmdiframewndexgetmditabscontextmenualloweditems"></a><a name="getmditabscontextmenualloweditems"></a>CMDIFramewndEx:取得MDITabs上下文選單允許專案

返回一個標誌組合,確定啟用 MDI 選項卡式組功能時哪些操作有效。

```
DWORD GetMDITabsContextMenuAllowedItems();
```

### <a name="return-value"></a>傳回值

以下旗標的位-OR 組合:

- BCGP_MDI_CREATE_VERT_GROUP - 可以創建垂直選項卡組。

- BCGP_MDI_CREATE_HORZ_GROUP - 可以創建水平選項卡組。

- BCGP_MDI_CAN_MOVE_PREV - 可以將選項卡移動到上一個選項卡組。

- BCGP_MDI_CAN_MOVE_NEXT - 可以將選項卡移動到下一個選項卡組。

### <a name="remarks"></a>備註

啟用 MDI 選項卡群組功能後,必須知道特定視窗的選項卡上允許執行哪些操作。 此方法分析選項卡式視窗的當前佈局,並返回可用於生成快捷功能表的標誌組合。

當所有選項卡式視窗垂直對齊或只有一個選項卡式視窗時,可以創建新的垂直選項卡組。

當所有選項卡式視窗水平對齊時,或者只有一個選項卡式視窗時,可以創建新的水平選項卡組。

僅當選項卡式視窗中有多個選項卡時,才能將選項卡移動到前一個組。

僅當選項卡式視窗中有多個選項卡時,才能將選項卡移動到下一個組。

## <a name="cmdiframewndexgetmenubar"></a><a name="getmenubar"></a>CMDIFramewndEx::獲取功能表欄

返回指向附加到框架視窗的功能表欄物件的指標。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

指向功能表欄物件的指標。

## <a name="cmdiframewndexgetpane"></a><a name="getpane"></a>CMDIFramewndEx::獲取窗格

返回指向具有指定控制項 ID 的窗格的指標。

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]控件識別碼。

### <a name="return-value"></a>傳回值

指向具有指定控制項 ID 的窗格的指標(如果存在)。 否則為 NULL。

## <a name="cmdiframewndexgetribbonbar"></a><a name="getribbonbar"></a>CMDIFramewndEx:獲取帶狀欄

檢索框架的功能區條控制項。

```
CMFCRibbonBar* GetRibbonBar();
```

### <a name="return-value"></a>傳回值

指向框架的[CMFCRibbonBar 類別](../../mfc/reference/cmfcribbonbar-class.md)。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexgettearoffbars"></a><a name="gettearoffbars"></a>CMDIFramewndEx::獲取關閉條形

返回撕下功能表的清單。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>傳回值

對[CObList 類](../../mfc/reference/coblist-class.md)物件的引用,該`CPane`物件包含指向 處於分淚狀態的派生物件的指標集合。

### <a name="remarks"></a>備註

`CMDIFrameWndEx`維護撕掉功能表的集合。 使用此方法檢索對此清單的引用。

## <a name="cmdiframewndexgettoolbarbuttontooltiptext"></a><a name="gettoolbarbuttontooltiptext"></a>CMDIFramewndEx::取得工具列按鈕工具提示文字

當應用程式顯示工具列按鈕的工具提示時,由框架調用。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列按鈕的指標。

*斯特特文字*<br/>
[在]要顯示按鈕的工具提示文本。

### <a name="return-value"></a>傳回值

如果已顯示工具提示,則為 TRUE。 否則為 FALSE。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexinsertpane"></a><a name="insertpane"></a>CMDIFramewndEx::插入窗格

向停靠管理器註冊指定的窗格。

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter=TRUE);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]指向要插入的窗格的指標。

*p 目標*<br/>
[在]指向窗格之前或之後插入窗格的指標。

*b 後*<br/>
[在]如果為 TRUE,則*pControlBar*在*pTarget*後插入。 如果 FALSE,則在*pTarget*之前插入*pControlBar。*

### <a name="return-value"></a>傳回值

如果該方法成功註冊窗格,則為 TRUE,如果窗格已註冊到停靠管理器,則 FALSE。

### <a name="remarks"></a>備註

使用此方法可以告訴停靠管理器*pControlBar*指定的窗格。 停靠管理器將根據窗格的對齊方式和停靠管理器內部清單中的位置對齊此窗格。

## <a name="cmdiframewndexisfullscreen"></a><a name="isfullscreen"></a>CMDIFramewndEx:是全屏

確定框架視窗是否處於全屏模式。

```
BOOL IsFullScreen() const;
```

### <a name="return-value"></a>傳回值

如果幀視窗處於全屏模式,則為 TRUE;如果幀視窗處於全屏模式,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

您可以通過調用[CMDIFrameWndEx::啟用全屏模式](#enablefullscreenmode)方法來設置全屏模式。

## <a name="cmdiframewndexismditabbedgroup"></a><a name="ismditabbedgroup"></a>CMDIFramewndEx:IsMDITab貝德集團

指定是否啟用 MDI 選項卡式群組功能。

```
BOOL IsMDITabbedGroup() const;
```

### <a name="return-value"></a>傳回值

如果啟用了 MDI 選項卡式組功能,則為 TRUE;如果啟用了 MDI 選項卡式組功能,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

要確定是否啟用一般 MDI 選項卡或 MDI 選項卡群組功能,請使用[CMDIFrameWndEx::areMDITabs](#aremditabs)。

## <a name="cmdiframewndexismemberofmditabgroup"></a><a name="ismemberofmditabgroup"></a>CMDIframewndEx:是MDITab集團的成員

確定指定的選項卡式視窗是否位於 MDI 選項卡式組中的視窗清單中。

```
BOOL IsMemberOfMDITabGroup(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向選項卡式視窗的指標。

### <a name="return-value"></a>傳回值

如果指定的選項卡式視窗位於構成 MDI 選項卡式組的選項卡式視窗清單中,則為 TRUE。 否則,FALSE。

## <a name="cmdiframewndexismenubaravailable"></a><a name="ismenubaravailable"></a>CMDIFramewndEx::IsMenuBar可用

確定框架視窗是否具有功能表列。

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>傳回值

如果指向功能表欄物件的指標不是 NULL,則為 TRUE;如果指向選單欄物件的指標為 NULL,則為 TRUE。否則 FALSE。

## <a name="cmdiframewndexispointneardocksite"></a><a name="ispointneardocksite"></a>CMDIFramewndEx::IsPointNearDockSite

確定指定點是否靠近停靠網站。

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]螢幕座標中的指定點。

*dwBaralignment*<br/>
[在]指定點附近的邊。 可能的值是CBRS_ALIGN_LEFT、CBRS_ALIGN_RIGHT、CBRS_ALIGN_TOP 和CBRS_ALIGN_BOTTOM

*bouterEdge*<br/>
[在]如果點靠近停靠網站的外部邊界,則為 TRUE;否則。

### <a name="return-value"></a>傳回值

如果點靠近停靠網站,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當點位於停靠管理器中設置的靈敏度內時,該點位於停靠網站附近。 默認靈敏度為 15 圖元。

## <a name="cmdiframewndexisprintpreview"></a><a name="isprintpreview"></a>CMDIFramewndEx::是列印預覽

確定框架視窗是否處於列印預覽模式。

```
BOOL IsPrintPreview();
```

### <a name="return-value"></a>傳回值

如果幀視窗處於列印預覽模式,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexloadframe"></a><a name="loadframe"></a>CMDIFramewndEx::載入幀

從資源資訊創建框架視窗。

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

*nID資源*<br/>
[在]與框架視窗關聯的共享資源的 ID。

*dwDefault 樣式*<br/>
[在]框架視窗的樣式。

*pparentwnd*<br/>
[在]指向幀父級的指標。

*pContext*<br/>
[在]指向[CCreateContext 結構](../../mfc/reference/ccreatecontext-structure.md)的指標。 此參數可以是 NULL。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE,否則為 FALSE。

## <a name="cmdiframewndexloadmdistate"></a><a name="loadmdistate"></a>CMDIFramewndEx::載入MDIState

載入 MDI 選項卡群組的指定佈局和以前打開的文件清單。

```
virtual BOOL LoadMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定設定檔名稱。

### <a name="return-value"></a>傳回值

如果負載成功,則為 TRUE;如果負載失敗或沒有要載入的數據,則 FALSE。

### <a name="remarks"></a>備註

要載入或儲存 MDI 選項卡和群組的狀態以及開啟的文件清單,執行以下操作:

- 呼叫[CMDIFrameWndEx::](#savemdistate)在主框架關閉時儲存MDIState

- 呼叫[CMDIFrameWndEx::建立主幀時載入MDIState。](#loadmdistate) 此調用的建議位置是首次在主幀顯示之前。 在`CWinAppEx::EnableLoadWindowPlacement``(FALSE);`調`pMainFrame->LoadFrame (IDR_MAINFRAME);.`用`CBCGPWorkspace::ReloadWindowPlacement``(pMainFrame);`后`LoadMDIState`添加以 在註冊表中存儲的位置顯示主幀。

- 如果`GetDocumentName`應用程式顯示`CMDIChildWndEx`的文檔未存儲為檔,則在派生類中覆蓋。 傳回的字串將作為文件標識符保存在註冊表中。 [CMDIChildWndEx 的基本實現:取得文件名稱](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)傳回從[CDocument 取得的值::取得PathName](../../mfc/reference/cdocument-class.md#getpathname)。

- 覆蓋[CMDIFrameWndEx:創建文檔視窗](#createdocumentwindow),以在從註冊表載入文檔時正確創建文檔。 第一個參數是返回的`GetDocumentName`字串。

### <a name="example"></a>範例

下面的範例顯示如何在`LoadMDIState` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#11](../../mfc/codesnippet/cpp/cmdiframewndex-class_11.cpp)]

## <a name="cmdiframewndexmditabmovetonextgroup"></a><a name="mditabmovetonextgroup"></a>CMDIFramewndEx::MDITabmoveToNextGroup

將活動選項卡從當前活動的選項卡式窗口移動到下一個或上一個選項卡式選項卡組。

```
void MDITabMoveToNextGroup(BOOL bNext=TRUE);
```

### <a name="parameters"></a>參數

*b 下一個*<br/>
[在]如果為 TRUE,則將選項卡移動到下一個選項卡式組。 如果 FALSE,則將其移動到以前的選項卡式組。

## <a name="cmdiframewndexmditabnewgroup"></a><a name="mditabnewgroup"></a>CMDIFramewndEx::MDITabNewGroup

建立具有單個視窗的新選項卡式組。

```
void MDITabNewGroup(BOOL bVert=TRUE);
```

### <a name="parameters"></a>參數

*bVert*<br/>
[在]指定新的組對齊方式。 如果為 TRUE,則新組垂直對齊。 如果 FALSE,則新組水準對齊。

### <a name="remarks"></a>備註

使用此函數可以創建新的選項卡式視窗(新的選項卡式組),並將第一個選項卡添加到該視窗。

### <a name="example"></a>範例

下面的範例顯示如何在`MDITabNewGroup` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#12](../../mfc/codesnippet/cpp/cmdiframewndex-class_12.cpp)]

## <a name="cmdiframewndexm_bcancovertcontrolbartomdichild"></a><a name="m_bcancovertcontrolbartomdichild"></a>CMDIFramewndEx::m_bCanCovertControlBarToMDIChild

指定停靠窗格是否可以轉換為 MDI 子視窗。

```
BOOL m_bCanCovertControlBarToMDIChild;
```

### <a name="remarks"></a>備註

指示停靠控制條是否可以轉換為 MDI 子視窗。 如果此標誌為 TRUE,則當使用者選擇 **「選項卡式文檔」** 命令時,框架將自動處理轉換。 標誌受到保護,您必須通過在`m_bCanCovertControlBarToMDIChild``CMDIFrameWndEx`派生類的構造函數中設置或重寫`CanConvertControlBarToMDIChild`來顯式啟用此選項。

預設值是 `FALSE`。

### <a name="example"></a>範例

下面的範例顯示如何在`m_bCanCovertControlBarToMDIChild` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#13](../../mfc/codesnippet/cpp/cmdiframewndex-class_2.cpp)]

## <a name="cmdiframewndexm_bdisablesetredraw"></a><a name="m_bdisablesetredraw"></a>CMDIFramewndEx::m_bDisableSetRedraw

啟用或禁用 MDI 子視窗的重繪優化。

```
AFX_IMPORT_DATA static BOOL m_bDisableSetRedraw;
```

### <a name="remarks"></a>備註

預設值為 TRUE。

如果要優化 MDI 子級的重新繪製,將此標誌設置為 FALSE。 在這種情況下,當應用程式更改活動選項卡`SetRedraw (FALSE)`時,框架將調用主框架。

此標誌可能會導致不需要的效果(例如,變得可見的後台應用程式)。 因此,我們建議您僅在 MDI 選項卡激活期間遇到明顯的閃爍時才更改預設值。

## <a name="cmdiframewndexnegotiateborderspace"></a><a name="negotiateborderspace"></a>CMDIFramewndEx::談判邊界空間

在 OLE 就地激活期間協商框架視窗中的邊框空間。

```
virtual BOOL NegotiateBorderSpace(
    UINT nBorderCmd,
    LPRECT lpRectBorder);
```

### <a name="parameters"></a>參數

*nBorderCmd*<br/>
[在]包含枚舉`CFrameWnd::BorderCmd`中的以下值之一:

- `borderGet` = 1

- `borderRequest` = 2

- `borderSet` = 3

*lprect邊框*<br/>
[進出]指向[RECT 結構](/windows/win32/api/windef/ns-windef-rect)或指定邊框座標的[CRect 類](../../atl-mfc-shared/reference/crect-class.md)物件的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則非零;否則 0。

### <a name="remarks"></a>備註

該方法是OLE邊界空間談判的實現。

## <a name="cmdiframewndexonclosedockingpane"></a><a name="onclosedockingpane"></a>CMDIFramewndEx::關閉對接窗格

當用戶按下可停靠窗格上的 **「關閉**」按鈕時,由框架呼叫。

```
virtual BOOL OnCloseDockingPane(CDockablePane* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向正在關閉的窗格的指標。

### <a name="return-value"></a>傳回值

如果可以關閉停靠窗格,則為 TRUE。 否則，FALSE。

### <a name="remarks"></a>備註

重寫此方法以處理停靠窗格的隱藏。 如果要防止隱藏停靠窗格,則返回 FALSE。

預設實現不執行任何操作,並返回 TRUE。

## <a name="cmdiframewndexoncloseminiframe"></a><a name="oncloseminiframe"></a>CMDIFramewndEx::在關閉迷你框架上

當用戶按下浮動小型框架視窗中的 **「關閉**」按鈕時,由框架呼叫。

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向正在關閉的微型框架視窗的指標。

### <a name="return-value"></a>傳回值

如果可以關閉浮動小型框架視窗,則為 TRUE。 否則，FALSE。

### <a name="remarks"></a>備註

重寫此方法以處理浮動小型框架視窗的隱藏。 如果要防止隱藏浮動的微型框架視窗,則返回 FALSE。

預設實現不執行任何操作,並返回 TRUE。

## <a name="cmdiframewndexonclosepopupmenu"></a><a name="onclosepopupmenu"></a>CMDIFramewndEx::在關閉彈出功能表

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向彈出式功能表的指標。

### <a name="remarks"></a>備註

如果要處理來自[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件的通知,這些物件處理WM_DESTROY消息時,將重寫此方法。

## <a name="cmdiframewndexoncmdmsg"></a><a name="oncmdmsg"></a>CMDIFramewndEx::在CmdMsg上

由框架呼叫以路由和調度命令訊息並更新命令使用者介面物件。

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]命令識別碼。

*n代碼*<br/>
[在]標識命令通知代碼。 有關*nCode*的值的詳細資訊,請參閱[CMDTarget:onCmdMsg。](../../mfc/reference/ccmdtarget-class.md#oncmdmsg)

*pExtra*<br/>
[在]根據*nCode*的值使用。 有關*pExtra*的更多資訊,請參閱[CMDTarget:onCmdMsg。](../../mfc/reference/ccmdtarget-class.md#oncmdmsg)

*pHandlerInfo*<br/>
[進出]通常,此參數應為 NULL。如果`OnCmdMsg`不是 NULL, 請填寫*pHandlerInfo*結構 的`pTarget`和`pmf`成員,而不是調度命令。

### <a name="return-value"></a>傳回值

處理消息時非零;否則 0。

## <a name="cmdiframewndexondrawmenuimage"></a><a name="ondrawmenuimage"></a>CMDIFramewndEx::在畫上功能表圖像

架構在繪製與功能表項目相關聯的映像時所呼叫。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pMenu 按鈕*<br/>
[在]指向功能表按鈕。

*rectImage*<br/>
[在]圖像的邊界矩形。

### <a name="return-value"></a>傳回值

如果方法繪製圖像,則為 TRUE。 預設實現返回 FALSE。

### <a name="remarks"></a>備註

如果要為屬於`CMDIFrameWndEx`派生對象擁有的功能表欄的功能表項自定義圖像渲染,請重寫此方法。 預設實作不做任何動作。

## <a name="cmdiframewndexondrawmenulogo"></a><a name="ondrawmenulogo"></a>CMDIFramewndEx::在DrawMenulogo上

當[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)處理WM_PAINT消息時,由框架調用。

```
virtual void OnDrawMenuLogo(
    CDC*,
    CMFCPopupMenu*,
    const CRect&);
```

### <a name="remarks"></a>備註

重寫此函數,在屬於`CMDIFrameWndEx`派生對象的功能表欄的彈出式功能表上顯示徽標。 預設實作不做任何動作。

## <a name="cmdiframewndexonerasemdiclientbackground"></a><a name="onerasemdiclientbackground"></a>CMDIFramewndEx::在EraseMDI用戶端背景上

當 MDI 幀視窗處理WM_ERASEBKGND消息時,由框架調用。

```
virtual BOOL OnEraseMDIClientBackground(CDC*);
```

### <a name="return-value"></a>傳回值

如果應用程式處理消息並擦除背景,則為 TRUE。

### <a name="remarks"></a>備註

如果要在`CMDIFrameWndEx`派生類中處理WM_ERASEBKGND消息,則重寫此成員函數。

## <a name="cmdiframewndexonmenubuttontoolhittest"></a><a name="onmenubuttontoolhittest"></a>CMDIFramewndEx::在MenuButton工具命中測試

當[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理WM_NCHITTEST消息時,由框架調用。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]工具列按鈕。

*Pti*<br/>
[出]指向[TOOLINFO](/windows/win32/api/commctrl/ns-commctrl-tttoolinfoa)結構的指標。

### <a name="return-value"></a>傳回值

如果應用程式填充*pTI*參數,則為 TRUE。 預設實現返回 FALSE。

### <a name="remarks"></a>備註

如果要向工具提示提供有關特定功能表項的資訊,請重寫此方法。 預設實作不做任何動作。

## <a name="cmdiframewndexonmoveminiframe"></a><a name="onmoveminiframe"></a>CMDIFramewndEx::移動迷你框架

由框架調用以移動微型框架視窗。

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
[在]指向微型框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE,否則為 FALSE。

## <a name="cmdiframewndexonsetpreviewmode"></a><a name="onsetpreviewmode"></a>CMDIFramewndEx::打開預覽模式

設置應用程式的主框架視窗列印預覽模式。

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

*b預覽*<br/>
[在]如果為 TRUE,則設置列印預覽模式。 如果 FALSE,則取消預覽模式。

*pState*<br/>
[在]指向結構的`CPrintPreviewState`指標。

### <a name="remarks"></a>備註

此方法重寫[CFramewnd::OnSet 預覽模式](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。

## <a name="cmdiframewndexonshowcustomizepane"></a><a name="onshowcustomizepane"></a>CMDIFramewndEx::在顯示自定義窗格

啟動"快速自定義"窗格時,由框架調用。

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>參數

*pMenuPane*<br/>
[在]指向「快速自定義」窗格的指標。

*uiToolbarID*<br/>
[在]要自定義工具列的控制 ID。

### <a name="return-value"></a>傳回值

此方法始終返回 TRUE。

### <a name="remarks"></a>備註

"快速自定義"窗格是當使用者按一下工具列上的 **"自訂"** 時打開的功能表。

在派生類中重寫此方法,在「快速自定義」窗格中進行更改。

## <a name="cmdiframewndexonshowmditabcontextmenu"></a><a name="onshowmditabcontextmenu"></a>CMDIFramewndEx:上秀MDITab上下文菜單

在其中一個選項卡上顯示快捷功能表之前,由框架調用。 僅適用於 MDI 選項卡式群組。

```
virtual BOOL OnShowMDITabContextMenu(
    CPoint point,
    DWORD dwAllowedItems,
    BOOL bTabDrop);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]選單在螢幕座標中的位置。

*可被項目*<br/>
[在]指示目前選項卡允許執行的操作的標誌的位-OR 組合:

- BCGP_MDI_CREATE_VERT_GROUP - 可以創建垂直選項卡組。

- BCGP_MDI_CREATE_HORZ_GROUP - 可以創建水平選項卡組。

- BCGP_MDI_CAN_MOVE_PREV - 可以將選項卡移動到上一個選項卡組。

- BCGP_MDI_CAN_MOVE_NEXT - 可以將選項卡移動到下一個選項卡組。

- BCGP_MDI_CAN_BE_DOCKED - 將選項卡式文件切換到停靠狀態(僅與選項卡式文件相關)。

*bTabDrop*<br/>
[在]TRUE 顯示選單,因為將選項卡拖動到另一個選項卡組。 FALSE 將功能表顯示為當前活動選項卡上的快捷功能表。

### <a name="return-value"></a>傳回值

在[CBCGGPMDIFramewnd](../../mfc/reference/cmdiframewndex-class.md)派生類中重寫此方法。

### <a name="remarks"></a>備註

如果不處理`OnShowMDITabContextMenu`,將不會顯示快捷功能表。 啟用 MDI 選項卡群組功能時 **,MFC 應用程式精靈**會生成此功能。

### <a name="example"></a>範例

下面的範例顯示如何在`OnShowMDITabContextMenu` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#14](../../mfc/codesnippet/cpp/cmdiframewndex-class_13.cpp)]

## <a name="cmdiframewndexonshowpanes"></a><a name="onshowpanes"></a>CMDIFramewndEx::在顯示窗格

由框架呼叫以顯示或隱藏窗格。

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]TRUE 顯示窗格,FALSE 以隱藏窗格。

### <a name="return-value"></a>傳回值

如果窗格的狀態因調用此方法而發生更改,則 FALSE 如果窗格已處於*bShow*指定的狀態。 例如,如果窗格是隱藏的,並且*bShow*是 FALSE,則返回值為 FALSE。

### <a name="remarks"></a>備註

預設實現從頂層框架視窗中刪除工具列。

如果[CDockingManager:m_bHideDockingBarsInContainerMode](../../mfc/reference/cdockingmanager-class.md#m_bhidedockingbarsincontainermode)為 TRUE(預設值),則所有停靠窗格都將隱藏。

## <a name="cmdiframewndexonshowpopupmenu"></a><a name="onshowpopupmenu"></a>CMDIFramewndEx::在顯示彈出菜單

框架在打開彈出式功能表時調用它。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu*);
```

### <a name="return-value"></a>傳回值

如果要顯示彈出式功能表,則為 TRUE。 否則，FALSE。 預設實現返回 TRUE。

### <a name="remarks"></a>備註

如果要在彈出功能表啟動時實現特殊處理,請重寫此方法。 例如,如果要將常規功能表項更改為顏色功能表按鈕,則設置撕線,等等。

預設實作不做任何動作。

## <a name="cmdiframewndexonsizemdiclient"></a><a name="onsizemdiclient"></a>CMDIFramewndEx:onsizeMDIClient

當用戶端 MDI 視窗的大小發生變化時,由框架調用。

```
virtual void OnSizeMDIClient(
    const CRect& rectOld,
    const CRect& rectNew);
```

### <a name="parameters"></a>參數

*rectOld*<br/>
[在]MDI 用戶端視窗的當前大小。

*重新*<br/>
[在]MDI 用戶端視窗的新大小。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexontearoffmenu"></a><a name="ontearoffmenu"></a>CMDIFramewndEx::在TearoffMenu上

架構在啟動有分割列的功能表時所呼叫。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向彈出功能表的指標。

*pBar*<br/>
[在]指向撕裂條的指標。

### <a name="return-value"></a>傳回值

TRUE 允許啟動帶有撕開欄的彈出式功能表;否則 FALSE。 預設值是 TRUE。

### <a name="remarks"></a>備註

如果要實現撕開條的特殊設置,則重寫此功能。 預設實作不做任何動作。

## <a name="cmdiframewndexonupdateframemenu"></a><a name="onupdateframemenu"></a>CMDIFramewndEx::更新框架功能表

由框架調用以更新框架功能表。

```
virtual void OnUpdateFrameMenu(HMENU hMenuAlt);
```

### <a name="parameters"></a>參數

*哈梅內阿爾特*<br/>
[在]功能表的句柄。

## <a name="cmdiframewndexpanefrompoint"></a><a name="panefrompoint"></a>CMDIFramewndEx::P從點

返回包含指定點的停靠窗格。

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]點(在螢幕座標中)。

*nSensitivity*<br/>
[在]此值在所有方向上放大每個選中窗格的視窗矩形。

*bExactBar*<br/>
[在]如果為 TRUE,則忽略*nSensitivity*參數。

*pRTCBar 類型*<br/>
[在]如果非 NULL,則該方法僅在指定類型的窗格上遍網。

*dwalignment*<br/>
[出]如果找到窗格,此參數將指定窗格的哪一側最接近指定點。

### <a name="return-value"></a>傳回值

指向停靠窗格的指標,如果沒有控件包含*點*指定的點,則為 NULL。

### <a name="remarks"></a>備註

呼叫被重定到[CDockingManager 類別](../../mfc/reference/cdockingmanager-class.md)。 有關詳細資訊[,請參閱 CDockingManager:控制列從點](../../mfc/reference/cdockingmanager-class.md#panefrompoint)。

## <a name="cmdiframewndexrecalclayout"></a><a name="recalclayout"></a>CMDIFramewndEx:recalclayout

由框架調用以重新計算框架視窗的佈局。

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

*b 通知*<br/>
[在]確定框架視窗的活動就地專案是否接收佈局更改通知。 如果為 TRUE,則會通知該專案;如果為 TRUE,則通知該專案。否則 FALSE。

### <a name="remarks"></a>備註

此方法重寫[CFramewnd::recalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。

## <a name="cmdiframewndexremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>CMDIFramewndEx::從Dock管理器中刪除Pane

取消註冊窗格並從停靠管理器中刪除它。

```
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>參數

*p控制列*<br/>
[在]指向要刪除的窗格的指標。

*b破壞*<br/>
[在]TRUE 以銷毀已刪除的窗格。 不摧毀它。

*b 調整佈局*<br/>
[在]TRUE 可立即調整停靠佈局。 如果 FALSE,則僅當由於其他原因(用戶調整視窗大小、拖動主框架等)而發生重繪事件時才會進行調整。

*bAutoHide*<br/>
[在]TRUE 從自動隱藏窗格列表中刪除窗格。 FALSE 從常規窗格清單中刪除窗格。

*pBar 取代*<br/>
[在]指向替換已刪除窗格的窗格的指標。

### <a name="remarks"></a>備註

您必須向停靠管理器註冊每個窗格才能參與停靠佈局。 使用[CMDIFrameWndEx::添加窗格](#addpane)或[CMDIFramewndEx::插入窗格](#insertpane)以註冊窗格。

當窗格不再是框架視窗的停靠佈局的一部分時,請使用此方法。

## <a name="cmdiframewndexsavemdistate"></a><a name="savemdistate"></a>CMDIFramewndEx::保存MDIState

儲存 MDI 選項卡群組的當前佈局和以前打開的文件清單。

```
virtual BOOL SaveMDIState(LPCTSTR lpszProfileName);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定設定檔名稱。

### <a name="return-value"></a>傳回值

如果保存成功,則為 TRUE;如果保存失敗,則 FALSE。

### <a name="remarks"></a>備註

要載入或儲存 MDI 選項卡和群組的狀態以及開啟的文件清單,執行以下操作:

- 主`SaveMDIState`框架關閉時通話

- 呼叫[CMDIFrameWndEx::建立主幀時載入MDIState。](#loadmdistate) 此調用的建議位置是首次在顯示主幀之前。

- 之前`CWinAppEx::EnableLoadWindowPlacement(FALSE);`致電`pMainFrame->LoadFrame (IDR_MAINFRAME);`

- 之後`CWinAppEx::ReloadWindowPlacement(pMainFrame)``LoadMDIState`調用以在註冊表中存儲的位置顯示主框架。

- 如果`GetDocumentName`應用程式顯示`CMDIChildWndEx`的文檔未存儲為檔,則在派生類中覆蓋。 傳回的字串將作為文件標識符保存在註冊表中。 有關詳細資訊,請參閱[CMDIChildwndEx::獲取文件名稱](../../mfc/reference/cmdichildwndex-class.md#getdocumentname)。

- 覆蓋[CMDIFrameWndEx:創建文檔視窗](#createdocumentwindow),以便從註冊表載入文檔時正確創建文檔。 的參數`CreateDocumentWindow`是前面返回`GetDocumentName`的 字串。

### <a name="example"></a>範例

下面的範例顯示如何在`SaveMDIState` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#15](../../mfc/codesnippet/cpp/cmdiframewndex-class_14.cpp)]

## <a name="cmdiframewndexsetprintpreviewframe"></a><a name="setprintpreviewframe"></a>CMDIFramewndEx::設置列印預覽框架

設置列印預覽框架視窗。

```
void SetPrintPreviewFrame(CFrameWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向列印預覽框架視窗的指標。

### <a name="remarks"></a>備註

## <a name="cmdiframewndexsetuptoolbarmenu"></a><a name="setuptoolbarmenu"></a>CMDIFramewndEx::設定工具列選單

通過將虛擬項目替換為使用者定義的項來修改工具列物件。

```
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>參數

*選單*<br/>
[在]對要修改的[CMenu 類](../../mfc/reference/cmenu-class.md)物件的引用。

*uiViewUserToolbarCmdFirst*<br/>
[在]指定第一個使用者定義的命令。

*uiViewUserToolbarCmdLast*<br/>
[在]指定最後一個使用者定義的命令。

## <a name="cmdiframewndexshowfullscreen"></a><a name="showfullscreen"></a>CMDIFramewndEx::顯示全屏

將主幀從常規模式切換到全屏模式。

```
void ShowFullScreen();
```

### <a name="remarks"></a>備註

## <a name="cmdiframewndexshowpane"></a><a name="showpane"></a>CMDIFramewndEx::顯示窗格

顯示或隱藏指定的窗格。

```
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要顯示或隱藏的窗格的指標。

*b 顯示*<br/>
[在]TRUE 以顯示窗格。 FALSE 以隱藏窗格。

*bDelay*<br/>
[在]TRUE 以延遲停靠佈局的重新計算。 FALSE 可立即重新計算停靠佈局。

*b 啟動*<br/>
[在]TRUE 以顯示窗格應為活動。 FALSE 將窗格顯示為非活動狀態。

### <a name="remarks"></a>備註

呼叫此方法以顯示或隱藏窗格。 請勿用於`ShowWindow`停靠窗格。

### <a name="example"></a>範例

下面的範例顯示如何在`ShowPane` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#16](../../mfc/codesnippet/cpp/cmdiframewndex-class_15.cpp)]

## <a name="cmdiframewndexshowwindowsdialog"></a><a name="showwindowsdialog"></a>CMDIFramewndEx::顯示視窗對話

創建一個[CMFCWindowsManager對話框](../../mfc/reference/cmfcwindowsmanagerdialog-class.md)並打開它。

```
void ShowWindowsDialog();
```

### <a name="example"></a>範例

下面的範例顯示如何在`ShowWindowsDialog` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#18](../../mfc/codesnippet/cpp/cmdiframewndex-class_16.cpp)]

## <a name="cmdiframewndextabbeddocumenttocontrolbar"></a><a name="tabbeddocumenttocontrolbar"></a>CMDIFramewndEx::Tabbed文檔到控制欄

將指定的選項卡式文件轉換為停靠窗格。

```
virtual BOOL TabbedDocumentToControlBar(CMDIChildWndEx* pMDIChildWnd);
```

### <a name="parameters"></a>參數

*pMDIChildwnd*<br/>
指向包含停靠窗格的 MDI 子視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE,失敗時為 FALSE。

### <a name="remarks"></a>備註

使用此方法可將選項卡式文件轉換為停靠窗格。 選項卡式文件必須使用[CMDIFrameWndEx:::控制欄標籤文件](#controlbartotabbeddocument)創建。

### <a name="example"></a>範例

下面的範例顯示如何在`TabbedDocumentToControlBar` [VisualStudioDemo 範例中使用:MFC 視覺化工作室應用程式](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_VisualStudioDemo#19](../../mfc/codesnippet/cpp/cmdiframewndex-class_17.cpp)]

## <a name="cmdiframewndexupdatecaption"></a><a name="updatecaption"></a>CMDIFramewndEx::更新標題

由框架調用以更新視窗框架標題。

```
void UpdateCaption();
```

### <a name="remarks"></a>備註

## <a name="cmdiframewndexupdatemditabbedbarsicons"></a><a name="updatemditabbedbarsicons"></a>CMDIFramewndEx::更新MDITab貝德巴圖示

設置每個 MDI 選項卡式窗格的圖示。

```
void UpdateMDITabbedBarsIcons();
```

## <a name="cmdiframewndexwinhelp"></a><a name="winhelp"></a>CMDIFramewndEx::贏説明

架構所呼叫以起始 WinHelp 應用程式或內容說明。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>參數

*dwData*<br/>
[在]指定*nCmd*指定的幫助類型所需的資料。

*nCmd*<br/>
[在]指定請求的幫助類型。 有關可能值的清單及其如何影響*dwData*參數,請參閱 Windows SDK 中的[WinHelp 函數](/windows/win32/api/winuser/nf-winuser-winhelpw)。

### <a name="remarks"></a>備註

這個方法會覆寫 [CWnd::WinHelp](../../mfc/reference/cwnd-class.md#winhelp)。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMDIFrameWnd](../../mfc/reference/cframewnd-class.md)<br/>
[CMDIChildWndEx 類別](../../mfc/reference/cmdichildwndex-class.md)
