---
title: CMFCPopupMenu 類別
ms.date: 10/18/2018
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
ms.openlocfilehash: 4749b043271518a40024d1da4f97b593ad882a78
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375378"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu 類別

實作 Windows 快顯功能表功能，並加入功能 (例如 Tear-Off 功能表和工具提示) 進行擴充。
有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCPopupMenu : public CMiniFrameWnd
```

## <a name="members"></a>成員

### <a name="protected-constructors"></a>受保護的建構函式

|名稱|描述|
|----------|-----------------|
|[CMFC彈出功能表::CMFC彈出功能表](#cmfcpopupmenu)|建構 `CMFCPopupMenu` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFC彈出功能表::啟動彈出功能表](#activatepopupmenu)||
|[CMFC彈出選單::始終顯示空工具輸入](#alwaysshowemptytoolsentry)|設置是否啟用了彈出式功能表以顯示使用者定義工具的空條目。|
|[CMFC彈出選單::所有命令都顯示](#areallcommandsshown)||
|[CMFC彈出功能表::檢查區域](#checkarea)|確定點相對於彈出功能表的位置。|
|[CMFC彈出選單::關閉選單](#closemenu)||
|[CMFC彈出選單:建立](#create)|創建一個彈出式功能表並將其附加到`CMFCPopupMenu`物件。|
|[CMFCPopupMenu::DefaultMouse點擊關閉](#defaultmouseclickonclose)||
|[CMFCPopup功能表::啟用功能表Logo](#enablemenulogo)|初始化彈出功能表的徽標。|
|[CMFCPopup選單::啟用選單聲音](#enablemenusound)|啟用功能表聲音。|
|[CMFC彈出選單::啟用調整](#enableresize)||
|[CMFC彈出選單::啟用滾動](#enablescrolling)||
|[CMFC彈出選單::啟用反轉調整](#enablevertresize)||
|[CMFCPopup功能表::尋找子項目按命令](#findsubitembycommand)||
|[CMFC彈出選單::取得活動選單](#getactivemenu)|返回當前活動功能表。|
|[CMFCPopup功能表::取得動畫速度](#getanimationspeed)|返回彈出式功能表的動畫速度。|
|[CMFCPopup功能表::獲取動畫類型](#getanimationtype)|返回當前類型的彈出式功能表動畫。|
|[CMFC彈出功能表::獲取方向](#getdropdirection)||
|[CMFCPopup功能表::獲取力量選單焦點](#getforcemenufocus)|指示顯示彈出式功能表時,焦點是否返回到菜單欄。|
|[CMFCPopup功能表::獲取力量陰影](#getforceshadow)||
|[CMFCPopup功能表::取得HMenu](#gethmenu)|返回附加功能表資源的句柄。|
|[CMFC彈出功能表::獲取選單欄](#getmenubar)|返回嵌入在彈出式功能表中的[CMFCPopupMenuBar。](../../mfc/reference/cmfcpopupmenubar-class.md)|
|[CMFC彈出選單::獲取選單專案](#getmenuitem)|返回指向指定索引處的功能表項的指標。|
|[CMFC彈出功能表::獲取菜單項計數](#getmenuitemcount)|返回彈出功能表中的項數。|
|[CMFCPopup功能表::獲取消息](#getmessagewnd)|返回指向框架路由彈出功能表消息的視窗的指標。|
|[CMFC彈出功能表::獲取家長區域](#getparentarea)||
|[CMFC彈出功能表::獲取家長按鈕](#getparentbutton)|返回指向父工具列按鈕的指標。|
|[CMFC彈出功能表::獲取家長彈出功能表](#getparentpopupmenu)|返回指向父彈出視窗功能表的指標。|
|[CMFCPopup功能表::取得父功能元素](#getparentribbonelement)||
|[CMFC彈出選單::獲取父項工具列](#getparenttoolbar)|返回指向父工具列的指標。|
|[CMFCPopup選單::取得快速自定義類型](#getquickcustomizetype)||
|[CMFCPopup功能表::獲取塞爾專案](#getselitem)|返回指向當前所選功能表命令的指標。|
|[CMFCPopupMenu::已調整大小](#hasbeenresized)||
|[CMFCPopup功能表::隱藏很少使用的命令](#hiderarelyusedcommands)|指示彈出式功能表是否可以隱藏很少使用的命令。|
|[CMFCPopupMenu::InCommand](#incommand)||
|[CMFC彈出選單::插入專案](#insertitem)|將新專案插入指定位置的彈出式功能表中。|
|[CMFCPopup選單::插入分隔符](#insertseparator)|在指定位置的彈出式功能表中插入分隔符。|
|[CMFC彈出功能表::永遠關閉](#isalwaysclose)||
|[CMFC彈出選單::隨時顯示空工具輸入](#isalwaysshowemptytoolsentry)||
|[CMFC彈出選單::是自定義窗格](#iscustomizepane)|指示彈出式選單是否充當**快速自訂窗格**。|
|[CMFCPopup功能表::Iscclose](#isescclose)||
|[CMFC彈出功能表::空閒](#isidle)|指示彈出式功能表當前是否處於空閒狀態。|
|[CMFCPopup功能表::IsMenuSound](#ismenusound)||
|[CMFCPopup功能表::快速定製](#isquickcustomize)|確定關聯的[CMFCToolBarMenuButton 類](../../mfc/reference/cmfctoolbarmenubutton-class.md)是否處於快速自定義模式。|
|[CMFC彈出功能表::可重調整](#isresizeble)||
|[CMFCPopup功能表::右對齊](#isrightalign)|指示功能表是右對齊還是左對齊。|
|[CMFC彈出功能表::可滾動](#isscrollable)||
|[CMFC彈出選單::是傳送選單選擇Mmsg](#issendmenuselectmsg)|指示當使用者從彈出式功能表中選擇命令時,框架是否通知父框架。|
|[CMFC彈出選單::顯示](#isshown)|指示彈出式功能表當前是否可見。|
|[CMFCPopup功能表::移動到](#moveto)||
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(覆寫 `CFrameWnd::OnCmdMsg`。)|
|[CMFCPopupMenu::Post命令](#postcommand)||
|[CMFCPopup功能表::P重新翻譯訊息](#pretranslatemessage)|(覆寫 `CFrameWnd::PreTranslateMessage`。)|
|[CMFCPopup功能表::Recalclayout](#recalclayout)|當標準控制欄打開或關閉或調整框架視窗大小時,由框架調用。 (覆蓋[CFramewnd:recalclayout](../../mfc/reference/cframewnd-class.md#recalclayout).)|
|[CMFC彈出選單::刪除所有專案](#removeallitems)|清除彈出功能表中的所有專案。|
|[CMFC彈出選單::刪除專案](#removeitem)|從彈出式功能表中刪除指定的項。|
|[CMFC彈出選單::儲存狀態](#savestate)||
|[CMFCPopup功能表::設定動畫速度](#setanimationspeed)|設置彈出式功能表的動畫速度。|
|[CMFC彈出選單::設定動畫類型](#setanimationtype)|設置彈出式功能表的動畫類型。|
|[CMFC彈出選單::設定自動銷毀](#setautodestroy)||
|[CMFC彈出選單::設定預設項目](#setdefaultitem)|設置彈出式功能表的預設命令。|
|[CMFC彈出選單::設定強制選單焦點](#setforcemenufocus)|顯示彈出式功能表時,強制輸入焦點返回到功能表欄。|
|[CMFC彈出功能表::設置力量陰影](#setforceshadow)|當彈出功能表出現在主框架之外時,強制框架繪製功能表陰影。|
|[CMFC彈出選單::設定最大寬度](#setmaxwidth)|設置彈出式功能表的最大寬度。|
|[CMFCPopup功能表::設定消息](#setmessagewnd)||
|[CMFCPopup功能表::設定父功能區元素](#setparentribbonelement)||
|[CMFC彈出選單::設定快速自定義類型](#setquickcustomizetype)||
|[CMFC彈出選單::設定快速模式](#setquickmode)||
|[CMFC彈出功能表::設定正確對齊](#setrightalign)|設置彈出式功能表的功能表對齊方式。|
|[CMFC彈出選單::設定傳送選單選擇Mmsg](#setsendmenuselectmsg)|設置一個標誌,用於控制當用戶選擇命令時彈出功能表是否通知其父框架。|
|[CMFC彈出選單::顯示所有命令](#showallcommands)|強制彈出功能表顯示所有命令。|
|[CMFC彈出功能表::觸發調整](#triggerresize)||
|[CMFC彈出功能表::更新所有陰影](#updateallshadows)|更新所有打開的彈出式功能表的陰影。|
|[CMFC彈出功能表::更新陰影](#updateshadow)|更新彈出式功能表的影子。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFC彈出功能表::創建"撕裂欄"](#createtearoffbar)||
|[CMFCPopup功能表::打開](#onchangehot)||
|[CMFC彈出功能表::在選擇項目上](#onchooseitem)||

### <a name="remarks"></a>備註

通常,MFC 會自動創建彈出式功能表。 如果要手動建立`CMFCPopupMenu`物件,請在堆上分配一個物件,然後呼叫[CMFCPopupMenu::create](#create)。

## <a name="example"></a>範例

下面的示例演示如何配置彈出式功能表物件。 該示例演示如何設置徽標和彈出式功能表的聲音、設置動畫速度和類型、在主框外彈出功能表出現時繪製功能表陰影、設置最大寬度以及設置彈出式功能表的正確功能表對齊方式。 此代碼段是[自定義頁示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)

`CMFCPopupMenu`

## <a name="requirements"></a>需求

**標題:** afxpopupmenu.h

## <a name="cmfcpopupmenuactivatepopupmenu"></a><a name="activatepopupmenu"></a>CMFC彈出功能表::啟動彈出功能表

```
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,
    CMFCPopupMenu* pPopupMenu);
```

### <a name="parameters"></a>參數

[在]*pTop 架構*<br/>
[在]*pPopupMenu*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenualwaysshowemptytoolsentry"></a><a name="alwaysshowemptytoolsentry"></a>CMFC彈出選單::始終顯示空工具輸入

設置是否啟用了彈出式功能表以顯示使用者定義工具的空條目。

```
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]如果彈出式功能表可以顯示空條目,則為 TRUE;否則。

## <a name="cmfcpopupmenuareallcommandsshown"></a><a name="areallcommandsshown"></a>CMFC彈出選單::所有命令都顯示

```
BOOL AreAllCommandsShown() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenucheckarea"></a><a name="checkarea"></a>CMFC彈出功能表::檢查區域

確定點相對於彈出功能表的位置。

```
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;
```

### <a name="parameters"></a>參數

*ptScreen*<br/>
[在]螢幕座標中的一個點。

### <a name="return-value"></a>傳回值

指示點相對於彈出功能表的位置的MENUAREA_TYPE參數。

### <a name="remarks"></a>備註

MENUAREA_TYPE參數可以具有以下任意值之一。

- 外部 - *ptScreen*在彈出式功能表之外。

- LOGO - *ptScreen*位於徽標區域上。

- TEAROFF_CAPTION - *ptScreen*位於撕下標題上。

- SHADOW_BOTTOM - *ptScreen*位於彈出式功能表的底部陰影上。

- SHADOW_RIGHT - *ptScreen*位於彈出式功能表的右陰影上。

- MENU - *ptScreen*超過命令。

## <a name="cmfcpopupmenuclosemenu"></a><a name="closemenu"></a>CMFC彈出選單::關閉選單

```
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```

### <a name="parameters"></a>參數

[在]*bSetFocustoBar*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenucmfcpopupmenu"></a><a name="cmfcpopupmenu"></a>CMFC彈出功能表::CMFC彈出功能表

構造[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件。

```
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,
    LPCTSTR lpszTitle);
```

### <a name="parameters"></a>參數

*pCustPage*<br/>
[在]指向自定義頁的指標。

*lpszTitle*<br/>
[在]包含選單標題的字串。

### <a name="remarks"></a>備註

此方法分配 的`CMFCPopupMenu`資源 。 要建立彈出式選單項目,請致電[CMFCPopupMenu::建立](#create)。

## <a name="cmfcpopupmenucreate"></a><a name="create"></a>CMFC彈出選單:建立

創建一個彈出式功能表並將其附加到[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件。

```
virtual BOOL Create(
    CWnd* pWndParent,
    int x,
    int y,
    HMENU hMenu,
    BOOL bLocked = FALSE,
    BOOL bOwnMessage = FALSE);
```

### <a name="parameters"></a>參數

*pwnd 父級*<br/>
[在]的`CMFCPopupMenu`父視窗。

*X.*<br/>
[在]彈出選單位置的水平螢幕座標

*Y*<br/>
[在]彈出功能表位置的垂直螢幕座標。

*hMenu*<br/>
[在]功能表資源的句柄。

*封鎖*<br/>
[在]指示功能表是否可自定義的布爾參數。 FALSE 表示彈出式功能表是可自定義的。

*bown消息*<br/>
[在]一個布爾參數,指示框架如何路由功能表消息。 如需詳細資訊，請參閱＜備註＞一節。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

如果*bownMessage*為 TRUE,則框架會將任何選單訊息路由到*pWndParent*。 如果*bown 消息為 TRUE,* 則*pWndParent*不得為 NULL。 如果*bownMessage*是 FALSE,則框架會將功能表消息路由到父彈出視窗功能表。

### <a name="example"></a>範例

下面的示例演示如何使用`Create``CMFCPopuMenu`類的方法。 此代碼段是[自定義頁示例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]

## <a name="cmfcpopupmenucreatetearoffbar"></a><a name="createtearoffbar"></a>CMFC彈出功能表::創建"撕裂欄"

```
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,
    UINT uiID,
    LPCTSTR lpszName);
```

### <a name="parameters"></a>參數

[在]*普恩德·梅因*<br/>
[在]*uiID*<br/>
[在]*lpsz名稱*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenudefaultmouseclickonclose"></a><a name="defaultmouseclickonclose"></a>CMFCPopupMenu::DefaultMouse點擊關閉

```
virtual BOOL DefaultMouseClickOnClose() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablemenulogo"></a><a name="enablemenulogo"></a>CMFCPopup功能表::啟用功能表Logo

初始化彈出功能表的徽標。

```
void EnableMenuLogo(
    int iLogoSize,
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```

### <a name="parameters"></a>參數

*iLogoSize*<br/>
[在]徽標的大小(以像素為單位)。

*nLogo位置*<br/>
[在]指示徽標位置的枚舉數據類型。

### <a name="remarks"></a>備註

要顯示徽標,在主框架視窗中實現方法[CFramewndEx:onDrawMenuLogo。](../../mfc/reference/cframewndex-class.md#ondrawmenulogo)

*nLogoLocation*的可能值為MENU_LOGO_LEFT、MENU_LOGO_RIGHT、MENU_LOGO_TOP和MENU_LOGO_BOTTOM。

## <a name="cmfcpopupmenuenablemenusound"></a><a name="enablemenusound"></a>CMFCPopup選單::啟用選單聲音

啟用功能表聲音。

```
static void EnableMenuSound(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用聲音,否則 FALSE。

### <a name="remarks"></a>備註

如果啟用聲音,當使用者打開彈出式功能表或選擇功能表命令時,框架將調用[PlaySound](/windows/win32/api/shobjidl_core/nf-shobjidl_core-iusernotification-playsound)方法。 默認情況下,此功能已啟用。

## <a name="cmfcpopupmenuenableresize"></a><a name="enableresize"></a>CMFC彈出選單::啟用調整

```
void EnableResize(CSize sizeMinResize);
```

### <a name="parameters"></a>參數

[在]*大小最小調整*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablescrolling"></a><a name="enablescrolling"></a>CMFC彈出選單::啟用滾動

```
void EnableScrolling(BOOL = TRUE);
```

### <a name="parameters"></a>參數

[在]*波爾*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuenablevertresize"></a><a name="enablevertresize"></a>CMFC彈出選單::啟用反轉調整

```
void EnableVertResize(int nMinResize);
```

### <a name="parameters"></a>參數

[在]*nMinResize*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenufindsubitembycommand"></a><a name="findsubitembycommand"></a>CMFCPopup功能表::尋找子項目按命令

```
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;
```

### <a name="parameters"></a>參數

[在]*烏伊Cmd*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetactivemenu"></a><a name="getactivemenu"></a>CMFC彈出選單::取得活動選單

返回當前活動功能表。

```
static CMFCPopupMenu* GetActiveMenu();
```

### <a name="return-value"></a>傳回值

指向活動彈出式功能表的指標,如果當前沒有彈出視窗功能表處於活動狀態,則指向 NULL。

### <a name="remarks"></a>備註

每個應用程式最多只能有一個活動彈出功能表。

## <a name="cmfcpopupmenugetanimationspeed"></a><a name="getanimationspeed"></a>CMFCPopup功能表::取得動畫速度

返回彈出式功能表的動畫速度。

```
static UINT GetAnimationSpeed();
```

### <a name="return-value"></a>傳回值

一個整數,指示彈出功能表動畫完成所需的時間(以毫秒為單位)。

### <a name="remarks"></a>備註

動畫速度是全域值。 使用[CMFCPopupMenu::設定動畫速度](#setanimationspeed)以更改彈出式功能表的動畫速度。

## <a name="cmfcpopupmenugetanimationtype"></a><a name="getanimationtype"></a>CMFCPopup功能表::獲取動畫類型

返回當前類型的彈出式動畫。

```
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```

### <a name="parameters"></a>參數

*bNoSystem*<br/>
[在]指示此方法是否檢查全域值的布爾參數。 如果希望此方法返回[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)的此實例的動畫樣式,則 FALSE。

### <a name="return-value"></a>傳回值

描述動畫類型的枚舉值。

### <a name="remarks"></a>備註

彈出式功能表的動畫樣式對於應用程式來說是全域的。 使用[CMFCPopupMenuMenu::設置動畫類型](#setanimationtype)來設置動畫樣式。

下表列出了可能的動畫類型。

|||
|-|-|
|NO_ANIMATION|彈出式功能表未設置動畫,並立即顯示。  |
|展開|框架顯示從左上角到右下角的彈出式功能表。  |
|投影片|彈出式功能表從上到下移動。  |
|褪色|彈出式功能表首先顯示為透明並逐漸凝固。  |

## <a name="cmfcpopupmenugetdropdirection"></a><a name="getdropdirection"></a>CMFC彈出功能表::獲取方向

```
DROP_DIRECTION GetDropDirection() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetforcemenufocus"></a><a name="getforcemenufocus"></a>CMFCPopup功能表::獲取力量選單焦點

指示顯示彈出式功能表時,焦點是否返回到菜單欄。

```
static BOOL GetForceMenuFocus();
```

### <a name="return-value"></a>傳回值

如果顯示彈出式功能表時輸入焦點返回到功能表欄,則為 TRUE;如果彈出式功能表保留焦點,則 FALSE。

### <a name="remarks"></a>備註

默認情況下,應用程式不會將焦點返回到菜單欄。 要變更此設定,請使用[CMFCPopupMenuMenu::設定ForceMenu焦點](#setforcemenufocus)。

## <a name="cmfcpopupmenugetforceshadow"></a><a name="getforceshadow"></a>CMFCPopup功能表::獲取力量陰影

```
static BOOL __stdcall GetForceShadow();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugethmenu"></a><a name="gethmenu"></a>CMFCPopup功能表::取得HMenu

返回附加功能表資源的句柄。

```
HMENU GetHMenu();
```

## <a name="cmfcpopupmenugetmenubar"></a><a name="getmenubar"></a>CMFC彈出功能表::獲取選單欄

返回嵌入在彈出式功能表中的[CMFCPopupMenuBar。](../../mfc/reference/cmfcpopupmenubar-class.md)

```
virtual CMFCPopupMenuBar* GetMenuBar();
```

### <a name="return-value"></a>傳回值

指向嵌入`CMFCPopupMenuBar`的指標。

### <a name="remarks"></a>備註

彈出功能表具有嵌入`CMFCPopupMenuBar`物件。 如果使用不同的嵌入式類,則必須在派生類中重寫此方法。

## <a name="cmfcpopupmenugetmenuitem"></a><a name="getmenuitem"></a>CMFC彈出選單::獲取選單專案

返回指向指定索引處的功能表項的指標。

```
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[在]功能表項的零基索引。

### <a name="return-value"></a>傳回值

指向功能表項的指標。 如果索引無效,則為 NULL。

### <a name="remarks"></a>備註

功能表項由[CMFCToolBarMenuButton 類](../../mfc/reference/cmfctoolbarmenubutton-class.md)表示。 調用此方法時,它將返回指向相應`CMFCToolBarMenuButton`的指標。

## <a name="cmfcpopupmenugetmenuitemcount"></a><a name="getmenuitemcount"></a>CMFC彈出功能表::獲取菜單項計數

返回彈出式功能表中的項數。

```
int GetMenuItemCount() const;
```

### <a name="return-value"></a>傳回值

功能表中的項數。

## <a name="cmfcpopupmenugetmessagewnd"></a><a name="getmessagewnd"></a>CMFCPopup功能表::獲取消息

返回指向框架路由彈出功能表消息的視窗的指標。

```
CWnd* GetMessageWnd() const;
```

### <a name="return-value"></a>傳回值

指向接收彈出功能表消息的視窗的指標;如果沒有視窗,則為 NULL。

### <a name="remarks"></a>備註

當您使用方法[CMFCPopupMenu::創建](#create)以創建一個彈出式功能表時,可以指定接收功能表訊息的視窗。

## <a name="cmfcpopupmenugetparentarea"></a><a name="getparentarea"></a>CMFC彈出功能表::獲取家長區域

```
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```

### <a name="parameters"></a>參數

[在]*rectParentBtn*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetparentbutton"></a><a name="getparentbutton"></a>CMFC彈出功能表::獲取家長按鈕

返回指向父工具列按鈕的指標。

```
CMFCToolBarMenuButton* GetParentButton() const;
```

### <a name="return-value"></a>傳回值

指向父工具列按鈕的指標。 如果彈出式選單沒有父工具列按鈕,則為 NULL。

### <a name="remarks"></a>備註

`CMFCPopupMenu`可以與功能表上的按鈕關聯。 在這種情況下,當用戶選擇父工具列按鈕時,將顯示彈出菜單。

如果彈出式功能表是快捷菜單,它將沒有父工具列按鈕。

## <a name="cmfcpopupmenugetparentpopupmenu"></a><a name="getparentpopupmenu"></a>CMFC彈出功能表::獲取家長彈出功能表

返回指向父彈出視窗功能表的指標。

```
CMFCPopupMenu* GetParentPopupMenu() const;
```

### <a name="return-value"></a>傳回值

指向父物件的指標;`CMFCPopupMenu`指向父物件的指標如果沒有父彈出功能表,則為 NULL。

### <a name="remarks"></a>備註

僅當是子功能表時,彈出式功能表`CMFCPopupMenu`才具有父物件。

## <a name="cmfcpopupmenugetparentribbonelement"></a><a name="getparentribbonelement"></a>CMFCPopup功能表::取得父功能元素

```
CMFCRibbonBaseElement* GetParentRibbonElement() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetparenttoolbar"></a><a name="getparenttoolbar"></a>CMFC彈出選單::獲取父項工具列

返回指向父工具列的指標。

```
CMFCToolBar* GetParentToolBar() const;
```

### <a name="return-value"></a>傳回值

指向父工具列的指標。 如果彈出式功能表沒有父工具列,則為 NULL。

### <a name="remarks"></a>備註

如果`CMFCPopupMenu`是快捷功能表,則它沒有父工具列。

## <a name="cmfcpopupmenugetquickcustomizetype"></a><a name="getquickcustomizetype"></a>CMFCPopup選單::取得快速自定義類型

```
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenugetselitem"></a><a name="getselitem"></a>CMFCPopup功能表::獲取塞爾專案

返回指向當前所選功能表命令的指標。

```
CMFCToolBarMenuButton* GetSelItem();
```

### <a name="return-value"></a>傳回值

指向當前選擇的功能表命令的指標;如果未選擇任何項目,則為 NULL。

### <a name="remarks"></a>備註

彈出式功能表上的功能表命令由[CMFCToolBarMenuButton 類](../../mfc/reference/cmfctoolbarmenubutton-class.md)或派`CMFCToolBarMenuButton`生自 的 類表示。

## <a name="cmfcpopupmenuhasbeenresized"></a><a name="hasbeenresized"></a>CMFCPopupMenu::已調整大小

```
BOOL HasBeenResized() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuhiderarelyusedcommands"></a><a name="hiderarelyusedcommands"></a>CMFCPopup功能表::隱藏很少使用的命令

指示彈出式功能表是否可以隱藏很少使用的命令。

```
BOOL HideRarelyUsedCommands() const;
```

### <a name="return-value"></a>傳回值

如果彈出式功能表可以隱藏很少使用的命令,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法僅指定彈出式功能表是否可以隱藏很少使用的命令,而不是啟用該設定時。 如果彈出功能表具有父按鈕,並且父視窗派生自[CMFCMenuBar 類](../../mfc/reference/cmfcmenubar-class.md),則可以隱藏很少使用的命令。 使用[CMFCMenuBar::設定最近使用的功能表](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus)以啟用此功能,CMFCMenuBar:[最近使用選單](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus)以確定此功能當前是否已啟用。 必須為父窗口調用這兩種方法。

## <a name="cmfcpopupmenuincommand"></a><a name="incommand"></a>CMFCPopupMenu::InCommand

```
virtual BOOL InCommand();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuinsertitem"></a><a name="insertitem"></a>CMFC彈出選單::插入專案

將新專案插入指定位置的彈出式功能表中。

```
int InsertItem(
    const CMFCToolBarMenuButton& button,
    int iInsertA = -1);
```

### <a name="parameters"></a>參數

*按鈕*<br/>
[在]要添加的功能表項的引用。

*iInsertAt*<br/>
[在]新專案的零基索引。 如果*iInsertAt*為 -1,則該專案將添加到菜單的末尾。

### <a name="return-value"></a>傳回值

插入專案的位置的零基索引。 -1 如果方法失敗。

### <a name="remarks"></a>備註

如果為*iInsertAt*提供了無效值,則此方法將失敗,例如大於彈出式菜單上當前項數的整數。

## <a name="cmfcpopupmenuinsertseparator"></a><a name="insertseparator"></a>CMFCPopup選單::插入分隔符

在指定位置的彈出式功能表中插入分隔符。

```
int InsertSeparator(int iInsertAt = -1);
```

### <a name="parameters"></a>參數

*iInsertAt*<br/>
[在]此方法將插入分隔符的位置的零基索引。

### <a name="return-value"></a>傳回值

插入分隔符的位置的零基索引。 -1 如果此方法失敗。

### <a name="remarks"></a>備註

*iInsertAt*的值為 -1 表示此方法將分隔符添加到彈出式功能表的末尾。

如果*iInsertAt*是無效值,則此方法將失敗。

## <a name="cmfcpopupmenuisalwaysclose"></a><a name="isalwaysclose"></a>CMFC彈出功能表::永遠關閉

```
virtual BOOL IsAlwaysClose() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisalwaysshowemptytoolsentry"></a><a name="isalwaysshowemptytoolsentry"></a>CMFC彈出選單::隨時顯示空工具輸入

```
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuiscustomizepane"></a><a name="iscustomizepane"></a>CMFC彈出選單::是自定義窗格

指示彈出式選單是否充當**快速自訂窗格**。

```
BOOL IsCustomizePane();
```

### <a name="return-value"></a>傳回值

如果彈出視窗是 **「庫克自定義窗格」,** 則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

使用 **「快速自訂窗格**」可使用戶直接自定義彈出式功能表。 **"快速自定義窗格**"`CMFCPopupMenu`是 當使用者按一下工具列按鈕直接編輯工具列時出現的。

您的應用程式應在[CMDIFramewndEx 期間呼叫此方法::在顯示自訂窗格](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)。

## <a name="cmfcpopupmenuisescclose"></a><a name="isescclose"></a>CMFCPopup功能表::Iscclose

```
BOOL IsEscClose();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisidle"></a><a name="isidle"></a>CMFC彈出功能表::空閒

指示彈出式功能表當前是否處於空閒狀態。

```
virtual BOOL IsIdle() const;
```

### <a name="return-value"></a>傳回值

如果彈出式功能表處於空閒模式,則為 TRUE;如果彈出功能表處於空閒狀態,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

默認情況下,如果顯示動畫完成且使用者未滾動彈出視窗功能表,則彈出視窗功能表處於空閒模式。

## <a name="cmfcpopupmenuismenusound"></a><a name="ismenusound"></a>CMFCPopup功能表::IsMenuSound

```
static UINT __stdcall IsMenuSound();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisquickcustomize"></a><a name="isquickcustomize"></a>CMFCPopup功能表::快速定製

確定關聯的[CMFCToolBarMenuButton 類](../../mfc/reference/cmfctoolbarmenubutton-class.md)是否處於快速自定義模式。

```
BOOL IsQuickCustomize();
```

### <a name="return-value"></a>傳回值

如果關聯的功能表按鈕處於快速自定義模式,則為 TRUE;否則 FALSE。 如果彈出式功能表未與關聯,則此方法也將返回`CMFCToolBarMenuButton`FALSE。

### <a name="remarks"></a>備註

在「快速自訂」模式下,用戶選擇工具列上的按鈕以直接自定義該按鈕。

## <a name="cmfcpopupmenuisresizeble"></a><a name="isresizeble"></a>CMFC彈出功能表::可重調整

```
BOOL IsResizeble() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuisrightalign"></a><a name="isrightalign"></a>CMFCPopup功能表::右對齊

指示功能表是右對齊還是左對齊。

```
BOOL IsRightAlign() const;
```

### <a name="return-value"></a>傳回值

如果功能表正確對齊,則為 TRUE;如果功能表左對齊,則 FALSE。

### <a name="remarks"></a>備註

您可以使用[CMFCPopupMenuMenu::設置右對齊](#setrightalign)來設置功能表對齊方式。 默認情況下,彈出式功能表使用左對齊。

功能表對齊不是全域設置,並且可能因彈出式功能表而異。

## <a name="cmfcpopupmenuisscrollable"></a><a name="isscrollable"></a>CMFC彈出功能表::可滾動

```
BOOL IsScrollable() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuissendmenuselectmsg"></a><a name="issendmenuselectmsg"></a>CMFC彈出選單::是傳送選單選擇Mmsg

指示當使用者從彈出式功能表中選擇命令時,框架是否通知父框架。

```
static BOOL IsSendMenuSelectMsg();
```

### <a name="return-value"></a>傳回值

如果框架通知父框架,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當使用者選擇功能表命令時,框架通過向父幀發送WM_MENUSELECT消息來通知父幀。

## <a name="cmfcpopupmenuisshown"></a><a name="isshown"></a>CMFC彈出選單::顯示

指示彈出式功能表當前是否可見。

```
BOOL IsShown() const;
```

### <a name="return-value"></a>傳回值

如果彈出功能表可見,則為 TRUE;否則 FALSE。

## <a name="cmfcpopupmenumoveto"></a><a name="moveto"></a>CMFCPopup功能表::移動到

```
void MoveTo(const CPoint& pt);
```

### <a name="parameters"></a>參數

[在]*pt*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuonchangehot"></a><a name="onchangehot"></a>CMFCPopup功能表::打開

```
virtual void OnChangeHot(int nHot);
```

### <a name="parameters"></a>參數

[在]*nHot*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuonchooseitem"></a><a name="onchooseitem"></a>CMFC彈出功能表::在選擇項目上

```
virtual void OnChooseItem(UINT uidCmdID);
```

### <a name="parameters"></a>參數

[在]*烏伊德·CmdID*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuoncmdmsg"></a><a name="oncmdmsg"></a>CMFCPopupMenu::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

[在]*nID*<br/>
[在]*n代碼*<br/>
[在]*pExtra*<br/>
[在]*pHandlerInfo*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenupostcommand"></a><a name="postcommand"></a>CMFCPopupMenu::Post命令

```
BOOL PostCommand(UINT uiCommandID);
```

### <a name="parameters"></a>參數

[在]*uiCommandID*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenupretranslatemessage"></a><a name="pretranslatemessage"></a>CMFCPopup功能表::P重新翻譯訊息

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>參數

[在]*pMsg*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenurecalclayout"></a><a name="recalclayout"></a>CMFCPopup功能表::Recalclayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

[在]*b 通知*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuremoveallitems"></a><a name="removeallitems"></a>CMFC彈出選單::刪除所有專案

清除彈出功能表中的所有專案。

```
void RemoveAllItems();
```

## <a name="cmfcpopupmenuremoveitem"></a><a name="removeitem"></a>CMFC彈出選單::刪除專案

從彈出式功能表中刪除指定的項。

```
BOOL RemoveItem(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[在]要刪除的項的零基索引。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法會自動排列受項目刪除影響的任何分隔符。 有關框架如何重新排列分隔符的詳細資訊,請參閱[CMFCToolBar:::刪除按鈕](../../mfc/reference/cmfctoolbar-class.md#removebutton)。

## <a name="cmfcpopupmenusavestate"></a><a name="savestate"></a>CMFC彈出選單::儲存狀態

```
virtual void SaveState();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetanimationspeed"></a><a name="setanimationspeed"></a>CMFCPopup功能表::設定動畫速度

設置彈出式功能表的動畫速度。

```
static void SetAnimationSpeed(UINT nElapse);
```

### <a name="parameters"></a>參數

*脫位*<br/>
[在]新的動畫速度,以毫秒為單位。

### <a name="remarks"></a>備註

動畫速度是全域值,會影響應用程式中的所有彈出式功能表。 此值指定動畫完成時長。

默認情況下,此參數設置為 30 毫秒。 *nElapse*的有效值範圍為 0 到 200。

## <a name="cmfcpopupmenusetanimationtype"></a><a name="setanimationtype"></a>CMFC彈出選單::設定動畫類型

設置此彈出式功能表的動畫類型。

```
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```

### <a name="parameters"></a>參數

*型別*<br/>
[在]指定動畫類型的枚舉數據類型。

### <a name="remarks"></a>備註

有關*類型*的有效值清單,請參閱[CMFCPopupMenuMenu::取得動畫類型](#getanimationtype)。

## <a name="cmfcpopupmenusetautodestroy"></a><a name="setautodestroy"></a>CMFC彈出選單::設定自動銷毀

```
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```

### <a name="parameters"></a>參數

[在]*bAuto銷毀*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetdefaultitem"></a><a name="setdefaultitem"></a>CMFC彈出選單::設定預設項目

設置彈出式功能表的預設命令。

```
void SetDefaultItem(UINT uiCmd);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]新預設命令的功能表命令 ID。

### <a name="remarks"></a>備註

彈出式功能表中的預設命令是在彈出功能表出現時選擇的命令。

## <a name="cmfcpopupmenusetforcemenufocus"></a><a name="setforcemenufocus"></a>CMFC彈出選單::設定強制選單焦點

顯示彈出式功能表時,強制輸入焦點返回到功能表欄。

```
static void SetForceMenuFocus(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[在]如果希望框架在顯示彈出式功能表時強制將輸入焦點強制到菜單欄,則為 TRUE。 如果希望彈出功能表保留焦點,則 FALSE。

### <a name="remarks"></a>備註

此方法為應用程式中的所有彈出式功能表設置全域標誌。 默認情況下,此功能未啟用。

## <a name="cmfcpopupmenusetforceshadow"></a><a name="setforceshadow"></a>CMFC彈出功能表::設置力量陰影

當彈出功能表出現在主框架之外時,強制框架繪製功能表陰影。

```
static void SetForceShadow(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[在]如果希望框架繪製功能表陰影,則為 TRUE,否則為 FALSE。

### <a name="remarks"></a>備註

調用此方法時,它會在應用程式中設置全域標誌。 此標誌會影響應用程式中的所有彈出式功能表。

## <a name="cmfcpopupmenusetmaxwidth"></a><a name="setmaxwidth"></a>CMFC彈出選單::設定最大寬度

設置彈出式功能表的最大寬度。

```
void SetMaxWidth(int iMaxWidth);
```

### <a name="parameters"></a>參數

*iMaxWidth*<br/>
[在]彈出式功能表的最大寬度(以像素為單位)。

### <a name="remarks"></a>備註

如果與功能表命令關聯的文本不能包含最大寬度,則該文本將被截斷,不適合的零件將替換為三個點。

## <a name="cmfcpopupmenusetmessagewnd"></a><a name="setmessagewnd"></a>CMFCPopup功能表::設定消息

```
void SetMessageWnd(CWnd* pMsgWnd);
```

### <a name="parameters"></a>參數

[在]*pMsgwnd*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetparentribbonelement"></a><a name="setparentribbonelement"></a>CMFCPopup功能表::設定父功能區元素

```
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```

### <a name="parameters"></a>參數

[在]*佩萊姆*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetquickcustomizetype"></a><a name="setquickcustomizetype"></a>CMFC彈出選單::設定快速自定義類型

```
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```

### <a name="parameters"></a>參數

[在]*類型*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetquickmode"></a><a name="setquickmode"></a>CMFC彈出選單::設定快速模式

```
void SetQuickMode();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenusetrightalign"></a><a name="setrightalign"></a>CMFC彈出功能表::設定正確對齊

設置彈出式功能表的功能表對齊方式。

```
void SetRightAlign(BOOL bRightAlign = TRUE);
```

### <a name="parameters"></a>參數

*b 右對齊*<br/>
[在]指示功能表對齊的布爾。 TRUE 表示右對齊,FALSE 表示左對齊。

### <a name="remarks"></a>備註

默認情況下,所有彈出式功能表都左對齊。

## <a name="cmfcpopupmenusetsendmenuselectmsg"></a><a name="setsendmenuselectmsg"></a>CMFC彈出選單::設定傳送選單選擇Mmsg

設置一個標誌,用於控制當用戶選擇命令時彈出功能表是否通知其父框架。

```
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]如果彈出式功能表通知其父框架,則為 TRUE,否則為 FALSE。

### <a name="remarks"></a>備註

這是應用程式中所有彈出式功能表的全域選項。 如果啟用,則當用戶選擇命令時,彈出式功能表將向父幀發送WM_MENUSELECT消息。

## <a name="cmfcpopupmenushowallcommands"></a><a name="showallcommands"></a>CMFC彈出選單::顯示所有命令

強制彈出功能表顯示所有命令。

```
void ShowAllCommands();
```

### <a name="remarks"></a>備註

這不是全域設置,僅影響當前彈出功能表。

## <a name="cmfcpopupmenutriggerresize"></a><a name="triggerresize"></a>CMFC彈出功能表::觸發調整

```
void TriggerResize();
```

### <a name="remarks"></a>備註

## <a name="cmfcpopupmenuupdateallshadows"></a><a name="updateallshadows"></a>CMFC彈出功能表::更新所有陰影

更新所有打開的彈出式功能表的陰影。

```
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>參數

*lprect 螢幕*<br/>
[在]指定要更新的區域的矩形,位於螢幕座標中。

### <a name="remarks"></a>備註

當彈出式功能表顯示在動畫控制件或其他具有動態內容的視窗時,此方法很有用。

## <a name="cmfcpopupmenuupdateshadow"></a><a name="updateshadow"></a>CMFC彈出功能表::更新陰影

更新彈出式功能表的影子。

```
void UpdateShadow(LPRECT lprectScreen = NULL);
```

### <a name="parameters"></a>參數

*lprect 螢幕*<br/>
[在]螢幕座標中指定要更新的區域邊界的矩形。

### <a name="remarks"></a>備註

當具有陰影的彈出式功能表與動畫圖像重疊時,調用此方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)
