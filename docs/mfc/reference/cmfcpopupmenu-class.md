---
title: CMFCPopupMenu 類別 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::CMFCPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::ActivatePopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::AlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::AreAllCommandsShown
- AFXPOPUPMENU/CMFCPopupMenu::CheckArea
- AFXPOPUPMENU/CMFCPopupMenu::CloseMenu
- AFXPOPUPMENU/CMFCPopupMenu::Create
- AFXPOPUPMENU/CMFCPopupMenu::DefaultMouseClickOnClose
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuLogo
- AFXPOPUPMENU/CMFCPopupMenu::EnableMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::EnableResize
- AFXPOPUPMENU/CMFCPopupMenu::EnableScrolling
- AFXPOPUPMENU/CMFCPopupMenu::EnableVertResize
- AFXPOPUPMENU/CMFCPopupMenu::FindSubItemByCommand
- AFXPOPUPMENU/CMFCPopupMenu::GetActiveMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::GetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::GetDropDirection
- AFXPOPUPMENU/CMFCPopupMenu::GetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::GetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::GetHMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuBar
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItem
- AFXPOPUPMENU/CMFCPopupMenu::GetMenuItemCount
- AFXPOPUPMENU/CMFCPopupMenu::GetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::GetParentArea
- AFXPOPUPMENU/CMFCPopupMenu::GetParentButton
- AFXPOPUPMENU/CMFCPopupMenu::GetParentPopupMenu
- AFXPOPUPMENU/CMFCPopupMenu::GetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::GetParentToolBar
- AFXPOPUPMENU/CMFCPopupMenu::GetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::GetSelItem
- AFXPOPUPMENU/CMFCPopupMenu::HasBeenResized
- AFXPOPUPMENU/CMFCPopupMenu::HideRarelyUsedCommands
- AFXPOPUPMENU/CMFCPopupMenu::InCommand
- AFXPOPUPMENU/CMFCPopupMenu::InsertItem
- AFXPOPUPMENU/CMFCPopupMenu::InsertSeparator
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysClose
- AFXPOPUPMENU/CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry
- AFXPOPUPMENU/CMFCPopupMenu::IsCustomizePane
- AFXPOPUPMENU/CMFCPopupMenu::IsEscClose
- AFXPOPUPMENU/CMFCPopupMenu::IsIdle
- AFXPOPUPMENU/CMFCPopupMenu::IsMenuSound
- AFXPOPUPMENU/CMFCPopupMenu::IsQuickCustomize
- AFXPOPUPMENU/CMFCPopupMenu::IsResizeble
- AFXPOPUPMENU/CMFCPopupMenu::IsRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::IsScrollable
- AFXPOPUPMENU/CMFCPopupMenu::IsSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::IsShown
- AFXPOPUPMENU/CMFCPopupMenu::MoveTo
- AFXPOPUPMENU/CMFCPopupMenu::OnCmdMsg
- AFXPOPUPMENU/CMFCPopupMenu::PostCommand
- AFXPOPUPMENU/CMFCPopupMenu::PreTranslateMessage
- AFXPOPUPMENU/CMFCPopupMenu::RecalcLayout
- AFXPOPUPMENU/CMFCPopupMenu::RemoveAllItems
- AFXPOPUPMENU/CMFCPopupMenu::RemoveItem
- AFXPOPUPMENU/CMFCPopupMenu::SaveState
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationSpeed
- AFXPOPUPMENU/CMFCPopupMenu::SetAnimationType
- AFXPOPUPMENU/CMFCPopupMenu::SetAutoDestroy
- AFXPOPUPMENU/CMFCPopupMenu::SetDefaultItem
- AFXPOPUPMENU/CMFCPopupMenu::SetForceMenuFocus
- AFXPOPUPMENU/CMFCPopupMenu::SetForceShadow
- AFXPOPUPMENU/CMFCPopupMenu::SetMaxWidth
- AFXPOPUPMENU/CMFCPopupMenu::SetMessageWnd
- AFXPOPUPMENU/CMFCPopupMenu::SetParentRibbonElement
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickCustomizeType
- AFXPOPUPMENU/CMFCPopupMenu::SetQuickMode
- AFXPOPUPMENU/CMFCPopupMenu::SetRightAlign
- AFXPOPUPMENU/CMFCPopupMenu::SetSendMenuSelectMsg
- AFXPOPUPMENU/CMFCPopupMenu::ShowAllCommands
- AFXPOPUPMENU/CMFCPopupMenu::TriggerResize
- AFXPOPUPMENU/CMFCPopupMenu::UpdateAllShadows
- AFXPOPUPMENU/CMFCPopupMenu::UpdateShadow
- AFXPOPUPMENU/CMFCPopupMenu::CreateTearOffBar
- AFXPOPUPMENU/CMFCPopupMenu::OnChangeHot
- AFXPOPUPMENU/CMFCPopupMenu::OnChooseItem
dev_langs:
- C++
helpviewer_keywords:
- CMFCPopupMenu [MFC], CMFCPopupMenu
- CMFCPopupMenu [MFC], ActivatePopupMenu
- CMFCPopupMenu [MFC], AlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], AreAllCommandsShown
- CMFCPopupMenu [MFC], CheckArea
- CMFCPopupMenu [MFC], CloseMenu
- CMFCPopupMenu [MFC], Create
- CMFCPopupMenu [MFC], DefaultMouseClickOnClose
- CMFCPopupMenu [MFC], EnableMenuLogo
- CMFCPopupMenu [MFC], EnableMenuSound
- CMFCPopupMenu [MFC], EnableResize
- CMFCPopupMenu [MFC], EnableScrolling
- CMFCPopupMenu [MFC], EnableVertResize
- CMFCPopupMenu [MFC], FindSubItemByCommand
- CMFCPopupMenu [MFC], GetActiveMenu
- CMFCPopupMenu [MFC], GetAnimationSpeed
- CMFCPopupMenu [MFC], GetAnimationType
- CMFCPopupMenu [MFC], GetDropDirection
- CMFCPopupMenu [MFC], GetForceMenuFocus
- CMFCPopupMenu [MFC], GetForceShadow
- CMFCPopupMenu [MFC], GetHMenu
- CMFCPopupMenu [MFC], GetMenuBar
- CMFCPopupMenu [MFC], GetMenuItem
- CMFCPopupMenu [MFC], GetMenuItemCount
- CMFCPopupMenu [MFC], GetMessageWnd
- CMFCPopupMenu [MFC], GetParentArea
- CMFCPopupMenu [MFC], GetParentButton
- CMFCPopupMenu [MFC], GetParentPopupMenu
- CMFCPopupMenu [MFC], GetParentRibbonElement
- CMFCPopupMenu [MFC], GetParentToolBar
- CMFCPopupMenu [MFC], GetQuickCustomizeType
- CMFCPopupMenu [MFC], GetSelItem
- CMFCPopupMenu [MFC], HasBeenResized
- CMFCPopupMenu [MFC], HideRarelyUsedCommands
- CMFCPopupMenu [MFC], InCommand
- CMFCPopupMenu [MFC], InsertItem
- CMFCPopupMenu [MFC], InsertSeparator
- CMFCPopupMenu [MFC], IsAlwaysClose
- CMFCPopupMenu [MFC], IsAlwaysShowEmptyToolsEntry
- CMFCPopupMenu [MFC], IsCustomizePane
- CMFCPopupMenu [MFC], IsEscClose
- CMFCPopupMenu [MFC], IsIdle
- CMFCPopupMenu [MFC], IsMenuSound
- CMFCPopupMenu [MFC], IsQuickCustomize
- CMFCPopupMenu [MFC], IsResizeble
- CMFCPopupMenu [MFC], IsRightAlign
- CMFCPopupMenu [MFC], IsScrollable
- CMFCPopupMenu [MFC], IsSendMenuSelectMsg
- CMFCPopupMenu [MFC], IsShown
- CMFCPopupMenu [MFC], MoveTo
- CMFCPopupMenu [MFC], OnCmdMsg
- CMFCPopupMenu [MFC], PostCommand
- CMFCPopupMenu [MFC], PreTranslateMessage
- CMFCPopupMenu [MFC], RecalcLayout
- CMFCPopupMenu [MFC], RemoveAllItems
- CMFCPopupMenu [MFC], RemoveItem
- CMFCPopupMenu [MFC], SaveState
- CMFCPopupMenu [MFC], SetAnimationSpeed
- CMFCPopupMenu [MFC], SetAnimationType
- CMFCPopupMenu [MFC], SetAutoDestroy
- CMFCPopupMenu [MFC], SetDefaultItem
- CMFCPopupMenu [MFC], SetForceMenuFocus
- CMFCPopupMenu [MFC], SetForceShadow
- CMFCPopupMenu [MFC], SetMaxWidth
- CMFCPopupMenu [MFC], SetMessageWnd
- CMFCPopupMenu [MFC], SetParentRibbonElement
- CMFCPopupMenu [MFC], SetQuickCustomizeType
- CMFCPopupMenu [MFC], SetQuickMode
- CMFCPopupMenu [MFC], SetRightAlign
- CMFCPopupMenu [MFC], SetSendMenuSelectMsg
- CMFCPopupMenu [MFC], ShowAllCommands
- CMFCPopupMenu [MFC], TriggerResize
- CMFCPopupMenu [MFC], UpdateAllShadows
- CMFCPopupMenu [MFC], UpdateShadow
- CMFCPopupMenu [MFC], CreateTearOffBar
- CMFCPopupMenu [MFC], OnChangeHot
- CMFCPopupMenu [MFC], OnChooseItem
ms.assetid: 9555dca1-8c9c-44c9-af72-0659ddad128e
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 3b80dbc4383b18f3e8183ae06d2259398b5e1223
ms.sourcegitcommit: 26fff80635bd1d51bc51899203fddfea8b29b530
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/05/2018
ms.locfileid: "37852545"
---
# <a name="cmfcpopupmenu-class"></a>CMFCPopupMenu 類別
實作 Windows 快顯功能表功能，並加入功能 (例如 Tear-Off 功能表和工具提示) 進行擴充。
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]    
  
## <a name="syntax"></a>語法  
  
```  
class CMFCPopupMenu : public CMiniFrameWnd  
```  
  
## <a name="members"></a>成員  
  
### <a name="protected-constructors"></a>受保護的建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::CMFCPopupMenu](#cmfcpopupmenu)|建構 `CMFCPopupMenu` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::ActivatePopupMenu](#activatepopupmenu)||  
|[CMFCPopupMenu::AlwaysShowEmptyToolsEntry](#alwaysshowemptytoolsentry)|設定是否啟用快顯功能表來顯示使用者定義類型的空項目。|  
|[CMFCPopupMenu::AreAllCommandsShown](#areallcommandsshown)||  
|[CMFCPopupMenu::CheckArea](#checkarea)|決定一個點相對的快顯功能表的位置。|  
|[CMFCPopupMenu::CloseMenu](#closemenu)||  
|[CMFCPopupMenu::Create](#create)|建立快顯功能表，並將它附加至`CMFCPopupMenu`物件。|  
|[CMFCPopupMenu::DefaultMouseClickOnClose](#defaultmouseclickonclose)||  
|[CMFCPopupMenu::EnableMenuLogo](#enablemenulogo)|初始化快顯功能表的標誌。|  
|[CMFCPopupMenu::EnableMenuSound](#enablemenusound)|可讓功能表的音效。|  
|[CMFCPopupMenu::EnableResize](#enableresize)||  
|[CMFCPopupMenu::EnableScrolling](#enablescrolling)||  
|[CMFCPopupMenu::EnableVertResize](#enablevertresize)||  
|[CMFCPopupMenu::FindSubItemByCommand](#findsubitembycommand)||  
|[CMFCPopupMenu::GetActiveMenu](#getactivemenu)|傳回目前使用中的功能表。|  
|[CMFCPopupMenu::GetAnimationSpeed](#getanimationspeed)|傳回快顯功能表的動畫速度。|  
|[CMFCPopupMenu::GetAnimationType](#getanimationtype)|傳回目前的快顯功能表的動畫類型。|  
|[CMFCPopupMenu::GetDropDirection](#getdropdirection)||  
|[CMFCPopupMenu::GetForceMenuFocus](#getforcemenufocus)|表示是否要將焦點傳回至功能表列的快顯功能表顯示時。|  
|[CMFCPopupMenu::GetForceShadow](#getforceshadow)||  
|[CMFCPopupMenu::GetHMenu](#gethmenu)|傳回附加的功能表資源的控制代碼。|  
|[CMFCPopupMenu::GetMenuBar](#getmenubar)|傳回[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)內嵌在快顯功能表。|  
|[CMFCPopupMenu::GetMenuItem](#getmenuitem)|讓指標回到指定的索引處的功能表項目。|  
|[CMFCPopupMenu::GetMenuItemCount](#getmenuitemcount)|在快顯功能表中，傳回的項目數。|  
|[CMFCPopupMenu::GetMessageWnd](#getmessagewnd)|讓指標回到的視窗，架構會將路由快顯功能表訊息。|  
|[CMFCPopupMenu::GetParentArea](#getparentarea)||  
|[CMFCPopupMenu::GetParentButton](#getparentbutton)|讓指標回到父工具列按鈕。|  
|[CMFCPopupMenu::GetParentPopupMenu](#getparentpopupmenu)|讓指標回到父快顯功能表。|  
|[CMFCPopupMenu::GetParentRibbonElement](#getparentribbonelement)||  
|[CMFCPopupMenu::GetParentToolBar](#getparenttoolbar)|傳回為父工具列的指標。|  
|[CMFCPopupMenu::GetQuickCustomizeType](#getquickcustomizetype)||  
|[CMFCPopupMenu::GetSelItem](#getselitem)|讓指標回到目前選取的功能表命令。|  
|[CMFCPopupMenu::HasBeenResized](#hasbeenresized)||  
|[CMFCPopupMenu::HideRarelyUsedCommands](#hiderarelyusedcommands)|表示快顯功能表是否可以隱藏很少使用的命令。|  
|[CMFCPopupMenu::InCommand](#incommand)||  
|[CMFCPopupMenu::InsertItem](#insertitem)|在指定的位置快顯功能表中插入新項目。|  
|[CMFCPopupMenu::InsertSeparator](#insertseparator)|插入指定位置的快顯功能表中的分隔符號。|  
|[CMFCPopupMenu::IsAlwaysClose](#isalwaysclose)||  
|[CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry](#isalwaysshowemptytoolsentry)||  
|[CMFCPopupMenu::IsCustomizePane](#iscustomizepane)|指出是否有快顯功能表當作**QuickCustomizePane**。|  
|[CMFCPopupMenu::IsEscClose](#isescclose)||  
|[CMFCPopupMenu::IsIdle](#isidle)|指出快顯功能表是否目前處於閒置狀態。|  
|[CMFCPopupMenu::IsMenuSound](#ismenusound)||  
|[CMFCPopupMenu::IsQuickCustomize](#isquickcustomize)|決定是否相關聯[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)處於 QuickCustomize 模式。|  
|[CMFCPopupMenu::IsResizeble](#isresizeble)||  
|[CMFCPopupMenu::IsRightAlign](#isrightalign)|指出功能表是否靠右或靠左對齊。|  
|[CMFCPopupMenu::IsScrollable](#isscrollable)||  
|[CMFCPopupMenu::IsSendMenuSelectMsg](#issendmenuselectmsg)|指出當使用者從快顯功能表中選取的命令時，framework 是否通知父框架。|  
|[CMFCPopupMenu::IsShown](#isshown)|指出是否為目前可看見快顯功能表。|  
|[CMFCPopupMenu::MoveTo](#moveto)||  
|[CMFCPopupMenu::OnCmdMsg](#oncmdmsg)|(覆寫 `CFrameWnd::OnCmdMsg`。)|  
|[CMFCPopupMenu::PostCommand](#postcommand)||  
|[CMFCPopupMenu::PreTranslateMessage](#pretranslatemessage)|(覆寫 `CFrameWnd::PreTranslateMessage`。)|  
|[CMFCPopupMenu::RecalcLayout](#recalclayout)|當標準主控項列切換為開或關或框架視窗調整大小時，由架構呼叫。 (覆寫[CFrameWnd::RecalcLayout](../../mfc/reference/cframewnd-class.md#recalclayout)。)|  
|[CMFCPopupMenu::RemoveAllItems](#removeallitems)|清除快顯功能表中的所有項目。|  
|[CMFCPopupMenu::RemoveItem](#removeitem)|從快顯功能表中移除指定的項目。|  
|[CMFCPopupMenu::SaveState](#savestate)||  
|[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)|設定快顯功能表的動畫速度。|  
|[CMFCPopupMenu::SetAnimationType](#setanimationtype)|設定快顯功能表的動畫類型。|  
|[CMFCPopupMenu::SetAutoDestroy](#setautodestroy)||  
|[CMFCPopupMenu::SetDefaultItem](#setdefaultitem)|設定快顯功能表的預設命令。|  
|[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)|會強制以返回 功能表列的快顯功能表出現時輸入的焦點。|  
|[CMFCPopupMenu::SetForceShadow](#setforceshadow)|強制主框架外的快顯功能表出現時，繪製功能表陰影的架構。|  
|[CMFCPopupMenu::SetMaxWidth](#setmaxwidth)|設定快顯功能表的最大寬度。|  
|[CMFCPopupMenu::SetMessageWnd](#setmessagewnd)||  
|[CMFCPopupMenu::SetParentRibbonElement](#setparentribbonelement)||  
|[CMFCPopupMenu::SetQuickCustomizeType](#setquickcustomizetype)||  
|[CMFCPopupMenu::SetQuickMode](#setquickmode)||  
|[CMFCPopupMenu::SetRightAlign](#setrightalign)|設定快顯功能表的功能表對齊方式。|  
|[CMFCPopupMenu::SetSendMenuSelectMsg](#setsendmenuselectmsg)|設定會控制當使用者選取命令時，快顯功能表是否告知其父框架的旗標。|  
|[CMFCPopupMenu::ShowAllCommands](#showallcommands)|會強制快顯功能表以顯示所有命令。|  
|[CMFCPopupMenu::TriggerResize](#triggerresize)||  
|[CMFCPopupMenu::UpdateAllShadows](#updateallshadows)|更新所有開啟的快顯功能表的陰影。|  
|[CMFCPopupMenu::UpdateShadow](#updateshadow)|更新快顯功能表的陰影。|  
  
### <a name="protected-methods"></a>保護方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCPopupMenu::CreateTearOffBar](#createtearoffbar)||  
|[CMFCPopupMenu::OnChangeHot](#onchangehot)||  
|[CMFCPopupMenu::OnChooseItem](#onchooseitem)||  
  
### <a name="remarks"></a>備註  
 一般來說，MFC 會自動建立快顯功能表。 如果您想要建立`CMFCPopupMenu`手動物件，配置在堆積上的其中一個，然後呼叫[CMFCPopupMenu::Create](#create)。  
  
## <a name="example"></a>範例  
 下列範例示範如何設定快顯功能表物件。 此範例示範如何設定標誌和快顯功能表的音效、 設定動畫的速度和類型、 繪製功能表陰影主框架外的快顯功能表出現時，設定的最大寬度，並設定快顯功能表的右邊的功能表對齊。 此程式碼片段是一部分[自訂頁面範例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_CustomPages#2](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 [CFrameWnd](../../mfc/reference/cframewnd-class.md)  
  
 [CMiniFrameWnd](../../mfc/reference/cminiframewnd-class.md)  
  
 `CMFCPopupMenu`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxpopupmenu.h  
  
##  <a name="activatepopupmenu"></a>  CMFCPopupMenu::ActivatePopupMenu  

  
```  
static BOOL __stdcall ActivatePopupMenu(
    CFrameWnd* pTopFrame,  
    CMFCPopupMenu* pPopupMenu);
```  
  
### <a name="parameters"></a>參數  
 [in]*pTopFrame*  
 [in]*pPopupMenu*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="alwaysshowemptytoolsentry"></a>  CMFCPopupMenu::AlwaysShowEmptyToolsEntry  
 設定是否啟用快顯功能表來顯示使用者定義類型的空項目。  
  
```  
static void AlwaysShowEmptyToolsEntry(BOOL bShow = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bShow*  
 如果快顯功能表可顯示空的項目，則為 TRUEFALSE 否則。  
  
##  <a name="areallcommandsshown"></a>  CMFCPopupMenu::AreAllCommandsShown  

  
```  
BOOL AreAllCommandsShown() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="checkarea"></a>  CMFCPopupMenu::CheckArea  
 決定一個點相對的快顯功能表的位置。  
  
```  
MENUAREA_TYPE CheckArea(const CPoint& ptScreen) const;  
```  
  
### <a name="parameters"></a>參數  
 [in]*ptScreen*  
 螢幕座標中的點。  
  
### <a name="return-value"></a>傳回值  
 表示相對於快顯功能表中的點所在的 MENUAREA_TYPE 參數。  
  
### <a name="remarks"></a>備註  
 MENUAREA_TYPE 參數可以有下列值之一。  
  
-   外部- *ptScreen*超出快顯功能表。  
  
-   標誌- *ptScreen*標誌區域上方。  
  
-   TEAROFF_CAPTION- *ptScreen*分割標題上方。  
  
-   SHADOW_BOTTOM- *ptScreen*是透過快顯功能表的底部陰影。  
  
-   SHADOW_RIGHT- *ptScreen*是透過快顯功能表的陰影。  
  
-   功能表中， *ptScreen*是透過命令。  
  
##  <a name="closemenu"></a>  CMFCPopupMenu::CloseMenu  

  
```  
void CloseMenu(BOOL bSetFocusToBar = FALSE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bSetFocusToBar*  
  
### <a name="remarks"></a>備註  
  
##  <a name="cmfcpopupmenu"></a>  CMFCPopupMenu::CMFCPopupMenu  
 建構[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件。  
  
```  
CMFCPopupMenu(
    CMFCToolBarsMenuPropertyPage* pCustPage,  
    LPCTSTR lpszTitle);
```  
  
### <a name="parameters"></a>參數  
 [in]*pCustPage*  
 自訂頁面指標。  
  
 [in]*lpszTitle*  
 包含的功能表標題的字串。  
  
### <a name="remarks"></a>備註  
 這個方法會配置的資源`CMFCPopupMenu`。 若要建立快顯功能表項目，呼叫[CMFCPopupMenu::Create](#create)。  
  
##  <a name="create"></a>  CMFCPopupMenu::Create  
 建立快顯功能表，並將它附加至[CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件。  
  
```  
virtual BOOL Create(
    CWnd* pWndParent,  
    int x,  
    int y,  
    HMENU hMenu,  
    BOOL bLocked = FALSE,  
    BOOL bOwnMessage = FALSE);
```  
  
### <a name="parameters"></a>參數  
 [in]*pWndParent*  
 父視窗`CMFCPopupMenu`。  
  
 [in]*x*  
 水平螢幕座標，快顯功能表的位置  
  
 [in]*y*  
 快顯功能表的位置的垂直螢幕座標。  
  
 [in]*hMenu*  
 功能表資源控制代碼。  
  
 [in]*封鎖*  
 布林值參數，指出功能表是否可自訂。 FALSE 表示快顯功能表自訂。  
  
 [in]*bOwnMessage*  
 布林值參數，指出如何架構會將路由的功能表訊息。 請參閱 < 備註 > 一節，如需詳細資訊。  
  
### <a name="return-value"></a>傳回值  
 如果方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 如果*bOwnMessage*為 TRUE 時，framework 路由至任何功能表訊息*pWndParent*。 *pWndParent*不得為 NULL，如果*bOwnMessage*為 TRUE。 如果*bOwnMessage*為 FALSE 時，framework 路由至父快顯功能表的功能表訊息。  
  
### <a name="example"></a>範例  
 下列範例示範如何使用`Create`方法的`CMFCPopuMenu`類別。 此程式碼片段是一部分[自訂頁面範例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_CustomPages#1](../../mfc/reference/codesnippet/cpp/cmfcpopupmenu-class_2.cpp)]  
  
##  <a name="createtearoffbar"></a>  CMFCPopupMenu::CreateTearOffBar  

  
```  
virtual CPane* CreateTearOffBar(
    CFrameWnd* pWndMain,  
    UINT uiID,  
    LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>參數  
 [in]*pWndMain*  
 [in]*uiID*  
 [in]*lpszName*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="defaultmouseclickonclose"></a>  CMFCPopupMenu::DefaultMouseClickOnClose  

  
```  
virtual BOOL DefaultMouseClickOnClose() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="enablemenulogo"></a>  CMFCPopupMenu::EnableMenuLogo  
 初始化快顯功能表的標誌。  
  
```  
void EnableMenuLogo(
    int iLogoSize,  
    LOGO_LOCATION nLogoLocation = MENU_LOGO_LEFT);
```  
  
### <a name="parameters"></a>參數  
 [in]*iLogoSize*  
 標誌，像素為單位的大小。  
  
 [in]*nLogoLocation*  
 列舉的資料類型，表示標誌的位置。  
  
### <a name="remarks"></a>備註  
 若要顯示的標誌，實作方法[CFrameWndEx::OnDrawMenuLogo](../../mfc/reference/cframewndex-class.md#ondrawmenulogo)主框架視窗中。  
  
 可能值*nLogoLocation* MENU_LOGO_LEFT、 MENU_LOGO_RIGHT、 MENU_LOGO_TOP，和 MENU_LOGO_BOTTOM。  
  
##  <a name="enablemenusound"></a>  CMFCPopupMenu::EnableMenuSound  
 可讓功能表的音效。  
  
```  
static void EnableMenuSound(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bEnable*  
 否則為 FALSE 啟用音效，則為 TRUE。  
  
### <a name="remarks"></a>備註  
 如果您啟用音效，架構會呼叫[PlaySound](http://msdn.microsoft.com/library/windows/desktop/bb774426)方法，當使用者開啟快顯功能表，或選取功能表命令。 根據預設，會啟用這項功能。  
  
##  <a name="enableresize"></a>  CMFCPopupMenu::EnableResize  

  
```  
void EnableResize(CSize sizeMinResize);
```  
  
### <a name="parameters"></a>參數  
 [in]*sizeMinResize*  
  
### <a name="remarks"></a>備註  
  
##  <a name="enablescrolling"></a>  CMFCPopupMenu::EnableScrolling  

  
```  
void EnableScrolling(BOOL = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*BOOL*  
  
### <a name="remarks"></a>備註  
  
##  <a name="enablevertresize"></a>  CMFCPopupMenu::EnableVertResize  

  
```  
void EnableVertResize(int nMinResize);
```  
  
### <a name="parameters"></a>參數  
 [in]*nMinResize*  
  
### <a name="remarks"></a>備註  
  
##  <a name="findsubitembycommand"></a>  CMFCPopupMenu::FindSubItemByCommand  

  
```  
CMFCToolBarMenuButton* FindSubItemByCommand(UINT uiCmd) const;  
```  
  
### <a name="parameters"></a>參數  
 [in]*uiCmd*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getactivemenu"></a>  CMFCPopupMenu::GetActiveMenu  
 傳回目前使用中的功能表。  
  
```  
static CMFCPopupMenu* GetActiveMenu();
```  
  
### <a name="return-value"></a>傳回值  
 作用中的快顯功能表或如果沒有快顯功能表是目前作用中的 NULL 指標。  
  
### <a name="remarks"></a>備註  
 每個應用程式可以有最多一個作用中快顯功能表。  
  
##  <a name="getanimationspeed"></a>  CMFCPopupMenu::GetAnimationSpeed  
 傳回快顯功能表的動畫速度。  
  
```  
static UINT GetAnimationSpeed();
```  
  
### <a name="return-value"></a>傳回值  
 整數，表示的時間，以毫秒為單位，完成所需的快顯功能表的動畫。  
  
### <a name="remarks"></a>備註  
 動畫速度是一個全域值。 使用[CMFCPopupMenu::SetAnimationSpeed](#setanimationspeed)來變更快顯功能表的動畫速度。  
  
##  <a name="getanimationtype"></a>  CMFCPopupMenu::GetAnimationType  
 傳回目前的快顯動畫類型。  
  
```  
static CMFCPopupMenu::ANIMATION_TYPE GetAnimationType(BOOL bNoSystem = FALSE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bNoSystem*  
 布林值參數，指出是否此方法會檢查的全域值。 若要讓此方法以傳回動畫樣式，這個執行個體，則為 FALSE。 [CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)。  
  
### <a name="return-value"></a>傳回值  
 描述動畫類型的列舉的值。  
  
### <a name="remarks"></a>備註  
 針對快顯功能表樣式是動畫的全域應用程式。 使用[CMFCPopupMenu::SetAnimationType](#setanimationtype)來設定動畫樣式。  
  
 下表列出可能的動畫類型。  
  
 NO_ANIMATION  
 快顯功能表沒有建立動畫，並會立即顯示。  
  
 展開  
 此架構會顯示快顯功能表從左上角到右下角。  
  
 投影片  
 快顯功能表會從上往下。  
  
 淡出  
 第一次出現 透明快顯功能表，並逐漸 solidifies。  
  
##  <a name="getdropdirection"></a>  CMFCPopupMenu::GetDropDirection  

  
```  
DROP_DIRECTION GetDropDirection() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getforcemenufocus"></a>  CMFCPopupMenu::GetForceMenuFocus  
 表示是否要將焦點傳回至功能表列的快顯功能表顯示時。  
  
```  
static BOOL GetForceMenuFocus();
```  
  
### <a name="return-value"></a>傳回值  
 如果會顯示快顯功能表; 時，將會傳回至功能表列的輸入的焦點，則為 TRUE。如果快顯功能表保留焦點，則為 FALSE。  
  
### <a name="remarks"></a>備註  
 根據預設，您的應用程式不會傳回焦點功能表列。 若要變更此設定，請使用[CMFCPopupMenu::SetForceMenuFocus](#setforcemenufocus)。  
  
##  <a name="getforceshadow"></a>  CMFCPopupMenu::GetForceShadow  

  
```  
static BOOL __stdcall GetForceShadow();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="gethmenu"></a>  CMFCPopupMenu::GetHMenu  
 傳回附加的功能表資源的控制代碼。  
  
```  
HMENU GetHMenu();
```  
  
##  <a name="getmenubar"></a>  CMFCPopupMenu::GetMenuBar  
 傳回[CMFCPopupMenuBar](../../mfc/reference/cmfcpopupmenubar-class.md)內嵌在快顯功能表。  
  
```  
virtual CMFCPopupMenuBar* GetMenuBar();
```  
  
### <a name="return-value"></a>傳回值  
 內嵌的指標`CMFCPopupMenuBar`。  
  
### <a name="remarks"></a>備註  
 快顯功能表已內嵌`CMFCPopupMenuBar`物件。 如果您使用不同的內嵌的類別，您必須覆寫這個方法在衍生類別中。  
  
##  <a name="getmenuitem"></a>  CMFCPopupMenu::GetMenuItem  
 讓指標回到指定的索引處的功能表項目。  
  
```  
CMFCToolBarMenuButton* GetMenuItem(int iIndex) const;  
```  
  
### <a name="parameters"></a>參數  
 [in]*iIndex*  
 功能表項目的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 功能表項目的指標。 如果索引無效，則為 NULL。  
  
### <a name="remarks"></a>備註  
 功能表項目都由[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)。 當您呼叫這個方法時，它讓指標回到適當`CMFCToolBarMenuButton`。  
  
##  <a name="getmenuitemcount"></a>  CMFCPopupMenu::GetMenuItemCount  
 傳回快顯功能表中的項目數目。  
  
```  
int GetMenuItemCount() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在功能表中的項目數目。  
  
##  <a name="getmessagewnd"></a>  CMFCPopupMenu::GetMessageWnd  
 讓指標回到的視窗，架構會將路由快顯功能表訊息。  
  
```  
CWnd* GetMessageWnd() const;  
```  
  
### <a name="return-value"></a>傳回值  
 接收快顯功能表訊息視窗的指標如果沒有任何視窗，則為 NULL。  
  
### <a name="remarks"></a>備註  
 當您使用的方法[CMFCPopupMenu::Create](#create)若要建立快顯功能表，您指定哪些視窗接收到的功能表訊息。  
  
##  <a name="getparentarea"></a>  CMFCPopupMenu::GetParentArea  

  
```  
virtual CWnd* GetParentArea(CRect& rectParentBtn);
```  
  
### <a name="parameters"></a>參數  
 [in]*rectParentBtn*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getparentbutton"></a>  CMFCPopupMenu::GetParentButton  
 讓指標回到父工具列按鈕。  
  
```  
CMFCToolBarMenuButton* GetParentButton() const;  
```  
  
### <a name="return-value"></a>傳回值  
 [父] 工具列按鈕指標。 如果快顯功能表已沒有 [父] 工具列按鈕，則為 NULL。  
  
### <a name="remarks"></a>備註  
 A`CMFCPopupMenu`可以是 [] 功能表上的按鈕相關聯。 在此案例中，當使用者選取 [父] 工具列按鈕，會出現快顯功能表。  
  
 如果快顯功能表的捷徑功能表，會有任何父工具列按鈕。  
  
##  <a name="getparentpopupmenu"></a>  CMFCPopupMenu::GetParentPopupMenu  
 讓指標回到父快顯功能表。  
  
```  
CMFCPopupMenu* GetParentPopupMenu() const;  
```  
  
### <a name="return-value"></a>傳回值  
 父代指標`CMFCPopupMenu`物件;如果沒有父快顯功能表，則為 NULL。  
  
### <a name="remarks"></a>備註  
 快顯功能表有父代`CMFCPopupMenu`物件是否為子功能表。  
  
##  <a name="getparentribbonelement"></a>  CMFCPopupMenu::GetParentRibbonElement  

  
```  
CMFCRibbonBaseElement* GetParentRibbonElement() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getparenttoolbar"></a>  CMFCPopupMenu::GetParentToolBar  
 傳回為父工具列的指標。  
  
```  
CMFCToolBar* GetParentToolBar() const;  
```  
  
### <a name="return-value"></a>傳回值  
 為父工具列指標。 如果快顯功能表還包含沒有父工具列，則為 NULL。  
  
### <a name="remarks"></a>備註  
 如果`CMFCPopupMenu`是快顯功能表，它將包含沒有父工具列。  
  
##  <a name="getquickcustomizetype"></a>  CMFCPopupMenu::GetQuickCustomizeType  

  
```  
QUICK_CUSTOMIZE_TYPE GetQuickCustomizeType() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getselitem"></a>  CMFCPopupMenu::GetSelItem  
 讓指標回到目前選取的功能表命令。  
  
```  
CMFCToolBarMenuButton* GetSelItem();
```  
  
### <a name="return-value"></a>傳回值  
 指向目前選取之功能表命令如果在不選取任何項目，則為 NULL。  
  
### <a name="remarks"></a>備註  
 以快顯功能表的功能表命令都由[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)，或衍生自類別`CMFCToolBarMenuButton`。  
  
##  <a name="hasbeenresized"></a>  CMFCPopupMenu::HasBeenResized  

  
```  
BOOL HasBeenResized() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="hiderarelyusedcommands"></a>  CMFCPopupMenu::HideRarelyUsedCommands  
 表示快顯功能表是否可以隱藏很少使用的命令。  
  
```  
BOOL HideRarelyUsedCommands() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果快顯功能表可以隱藏很少使用的命令;，則為 TRUE。否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會指定是否可以隱藏快顯功能表只有很少使用的命令，如果已啟用該設定。 快顯功能表可以隱藏很少使用的命令，如果它具有父代按鈕和父視窗衍生自[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)。 使用[CMFCMenuBar::SetRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#setrecentlyusedmenus)若要啟用這項功能並[CMFCMenuBar::IsRecentlyUsedMenus](../../mfc/reference/cmfcmenubar-class.md#isrecentlyusedmenus)來判斷目前是否已啟用此功能。 您必須呼叫這兩種方法在父視窗。  
  
##  <a name="incommand"></a>  CMFCPopupMenu::InCommand  

  
```  
virtual BOOL InCommand();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="insertitem"></a>  CMFCPopupMenu::InsertItem  
 在指定的位置快顯功能表中插入新項目。  
  
```  
int InsertItem(
    const CMFCToolBarMenuButton& button,  
    int iInsertA = -1);
```  
  
### <a name="parameters"></a>參數  
 [in]*按鈕*  
 要加入功能表項目參考。  
  
 [in]*iInsertAt*  
 將新項目的以零為起始的索引。 如果*iInsertAt*為-1，將項目加入功能表的尾端。  
  
### <a name="return-value"></a>傳回值  
 已插入之項目的位置以零為起始的索引。 如果方法失敗，為-1。  
  
### <a name="remarks"></a>備註  
 如果您提供的值無效，這個方法將會失敗*iInsertAt*，例如大於目前在快顯功能表上的項目數的整數。  
  
##  <a name="insertseparator"></a>  CMFCPopupMenu::InsertSeparator  
 插入指定位置的快顯功能表中的分隔符號。  
  
```  
int InsertSeparator(int iInsertAt = -1);
```  
  
### <a name="parameters"></a>參數  
 [in]*iInsertAt*  
 這個方法會在該處插入分隔符號的位置以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 分隔符號的插入位置的以零為起始的索引。 如果此方法失敗，為-1。  
  
### <a name="remarks"></a>備註  
 值為-1 *iInsertAt*表示這個方法將會加入快顯功能表的尾端分隔符號。  
  
 如果這個方法會失敗*iInsertAt*是無效的值。  
  
##  <a name="isalwaysclose"></a>  CMFCPopupMenu::IsAlwaysClose  

  
```  
virtual BOOL IsAlwaysClose() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="isalwaysshowemptytoolsentry"></a>  CMFCPopupMenu::IsAlwaysShowEmptyToolsEntry  

  
```  
static BOOL __stdcall IsAlwaysShowEmptyToolsEntry();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="iscustomizepane"></a>  CMFCPopupMenu::IsCustomizePane  
 指出是否有快顯功能表當作**QuickCustomizePane**。  
  
```  
BOOL IsCustomizePane();
```  
  
### <a name="return-value"></a>傳回值  
 如果快顯視窗中，則為 TRUE **QuckCustomizePane**，否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 使用**QuickCustomizePane** ，讓使用者直接來自訂快顯功能表。 **QuickCustomizePane**是`CMFCPopupMenu`顯示當使用者按一下工具列按鈕，以直接進行編輯。  
  
 您的應用程式應該呼叫這個方法期間[CMDIFrameWndEx::OnShowCustomizePane](../../mfc/reference/cmdiframewndex-class.md#onshowcustomizepane)。  
  
##  <a name="isescclose"></a>  CMFCPopupMenu::IsEscClose  

  
```  
BOOL IsEscClose();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="isidle"></a>  CMFCPopupMenu::IsIdle  
 指出快顯功能表是否目前處於閒置狀態。  
  
```  
virtual BOOL IsIdle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果快顯功能表處於閒置模式，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 根據預設，快顯功能表時處於閒置模式顯示動畫完成，而且使用者不可捲動快顯功能表。  
  
##  <a name="ismenusound"></a>  CMFCPopupMenu::IsMenuSound  

  
```  
static UINT __stdcall IsMenuSound();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="isquickcustomize"></a>  CMFCPopupMenu::IsQuickCustomize  
 決定是否相關聯[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)處於 QuickCustomize 模式。  
  
```  
BOOL IsQuickCustomize();
```  
  
### <a name="return-value"></a>傳回值  
 如果相關聯的功能表按鈕為 QuickCustomize 模式，則為 TRUE否則為 FALSE。 如果不是與相關聯的快顯功能表，這個方法也會傳回 FALSE `CMFCToolBarMenuButton`。  
  
### <a name="remarks"></a>備註  
 在 QuickCustomize 模式的使用者會選取直接自訂按鈕的工具列上的按鈕。  
  
##  <a name="isresizeble"></a>  CMFCPopupMenu::IsResizeble  

  
```  
BOOL IsResizeble() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="isrightalign"></a>  CMFCPopupMenu::IsRightAlign  
 指出功能表是否靠右或靠左對齊。  
  
```  
BOOL IsRightAlign() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果功能表是靠右對齊;，則為 TRUE。如果功能表靠左對齊，則為 FALSE。  
  
### <a name="remarks"></a>備註  
 您可以使用[CMFCPopupMenu::SetRightAlign](#setrightalign)設定功能表對齊方式。 根據預設，快顯功能表，請使用靠左對齊。  
  
 功能表對齊不是全域設定，和快顯功能表而有所不同。  
  
##  <a name="isscrollable"></a>  CMFCPopupMenu::IsScrollable  

  
```  
BOOL IsScrollable() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="issendmenuselectmsg"></a>  CMFCPopupMenu::IsSendMenuSelectMsg  
 指出當使用者從快顯功能表中選取的命令時，framework 是否通知父框架。  
  
```  
static BOOL IsSendMenuSelectMsg();
```  
  
### <a name="return-value"></a>傳回值  
 如果架構通知父框架;，則為 TRUE。否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 架構會使用選取的功能表命令時將它傳送 WM_MENUSELECT 訊息通知父框架。  
  
##  <a name="isshown"></a>  CMFCPopupMenu::IsShown  
 指出是否為目前可看見快顯功能表。  
  
```  
BOOL IsShown() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果快顯功能表會顯示;，則為 TRUE。否則為 FALSE。  
  
##  <a name="moveto"></a>  CMFCPopupMenu::MoveTo  

  
```  
void MoveTo(const CPoint& pt);
```  
  
### <a name="parameters"></a>參數  
 [in]*pt*  
  
### <a name="remarks"></a>備註  
  
##  <a name="onchangehot"></a>  CMFCPopupMenu::OnChangeHot  

  
```  
virtual void OnChangeHot(int nHot);
```  
  
### <a name="parameters"></a>參數  
 [in]*nHot*  
  
### <a name="remarks"></a>備註  
  
##  <a name="onchooseitem"></a>  CMFCPopupMenu::OnChooseItem  

  
```  
virtual void OnChooseItem(UINT uidCmdID);
```  
  
### <a name="parameters"></a>參數  
 [in]*uidCmdID*  
  
### <a name="remarks"></a>備註  
  
##  <a name="oncmdmsg"></a>  CMFCPopupMenu::OnCmdMsg  

  
```  
virtual BOOL OnCmdMsg(
    UINT nID,  
    int nCode,  
    void* pExtra,  
    AFX_CMDHANDLERINFO* pHandlerInfo);
```  
  
### <a name="parameters"></a>參數  
 [in]*nID*  
 [in]*則 nCode*  
 [in]*pExtra*  
 [in]*pHandlerInfo*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="postcommand"></a>  CMFCPopupMenu::PostCommand  

  
```  
BOOL PostCommand(UINT uiCommandID);
```  
  
### <a name="parameters"></a>參數  
 [in]*uiCommandID*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="pretranslatemessage"></a>  CMFCPopupMenu::PreTranslateMessage  

  
```  
virtual BOOL PreTranslateMessage(MSG* pMsg);
```  
  
### <a name="parameters"></a>參數  
 [in]*pMsg*  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="recalclayout"></a>  CMFCPopupMenu::RecalcLayout  

  
```  
virtual void RecalcLayout(BOOL bNotify = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bNotify*  
  
### <a name="remarks"></a>備註  
  
##  <a name="removeallitems"></a>  CMFCPopupMenu::RemoveAllItems  
 清除快顯功能表中的所有項目。  
  
```  
void RemoveAllItems();
```  
  
##  <a name="removeitem"></a>  CMFCPopupMenu::RemoveItem  
 從快顯功能表中移除指定的項目。  
  
```  
BOOL RemoveItem(int iIndex);
```  
  
### <a name="parameters"></a>參數  
 [in]*iIndex*  
 要刪除之項目的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 如果方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會自動排列受影響的項目移除任何分隔字元。 如需此架構如何重新排列分隔符號的詳細資訊，請參閱[CMFCToolBar::RemoveButton](../../mfc/reference/cmfctoolbar-class.md#removebutton)。  
  
##  <a name="savestate"></a>  CMFCPopupMenu::SaveState  

  
```  
virtual void SaveState();
```  
  
### <a name="remarks"></a>備註  
  
##  <a name="setanimationspeed"></a>  CMFCPopupMenu::SetAnimationSpeed  
 設定快顯功能表的動畫速度。  
  
```  
static void SetAnimationSpeed(UINT nElapse);
```  
  
### <a name="parameters"></a>參數  
 [in]*nElapse*  
 新動畫的速度，以毫秒為單位。  
  
### <a name="remarks"></a>備註  
 動畫速度是一個全域值，而且會影響應用程式中的所有快顯功能表。 這個值會指定花多少時間才能完成快顯功能表的動畫。  
  
 根據預設，此參數會設定為 30 的毫秒。 有效值範圍*nElapse*是從 0 到 200。  
  
##  <a name="setanimationtype"></a>  CMFCPopupMenu::SetAnimationType  
 設定這個快顯功能表的動畫類型。  
  
```  
static void SetAnimationType(CMFCPopupMenu::ANIMATION_TYPE type);
```  
  
### <a name="parameters"></a>參數  
 [in]*類型*  
 指定的動畫類型列舉的資料型別。  
  
### <a name="remarks"></a>備註  
 請參閱[CMFCPopupMenu::GetAnimationType](#getanimationtype)如需有效值的清單*型別*。  
  
##  <a name="setautodestroy"></a>  CMFCPopupMenu::SetAutoDestroy  

  
```  
void SetAutoDestroy(BOOL bAutoDestroy = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bAutoDestroy*  
  
### <a name="remarks"></a>備註  
  
##  <a name="setdefaultitem"></a>  CMFCPopupMenu::SetDefaultItem  
 設定快顯功能表的預設命令。  
  
```  
void SetDefaultItem(UINT uiCmd);
```  
  
### <a name="parameters"></a>參數  
 [in]*uiCmd*  
 新的預設命令的功能表命令識別碼。  
  
### <a name="remarks"></a>備註  
 快顯功能表中的預設命令是快顯功能表出現時選取的命令。  
  
##  <a name="setforcemenufocus"></a>  CMFCPopupMenu::SetForceMenuFocus  
 會強制以返回 功能表列的快顯功能表出現時輸入的焦點。  
  
```  
static void SetForceMenuFocus(BOOL bValue);
```  
  
### <a name="parameters"></a>參數  
 [in]*bValue*  
 如果您想要強制在功能表列的快顯功能表出現時輸入的焦點的架構，則為 TRUE。 如果您想要保留焦點快顯功能表，則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會設定為全域應用程式中的所有快顯功能表的旗標。 根據預設，未啟用這項功能。  
  
##  <a name="setforceshadow"></a>  CMFCPopupMenu::SetForceShadow  
 強制主框架外的快顯功能表出現時，繪製功能表陰影的架構。  
  
```  
static void SetForceShadow(BOOL bValue);
```  
  
### <a name="parameters"></a>參數  
 [in]*bValue*  
 如果您想要的架構，否則為 FALSE 繪製功能表陰影，則為 TRUE。  
  
### <a name="remarks"></a>備註  
 當您呼叫這個方法時，它會在您的應用程式中設定全域旗標。 這個旗標會影響您的應用程式中的所有快顯功能表。  
  
##  <a name="setmaxwidth"></a>  CMFCPopupMenu::SetMaxWidth  
 設定快顯功能表的最大寬度。  
  
```  
void SetMaxWidth(int iMaxWidth);
```  
  
### <a name="parameters"></a>參數  
 [in]*iMaxWidth*  
 快顯功能表的 像素為單位最大寬度。  
  
### <a name="remarks"></a>備註  
 如果與功能表命令相關聯的文字所無法容納的最大寬度，則會遭到截斷，而不符合的組件會取代三個點。  
  
##  <a name="setmessagewnd"></a>  CMFCPopupMenu::SetMessageWnd  

  
```  
void SetMessageWnd(CWnd* pMsgWnd);
```  
  
### <a name="parameters"></a>參數  
 [in]*pMsgWnd*  
  
### <a name="remarks"></a>備註  
  
##  <a name="setparentribbonelement"></a>  CMFCPopupMenu::SetParentRibbonElement  

  
```  
void SetParentRibbonElement(CMFCRibbonBaseElement* pElem);
```  
  
### <a name="parameters"></a>參數  
 [in]*pElem*  
  
### <a name="remarks"></a>備註  
  
##  <a name="setquickcustomizetype"></a>  CMFCPopupMenu::SetQuickCustomizeType  

  
```  
void SetQuickCustomizeType(QUICK_CUSTOMIZE_TYPE Type);
```  
  
### <a name="parameters"></a>參數  
 [in]*類型*  
  
### <a name="remarks"></a>備註  
  
##  <a name="setquickmode"></a>  CMFCPopupMenu::SetQuickMode  

  
```  
void SetQuickMode();
```  
  
### <a name="remarks"></a>備註  
  
##  <a name="setrightalign"></a>  CMFCPopupMenu::SetRightAlign  
 設定快顯功能表的功能表對齊方式。  
  
```  
void SetRightAlign(BOOL bRightAlign = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bRightAlign*  
 布林值，指出功能表對齊方式。 TRUE 表示靠右對齊，FALSE 表示靠左的對齊。  
  
### <a name="remarks"></a>備註  
 根據預設，所有的快顯功能表會是靠左對齊。  
  
##  <a name="setsendmenuselectmsg"></a>  CMFCPopupMenu::SetSendMenuSelectMsg  
 設定會控制當使用者選取命令時，快顯功能表是否告知其父框架的旗標。  
  
```  
static void SetSendMenuSelectMsg(BOOL bSet = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [in]*bSet*  
 快顯功能表會告知其父框架中，FALSE 否則，其值為 TRUE。  
  
### <a name="remarks"></a>備註  
 這是全域應用程式中的所有快顯功能表選項。 如果已啟用，則快顯功能表會在使用者選取命令時傳送 WM_MENUSELECT 訊息給父框架。  
  
##  <a name="showallcommands"></a>  CMFCPopupMenu::ShowAllCommands  
 會強制快顯功能表以顯示所有命令。  
  
```  
void ShowAllCommands();
```  
  
### <a name="remarks"></a>備註  
 這不是全域設定，而且會影響只有目前的快顯功能表。  
  
##  <a name="triggerresize"></a>  CMFCPopupMenu::TriggerResize  

  
```  
void TriggerResize();
```  
  
### <a name="remarks"></a>備註  
  
##  <a name="updateallshadows"></a>  CMFCPopupMenu::UpdateAllShadows  
 更新所有開啟的快顯功能表的陰影。  
  
```  
static void UpdateAllShadows(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>參數  
 [in]*lprectScreen*  
 螢幕座標中指定要更新的區域的矩形。  
  
### <a name="remarks"></a>備註  
 當動畫的控制項或其他具有動態內容的視窗上顯示快顯功能表時，此方法相當實用。  
  
##  <a name="updateshadow"></a>  CMFCPopupMenu::UpdateShadow  
 更新快顯功能表的陰影。  
  
```  
void UpdateShadow(LPRECT lprectScreen = NULL);
```  
  
### <a name="parameters"></a>參數  
 [in]*lprectScreen*  
 矩形，在螢幕座標中，指定要更新的區域界限。  
  
### <a name="remarks"></a>備註  
 當有陰影的快顯功能表重疊動畫的影像，請呼叫這個方法。  
  
## <a name="see-also"></a>另請參閱  
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [類別](../../mfc/reference/mfc-classes.md)   
 [CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)
