---
title: CMFCPropertyGridProperty 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CMFCPropertyGridProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AddSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustButtonRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AdjustInPlaceEditRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::AllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateInPlaceEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Enable
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::EnableSpinControl
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Expand
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::FormatProperty
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetExpandedSubItems
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetHierarchyLevel
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetNameTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOption
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOptionCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetParent
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetRect
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetSubItemsCount
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::GetValueTooltip
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HitTest
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsAllowEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsEnabled
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsGroup
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsInPlaceEditing
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsModified
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsParentExpanded
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSelected
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsVisible
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCloseCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDblClk
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawExpandBox
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDrawValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnEndEdit
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnPosSizeChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnRClickValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSelectCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetCursor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnSetSelection
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnUpdateValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::PushChar
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Redraw
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveAllOptions
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::RemoveSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::ResetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetData
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetDescription
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetName
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetOriginalValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::SetValue
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Show
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::CreateCombo
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::HasButton
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::Init
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsSubItem
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::IsValueChanged
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnCtlColor
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnDestroyWindow
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::OnKillFocus
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatDouble
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatFloat
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatLong
- AFXPROPERTYGRIDCTRL/CMFCPropertyGridProperty::m_strFormatShort
helpviewer_keywords:
- CMFCPropertyGridProperty [MFC], CMFCPropertyGridProperty
- CMFCPropertyGridProperty [MFC], AddOption
- CMFCPropertyGridProperty [MFC], AddSubItem
- CMFCPropertyGridProperty [MFC], AdjustButtonRect
- CMFCPropertyGridProperty [MFC], AdjustInPlaceEditRect
- CMFCPropertyGridProperty [MFC], AllowEdit
- CMFCPropertyGridProperty [MFC], CreateInPlaceEdit
- CMFCPropertyGridProperty [MFC], CreateSpinControl
- CMFCPropertyGridProperty [MFC], Enable
- CMFCPropertyGridProperty [MFC], EnableSpinControl
- CMFCPropertyGridProperty [MFC], Expand
- CMFCPropertyGridProperty [MFC], FormatProperty
- CMFCPropertyGridProperty [MFC], GetData
- CMFCPropertyGridProperty [MFC], GetDescription
- CMFCPropertyGridProperty [MFC], GetExpandedSubItems
- CMFCPropertyGridProperty [MFC], GetHierarchyLevel
- CMFCPropertyGridProperty [MFC], GetName
- CMFCPropertyGridProperty [MFC], GetNameTooltip
- CMFCPropertyGridProperty [MFC], GetOption
- CMFCPropertyGridProperty [MFC], GetOptionCount
- CMFCPropertyGridProperty [MFC], GetOriginalValue
- CMFCPropertyGridProperty [MFC], GetParent
- CMFCPropertyGridProperty [MFC], GetRect
- CMFCPropertyGridProperty [MFC], GetSubItem
- CMFCPropertyGridProperty [MFC], GetSubItemsCount
- CMFCPropertyGridProperty [MFC], GetValue
- CMFCPropertyGridProperty [MFC], GetValueTooltip
- CMFCPropertyGridProperty [MFC], HitTest
- CMFCPropertyGridProperty [MFC], IsAllowEdit
- CMFCPropertyGridProperty [MFC], IsEnabled
- CMFCPropertyGridProperty [MFC], IsExpanded
- CMFCPropertyGridProperty [MFC], IsGroup
- CMFCPropertyGridProperty [MFC], IsInPlaceEditing
- CMFCPropertyGridProperty [MFC], IsModified
- CMFCPropertyGridProperty [MFC], IsParentExpanded
- CMFCPropertyGridProperty [MFC], IsSelected
- CMFCPropertyGridProperty [MFC], IsVisible
- CMFCPropertyGridProperty [MFC], OnClickButton
- CMFCPropertyGridProperty [MFC], OnClickName
- CMFCPropertyGridProperty [MFC], OnClickValue
- CMFCPropertyGridProperty [MFC], OnCloseCombo
- CMFCPropertyGridProperty [MFC], OnDblClk
- CMFCPropertyGridProperty [MFC], OnDrawButton
- CMFCPropertyGridProperty [MFC], OnDrawDescription
- CMFCPropertyGridProperty [MFC], OnDrawExpandBox
- CMFCPropertyGridProperty [MFC], OnDrawName
- CMFCPropertyGridProperty [MFC], OnDrawValue
- CMFCPropertyGridProperty [MFC], OnEdit
- CMFCPropertyGridProperty [MFC], OnEndEdit
- CMFCPropertyGridProperty [MFC], OnKillSelection
- CMFCPropertyGridProperty [MFC], OnPosSizeChanged
- CMFCPropertyGridProperty [MFC], OnRClickName
- CMFCPropertyGridProperty [MFC], OnRClickValue
- CMFCPropertyGridProperty [MFC], OnSelectCombo
- CMFCPropertyGridProperty [MFC], OnSetCursor
- CMFCPropertyGridProperty [MFC], OnSetSelection
- CMFCPropertyGridProperty [MFC], OnUpdateValue
- CMFCPropertyGridProperty [MFC], PushChar
- CMFCPropertyGridProperty [MFC], Redraw
- CMFCPropertyGridProperty [MFC], RemoveAllOptions
- CMFCPropertyGridProperty [MFC], RemoveSubItem
- CMFCPropertyGridProperty [MFC], ResetOriginalValue
- CMFCPropertyGridProperty [MFC], SetData
- CMFCPropertyGridProperty [MFC], SetDescription
- CMFCPropertyGridProperty [MFC], SetName
- CMFCPropertyGridProperty [MFC], SetOriginalValue
- CMFCPropertyGridProperty [MFC], SetValue
- CMFCPropertyGridProperty [MFC], Show
- CMFCPropertyGridProperty [MFC], CreateCombo
- CMFCPropertyGridProperty [MFC], HasButton
- CMFCPropertyGridProperty [MFC], Init
- CMFCPropertyGridProperty [MFC], IsSubItem
- CMFCPropertyGridProperty [MFC], IsValueChanged
- CMFCPropertyGridProperty [MFC], OnCtlColor
- CMFCPropertyGridProperty [MFC], OnDestroyWindow
- CMFCPropertyGridProperty [MFC], OnKillFocus
- CMFCPropertyGridProperty [MFC], m_strFormatDouble
- CMFCPropertyGridProperty [MFC], m_strFormatFloat
- CMFCPropertyGridProperty [MFC], m_strFormatLong
- CMFCPropertyGridProperty [MFC], m_strFormatShort
ms.assetid: 36f3fabe-0efe-468b-8a0b-5a7956db38a2
ms.openlocfilehash: 08fd7f1ba11053358391e7f120eb5db80d764c87
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754096"
---
# <a name="cmfcpropertygridproperty-class"></a>CMFCPropertyGridProperty 類別

物件`CMFCPropertyGridProperty`表示屬性清單控制件中的清單項。

   有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCPropertyGridProperty : public CObject
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFC財產網格屬性:CMFC財產網格屬性](#cmfcpropertygridproperty)|建構 `CMFCPropertyGridProperty` 物件。|
|`CMFCPropertyGridProperty::~CMFCPropertyGridProperty`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFC財產網格屬性:新增選項](#addoption)|將新的清單項目加入屬性清單控制件。|
|[CMFC 屬性網格屬性::新增子項](#addsubitem)|將子項添加到屬性。|
|[CMFC財產網格屬性::調整按鈕](#adjustbuttonrect)|由父屬性清單控制件調用,以告訴屬性調整嵌入按鈕的邊界矩形的大小。|
|[CMFC財產網格屬性::調整位置編輯](#adjustinplaceeditrect)|檢索用於設置屬性值的文本框和可選旋轉按鈕控制件的邊界。|
|[CMFC財產網格屬性::允許編輯](#allowedit)|使屬性可編輯或唯讀。|
|[CMFC財產網格屬性::創建原位編輯](#createinplaceedit)|由框架呼叫,以建立屬性的可編輯控制項。|
|[CMFC屬性網格屬性::建立斯賓控制](#createspincontrol)|由框架呼叫以創建可編輯的旋轉按鈕控制項。|
|[CMFC 財產網格屬性:啟用](#enable)|啟用或禁用屬性。|
|[CMFC 屬性網格屬性::啟用斯賓控制](#enablespincontrol)|啟用或禁用用於修改屬性值的旋轉按鈕控制項。|
|[CMFC財產網格屬性::展開](#expand)|展開或摺疊包含子屬性的屬性。|
|[CMFC 財產網格屬性:格式屬性](#formatproperty)|格式化屬性值的文字表示法。|
|[CMFC財產網格屬性:獲取數據](#getdata)|檢索與屬性關聯的 DWORD 值。|
|[CMFC財產網格屬性:取得描述](#getdescription)|檢索屬性描述。|
|[CMFC 屬性網格屬性:取得擴充子項目](#getexpandedsubitems)|檢索展開的子項的數量。|
|[CMFC 屬性網格屬性:取得層次結構等級](#gethierarchylevel)|檢索屬性層次結構級別的零基索引。|
|[CMFC財產網格屬性:取得名稱](#getname)|檢索屬性的名稱。|
|[CMFC財產網格屬性::獲取名稱工具提示](#getnametooltip)|由框架呼叫以在工具提示中顯示屬性的名稱。|
|[CMFC財產網格屬性:取得選項](#getoption)|檢索由索引指定的選項的文本。|
|[CMFC財產網格屬性:獲取期權計數](#getoptioncount)|檢索屬於屬性的選項數。|
|[CMFC財產網格屬性:取得原始價值](#getoriginalvalue)|檢索當前屬性的初始值。|
|[CMFC財產網格屬性:獲取父項](#getparent)|檢索指向父屬性的指標。|
|[CMFC財產網格屬性:取得 Rect](#getrect)|檢索屬性的邊界矩形。|
|[CMFC財產網格屬性:取得子專案](#getsubitem)|檢索由零基索引標識的子屬性。|
|[CMFC 屬性網格屬性:取得子項目計數](#getsubitemscount)|檢索子項的數量。|
|`CMFCPropertyGridProperty::GetThisClass`|框架用於獲取指向與此類類型關聯的[CRuntimeClass](../../mfc/reference/cruntimeclass-structure.md)物件的指標。|
|[CMFC財產網格屬性:獲取價值](#getvalue)|檢索屬性值。|
|[CMFC財產網格屬性:取得價值工具提示](#getvaluetooltip)|由框架調用以檢索屬性值的文本表示形式,然後顯示在工具提示中。|
|[CMFC財產網格屬性:hitTest](#hittest)|指向對應於點的屬性清單項的屬性物件。|
|[CMFC財產網格屬性::允許編輯](#isallowedit)|指示屬性是否可編輯。|
|[CMFC 屬性格格屬性:已開啟](#isenabled)|指示屬性是啟用還是禁用。|
|[CMFC財產網格屬性::已擴展](#isexpanded)|指示屬性是展開還是摺疊。|
|[CMFC財產網格屬性::IsGroup](#isgroup)|指示當前屬性是否表示組。|
|[CMFC財產網格屬性::位置編輯](#isinplaceediting)|指示當前屬性是否可編輯。|
|[CMFC財產網格屬性:已修改](#ismodified)|指示是否修改當前屬性。|
|[CMFC財產網格屬性::父級擴展](#isparentexpanded)|指示是否展開當前屬性的父項。|
|[CMFC財產網格屬性:已選定](#isselected)|指示是否選擇了當前屬性。|
|[CMFC財產網格屬性:可見](#isvisible)|指示當前屬性是否可見。|
|[CMFC財產網格屬性::點擊按鈕](#onclickbutton)|使用者按一下屬性中內含的按鈕時由架構呼叫。|
|[CMFC財產網格屬性::點擊名稱](#onclickname)|當用戶按一下屬性的名稱欄位時,由父屬性清單控制件調用。|
|[CMFC財產網格屬性::點擊值](#onclickvalue)|當用戶按一下屬性的值欄位時,由父屬性清單控制件調用。|
|[CMFC財產網格屬性::在關閉Combo](#onclosecombo)|當屬性中包含的組合框關閉時,由框架調用。|
|[CMFC財產網格屬性::OnDblClk](#ondblclk)|當用戶雙擊屬性時,由框架調用。|
|[CMFC財產網格屬性::在繪製按鈕](#ondrawbutton)|由框架調用以繪製包含在屬性中的按鈕。|
|[CMFC財產網格屬性::畫中的描述](#ondrawdescription)|由框架調用以顯示屬性描述。|
|[CMFC財產網格屬性::OnDraw 擴展框](#ondrawexpandbox)|由框架調用,以在包含子屬性的屬性附近繪製展開框控制元件。|
|[CMFC財產網格屬性::畫名](#ondrawname)|由框架調用以顯示屬性名稱。|
|[CMFC財產網格屬性::拉平價值](#ondrawvalue)|由架構呼叫以顯示屬性值。|
|[CMFC財產網格屬性::編輯](#onedit)|使用者即將修改屬性值時由架構呼叫。|
|[CMFC財產網格屬性::結束編輯](#onendedit)|當使用者完成修改屬性值時,由框架調用。|
|[CMFC財產網格屬性::在基爾選擇](#onkillselection)||
|[CMFC財產網格屬性::在Possize上更改](#onpossizechanged)||
|[CMFC財產網格屬性::點擊名稱](#onrclickname)|當用戶單擊屬性名稱區域中的滑鼠右鍵時,由框架調用。|
|[CMFC財產網格屬性::點擊價值](#onrclickvalue)|當用戶單擊屬性值區域中的滑鼠右鍵時,由框架調用。|
|[CMFC財產網格屬性::在選擇Combo](#onselectcombo)|當使用者從可編輯組合框中選擇專案時,由框架調用。|
|[CMFC財產網格屬性::打開游標](#onsetcursor)|當滑鼠指標移動到屬性項時,由框架調用。|
|[CMFC財產網格屬性::打開選擇](#onsetselection)||
|[CMFC財產網格屬性:更新值](#onupdatevalue)|當可編輯屬性的值變更時由架構呼叫。|
|[CMFC財產網格屬性::P](#pushchar)|選擇屬性並且使用者輸入新字元時從屬性清單控制項調用。|
|[CMFC財產網格屬性:重繪](#redraw)|重繪屬性。|
|[CMFC 屬性網格屬性::刪除所有選項](#removealloptions)|從屬性中刪除所有選項(專案)。|
|[CMFC 屬性網格屬性::刪除子專案](#removesubitem)|刪除指定的子項。|
|[CMFC財產網格屬性:重置原始值](#resetoriginalvalue)|還原編輯屬性的原始值。|
|[CMFC財產網格屬性::數據集](#setdata)|將 DWORD 值與屬性關聯。|
|[CMFC 屬性網格屬性::設定描述](#setdescription)|指定描述目前的屬性的文字。|
|[CMFC 屬性網格屬性::設定名稱](#setname)|設置屬性的名稱。|
|[CMFC財產網格屬性::設置原始價值](#setoriginalvalue)|設定可編輯屬性的原始值。|
|[CMFC財產網格屬性::設置價值](#setvalue)|設置屬性網格屬性的值。|
|[CMFC 財產網格屬性:顯示](#show)|顯示或隱藏屬性。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFC財產網格屬性:建立Combo](#createcombo)|由框架調用,以向屬性添加組合框。|
|[CMFC財產網格屬性::哈斯按鈕](#hasbutton)|指示屬性是否包含按鈕。|
|[CMFC財產網格屬性::Init](#init)|由框架調用以初始化屬性物件。|
|[CMFC財產網格屬性::是子專案](#issubitem)|指示指定的屬性是否是當前屬性的子項。|
|[CMFC財產網格屬性::已更改價值](#isvaluechanged)|指示當前屬性的值是否已更改。|
|[CMFC財產網格屬性::在CtlColor上](#onctlcolor)|當必須檢索畫筆以填充屬性的背景顏色時,由框架調用。|
|[CMFC財產網格屬性::在銷毀視窗上](#ondestroywindow)|當屬性被銷毀或編輯完成時,由框架調用。|
|[CMFC財產網格屬性::在基爾焦點](#onkillfocus)|當屬性失去輸入焦點時,由框架調用。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCPropertyGridProperty::m_strFormatDouble](#m_strformatdouble)|為類型為雙精度值設置字串的格式。|
|[CMFCPropertyGridProperty::m_strFormatFloat](#m_strformatfloat)|為類型浮點的值格式化字串。|
|[CMFCPropertyGridProperty::m_strFormatLong](#m_strformatlong)|格式化長類型值的字串。|
|[CMFCPropertyGridProperty::m_strFormatShort](#m_strformatshort)|格式化短類型值的字串。|

## <a name="remarks"></a>備註

使用物件`CMFCPropertyGridProperty`表示屬性,然後將其添加到屬性清單控制項。 有關詳細資訊,請參閱[CMFC 財產網格Ctrl 類](../../mfc/reference/cmfcpropertygridctrl-class.md)。

屬性物件可以表示資料類型,如字串、日期和布爾值或整數值。 它可以包含子屬性,也可以包含控制項,如組合框或按鈕控制元件。

## <a name="example"></a>範例

下面的示例演示如何構造`CMFCPropertyGridProperty`物件。 該示例還演示如何在`CMFCPropertyGridProperty`類中使用各種方法添加選項、添加子項、啟用屬性以及顯示屬性。 此示例是[「新控制件」範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_NewControls#27](../../mfc/reference/codesnippet/cpp/cmfcpropertygridproperty-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CMFCPropertyGridProperty](../../mfc/reference/cmfcpropertygridproperty-class.md)

## <a name="requirements"></a>需求

**標題:** afxpropertygridctrl.h

## <a name="cmfcpropertygridpropertyaddoption"></a><a name="addoption"></a>CMFC財產網格屬性:新增選項

將新的清單項目加入屬性清單控制件。

```
BOOL AddOption(
    LPCTSTR lpszOption,
    BOOL bInsertUnique=TRUE);
```

### <a name="parameters"></a>參數

*lpszOption*<br/>
[在]要添加的清單項(選項)。

*bInsert 唯一*<br/>
[在]僅在清單項不存在時添加清單項;如果清單項不存在,則僅添加它。否則,FALSE。 預設值為 TRUE。

### <a name="return-value"></a>傳回值

TRUE,這意味著將添加清單項。 否則,FALSE,這意味著不會添加清單項,因為*bInsert 唯一*參數為 TRUE,*並且 lpszOption*參數指定的清單項已存在。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyaddsubitem"></a><a name="addsubitem"></a>CMFC 屬性網格屬性::新增子項

將子項添加到屬性。

```
BOOL AddSubItem(CMFCPropertyGridProperty* pProp);
```

### <a name="parameters"></a>參數

*pProp*<br/>
[在]指向要添加的屬性的指標。

### <a name="return-value"></a>傳回值

如果指定屬性成功添加為子屬性,則為 TRUE。 如果未添加該屬性,則 FALSE,因為它已在父屬性中發生。

### <a name="remarks"></a>備註

使用此方法可以創建父屬性和子屬性的分層清單。 添加子屬性後,父屬性將自動顯示由加號 (*) 指定的展開框控制項。 當用戶單擊加號時,父屬性將展開並顯示任何子屬性項。

## <a name="cmfcpropertygridpropertyadjustbuttonrect"></a><a name="adjustbuttonrect"></a>CMFC財產網格屬性::調整按鈕

由父屬性清單控制件調用,以告訴屬性調整嵌入按鈕的邊界矩形的大小。

```
virtual void AdjustButtonRect();
```

### <a name="remarks"></a>備註

預設情況下,此方法:

- 調整按鈕的寬度等於按鈕的高度加上 3 個圖元。

- 將按鈕的邊界矩形移至屬性的右邊緣

- 將按鈕移至屬性上邊緣以下 1 圖元。

## <a name="cmfcpropertygridpropertyadjustinplaceeditrect"></a><a name="adjustinplaceeditrect"></a>CMFC財產網格屬性::調整位置編輯

檢索用於設置屬性值的文本框和可選旋轉按鈕控制件的邊界。

```
virtual void AdjustInPlaceEditRect(
    CRect& rectEdit,
    CRect& rectSpin);
```

### <a name="parameters"></a>參數

*整編*<br/>
[出]當此方法返回時,一個矩形指定屬性值的文本框的邊界。

*雷平斯平*<br/>
[出]當此方法返回時,一個矩形指定屬性值的旋轉按鈕控制件的邊界。 或者,如果屬性不支援旋轉按鈕,則為空矩形。

### <a name="remarks"></a>備註

屬性的值區域由文字框和可能*的選項按鈕*組成,例如旋轉按鈕控制項。 此方法計算文本框和選項按鈕的尺寸,然後在指定的參數中返回這些值。

## <a name="cmfcpropertygridpropertyallowedit"></a><a name="allowedit"></a>CMFC財產網格屬性::允許編輯

使屬性可編輯或唯讀。

```cpp
void AllowEdit(BOOL bAllow=TRUE);
```

### <a name="parameters"></a>參數

*bAllow*<br/>
[在]TRUE 使屬性可編輯;FALSE 使屬性為唯讀。 預設值為 TRUE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertycmfcpropertygridproperty"></a><a name="cmfcpropertygridproperty"></a>CMFC財產網格屬性:CMFC財產網格屬性

建構 `CMFCPropertyGridProperty` 物件。

```
CMFCPropertyGridProperty(
    const CString& strGroupName,
    DWORD_PTR dwData=0,
    BOOL bIsValueList=FALSE);

CMFCPropertyGridProperty(
    const CString& strName,
    const _variant_t& varValue,
    LPCTSTR lpszDescr=NULL,
    DWORD_PTR dwData=0,
    LPCTSTR lpszEditMask=NULL,
    LPCTSTR lpszEditTemplate=NULL,
    LPCTSTR lpszValidChars=NULL);
```

### <a name="parameters"></a>參數

*strGroup 名稱*<br/>
[在]組名稱。 *組*是屬性網格控件中相關屬性的集合。 如果控制項以分層方式顯示,*則群組名稱*將顯示為群組上方的行中的類別標題。

*dwData*<br/>
[在]特定於應用程式的數據,例如整數或指向與屬性關聯的其他數據的指標。 預設值為 0。

*strName*<br/>
[在]屬性的名稱。

*varValue*<br/>
[在]屬性值。

*lpszDescr*<br/>
[在]屬性描述。 預設值是 NULL。

*lpszEditMask*<br/>
[在]編輯遮罩(如果屬性是蒙版編輯控件)。 預設值是 NULL。

*lpszEditTemplate*<br/>
[在]編輯範本(如果屬性是蒙版編輯控件)。 預設值是 NULL。

*lpszValidChars*<br/>
[在]有效字元的清單(如果屬性是蒙版編輯控制項)。 預設值是 NULL。

*bIsValueList*<br/>
[在]如果屬性表示值清單,則為 TRUE;如果屬性表示值清單,則為 TRUE。如果屬性表示單個值,則 FALSE。 預設值為 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertycreatecombo"></a><a name="createcombo"></a>CMFC財產網格屬性:建立Combo

由框架調用,以向屬性添加組合框。

```
virtual CComboBox* CreateCombo(
    CWnd* pWndParent,
    CRect rect);
```

### <a name="parameters"></a>參數

*pwnd 父級*<br/>
[在]指向組合框的父視窗。

*矩形*<br/>
[在]組合框的邊界矩形。

### <a name="return-value"></a>傳回值

指向新[CComboBox](../../mfc/reference/ccombobox-class.md)物件的指標。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertycreateinplaceedit"></a><a name="createinplaceedit"></a>CMFC財產網格屬性::創建原位編輯

由框架呼叫,以建立屬性的可編輯控制項。

```
virtual CWnd* CreateInPlaceEdit(
    CRect rectEdit,
    BOOL& bDefaultFormat);
```

### <a name="parameters"></a>參數

*整編*<br/>
[在]可編輯控制件的邊界矩形。

*b預設格式*<br/>
[在]TRUE 使用預設屬性格式設置可編輯控制項的文字;否則,FALSE。

### <a name="return-value"></a>傳回值

如果此方法成功,則指向可編輯控件的指標;否則,NULL。

### <a name="remarks"></a>備註

此方法使用[在 CMFCPropertyGrid 屬性](../../mfc/reference/cmfcpropertygridproperty-class.md)類構造函數中指定的 varValue、lpszEditMask、lpszEditTemplate 和*lpszValidChars*參數的值。 *varValue* *lpszEditMask* *lpszEditTemplate* 默認情況下,此方法支援*varValue*變體類型。 這包括VT_BSTR、VT_R4、VT_R8、VT_UI1、VT_I2、VT_INT、VT_UINT、VT_I4、VT_UI2、VT_UI4和VT_BOOL。

如果指定了一個或多個*lpszEditMask、lpszEditTemplate*或*lpszValidChar 參數*,則此方法將建立一個[CMFCMaskedEdit 控制件](../../mfc/reference/cmfcmaskededit-class.md); *lpszEditTemplate*否則,它將創建一個[CEdit](../../mfc/reference/cedit-class.md)控制項。

## <a name="cmfcpropertygridpropertycreatespincontrol"></a><a name="createspincontrol"></a>CMFC屬性網格屬性::建立斯賓控制

由框架呼叫以創建可編輯的旋轉按鈕控制項。

```
virtual CSpinButtonCtrl* CreateSpinControl(CRect rectSpin);
```

### <a name="parameters"></a>參數

*雷平斯平*<br/>
[在]定義可編輯旋轉按鈕控制件的矩形。

### <a name="return-value"></a>傳回值

指向新的[CMFCSpinButtonCtrl](../../mfc/reference/cmfcspinbuttonctrl-class.md)物件的指標,該物件作為指向[CSpinButtonCtrl](../../mfc/reference/cspinbuttonctrl-class.md)物件的指標進行強制轉換。

### <a name="remarks"></a>備註

呼叫[CMFC 屬性網格屬性::啟用SpinControl](#enablespincontrol)方法,以在屬性的右邊緣顯示可編輯的旋轉按鈕控制項。

## <a name="cmfcpropertygridpropertyenable"></a><a name="enable"></a>CMFC 財產網格屬性:啟用

啟用或禁用屬性。

```cpp
void Enable(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 以啟用屬性;FALSE 以禁用該屬性。 禁用的屬性不響應滑鼠或鍵盤輸入。 預設值為 TRUE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyenablespincontrol"></a><a name="enablespincontrol"></a>CMFC 屬性網格屬性::啟用斯賓控制

啟用或禁用用於修改屬性值的旋轉按鈕控制項。

```cpp
void EnableSpinControl(
    BOOL bEnable=TRUE,
    int nMin=0,
    int nMax=0);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用旋轉按鈕控制件;FALSE 以禁用旋轉按鈕控制項。 預設值為 TRUE。

*nMin*<br/>
[在]旋轉按鈕控制件的最小值。 預設值為 0。

*nMax*<br/>
[在]旋轉按鈕控制項的最大值。 預設值為 0。

### <a name="remarks"></a>備註

當要編輯屬性時,框架會自動創建旋轉按鈕控制項。

屬性類型(由 CMFCPropertyGrid 屬性的*varValue*參數指定[::CMFC屬性網格構造函數](#cmfcpropertygridproperty))必須是受支援的變體類型。 否則,此方法在調試模式下斷言。 支援的類型包括VT_INT、VT_UINT、VT_I2、VT_I4、VT_UI2和VT_UI4。

## <a name="cmfcpropertygridpropertyexpand"></a><a name="expand"></a>CMFC財產網格屬性::展開

展開或摺疊包含子屬性的屬性。

```cpp
void Expand(BOOL bExpand=TRUE);
```

### <a name="parameters"></a>參數

*b 延伸*<br/>
[在]TRUE 以擴展屬性;FALSE 以摺疊屬性。 預設值為 TRUE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyformatproperty"></a><a name="formatproperty"></a>CMFC 財產網格屬性:格式屬性

格式化屬性值的文字表示法。

```
virtual CString FormatProperty();
```

### <a name="return-value"></a>傳回值

屬性值的文本表示形式。

### <a name="remarks"></a>備註

在顯示屬性值之前,框架將調用此方法。

## <a name="cmfcpropertygridpropertygetdata"></a><a name="getdata"></a>CMFC財產網格屬性:獲取數據

檢索與屬性關聯的 DWORD 值。

```
DWORD_PTR GetData() const;
```

### <a name="return-value"></a>傳回值

DWORD 值。

### <a name="remarks"></a>備註

返回的數據是特定於應用程式的值,例如數位或指向其他數據的指標。 在建構屬性或調用[CMFCPropertyGrid 屬性:::setData](#setdata)方法時指定數據值。

## <a name="cmfcpropertygridpropertygetdescription"></a><a name="getdescription"></a>CMFC財產網格屬性:取得描述

檢索屬性描述。

```
const CString& GetDescription() const;
```

### <a name="return-value"></a>傳回值

包含屬性描述的文字字串。

### <a name="remarks"></a>備註

屬性清單控制項還使用此方法來顯示屬性的說明。

## <a name="cmfcpropertygridpropertygetexpandedsubitems"></a><a name="getexpandedsubitems"></a>CMFC 屬性網格屬性:取得擴充子項目

檢索展開的子項的數量。

```
int GetExpandedSubItems(BOOL bIncludeHidden=TRUE) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*b 包括隱藏*|[在]TRUE 以包括在計數中隱藏的子項;否則,FALSE。 預設值為 TRUE。|

### <a name="return-value"></a>傳回值

展開的子項的數量。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygethierarchylevel"></a><a name="gethierarchylevel"></a>CMFC 屬性網格屬性:取得層次結構等級

檢索屬性層次結構級別的零基索引。

```
int GetHierarchyLevel() const;
```

### <a name="return-value"></a>傳回值

屬性的層次結構級別。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetname"></a><a name="getname"></a>CMFC財產網格屬性:取得名稱

檢索屬性的名稱。

```
LPCTSTR GetName() const;
```

### <a name="return-value"></a>傳回值

指向包含屬性名稱的字串的指標。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetnametooltip"></a><a name="getnametooltip"></a>CMFC財產網格屬性::獲取名稱工具提示

由框架呼叫以在工具提示中顯示屬性的名稱。

```
virtual CString GetNameTooltip();
```

### <a name="return-value"></a>傳回值

包含屬性名稱的字串。 預設情況下,返回值為空字串。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetoption"></a><a name="getoption"></a>CMFC財產網格屬性:取得選項

檢索由索引指定的選項的文本。

```
LPCTSTR GetOption(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要檢索的屬性清單項(選項)的零基索引。

### <a name="return-value"></a>傳回值

指向包含選項文字的字串的指標。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetoptioncount"></a><a name="getoptioncount"></a>CMFC財產網格屬性:獲取期權計數

檢索屬於屬性的選項數。

```
int GetOptionCount() const;
```

### <a name="return-value"></a>傳回值

屬性控制項包含的屬性清單項(選項)的數量。

### <a name="remarks"></a>備註

呼叫[CMFC 屬性網格屬性::AddOption](#addoption)方法以將項添加到屬性清單中。 呼叫[CMFC 屬性網格屬性::刪除所有選項](#removealloptions)方法以刪除所有專案。

## <a name="cmfcpropertygridpropertygetoriginalvalue"></a><a name="getoriginalvalue"></a>CMFC財產網格屬性:取得原始價值

檢索當前屬性的初始值。

```
const COleVariant& GetOriginalValue() const;
```

### <a name="return-value"></a>傳回值

當前屬性的原始值。

### <a name="remarks"></a>備註

使用此方法可以復原更改當前屬性值的編輯操作的效果。

當前屬性的原始值由[CMFC 屬性網格屬性設置::CMFC財產網格屬性構造函數](#cmfcpropertygridproperty),由[CMFC 屬性網格屬性修改::設置原始值](#setoriginalvalue)方法,並由[CMFC 屬性網格屬性::重置原始值](#resetoriginalvalue)方法重置。

## <a name="cmfcpropertygridpropertygetparent"></a><a name="getparent"></a>CMFC財產網格屬性:獲取父項

檢索指向父屬性的指標。

```
CMFCPropertyGridProperty* GetParent() const;
```

### <a name="return-value"></a>傳回值

指向父屬性物件的指標,或頂級屬性的 NULL。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetrect"></a><a name="getrect"></a>CMFC財產網格屬性:取得 Rect

檢索屬性的邊界矩形。

```
CRect GetRect() const;
```

### <a name="return-value"></a>傳回值

描述邊界矩形的[CRect](../../atl-mfc-shared/reference/crect-class.md)物件。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetsubitem"></a><a name="getsubitem"></a>CMFC財產網格屬性:取得子專案

檢索由零基索引標識的子屬性。

```
CMFCPropertyGridProperty* GetSubItem(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]要檢索的屬性的零基索引。 如果此參數小於零或大於或等於子屬性數,則此參數無效。

### <a name="return-value"></a>傳回值

指向作為此屬性子項的屬性物件的指標。

-或-

在零售模式下,如果*nIndex*參數無效,則 NULL。 在調試模式下,此方法斷言。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetsubitemscount"></a><a name="getsubitemscount"></a>CMFC 屬性網格屬性:取得子項目計數

檢索子項的數量。

```
int GetSubItemsCount() const;
```

### <a name="return-value"></a>傳回值

子項數。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetvalue"></a><a name="getvalue"></a>CMFC財產網格屬性:獲取價值

檢索屬性值。

```
virtual const _variant_t& GetValue() const;
```

### <a name="return-value"></a>傳回值

包含屬性值的變體。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertygetvaluetooltip"></a><a name="getvaluetooltip"></a>CMFC財產網格屬性:取得價值工具提示

由框架調用以檢索屬性值的文本表示形式,然後顯示在工具提示中。

```
virtual CString GetValueTooltip();
```

### <a name="return-value"></a>傳回值

包含`CString`屬性值的文本表示形式的物件。 預設情況下,此值為空字串。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyhasbutton"></a><a name="hasbutton"></a>CMFC財產網格屬性::哈斯按鈕

指示屬性是否包含按鈕。

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>傳回值

如果屬性包含按鈕(或屬性清單),則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyhittest"></a><a name="hittest"></a>CMFC財產網格屬性:hitTest

指向對應於點的屬性清單項的屬性物件。

```
CMFCPropertyGridProperty* HitTest(
    CPoint point,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL);

CMFCPropertyGridProperty* HitTest(
    CPoint pt,
    CMFCPropertyGridProperty::ClickArea* pnArea=NULL,
    BOOL bPropsOnly=FALSE) const;
```

### <a name="parameters"></a>參數

*點*<br/>
[在]要測試的點,在客戶端座標中。 此參數通常是當前滑鼠指標位置。

*pt*<br/>
[在]要測試的點,在客戶端座標中。

*pnArea*<br/>
[出]當此方法返回時,指示包含指定點的區域。 如需詳細資訊，請參閱＜備註＞。 預設值是 NULL。

*bProps*<br/>
[在]TRUE 以測試屬性控制中的任何區域;FALSE 僅測試描述區域。 預設值為 FALSE。

### <a name="return-value"></a>傳回值

指向屬性物件或 NULL 的指標。

### <a name="remarks"></a>備註

默認情況下,如果在任何屬性項中找不到指定的點,則此方法將測試屬性子項。

下表列出了可返回到*pnArea*參數的值。

|區域|描述|
|----------|-----------------|
|`ClickArea::ClickExpandBox`|展開框控件,由加號 (*) 指定。|
|`ClickArea::ClickName`|屬性名稱。|
|`ClickArea::ClickValue`|屬性值。|

## <a name="cmfcpropertygridpropertyinit"></a><a name="init"></a>CMFC財產網格屬性::Init

由框架調用以初始化屬性物件。

```cpp
void Init();
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisallowedit"></a><a name="isallowedit"></a>CMFC財產網格屬性::允許編輯

指示屬性是否可編輯。

```
BOOL IsAllowEdit() const;
```

### <a name="return-value"></a>傳回值

如果屬性是可編輯的,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisenabled"></a><a name="isenabled"></a>CMFC 屬性格格屬性:已開啟

指示屬性是啟用還是禁用。

```
BOOL IsEnabled() const;
```

### <a name="return-value"></a>傳回值

如果啟用了該屬性,則為 TRUE;如果啟用了該屬性,則為 TRUE。如果屬性已禁用,則 FALSE。

### <a name="remarks"></a>備註

告訴屬性是啟用還是禁用。

## <a name="cmfcpropertygridpropertyisexpanded"></a><a name="isexpanded"></a>CMFC財產網格屬性::已擴展

指示屬性是展開還是摺疊。

```
BOOL IsExpanded() const;
```

### <a name="return-value"></a>傳回值

如果屬性已展開,則為 TRUE;如果屬性已摺疊,則 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisgroup"></a><a name="isgroup"></a>CMFC財產網格屬性::IsGroup

指示當前屬性是否表示組。

```
BOOL IsGroup() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性物件表示組,則為 TRUE;如果當前屬性物件表示組。"如果屬性表示值,則 FALSE。

### <a name="remarks"></a>備註

*組*是屬性網格控件中相關屬性的集合。 如果控制項以分層方式顯示,*則群組名稱*將顯示為群組上方的行中的類別標題。

## <a name="cmfcpropertygridpropertyisinplaceediting"></a><a name="isinplaceediting"></a>CMFC財產網格屬性::位置編輯

指示當前屬性是否可編輯。

```
BOOL IsInPlaceEditing() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性可編輯,則為 TRUE;如果當前屬性可編輯,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyismodified"></a><a name="ismodified"></a>CMFC財產網格屬性:已修改

指示是否修改當前屬性。

```
BOOL IsModified() const;
```

### <a name="return-value"></a>傳回值

如果屬性被修改,則為 TRUE;如果屬性已修改,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisparentexpanded"></a><a name="isparentexpanded"></a>CMFC財產網格屬性::父級擴展

指示是否展開當前屬性的父項。

```
BOOL IsParentExpanded() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性的所有父項都展開,則為 TRUE;如果父屬性摺疊,則 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisselected"></a><a name="isselected"></a>CMFC財產網格屬性:已選定

指示是否選擇了當前屬性。

```
virtual BOOL IsSelected() const;
```

### <a name="return-value"></a>傳回值

如果選擇了當前屬性,則為 TRUE;如果選擇了當前屬性,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyissubitem"></a><a name="issubitem"></a>CMFC財產網格屬性::是子專案

指示指定的屬性是否是當前屬性的子項。

```
BOOL IsSubItem(CMFCPropertyGridProperty* pProp) const;
```

### <a name="parameters"></a>參數

*pProp*<br/>
[在]指向屬性的指標。

### <a name="return-value"></a>傳回值

如果指定的屬性是當前屬性的子項,則為 TRUE;如果指定屬性是當前屬性的子項,則為 TRUE。否則,FALSE。

## <a name="cmfcpropertygridpropertyisvaluechanged"></a><a name="isvaluechanged"></a>CMFC財產網格屬性::已更改價值

指示當前屬性的值是否已更改。

```
virtual BOOL IsValueChanged() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性的值已更改,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyisvisible"></a><a name="isvisible"></a>CMFC財產網格屬性:可見

指示當前屬性是否可見。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性可見,則為 TRUE;如果當前屬性為 TRUE,否則;假。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertym_strformatdouble"></a><a name="m_strformatdouble"></a>CMFC財產網格屬性::m_strFormatDouble

為雙精度類型值保留格式字串。

```
static CString m_strFormatDouble;
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertym_strformatfloat"></a><a name="m_strformatfloat"></a>CMFC財產網格屬性::m_strFormatFloat

為類型浮點的值保留格式字串。

```
static CString m_strFormatFloat;
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertym_strformatlong"></a><a name="m_strformatlong"></a>CMFC財產網格屬性::m_strFormatLong

為長類型的值保留格式字串。

```
static CString m_strFormatLong;
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertym_strformatshort"></a><a name="m_strformatshort"></a>CMFC財產網格屬性::m_strFormatShort

為短類型值保留格式字串。

```
static CString m_strFormatShort;
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyonclickbutton"></a><a name="onclickbutton"></a>CMFC財產網格屬性::點擊按鈕

使用者按一下屬性中內含的按鈕時由架構呼叫。

```
virtual void OnClickButton(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]用戶端座標中的點。

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonclickname"></a><a name="onclickname"></a>CMFC財產網格屬性::點擊名稱

當用戶按一下屬性的名稱欄位時,由父屬性清單控制件調用。

```
virtual void OnClickName(CPoint C);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*C*|[在]用戶端座標中的點。|

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonclickvalue"></a><a name="onclickvalue"></a>CMFC財產網格屬性::點擊值

當用戶按一下屬性的值欄位時,由父屬性清單控制件調用。

```
virtual BOOL OnClickValue(
    UINT uiMsg,
    CPoint point);
```

### <a name="parameters"></a>參數

*烏伊姆斯格*<br/>
[在]滑鼠消息。

*點*<br/>
[在]用戶端座標中的點。

### <a name="return-value"></a>傳回值

如果此方法處理了指定的滑鼠消息,則為 TRUE;如果此方法處理了指定的滑鼠消息。"否則,FALSE。

### <a name="remarks"></a>備註

預設情況下,如果當前屬性不可編輯,此方法將返回 FALSE。 否則,與此屬性關聯的編輯或旋轉控制項將處理指定的滑鼠訊息,然後此方法返回 TRUE。

## <a name="cmfcpropertygridpropertyonclosecombo"></a><a name="onclosecombo"></a>CMFC財產網格屬性::在關閉Combo

當屬性中包含的組合框關閉時,由框架調用。

```
virtual void OnCloseCombo();
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyonctlcolor"></a><a name="onctlcolor"></a>CMFC財產網格屬性::在CtlColor上

當必須檢索畫筆以填充屬性的背景顏色時,由框架調用。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*nCtlColor*<br/>
[在](不使用此參數。

### <a name="return-value"></a>傳回值

如果此方法成功,則對畫筆的句柄;否則,NULL。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyondblclk"></a><a name="ondblclk"></a>CMFC財產網格屬性::OnDblClk

當用戶雙擊屬性時,由框架調用。

```
virtual BOOL OnDblClk(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]用戶端座標中的點。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

預設情況下,此方法選擇屬性清單控制件中的下一個屬性項。

## <a name="cmfcpropertygridpropertyondestroywindow"></a><a name="ondestroywindow"></a>CMFC財產網格屬性::在銷毀視窗上

當屬性被銷毀或編輯完成時,由框架調用。

```
virtual void OnDestroyWindow();
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyondrawbutton"></a><a name="ondrawbutton"></a>CMFC財產網格屬性::在繪製按鈕

由框架調用以繪製包含在屬性中的按鈕。

```
virtual void OnDrawButton(
    CDC* pDC,
    CRect rectButton);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*rectButton*<br/>
[在]指定繪製按鈕的位置的邊界矩形。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyondrawdescription"></a><a name="ondrawdescription"></a>CMFC財產網格屬性::畫中的描述

由框架調用以繪製屬性描述。

```
virtual void OnDrawDescription(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*矩形*<br/>
[在]指定繪製屬性說明的位置的邊界矩形。

### <a name="remarks"></a>備註

預設情況下,此方法在父屬性清單控制件使用的字型中繪製屬性名稱和說明。 屬性描述以常規樣式繪製,屬性名稱以粗體樣式繪製。

## <a name="cmfcpropertygridpropertyondrawexpandbox"></a><a name="ondrawexpandbox"></a>CMFC財產網格屬性::OnDraw 擴展框

由框架調用,以在包含子屬性的屬性附近繪製展開框控制元件。

```
virtual void OnDrawExpandBox(
    CDC* pDC,
    CRect rectExpand);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*重新延伸*<br/>
[在]指定繪製展開框控制器的位置的邊界矩形。

### <a name="remarks"></a>備註

按下展開框控制項以展開或摺疊子屬性清單。 展開框控制項由包含加 (+) 或減 (-) 符號的正方形指定。 加號表示可以展開該屬性以顯示子屬性的清單。 減號表示清單可以摺疊以僅顯示屬性。

## <a name="cmfcpropertygridpropertyondrawname"></a><a name="ondrawname"></a>CMFC財產網格屬性::畫名

由框架調用以顯示屬性名稱。

```
virtual void OnDrawName(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*矩形*<br/>
[在]指定在何處繪製屬性名稱的邊界矩形。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyondrawvalue"></a><a name="ondrawvalue"></a>CMFC財產網格屬性::拉平價值

由架構呼叫以顯示屬性值。

```
virtual void OnDrawValue(
    CDC* pDC,
    CRect rect);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*矩形*<br/>
[在]指定繪製屬性值的位置的邊界矩形。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyonedit"></a><a name="onedit"></a>CMFC財產網格屬性::編輯

使用者即將修改屬性值時由架構呼叫。

```
virtual BOOL OnEdit(LPPOINT lptClick);
```

### <a name="parameters"></a>參數

*lptClick*<br/>
[在](不使用此參數。指向點(在用戶端座標中的指標)。

### <a name="return-value"></a>傳回值

如果編輯操作成功啟動,則為 TRUE;如果編輯操作成功啟動,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

當使用者要修改屬性值時,框架將調用此功能。 默認情況下,此方法啟動組合框控制項或旋轉控制項的相應編輯器。

## <a name="cmfcpropertygridpropertyonendedit"></a><a name="onendedit"></a>CMFC財產網格屬性::結束編輯

當使用者完成修改屬性值時,由框架調用。

```
virtual BOOL OnEndEdit();
```

### <a name="return-value"></a>傳回值

此方法始終返回 TRUE。

### <a name="remarks"></a>備註

預設情況下,此方法會破壞當前編輯控件,然後返回 TRUE。

## <a name="cmfcpropertygridpropertyonkillfocus"></a><a name="onkillfocus"></a>CMFC財產網格屬性::在基爾焦點

當屬性失去輸入焦點時,由框架調用。

```
virtual BOOL OnKillFocus(CWnd*);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*CWnd*|[在](未使用。指向視窗的指標。|

### <a name="return-value"></a>傳回值

此方法始終返回 TRUE。

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作,然後返回 TRUE。 如果重寫此方法,如果框架可以在屬性丟失輸入焦點時結束編輯操作,則返回 TRUE。

## <a name="cmfcpropertygridpropertyonkillselection"></a><a name="onkillselection"></a>CMFC財產網格屬性::在基爾選擇

```
virtual void OnKillSelection(CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>參數

[在]*CMFC財產&#42;*<br/>

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonpossizechanged"></a><a name="onpossizechanged"></a>CMFC財產網格屬性::在Possize上更改

```
virtual void OnPosSizeChanged(CRect);
```

### <a name="parameters"></a>參數

[在]*CRect*<br/>

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonrclickname"></a><a name="onrclickname"></a>CMFC財產網格屬性::點擊名稱

當用戶單擊屬性名稱區域中的滑鼠右鍵時,由框架調用。

```
virtual void OnRClickName(CPoint C);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*C*|[在]用戶端座標中的點。|

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonrclickvalue"></a><a name="onrclickvalue"></a>CMFC財產網格屬性::點擊價值

當用戶單擊屬性值區域中的滑鼠右鍵時,由框架調用。

```
virtual void OnRClickValue(
    CPoint C,
    BOOL B);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*C*|[在]用戶端座標中的點。|
|*B*|[在]一個布爾。|

### <a name="remarks"></a>備註

預設情況下,此方法不執行任何操作,*並且 B*參數沒有預定義用途。

## <a name="cmfcpropertygridpropertyonselectcombo"></a><a name="onselectcombo"></a>CMFC財產網格屬性::在選擇Combo

當使用者從可編輯組合框中選擇專案時,由框架調用。

```
virtual void OnSelectCombo();
```

### <a name="remarks"></a>備註

預設情況下,此方法使用所選項的文本來更新屬性值。

## <a name="cmfcpropertygridpropertyonsetcursor"></a><a name="onsetcursor"></a>CMFC財產網格屬性::打開游標

當滑鼠指標移動到屬性項時,由框架調用。

```
virtual BOOL OnSetCursor() const;
```

### <a name="return-value"></a>傳回值

如果當前屬性是變體類型或值列表,並且此方法成功載入插入點(I-beam)滑鼠游標,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法支援以下變體類型:VT_INT、VT_I2、VT_I4、VT_UINT、VT_UI1、VT_UI2、VT_UI4、VT_R4、VT_R8和VT_BSTR。

## <a name="cmfcpropertygridpropertyonsetselection"></a><a name="onsetselection"></a>CMFC財產網格屬性::打開選擇

```
virtual void OnSetSelection CMFCPropertyGridProperty*);
```

### <a name="parameters"></a>參數

[在]*CMFC財產&#42;*<br/>

### <a name="remarks"></a>備註

默認情況下,此方法不執行任何操作。

## <a name="cmfcpropertygridpropertyonupdatevalue"></a><a name="onupdatevalue"></a>CMFC財產網格屬性:更新值

當可編輯屬性的值變更時由架構呼叫。

```
virtual BOOL OnUpdateValue();
```

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertypushchar"></a><a name="pushchar"></a>CMFC財產網格屬性::P

選擇屬性並且使用者輸入新字元時從屬性清單控制項調用。

```
virtual BOOL PushChar(UINT nChar);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
[在]字元。

### <a name="return-value"></a>傳回值

如果編輯操作繼續,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法支援一個屬性,該屬性是值清單或以下變體類型之一:VT_INT、VT_I2、VT_I4、VT_UINT、VT_UI1、VT_UI2、VT_UI4、VT_R4、VT_R8和VT_BSTR。

## <a name="cmfcpropertygridpropertyredraw"></a><a name="redraw"></a>CMFC財產網格屬性:重繪

重繪屬性。

```cpp
void Redraw();
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyremovealloptions"></a><a name="removealloptions"></a>CMFC 屬性網格屬性::刪除所有選項

從屬性中刪除所有選項(專案)。

```cpp
void RemoveAllOptions();
```

### <a name="remarks"></a>備註

選項也稱為屬性清單控制件的清單項。

## <a name="cmfcpropertygridpropertyremovesubitem"></a><a name="removesubitem"></a>CMFC 屬性網格屬性::刪除子專案

刪除指定的子項。

```
BOOL RemoveSubItem(
    CMFCPropertyGridProperty*& pProp,
    BOOL bDelete=TRUE);
```

### <a name="parameters"></a>參數

*pProp*<br/>
[在]指向屬性子項的指標。

*b 刪除*<br/>
[在]TRUE 刪除*pProp*參數指定的屬性物件;否則,FALSE。 預設值為 TRUE。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

如果要移動指定的子項,請為*bDelete*參數指定 FALSE;即刪除子項,然後將其添加到其他位置。

## <a name="cmfcpropertygridpropertyresetoriginalvalue"></a><a name="resetoriginalvalue"></a>CMFC財產網格屬性:重置原始值

還原編輯屬性的原始值。

```
virtual void ResetOriginalValue();
```

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertysetdata"></a><a name="setdata"></a>CMFC財產網格屬性::數據集

將 DWORD 值與屬性關聯。

```cpp
void SetData(DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*dwData*<br/>
[在]特定於應用程式的 32 位值,如整數或指向其他數據的指標。

### <a name="remarks"></a>備註

使用[CMFC 屬性網格屬性:getData](#getdata)方法檢索 DWORD 值。 使用[CMFC 屬性網格Ctrl:尋找ItemByData](../../mfc/reference/cmfcpropertygridctrl-class.md#finditembydata)方法尋找與指定 DWORD 值關聯的屬性清單項。

## <a name="cmfcpropertygridpropertysetdescription"></a><a name="setdescription"></a>CMFC 屬性網格屬性::設定描述

指定描述目前的屬性的文字。

```cpp
void SetDescription(const CString& strDescr);
```

### <a name="parameters"></a>參數

*斯特德施克*<br/>
[在]描述目前的屬性的文字。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertysetname"></a><a name="setname"></a>CMFC 屬性網格屬性::設定名稱

設置屬性的名稱。

```cpp
void SetName(
    LPCTSTR lpszName,
    BOOL bRedraw=TRUE);
```

### <a name="parameters"></a>參數

*lpsz名稱*<br/>
[在]屬性名稱。

*bredraw*<br/>
[在]TRUE 立即重繪屬性;否則,FALSE。 預設值為 TRUE。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertysetoriginalvalue"></a><a name="setoriginalvalue"></a>CMFC財產網格屬性::設置原始價值

設定可編輯屬性的原始值。

```
virtual void SetOriginalValue(const COleVariant& varValue);
```

### <a name="parameters"></a>參數

*varValue*<br/>
[在]值。

### <a name="remarks"></a>備註

使用[CMFC 屬性網格屬性:重置原始值](#resetoriginalvalue)方法重置已編輯屬性的原始值。

## <a name="cmfcpropertygridpropertysetvalue"></a><a name="setvalue"></a>CMFC財產網格屬性::設置價值

設置屬性網格屬性的值。

```
virtual void SetValue(const _variant_t& varValue);
```

### <a name="parameters"></a>參數

*varValue*<br/>
[在]對值的引用。

### <a name="remarks"></a>備註

## <a name="cmfcpropertygridpropertyshow"></a><a name="show"></a>CMFC 財產網格屬性:顯示

顯示或隱藏屬性。

```cpp
void Show(
    BOOL bShow=TRUE,
    BOOL bAdjustLayout=TRUE);
```

### <a name="parameters"></a>參數

*b 顯示*<br/>
[在]TRUE 以顯示當前屬性及其子項;FALSE 以隱藏當前屬性及其子項。 預設值為 TRUE。

*b 調整佈局*<br/>
[在]TRUE 以重新計算如何繪製屬性的標籤和值,然後繪製屬性;FALSE 用於使用現有計算繪製屬性。 預設值為 TRUE。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCPropertyGridCtrl 類別](../../mfc/reference/cmfcpropertygridctrl-class.md)
