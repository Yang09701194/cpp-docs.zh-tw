---
title: CMFCRibbonButton 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::CMFCRibbonButton
- AFXRIBBONBUTTON/CMFCRibbonButton::AddSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::CanBeStretched
- AFXRIBBONBUTTON/CMFCRibbonButton::CleanUpSizes
- AFXRIBBONBUTTON/CMFCRibbonButton::ClosePopupMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawBottomText
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawImage
- AFXRIBBONBUTTON/CMFCRibbonButton::DrawRibbonText
- AFXRIBBONBUTTON/CMFCRibbonButton::FindSubItemIndexByID
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCommandRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetCompactSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIcon
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::GetImageSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetIntermediateSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::GetMenuRect
- AFXRIBBONBUTTON/CMFCRibbonButton::GetRegularSize
- AFXRIBBONBUTTON/CMFCRibbonButton::GetSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::GetTextRowHeight
- AFXRIBBONBUTTON/CMFCRibbonButton::GetToolTipText
- AFXRIBBONBUTTON/CMFCRibbonButton::HasCompactMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasIntermediateMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasLargeMode
- AFXRIBBONBUTTON/CMFCRibbonButton::HasMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::IsAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsApplicationButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsCommandAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDefaultPanelButton
- AFXRIBBONBUTTON/CMFCRibbonButton::IsDrawTooltipImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuAreaHighlighted
- AFXRIBBONBUTTON/CMFCRibbonButton::IsMenuOnBottom
- AFXRIBBONBUTTON/CMFCRibbonButton::IsPopupDefaultMenuLook
- AFXRIBBONBUTTON/CMFCRibbonButton::IsRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::IsSingleLineText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnCalcTextSize
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDrawBorder
- AFXRIBBONBUTTON/CMFCRibbonButton::OnDraw
- AFXRIBBONBUTTON/CMFCRibbonButton::OnFillBackground
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveAllSubItems
- AFXRIBBONBUTTON/CMFCRibbonButton::RemoveSubItem
- AFXRIBBONBUTTON/CMFCRibbonButton::SetACCData
- AFXRIBBONBUTTON/CMFCRibbonButton::SetAlwaysLargeImage
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDefaultCommand
- AFXRIBBONBUTTON/CMFCRibbonButton::SetDescription
- AFXRIBBONBUTTON/CMFCRibbonButton::SetImageIndex
- AFXRIBBONBUTTON/CMFCRibbonButton::SetMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetParentCategory
- AFXRIBBONBUTTON/CMFCRibbonButton::SetRightAlignMenu
- AFXRIBBONBUTTON/CMFCRibbonButton::SetText
- AFXRIBBONBUTTON/CMFCRibbonButton::OnClick
helpviewer_keywords:
- CMFCRibbonButton [MFC], CMFCRibbonButton
- CMFCRibbonButton [MFC], AddSubItem
- CMFCRibbonButton [MFC], CanBeStretched
- CMFCRibbonButton [MFC], CleanUpSizes
- CMFCRibbonButton [MFC], ClosePopupMenu
- CMFCRibbonButton [MFC], DrawBottomText
- CMFCRibbonButton [MFC], DrawImage
- CMFCRibbonButton [MFC], DrawRibbonText
- CMFCRibbonButton [MFC], FindSubItemIndexByID
- CMFCRibbonButton [MFC], GetCommandRect
- CMFCRibbonButton [MFC], GetCompactSize
- CMFCRibbonButton [MFC], GetIcon
- CMFCRibbonButton [MFC], GetImageIndex
- CMFCRibbonButton [MFC], GetImageSize
- CMFCRibbonButton [MFC], GetIntermediateSize
- CMFCRibbonButton [MFC], GetMenu
- CMFCRibbonButton [MFC], GetMenuRect
- CMFCRibbonButton [MFC], GetRegularSize
- CMFCRibbonButton [MFC], GetSubItems
- CMFCRibbonButton [MFC], GetTextRowHeight
- CMFCRibbonButton [MFC], GetToolTipText
- CMFCRibbonButton [MFC], HasCompactMode
- CMFCRibbonButton [MFC], HasIntermediateMode
- CMFCRibbonButton [MFC], HasLargeMode
- CMFCRibbonButton [MFC], HasMenu
- CMFCRibbonButton [MFC], IsAlwaysDrawBorder
- CMFCRibbonButton [MFC], IsAlwaysLargeImage
- CMFCRibbonButton [MFC], IsApplicationButton
- CMFCRibbonButton [MFC], IsCommandAreaHighlighted
- CMFCRibbonButton [MFC], IsDefaultCommand
- CMFCRibbonButton [MFC], IsDefaultPanelButton
- CMFCRibbonButton [MFC], IsDrawTooltipImage
- CMFCRibbonButton [MFC], IsLargeImage
- CMFCRibbonButton [MFC], IsMenuAreaHighlighted
- CMFCRibbonButton [MFC], IsMenuOnBottom
- CMFCRibbonButton [MFC], IsPopupDefaultMenuLook
- CMFCRibbonButton [MFC], IsRightAlignMenu
- CMFCRibbonButton [MFC], IsSingleLineText
- CMFCRibbonButton [MFC], OnCalcTextSize
- CMFCRibbonButton [MFC], OnDrawBorder
- CMFCRibbonButton [MFC], OnDraw
- CMFCRibbonButton [MFC], OnFillBackground
- CMFCRibbonButton [MFC], RemoveAllSubItems
- CMFCRibbonButton [MFC], RemoveSubItem
- CMFCRibbonButton [MFC], SetACCData
- CMFCRibbonButton [MFC], SetAlwaysLargeImage
- CMFCRibbonButton [MFC], SetDefaultCommand
- CMFCRibbonButton [MFC], SetDescription
- CMFCRibbonButton [MFC], SetImageIndex
- CMFCRibbonButton [MFC], SetMenu
- CMFCRibbonButton [MFC], SetParentCategory
- CMFCRibbonButton [MFC], SetRightAlignMenu
- CMFCRibbonButton [MFC], SetText
- CMFCRibbonButton [MFC], OnClick
ms.assetid: 732e941c-9504-4b83-a691-d18075965d53
ms.openlocfilehash: e25a375f8bf5769a4a118318eac272db93062cbf
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752509"
---
# <a name="cmfcribbonbutton-class"></a>CMFCRibbonButton 類別

`CMFCRibbonButton` 類別實作可以放置在功能區列項目 (例如面板、快速存取工具列和快顯功能表) 上的按鈕。

有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCRibbonButton : public CMFCRibbonBaseElement
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFC功能功能按鈕:CMFC功能功能按鈕](#cmfcribbonbutton)|建構功能區按鈕物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonButton::AddSubItem](#addsubitem)|將功能表項目加入至與按鈕相關聯的快顯功能表。|
|[CMFCRibbonButton::CanBeStretched](#canbestretched)|(覆蓋[CMFC 功能基礎元素::可以拉伸](../../mfc/reference/cmfcribbonbaseelement-class.md#canbestretched).)|
|[CMFCRibbonButton::CleanUpSizes](#cleanupsizes)|(覆寫[CMFC 功能基礎元素::清理調整大小](../../mfc/reference/cmfcribbonbaseelement-class.md#cleanupsizes)。|
|[CMFCRibbonButton::ClosePopupMenu](#closepopupmenu)|(覆蓋[CMFC 功能基礎元素::閉合彈出選單](../../mfc/reference/cmfcribbonbaseelement-class.md#closepopupmenu).)|
|[CMFCRibbonButton::DrawBottomText](#drawbottomtext)||
|[CMFCRibbonButton::DrawImage](#drawimage)|(覆寫[CMFC 功能基礎元素::D原始影像](../../mfc/reference/cmfcribbonbaseelement-class.md#drawimage).)|
|[CMFCRibbonButton::DrawRibbonText](#drawribbontext)||
|[CMFCRibbonButton::FindSubItemIndexByID](#findsubitemindexbyid)|傳回與指定之命令識別碼相關聯的快顯功能表項目索引。|
|[CMFCRibbonButton::GetCommandRect](#getcommandrect)||
|[CMFCRibbonButton::GetCompactSize](#getcompactsize)|傳回功能區項目的壓縮大小。 (覆寫[CMFC 功能基礎元素:取得壓縮大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getcompactsize).)|
|[CMFCRibbonButton::GetIcon](#geticon)||
|[CMFCRibbonButton::GetImageIndex](#getimageindex)|傳回與按鈕相關聯的映像索引。|
|[CMFCRibbonButton::GetImageSize](#getimagesize)|傳回功能區項目的影像大小。 ( 覆寫[CMFC 功能基礎元素:取得影像大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getimagesize).)|
|[CMFCRibbonButton::GetIntermediateSize](#getintermediatesize)|傳回中繼狀態之功能區項目的大小。 (覆寫[CMFC 功能基礎元素:取得中間大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getintermediatesize).)|
|[CMFCRibbonButton::GetMenu](#getmenu)|傳回已指派給功能區按鈕之 Windows 功能表的控制代碼。|
|[CMFCRibbonButton::GetMenuRect](#getmenurect)||
|[CMFCRibbonButton::GetRegularSize](#getregularsize)|傳回功能區項目的一般大小。 (覆寫[CMFC 功能基礎元素:取得一般大小](../../mfc/reference/cmfcribbonbaseelement-class.md#getregularsize).)|
|[CMFCRibbonButton::GetSubItems](#getsubitems)||
|[CMFCRibbonButton::GetTextRowHeight](#gettextrowheight)||
|[CMFCRibbonButton::GetToolTipText](#gettooltiptext)|傳回功能區項目的工具提示文字。 ( 覆寫[CMFC 功能基礎元素:抓取工具提示文字](../../mfc/reference/cmfcribbonbaseelement-class.md#gettooltiptext).)|
|[CMFCRibbonButton::HasCompactMode](#hascompactmode)|指定功能區項目是否有精簡模式。 (覆蓋[CMFC 功能基礎元素::具有壓縮模式](../../mfc/reference/cmfcribbonbaseelement-class.md#hascompactmode).)|
|[CMFCRibbonButton::HasIntermediateMode](#hasintermediatemode)|指定功能區項目是否有中繼模式。 (覆蓋[CMFC 功能基礎元素::具有中間模式](../../mfc/reference/cmfcribbonbaseelement-class.md#hasintermediatemode).)|
|[CMFCRibbonButton::HasLargeMode](#haslargemode)|指定功能區項目是否有大型模式。 (覆蓋[CMFC 功能基礎元素::具有大模式](../../mfc/reference/cmfcribbonbaseelement-class.md#haslargemode).)|
|[CMFCRibbonButton::HasMenu](#hasmenu)|(覆蓋[CMFC 功能基礎元素::哈斯梅因](../../mfc/reference/cmfcribbonbaseelement-class.md#hasmenu).)|
|[CMFCRibbonButton::IsAlwaysDrawBorder](#isalwaysdrawborder)||
|[CMFCRibbonButton::IsAlwaysLargeImage](#isalwayslargeimage)|(覆蓋[CMFC 功能基礎元素::是始終較大的圖像](../../mfc/reference/cmfcribbonbaseelement-class.md#isalwayslargeimage).)|
|[CMFCRibbonButton::IsApplicationButton](#isapplicationbutton)||
|[CMFCRibbonButton::IsCommandAreaHighlighted](#iscommandareahighlighted)||
|[CMFCRibbonButton::IsDefaultCommand](#isdefaultcommand)|判定您是否已啟用功能區按鈕的預設命令。|
|[CMFCRibbonButton::IsDefaultPanelButton](#isdefaultpanelbutton)||
|[CMFCRibbonButton::IsDrawTooltipImage](#isdrawtooltipimage)||
|[CMFCRibbonButton::IsLargeImage](#islargeimage)||
|[CMFCRibbonButton::IsMenuAreaHighlighted](#ismenuareahighlighted)||
|[CMFCRibbonButton::IsMenuOnBottom](#ismenuonbottom)||
|[CMFCRibbonButton::IsPopupDefaultMenuLook](#ispopupdefaultmenulook)||
|[CMFCRibbonButton::IsRightAlignMenu](#isrightalignmenu)|判定功能表是否靠右對齊。|
|[CMFCRibbonButton::IsSingleLineText](#issinglelinetext)||
|[CMFCRibbonButton::OnCalcTextSize](#oncalctextsize)|(覆蓋[CMFC 功能基礎元素::在CalcTextSize](../../mfc/reference/cmfcribbonbaseelement-class.md#oncalctextsize)上。|
|[CMFCRibbonButton::OnDrawBorder](#ondrawborder)||
|[CMFCRibbonButton::OnDraw](#ondraw)|由架構呼叫以繪製功能區項目。 (覆寫[CMFC 功能基礎元素:onDraw](../../mfc/reference/cmfcribbonbaseelement-class.md#ondraw).)|
|[CMFCRibbonButton::OnFillBackground](#onfillbackground)||
|[CMFCRibbonButton::RemoveAllSubItems](#removeallsubitems)|從快顯功能表中移除所有功能表項目。|
|[CMFCRibbonButton::RemoveSubItem](#removesubitem)|從快顯功能表中移除功能表項目。|
|[CMFCRibbonButton::SetACCData](#setaccdata)|(覆寫[CMFC 功能基礎元素:設定ACC資料](../../mfc/reference/cmfcribbonbaseelement-class.md#setaccdata).)|
|[CMFCRibbonButton::SetAlwaysLargeImage](#setalwayslargeimage)|指定使用者摺疊按鈕時，按鈕是顯示大型影像還是小型影像。|
|[CMFCRibbonButton::SetDefaultCommand](#setdefaultcommand)|啟用功能區按鈕的預設命令。|
|[CMFCRibbonButton::SetDescription](#setdescription)|設定功能區項目的描述。 (覆寫[CMFC 功能基礎元素:設定描述](../../mfc/reference/cmfcribbonbaseelement-class.md#setdescription).)|
|[CMFCRibbonButton::SetImageIndex](#setimageindex)|將索引指派給按鈕的影像。|
|[CMFCRibbonButton::SetMenu](#setmenu)|將快顯功能表上指派給功能區按鈕。|
|[CMFCRibbonButton::SetParentCategory](#setparentcategory)|(覆寫[CMFC 功能基礎元素:設定父項目](../../mfc/reference/cmfcribbonbaseelement-class.md#setparentcategory).)|
|[CMFCRibbonButton::SetRightAlignMenu](#setrightalignmenu)|將快顯功能表對齊按鈕右邊。|
|[CMFCRibbonButton::SetText](#settext)|設定功能區項目的文字。 (覆寫[CMFC 功能基礎元素::設定文字](../../mfc/reference/cmfcribbonbaseelement-class.md#settext).)|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonButton::OnClick](#onclick)|使用者按一下按鈕時由架構呼叫。|

## <a name="example"></a>範例

下列範例示範如何在 `CMFCRibbonButton` 類別中使用各種方法。 此範例示範如何建構 `CMFCRibbonButton` 類別的物件、將快顯功能表指派給功能區按鈕、設定按鈕的描述、從快顯功能表中移除功能表項目，以及將快顯功能表靠右對齊按鈕的邊緣。

[!code-cpp[NVC_MFC_RibbonApp#7](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_1.cpp)]

## <a name="remarks"></a>備註

要在應用程式中使用功能區按鈕,請建構按鈕物件並將其添加到相應的功能區[面板](../../mfc/reference/cmfcribbonpanel-class.md)中。

```cpp
CMFCRibbonPanel* pPanel = pCategory->AddPanel (
    _T("Clipboard"), // Panel name
    m_PanelIcons.ExtractIcon (0)); // Panel icon

// Create the first button ("Paste"):
CMFCRibbonButton* pPasteButton =
    new CMFCRibbonButton (ID_EDIT_PASTE, _T("Paste"), -1, 0);

// The third parameter (-1) disables small images for button.
// This button is always displayed with a large image
// Associate a pop-up menu with the "Paste" button:
pPasteButton->SetMenu (IDR_CONTEXT_MENU);

// Add buttons to the panel. These buttons have only small images.
pPanel->Add (new CMFCRibbonButton (ID_EDIT_CUT, _T("Cut"), 1));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_COPY, _T("Copy"), 2));
pPanel->Add (new CMFCRibbonButton (ID_EDIT_PAINT, _T("Paint"), 9));
```

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)

[CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxribbonbutton.h

## <a name="cmfcribbonbuttonaddsubitem"></a><a name="addsubitem"></a>CMFC 功能按鈕::新增子項

將功能表項目加入至與按鈕相關聯的快顯功能表。

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1);
```

### <a name="parameters"></a>參數

*p 子項目*<br/>
[在]指定指向要添加的新元素的指標。

*nIndex*<br/>
[在]指定要將元素添加到按鈕的功能表項陣列的索引;-1 以在功能表項陣列的末尾添加元素。

## <a name="cmfcribbonbuttoncanbestretched"></a><a name="canbestretched"></a>CMFC 功能按鈕::可拉伸

```
virtual BOOL CanBeStretched();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttoncleanupsizes"></a><a name="cleanupsizes"></a>CMFC 功能按鈕::清理放大縮小字型功能

```
virtual void CleanUpSizes();
```

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonclosepopupmenu"></a><a name="closepopupmenu"></a>CMFC功能按鈕::關閉彈出選單

```
virtual void ClosePopupMenu();
```

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttoncmfcribbonbutton"></a><a name="cmfcribbonbutton"></a>CMFC功能功能按鈕:CMFC功能功能按鈕

建構功能區按鈕物件。

```
CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex=-1,
    int nLargeImageIndex=-1,
    BOOL bAlwaysShowDescription=FALSE);

CMFCRibbonButton(
    UINT nID,
    LPCTSTR lpszText,
    HICON hIcon,
    BOOL bAlwaysShowDescription=FALSE,
    HICON hIconSmall=NULL,
    BOOL bAutoDestroyIcon=FALSE,
    BOOL bAlphaBlendIcon=FALSE);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]指定按鈕的命令識別碼。

*lpszText*<br/>
[在]指定按鈕的文字標籤。

*n 小圖像索引*<br/>
[在]在父類別的圖像清單中指定按鈕小圖像的零基索引。

*nLargeImageIndex*<br/>
[在]在父類別的圖像清單中指定按鈕大圖像的零基索引。

*hIcon*<br/>
[在]指定應用程式用作按鈕圖像的圖示的句柄。

### <a name="example"></a>範例

下面的示例演示如何構造`CMFCRibbonButton`物件。

[!code-cpp[NVC_MFC_RibbonApp#6](../../mfc/reference/codesnippet/cpp/cmfcribbonbutton-class_2.cpp)]

## <a name="cmfcribbonbuttondrawbottomtext"></a><a name="drawbottomtext"></a>CMFC功能框架按鈕::D原始文字

```
CSize DrawBottomText(
    CDC* pDC,
    BOOL bCalcOnly);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*bCalcOnly*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttondrawimage"></a><a name="drawimage"></a>CMFC功能按鈕::D原始影像

```
virtual void DrawImage(
    CDC* pDC,
    RibbonImageType type,
    CRect rectImage);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*類型*<br/>
[在]*rectImage*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttondrawribbontext"></a><a name="drawribbontext"></a>CMFC功能框架按鈕::D原始剪彩文字

```
virtual int DrawRibbonText(
    CDC* pDC,
    const CString& strText,
    CRect rectText,
    UINT uiDTFlags,
    COLORREF clrText = (COLORREF)-1);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*斯特文字*<br/>
[在]*整文*<br/>
[在]*uiDTFlags*<br/>
[在]*clrText*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonfindsubitemindexbyid"></a><a name="findsubitemindexbyid"></a>CMFC 功能按鈕::尋找子項目索引 ByID

傳回與指定之命令識別碼相關聯的快顯功能表項目索引。

```
int FindSubItemIndexByID(UINT uiID) const;
```

### <a name="parameters"></a>參數

*uiID*<br/>
[在]指定彈出功能表項的命令 ID。

### <a name="return-value"></a>傳回值

與*uiID*關聯的子項的零基索引。 -1 如果沒有此類子專案。

## <a name="cmfcribbonbuttongetcommandrect"></a><a name="getcommandrect"></a>CMFC 功能按鈕::取得命令雷ct

```
CRect GetCommandRect() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetcompactsize"></a><a name="getcompactsize"></a>CMFC 功能按鈕:取得壓縮尺寸

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongeticon"></a><a name="geticon"></a>CMFC功能按鈕:GetIcon

```
HICON GetIcon(BOOL bLargeIcon = TRUE) const;
```

### <a name="parameters"></a>參數

[在]*bLargeIcon*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetimageindex"></a><a name="getimageindex"></a>CMFC功能按鈕:取得影像索引

傳回與按鈕相關聯的映像索引。

```
int GetImageIndex(BOOL bLargeImage) const;
```

### <a name="parameters"></a>參數

*bLargeImage*<br/>
[在]如果為 TRUE,則返回包含大圖像的圖像清單中的圖像索引;如果為 TRUE,則返回包含大圖像的圖像索引。否則,將返回包含小圖像的圖像清單中的圖像索引。

### <a name="return-value"></a>傳回值

關聯圖像清單中按鈕圖像的索引。

## <a name="cmfcribbonbuttongetimagesize"></a><a name="getimagesize"></a>CMFC 功能按鈕:抓取影像大小

```
virtual CSize GetImageSize(RibbonImageType type) const;
```

### <a name="parameters"></a>參數

[在]*類型*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetintermediatesize"></a><a name="getintermediatesize"></a>CMFC 功能按鈕:取得中間大小

```
virtual CSize GetIntermediateSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetmenu"></a><a name="getmenu"></a>CMFC功能按鈕:取得選單

傳回已指派給功能區按鈕之 Windows 功能表的控制代碼。

```
HMENU GetMenu() const;
```

### <a name="return-value"></a>傳回值

分配給按鈕的 Windows 功能表的句柄;如果沒有分配功能表,則為 NULL。

## <a name="cmfcribbonbuttongetmenurect"></a><a name="getmenurect"></a>CMFC功能按鈕::取得選單

```
CRect GetMenuRect() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetregularsize"></a><a name="getregularsize"></a>CMFC 功能按鈕:取得一般大小

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongetsubitems"></a><a name="getsubitems"></a>CMFC 功能按鈕:抓取子項目

```
const CArray<CMFCRibbonBaseElement*, CMFCRibbonBaseElement*>& GetSubItems() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongettextrowheight"></a><a name="gettextrowheight"></a>CMFC 功能按鈕::取得文字行高度

```
int GetTextRowHeight() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttongettooltiptext"></a><a name="gettooltiptext"></a>CMFC 功能按鈕:抓取工具提示文字

```
virtual CString GetToolTipText() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonhascompactmode"></a><a name="hascompactmode"></a>CMFC功能按鈕::具有壓縮模式

```
virtual BOOL HasCompactMode() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonhasintermediatemode"></a><a name="hasintermediatemode"></a>CMFC 功能按鈕::具有中間模式

```
virtual BOOL HasIntermediateMode() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonhaslargemode"></a><a name="haslargemode"></a>CMFC 功能按鈕::具有大模式

```
virtual BOOL HasLargeMode() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonhasmenu"></a><a name="hasmenu"></a>CMFC功能按鈕::哈斯梅因

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisalwaysdrawborder"></a><a name="isalwaysdrawborder"></a>CMFC 功能按鈕::始終繪製邊框

```
virtual BOOL IsAlwaysDrawBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisalwayslargeimage"></a><a name="isalwayslargeimage"></a>CMFC 功能按鈕::始終顯示大型圖像

```
virtual BOOL IsAlwaysLargeImage() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisapplicationbutton"></a><a name="isapplicationbutton"></a>CMFC功能按鈕::是應用按鈕

```
virtual BOOL IsApplicationButton() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttoniscommandareahighlighted"></a><a name="iscommandareahighlighted"></a>CMFC 功能按鈕::是命令區域突出顯示

```
virtual BOOL IsCommandAreaHighlighted() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisdefaultcommand"></a><a name="isdefaultcommand"></a>CMFC 功能按鈕::預設命令

指定是否啟用功能區按鈕的預設命令。

```
BOOL IsDefaultCommand() const;
```

### <a name="return-value"></a>傳回值

如果啟用了功能區按鈕的預設命令,則為 TRUE;否則。

## <a name="cmfcribbonbuttonisdefaultpanelbutton"></a><a name="isdefaultpanelbutton"></a>CMFC 功能按鈕::預設面板按鈕

```
virtual BOOL IsDefaultPanelButton() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisdrawtooltipimage"></a><a name="isdrawtooltipimage"></a>CMFC 功能按鈕::正在繪製工具提示影像

```
virtual BOOL IsDrawTooltipImage() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonislargeimage"></a><a name="islargeimage"></a>CMFC 功能按鈕::大圖像

```
BOOL IsLargeImage() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonismenuareahighlighted"></a><a name="ismenuareahighlighted"></a>CMFC 功能按鈕::正選單區域突出顯示

```
virtual BOOL IsMenuAreaHighlighted() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonismenuonbottom"></a><a name="ismenuonbottom"></a>CMFC功能按鈕::ismenuonon

```
BOOL IsMenuOnBottom() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonispopupdefaultmenulook"></a><a name="ispopupdefaultmenulook"></a>CMFC 功能按鈕::是彈出預設選單檢視

```
virtual BOOL IsPopupDefaultMenuLook() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonisrightalignmenu"></a><a name="isrightalignmenu"></a>CMFC功能按鈕::右對齊選單

指定選單是否正確對齊。

```
BOOL IsRightAlignMenu() const;
```

### <a name="return-value"></a>傳回值

如果功能表正確對齊,則為 TRUE;否則 FALSE。

## <a name="cmfcribbonbuttonissinglelinetext"></a><a name="issinglelinetext"></a>CMFC 功能按鈕::是單行文字

```
BOOL IsSingleLineText() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttononcalctextsize"></a><a name="oncalctextsize"></a>CMFC 功能按鈕::在文字大小上

```
virtual void OnCalcTextSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttononclick"></a><a name="onclick"></a>CMFC功能按鈕:點擊

使用者按一下按鈕時由架構呼叫。

```
virtual void OnClick(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]指定滑鼠按下的位置。

### <a name="remarks"></a>備註

如果要處理此事件,在派生類中重寫此方法。

## <a name="cmfcribbonbuttonondraw"></a><a name="ondraw"></a>CMFC功能按鈕:在畫上

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonondrawborder"></a><a name="ondrawborder"></a>CMFC 功能按鈕::在繪製邊框

```
virtual void OnDrawBorder(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttononfillbackground"></a><a name="onfillbackground"></a>CMFC 功能按鈕::打開填充背景

```
virtual COLORREF OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonremoveallsubitems"></a><a name="removeallsubitems"></a>CMFC 功能按鈕::刪除所有子專案

從快顯功能表中移除所有功能表項目。

```cpp
void RemoveAllSubItems();
```

## <a name="cmfcribbonbuttonremovesubitem"></a><a name="removesubitem"></a>CMFC 功能按鈕::刪除子專案

從快顯功能表中移除功能表項目。

```
BOOL RemoveSubItem(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定要刪除的功能表項的零基索引。

### <a name="return-value"></a>傳回值

如果指定的項已成功刪除,則為 TRUE;如果指定項已成功刪除,則為 TRUE。否則,如果*nIndex*為負或超過彈出式功能表中的功能表項數,則 FALSE。

## <a name="cmfcribbonbuttonsetaccdata"></a><a name="setaccdata"></a>CMFC 功能按鈕::設定ACC數據

設定功能區按鈕的協助工具資料。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
功能區項目的父視窗。

*資料*<br/>
功能區項目的協助工具資料。

### <a name="return-value"></a>傳回值

如果成功,則返回 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonsetalwayslargeimage"></a><a name="setalwayslargeimage"></a>CMFC 功能按鈕::設置始終較大的圖像

指定使用者摺疊按鈕時，按鈕是顯示大型影像還是小型影像。

```cpp
void SetAlwaysLargeImage(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]如果為 TRUE,則該按鈕將顯示一個大圖像。 否則,該按鈕將顯示一個小圖像。

## <a name="cmfcribbonbuttonsetdefaultcommand"></a><a name="setdefaultcommand"></a>CMFC 功能按鈕::設定預設命令

啟用功能區按鈕的預設命令。

```cpp
void SetDefaultCommand(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]如果為 TRUE,則按鈕可以執行其預設命令。 如果 FALSE,則按鈕無法執行其預設命令。

### <a name="remarks"></a>備註

*bSet*僅在按鈕具有功能表時才相關。 如果*bSet*為 TRUE,則按鈕可以執行其預設命令,並且僅當使用者單擊按鈕右邊緣的箭頭時,才會顯示分配的彈出功能表。 否則,按鈕無法執行其預設命令,並且無論使用者單擊按鈕的哪個區域,都會顯示彈出菜單。

## <a name="cmfcribbonbuttonsetdescription"></a><a name="setdescription"></a>CMFC 功能按鈕::設定描述

```
virtual void SetDescription(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

[在]*lpszText*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonsetimageindex"></a><a name="setimageindex"></a>CMFC 功能按鈕::設定影像索引

將索引指派給按鈕的影像。

```cpp
void SetImageIndex(
    int nIndex,
    BOOL bLargeImage);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定圖像索引。

*bLargeImage*<br/>
[在]如果為 TRUE,則指定的索引引用大型圖像的清單。 否則,索引將引用小圖像的清單。

## <a name="cmfcribbonbuttonsetmenu"></a><a name="setmenu"></a>CMFC功能按鈕::設定選單

將快顯功能表上指派給功能區按鈕。

```cpp
void SetMenu(
    HMENU hMenu,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);

void SetMenu(
    UINT uiMenuResID,
    BOOL bIsDefaultCommand=FALSE,
    BOOL bRightAlign=FALSE);
```

### <a name="parameters"></a>參數

*hMenu*<br/>
Windows 菜單的句柄。

*bIsDefault 命令*<br/>
如果為 TRUE,則按鈕可以執行其預設命令;如果為 TRUE,則按鈕可以執行其預設命令。否則,該按鈕將顯示一個彈出式功能表。

*b 右對齊*<br/>
如果為 TRUE,則功能表是右對齊的。 否則,功能表將左對齊。

*uiMenuResID*<br/>
功能表資源識別碼。

### <a name="remarks"></a>備註

當應用程式將功能表分配給按鈕時,按鈕的右側將顯示一個箭頭。 如果*bIsDefault 命令*為 TRUE,則功能表僅在使用者按下箭頭時才顯示。 如果用戶按下這個按鈕,則執行其預設命令。 如果*bIsDefault 命令*為 FALSE,則功能表通過單擊按鈕上的任意位置顯示。

## <a name="cmfcribbonbuttonsetparentcategory"></a><a name="setparentcategory"></a>CMFC 功能按鈕::設定父項目類別

```
virtual void SetParentCategory(CMFCRibbonCategory* pParent);
```

### <a name="parameters"></a>參數

[在]*p 父級*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbonbuttonsetrightalignmenu"></a><a name="setrightalignmenu"></a>CMFC 功能按鈕::設定右對齊選單

將彈出式功能表對齊到按鈕的邊緣。

```cpp
void SetRightAlignMenu(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]如果為 TRUE,則功能表是右對齊的。 否則,選單將左對齊

## <a name="cmfcribbonbuttonsettext"></a><a name="settext"></a>CMFC 功能按鈕::設定文字

```
virtual void SetText(LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

[在]*lpszText*<br/>

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)
