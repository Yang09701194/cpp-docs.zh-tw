---
title: CMFCRibbonGallery 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: 818ce55e44d91520e568308a1a1e8a1fa0c8658d
ms.sourcegitcommit: 5cecccba0a96c1b4ccea1f7a1cfd91f259cc5bde
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/01/2019
ms.locfileid: "58780388"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 類別

實作 Office 2007 樣式的功能區組件庫。
如需詳細資訊，請參閱中的原始程式碼**VC\\atlmfc\\src\\mfc** Visual Studio 安裝資料夾。

## <a name="syntax"></a>語法

```
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|建構並初始化 `CMFCRibbonGallery` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonGallery::AddGroup](#addgroup)|將新的群組加入至資源庫中。|
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|將新的功能表項目加入至下拉式選單中。|
|[CMFCRibbonGallery::Clear](#clear)|清除資源庫的內容。|
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|啟用或停用功能表面板的調整大小。|
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|啟用或停用快顯功能表左邊的提要欄位。|
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(覆寫[cmfcribbonbutton:: Getcompactsize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize)。)|
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(覆寫[CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown)。)|
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|傳回位於指定索引處的群組名稱。|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|傳回資料列的功能區圖庫中的項目數目。|
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|傳回資源庫中的項目相關聯的工具提示文字。|
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|傳回使用者選取資源庫中的最後一個項目的索引。|
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|傳回目前的組件庫的命令識別碼。|
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(覆寫[cmfcribbonbutton:: Getregularsize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize)。)|
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(覆寫[CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu)。)|
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|指定是否要將資源庫包含在資源庫 按鈕。|
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|指定是否啟用或停用功能表調整大小。|
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|指定是否啟用或停用提要欄位。|
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(覆寫 `CMFCRibbonButton::OnAfterChangeRect`。)|
|[CMFCRibbonGallery::OnDraw](#ondraw)|(覆寫[cmfcribbonbutton:: Ondraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw)。)|
|[CMFCRibbonGallery::OnEnable](#onenable)|(覆寫 `CMFCRibbonBaseElement::OnEnable`。)|
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(覆寫[CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged)。)|
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|資源庫會重新繪製。|
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|從資源庫中的所有項目中移除的工具提示。|
|[CMFCRibbonGallery::SelectItem](#selectitem)||
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(覆寫[cmfcribbonbutton:: Setaccdata](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata)。)|
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|指定是否要顯示功能區圖庫下拉式按鈕，或是做為直接在功能區上的色板。|
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|設定群組的名稱。|
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|在資源庫中定義的每個資料列的項目數。|
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|設定資源庫中的項目工具提示文字。|
|[CMFCRibbonGallery::SetPalette](#setpalette)|將色板附加至功能區圖庫中。|
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|定義已選取主機庫項目時，會將 WM_COMMAND 訊息中傳送的命令識別碼。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|繪製組件庫圖示時，由架構呼叫。|

## <a name="remarks"></a>備註

組件庫按鈕行為就像一般功能表按鈕一樣，不同之處在於它會顯示資源庫，當使用者開啟它。 當您選取資源庫中的項目時，則架構會傳送以及按鈕的命令 ID 的 WM_COMMAND 訊息。 當您處理訊息時，您應該呼叫[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)來判斷哪一個項目中所選取資源庫。

## <a name="example"></a>範例

下列範例示範如何使用中的各種方法`CMFCRibbonGallery`類別，以設定`CMFCRibbonGallery`物件。 此範例說明如何在資源庫中指定的每個資料列的項目數、 啟用 [功能表] 面板的調整大小、 啟用快顯功能表中，左側邊欄和顯示功能區圖庫做為直接在功能區列上的色板。 這段程式碼片段是 [Draw 用戶端範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)

[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>需求

**標頭：** afxRibbonPaletteGallery.h

##  <a name="addgroup"></a>  CMFCRibbonGallery::AddGroup

將新的群組加入至資源庫中。

```
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>參數

*lpszGroupName*<br/>
[in]指定群組的名稱。

*uiImagesPaletteResID*<br/>
[in]指定映像清單，其中包含群組的映像的資源識別碼。

*cxPaletteImage*<br/>
[in]指定的寬度，單位為像素的影像。

*imagesGroup*<br/>
[in]映像清單，其中包含群組的映像參考。

*nIconsNum*<br/>
[in]指定群組中的圖示數目。 僅針對自訂 （擁有者繪製），應該指定這個參數群組。

### <a name="remarks"></a>備註

您可以藉由呼叫這個方法，將功能區圖庫中的項目分割成多個群組中。 每個群組可以有標題。

##  <a name="addsubitem"></a>  CMFCRibbonGallery::AddSubItem

將新的功能表項目加入至下拉式選單中。

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>參數

*pSubItem*<br/>
[in]若要加入至功能表項目的指標。

*nIndex*<br/>
[in]指定位置的以零為起始索引位置插入項目。

*bOnTop*<br/>
[in]若要指定功能區圖庫; 之前，應插入項目，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

您可以結合快顯視窗組件庫的快顯功能表項目，藉由呼叫這個方法。 之前或之後的組件庫，則可以放置功能表項目。

若要插入組件庫之前，項目，設定*bOnTop*設為 TRUE。 設定*bOnTop*設為 FALSE 可插入資源庫下方的項目。

> [!NOTE]
>  參數*nIndex*指定插入索引在資源庫頂端和底部的 資源庫。 例如，如果您要插入項目一個位置，在資源庫之前，請設定*nIndex*為 1 和*bOnTop*設為 TRUE。 同樣地，如果您需要將資源庫下方的項目一個位置，設定*nIndex*為 1 和*bOnTop*為 FALSE。

##  <a name="clear"></a>  CMFCRibbonGallery::Clear

清除資源庫的內容。

```
virtual void Clear();
```

### <a name="remarks"></a>備註

呼叫這個方法來移除功能區圖庫中的所有內容。 這必須先將新的功能區圖庫或群組的集合附加至功能區圖庫完成。

##  <a name="cmfcribbongallery"></a>  CMFCRibbonGallery::CMFCRibbonGallery

建構並初始化[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)物件。

```
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
指定當使用者按一下按鈕時要執行此命令的命令識別碼。

*lpszText*<br/>
指定要顯示於按鈕的文字。

*nSmallImageIndex*<br/>
出現在按鈕上的小型影像之以零起始的索引。

*nLargeImageIndex*<br/>
要顯示在按鈕上的大型影像的以零起始的索引。

*imagesPalette*<br/>
參考[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)物件，其中包含出現在資源庫映像。

*uiImagesPaletteResID*<br/>
在資源庫上顯示的影像清單的資源識別碼。

*cxPaletteImage*<br/>
指定寬度，單位為像素上資源庫的映像。

*sizeIcon*<br/>
指定的大小，單位為像素資源庫映像。

*nIconsNum*<br/>
在資源庫中指定圖示的數目。

*bDefaultButtonStyle*<br/>
指定是否要使用預設值或主控描繪按鈕樣式。

### <a name="remarks"></a>備註

##  <a name="enablemenuresize"></a>  CMFCRibbonGallery::EnableMenuResize

啟用或停用功能表面板的調整大小。

```
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]若要啟用功能表; 調整大小時，則為 TRUE否則為 FALSE。

*bVertcalOnly*<br/>
[in]TRUE 表示指定的資源庫可以垂直調整大小只;指定可以調整垂直和水平大小的資源庫，則為 FALSE。

### <a name="remarks"></a>備註

若要啟用或停用 調整大小功能區圖庫中使用這個方法。 啟用時調整大小，功能區圖庫會顯示使用者可用來調整其大小的移駐夾。

##  <a name="enablemenusidebar"></a>  CMFCRibbonGallery::EnableMenuSideBar

啟用或停用快顯功能表左邊的提要欄位。

```
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]若要指定，會啟用提要欄位;，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法來啟用或停用 Office XP 樣式提要欄位，在左側的功能表。

##  <a name="getcompactsize"></a>  CMFCRibbonGallery::GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getgroupname"></a>  CMFCRibbonGallery::GetGroupName

傳回位於指定索引處的群組名稱。

```
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>參數

*nGroupIndex*<br/>
[in]指定以零為起始的索引，您想要擷取其名稱的群組。

### <a name="return-value"></a>傳回值

位於指定索引處的群組名稱。 傳遞無效的索引，將會導致失敗的判斷提示。

### <a name="remarks"></a>備註

##  <a name="getgroupoffset"></a>  CMFCRibbonGallery::GetGroupOffset

```
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="geticonsinrow"></a>  CMFCRibbonGallery::GetIconsInRow

傳回資料列的功能區圖庫中的項目數目。

```
int GetIconsInRow() const;
```

### <a name="return-value"></a>傳回值

資料列中的項目數目。

### <a name="remarks"></a>備註

##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip

傳回資源庫中的項目相關聯的工具提示文字。

```
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>參數

*nItemIndex*<br/>
[in]指定要擷取的工具提示文字的項目以零為起始的索引。

### <a name="return-value"></a>傳回值

指派給功能區圖庫中的項目工具提示字串的指標。 如果沒有工具提示會指派給該項目，它可以是 NULL。

### <a name="remarks"></a>備註

##  <a name="getlastselecteditem"></a>  CMFCRibbonGallery::GetLastSelectedItem

傳回在使用者選取功能區圖庫中的最後一個項目的索引。

```
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>參數

*uiCmdID*<br/>
[in]指定功能表項目，開啟 [功能區圖庫的命令識別碼。

### <a name="return-value"></a>傳回值

當使用者在功能區圖庫中選取任何項目時，程式庫會傳送以及功能表按鈕，開啟 功能區圖庫的命令 ID 的 WM_COMMAND 訊息。

### <a name="remarks"></a>備註

##  <a name="getpaletteid"></a>  CMFCRibbonGallery::GetPaletteID

傳回目前的調色盤的命令識別碼。

```
int GetPaletteID() const;
```

### <a name="return-value"></a>傳回值

在目前選取的調色盤的命令識別碼。

### <a name="remarks"></a>備註

##  <a name="getregularsize"></a>  CMFCRibbonGallery::GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getselecteditem"></a>  CMFCRibbonGallery::GetSelectedItem

```
int GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="hasmenu"></a>  CMFCRibbonGallery::HasMenu

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isbuttonmode"></a>  CMFCRibbonGallery::IsButtonMode

指定調色盤，是否要包含在資源庫 按鈕。

```
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>傳回值

為下拉式選單按鈕; 顯示調色盤，則為 TRUE如果功能區上直接顯示調色盤，則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="ismenuresizeenabled"></a>  CMFCRibbonGallery::IsMenuResizeEnabled

指定是否啟用功能表調整大小。

```
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>傳回值

如果已啟用功能表調整大小;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="ismenuresizevertical"></a>  CMFCRibbonGallery::IsMenuResizeVertical

```
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="ismenusidebar"></a>  CMFCRibbonGallery::IsMenuSideBar

指定是否啟用或停用提要欄位。

```
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>傳回值

如果在快顯功能表中，左側繪製 Office XP 樣式提要欄位，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="onafterchangerect"></a>  CMFCRibbonGallery::OnAfterChangeRect

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="remarks"></a>備註

##  <a name="ondraw"></a>  CMFCRibbonGallery::OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="remarks"></a>備註

##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon

繪製組件庫圖示時，由架構呼叫。

```
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]用於繪製的裝置內容指標。

*rectIcon*<br/>
[in]指定要繪製的圖示的週框矩形。

*nIconIndex*<br/>
[in]在組件庫圖示的圖示，以繪製映像清單中指定的以零為起始的索引。

*pIcon*<br/>
[in]正在繪製之圖示的指標。

*clrText*<br/>
[in]指定要繪製的項目文字的色彩。

### <a name="remarks"></a>備註

您可以覆寫這個方法在衍生類別來自訂外觀的功能區圖庫中。

##  <a name="onenable"></a>  CMFCRibbonGallery::OnEnable

```
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>參數

[in] *bEnable*<br/>

### <a name="remarks"></a>備註

##  <a name="onrtlchanged"></a>  CMFCRibbonGallery::OnRTLChanged

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>參數

[in] *bIsRTL*<br/>

### <a name="remarks"></a>備註

##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons

資源庫會重新繪製。

```
void RedrawIcons();
```

### <a name="remarks"></a>備註

呼叫此函式來重繪資源庫。 如果您已在執行階段組件庫的內容，您必須呼叫這個方法。

##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips

從資源庫中的所有項目中移除的工具提示。

```
void RemoveItemToolTips();
```

### <a name="remarks"></a>備註

##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem

```
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>參數

[in] *nItemIndex*<br/>

### <a name="remarks"></a>備註

##  <a name="setaccdata"></a>  CMFCRibbonGallery::SetACCData

使用功能區圖庫中的協助工具資料填入指定的 `CAccessibilityData` 物件。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
[in]功能區圖庫視窗的父視窗。

*data*<br/>
[out]A`CAccessibilityData`從功能區圖庫接收協助工具資料的物件。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

如果方法成功，則為 TRUE否則為 FALSE。

##  <a name="setbuttonmode"></a>  CMFCRibbonGallery::SetButtonMode

決定是否要顯示功能區圖庫，下拉式按鈕，或是做為直接在功能區上的色板。

```
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[in]若要以下拉式選單按鈕; 顯示功能區圖庫，則為 TRUE在功能區上直接顯示功能區圖庫的內容，則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName

設定群組的名稱。

```
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>參數

*nGroupIndex*<br/>
[in]指定的群組變更名稱所針對的以零為起始的索引。

*lpszGroupName*<br/>
[in]指定群組的新名稱。

### <a name="remarks"></a>備註

正在變更其名稱的群組必須已使用[CMFCRibbonGallery::AddGroup](#addgroup)方法。

##  <a name="seticonsinrow"></a>  CMFCRibbonGallery::SetIconsInRow

指定在資源庫中的每個資料列的項目數。

```
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>參數

*nIconsInRow*<br/>
[in]指定項目出現在資源庫的每個資料列的數目。

### <a name="remarks"></a>備註

使用此方法來指定功能區圖庫的寬度。

##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip

設定資源庫中的項目工具提示文字。

```
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>參數

*nItemIndex*<br/>
[in]與相關聯的工具提示的調色盤項目以零為起始的索引。

*lpszToolTip*<br/>
[in]若要顯示在工具提示文字。

### <a name="remarks"></a>備註

##  <a name="setpalette"></a>  CMFCRibbonGallery::SetPalette

將色板附加至功能區圖庫中。

```
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>參數

*imagesPalette*<br/>
[in]指定映像清單，其中包含出現在資源庫上的圖示。

*uiImagesPaletteResID*<br/>
[in]指定映像清單，其中包含出現在資源庫圖示的資源識別碼。

*cxPaletteImage*<br/>
[in]指定寬度，單位為像素上資源庫映像。

### <a name="remarks"></a>備註

##  <a name="setpaletteid"></a>  CMFCRibbonGallery::SetPaletteID

定義當使用者選取主機庫項目，會將 WM_COMMAND 訊息中傳送的命令識別碼。

```
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
[in]指定當使用者選取主機庫項目，會將 WM_COMMAND 訊息中傳送的命令識別碼。

### <a name="remarks"></a>備註

若要判斷使用者選取從資源庫的特定項目，請呼叫[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)靜態方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCRibbonButton 類別](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFCRibbonGalleryMenuButton 類別](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
