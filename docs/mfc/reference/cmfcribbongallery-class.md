---
title: CMFCRibbonGallery 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: f1ef68cba0012ad5b5d0eb6d3322acc6a1c6555c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81375157"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 類別

實作 Office 2007 樣式的功能區組件庫。
有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```cpp
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFC功能畫廊:CMFC剪綵畫廊](#cmfcribbongallery)|建構並初始化 `CMFCRibbonGallery` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFC功能庫:新增群組](#addgroup)|向庫添加新組。|
|[CMFC 函式庫::新增子項](#addsubitem)|將新的功能表項添加到下拉選單。|
|[CMFC 功能放大縮小字型功能 放大縮小字型功能](#clear)|清除庫的內容。|
|[CMFC 函式庫::啟用選單重新大小](#enablemenuresize)|啟用或禁用調整功能表面板的大小。|
|[CMFC功能庫:啟用選單邊欄](#enablemenusidebar)|啟用或禁用彈出功能表左側的側欄。|
|[CMFC 函式庫:取得壓縮大小](#getcompactsize)|( 覆寫[CMFC 功能按鈕:取得壓縮大小](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize).)|
|[CMFC功能庫:取得向下](#getdroppeddown)|(覆寫[CMFC 功能基礎元素::取得向下](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown). )|
|[CMFC 函式庫:取得群組名稱](#getgroupname)|返回位於指定索引的組的名稱。|
|[CMFC 功能庫:獲取集團偏移](#getgroupoffset)||
|[CMFC功能庫:取得圖示](#geticonsinrow)|返回功能區庫行中的項目數。|
|[CMFC 函式庫::取得專案工具提示](#getitemtooltip)|傳回與庫中項目關聯的工具提示文本。|
|[CMFC 函式庫:取得最後選擇項目](#getlastselecteditem)|返回用戶選擇的庫中最後一個專案的索引。|
|[CMFC功能庫:取得PaletteID](#getpaletteid)|返回目前庫的命令 ID。|
|[CMFC 函式庫:取得一般大小](#getregularsize)|(覆寫[CMFC 功能按鈕:取得一般大小](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize).)|
|[CMFC功能庫:取得選定專案](#getselecteditem)||
|[CMFC功能庫:哈斯梅因](#hasmenu)|(覆蓋[CMFC 功能按鈕::哈斯梅因](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu).)|
|[CMFC功能庫::正按鈕模式](#isbuttonmode)|指定庫是否包含在庫按鈕中。|
|[CMFC 函式庫:已啟用「已啟用」選單](#ismenuresizeenabled)|指定是啟用還是禁用功能表調整大小。|
|[CMFC 功能庫::正選垂直](#ismenuresizevertical)||
|[CMFC功能庫:isMenusideBar](#ismenusidebar)|指定側欄是啟用還是禁用。|
|[CMFC 函式庫:在轉換後](#onafterchangerect)|(覆寫 `CMFCRibbonButton::OnAfterChangeRect`。)|
|[CMFC功能畫廊:OnDraw](#ondraw)|(覆寫[CMFC 功能按鈕:onDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw).)|
|[CMFC功能庫:啟用](#onenable)|(覆寫 `CMFCRibbonBaseElement::OnEnable`。)|
|[CMFC 函式庫::開啟](#onrtlchanged)|(覆寫[CMFC 功能基礎元素:OnRTL 已變更](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged).)|
|[CMFC功能庫:重繪圖示](#redrawicons)|重繪圖庫。|
|[CMFC 函式庫::刪除專案工具提示](#removeitemtooltips)|從庫中的所有項目中刪除工具提示。|
|[CMFC 函式庫:選擇項目](#selectitem)||
|[CMFC功能庫::設定ACC數據](#setaccdata)|( 覆寫[CMFC 功能按鈕:設定ACC資料](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata).)|
|[CMFC 函式庫::設定按鈕模式](#setbuttonmode)|指定是將功能區庫顯示為下拉按鈕還是直接在功能區上作為調色板顯示。|
|[CMFC 函式庫::組名](#setgroupname)|設置組的名稱。|
|[CMFC功能庫:setIconsinrow](#seticonsinrow)|定義庫中每行的項目數。|
|[CMFC 函式庫::設定專案工具提示](#setitemtooltip)|設定庫中專案的工具提示文本。|
|[CMFC功能庫::設定調色板](#setpalette)|將調色板附加到功能區庫。|
|[CMFC功能庫::設定調色板ID](#setpaletteid)|定義在選擇庫項時在WM_COMMAND消息中發送的命令 ID。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFC功能庫:在DrawPaletteIcon](#ondrawpaletteicon)|繪製庫圖示時由框架調用。|

## <a name="remarks"></a>備註

庫按鈕的功能與常規功能表按鈕類似,只不過當用戶打開庫時,它將顯示它。 當您在庫中選擇專案時,框架會將WM_COMMAND消息與按鈕的命令 ID 一起發送。 處理郵件時,應調用[CMFCRibbonGallery:getLast 選擇專案](#getlastselecteditem),以確定從庫中選擇了哪個專案。

## <a name="example"></a>範例

下面的範例展示如何在`CMFCRibbonGallery`類中使用各種方法來配置`CMFCRibbonGallery`物件。 該示例演示如何在庫中指定每行項目數、啟用功能表面板大小、啟用彈出式功能表左側的側欄以及直接在功能區列上作為調色板顯示功能區庫。 這段程式碼片段是 [Draw 用戶端範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)\
•&nbsp;[CMFC 功能基礎元素](../../mfc/reference/cmfcribbonbaseelement-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;[CMFC 功能按鈕](../../mfc/reference/cmfcribbonbutton-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;•&nbsp;[CMFC剪綵畫廊](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>需求

**標題:** afxRibbonPaletteGallery.h

## <a name="cmfcribbongalleryaddgroup"></a><a name="addgroup"></a>CMFC功能庫:新增群組

向庫添加新組。

```cpp
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>參數

*lpszGroup 名稱*<br/>
[在]指定群組的名稱。

*uiImagesPaletteResID*<br/>
[在]指定包含組圖像的影像清單的資源識別碼。

*cxPalette影像*<br/>
[在]指定圖像的寬度(以像素為單位)。

*圖片組*<br/>
[在]對包含組圖像的圖像清單的引用。

*N 圖示Num*<br/>
[在]指定群組中的圖示數。 此參數應僅為自定義(繪製的所有者)組指定。

### <a name="remarks"></a>備註

通過調用此方法,可以將功能區庫中的項目劃分為多個組。 每個組可以有一個標題。

## <a name="cmfcribbongalleryaddsubitem"></a><a name="addsubitem"></a>CMFC 函式庫::新增子項

將新的功能表項添加到下拉選單。

```cpp
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>參數

*p 子項目*<br/>
[在]要添加到菜單的項的指標。

*nIndex*<br/>
[在]指定要插入專案的位置的零基索引。

*蓬托普*<br/>
[在]TRUE 指定應在功能區庫之前插入專案;如果為 TRUE,請指定專案應插入到功能區庫之前。否則,FALSE。

### <a name="remarks"></a>備註

您可以通過調用此方法將彈出式圖庫與彈出式功能表項組合。 功能表項可以放置在庫之前或之後。

若要在庫之前插入專案,請將*bonTop*設定為 TRUE。 將 *"bonTop"* 設定為 FALSE 以將專案插入庫下方。

> [!NOTE]
> 參數*nIndex*在庫頂部和庫底部指定插入索引。 例如,如果需要在庫之前插入專案 1 個位置,請將*nIndex*設置為*1,將 bonTop*設置為 TRUE。 同樣,如果需要在庫下方插入專案 1 個位置,請將*nIndex*設置為*1,將 bonTop*設置為 FALSE。

## <a name="cmfcribbongalleryclear"></a><a name="clear"></a>CMFC 功能放大縮小字型功能 放大縮小字型功能

清除庫的內容。

```cpp
virtual void Clear();
```

### <a name="remarks"></a>備註

呼叫此方法從功能區庫中刪除所有內容。 在將新的功能區庫或組集附加到功能區庫之前,必須完成此操作。

## <a name="cmfcribbongallerycmfcribbongallery"></a><a name="cmfcribbongallery"></a>CMFC功能畫廊:CMFC剪綵畫廊

構造並初始化[CMFC 功能區庫](../../mfc/reference/cmfcribbongallery-class.md)物件。

```cpp
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
指定在使用者按下按鈕時要執行的命令 ID。

*lpszText*<br/>
指定要顯示在按鈕上的文字。

*n 小圖像索引*<br/>
要顯示在按鈕上的小圖像的零基索引。

*nLargeImageIndex*<br/>
要顯示在按鈕上的大圖像的零基索引。

*影像調色盤*<br/>
對包含要顯示在庫中的圖像的[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)物件的引用。

*uiImagesPaletteResID*<br/>
要在庫中顯示的影像清單的資源識別碼。

*cxPalette影像*<br/>
指定庫中圖像的寬度(以像素為單位)。

*大小圖示*<br/>
指定庫圖像的大小(以像素為單位)。

*N 圖示Num*<br/>
指定庫中的圖示數。

*b預設按鈕樣式*<br/>
指定是使用預設按鈕樣式還是擁有者繪製的按鈕樣式。

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryenablemenuresize"></a><a name="enablemenuresize"></a>CMFC 函式庫::啟用選單重新大小

啟用或禁用調整功能表面板的大小。

```cpp
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 以啟用調整功能表大小;否則,FALSE。

*bVertcal*<br/>
[在]TRUE 指定庫只能垂直調整大小;FALSE 指定庫可以垂直和水平調整大小。

### <a name="remarks"></a>備註

使用此方法啟用或禁用調整功能區庫大小。 啟用調整大小時,功能區庫將顯示一個抓手,用戶可以用它來調整其大小。

## <a name="cmfcribbongalleryenablemenusidebar"></a><a name="enablemenusidebar"></a>CMFC功能庫:啟用選單邊欄

啟用或禁用彈出功能表左側的側欄。

```cpp
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 以指定已啟用側欄;否則,FALSE。

### <a name="remarks"></a>備註

調用此方法以啟用或禁用功能表左側的 Office XP 樣式側欄。

## <a name="cmfcribbongallerygetcompactsize"></a><a name="getcompactsize"></a>CMFC 函式庫:取得壓縮大小

```cpp
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetdroppeddown"></a><a name="getdroppeddown"></a>CMFC功能庫:取得向下

```cpp
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetgroupname"></a><a name="getgroupname"></a>CMFC 函式庫:取得群組名稱

返回位於指定索引的組的名稱。

```cpp
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>參數

*N組索引*<br/>
[在]指定要檢索其名稱的組的零基索引。

### <a name="return-value"></a>傳回值

位於指定索引的組的名稱。 傳遞無效的索引將導致斷言失敗。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetgroupoffset"></a><a name="getgroupoffset"></a>CMFC 功能庫:獲取集團偏移

```cpp
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygeticonsinrow"></a><a name="geticonsinrow"></a>CMFC功能庫:取得圖示

返回功能區庫行中的項目數。

```cpp
int GetIconsInRow() const;
```

### <a name="return-value"></a>傳回值

行中的項數。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetitemtooltip"></a><a name="getitemtooltip"></a>CMFC 函式庫::取得專案工具提示

傳回與庫中項目關聯的工具提示文本。

```cpp
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>參數

*n 專案索引*<br/>
[在]指定要為其檢索工具提示文本的項的零基索引。

### <a name="return-value"></a>傳回值

指向分配給功能區庫中專案的工具提示字串的指標。 如果未向該專案分配工具提示,則它可以為 NULL。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetlastselecteditem"></a><a name="getlastselecteditem"></a>CMFC 函式庫:取得最後選擇項目

返回用戶選擇的功能區庫中最後一個專案的索引。

```cpp
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>參數

*烏伊CmdID*<br/>
[在]指定開啟功能區庫的功能表項的命令 ID。

### <a name="return-value"></a>傳回值

當使用者選擇功能區庫中的任何專案時,庫將發送WM_COMMAND消息以及打開功能區庫的功能表按鈕的命令 ID。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetpaletteid"></a><a name="getpaletteid"></a>CMFC功能庫:取得PaletteID

返回當前調色板的命令 ID。

```cpp
int GetPaletteID() const;
```

### <a name="return-value"></a>傳回值

當前所選調色板的命令 ID。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetregularsize"></a><a name="getregularsize"></a>CMFC 函式庫:取得一般大小

```cpp
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerygetselecteditem"></a><a name="getselecteditem"></a>CMFC功能庫:取得選定專案

```cpp
int GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryhasmenu"></a><a name="hasmenu"></a>CMFC功能庫:哈斯梅因

```cpp
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryisbuttonmode"></a><a name="isbuttonmode"></a>CMFC功能庫::正按鈕模式

指定調色板是否包含在庫按鈕中。

```cpp
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>傳回值

如果調色板顯示為下拉菜單按鈕,則為 TRUE;如果調色板顯示為下拉菜單按鈕,則為 TRUE。如果調色板直接顯示在功能區上,則 FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryismenuresizeenabled"></a><a name="ismenuresizeenabled"></a>CMFC 函式庫:已啟用「已啟用」選單

指定是否啟用了功能表調整大小。

```cpp
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>傳回值

如果已啟用功能表調整大小,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryismenuresizevertical"></a><a name="ismenuresizevertical"></a>CMFC 功能庫::正選垂直

```cpp
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryismenusidebar"></a><a name="ismenusidebar"></a>CMFC功能庫:isMenusideBar

指定側欄是啟用還是禁用。

```cpp
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>傳回值

如果 Office XP 風格的側欄在彈出式功能表的左側繪製,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryonafterchangerect"></a><a name="onafterchangerect"></a>CMFC 函式庫:在轉換後

```cpp
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryondraw"></a><a name="ondraw"></a>CMFC功能畫廊:OnDraw

```cpp
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryondrawpaletteicon"></a><a name="ondrawpaletteicon"></a>CMFC功能庫:在DrawPaletteIcon

繪製庫圖示時由框架調用。

```cpp
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向用於繪圖的設備上下文的指標。

*整形圖示*<br/>
[在]指定要繪製的圖示的邊界矩形。

*nIconIndex*<br/>
[在]指定要繪製的圖示的圖庫圖示的圖像清單中的零基索引。

*pIcon*<br/>
[在]指向正在繪製的圖示的指標。

*clrText*<br/>
[在]指定要繪製的項目文字的顏色。

### <a name="remarks"></a>備註

可以在派生類中重寫此方法,以自定義功能區庫的外觀。

## <a name="cmfcribbongalleryonenable"></a><a name="onenable"></a>CMFC功能庫:啟用

```cpp
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>參數

[在]*b 啟用*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryonrtlchanged"></a><a name="onrtlchanged"></a>CMFC 函式庫::開啟

```cpp
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>參數

[在]*比塞爾*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryredrawicons"></a><a name="redrawicons"></a>CMFC功能庫:重繪圖示

重繪圖庫。

```cpp
void RedrawIcons();
```

### <a name="remarks"></a>備註

調用此函數以重繪庫。 如果在運行時更改了庫的內容,則必須調用此方法。

## <a name="cmfcribbongalleryremoveitemtooltips"></a><a name="removeitemtooltips"></a>CMFC 函式庫::刪除專案工具提示

從庫中的所有項目中刪除工具提示。

```cpp
void RemoveItemToolTips();
```

### <a name="remarks"></a>備註

## <a name="cmfcribbongalleryselectitem"></a><a name="selectitem"></a>CMFC 函式庫:選擇項目

```cpp
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>參數

[在]*n 專案索引*<br/>

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerysetaccdata"></a><a name="setaccdata"></a>CMFC功能庫::設定ACC數據

使用功能區圖庫中的協助工具資料填入指定的 `CAccessibilityData` 物件。

```cpp
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
[在]功能區庫視窗的父視窗。

*資料*<br/>
[出]從`CAccessibilityData`功能區庫接收輔助功能數據的物件。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

如果方法成功,則為 TRUE;否則,FALSE。

## <a name="cmfcribbongallerysetbuttonmode"></a><a name="setbuttonmode"></a>CMFC 函式庫::設定按鈕模式

確定是將功能區庫顯示為下拉按鈕還是直接在功能區上作為調色板顯示。

```cpp
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]TRUE 將功能區庫顯示為下拉菜單按鈕;FALSE 直接顯示在功能區上功能區庫的內容。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerysetgroupname"></a><a name="setgroupname"></a>CMFC 函式庫::組名

設置組的名稱。

```cpp
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>參數

*N組索引*<br/>
[在]指定要為其更改名稱的組的從零開始索引。

*lpszGroup 名稱*<br/>
[在]指定組的新名稱。

### <a name="remarks"></a>備註

必須使用[CMFC 功能區庫::addGroup](#addgroup)方法添加其名稱的組。

## <a name="cmfcribbongalleryseticonsinrow"></a><a name="seticonsinrow"></a>CMFC功能庫:setIconsinrow

指定庫中每行的項目數。

```cpp
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>參數

*內辛內羅*<br/>
[在]指定要在庫的每一行中顯示的項目數。

### <a name="remarks"></a>備註

使用此方法指定功能區庫的寬度。

## <a name="cmfcribbongallerysetitemtooltip"></a><a name="setitemtooltip"></a>CMFC 函式庫::設定專案工具提示

設定庫中專案的工具提示文本。

```cpp
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>參數

*n 專案索引*<br/>
[在]要與哪個選項關聯的調色板項的零基索引。

*lpszToolTip*<br/>
[在]要顯示在工具提示上的文本。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerysetpalette"></a><a name="setpalette"></a>CMFC功能庫::設定調色板

將調色板附加到功能區庫。

```cpp
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>參數

*影像調色盤*<br/>
[在]指定包含要顯示在庫中的圖示的影像清單。

*uiImagesPaletteResID*<br/>
[在]指定包含要顯示在庫中的圖示的影像清單的資源 ID。

*cxPalette影像*<br/>
[在]指定庫中圖像的寬度(以像素為單位)。

### <a name="remarks"></a>備註

## <a name="cmfcribbongallerysetpaletteid"></a><a name="setpaletteid"></a>CMFC功能庫::設定調色板ID

定義使用者選擇庫項時在WM_COMMAND消息中發送的命令 ID。

```cpp
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]指定使用者選擇庫項時在WM_COMMAND訊息中發送的命令 ID。

### <a name="remarks"></a>備註

要確定使用者從庫中選擇的特定項,請調用[CMFC 功能區庫::GetLast選擇專案](#getlastselecteditem)靜態方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCRibbonButton 類別](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFCRibbonGalleryMenuButton 類別](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
