---
title: CMFCRibbonGallery 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
ms.openlocfilehash: 5a723af1e32a7a2e78bfb099680dce3e9b710838
ms.sourcegitcommit: bd7ddc044f9083246614b602ef6a758775313214
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/09/2019
ms.locfileid: "68866214"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 類別

實作 Office 2007 樣式的功能區組件庫。
如需詳細資訊, 請參閱位於 Visual Studio 安裝**的\\VC\\atlmfc\\src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCRibbonGallery : public CMFCRibbonButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|建構並初始化 `CMFCRibbonGallery` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|說明|
|----------|-----------------|
|[CMFCRibbonGallery::AddGroup](#addgroup)|將新群組新增至資源庫。|
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|將新的功能表項目加入至下拉式功能表。|
|[CMFCRibbonGallery::Clear](#clear)|清除資源庫的內容。|
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|啟用或停用功能表面板的調整大小。|
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|啟用或停用快顯功能表左側的側條。|
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(覆寫[CMFCRibbonButton:: GetCompactSize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize)。)|
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(覆寫[CMFCRibbonBaseElement:: GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown)。)|
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|傳回位於指定之索引處的組名。|
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|傳回功能區圖庫的資料列中的專案數。|
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|傳回與圖庫中的專案相關聯的工具提示文字。|
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|傳回資源庫中使用者選取的最後一個專案的索引。|
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|傳回目前圖庫的命令識別碼。|
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(覆寫[CMFCRibbonButton:: GetRegularSize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize)。)|
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(覆寫[CMFCRibbonButton:: HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu)。)|
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|指定圖庫是否包含在圖庫按鈕中。|
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|指定是否要啟用或停用功能表調整大小。|
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|指定側條是否已啟用或停用。|
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(覆寫 `CMFCRibbonButton::OnAfterChangeRect`。)|
|[CMFCRibbonGallery::OnDraw](#ondraw)|(覆寫[CMFCRibbonButton:: OnDraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw)。)|
|[CMFCRibbonGallery::OnEnable](#onenable)|(覆寫 `CMFCRibbonBaseElement::OnEnable`。)|
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(覆寫[CMFCRibbonBaseElement:: OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged)。)|
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|重新繪製圖庫。|
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|將工具提示從資源庫中的所有專案移除。|
|[CMFCRibbonGallery::SelectItem](#selectitem)||
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(覆寫[CMFCRibbonButton:: SetACCData](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata)。)|
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|指定是否要將功能區圖庫顯示為下拉式按鈕, 或直接在功能區上顯示為調色板。|
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|設定群組的名稱。|
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|定義資源庫中每個資料列的專案數。|
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|設定資源庫中專案的工具提示文字。|
|[CMFCRibbonGallery::SetPalette](#setpalette)|將色板附加至功能區圖庫。|
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|定義在選取圖庫專案時, 在 WM_COMMAND 訊息中傳送的命令識別碼。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|繪製圖庫圖示時由架構呼叫。|

## <a name="remarks"></a>備註

[資源庫] 按鈕的行為就像一般功能表按鈕一樣, 不同的是, 它會在使用者開啟圖庫時顯示資源庫。 當您選取資源庫中的專案時, 架構會連同按鈕的命令識別碼一起傳送 WM_COMMAND 訊息。 當您處理訊息時, 您應該呼叫[CMFCRibbonGallery:: GetLastSelectedItem](#getlastselecteditem)來判斷哪個專案已從資源庫中選取。

## <a name="example"></a>範例

下列範例示範如何在`CMFCRibbonGallery`類別中使用各種方法來`CMFCRibbonGallery`設定物件。 此範例說明如何指定資源庫中每個資料列的專案數、啟用功能表面板的調整大小、啟用快顯功能表左邊的側條, 以及直接在功能區列上將功能區圖庫顯示為調色板。 這段程式碼片段是 [Draw 用戶端範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)\
└&nbsp; [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp; [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)\
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;└&nbsp; [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)

## <a name="requirements"></a>需求

**標頭:** afxribbonpalettegallery.h。h

##  <a name="addgroup"></a>CMFCRibbonGallery:: AddGroup

將新群組新增至資源庫。

```
void AddGroup(
    LPCTSTR lpszGroupName,
    UINT uiImagesPaletteResID,
    int cxPaletteImage);

void AddGroup(
    LPCTSTR lpszGroupName,
    CMFCToolBarImages& imagesGroup);

void AddGroup(
    LPCTSTR lpszGroupName,
    int nIconsNum);
```

### <a name="parameters"></a>參數

*lpszGroupName*<br/>
在指定群組的名稱。

*uiImagesPaletteResID*<br/>
在指定包含群組影像之影像清單的資源識別碼。

*cxPaletteImage*<br/>
在指定影像的寬度 (以圖元為單位)。

*imagesGroup*<br/>
在包含群組影像之影像清單的參考。

*nIconsNum*<br/>
在指定群組中的圖示數目。 此參數只應針對自訂 (主控描繪) 群組指定。

### <a name="remarks"></a>備註

您可以藉由呼叫這個方法, 將功能區資源庫中的專案分割成多個群組。 每個群組都可以有標題。

##  <a name="addsubitem"></a>CMFCRibbonGallery:: AddSubItem

將新的功能表項目加入至下拉式功能表。

```
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,
    int nIndex=-1,
    BOOL bOnTop=FALSE);
```

### <a name="parameters"></a>參數

*pSubItem*<br/>
在要加入至功能表之專案的指標。

*nIndex*<br/>
在指定要插入專案的位置之以零為基底的索引。

*bOnTop*<br/>
在TRUE 表示要將專案插入功能區圖庫之前;否則為 FALSE。

### <a name="remarks"></a>備註

您可以藉由呼叫這個方法, 將快顯視窗庫與快顯功能表專案結合。 功能表項目可以放在圖庫之前或之後。

若要在資源庫之前插入專案, 請將*bOnTop*設定為 TRUE。 將 [ *bOnTop* ] 設定為 [FALSE], 以將專案插入資源庫底下。

> [!NOTE]
>  參數*nIndex*會在資源庫頂端和圖庫底部指定插入索引。 例如, 如果您需要在資源庫的一個位置插入一個專案, 請將*nIndex*設定為 1, 並將*BONTOP*設為 TRUE。 同樣地, 如果您需要在資源庫底下的一個位置插入專案, 請將*nIndex*設定為 1, 並將*BONTOP*設為 FALSE。

##  <a name="clear"></a>CMFCRibbonGallery:: Clear

清除資源庫的內容。

```
virtual void Clear();
```

### <a name="remarks"></a>備註

呼叫此方法可從功能區圖庫移除所有內容。 您必須先完成這項作業, 才能將新的功能區資源庫或群組集合附加至功能區資源庫。

##  <a name="cmfcribbongallery"></a>CMFCRibbonGallery:: CMFCRibbonGallery

建立[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)物件的結構並加以初始化。

```
CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CMFCToolBarImages& imagesPalette);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    UINT uiImagesPaletteResID=0,
    int cxPaletteImage=0);

CMFCRibbonGallery (
    UINT nID,
    LPCTSTR lpszText,
    int nSmallImageIndex,
    int nLargeImageIndex,
    CSize sizeIcon,
    int nIconsNum,
    BOOL bDefaultButtonStyle=TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
指定使用者按一下按鈕時要執行之命令的命令識別碼。

*lpszText*<br/>
指定要顯示在按鈕上的文字。

*nSmallImageIndex*<br/>
要顯示在按鈕上的小型影像之以零為起始的索引。

*nLargeImageIndex*<br/>
要顯示在按鈕上的大型影像之以零為起始的索引。

*imagesPalette*<br/>
[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)物件的參考, 其中包含要顯示在資源庫中的影像。

*uiImagesPaletteResID*<br/>
要顯示在圖庫上之影像清單的資源識別碼。

*cxPaletteImage*<br/>
指定圖庫上影像的寬度 (以圖元為單位)。

*sizeIcon*<br/>
指定圖庫影像的大小 (以圖元為單位)。

*nIconsNum*<br/>
指定圖庫中的圖示數目。

*bDefaultButtonStyle*<br/>
指定是否要使用預設或主控描繪的按鈕樣式。

### <a name="remarks"></a>備註

##  <a name="enablemenuresize"></a>CMFCRibbonGallery:: EnableMenuResize

啟用或停用功能表面板的調整大小。

```
void EnableMenuResize(
    BOOL bEnable = TRUE,
    BOOL bVertcalOnly = FALSE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用調整功能表的大小;否則為 FALSE。

*bVertcalOnly*<br/>
在TRUE 表示指定圖庫只能垂直調整大小;FALSE, 指定資源庫可以垂直和水準調整大小。

### <a name="remarks"></a>備註

使用此方法來啟用或停用調整功能區圖庫的大小。 啟用調整大小時, 功能區資源庫會顯示使用者可用於調整其大小的移駐夾。

##  <a name="enablemenusidebar"></a>CMFCRibbonGallery:: EnableMenuSideBar

啟用或停用快顯功能表左側的側條。

```
void EnablMenuSideBar(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示要啟用側條;否則為 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法, 以啟用或停用功能表左側的 Office XP 樣式側條。

##  <a name="getcompactsize"></a>CMFCRibbonGallery:: GetCompactSize

```
virtual CSize GetCompactSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown

```
virtual CMFCRibbonBaseElement* GetDroppedDown();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getgroupname"></a>CMFCRibbonGallery:: GetGroupName

傳回位於指定之索引處的組名。

```
LPCTSTR GetGroupName(int nGroupIndex) const;
```

### <a name="parameters"></a>參數

*nGroupIndex*<br/>
在針對您要取得其名稱的群組, 指定以零為基底的索引。

### <a name="return-value"></a>傳回值

位於指定索引處之群組的名稱。 傳遞不正確索引將會導致失敗的判斷提示。

### <a name="remarks"></a>備註

##  <a name="getgroupoffset"></a>CMFCRibbonGallery:: GetGroupOffset

```
virtual int GetGroupOffset() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="geticonsinrow"></a>CMFCRibbonGallery:: GetIconsInRow

傳回功能區圖庫的資料列中的專案數。

```
int GetIconsInRow() const;
```

### <a name="return-value"></a>傳回值

資料列中的專案數。

### <a name="remarks"></a>備註

##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip

傳回與圖庫中的專案相關聯的工具提示文字。

```
LPCTSTR GetItemToolTip(int nItemIndex) const;
```

### <a name="parameters"></a>參數

*nItemIndex*<br/>
在指定要為其取得工具提示文字的專案之以零為起始的索引。

### <a name="return-value"></a>傳回值

指派給功能區圖庫中專案的工具提示字串指標。 如果未將任何工具提示指派給該專案, 則它可以是 Null。

### <a name="remarks"></a>備註

##  <a name="getlastselecteditem"></a>CMFCRibbonGallery:: GetLastSelectedItem

傳回使用者選取的功能區圖庫中, 最後一個專案的索引。

```
static int GetLastSelectedItem(UINT uiCmdID);
```

### <a name="parameters"></a>參數

*uiCmdID*<br/>
[in]指定功能表項目，開啟功能區圖庫的命令識別碼。

### <a name="return-value"></a>傳回值

當使用者選取功能區圖庫中的任何專案時, 文件庫會傳送 WM_COMMAND 訊息, 以及開啟功能區圖庫之功能表按鈕的命令 ID。

### <a name="remarks"></a>備註

##  <a name="getpaletteid"></a>CMFCRibbonGallery:: GetPaletteID

傳回目前調色板的命令識別碼。

```
int GetPaletteID() const;
```

### <a name="return-value"></a>傳回值

目前所選取之調色板的命令識別碼。

### <a name="remarks"></a>備註

##  <a name="getregularsize"></a>CMFCRibbonGallery:: GetRegularSize

```
virtual CSize GetRegularSize(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getselecteditem"></a>CMFCRibbonGallery:: GetSelectedItem

```
int GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="hasmenu"></a>CMFCRibbonGallery:: HasMenu

```
virtual BOOL HasMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isbuttonmode"></a>CMFCRibbonGallery:: IsButtonMode

指定色板是否包含在圖庫按鈕中。

```
BOOL IsButtonMode() const;
```

### <a name="return-value"></a>傳回值

如果調色板顯示為下拉式功能表按鈕, 則為 TRUE;如果調色板直接顯示在功能區上, 則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="ismenuresizeenabled"></a>CMFCRibbonGallery:: IsMenuResizeEnabled

指定是否啟用 [調整功能表大小]。

```
BOOL IsMenuResizeEnabled() const;
```

### <a name="return-value"></a>傳回值

如果已啟用功能表調整大小, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="ismenuresizevertical"></a>CMFCRibbonGallery:: IsMenuResizeVertical

```
BOOL IsMenuResizeVertical() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="ismenusidebar"></a>CMFCRibbonGallery:: IsMenuSideBar

指定側條是否已啟用或停用。

```
BOOL IsMenuSideBar() const;
```

### <a name="return-value"></a>傳回值

如果 Office XP 樣式的側邊列是在快顯功能表的左邊繪製, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="onafterchangerect"></a>CMFCRibbonGallery:: OnAfterChangeRect

```
virtual void OnAfterChangeRect(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="remarks"></a>備註

##  <a name="ondraw"></a>CMFCRibbonGallery:: OnDraw

```
virtual void OnDraw(CDC* pDC);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>

### <a name="remarks"></a>備註

##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon

繪製圖庫圖示時由架構呼叫。

```
virtual void OnDrawPaletteIcon(
    CDC* pDC,
    CRect rectIcon,
    int nIconIndex,
    CMFCRibbonGalleryIcon* pIcon,
    COLORREF clrText);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在用於繪製之裝置內容的指標。

*rectIcon*<br/>
在指定要繪製之圖示的周框。

*nIconIndex*<br/>
在在要繪製的圖示圖庫圖示清單中, 指定以零為基底的索引。

*pIcon*<br/>
在所繪製圖示的指標。

*clrText*<br/>
在指定要繪製之專案文字的色彩。

### <a name="remarks"></a>備註

您可以在衍生類別中覆寫這個方法, 以自訂功能區圖庫的外觀。

##  <a name="onenable"></a>CMFCRibbonGallery:: OnEnable

```
virtual void OnEnable(BOOL bEnable);
```

### <a name="parameters"></a>參數

在*bEnable*<br/>

### <a name="remarks"></a>備註

##  <a name="onrtlchanged"></a>CMFCRibbonGallery:: OnRTLChanged

```
virtual void OnRTLChanged(BOOL bIsRTL);
```

### <a name="parameters"></a>參數

在*bIsRTL*<br/>

### <a name="remarks"></a>備註

##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons

重新繪製圖庫。

```
void RedrawIcons();
```

### <a name="remarks"></a>備註

呼叫此函式可重繪圖庫。 如果您已在執行時間變更圖庫的內容, 則必須呼叫此方法。

##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips

將工具提示從資源庫中的所有專案移除。

```
void RemoveItemToolTips();
```

### <a name="remarks"></a>備註

##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem

```
void SelectItem(int nItemIndex);
```

### <a name="parameters"></a>參數

[in] *nItemIndex*<br/>

### <a name="remarks"></a>備註

##  <a name="setaccdata"></a>CMFCRibbonGallery:: SetACCData

使用功能區圖庫中的協助工具資料填入指定的 `CAccessibilityData` 物件。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
在功能區圖庫視窗的父視窗。

*data*<br/>
脫銷`CAccessibilityData`物件, 可從功能區圖庫接收協助工具資料。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

如果方法成功, 則為 TRUE;否則為 FALSE。

##  <a name="setbuttonmode"></a>CMFCRibbonGallery:: SetButtonMode

決定是否要將功能區圖庫顯示為下拉式按鈕, 或直接在功能區上顯示為調色板。

```
void SetButtonMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
在TRUE 表示將功能區圖庫顯示為下拉式功能表按鈕;FALSE 表示直接在功能區上顯示功能區圖庫的內容。

### <a name="remarks"></a>備註

##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName

設定群組的名稱。

```
void SetGroupName(
    int nGroupIndex,
    LPCTSTR lpszGroupName);
```

### <a name="parameters"></a>參數

*nGroupIndex*<br/>
在針對要變更名稱的群組, 指定以零為基底的索引。

*lpszGroupName*<br/>
在指定群組的新名稱。

### <a name="remarks"></a>備註

必須使用[CMFCRibbonGallery:: AddGroup](#addgroup)方法加入其名稱已變更的群組。

##  <a name="seticonsinrow"></a>CMFCRibbonGallery:: SetIconsInRow

指定資源庫中每個資料列的專案數。

```
void SetIconsInRow(int nIconsInRow);
```

### <a name="parameters"></a>參數

*nIconsInRow*<br/>
在指定要在資源庫的每個資料列中顯示的專案數。

### <a name="remarks"></a>備註

使用此方法可指定功能區圖庫的寬度。

##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip

設定資源庫中專案的工具提示文字。

```
void SetItemToolTip(
    int nItemIndex,
    LPCTSTR lpszToolTip);
```

### <a name="parameters"></a>參數

*nItemIndex*<br/>
在要與工具提示產生關聯之調色板專案的以零為基底的索引。

*lpszToolTip*<br/>
在要顯示在工具提示上的文字。

### <a name="remarks"></a>備註

##  <a name="setpalette"></a>CMFCRibbonGallery:: SetPalette

將色板附加至功能區圖庫。

```
void SetPalette(CMFCToolBarImages& imagesPalette);

void SetPalette(
    UINT uiImagesPaletteResID,
    int cxPaletteImage);
```

### <a name="parameters"></a>參數

*imagesPalette*<br/>
在指定影像清單, 其中包含要顯示在資源庫中的圖示。

*uiImagesPaletteResID*<br/>
在指定影像清單的資源識別碼, 其中包含要顯示在資源庫中的圖示。

*cxPaletteImage*<br/>
在指定圖庫上影像的寬度 (以圖元為單位)。

### <a name="remarks"></a>備註

##  <a name="setpaletteid"></a>CMFCRibbonGallery:: SetPaletteID

定義當使用者選取主機庫專案時, 在 WM_COMMAND 訊息中傳送的命令識別碼。

```
void SetPaletteID(UINT nID);
```

### <a name="parameters"></a>參數

*nID*<br/>
在指定當使用者選取主機庫專案時, 在 WM_COMMAND 訊息中傳送的命令識別碼。

### <a name="remarks"></a>備註

若要判斷使用者從資源庫中選取的特定專案, 請呼叫[CMFCRibbonGallery:: GetLastSelectedItem](#getlastselecteditem)靜態方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCRibbonButton 類別](../../mfc/reference/cmfcribbonbutton-class.md)<br/>
[CMFCRibbonGalleryMenuButton 類別](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
