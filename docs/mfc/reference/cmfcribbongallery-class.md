---
title: CMFCRibbonGallery 類別 |Microsoft 文件
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::CMFCRibbonGallery
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddGroup
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::AddSubItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::Clear
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuResize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::EnableMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetCompactSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetDroppedDown
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetGroupOffset
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetLastSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetRegularSize
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::GetSelectedItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::HasMenu
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeEnabled
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuResizeVertical
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::IsMenuSideBar
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnAfterChangeRect
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDraw
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnEnable
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnRTLChanged
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RedrawIcons
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::RemoveItemToolTips
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SelectItem
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetACCData
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetButtonMode
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetGroupName
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetIconsInRow
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetItemToolTip
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPalette
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::SetPaletteID
- AFXRIBBONPALETTEGALLERY/CMFCRibbonGallery::OnDrawPaletteIcon
dev_langs:
- C++
helpviewer_keywords:
- CMFCRibbonGallery [MFC], CMFCRibbonGallery
- CMFCRibbonGallery [MFC], AddGroup
- CMFCRibbonGallery [MFC], AddSubItem
- CMFCRibbonGallery [MFC], Clear
- CMFCRibbonGallery [MFC], EnableMenuResize
- CMFCRibbonGallery [MFC], EnableMenuSideBar
- CMFCRibbonGallery [MFC], GetCompactSize
- CMFCRibbonGallery [MFC], GetDroppedDown
- CMFCRibbonGallery [MFC], GetGroupName
- CMFCRibbonGallery [MFC], GetGroupOffset
- CMFCRibbonGallery [MFC], GetIconsInRow
- CMFCRibbonGallery [MFC], GetItemToolTip
- CMFCRibbonGallery [MFC], GetLastSelectedItem
- CMFCRibbonGallery [MFC], GetPaletteID
- CMFCRibbonGallery [MFC], GetRegularSize
- CMFCRibbonGallery [MFC], GetSelectedItem
- CMFCRibbonGallery [MFC], HasMenu
- CMFCRibbonGallery [MFC], IsButtonMode
- CMFCRibbonGallery [MFC], IsMenuResizeEnabled
- CMFCRibbonGallery [MFC], IsMenuResizeVertical
- CMFCRibbonGallery [MFC], IsMenuSideBar
- CMFCRibbonGallery [MFC], OnAfterChangeRect
- CMFCRibbonGallery [MFC], OnDraw
- CMFCRibbonGallery [MFC], OnEnable
- CMFCRibbonGallery [MFC], OnRTLChanged
- CMFCRibbonGallery [MFC], RedrawIcons
- CMFCRibbonGallery [MFC], RemoveItemToolTips
- CMFCRibbonGallery [MFC], SelectItem
- CMFCRibbonGallery [MFC], SetACCData
- CMFCRibbonGallery [MFC], SetButtonMode
- CMFCRibbonGallery [MFC], SetGroupName
- CMFCRibbonGallery [MFC], SetIconsInRow
- CMFCRibbonGallery [MFC], SetItemToolTip
- CMFCRibbonGallery [MFC], SetPalette
- CMFCRibbonGallery [MFC], SetPaletteID
- CMFCRibbonGallery [MFC], OnDrawPaletteIcon
ms.assetid: 9734c9c9-981c-4b3f-8c59-264fd41811b4
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: da6727c54fd3c1f4ae25f401294861a6c8909e50
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33377858"
---
# <a name="cmfcribbongallery-class"></a>CMFCRibbonGallery 類別
實作 Office 2007 樣式的功能區組件庫。  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
## <a name="syntax"></a>語法  
  
```  
class CMFCRibbonGallery : public CMFCRibbonButton  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::CMFCRibbonGallery](#cmfcribbongallery)|建構並初始化 `CMFCRibbonGallery` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::AddGroup](#addgroup)|將新的群組加入至組件庫。|  
|[CMFCRibbonGallery::AddSubItem](#addsubitem)|將新的功能表項目加入至下拉式選單。|  
|[CMFCRibbonGallery::Clear](#clear)|清除 「 組件庫的內容。|  
|[CMFCRibbonGallery::EnableMenuResize](#enablemenuresize)|啟用或停用功能表面板的調整大小。|  
|[CMFCRibbonGallery::EnableMenuSideBar](#enablemenusidebar)|啟用或停用快顯功能表左邊提要欄位。|  
|[CMFCRibbonGallery::GetCompactSize](#getcompactsize)|(覆寫[cmfcribbonbutton:: Getcompactsize](../../mfc/reference/cmfcribbonbutton-class.md#getcompactsize)。)|  
|[CMFCRibbonGallery::GetDroppedDown](#getdroppeddown)|(覆寫[CMFCRibbonBaseElement::GetDroppedDown](../../mfc/reference/cmfcribbonbaseelement-class.md#getdroppeddown)。)|  
|[CMFCRibbonGallery::GetGroupName](#getgroupname)|傳回位於指定索引上的群組名稱。|  
|[CMFCRibbonGallery::GetGroupOffset](#getgroupoffset)||  
|[CMFCRibbonGallery::GetIconsInRow](#geticonsinrow)|傳回資料列的功能區圖庫中的項目數目。|  
|[CMFCRibbonGallery::GetItemToolTip](#getitemtooltip)|傳回組件庫中的項目相關聯的工具提示文字。|  
|[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)|傳回使用者選取的組件庫中的最後一個項目的索引。|  
|[CMFCRibbonGallery::GetPaletteID](#getpaletteid)|傳回目前的組件庫的命令識別碼。|  
|[CMFCRibbonGallery::GetRegularSize](#getregularsize)|(覆寫[cmfcribbonbutton:: Getregularsize](../../mfc/reference/cmfcribbonbutton-class.md#getregularsize)。)|  
|[CMFCRibbonGallery::GetSelectedItem](#getselecteditem)||  
|[CMFCRibbonGallery::HasMenu](#hasmenu)|(覆寫[CMFCRibbonButton::HasMenu](../../mfc/reference/cmfcribbonbutton-class.md#hasmenu)。)|  
|[CMFCRibbonGallery::IsButtonMode](#isbuttonmode)|指定是否要將組件庫包含在組件庫按鈕。|  
|[CMFCRibbonGallery::IsMenuResizeEnabled](#ismenuresizeenabled)|指定是否啟用或停用功能表調整大小。|  
|[CMFCRibbonGallery::IsMenuResizeVertical](#ismenuresizevertical)||  
|[CMFCRibbonGallery::IsMenuSideBar](#ismenusidebar)|指定是否啟用或停用提要欄位。|  
|[CMFCRibbonGallery::OnAfterChangeRect](#onafterchangerect)|(覆寫 `CMFCRibbonButton::OnAfterChangeRect`。)|  
|[CMFCRibbonGallery::OnDraw](#ondraw)|(覆寫[cmfcribbonbutton:: Ondraw](../../mfc/reference/cmfcribbonbutton-class.md#ondraw)。)|  
|[CMFCRibbonGallery::OnEnable](#onenable)|(覆寫 `CMFCRibbonBaseElement::OnEnable`。)|  
|[CMFCRibbonGallery::OnRTLChanged](#onrtlchanged)|(覆寫[CMFCRibbonBaseElement::OnRTLChanged](../../mfc/reference/cmfcribbonbaseelement-class.md#onrtlchanged)。)|  
|[CMFCRibbonGallery::RedrawIcons](#redrawicons)|組件庫會重新繪製。|  
|[CMFCRibbonGallery::RemoveItemToolTips](#removeitemtooltips)|移除組件庫中的所有項目中的工具提示。|  
|[CMFCRibbonGallery::SelectItem](#selectitem)||  
|[CMFCRibbonGallery::SetACCData](#setaccdata)|(覆寫[cmfcribbonbutton:: Setaccdata](../../mfc/reference/cmfcribbonbutton-class.md#setaccdata)。)|  
|[CMFCRibbonGallery::SetButtonMode](#setbuttonmode)|指定是否要顯示功能區圖庫下拉式按鈕，或直接在功能區上的調色盤。|  
|[CMFCRibbonGallery::SetGroupName](#setgroupname)|設定群組的名稱。|  
|[CMFCRibbonGallery::SetIconsInRow](#seticonsinrow)|組件庫中定義的每個資料列的項目數。|  
|[CMFCRibbonGallery::SetItemToolTip](#setitemtooltip)|在圖庫 中設定項目的工具提示文字。|  
|[CMFCRibbonGallery::SetPalette](#setpalette)|將色板附加至功能區圖庫中。|  
|[CMFCRibbonGallery::SetPaletteID](#setpaletteid)|定義傳送中的命令 ID`WM_COMMAND`訊息已選取主機庫項目時。|  
  
### <a name="protected-methods"></a>受保護的方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCRibbonGallery::OnDrawPaletteIcon](#ondrawpaletteicon)|繪製圖庫圖示時，由架構呼叫。|  
  
## <a name="remarks"></a>備註  
 組件庫按鈕行為就像一般功能表按鈕一樣，不同之處在於它會顯示主機庫，當使用者開啟它。 當您選取主機庫項目時，架構會傳送`WM_COMMAND`連同按鈕的命令 ID 的訊息。 當您處理訊息時，您應該呼叫[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)來判斷哪一個項目已從資源庫中選取。  
  
## <a name="example"></a>範例  
 下列範例示範如何使用各種方法的`CMFCRibbonGallery`用來設定類別`CMFCRibbonGallery`物件。 此範例說明如何指定組件庫中的每個資料列的項目數、 啟用 [功能表] 面板的調整大小、 啟用提要欄位的快顯功能表中，左邊和以調色盤直接在功能區列上顯示功能區圖庫。 這段程式碼片段是 [Draw 用戶端範例](../../visual-cpp-samples.md)的一部分。  
  
 [!code-cpp[NVC_MFC_DrawClient#6](../../mfc/reference/codesnippet/cpp/cmfcribbongallery-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md) [CMFCRibbonBaseElement](../../mfc/reference/cmfcribbonbaseelement-class.md) [CMFCRibbonButton](../../mfc/reference/cmfcribbonbutton-class.md)  
  
 [CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)  
  
## <a name="requirements"></a>需求  
 **標頭：** afxRibbonPaletteGallery.h  
  
##  <a name="addgroup"></a>  CMFCRibbonGallery::AddGroup  
 將新的群組加入至組件庫。  
  
```  
void AddGroup(
    LPCTSTR lpszGroupName,  
    UINT uiImagesPaletteResID,  
    int cxPaletteImage);

 
void AddGroup(
    LPCTSTR lpszGroupName,  
    CMFCToolBarImages& imagesGroup);

 
void AddGroup(
    LPCTSTR lpszGroupName,  
    int nIconsNum);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `lpszGroupName`  
 指定群組的名稱。  
  
 [輸入] `uiImagesPaletteResID`  
 指定的資源識別碼的影像清單，其中包含群組的映像。  
  
 [輸入] `cxPaletteImage`  
 指定映像素為單位的寬度。  
  
 [輸入] `imagesGroup`  
 影像清單，其中包含群組影像參考。  
  
 [輸入] `nIconsNum`  
 指定群組中的圖示數目。 應該指定這個參數，只會針對自訂 （擁有者繪製） 群組。  
  
### <a name="remarks"></a>備註  
 您可以分割成多個群組的功能區圖庫上的項目藉由呼叫這個方法。 每個群組都可以有標題。  
  
##  <a name="addsubitem"></a>  CMFCRibbonGallery::AddSubItem  
 將新的功能表項目加入至下拉式選單。  
  
```  
void AddSubItem(
    CMFCRibbonBaseElement* pSubItem,  
    int nIndex=-1,  
    BOOL bOnTop=FALSE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pSubItem`  
 要加入功能表項目的指標。  
  
 [輸入] `nIndex`  
 指定的位置以零為起始的索引位置插入項目。  
  
 [輸入] `bOnTop`  
 `TRUE` 若要指定功能區圖庫; 之前，應插入項目否則， `FALSE`。  
  
### <a name="remarks"></a>備註  
 您可以結合快顯視窗的組件庫的快顯功能表項目，藉由呼叫這個方法。 之前或之後的組件庫，則可以放置功能表項目。  
  
 若要插入組件庫前面的項目，設定`bOnTop`至`TRUE`。 設定`bOnTop`至`FALSE`来插入組件庫底下的項目。  
  
> [!NOTE]
>  參數`nIndex`指定插入索引在組件庫的頂端和底部的組件庫。 例如，如果您要插入組件庫之前的項目一個位置，請設定`nIndex`設為 1 和`bOnTop`至`TRUE`。 同樣地，如果您要插入組件庫下的項目一個位置，請設定`nIndex`設為 1 和`bOnTop`至`FALSE`。  
  
##  <a name="clear"></a>  CMFCRibbonGallery::Clear  
 清除 「 組件庫的內容。  
  
```  
virtual void Clear();
```  
  
### <a name="remarks"></a>備註  
 呼叫此方法以從功能區圖庫中移除所有內容。 這必須先將新的功能區圖庫或群組的集合附加至功能區圖庫完成。  
  
##  <a name="cmfcribbongallery"></a>  CMFCRibbonGallery::CMFCRibbonGallery  
 建構並初始化[CMFCRibbonGallery](../../mfc/reference/cmfcribbongallery-class.md)物件。  
  
```  
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    CMFCToolBarImages& imagesPalette);

 
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    UINT uiImagesPaletteResID=0,  
    int cxPaletteImage=0);

 
CMFCRibbonGallery (
    UINT nID,  
    LPCTSTR lpszText,  
    int nSmallImageIndex,  
    int nLargeImageIndex,  
    CSize sizeIcon,  
    int nIconsNum,  
    BOOL bDefaultButtonStyle=TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 指定當使用者按一下按鈕時若要執行命令的命令識別碼。  
  
 `lpszText`  
 指定要顯示在按鈕上的文字。  
  
 `nSmallImageIndex`  
 會出現在按鈕上的小型影像以零為起始的索引。  
  
 `nLargeImageIndex`  
 在按鈕上顯示大型影像的以零為起始的索引。  
  
 `imagesPalette`  
 若要參考[CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)物件，其中包含出現在資源庫映像。  
  
 `uiImagesPaletteResID`  
 組件庫上顯示的影像清單的資源識別碼。  
  
 `cxPaletteImage`  
 組件庫映像素為單位指定的寬度。  
  
 `sizeIcon`  
 指定資源庫映像素為單位的大小。  
  
 `nIconsNum`  
 指定組件庫中的圖示數目。  
  
 `bDefaultButtonStyle`  
 指定是否要使用預設值或為主控描繪按鈕樣式。  
  
### <a name="remarks"></a>備註  
  
##  <a name="enablemenuresize"></a>  CMFCRibbonGallery::EnableMenuResize  
 啟用或停用功能表面板的調整大小。  
  
```  
void EnableMenuResize(
    BOOL bEnable = TRUE,  
    BOOL bVertcalOnly = FALSE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bEnable`  
 `TRUE` 若要啟用 調整大小功能表;否則， `FALSE`。  
  
 [輸入] `bVertcalOnly`  
 `TRUE` 若要指定的圖庫可以垂直調整大小只;`FALSE`來指定組件庫，可能會調整大小同時垂直和水平。  
  
### <a name="remarks"></a>備註  
 若要啟用或停用調整大小功能區圖庫中使用這個方法。 啟用時調整大小，功能區圖庫會顯示移駐夾的使用者可以用來調整其大小。  
  
##  <a name="enablemenusidebar"></a>  CMFCRibbonGallery::EnableMenuSideBar  
 啟用或停用快顯功能表左邊提要欄位。  
  
```  
void EnablMenuSideBar(BOOL bEnable=TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bEnable`  
 `TRUE` 若要指定的提要欄位已啟用。否則， `FALSE`。  
  
### <a name="remarks"></a>備註  
 呼叫此方法以啟用或停用在左側功能表的 Office XP 樣式提要欄位。  
  
##  <a name="getcompactsize"></a>  CMFCRibbonGallery::GetCompactSize  

  
```  
virtual CSize GetCompactSize(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getdroppeddown"></a>  CMFCRibbonGallery::GetDroppedDown  

  
```  
virtual CMFCRibbonBaseElement* GetDroppedDown();
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getgroupname"></a>  CMFCRibbonGallery::GetGroupName  
 傳回位於指定索引上的群組名稱。  
  
```  
LPCTSTR GetGroupName(int nGroupIndex) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nGroupIndex`  
 指定您想要擷取其名稱的群組以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 位於指定索引處的群組名稱。 傳遞無效的索引，將會導致失敗的判斷提示。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getgroupoffset"></a>  CMFCRibbonGallery::GetGroupOffset  

  
```  
virtual int GetGroupOffset() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="geticonsinrow"></a>  CMFCRibbonGallery::GetIconsInRow  
 傳回資料列的功能區圖庫中的項目數目。  
  
```  
int GetIconsInRow() const;  
```  
  
### <a name="return-value"></a>傳回值  
 資料列中的項目數目。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getitemtooltip"></a>  CMFCRibbonGallery::GetItemToolTip  
 傳回組件庫中的項目相關聯的工具提示文字。  
  
```  
LPCTSTR GetItemToolTip(int nItemIndex) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nItemIndex`  
 指定要擷取的工具提示文字的項目以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 工具提示字串指派給功能區圖庫中的項目指標。 它可以是`NULL`如果任何工具提示會不指派給這個項目。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getlastselecteditem"></a>  CMFCRibbonGallery::GetLastSelectedItem  
 傳回使用者選取的功能區圖庫中的最後一個項目的索引。  
  
```  
static int GetLastSelectedItem(UINT uiCmdID);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `uiCmdID`  
 指定功能表項目，開啟功能區圖庫的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 當使用者在功能區圖庫中選取任何項目時，程式庫會傳送`WM_COMMAND`以及開啟功能區圖庫的功能表按鈕的命令 ID 的訊息。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getpaletteid"></a>  CMFCRibbonGallery::GetPaletteID  
 傳回目前的調色盤的命令識別碼。  
  
```  
int GetPaletteID() const;  
```  
  
### <a name="return-value"></a>傳回值  
 目前選取的調色盤命令識別碼。  
  
### <a name="remarks"></a>備註  
  
##  <a name="getregularsize"></a>  CMFCRibbonGallery::GetRegularSize  

  
```  
virtual CSize GetRegularSize(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="getselecteditem"></a>  CMFCRibbonGallery::GetSelectedItem  

  
```  
int GetSelectedItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="hasmenu"></a>  CMFCRibbonGallery::HasMenu  

  
```  
virtual BOOL HasMenu() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="isbuttonmode"></a>  CMFCRibbonGallery::IsButtonMode  
 指定調色盤是否包含在組件庫按鈕。  
  
```  
BOOL IsButtonMode() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE` 如果調色盤會顯示為下拉式清單功能表按鈕。`FALSE`如果直接在功能區上顯示調色盤。  
  
### <a name="remarks"></a>備註  
  
##  <a name="ismenuresizeenabled"></a>  CMFCRibbonGallery::IsMenuResizeEnabled  
 指定是否啟用功能表調整大小。  
  
```  
BOOL IsMenuResizeEnabled() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE` 如果已啟用功能表調整大小;否則， `FALSE`。  
  
### <a name="remarks"></a>備註  
  
##  <a name="ismenuresizevertical"></a>  CMFCRibbonGallery::IsMenuResizeVertical  

  
```  
BOOL IsMenuResizeVertical() const;  
```  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
  
##  <a name="ismenusidebar"></a>  CMFCRibbonGallery::IsMenuSideBar  
 指定是否啟用或停用提要欄位。  
  
```  
BOOL IsMenuSideBar() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE` 如果在快顯功能表; 左下方繪製 Office XP 樣式提要欄位否則， `FALSE`。  
  
### <a name="remarks"></a>備註  
  
##  <a name="onafterchangerect"></a>  CMFCRibbonGallery::OnAfterChangeRect  

  
```  
virtual void OnAfterChangeRect(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
  
### <a name="remarks"></a>備註  
  
##  <a name="ondraw"></a>  CMFCRibbonGallery::OnDraw  

  
```  
virtual void OnDraw(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
  
### <a name="remarks"></a>備註  
  
##  <a name="ondrawpaletteicon"></a>  CMFCRibbonGallery::OnDrawPaletteIcon  
 繪製圖庫圖示時，由架構呼叫。  
  
```  
virtual void OnDrawPaletteIcon(
    CDC* pDC,  
    CRect rectIcon,  
    int nIconIndex,  
    CMFCRibbonGalleryIcon* pIcon,  
    COLORREF clrText);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
 用於繪製的裝置內容的指標。  
  
 [輸入] `rectIcon`  
 指定的週框的圖示，以繪製。  
  
 [輸入] `nIconIndex`  
 影像清單的組件庫圖示的圖示，以繪製在指定的以零為起始的索引。  
  
 [輸入] `pIcon`  
 正在繪製之圖示的指標。  
  
 [輸入] `clrText`  
 指定要繪製的項目文字的色彩。  
  
### <a name="remarks"></a>備註  
 您可以覆寫這個方法來自訂功能區圖庫外觀的衍生類別中。  
  
##  <a name="onenable"></a>  CMFCRibbonGallery::OnEnable  

  
```  
virtual void OnEnable(BOOL bEnable);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bEnable`  
  
### <a name="remarks"></a>備註  
  
##  <a name="onrtlchanged"></a>  CMFCRibbonGallery::OnRTLChanged  

  
```  
virtual void OnRTLChanged(BOOL bIsRTL);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bIsRTL`  
  
### <a name="remarks"></a>備註  
  
##  <a name="redrawicons"></a>  CMFCRibbonGallery::RedrawIcons  
 組件庫會重新繪製。  
  
```  
void RedrawIcons();
```  
  
### <a name="remarks"></a>備註  
 呼叫此函式可重繪其組件庫。 如果您已在執行階段組件庫的內容，您必須呼叫這個方法。  
  
##  <a name="removeitemtooltips"></a>  CMFCRibbonGallery::RemoveItemToolTips  
 移除組件庫中的所有項目中的工具提示。  
  
```  
void RemoveItemToolTips();
```  
  
### <a name="remarks"></a>備註  
  
##  <a name="selectitem"></a>  CMFCRibbonGallery::SelectItem  

  
```  
void SelectItem(int nItemIndex);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nItemIndex`  
  
### <a name="remarks"></a>備註  
  
##  <a name="setaccdata"></a>  CMFCRibbonGallery::SetACCData  
 使用功能區圖庫中的協助工具資料填入指定的 `CAccessibilityData` 物件。  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,   
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pParent`  
 功能區圖庫視窗的父視窗。  
  
 [輸出] `data`  
 從功能區圖庫接收協助工具資料的 `CAccessibilityData` 物件。  
  
### <a name="return-value"></a>傳回值  
  
### <a name="remarks"></a>備註  
 如果方法成功，則為 `TRUE`，否則為 `FALSE`。  
  
##  <a name="setbuttonmode"></a>  CMFCRibbonGallery::SetButtonMode  
 決定是否要顯示功能區圖庫下拉式按鈕，或直接在功能區上的調色盤。  
  
```  
void SetButtonMode(BOOL bSet=TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bSet`  
 `TRUE` 若要以下拉功能表按鈕; 顯示功能區圖庫`FALSE`在功能區上直接顯示功能區圖庫的內容。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setgroupname"></a>  CMFCRibbonGallery::SetGroupName  
 設定群組的名稱。  
  
```  
void SetGroupName(
    int nGroupIndex,  
    LPCTSTR lpszGroupName);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nGroupIndex`  
 指定的群組名稱要變更的以零為起始的索引。  
  
 [輸入] `lpszGroupName`  
 指定群組的新名稱。  
  
### <a name="remarks"></a>備註  
 正在變更其名稱的群組必須已加入使用[CMFCRibbonGallery::AddGroup](#addgroup)方法。  
  
##  <a name="seticonsinrow"></a>  CMFCRibbonGallery::SetIconsInRow  
 指定組件庫中的每個資料列的項目數。  
  
```  
void SetIconsInRow(int nIconsInRow);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nIconsInRow`  
 指定要在組件庫的每個資料列中顯示的項目數。  
  
### <a name="remarks"></a>備註  
 使用這個方法來指定功能區圖庫的寬度。  
  
##  <a name="setitemtooltip"></a>  CMFCRibbonGallery::SetItemToolTip  
 在圖庫 中設定項目的工具提示文字。  
  
```  
void SetItemToolTip(
    int nItemIndex,  
    LPCTSTR lpszToolTip);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nItemIndex`  
 與相關聯的工具提示的調色盤項目以零為起始的索引。  
  
 [輸入] `lpszToolTip`  
 在工具提示上顯示的文字。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setpalette"></a>  CMFCRibbonGallery::SetPalette  
 將色板附加至功能區圖庫中。  
  
```  
void SetPalette(CMFCToolBarImages& imagesPalette);

 
void SetPalette(
    UINT uiImagesPaletteResID,  
    int cxPaletteImage);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `imagesPalette`  
 指定包含要顯示在組件庫上圖示的影像清單。  
  
 [輸入] `uiImagesPaletteResID`  
 指定影像清單，其中包含出現在組件庫圖示的資源識別碼。  
  
 [輸入] `cxPaletteImage`  
 組件庫映像素為單位指定的寬度。  
  
### <a name="remarks"></a>備註  
  
##  <a name="setpaletteid"></a>  CMFCRibbonGallery::SetPaletteID  
 定義傳送中的命令 ID **WM_COMMAND**訊息當使用者選取主機庫項目。  
  
```  
void SetPaletteID(UINT nID);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nID`  
 指定傳送中的命令識別碼**WM_COMMAND**訊息當使用者選取主機庫項目。  
  
### <a name="remarks"></a>備註  
 若要判斷使用者選取 從組件庫的特定項目，請呼叫[CMFCRibbonGallery::GetLastSelectedItem](#getlastselecteditem)靜態方法。  
  
## <a name="see-also"></a>另請參閱  
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [類別](../../mfc/reference/mfc-classes.md)   
 [CMFCRibbonButton 類別](../../mfc/reference/cmfcribbonbutton-class.md)   
 [CMFCRibbonGalleryMenuButton 類別](../../mfc/reference/cmfcribbongallerymenubutton-class.md)
