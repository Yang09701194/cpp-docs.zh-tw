---
title: CMFCToolBar 類別 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7b92acb477e6e15dfe933360dd6456db09d7f52a
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/19/2018
ms.locfileid: "46408736"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 類別

`CMFCToolBar`類別類似於[CToolBar 類別](../../mfc/reference/ctoolbar-class.md)，但是提供額外的使用者介面功能的支援。 這包括一般工具列、含作用中影像的工具列、大圖示、頁面巡覽區按鈕、鎖定工具列、Rebar 控制項、影像下方文字、背景影像和索引標籤式工具列。 `CMFCToolBar` 類別的內建支援也包括工具列和功能表的使用者自訂、工具列和功能表之間的拖放、下拉式方塊按鈕、編輯方塊按鈕、色彩選擇器和縮合按鈕。

如需詳細資訊，請參閱中的原始程式碼**VC\\atlmfc\\src\\mfc** Visual Studio 安裝資料夾。

## <a name="syntax"></a>語法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|預設建構函式。|
|`CMFCToolBar::~CMFCToolBar`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|將功能表命令加入至一定會在使用者開啟功能表時所顯示的命令清單。|
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|一個指定的命令相關聯的計數器遞增。|
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|新增映像從使用者介面資源的應用程式中的映像集合。|
|[CMFCToolBar::AdjustLayout](#adjustlayout)|重新計算的大小和位置 工具列。 (覆寫[cbasepane:: Adjustlayout](../../mfc/reference/cbasepane-class.md#adjustlayout))。|
|[CMFCToolBar::AdjustSize](#adjustsize)|重新計算工具列的大小。|
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|指定是否可以顯示文字標籤底下的工具列按鈕上的映像。|
|[CMFCToolBar::AreTextLabels](#aretextlabels)|指定影像下方的文字標籤是否目前顯示在工具列按鈕上。|
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|啟用或停用自動產生的非作用中的按鈕影像。|
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|傳回指定的索引[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)此工具列中的物件。|
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|計算工具列的水平大小。 (覆寫[cbasepane:: Calcfixedlayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout)。)|
|[CMFCToolBar::CalcSize](#calcsize)|由架構呼叫的版面配置計算處理序的一部分。 (覆寫[CPane::CalcSize](../../mfc/reference/cpane-class.md#calcsize)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFCToolBar::CleanUpImages](#cleanupimages)|釋放配置給工具列影像的系統資源。|
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|釋放配置的鎖定的工具列影像的系統資源。|
|[CMFCToolBar::CanBeClosed](#canbeclosed)|指定使用者是否可以關閉工具列。 (覆寫[cbasepane:: Canbeclosed](../../mfc/reference/cbasepane-class.md#canbeclosed)。)|
|[CMFCToolBar::CanBeRestored](#canberestored)|判斷是否系統可以還原工具列為其原始狀態後自訂。|
|[CMFCToolBar::CanFocus](#canfocus)|指定是否可以取得焦點。 (覆寫[CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFCToolBar::CommandToIndex](#commandtoindex)|傳回的按鈕索引，在工具列中，並提供指定的命令識別碼。|
|[CMFCToolBar::Create](#create)|建立 `CMFCToolBar` 物件。|
|[CMFCToolBar::CreateEx](#createex)|建立`CMFCToolBar`使用其他樣式選項，例如大型圖示的物件。|
|[CMFCToolBar::Deactivate](#deactivate)|停用工具列。|
|[Cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)|啟用或停用**新增或移除按鈕**會出現在結尾的工具列的按鈕。|
|[CMFCToolBar::EnableDocking](#enabledocking)|可停駐窗格的回主框架。 (覆寫[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)。)|
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|啟用或停用工具列按鈕上的大圖示。|
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|啟用或停用快速自訂的工具列，讓使用者可以按**Alt**鍵，並將按鈕拖曳至新位置。|
|[CMFCToolBar::EnableReflections](#enablereflections)|啟用或停用命令的反映。|
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|啟用或停用工具列按鈕影像下方的文字標籤。|
|[CMFCToolBar::FromHandlePermanent](#fromhandlepermanent)|擷取的指標`CMFCToolBar`物件，其中包含指定的視窗控制代碼。|
|[CMFCToolBar::GetAllButtons](#getallbuttons)|在工具列中傳回按鈕的唯讀的清單。|
|[CMFCToolBar::GetAllToolbars](#getalltoolbars)|在應用程式會傳回所有工具列唯讀清單。|
|[CMFCToolBar::GetBasicCommands](#getbasiccommands)|傳回唯讀的應用程式中所定義的基本命令清單。|
|[CMFCToolBar::GetButton](#getbutton)|將指標傳回至`CMFCToolBarButton`具有指定的工具列按鈕索引的物件。|
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|傳回命令 ID、 樣式和指定的索引處的按鈕影像索引。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|在工具列上，傳回每個按鈕的大小。|
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|傳回目前位於指定索引處的工具列按鈕的樣式。|
|[CMFCToolBar::GetButtonText](#getbuttontext)|傳回具有指定的索引的按鈕的文字標籤。|
|[CMFCToolBar::GetColdImages](#getcoldimages)|讓指標回到應用程式中的非作用中工具列按鈕影像的集合。|
|[CMFCToolBar::GetColumnWidth](#getcolumnwidth)|傳回的工具列按鈕的寬度。|
|[CMFCToolBar::GetCommandButtons](#getcommandbuttons)|傳回一份應用程式中有指定的命令 ID，從所有的工具列按鈕。|
|[CMFCToolBar::GetCount](#getcount)|傳回在工具列上的按鈕和分隔符號數目。|
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|擷取的指標`CMFCCustomizeButton`與工具列相關聯的物件。|
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|傳回具有指定之命令識別碼的工具列按鈕的預設影像的索引|
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|映像所使用的應用程式中的已停用的工具列按鈕集合中傳回的指標。|
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|讓指標回到應用程式中的已停用的功能表按鈕所使用的映像集合。|
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|擷取目前顯示子功能表的功能表按鈕物件的指標。|
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|指定是否已停用按鈕的影像會呈現暗灰色的版本，標準按鈕的影像，或從 已停用的按鈕影像的集合。|
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|讓指標回到目前反白顯示的工具列按鈕。|
|[CMFCToolBar::GetHotBorder](#gethotborder)|決定工具列按鈕是否為熱追蹤。|
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|傳回文字的色彩反白顯示的工具列按鈕。|
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|傳回具有輸入的焦點，工具列沒有之前的視窗控制代碼。|
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|指定是否忽略呼叫設定按鈕的標籤。|
|[CMFCToolBar::GetImageSize](#getimagesize)|傳回目前的工具列按鈕影像的大小。|
|[CMFCToolBar::GetImages](#getimages)|讓指標回到預設集合 按鈕影像的應用程式中。|
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|傳回用來尋找此工具列，工具列按鈕影像的全域清單中的工具列按鈕影像的索引位移。|
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|擷取工作區，必須指定索引處的按鈕重新繪製的區域。|
|[CMFCToolBar::GetItemID](#getitemid)|傳回指定索引處的工具列按鈕的命令識別碼。|
|[CMFCToolBar::GetItemRect](#getitemrect)|傳回指定索引處的按鈕的週框矩形。|
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|讓指標回到應用程式中的大型非作用中工具列按鈕影像的集合。|
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|讓指標回到應用程式中的大型的已停用的工具列按鈕影像的集合。|
|[CMFCToolBar::GetLargeImages](#getlargeimages)|讓指標回到應用程式中的大型的工具列按鈕影像的集合。|
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|在工具列上的鎖定冷映像的集合中傳回的指標。|
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|在工具列上的鎖定已停用映像的集合中傳回的指標。|
|[CMFCToolBar::GetLockedImages](#getlockedimages)|在工具列上的鎖定的按鈕影像的集合中傳回的指標。|
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|傳回已鎖定的工具列影像的預設大小。|
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|讓指標回到集合已鎖定工具列的功能表影像的工具列中。|
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|傳回應用程式中的功能表按鈕的大小。|
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|傳回應用程式中的功能表按鈕影像的大小。|
|[CMFCToolBar::GetMenuImages](#getmenuimages)|讓指標回到應用程式中的功能表按鈕影像的集合。|
|[CMFCToolBar::GetOrigButtons](#getorigbuttons)|擷取的非自訂化的按鈕，工具列的集合。|
|[CMFCToolBar::GetOrigResetButtons](#getorigresetbuttons)|擷取的非自訂的重設按鈕，工具列的集合。|
|[CMFCToolBar::GetResourceID](#getresourceid)|擷取工具列的資源識別碼。|
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|決定哪些物件、 父框架或擁有者，將命令傳送至工具列。|
|[CMFCToolBar::GetRowHeight](#getrowheight)|傳回的工具列按鈕的高度。|
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|指定工具列按鈕是否顯示工具提示。|
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|擷取工具列的同層級。|
|[CMFCToolBar::GetUserImages](#getuserimages)|讓指標回到應用程式中的使用者定義工具列按鈕影像的集合。|
|[CMFCToolBar::HitTest](#hittest)|傳回位於指定位置處的工具列按鈕的索引。|
|[CMFCToolBar::InsertButton](#insertbutton)|插入工具列按鈕。|
|[CMFCToolBar::InsertSeparator](#insertseparator)|插入工具列中的分隔符號。|
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|失效的工具列按鈕，在提供的索引存在工作的區。|
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|判斷使用者是否可以新增或移除工具列按鈕，使用**自訂**功能表選項。|
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|指定是否*快速自訂*正將按鈕拖曳。|
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|指定是否啟用自動產生的非作用中 （非醒目提示） 的按鈕影像。|
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|判斷命令是否在清單中的基本命令。|
|[CMFCToolBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|判斷工具列是否可以顯示擴充框線的按鈕。|
|[CMFCToolBar::IsButtonHighlighted](#isbuttonhighlighted)|決定工具列上的按鈕會反白顯示。|
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|決定是否要允許的命令。|
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|判斷命令是否很少使用 (請參閱[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions))。|
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|指定工具列 framework 是否為自訂模式。|
|[CMFCToolBar::IsDragButton](#isdragbutton)|決定是否被拖曳的工具列按鈕。|
|[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)|判斷是否要包含工具列**自訂** 按鈕。|
|[CMFCToolBar::IsFloating](#isfloating)|決定是否浮動工具列。|
|[CMFCToolBar::IsLargeIcons](#islargeicons)|指定是否在應用程式中的工具列目前顯示大型圖示。|
|[CMFCToolBar::IsLastCommandFromButton](#islastcommandfrombutton)|判斷最近執行已傳送命令，從指定的工具列按鈕。|
|[CMFCToolBar::IsLocked](#islocked)|決定是否要鎖定工具列。|
|[Cmfctoolbar:: Isonerowwithsibling](#isonerowwithsibling)|決定是否工具列和工具列，其同層級位於相同的資料列。|
|[CMFCToolBar::IsUserDefined](#isuserdefined)|指定工具列是否為使用者定義。|
|[CMFCToolBar::LoadBitmap](#loadbitmap)|從應用程式資源載入工具列影像。|
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|從應用程式資源載入工具列影像。 包含大型映像。|
|[CMFCToolBar::LoadParameters](#loadparameters)|從 Windows 登錄載入全域工具列上的選項。|
|[CMFCToolBar::LoadState](#loadstate)|從 Windows 登錄載入工具列狀態資訊。 (覆寫[CPane::LoadState](../../mfc/reference/cpane-class.md#loadstate)。)|
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|從應用程式資源載入工具列。|
|[Cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)|使用從應用程式資源載入工具列`CMFCToolBarInfo`helper 類別，可讓應用程式使用大型映像。|
|[CMFCToolBar::OnChangeHot](#onchangehot)|當使用者選取工具列上的按鈕時由架構呼叫。|
|[CMFCToolBar::OnFillBackground](#onfillbackground)|由架構呼叫[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)工具列背景填滿。|
|[CMFCToolBar::OnReset](#onreset)|還原為其原始狀態的工具列。|
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(覆寫[cbasepane:: Onsetaccdata](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|還原成預設狀態的工具列按鈕的文字。|
|`CMFCToolBar::OnUpdateCmdUI`|在內部使用。|
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|從工具列中，移除所有的按鈕。|
|[CMFCToolBar::RemoveButton](#removebutton)|從工具列中移除具有指定索引的按鈕。|
|[CMFCToolBar::RemoveStateFromRegistry](#removestatefromregistry)|從 Windows 登錄中刪除工具列的狀態資訊。|
|[CMFCToolBar::ReplaceButton](#replacebutton)|取代另一個工具列按鈕的工具列按鈕。|
|[CMFCToolBar::ResetAll](#resetall)|將所有工具列都還原至其原始狀態。|
|[CMFCToolBar::ResetAllImages](#resetallimages)|清除所有應用程式中的工具列影像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|還原工具列的原始狀態。|
|[CMFCToolBar::SaveState](#savestate)|將工具列的狀態資訊儲存在 Windows 登錄中。 (覆寫[CPane::SaveState](../../mfc/reference/cpane-class.md#savestate)。)|
|`CMFCToolBar::Serialize`|(覆寫 `CBasePane::Serialize`。)|
|[CMFCToolBar::SetBasicCommands](#setbasiccommands)|設定一律會在使用者開啟功能表時所顯示的命令清單。|
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|設定命令 ID、 樣式和工具列按鈕的映像識別碼。|
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|設定指定索引處的工具列按鈕的樣式。|
|[CMFCToolBar::SetButtonText](#setbuttontext)|設定工具列按鈕的文字標籤。|
|[CMFCToolBar::SetButtons](#setbuttons)|設定工具列的按鈕。|
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|指定當很少使用的命令未出現的功能表中的應用程式。|
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|啟用或停用應用程式中的所有工具列的自訂模式。|
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|指定是否停用的按鈕，在工具列上會以灰色顯示，或如果已停用的映像會用於停用的按鈕。|
|[CMFCToolBar::SetHeight](#setheight)|設定工具列的高度。|
|[CMFCToolBar::SetHotBorder](#sethotborder)|指定工具列按鈕是否熱追蹤。|
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|設定作用中工具列按鈕的文字色彩。|
|[CMFCToolBar::SetLargeIcons](#setlargeicons)|指定工具列按鈕是否顯示大型圖示。|
|[CMFCToolBar::SetLockedSizes](#setlockedsizes)|在工具列上設定鎖定的按鈕和鎖定的映像的大小。|
|[CMFCToolBar::SetMenuSizes](#setmenusizes)|設定工具列功能表按鈕和其映像的大小。|
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|設定使用者無法執行的命令的清單。|
|[Cmfctoolbar:: Setonerowwithsibling](#setonerowwithsibling)|將工具列和其同層級置於相同的資料列。|
|[CMFCToolBar::SetPermament](#setpermament)|指定使用者是否可以關閉工具列。|
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|指定是否在父框架或擁有者的命令傳送至工具列。|
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|指定是否，架構會顯示工具提示。|
|[Cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)|指定工具列的同層級。|
|[CMFCToolBar::SetSizes](#setsizes)|指定所有的工具列按鈕和映像的大小。|
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|在工具列上，指定按鈕的屬性。|
|[Cmfctoolbar:: Settworowswithsibling](#settworowswithsibling)|將工具列和其同層級置於個別的資料列。|
|[CMFCToolBar::SetUserImages](#setuserimages)|應用程式中設定使用者定義的映像的集合。|
|[CMFCToolBar::StretchPane](#stretchpane)|會自動水平或垂直縮放的工具列。 (覆寫[cbasepane:: Stretchpane](../../mfc/reference/cbasepane-class.md#stretchpane)。)|
|[CMFCToolBar::TranslateChar](#translatechar)|如果指定的按鍵碼對應至有效的鍵盤快速鍵，請執行按鈕命令。|
|[CMFCToolBar::UpdateButton](#updatebutton)|更新指定的按鈕狀態。|
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|重新調整位置指定的維度內的工具列按鈕。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|決定工具列是否會顯示在清單上**工具列**窗格**自訂** 對話方塊。|
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|計算在工具列上按鈕的最大高度。|
|[CMFCToolBar::DoPaint](#dopaint)|工具列會重新繪製。|
|[CMFCToolBar::DrawButton](#drawbutton)|會重新繪製的工具列按鈕。|
|[CMFCToolBar::DrawSeparator](#drawseparator)|在工具列上的分隔符號會重新繪製。|
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|按鈕的工具提示即將顯示時由架構呼叫。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBar::m_bDontScaleImages](#m_bdontscaleimages)|在高 DPI 模式中，指定是否要調整或不是工具列影像。|
|[CMFCToolBar::m_dblLargeImageRatio](#m_dbllargeimageratio)|指定大型影像的維度 （高度或寬度） 和一般映像的維度之間的比例。|

## <a name="remarks"></a>備註

若要納入`CMFCToolBar`物件到您的應用程式，請遵循下列步驟：

1. 新增`CMFCToolBar`主框架視窗的物件。

1. 當您處理主框架視窗的 WM_CREATE 訊息時，呼叫[CMFCToolBar::Create](#create)或是[CMFCToolBar::CreateEx](#createex)建立工具列，並指定其樣式。

1. 呼叫[CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)指定停駐樣式。

若要插入的特殊按鈕，例如下拉式方塊或下拉式工具列中，保留假的按鈕，在父資源中，並使用取代假的按鈕，在執行階段[CMFCToolBar::ReplaceButton](#replacebutton)。 如需詳細資訊，請參閱 <<c0> [ 逐步解說： 將工具列控制項](../walkthrough-putting-controls-on-toolbars.md)。

`CMFCToolBar` MFC 程式庫類別的基底類別[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)， [CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)，並[CMFCDropDownToolBar 類別](../../mfc/reference/cmfcdropdowntoolbar-class.md)。

## <a name="example"></a>範例

下列範例示範如何使用中的各種方法`CMFCToolBar`類別。 此範例示範如何設定標籤的文字視窗的工具列、 設定的框線、 將窗格 的樣式設定和啟用**新增或移除按鈕**會出現在結尾的工具列的按鈕。 此程式碼片段是一部分[IE 示範範例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>需求

**標頭：** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

##  <a name="addbasiccommand"></a>  CMFCToolBar::AddBasicCommand

將功能表命令加入至一定會在使用者開啟功能表時所顯示的命令清單。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]指定要新增的命令。

### <a name="remarks"></a>備註

在功能表開啟時，一律會顯示基本命令。 當使用者選擇要檢視最近使用的命令，這個方法是有意義。

使用[CMFCToolBar::SetBasicCommands](#setbasiccommands)方法來設定一律會在使用者開啟功能表時所顯示的命令清單。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法來擷取基本命令，以供您的應用程式的清單。

##  <a name="addcommandusage"></a>  CMFCToolBar::AddCommandUsage

一個指定的命令相關聯的計數器遞增。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>參數

*uiCommand*<br/>
[in]指定命令要計數器遞增。

### <a name="remarks"></a>備註

當使用者選取功能表項目時，架構會呼叫這個方法。

架構會使用計數器，可用來顯示最近使用的功能表項目 命令。

這個方法會使用遞增命令計數器[CMFCCmdUsageCount::AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法。

##  <a name="addtoolbarforimagecollection"></a>  CMFCToolBar::AddToolBarForImageCollection

新增映像從使用者介面資源的應用程式中的映像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[in]資源識別碼的工具列與映像的載入。

*uiBmpResID*<br/>
[in]工具列影像的點陣圖的資源識別碼。

*uiColdResID*<br/>
[in]與 「 冷 」 的工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
[in]功能表影像的點陣圖的資源識別碼。

*uiDisabledResID*<br/>
[in]已停用的工具列影像的點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
[in]已停用的功能表影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE。False *uiResID*或是*uiBmpResID*未指定有效的資源，或發生其他錯誤。

### <a name="remarks"></a>備註

呼叫這個方法來載入工具列影像的點陣圖，並將它新增至工具列影像的集合。 這個方法會建立暫存的工具列物件並呼叫[CMFCToolBar::LoadToolBar](#loadtoolbar)。

##  <a name="adjustlayout"></a>  CMFCToolBar::AdjustLayout

重新計算的大小和位置 工具列。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>備註

若要重新計算的大小和位置建立工具列之後，請呼叫這個方法。

架構會呼叫這個方法每次時，必須變更工具列的版面配置。 例如，使用者將另一個控制列、 調整大小的應用程式 視窗中，或自訂工具列時，必須變更版面配置。

覆寫此方法以提供您自己的動態配置，您可以從衍生類別中`CMFCToolbar`。

##  <a name="adjustsize"></a>  CMFCToolBar::AdjustSize

重新計算工具列的大小。

```
void AdjustSize();
```

### <a name="remarks"></a>備註

這個方法可確保工具列，以符合父框架界限內。 如果工具列有沒有父框架，這個方法任何作用。

[CMFCToolBar::AdjustLayout](#adjustlayout)方法會呼叫這個方法，以重新計算的大小，如果不是工具列的父代`CMFCReBar`物件。

##  <a name="allowchangetextlabels"></a>  CMFCToolBar::AllowChangeTextLabels

指定是否可以顯示文字標籤底下的工具列按鈕上的映像。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果允許顯示圖像; 下方的文字標籤，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會呼叫 [自訂] 對話方塊中，以判斷是否要啟用**顯示文字標籤**上的核取方塊**工具列**頁面選取的工具列。

預設實作會傳回 TRUE。

覆寫此方法中的物件衍生自`CMFCToolBar`，也不想讓使用者決定是否會在影像下方的工具列按鈕上顯示文字標籤時，傳回 FALSE。

##  <a name="allowshowonlist"></a>  CMFCToolBar::AllowShowOnList

決定工具列上是否會顯示在清單中的工具列**工具列**窗格**自訂** 對話方塊。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>傳回值

如果工具列物件可顯示在工具列的 [自訂] 頁面; 清單方塊中，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

決定是否工具列的 [自訂] 頁面上的清單應包含衍生自特定物件的架構所呼叫這個方法`CMFCToolBar`。

預設實作永遠傳回 TRUE。 當您不想要出現在 [自訂] 對話方塊中的 [工具列] 清單中的工具列，請覆寫這個方法。

##  <a name="aretextlabels"></a>  CMFCToolBar::AreTextLabels

指定影像下方的文字標籤是否目前顯示在工具列按鈕上。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕顯示的影像; 下方的文字標籤，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

使用[CMFCToolBar::EnableTextLabels](#enabletextlabels)可指定是否要顯示的文字。 預設值為 FALSE。 呼叫[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)來指定使用者是否可以變更此設定，在 [自訂] 對話方塊中的。

##  <a name="autograyinactiveimages"></a>  CMFCToolBar::AutoGrayInactiveImages

啟用或停用自動產生的非作用中的按鈕影像。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]布林值，指定是否要將非使用中的映像變暗。 如果此參數為 TRUE，會以灰色顯示非作用中的映像。 否則，非作用中的映像未呈現灰色。

*nGrayImagePercentage*<br/>
[in]指定非使用中的映像的明亮度百分比。 如果*bEnable*為 FALSE，則會忽略此值。

*bRedrawAllToolbars*<br/>
[in]布林值，指定是否要在應用程式來重繪所有工具列。 如果此參數為 TRUE，則這個方法會重新繪製所有工具列。

### <a name="remarks"></a>備註

如果*bEnable*為 TRUE 時，架構會使用*nGrayImagePercentage*從一般的映像產生非使用中的映像。 否則，您必須提供的一組非作用中的影像使用[CMFCToolBar::GetColdImages](#getcoldimages)方法。 根據預設，此選項已停用。

如需詳細資訊*nGrayImagePercentage*參數，請參閱[CMFCToolBarImages::GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

##  <a name="buttontoindex"></a>  CMFCToolBar::ButtonToIndex

傳回指定的索引[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)此工具列中的物件。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]工具列按鈕物件指標。

### <a name="return-value"></a>傳回值

索引*pButton*工具列按鈕，則為-1 指定的按鈕不是此工具列上的內部清單中。

##  <a name="calcfixedlayout"></a>  CMFCToolBar::CalcFixedLayout

計算工具列的水平大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*bStretch*<br/>
[in]如果為 true，則延展工具列的父框架的大小。

*bHorz*<br/>
[in]TRUE 表示引導工具列的水平空間。調整成工具列垂直，則為 FALSE。

### <a name="return-value"></a>傳回值

A`CSize`物件，指定工具列的大小。

### <a name="remarks"></a>備註

這個方法會使用計算工具列大小`CMFCToolBar::CalcLayout`方法。 通過 LM_STRETCH 旗標*dwMode*參數如果*bStretch*為 TRUE。 它會傳遞 LM_HORZ 旗標，如果*bHorz*為 TRUE。

請參閱 VisualStudioDemo 範例，其中會使用這個方法的範例。

##  <a name="calcmaxbuttonheight"></a>  CMFCToolBar::CalcMaxButtonHeight

計算中的工具列按鈕的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>傳回值

按鈕的最大高度。

### <a name="remarks"></a>備註

這個方法會計算在工具列上的所有工具列按鈕之間的最大高度。 高度根據目前的工具列停駐狀態等因素而有所不同。

衍生自的類別中置換此方法`CMFCToolBar`提供您自己的高度計算。

##  <a name="calcsize"></a>  CMFCToolBar::CalcSize

由架構呼叫的版面配置計算處理序的一部分。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>參數

*bVertDock*<br/>
[in]TRUE 表示指定的工具列停駐垂直;指定的工具列是否停駐水平，則為 FALSE。

### <a name="return-value"></a>傳回值

A`CSize`物件，指定在工具列上的按鈕的整體大小。

### <a name="remarks"></a>備註

這個方法會考量影響的每個按鈕，例如文字標籤和框線大小的區域大小的屬性。

如果工具列會不包含任何按鈕，這個方法會傳回所使用的保留的大小的單一按鈕[CMFCToolBar::GetButtonSize](#getbuttonsize)方法。

##  <a name="canbeclosed"></a>  CMFCToolBar::CanBeClosed

指定使用者是否可以關閉工具列。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>傳回值

如果工具列可由使用者關閉，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷使用者是否可以關閉工具列。 如果方法會傳回 TRUE，這種架構可以 SC_CLOSE 命令工具列的 [系統] 功能表中，使用者可以使用 [自訂] 對話方塊中的工具列的清單中的核取方塊來關閉工具列。

預設實作會傳回 TRUE。 衍生自的類別中置換此方法`CMFCToolBar`讓使用者無法關閉的工具列物件。

##  <a name="canberestored"></a>  CMFCToolBar::CanBeRestored

判斷是否系統可以還原工具列為其原始狀態後自訂。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>傳回值

如果您可以從應用程式資源; 還原工具列，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以決定是否工具列可以傳回至其原始狀態後自訂。 從應用程式資源載入原始的狀態。

如果`CanBeRestored`會傳回 TRUE，**工具列**頁面的 [自訂] 對話方塊可讓**重設**選取的工具列按鈕。

如果工具列已載入，請將它的原始資源識別碼為非零，則預設實作會傳回 TRUE。 通常，只有使用者定義的工具列，無法還原。

您可以覆寫`CanBeRestored`方法，以自訂此行為在衍生類別。

##  <a name="canfocus"></a>  CMFCToolBar::CanFocus

指定是否可以取得焦點。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法會覆寫基底類別實作中， [CBasePane::CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)，因為工具列物件無法接收焦點。

##  <a name="canhandlesiblings"></a>  CMFCToolBar::CanHandleSiblings

決定是否工具列和其同層級位於相同的窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>傳回值

如果工具列有同層級而工具列和其同層級位於相同的窗格;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

內部 cmfccustomizebutton:: Createpopupmenu 方法會呼叫這個方法，以決定如何顯示**自訂**快顯功能表。 如果這個方法會傳回 TRUE，架構會顯示**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**按鈕。

您通常不需要使用這個方法。 若要啟用**自訂** 按鈕所顯示的工具列上，呼叫[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法。 若要啟用**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**按鈕，請呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="cleanupimages"></a>  CMFCToolBar::CleanUpImages

釋放配置給工具列影像的系統資源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>備註

應用程式關閉時，架構會呼叫這個方法。

##  <a name="cleanuplockedimages"></a>  CMFCToolBar::CleanUpLockedImages

釋放配置的鎖定的工具列影像的系統資源。

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>備註

當您的應用程式的視覺化樣式變更時，請呼叫這個方法。 請參閱 VisualStudioDemo 範例，其中會使用這個方法的範例。

##  <a name="commandtoindex"></a>  CMFCToolBar::CommandToIndex

傳回的按鈕索引，在工具列中，並提供指定的命令識別碼。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>參數

*nIDFind*<br/>
[in]指定命令識別碼。

*iIndexFirst*<br/>
[in]指定要當作起點的起始索引。

### <a name="return-value"></a>傳回值

如果方法成功; 工具列按鈕的以零起始的索引-1，如果沒有任何按鈕，並提供指定的識別碼。

### <a name="remarks"></a>備註

A`CMFCToolBar`物件會維護之工具列上按鈕的內部清單。 呼叫此函式可擷取按鈕指定按鈕的命令 ID 的清單中的索引。

如果*iIndex*大於 0，這個方法會忽略任何具有索引的工具列上的按鈕少於*iIndex*。

##  <a name="create"></a>  CMFCToolBar::Create

建立 `CMFCToolBar` 物件。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pParentWnd*<br/>
[in]工具列的父視窗指標。

*cheaderctrl:: Create*<br/>
[in]工具列的樣式。 請參閱[工具列控制項和按鈕樣式](/windows/desktop/Controls/toolbar-control-and-button-styles)樣式清單的 Windows SDK 中。

*nID*<br/>
[in]子視窗的工具列的識別碼。

### <a name="return-value"></a>傳回值

如果這個方法成功，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會建立一種控制列，並將它附加至工具列。 它會將控制列建立 TBSTYLE_FLAT 樣式。 呼叫[CMFCToolBar::CreateEx](#createex)如果您想要不同的控制項列樣式。

##  <a name="createex"></a>  CMFCToolBar::CreateEx

建立`CMFCToolBar`使用其他樣式選項，例如大型圖示的物件。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pParentWnd*<br/>
[in]工具列的父視窗指標。

*dwCtrlStyle*<br/>
[in]建立內嵌的控制列物件的其他樣式。

*cheaderctrl:: Create*<br/>
[in]工具列的樣式。 請參閱[工具列控制項和按鈕樣式](/windows/desktop/Controls/toolbar-control-and-button-styles)取得一份適當的樣式。

*rcBorders*<br/>
[in]A`CRect`物件，指定工具列視窗框線的寬度。

*nID*<br/>
[in]子視窗的工具列的識別碼。

### <a name="return-value"></a>傳回值

如果這個方法成功，則為非零否則為 0。

### <a name="remarks"></a>備註

這個方法會建立一種控制列，並將它附加至工具列。

呼叫此方法，而非[CMFCToolBar::Create](#create)當在您想要提供特定的樣式。 例如，設定*dwCtrlStyle*至 TBSTYLE_FLAT |若要建立的工具列，類似於所使用的 Internet Explorer 4 工具列 TBSTYLE_TRANSPARENT。

### <a name="example"></a>範例

下列範例示範如何使用`CreateEx`方法的`CMFCToolBar`類別。 此程式碼片段是一部分[IE 示範範例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="deactivate"></a>  CMFCToolBar::Deactivate

停用工具列。

```
virtual void Deactivate();
```

### <a name="remarks"></a>備註

這個方法會藉由將焦點從反白顯示的工具列按鈕，停用工具列。 工具列會失去焦點，或被終結時，架構會呼叫這個方法。

##  <a name="dopaint"></a>  CMFCToolBar::DoPaint

工具列會重新繪製。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容指標。

### <a name="remarks"></a>備註

這個方法是由架構呼叫，必須重新繪製該工具列的一部分時。

覆寫這個方法以自訂物件衍生自外觀`CMFCToolBar`。

##  <a name="drawbutton"></a>  CMFCToolBar::DrawButton

會重新繪製的工具列按鈕。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容指標。

*pButton*<br/>
[in]若要繪製按鈕指標。

*pImages*<br/>
[in]工具列影像的指標。

*bHighlighted*<br/>
[in]如果按鈕已反白顯示;，則為 TRUE。否則為 FALSE。

*bDrawDisabledImages*<br/>
[in]如果停用的按鈕會呈暗灰色，則為 TRUE否則為 FALSE。

### <a name="return-value"></a>傳回值

如果按鈕重新繪製，則為 TRUE如果按鈕處於隱藏狀態，則為 FALSE。

### <a name="remarks"></a>備註

[CMFCToolBar::DrawButton](#drawbutton)方法會呼叫這個方法時必須重新繪製的工具列按鈕。

如果您想要自訂您的工具列上按鈕的外觀，請覆寫這個方法。

##  <a name="drawseparator"></a>  CMFCToolBar::DrawSeparator

在工具列上的分隔符號會重新繪製。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容指標。

*rect*<br/>
[in]週框繪製分隔符號的位置，可像素為單位的位置。

*bHorz*<br/>
[in]如果分隔符號是水平，FALSE 如果分隔符號是垂直的則為 TRUE。

### <a name="remarks"></a>備註

[CMFCToolBar::DoPaint](#dopaint)呼叫這個方法，每個[CMFCToolBar::DrawSeparator](#drawseparator) TBBS_SEPARATOR 樣式，而不是呼叫的物件[CMFCToolBar::DrawButton](#drawbutton)對於按鈕。

衍生自的類別中置換此方法[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)自訂分隔符號 工具列上的外觀。 預設實作會呼叫[CMFCVisualManager::OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)繪製分隔符號，其外觀取決於目前的視覺管理員。

##  <a name="enablecustomizebutton"></a>  Cmfctoolbar:: Enablecustomizebutton

啟用或停用會出現在工具列的 [自訂] 按鈕。

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);


void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]啟用或停用 [自訂] 按鈕。

*iCustomizeCmd*<br/>
[in][自訂] 按鈕的命令識別碼。

*strCustomizeText*<br/>
[in][自訂] 按鈕的文字標籤。

*uiCustomizeTextResId*<br/>
[in]字串的資源識別碼的自訂按鈕的標籤。

*bQuickCustomize*<br/>
[in]啟用或停用**新增或移除按鈕**按鈕從下拉功能表上的選項。

### <a name="remarks"></a>備註

如果*iCustomizeCmd*為-1，[framework] 顯示自訂按鈕時多個工具列按鈕無法放入工具列區域。 按鈕會顯示雙重向左箭號的 > 形箭號，表示有多個按鈕。

如果*iCustomizeCmd*指定有效的命令識別碼，以及*bEnable*是 TRUE 時，[自訂] 按鈕一律會顯示。 按鈕具有小型向下箭號，並開啟一個包含命令功能表。 此命令會使用所指定的文字標籤*strCustomizeText*。 如果*bQuickCustomize*也是如此，功能表會顯示**新增或移除按鈕**選項。

此架構以動態方式加入至功能表無法放入工具列區域所指定的項目之前的任何按鈕*iCustomizeCmd*。 > 形箭號向下箭號旁顯示。

##  <a name="enabledocking"></a>  CMFCToolBar::EnableDocking

可停駐窗格的回主框架。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>參數

*dwAlignment*<br/>
[in]指定要啟用的停駐對齊。

### <a name="remarks"></a>備註

此方法擴充的基底類別實作中， [CBasePane::EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)，藉由設定`CBasePane::m_dwControlBarStyle`AFX_CBRS_FLOAT 資料成員。 此方法接著會傳遞*dwAlignment*基底類別實作。

##  <a name="enablelargeicons"></a>  CMFCToolBar::EnableLargeIcons

啟用或停用工具列按鈕上的大圖示。

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]TRUE 表示啟用大圖示，FALSE 以停用大型圖示。

### <a name="remarks"></a>備註

根據預設，會啟用 大圖示。

##  <a name="enablequickcustomization"></a>  CMFCToolBar::EnableQuickCustomization

啟用或停用快速自訂的工具列，讓使用者可以按**Alt**鍵，並將按鈕拖曳至新位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]若要停用快速自訂 FALSE 啟用快速自訂項目，則為 TRUE。

##  <a name="enablereflections"></a>  CMFCToolBar::EnableReflections

啟用或停用命令的反映。

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]若要啟用命令反映;，則為 TRUE若要停用命令反映，則為 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法，以啟用命令的工具列按鈕的包含內嵌的控制項，例如下拉式方塊的反映。

如需有關命令反映的詳細資訊，請參閱[TN062： 訊息反映的 Windows 控制項](../../mfc/tn062-message-reflection-for-windows-controls.md)。

##  <a name="enabletextlabels"></a>  CMFCToolBar::EnableTextLabels

啟用或停用工具列按鈕影像下方的文字標籤。

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
如果工具列按鈕影像; 下方出現的文字標籤，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如果已啟用文字標籤，在工具列上的所有按鈕會都擴大來提供要顯示影像下方之標籤的空間。 [自訂] 對話方塊中有**顯示文字標籤**上的核取方塊**工具列**頁面。 當使用者選取一個工具列，並檢查此選項時，架構會呼叫`EnableTextLabels`所選的工具列。 您可以停用核取方塊物件衍生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)傳回 FALSE，從[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels) 。

##  <a name="fromhandlepermanent"></a>  CMFCToolBar::FromHandlePermanent

擷取的指標`CMFCToolBar`物件，其中包含指定的視窗控制代碼。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>參數

*hwnd*<br/>
[in]若要尋找的視窗控制代碼。

### <a name="return-value"></a>傳回值

指標`CMFCToolBar`物件，其中包含指定的視窗控制代碼，則為 NULL，如果沒有對應的`CMFCToolBar`物件存在。

### <a name="remarks"></a>備註

此共用的方法會檢查針對應用程式中的每個工具列`CMFCToolBar`物件，其中包含指定的視窗控制代碼。

##  <a name="getallbuttons"></a>  CMFCToolBar::GetAllButtons

在工具列中傳回按鈕的唯讀的清單。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>傳回值

常數參考[CObList 類別](../../mfc/reference/coblist-class.md)物件，其中包含的集合[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件。

##  <a name="getalltoolbars"></a>  CMFCToolBar::GetAllToolbars

在應用程式會傳回所有工具列唯讀清單。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>傳回值

Const 參考[CObList 類別](../../mfc/reference/coblist-class.md)物件，其中包含的集合`CMFCToolBar`物件。

##  <a name="getbasiccommands"></a>  CMFCToolBar::GetBasicCommands

傳回唯讀的應用程式中所定義的基本命令清單。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>傳回值

Const 參考[CList 類別](../../mfc/reference/clist-class.md)物件，其中包含基本命令的集合。

### <a name="remarks"></a>備註

新增基本命令，藉由呼叫[CMFCToolBar::AddBasicCommand](#addbasiccommand)或是[CMFCToolBar::SetBasicCommands](#setbasiccommands)。

##  <a name="getbutton"></a>  CMFCToolBar::GetButton

將指標傳回至[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)指定索引處的物件。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[in]指定的按鈕，以傳回的索引。

### <a name="return-value"></a>傳回值

指向工具列按鈕，如果有的話，或者，如果沒有這類的按鈕則為 NULL。

##  <a name="getbuttoninfo"></a>  CMFCToolBar::GetButtonInfo

傳回命令 ID、 樣式和指定的索引處的按鈕影像索引。

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]在工具列上的按鈕清單中指定的按鈕索引。

*nID*<br/>
[out]按鈕的命令 ID。

*nStyle*<br/>
[out]按鈕的樣式。

*iImage*<br/>
[out]按鈕的影像索引。

### <a name="remarks"></a>備註

`GetButtonInfo`方法找到的指定索引處的工具列按鈕，並擷取按鈕的命令識別碼、 樣式和影像索引。

如果按鈕，以便在指定的索引不存在，架構就會設定*nID*並*nStyle*設為 0，和*iImage*方法傳回時為-1。

##  <a name="getbuttonsize"></a>  CMFCToolBar::GetButtonSize

在工具列上，傳回每個按鈕的大小。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

A [CSize 類別](../../atl-mfc-shared/reference/csize-class.md)物件，指定在工具列上的每個按鈕的大小。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetSizes](#setsizes)或是[CMFCToolBar::SetLockedSizes](#setlockedsizes)設定工具列上的每個按鈕的大小。

##  <a name="getbuttonstyle"></a>  CMFCToolBar::GetButtonStyle

傳回目前位於指定索引處的工具列按鈕的樣式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

值，指定工具列按鈕的樣式。 。 請參閱[ToolBar 控制項樣式](../../mfc/reference/toolbar-control-styles.md)可能樣式的清單。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetButtonStyle](#setbuttonstyle)設定工具列按鈕的樣式

##  <a name="getbuttontext"></a>  CMFCToolBar::GetButtonText

傳回具有指定的索引的按鈕的文字標籤。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]工具列按鈕的索引。

*rString*<br/>
[out]工具列按鈕的標籤文字。

### <a name="return-value"></a>傳回值

工具列按鈕的標籤文字。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetButtonText](#setbuttontext)或是[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)設定的文字標籤。

##  <a name="getcoldimages"></a>  CMFCToolBar::GetColdImages

讓指標回到應用程式中的非作用中工具列按鈕影像的集合。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>傳回值

指標，非作用中工具列按鈕影像的集合。

### <a name="remarks"></a>備註

冷映像是指在使用者未與工具列按鈕互動時所使用。 呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或是[CMFCToolBar::LoadBitmap](#loadbitmap)載入原始的映像。

##  <a name="getcolumnwidth"></a>  CMFCToolBar::GetColumnWidth

傳回的工具列按鈕的寬度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>傳回值

值，指定工具列按鈕的寬度。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以計算工具列版面配置。 衍生的類別，以指定不同的資料行寬度為您的工具列中，這個方法會覆寫。

##  <a name="getcommandbuttons"></a>  CMFCToolBar::GetCommandButtons

傳回一份應用程式中有指定的命令 ID，從所有的工具列按鈕。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]按鈕的命令識別碼。

*listButtons*<br/>
[out]參考[CObList 類別](../../mfc/reference/coblist-class.md)接收的工具列按鈕清單物件。

### <a name="return-value"></a>傳回值

具有指定的命令識別碼的按鈕數目

##  <a name="getcount"></a>  CMFCToolBar::GetCount

傳回在工具列上的按鈕和分隔符號數目。

```
int GetCount() const;
```

### <a name="return-value"></a>傳回值

按鈕和工具列上的分隔符號數目。

##  <a name="getcustomizebutton"></a>  CMFCToolBar::GetCustomizeButton

擷取的指標`CMFCCustomizeButton`與工具列相關聯的物件。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>傳回值

指標`CMFCCustomizeButton`與工具列相關聯的物件。

### <a name="remarks"></a>備註

這個方法會擷取**自訂**出現結尾的工具列按鈕。 使用[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法來加入**自訂**加入工具列按鈕。

您可以呼叫[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)方法，以判斷工具列是否包含有效`CMFCCustomizeButton`物件。

##  <a name="getdefaultimage"></a>  CMFCToolBar::GetDefaultImage

傳回具有指定之命令識別碼的工具列按鈕的預設影像的索引

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>參數

*uiID*<br/>
[in]指定按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

共用映像清單中工具列影像的索引。

### <a name="remarks"></a>備註

使用此共用的方法來擷取具有指定之命令識別碼的工具列按鈕的預設影像的索引 傳回值是共用的應用程式中的所有工具列的工具列按鈕影像集合索引。 呼叫[CMFCToolBar::GetImages](#getimages)方法，以取得此集合的指標。

##  <a name="getdisabledimages"></a>  CMFCToolBar::GetDisabledImages

映像所使用的應用程式中的已停用的工具列按鈕集合中傳回的指標。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>傳回值

指標，已停用的工具列按鈕影像的集合。

### <a name="remarks"></a>備註

使用載入已停用的工具列按鈕影像[CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)並[CMFCToolBar::LoadBitmap](#loadbitmap)方法。

##  <a name="getdisabledmenuimages"></a>  CMFCToolBar::GetDisabledMenuImages

讓指標回到應用程式中的已停用的功能表按鈕所使用的映像集合。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>傳回值

指標，已停用的功能表影像的集合。

### <a name="remarks"></a>備註

使用載入已停用的映像[CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法。

##  <a name="getdroppeddownmenu"></a>  CMFCToolBar::GetDroppedDownMenu

擷取目前顯示子功能表的功能表按鈕物件的指標。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>參數

*pIndex*<br/>
[out]接收的按鈕索引集合中的工具列按鈕。

### <a name="return-value"></a>傳回值

如果沒有功能表會顯示子功能表及其子功能表或 NULL 顯示功能表按鈕物件的指標。

### <a name="remarks"></a>備註

如果這個方法會傳回非 NULL 值和*pIndex*不是 NULL，此值所指向*pIndex*設為 [功能表] 按鈕的工具列按鈕集合中的索引。

##  <a name="getgraydisabledbuttons"></a>  CMFCToolBar::GetGrayDisabledButtons

指定是否已停用按鈕的影像會呈現暗灰色的版本，標準按鈕的影像，或從 已停用的按鈕影像的集合。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>傳回值

變暗的停用的按鈕; 映像的方法，則為 TRUE取得集合中的 已停用的映像的映像，則為 FALSE。

### <a name="remarks"></a>備註

使用[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)呈現暗灰色的映像和集合中的 已停用的映像的映像之間切換。

##  <a name="gethighlightedbutton"></a>  CMFCToolBar::GetHighlightedButton

讓指標回到目前反白顯示的工具列按鈕。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>傳回值

指向工具列按鈕物件;或者，如果沒有 按鈕會反白顯示則為 NULL。

### <a name="remarks"></a>備註

如果具有鍵盤焦點時，會反白顯示的工具列按鈕。 如果工具列按鈕的熱追蹤此應用程式中的工具列按鈕會也會反白顯示 (如需詳細資訊，請參閱 < [CMFCToolBar::GetHotBorder](#gethotborder)並[CMFCToolBar::SetHotBorder](#sethotborder)) 和滑鼠指著它，任何的工具列按鈕或功能表項目不有鍵盤焦點時。

##  <a name="gethotborder"></a>  CMFCToolBar::GetHotBorder

判斷工具列按鈕是否*熱追蹤*。 如果按鈕是熱追蹤，其反白顯示，當滑鼠移過它。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕的熱追蹤;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

根據預設，工具列按鈕會是熱追蹤。

##  <a name="gethottextcolor"></a>  CMFCToolBar::GetHotTextColor

傳回文字的色彩反白顯示的工具列按鈕。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>傳回值

A [COLORREF](/windows/desktop/gdi/colorref)代表目前反白顯示的文字色彩的值。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetHotTextColor](#sethottextcolor)設定新的文字色彩反白顯示的工具列按鈕。

##  <a name="gethwndlastfocus"></a>  CMFCToolBar::GetHwndLastFocus

傳回具有輸入的焦點，工具列沒有之前的視窗控制代碼。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>傳回值

不衍生自的視窗控制代碼[CMFCBaseToolBar 類別](../../mfc/reference/cmfcbasetoolbar-class.md)，其先前的輸入焦點; 或如果沒有這類的時段，則為 NULL。

### <a name="remarks"></a>備註

當`CMFCToolBar`控制項收到輸入的焦點，其中存放了遺失焦點，好讓它可以在稍後還原視窗的控制代碼。

##  <a name="getignoresettext"></a>  CMFCToolBar::GetIgnoreSetText

指定是否忽略呼叫設定按鈕的標籤。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>傳回值

如果呼叫設定按鈕的標籤都會被忽略;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="getimages"></a>  CMFCToolBar::GetImages

讓指標回到預設集合 按鈕影像的應用程式中。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>傳回值

指標[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)物件，其中包含所有的工具列，應用程式中的預設映像的集合。

### <a name="remarks"></a>備註

此共用的方法提供應用程式的所有預設集合存取工具列映像。 呼叫[CMFCToolBar::LoadBitmap](#loadbitmap)將影像新增至集合的方法。

##  <a name="getimagesize"></a>  CMFCToolBar::GetImageSize

傳回目前的工具列按鈕影像的大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>傳回值

A [CSize 類別](../../atl-mfc-shared/reference/csize-class.md)物件，表示目前的工具列按鈕影像的大小。

##  <a name="getimagesoffset"></a>  CMFCToolBar::GetImagesOffset

傳回用來尋找此工具列，工具列按鈕影像的全域清單中的工具列按鈕影像的索引位移。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>傳回值

工具列影像索引位移。

### <a name="remarks"></a>備註

所有工具列預設影像會都儲存在全域[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)清單。 在工具列中的每個按鈕的映像會連續儲存在該清單。 若要計算之影像的索引，加入在工具列的按鈕索引，這個工具列按鈕的映像清單開頭的位移。

呼叫[CMFCToolBar::ButtonToIndex](#buttontoindex)取得工具列按鈕的按鈕中指定指標的索引。

呼叫[CMFCToolBar::GetImages](#getimages)來取得變數的指標，工具列影像的集合。

##  <a name="getinvalidateitemrect"></a>  CMFCToolBar::GetInvalidateItemRect

擷取工作區，必須指定索引處的按鈕重新繪製的區域。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]要擷取工作區] 按鈕的索引。

*lpRect*<br/>
[out]接收用戶端區域的區域的矩形物件的指標。

### <a name="remarks"></a>備註

*LpRect*參數不得為 NULL。 如果沒有按鈕位於提供的索引*lpRect*接收 RECT 物件初始化為零。

##  <a name="getitemid"></a>  CMFCToolBar::GetItemID

傳回指定索引處的工具列按鈕的命令識別碼。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

命令 ID 的工具列按鈕，或者，如果不存在具有指定索引的按鈕則為零。

##  <a name="getitemrect"></a>  CMFCToolBar::GetItemRect

傳回指定索引處的按鈕的週框矩形。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]指定工具列按鈕的索引。

*lpRect*<br/>
[out]指標`CRect`接收影像週框矩形的座標的物件。

### <a name="remarks"></a>備註

`CRect`物件*lpRect*點設定為 0，如果沒有指定索引處的按鈕。

### <a name="example"></a>範例

下列範例示範如何使用`GetItemRect`方法的`CMFCToolBar`類別。 此程式碼片段是一部分[IE 示範範例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

##  <a name="getlargecoldimages"></a>  CMFCToolBar::GetLargeColdImages

讓指標回到應用程式中的大型非作用中工具列按鈕影像的集合。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>傳回值

指標，大型冷的映像集合。

### <a name="remarks"></a>備註

冷映像是指在使用者未與工具列按鈕互動時所使用。 呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)載入大型冷的映像。

##  <a name="getlargedisabledimages"></a>  CMFCToolBar::GetLargeDisabledImages

讓指標回到應用程式中的大型的已停用的工具列按鈕影像的集合。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>傳回值

指向的大型集合的停用工具列按鈕影像。

### <a name="remarks"></a>備註

大型影像是大型的規則 工具列按鈕影像的版本。 呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或是[CMFCToolBar::LoadBitmap](#loadbitmap)載入大型映像。

##  <a name="getlargeimages"></a>  CMFCToolBar::GetLargeImages

讓指標回到應用程式中的大型的工具列按鈕影像的集合。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>傳回值

指標，大型的工具列按鈕影像的集合。

### <a name="remarks"></a>備註

大型影像是大型的規則 工具列按鈕影像的版本。 呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)載入大型映像。

##  <a name="getlockedcoldimages"></a>  CMFCToolBar::GetLockedColdImages

在工具列上的鎖定冷映像的集合中傳回的指標。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>傳回值

集合鎖定冷的映像或如果未鎖定工具列為 NULL 指標。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時，架構會使用一般的工具列按鈕影像的版本。 冷映像是指在使用者未與工具列按鈕互動時所使用。

如果未鎖定工具列，這個方法會傳回 NULL。 如果未鎖定工具列，這個方法會將判斷提示失敗也產生偵錯組建中。 如需有關鎖定工具列的詳細資訊，請參閱[CMFCToolBar::IsLocked](#islocked)。

呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法來載入已鎖定的冷映像。

##  <a name="getlockeddisabledimages"></a>  CMFCToolBar::GetLockedDisabledImages

在工具列上的鎖定已停用映像的集合中傳回的指標。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>傳回值

集合的鎖定已停用的映像或如果未鎖定工具列為 NULL 指標。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時，架構會使用一般的工具列按鈕影像的版本。 已停用的映像為 TBBS_DISABLED 樣式按鈕時，架構會使用的映像。

如果未鎖定工具列，這個方法會傳回 NULL。 如果未鎖定工具列，這個方法會將判斷提示失敗也產生偵錯組建中。 如需有關鎖定工具列的詳細資訊，請參閱[CMFCToolBar::IsLocked](#islocked)。

呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法來載入鎖定已停用的映像。

##  <a name="getlockedimages"></a>  CMFCToolBar::GetLockedImages

在工具列上的鎖定的按鈕影像的集合中傳回的指標。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>傳回值

集合已鎖定的工具列按鈕影像或如果未鎖定工具列為 NULL 指標。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時，架構會使用一般的工具列按鈕影像的版本。

如果未鎖定工具列，這個方法會傳回 NULL。 如果未鎖定工具列，這個方法會將判斷提示失敗也產生偵錯組建中。 如需有關鎖定工具列的詳細資訊，請參閱[CMFCToolBar::IsLocked](#islocked)。

##  <a name="getlockedimagesize"></a>  CMFCToolBar::GetLockedImageSize

傳回已鎖定的工具列影像的預設大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>傳回值

A`CSize`結構，指定鎖定的工具列影像或空的大小`CSize`結構，如果未鎖定工具列。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時，架構會使用一般的工具列按鈕影像的版本。

這個方法會傳回`CSize`結構使用零寬度和高度為零，如果未鎖定工具列。 如果未鎖定工具列，這個方法會將判斷提示失敗也產生偵錯組建中。 如需有關鎖定工具列的詳細資訊，請參閱[CMFCToolBar::IsLocked](#islocked)。

呼叫[CMFCToolBar::SetLockedSizes](#setlockedsizes)方法，以指定鎖定的影像大小。

##  <a name="getlockedmenuimages"></a>  CMFCToolBar::GetLockedMenuImages

讓指標回到集合已鎖定工具列的功能表影像的工具列中。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>傳回值

集合的鎖定的工具列功能表影像或如果未鎖定工具列為 NULL 指標。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時，架構會使用一般的工具列功能表影像的版本。

如果未鎖定工具列，這個方法會傳回 NULL。 如果未鎖定工具列，這個方法會將判斷提示失敗也產生偵錯組建中。 如需有關鎖定工具列的詳細資訊，請參閱[CMFCToolBar::IsLocked](#islocked)。

呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法來載入已鎖定的功能表影像。

##  <a name="getmenubuttonsize"></a>  CMFCToolBar::GetMenuButtonSize

傳回應用程式中的功能表按鈕的大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>傳回值

A`CSize`物件，表示功能表按鈕，像素為單位的大小。

### <a name="remarks"></a>備註

在工具列上的功能表按鈕的大小會維護為全域變數，並可以擷取由這個靜態方法。

呼叫[CMFCToolBar::SetMenuSizes](#setmenusizes)來設定這個全域變數。

##  <a name="getmenuimages"></a>  CMFCToolBar::GetMenuImages

讓指標回到應用程式中的功能表按鈕影像的集合。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>傳回值

指向的功能表影像的集合。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法來載入功能表影像。

呼叫[CMFCToolBar::SetMenuSizes](#setmenusizes)方法來設定按鈕和其映像的大小。

##  <a name="getmenuimagesize"></a>  CMFCToolBar::GetMenuImageSize

傳回應用程式中的功能表按鈕影像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>傳回值

A`CSize`物件，表示功能表影像的大小。

### <a name="remarks"></a>備註

這個方法會傳回影像的大小，會維護為全域變數的工具列功能表按鈕上。 呼叫[CMFCToolBar::SetMenuSizes](#setmenusizes)來設定這個全域變數。

##  <a name="getorigbuttons"></a>  CMFCToolBar::GetOrigButtons

擷取的非自訂化的按鈕，工具列的集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>傳回值

參考的非自訂化的按鈕，工具列的清單。

### <a name="remarks"></a>備註

它們由使用者自訂之前，架構就會建立一份工具列按鈕。 [CMFCToolBar::SetButtons](#setbuttons)方法會將每個按鈕的複本中提供的陣列加入原始的按鈕的清單。 [CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)方法還原從資源檔載入工具列的原始狀態。

若要設定的原始程式的工具列按鈕清單，請呼叫[CMFCToolBar::SetOrigButtons](#setorigbuttons)方法。

##  <a name="getorigresetbuttons"></a>  CMFCToolBar::GetOrigResetButtons

擷取的非自訂的重設按鈕，工具列的集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>傳回值

參考的非自訂清單重設工具列的按鈕。

### <a name="remarks"></a>備註

當使用者按一下**重設**按鈕在自訂模式下，架構會使用這個方法來還原已移除從工具列的按鈕。

[CMFCToolBar::SetButtons](#setbuttons)方法會將原始的重設按鈕的清單加入每個工具列按鈕的複本之後它會呼叫[CMFCToolBar::OnReset](#onreset)方法。 您可以覆寫[CMFCToolBar::OnReset](#onreset)方法，以自訂按鈕的外觀之後使用者按下,**重設** 按鈕。

##  <a name="getresourceid"></a>  CMFCToolBar::GetResourceID

擷取工具列的資源識別碼。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>傳回值

在工具列的資源識別碼。

### <a name="remarks"></a>備註

呼叫[cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)方法來設定工具列的資源識別碼。

##  <a name="getroutecommandsviaframe"></a>  CMFCToolBar::GetRouteCommandsViaFrame

決定哪些物件、 父框架或擁有者，將命令傳送至工具列。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>傳回值

非零值，如果父框架的命令傳送至工具列，0，表示擁有者會將命令傳送至工具列。

### <a name="remarks"></a>備註

根據預設，父框架會將命令傳送至工具列。 呼叫[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)來變更此行為。

如果此方法會傳回非零值，您可以使用擷取父框架物件的指標`CMFCToolBar::GetCommandTarget`方法。 請參閱 VisualStudioDemo 範例，其中會使用這個方法的範例。

##  <a name="getrowheight"></a>  CMFCToolBar::GetRowHeight

傳回的工具列按鈕的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕，單位為像素的高度。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以計算工具列版面配置。 在衍生的類別，以指定不同的高度，工具列中，這個方法會覆寫。

##  <a name="getshowtooltips"></a>  CMFCToolBar::GetShowTooltips

指定工具列按鈕是否顯示工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>傳回值

如果工具列按鈕; 會顯示工具提示，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

根據預設會顯示工具提示。 您可以藉由呼叫來變更此靜態的旗標[CMFCToolBar::SetShowTooltips](#setshowtooltips)。

##  <a name="getsiblingtoolbar"></a>  CMFCToolBar::GetSiblingToolBar

擷取工具列的同層級。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>傳回值

同層級工具列指標。

### <a name="remarks"></a>備註

如需有關如何啟用**在一個資料列上顯示按鈕**並**在兩個資料列上顯示按鈕**按鈕，請參閱[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="getuserimages"></a>  CMFCToolBar::GetUserImages

讓指標回到應用程式中的使用者定義工具列按鈕影像的集合。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>傳回值

指標，應用程式中的所有工具列的使用者定義工具列按鈕影像的集合。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetUserImages](#setuserimages)方法來設定應用程式中的使用者定義的映像集合。

##  <a name="hittest"></a>  CMFCToolBar::HitTest

傳回位於指定位置處的工具列按鈕的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[in]要測試，在工作區座標的點。

### <a name="return-value"></a>傳回值

位於指定的位置，則為-1 如果沒有任何這類的按鈕的按鈕索引為分隔符號。

##  <a name="insertbutton"></a>  CMFCToolBar::InsertButton

插入工具列按鈕。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);


virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>參數

*按鈕*<br/>
[in]指定要插入的按鈕。

*iInsertAt*<br/>
[in]指定要插入的按鈕上方的以零為起始的位置。

### <a name="return-value"></a>傳回值

位置處插入按鈕，或-1，如果錯誤發生。

### <a name="remarks"></a>備註

如果*iInsertAt*為-1，這個方法會將按鈕加入至工具列按鈕清單的結尾。

呼叫[CMFCToolBar::InsertSeparator](#insertseparator)方法來插入工具列中的分隔符號。

##  <a name="insertseparator"></a>  CMFCToolBar::InsertSeparator

插入工具列中的分隔符號。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>參數

*iInsertAt*<br/>
[in]指定要插入的分隔符號，在以零為起始的位置。 這個參數必須是大於 0。

### <a name="return-value"></a>傳回值

位置處插入分隔符號或-1，如果錯誤發生。

### <a name="remarks"></a>備註

呼叫這個方法來插入兩個現有的按鈕之間的分隔符號。 如果*iInsertAt*為-1，這個方法加入至工具列按鈕清單結尾的分隔符號。

您無法使用這個方法，加入空白的工具列中的分隔符號。

呼叫[CMFCToolBar::InsertButton](#insertbutton)来插入工具列按鈕的方法。

##  <a name="invalidatebutton"></a>  CMFCToolBar::InvalidateButton

失效的工具列按鈕，在提供的索引存在工作的區。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]工具列中的按鈕之以零起始的索引。

### <a name="return-value"></a>傳回值

指標`CMFCToolBarButton`物件，如果物件不存在，位於提供的索引或 NULL。

### <a name="remarks"></a>備註

更新工作區的工具列按鈕與相關聯時，架構會呼叫這個方法。 它會呼叫[CWnd::InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect)方法的用戶端矩形`CMFCToolBarButton`物件，位於提供的索引。

##  <a name="isaddremovequickcustomize"></a>  CMFCToolBar::IsAddRemoveQuickCustomize

判斷使用者是否可以新增或移除工具列按鈕，使用**自訂**功能表選項。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>傳回值

如果使用者可以使用，則為 TRUE**自訂** 功能表選項，修改工具列，否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isaltcustomizemode"></a>  CMFCToolBar::IsAltCustomizeMode

指定是否*快速自訂*正將按鈕拖曳。 啟用快速自訂時，使用者可以按下並按住 Alt 鍵和按鈕拖曳至新位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果正在拖曳的按鈕，使用快速的自訂，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isautograyinactiveimages"></a>  CMFCToolBar::IsAutoGrayInactiveImages

指定是否啟用自動產生的非作用中 （非醒目提示） 的按鈕影像。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>傳回值

如果已啟用自動變暗非作用中的映像的選項，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

您可以啟用或停用自動變暗的非作用中的映像藉由呼叫[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)。

##  <a name="isbasiccommand"></a>  CMFCToolBar::IsBasicCommand

判斷命令是否在清單中的基本命令。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果指定的命令所屬的基本命令; 清單，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個靜態方法會判斷命令是否已由*uiCmd*屬於基本命令的全域清單。 您可以變更的基本命令清單，藉由呼叫[CMFCToolBar::AddBasicCommand](#addbasiccommand)或是[CMFCToolBar::SetBasicCommands](#setbasiccommands)。

##  <a name="isbuttonextrasizeavailable"></a>  CMFCToolBar::IsButtonExtraSizeAvailable

判斷工具列是否可以顯示擴充框線的按鈕。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>傳回值

如果列可以顯示額外的框線大小; 按鈕，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如果網域控制站可以顯示按鈕具有延伸框線工具列物件傳回 TRUE。 工具列按鈕會呼叫這個方法，當它處理[CMFCToolBarButton::OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知並據以設定其內部的額外框線大小旗標。 此內部的旗標可能會稍後再擷取藉由呼叫[CMFCToolBarButton::IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)。

衍生自的類別中置換此方法`CMFCToolBar`而傳回 TRUE，如果您的列可以顯示額外的框線大小的工具列按鈕和否則傳回 FALSE。 預設實作會傳回 TRUE。

##  <a name="isbuttonhighlighted"></a>  CMFCToolBar::IsButtonHighlighted

判斷指定的按鈕會反白顯示。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>參數

*iButton*<br/>
[in]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

如果指定的按鈕會反白顯示;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="iscommandpermitted"></a>  CMFCToolBar::IsCommandPermitted

決定是否要允許的命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果允許指定的命令;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個靜態方法會判斷命令是否已由*uiCmd*屬於非允許命令的全域清單。

您可以變更非允許命令的清單，藉由呼叫[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)。

##  <a name="iscommandrarelyused"></a>  CMFCToolBar::IsCommandRarelyUsed

決定是否很少使用的命令。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果指定的命令很少使用，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

`IsCommandRarelyUsed`方法會傳回 FALSE，當一或多個下列情況發生：

- 指定的命令所屬的基本命令清單

- 指定的命令是其中一個標準命令

- 架構已自訂模式

- 基本命令的清單是空的

- 超過 20%的命令呼叫會呼叫指定的命令。

##  <a name="iscustomizemode"></a>  CMFCToolBar::IsCustomizeMode

指定工具列 framework 是否為自訂模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果架構是在自訂模式; 中，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

您可以切換自訂模式，藉由呼叫[CMFCToolBar::SetCustomizeMode](#setcustomizemode)。

架構變更的模式，當使用者叫用 [自訂] 對話方塊中 ( [CMFCToolBarsCustomizeDialog 類別](../../mfc/reference/cmfctoolbarscustomizedialog-class.md))。

##  <a name="isdragbutton"></a>  CMFCToolBar::IsDragButton

決定是否被拖曳的工具列按鈕。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]在工具列按鈕的指標。

### <a name="return-value"></a>傳回值

如果指定的按鈕拖曳至;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isexistcustomizebutton"></a>  CMFCToolBar::IsExistCustomizeButton

判斷是否要包含工具列**自訂** 按鈕。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>傳回值

如果工具列包含，則為 TRUE**自訂** 按鈕，否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳回 TRUE，如果[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)方法傳回的指標**自訂**出現結尾的工具列按鈕。

使用[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法來加入**自訂**加入工具列按鈕。

##  <a name="isfloating"></a>  CMFCToolBar::IsFloating

決定是否浮動工具列。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>傳回值

如果浮動工具列;，則為 TRUE。否則為 FALSE。

##  <a name="islargeicons"></a>  CMFCToolBar::IsLargeIcons

指定是否在應用程式中的工具列目前顯示大型圖示。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>傳回值

如果應用程式使用大圖示;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetLargeIcons](#setlargeicons)來切換 大圖示和規則的圖示。

架構會自動變更模式，當使用者切換**大圖示**上的核取方塊**選項**頁面**自訂** 對話方塊。

##  <a name="islastcommandfrombutton"></a>  CMFCToolBar::IsLastCommandFromButton

判斷最近執行已傳送命令，從指定的工具列按鈕。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]按鈕的指標。

### <a name="return-value"></a>傳回值

如果最後一個命令從按鈕傳送，則為 TRUE， *pButton*指定; 否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會取得的指標[MSG 結構](../../mfc/reference/msg-structure1.md)藉由呼叫`CWnd::GetCurrentMessage`。 然後它會比較具有按鈕的 HWND`MSG::lParam`和`MSG::hwnd`成員以判斷是否在按鈕原先的命令來源。

##  <a name="islocked"></a>  CMFCToolBar::IsLocked

決定是否要鎖定工具列。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>傳回值

如果已鎖定工具列，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

當使用者無法執行自訂工作，例如重新定位的工具列按鈕時，這個方法會傳回 TRUE。

鎖定的工具列會使用個別的映像清單。 如需有關這些映像清單的詳細資訊，請參閱 < [CMFCToolBar::LoadBitmapEx](#loadbitmapex)。

##  <a name="isonerowwithsibling"></a>  Cmfctoolbar:: Isonerowwithsibling

決定是否工具列和工具列，其同層級位於相同的資料列。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>傳回值

如果工具列和其同層級位於相同的資料列，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

[Cmfccustomizebutton:: Createpopupmenu](internal-classes.md)方法會呼叫這個方法，以決定如何顯示**自訂**快顯功能表。 如果這個方法會傳回 TRUE，架構會顯示**在一個資料列上顯示按鈕** 按鈕。 否則，架構會顯示**在兩個資料列上顯示按鈕** 按鈕。

您通常不需要使用這個方法。 若要啟用**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**按鈕，請呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)。

##  <a name="isresourcechanged"></a>  CMFCToolBar::IsResourceChanged


```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="issibling"></a>  CMFCToolBar::IsSibling


```
BOOL IsSibling();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isuserdefined"></a>  CMFCToolBar::IsUserDefined

指定工具列是否為使用者定義。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>傳回值

如果使用者; 所建立的工具列，則為 TRUE。否則為 FALSE。

##  <a name="loadbitmap"></a>  CMFCToolBar::LoadBitmap

從應用程式資源載入工具列影像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[in]參考作用中工具列影像之點陣圖的資源識別碼。

*uiColdResID*<br/>
[in]參考非作用中工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
[in]參考標準功能表影像之點陣圖的資源識別碼。

*封鎖*<br/>
[in]True 表示要鎖定工具列，否則為 FALSE。

*uiDisabledResID*<br/>
[in]參考已停用的工具列影像之點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
[in]參考已停用的功能表影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

[Cmfctoolbar:: Loadtoolbarex](#loadtoolbarex)方法會呼叫這個方法來載入與工具列相關聯的映像。 覆寫這個方法可執行影像資源的自訂載入。

呼叫 `LoadBitmapEx` 方法可在建立工具列之後載入其他影像。

##  <a name="loadbitmapex"></a>  CMFCToolBar::LoadBitmapEx


```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>參數

*params*<br/>
[in][in]*封鎖*

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="loadlargeiconsstate"></a>  CMFCToolBar::LoadLargeIconsState


```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[in]*lpszProfileName*

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="loadparameters"></a>  CMFCToolBar::LoadParameters

從 Windows 登錄載入全域工具列上的選項。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
[in]指定的 Windows 登錄機碼的相對路徑。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

這個方法會載入功能表動畫類型、 功能表的陰影樣式，以及是否要顯示大圖示，從 Windows 登錄等全域參數。

[CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法會呼叫這個方法的應用程式的初始化處理程序的一部分。

##  <a name="loadstate"></a>  CMFCToolBar::LoadState

從 Windows 登錄載入工具列狀態資訊。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
[in]指定的 Windows 登錄機碼的相對路徑。

*nIndex*<br/>
[in]指定工具列的控制項 ID。

*uiID*<br/>
[in]指定工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會呼叫這個方法的應用程式的初始化處理程序的一部分。 如需詳細資訊，請參閱 < [CWinAppEx::LoadState](../../mfc/reference/cwinappex-class.md#loadstate)。

##  <a name="loadtoolbar"></a>  CMFCToolBar::LoadToolBar

從應用程式資源載入工具列。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[in]在工具列的資源識別碼。

*uiColdResID*<br/>
[in]參考非作用中工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
[in]參考標準功能表影像之點陣圖的資源識別碼。

*封鎖*<br/>
[in]布林值，指定與否，是否要鎖定工具列。 如果這個參數是 *，則為 TRUE*，工具列已被鎖定。 否則工具列不會鎖定。

*uiDisabledResID*<br/>
[in]參考已停用的工具列影像之點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
[in]參考已停用的功能表影像之點陣圖的資源識別碼。

*uiHotResID*<br/>
[in]參考作用中工具列影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

載入與工具列相關聯的映像的初始化期間，架構會呼叫這個方法。

### <a name="example"></a>範例

下列範例示範如何使用`LoadToolBar`方法中的`CMFCToolBar`類別。 此程式碼片段是一部分[IE 示範範例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="loadtoolbarex"></a>  Cmfctoolbar:: Loadtoolbarex

使用從應用程式資源載入工具列`CMFCToolBarInfo`helper 類別，可讓應用程式使用大型映像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>參數

*uiToolbarResID*<br/>
[in]在工具列的資源識別碼。

*params*<br/>
[in]參考`CMFCToolBarInfo`物件，其中包含工具列影像的資源識別碼。

*封鎖*<br/>
[in]布林值，指定與否，是否要鎖定工具列。 如果此參數為 TRUE，則會鎖定工具列。 否則工具列不會鎖定。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

呼叫這個方法，以從應用程式資源載入工具列影像。

##  <a name="m_dbllargeimageratio"></a>  CMFCToolBar::m_dblLargeImageRatio

指定大型影像的維度 （高度或寬度） 和一般映像的維度之間的比例。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>備註

預設的比例為 2。 您可以變更此值可讓大型工具列映像，放大或縮小。

當您未指定一組大型映像時，架構會使用此資料成員。 比方說，如果您提供只有一組小型影像大小為 16 x 16，而且想要有大小 24 x 24 的大型影像，請設定此資料成員為 1.5。

##  <a name="nextmenu"></a>  CMFCToolBar::NextMenu


```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onbeforeremovebutton"></a>  CMFCToolBar::OnBeforeRemoveButton


```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]未使用。

*dropEffect*<br/>
[in]未使用。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onchangehot"></a>  CMFCToolBar::OnChangeHot

當使用者選取工具列上的按鈕時由架構呼叫。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>參數

*iHot*<br/>
[in]指定的工具列按鈕，則索引或如果沒有 [工具列] 按鈕已選取為-1。

### <a name="remarks"></a>備註

覆寫這個方法，以處理通知使用者已選取工具列上的按鈕。

##  <a name="onchangevisualmanager"></a>  CMFCToolBar::OnChangeVisualManager


```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>備註

##  <a name="onfillbackground"></a>  CMFCToolBar::OnFillBackground

由架構呼叫[CBasePane::DoPaint](../../mfc/reference/cbasepane-class.md#dopaint)工具列背景填滿。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容指標。

### <a name="remarks"></a>備註

[CMFCToolBar::DoPaint](#dopaint)已填入的工具列背景時呼叫這個方法。 預設實作不做任何動作。

覆寫這個方法在衍生類別中繪製自訂背景。

##  <a name="onglobalfontschanged"></a>  CMFCToolBar::OnGlobalFontsChanged


```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>備註

##  <a name="onreset"></a>  CMFCToolBar::OnReset

還原為其原始狀態的工具列。

```
virtual void OnReset();
```

### <a name="remarks"></a>備註

覆寫此方法以處理工具列重設的相關通知。

預設實作不做任何動作。 覆寫`OnReset`類別衍生自中`CMFCToolBar`當工具列有工具列回到其原始狀態時，必須被取代的 dummy 按鈕。

##  <a name="onsetaccdata"></a>  CMFCToolBar::OnSetAccData


```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>參數

[in]*lVal*

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onsetdefaultbuttontext"></a>  CMFCToolBar::OnSetDefaultButtonText

還原成預設狀態的工具列按鈕的文字。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]指向要設定其文字的按鈕。

### <a name="return-value"></a>傳回值

已成功還原，則為 TRUE 的 ifthe 文字;否則為 FALSE。

### <a name="remarks"></a>備註

覆寫這個方法，以處理通知的工具列按鈕的文字會變成其預設值。

預設實作會從應用程式資源載入按鈕的文字。

##  <a name="onusertooltip"></a>  CMFCToolBar::OnUserToolTip

按鈕的工具提示即將顯示時由架構呼叫。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]指向要顯示工具提示的工具列按鈕。

*strTTText*<br/>
[out]參考`CString`接收的工具提示文字的物件。

### <a name="return-value"></a>傳回值

則為 TRUE *strTTText*已填入之工具提示文字，否則為 FALSE。

### <a name="remarks"></a>備註

要顯示的工具列按鈕的工具提示時，架構會呼叫這個方法。 如果`OnUserToolTip`傳回 TRUE，架構會顯示工具提示，其中包含所傳回的文字`OnUserToolTip`中*strTTText*。 否則，工具提示會包含按鈕的文字。

覆寫`OnUserToolTip`自訂工具列按鈕的工具提示。 預設實作會呼叫[CMFCToolBar::OnUserToolTip](#onusertooltip)取得的工具提示文字。

##  <a name="prevmenu"></a>  CMFCToolBar::PrevMenu


```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="processcommand"></a>  CMFCToolBar::ProcessCommand

WM_COMMAND 訊息張貼至主控視窗的工具列。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[in]在工具列上按鈕的指標。

### <a name="return-value"></a>傳回值

這個方法應該一律會傳回 TRUE。 MFC 會在內部使用，則為 FALSE 的值。

### <a name="remarks"></a>備註

這個方法將 WM_COMMAND 訊息發佈至主控視窗的工具列藉由呼叫[CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage)並傳遞做為指定的按鈕的命令識別碼*wParam*參數。

使用[ON_COMMAND](message-map-macros-mfc.md#on_command)巨集，將 WM_COMMAND 訊息對應的成員函式。

##  <a name="removeallbuttons"></a>  CMFCToolBar::RemoveAllButtons

從工具列中，移除所有的按鈕和分隔符號。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>備註

它會重新建立或終結工具列時，架構會呼叫這個方法。

##  <a name="removebutton"></a>  CMFCToolBar::RemoveButton

從工具列中移除具有指定的索引的按鈕。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[in]指定的 [移除] 按鈕之以零起始的索引。

### <a name="return-value"></a>傳回值

如果方法成功，或如果指定的索引是無效的 FALSE 或索引指的是，則為 TRUE**自訂** 按鈕。

### <a name="remarks"></a>備註

這個方法會更新受影響的按鈕移除額外的工具列屬性。 比方說，這個方法會從工具列中移除不必要的分隔符號，並重建資料表的快速鍵。

如需詳細資訊**自訂**按鈕，請參閱[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)。

##  <a name="removestatefromregistry"></a>  CMFCToolBar::RemoveStateFromRegistry

從 Windows 登錄中刪除工具列的狀態資訊。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
[in]指定的登錄機碼的狀態資訊所在的位置。

*nIndex*<br/>
[in]工具列控制項識別碼。

*uiID*<br/>
[in]在工具列的資源識別碼。 如果這個參數是-1，這個方法會使用[CWnd::GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法來擷取資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會呼叫這個方法時就會刪除使用者定義的工具列。

如果您在 Windows 登錄中儲存其他狀態資訊，請覆寫這個方法。

##  <a name="replacebutton"></a>  CMFCToolBar::ReplaceButton

取代另一個工具列按鈕的工具列按鈕。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
[in]要取代按鈕的命令識別碼。

*按鈕*<br/>
[in]參考`CMFCToolBarButton`插入。

*球*<br/>
[in]布林值，指定是否要取代所有具有所指定的命令 ID 的按鈕*uiCmd*。 如果此參數為 TRUE，會取代所有具有指定的命令 ID 的按鈕。 否則，會取代第一個按鈕。

### <a name="return-value"></a>傳回值

會被取代的按鈕數目。 如果不存在具有指定的命令 ID 的按鈕，這是在工具列上，這個方法會傳回 0。

### <a name="remarks"></a>備註

當您想要將無法從資源載入的工具列按鈕加入時，請呼叫這個方法。 您可以建立預留位置按鈕在設計階段，並以自訂按鈕取代該按鈕，當您初始化工具列。 請參閱 VisualStudioDemo 範例，其中會使用這個方法的範例。

### <a name="example"></a>範例

下列範例示範如何使用`ReplaceButton`方法中的`CMFCToolBar`類別。 此程式碼片段是一部分[IE 示範範例](../../visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

##  <a name="resetall"></a>  CMFCToolBar::ResetAll

將所有工具列都還原至其原始狀態。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>備註

這個方法會呼叫[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)可還原的應用程式中的每個工具列上的方法。 它會使用[CMFCToolBar::CanBeRestored](#canberestored)方法，以判斷工具列是否可以還原。

##  <a name="resetallimages"></a>  CMFCToolBar::ResetAllImages

清除所有應用程式中的工具列影像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>備註

這個方法會清除已初始化的映像集合[CMFCToolBar::LoadToolBar](#loadtoolbar)並[CMFCToolBar::LoadBitmap](#loadbitmap)方法。

##  <a name="resetimages"></a>  CMFCToolBar::ResetImages


```
virtual void ResetImages();
```

### <a name="remarks"></a>備註

##  <a name="restorefocus"></a>  CMFCToolBar::RestoreFocus


```
virtual void RestoreFocus();
```

### <a name="remarks"></a>備註

##  <a name="restoreoriginalstate"></a>  CMFCToolBar::RestoreOriginalState

還原工具列的原始狀態。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>傳回值

如果方法成功，或 FALSE，如果方法失敗或工具列為使用者定義，則為 TRUE。

### <a name="remarks"></a>備註

這個方法透過使用從資源檔載入工具列[CMFCToolBar::LoadToolBar](#loadtoolbar)方法。

架構會呼叫這個方法，當使用者選擇**全部重設**按鈕**工具列**自訂對話方塊的頁面。

##  <a name="saveparameters"></a>  CMFCToolBar::SaveParameters


```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[in]*lpszProfileName*

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="savestate"></a>  CMFCToolBar::SaveState

將工具列的狀態資訊儲存在 Windows 登錄中。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
[in]指定的 Windows 登錄機碼的相對路徑。

*nIndex*<br/>
[in]工具列控制項識別碼。

*uiID*<br/>
[in]在工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

它會將應用程式狀態儲存至登錄時，架構會呼叫這個方法。 如需詳細資訊，請參閱 < [CWinAppEx::SaveState](../../mfc/reference/cwinappex-class.md#savestate)。

##  <a name="setbasiccommands"></a>  CMFCToolBar::SetBasicCommands

設定一律會在使用者開啟功能表時所顯示的命令清單。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
[in]參考`CList`物件，包含命令的集合。

### <a name="remarks"></a>備註

在功能表開啟時，一律會顯示基本命令。 當使用者選擇要檢視最近使用的命令，這個方法是有意義。

使用[CMFCToolBar::AddBasicCommand](#addbasiccommand)方法，將命令加入至基本命令的清單。 使用[CMFCToolBar::GetBasicCommands](#getbasiccommands)方法來擷取基本命令，以供您的應用程式的清單。

在總管的範例使用這個方法的範例，請參閱。

##  <a name="setbuttoninfo"></a>  CMFCToolBar::SetButtonInfo

設定命令 ID、 樣式和工具列按鈕的映像識別碼。

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]按鈕時會設定其屬性的以零為起始的索引。

*nID*<br/>
[in]按鈕的命令識別碼。

*nStyle*<br/>
[in]按鈕的樣式。 請參閱[ToolBar 控制項樣式](../../mfc/reference/toolbar-control-styles.md)可用工具列按鈕樣式的清單。

*iImage*<br/>
[in]（也就是集合中工具列影像的索引）] 按鈕之以零為起始的影像索引。

### <a name="remarks"></a>備註

呼叫這個方法來設定工具列按鈕的屬性。

在偵錯組建中，這個方法如果會產生判斷提示失敗由所指定的索引*nIndex*無效。

呼叫[CMFCToolBar::SetButtonStyle](#setbuttonstyle)方法來設定按鈕的樣式。

##  <a name="setbuttons"></a>  CMFCToolBar::SetButtons

設定工具列的按鈕。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>參數

*lpIDArray*<br/>
[in]若要插入的按鈕的命令 Id 的陣列的指標。

*nIDCount*<br/>
[in]中的項目數*lpIDArray*。

*bRemapImages*<br/>
[in]布林值，指定是否要插入的按鈕相關聯的現有按鈕映像。 如果此參數為 TRUE，則會重新對應的映像。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

呼叫此方法以移除現有按鈕從工具列，並插入新的按鈕的集合。

這個方法會加入**自訂**工具列和傳送 AFX_WM_RESETTOOLBAR 訊息給父視窗的工具列按鈕。 如需詳細資訊**自訂**按鈕，請參閱[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)。

##  <a name="setbuttonstyle"></a>  CMFCToolBar::SetButtonStyle

設定指定索引處的工具列按鈕的樣式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]工具列按鈕的樣式是設為起始的索引。

*nStyle*<br/>
[in]按鈕的樣式。 請參閱[ToolBar 控制項樣式](../../mfc/reference/toolbar-control-styles.md)可用工具列按鈕樣式的清單。

### <a name="remarks"></a>備註

如果這個方法會移除 TBBS_PRESSED 樣式*nStyle*是 TBBS_DISABLED，因為使用者不能按一下 停用的按鈕。

##  <a name="setbuttontext"></a>  CMFCToolBar::SetButtonText

設定工具列按鈕的文字標籤。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]工具列按鈕的索引。

*lpszText*<br/>
[in]工具列按鈕的文字標籤。 必須為非 NULL。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如果提供的索引未參考有效的工具列按鈕，這個方法會傳回 FALSE。

##  <a name="setcommandusageoptions"></a>  CMFCToolBar::SetCommandUsageOptions

指定當很少使用的命令未出現的功能表中的應用程式。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>參數

*nStartCount*<br/>
[in]指定必須執行數次的命令，然後在架構顯示只有基本] 和 [最近使用過的命令。

*nMinUsagePercentage*<br/>
[in]必須執行命令，才會被視為最近使用的命令的時間百分比。

### <a name="return-value"></a>傳回值

False *nMinUsagePercentage*等於或大於 100，否則為 TRUE。

### <a name="remarks"></a>備註

呼叫此方法以自訂演算法，架構會使用，以判斷如何基本和最近使用的功能表項目會出現。 如需有關基本命令的詳細資訊，請參閱[CMFCToolBar::AddBasicCommand](#addbasiccommand)。

這個類別會使用`CMFCCmdUsageCount`類別追蹤的命令的使用計數。 如需有關這個類別的詳細資訊，請參閱 < [CMFCCmdUsageCount 類別](../../mfc/reference/cmfccmdusagecount-class.md)。

##  <a name="setcustomizemode"></a>  CMFCToolBar::SetCustomizeMode

啟用或停用應用程式中的所有工具列的自訂模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[in]布林值，指定是否要啟用或停用自訂模式。 將此參數設為 true 以啟用自訂模式或 FALSE 來停用它。

### <a name="return-value"></a>傳回值

TRUE 如果呼叫這個方法會變更的自訂模式;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會調整的配置，並重新繪製應用程式中的每個工具列。 呼叫[CMFCToolBar::IsCustomizeMode](#iscustomizemode)方法，以判斷應用程式是否為自訂模式，

##  <a name="setgraydisabledbuttons"></a>  CMFCToolBar::SetGrayDisabledButtons

指定是否無法使用工具列上的按鈕會以灰色顯示，或是否使用按鈕無法使用的映像。

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>參數

*bGrayDisabledButtons*<br/>
[in]布林值，指定如何顯示無法使用的按鈕。 如果此參數為 TRUE 時，framework 變暗的按鈕。 否則，架構會使用按鈕無法使用的映像集合。

### <a name="remarks"></a>備註

根據預設，無法使用的按鈕會呈暗灰色。

##  <a name="setheight"></a>  CMFCToolBar::SetHeight

設定工具列的高度。

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>參數

*cyHeight*<br/>
[in]在工具列中，單位為像素的高度。

### <a name="remarks"></a>備註

之後它會設定高度，則這個方法會重新繪製的工具列。

##  <a name="sethelpmode"></a>  CMFCToolBar::SetHelpMode


```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>參數

[in]*bOn*

### <a name="remarks"></a>備註

##  <a name="sethot"></a>  CMFCToolBar::SetHot


```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>參數

[in]*pMenuButton*

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="sethotborder"></a>  CMFCToolBar::SetHotBorder

指定工具列按鈕是否熱追蹤。

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>參數

*bShowHotBorder*<br/>
[in]布林值，指定是否要熱追蹤的工具列按鈕。 如果此參數為 TRUE 時，工具列熱追蹤其按鈕。 否則工具列不會不熱追蹤其按鈕。

### <a name="remarks"></a>備註

如果按鈕是熱追蹤，架構會反白顯示的按鈕時在滑鼠移過它。 根據預設，每個工具列熱追蹤其按鈕。

呼叫[CMFCToolBar::GetHotBorder](#gethotborder)方法，以判斷是否工具列熱追蹤其按鈕。

##  <a name="sethottextcolor"></a>  CMFCToolBar::SetHotTextColor

設定作用中工具列按鈕的文字色彩。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>參數

*clrText*<br/>
[in]指定熱點追蹤的工具列按鈕的文字色彩。

### <a name="remarks"></a>備註

如需熱點追蹤的工具列按鈕的詳細資訊，請參閱[CMFCToolBar::GetHotBorder](#gethotborder)並[CMFCToolBar::SetHotBorder](#sethotborder)。

##  <a name="setignoresettext"></a>  CMFCToolBar::SetIgnoreSetText


```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>參數

[in]*bValue*

### <a name="remarks"></a>備註

##  <a name="setlargeicons"></a>  CMFCToolBar::SetLargeIcons

指定工具列按鈕是否顯示大型圖示。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>參數

*bLargeIcons*<br/>
[in]布林值，指定要使用的圖示。 如果此參數為 TRUE，則架構會顯示大圖示。 否則，架構會顯示規則的圖示。

### <a name="remarks"></a>備註

架構會呼叫這個方法，當使用者變更的狀態**大圖示**中的核取方塊**選項**索引標籤**自訂** 對話方塊。 這個方法會調整大小的應用程式中的所有工具列。

根據預設，架構會顯示規則的圖示。

如需詳細資訊**自訂** 對話方塊中，請參閱[CMFCToolBarsCustomizeDialog 類別](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

##  <a name="setlockedsizes"></a>  CMFCToolBar::SetLockedSizes

在工具列上設定鎖定的按鈕和鎖定的映像的大小。

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
[in]指定鎖定的工具列按鈕的大小。

*sizeImage*<br/>
[in]指定鎖定的工具列影像的大小。

*bDontScale*<br/>
指定是否要調整鎖定工具列影像在高 DPI 的模式。

### <a name="remarks"></a>備註

鎖定按鈕的預設大小為 23 x 22 個像素。 鎖定的映像的預設大小為 16x15 像素。

呼叫[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)方法來擷取的大小已鎖定的映像。 呼叫[CMFCToolBar::GetButtonSize](#getbuttonsize)方法來擷取的大小鎖定工具列按鈕。

##  <a name="setmaskmode"></a>  CMFCToolBar::SetMaskMode


```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>參數

[in]*bMasked*

### <a name="remarks"></a>備註

##  <a name="setmenusizes"></a>  CMFCToolBar::SetMenuSizes

設定工具列功能表按鈕和其映像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
[in]像素為單位指定工具列按鈕的大小。

*sizeImage*<br/>
[in]指定像素為單位的工具列影像的大小。

### <a name="remarks"></a>備註

根據預設，功能表按鈕和其映像具有未定義的大小。

呼叫[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)方法，以判斷功能表按鈕的大小並[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)方法，以判斷功能表按鈕影像的大小。

請參閱 IEDemo 和 MSMoneyDemo 範例如需範例，請使用這個方法。

##  <a name="setnonpermittedcommands"></a>  CMFCToolBar::SetNonPermittedCommands

設定使用者無法執行的命令的清單。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
[in]參考`CList`物件，其中包含無法由使用者執行的命令。

### <a name="remarks"></a>備註

呼叫這個方法，以防止使用者選取特定的命令。 比方說，您可能要防止使用者選取特定的命令，基於安全性考量。 請參閱 MDITabsDemo 和 MenuSubSet 範例如需範例，請使用這個方法。

這個方法會清除先前的非允許的命令清單。 根據預設，非允許命令的清單是空的。

##  <a name="setonerowwithsibling"></a>  Cmfctoolbar:: Setonerowwithsibling

將工具列和其同層級置於相同的資料列。

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>備註

架構會呼叫這個方法，當使用者按一下**在一個資料列上顯示按鈕** 按鈕。

呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)方法，讓**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**按鈕。 如果您呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)對於此工具列，同層級工具列會移動到這個工具列的資料列。 否則，此工具列會移到同層級的資料列。

這個架構會呼叫[cmfctoolbar:: Settworowswithsibling](#settworowswithsibling)方法，當使用者按一下**在兩個資料列上顯示按鈕** 按鈕。

##  <a name="setorigbuttons"></a>  CMFCToolBar::SetOrigButtons


```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>參數

[in]*lstOrigButtons*

### <a name="remarks"></a>備註

##  <a name="setpermament"></a>  CMFCToolBar::SetPermament

指定使用者是否可以關閉工具列。

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>參數

*bPermament*<br/>
[in]布林值，指定使用者是否可以關閉工具列。 如果此參數為 TRUE，則使用者無法關閉工具列。 否則，使用者可以關閉工具列。

### <a name="remarks"></a>備註

根據預設，使用者可以關閉每個工具列。

呼叫[CMFCToolBar::CanBeClosed](#canbeclosed)方法，以判斷使用者是否可以關閉工具列。

##  <a name="setroutecommandsviaframe"></a>  CMFCToolBar::SetRouteCommandsViaFrame

指定是否在父框架或擁有者的命令傳送至工具列。

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[in]如果此參數為 TRUE 時，父框架會將命令傳送至工具列。 否則，擁有者會將命令傳送至工具列。

### <a name="remarks"></a>備註

根據預設，父框架會將命令傳送至工具列。 呼叫[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)方法，以判斷是否父框架或擁有者的命令傳送至工具列。

##  <a name="setshowtooltips"></a>  CMFCToolBar::SetShowTooltips

指定是否，架構會顯示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[in]如果此參數為 TRUE，則架構會顯示工具提示。 否則，framework 會隱藏工具提示。

### <a name="remarks"></a>備註

根據預設，架構會顯示工具提示。

呼叫[CMFCToolBar::GetShowTooltips](#getshowtooltips)方法，以判斷是否在架構顯示工具提示。

##  <a name="setsiblingtoolbar"></a>  Cmfctoolbar:: Setsiblingtoolbar

指定工具列的同層級。

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>參數

*pBrotherToolbar*<br/>
[in]同層級工具列指標。

### <a name="remarks"></a>備註

這個方法可讓**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**會顯示當使用者顯示的按鈕**自訂**快顯功能表。 當您想要讓使用者能夠指定是否要在相同的資料列上或在不同的資料列上顯示相關的工具列，請呼叫這個方法。

呼叫這個方法，啟用後**自訂**會出現在工具列的按鈕。 若要啟用**自訂**按鈕，呼叫[cmfctoolbar:: Enablecustomizebutton](#enablecustomizebutton)方法。

若要擷取工具列的同層級，請呼叫[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)。

##  <a name="setsizes"></a>  CMFCToolBar::SetSizes

指定所有的工具列按鈕和映像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
[in]工具列按鈕，像素為單位的大小。

*sizeImage*<br/>
[in]工具列按鈕影像像素為單位的大小。

### <a name="remarks"></a>備註

工具列按鈕的預設大小為 23 x 22 個像素。 工具列按鈕影像的預設大小為 16x15 像素。

呼叫[CMFCToolBar::GetImageSize](#getimagesize)方法來擷取工具列按鈕影像的大小。 呼叫[CMFCToolBar::GetButtonSize](#getbuttonsize)方法來擷取工具列按鈕的大小。

##  <a name="settoolbarbtntext"></a>  CMFCToolBar::SetToolBarBtnText

在工具列上，指定按鈕的屬性。

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>參數

*nBtnIndex*<br/>
[in]工具列按鈕的工具列按鈕清單中以零為起始的索引。

*szText*<br/>
[in]指定工具列按鈕的文字標籤。

*bShowText*<br/>
[in]如果此參數為 TRUE，則架構會顯示文字標籤。 否則，framework 會隱藏文字標籤。

*bShowImage*<br/>
[in]如果此參數為 TRUE，則架構會顯示工具列按鈕影像。 否則，framework 會隱藏工具列按鈕影像。

### <a name="remarks"></a>備註

根據預設，架構會顯示工具列按鈕的影像，但並未顯示工具列按鈕的文字標籤。

在偵錯組建中，這個方法如果會產生判斷提示失敗*nBtnIndex*未參考有效的工具列按鈕或工具列按鈕是分隔符號。

##  <a name="settworowswithsibling"></a>  Cmfctoolbar:: Settworowswithsibling

將工具列和其同層級置於個別的資料列。

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>備註

架構會呼叫這個方法，當使用者按一下**在兩個資料列上顯示按鈕** 按鈕。

呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)方法，讓**在一個資料列上顯示按鈕**或是**在兩個資料列上顯示按鈕**按鈕。 如果您呼叫[cmfctoolbar:: Setsiblingtoolbar](#setsiblingtoolbar)對於此工具列，同層級工具列會移動到個別的資料列。 否則，此工具列會移至個別的資料列。

這個架構會呼叫[cmfctoolbar:: Setonerowwithsibling](#setonerowwithsibling)方法，當使用者按一下**在一個資料列上顯示按鈕** 按鈕。

##  <a name="setuserimages"></a>  CMFCToolBar::SetUserImages

應用程式中設定使用者定義的映像的集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>參數

*pUserImages*<br/>
[in]使用者定義的映像集合指標。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零否則為 0 指定`CMFCToolBarImages`物件無效，或從工具列的預設映像大小不同的映像大小。

### <a name="remarks"></a>備註

架構會使用使用者定義的映像，來繪製會由使用者自訂的工具列按鈕。 所指定的映像清單*pUserImages*會共用應用程式中的所有工具列。

這個方法會產生判斷提示失敗偵錯組建中若指定`CMFCToolBarImages`物件無效，或從工具列的預設映像大小不同的映像大小。

OutlookDemo、 ToolTipDemo 和 VisualStudioDemo 範例會使用這個方法來設定全域集合的使用者定義的映像。 載入這些檔案，稱為 UserImages.bmp 位於應用程式的工作目錄中。

呼叫[CMFCToolBar::GetUserImages](#getuserimages)方法來擷取使用者定義的應用程式中的映像集合。

##  <a name="stretchpane"></a>  CMFCToolBar::StretchPane

垂直或水平伸展工具列和重新置放的按鈕，如有必要。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>參數

*nLength*<br/>
[in]以像素為單位，用來拉長窗格中的金額。

*bVert*<br/>
[in]如果為 TRUE，垂直伸展窗格。 如果為 FALSE，水平伸展窗格。

### <a name="return-value"></a>傳回值

A`CSize`物件，指定工具列工作區的大小。

### <a name="remarks"></a>備註

這個方法會呼叫[CMFCToolBar::WrapToolBar](#wraptoolbar)重新定位在延伸的工具列按鈕。

傳回的值取決於呼叫[CMFCToolBar::CalcSize](#calcsize)。

##  <a name="translatechar"></a>  CMFCToolBar::TranslateChar

如果指定的按鍵碼對應至有效的鍵盤快速鍵，請執行按鈕命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>參數

*NChar*<br/>
[in]指定虛擬按鍵碼。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

### <a name="return-value"></a>傳回值

如果指定的按鍵碼，則為 FALSE。 不可列印或未對應到有效的鍵盤快速鍵;如果指定的按鍵碼對應至下拉式選單 選項中，則為 TRUE傳回值，否則為[CMFCToolBar::ProcessCommand](#processcommand)。

### <a name="remarks"></a>備註

架構會呼叫這個方法，搭配 Alt 鍵按下按鍵。

##  <a name="updatebutton"></a>  CMFCToolBar::UpdateButton

更新指定的按鈕狀態。

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]指定的 [更新] 按鈕之以零起始的索引。

### <a name="remarks"></a>備註

##  <a name="wraptoolbar"></a>  CMFCToolBar::WrapToolBar

重新調整位置指定的維度內的工具列按鈕。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>參數

*nWidth*<br/>
[in]在工具列的最大寬度。

*nHeight*<br/>
[in]在工具列的最大高度。 如果不會使用浮動工具列。

*pDC*<br/>
[in]裝置內容指標。 如果是 NULL，則會使用工具列的裝置內容。

*nColumnWidth*<br/>
[in]按鈕的寬度。 如果為-1，則會使用目前的寬度。

[in] m *nRowHeight*按鈕高度。 如果為-1，則會使用目前的高度。

### <a name="return-value"></a>傳回值

在工具列上按鈕的資料列數目。

### <a name="remarks"></a>備註

這個方法會重新調整內工具列中，自動換行如有需要額外的資料列的按鈕的按鈕。

##  <a name="m_bdontscaleimages"></a>  CMFCToolBar::m_bDontScaleImages

指定要在高 DPI 模式調整工具列影像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar 類別](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[逐步解說：將控制項放在工具列上](../../mfc/walkthrough-putting-controls-on-toolbars.md)



