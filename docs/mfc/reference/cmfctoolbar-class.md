---
title: CMFCToolBar 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: d2af7a808e07e0368dd43ed920b6d8736a90b995
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/15/2019
ms.locfileid: "69504893"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 類別

類別類似于[CToolBar 類別](../../mfc/reference/ctoolbar-class.md), 但會提供使用者介面功能的額外支援。 `CMFCToolBar` 這包括一般工具列、含作用中影像的工具列、大圖示、頁面巡覽區按鈕、鎖定工具列、Rebar 控制項、影像下方文字、背景影像和索引標籤式工具列。 `CMFCToolBar` 類別的內建支援也包括工具列和功能表的使用者自訂、工具列和功能表之間的拖放、下拉式方塊按鈕、編輯方塊按鈕、色彩選擇器和縮合按鈕。

如需詳細資訊, 請參閱位於 Visual Studio 安裝**的\\VC\\atlmfc\\src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|預設建構函式。|
|`CMFCToolBar::~CMFCToolBar`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|說明|
|----------|-----------------|
|[CMFCToolBar::AddBasicCommand](#addbasiccommand)|將功能表命令加入至當使用者開啟功能表時, 一律會顯示的命令清單。|
|[CMFCToolBar::AddCommandUsage](#addcommandusage)|將與指定命令相關聯的計數器遞增一。|
|[CMFCToolBar::AddToolBarForImageCollection](#addtoolbarforimagecollection)|將使用者介面資源中的影像新增至應用程式中的影像集合。|
|[CMFCToolBar::AdjustLayout](#adjustlayout)|重新計算工具列的大小和位置。 (覆寫[CBasePane:: AdjustLayout](../../mfc/reference/cbasepane-class.md#adjustlayout))。|
|[CMFCToolBar::AdjustSize](#adjustsize)|重新計算工具列的大小。|
|[CMFCToolBar::AllowChangeTextLabels](#allowchangetextlabels)|指定文字標籤是否可以在工具列按鈕的 [影像] 下顯示。|
|[CMFCToolBar::AreTextLabels](#aretextlabels)|指定 [影像] 底下的文字標籤目前是否顯示在工具列按鈕上。|
|[CMFCToolBar::AutoGrayInactiveImages](#autograyinactiveimages)|啟用或停用自動產生非使用中的按鈕影像。|
|[CMFCToolBar::ButtonToIndex](#buttontoindex)|傳回此工具列中指定之[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件的索引。|
|[CMFCToolBar::CalcFixedLayout](#calcfixedlayout)|計算工具列的水準大小。 (覆寫[CBasePane:: CalcFixedLayout](../../mfc/reference/cbasepane-class.md#calcfixedlayout)。)|
|[CMFCToolBar::CalcSize](#calcsize)|由架構在版面配置計算過程中呼叫。 (覆寫[CPane:: CalcSize](../../mfc/reference/cpane-class.md#calcsize)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFCToolBar::CleanUpImages](#cleanupimages)|釋放配置給工具列影像的系統資源。|
|[CMFCToolBar::CleanUpLockedImages](#cleanuplockedimages)|釋放配置給鎖定工具列影像的系統資源。|
|[CMFCToolBar:: CanBeClosed](#canbeclosed)|指定使用者是否可以關閉工具列。 (覆寫[CBasePane:: CanBeClosed](../../mfc/reference/cbasepane-class.md#canbeclosed)。)|
|[CMFCToolBar:: CanBeRestored](#canberestored)|判斷系統是否可以在自訂之後, 將工具列還原成其原始狀態。|
|[CMFCToolBar::CanFocus](#canfocus)|指定窗格是否可以接收焦點。 (覆寫[CBasePane:: CanFocus](../../mfc/reference/cbasepane-class.md#canfocus)。)|
|[CMFCToolBar::CanHandleSiblings](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFCToolBar::CommandToIndex](#commandtoindex)|使用指定的命令識別碼, 傳回工具列中按鈕的索引。|
|[CMFCToolBar::Create](#create)|建立 `CMFCToolBar` 物件。|
|[CMFCToolBar::CreateEx](#createex)|建立使用其他樣式選項的物件,例如大型圖示。`CMFCToolBar`|
|[CMFCToolBar::Deactivate](#deactivate)|停用工具列。|
|[CMFCToolBar::EnableCustomizeButton](#enablecustomizebutton)|啟用或停用出現在工具列結尾的 [**新增或移除按鈕**] 按鈕。|
|[CMFCToolBar::EnableDocking](#enabledocking)|啟用將窗格停駐到主框架。 (覆寫[CBasePane:: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)。)|
|[CMFCToolBar::EnableLargeIcons](#enablelargeicons)|啟用或停用工具列按鈕上的大圖示。|
|[CMFCToolBar::EnableQuickCustomization](#enablequickcustomization)|啟用或停用工具列的快速自訂, 讓使用者可以按**Alt**鍵並將按鈕拖曳到新的位置。|
|[CMFCToolBar::EnableReflections](#enablereflections)|啟用或停用命令反映。|
|[CMFCToolBar::EnableTextLabels](#enabletextlabels)|啟用或停用工具列按鈕影像底下的文字標籤。|
|[CMFCToolBar::FromHandlePermanent](#fromhandlepermanent)|抓取`CMFCToolBar`物件的指標, 其中包含指定的視窗控制碼。|
|[CMFCToolBar::GetAllButtons](#getallbuttons)|傳回工具列中的唯讀按鈕清單。|
|[CMFCToolBar::GetAllToolbars](#getalltoolbars)|傳回應用程式中所有工具列的唯讀清單。|
|[CMFCToolBar::GetBasicCommands](#getbasiccommands)|傳回應用程式中定義之基本命令的唯讀清單。|
|[CMFCToolBar::GetButton](#getbutton)|傳回具有指定的工具列`CMFCToolBarButton`按鈕索引之物件的指標。|
|[CMFCToolBar::GetButtonInfo](#getbuttoninfo)|傳回指定索引之按鈕的命令識別碼、樣式和影像索引。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|傳回工具列上每個按鈕的維度。|
|[CMFCToolBar::GetButtonStyle](#getbuttonstyle)|傳回位於指定索引之工具列按鈕的目前樣式。|
|[CMFCToolBar::GetButtonText](#getbuttontext)|傳回具有指定索引之按鈕的文字標籤。|
|[CMFCToolBar::GetColdImages](#getcoldimages)|傳回應用程式中冷工具列按鈕影像集合的指標。|
|[CMFCToolBar::GetColumnWidth](#getcolumnwidth)|傳回工具列按鈕的寬度。|
|[CMFCToolBar::GetCommandButtons](#getcommandbuttons)|從應用程式中的所有工具列, 傳回具有指定命令識別碼的按鈕清單。|
|[CMFCToolBar::GetCount](#getcount)|傳回工具列上的按鈕和分隔符號數目。|
|[CMFCToolBar::GetCustomizeButton](#getcustomizebutton)|抓取與工具列相關聯`CMFCCustomizeButton`之物件的指標。|
|[CMFCToolBar::GetDefaultImage](#getdefaultimage)|傳回具有指定命令識別碼之工具列按鈕的預設影像索引。|
|[CMFCToolBar::GetDisabledImages](#getdisabledimages)|傳回用於應用程式中停用的工具列按鈕之影像集合的指標。|
|[CMFCToolBar::GetDisabledMenuImages](#getdisabledmenuimages)|傳回用來在應用程式中停用的功能表按鈕之影像集合的指標。|
|[CMFCToolBar::GetDroppedDownMenu](#getdroppeddownmenu)|抓取目前顯示其子功能表的功能表按鈕物件指標。|
|[CMFCToolBar::GetGrayDisabledButtons](#getgraydisabledbuttons)|指定停用按鈕的影像是否為一般按鈕影像的暗灰色版本, 或從已停用按鈕影像的集合中取得。|
|[CMFCToolBar::GetHighlightedButton](#gethighlightedbutton)|傳回目前反白顯示之工具列按鈕的指標。|
|[CMFCToolBar::GetHotBorder](#gethotborder)|決定工具列按鈕是否會進行熱追蹤。|
|[CMFCToolBar::GetHotTextColor](#gethottextcolor)|傳回反白顯示之工具列按鈕的文字色彩。|
|[CMFCToolBar::GetHwndLastFocus](#gethwndlastfocus)|傳回視窗的控制碼, 其中的輸入焦點剛好在工具列的前面。|
|[CMFCToolBar::GetIgnoreSetText](#getignoresettext)|指定是否忽略設定按鈕標籤的呼叫。|
|[CMFCToolBar::GetImageSize](#getimagesize)|傳回工具列按鈕影像的目前大小。|
|[CMFCToolBar::GetImages](#getimages)|傳回應用程式中預設按鈕影像集合的指標。|
|[CMFCToolBar::GetImagesOffset](#getimagesoffset)|傳回索引位移, 用來在工具列按鈕影像的全域清單中尋找此工具列的工具列按鈕影像。|
|[CMFCToolBar::GetInvalidateItemRect](#getinvalidateitemrect)|抓取工作區的區域, 該區域必須針對指定索引處的按鈕重新繪製。|
|[CMFCToolBar::GetItemID](#getitemid)|傳回位於指定索引之工具列按鈕的命令 ID。|
|[CMFCToolBar::GetItemRect](#getitemrect)|傳回位於指定索引之按鈕的周框。|
|[CMFCToolBar::GetLargeColdImages](#getlargecoldimages)|傳回應用程式中大型冷工具列按鈕影像集合的指標。|
|[CMFCToolBar::GetLargeDisabledImages](#getlargedisabledimages)|傳回應用程式中大型停用工具列按鈕影像集合的指標。|
|[CMFCToolBar::GetLargeImages](#getlargeimages)|傳回應用程式中大型工具列按鈕影像集合的指標。|
|[CMFCToolBar::GetLockedColdImages](#getlockedcoldimages)|傳回工具列中鎖定冷影像集合的指標。|
|[CMFCToolBar::GetLockedDisabledImages](#getlockeddisabledimages)|傳回工具列中已鎖定之已停用影像集合的指標。|
|[CMFCToolBar::GetLockedImages](#getlockedimages)|傳回工具列中已鎖定按鈕影像集合的指標。|
|[CMFCToolBar::GetLockedImageSize](#getlockedimagesize)|傳回鎖定工具列影像的預設大小。|
|[CMFCToolBar::GetLockedMenuImages](#getlockedmenuimages)|傳回工具列中鎖定的工具列功能表影像之集合的指標。|
|[CMFCToolBar::GetMenuButtonSize](#getmenubuttonsize)|傳回應用程式中的功能表按鈕大小。|
|[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)|傳回應用程式中功能表按鈕影像的大小。|
|[CMFCToolBar::GetMenuImages](#getmenuimages)|傳回應用程式中功能表按鈕影像集合的指標。|
|[CMFCToolBar::GetOrigButtons](#getorigbuttons)|抓取工具列的非自訂按鈕集合。|
|[CMFCToolBar::GetOrigResetButtons](#getorigresetbuttons)|抓取工具列的非自訂重設按鈕集合。|
|[CMFCToolBar::GetResourceID](#getresourceid)|抓取工具列的資源識別碼。|
|[CMFCToolBar::GetRouteCommandsViaFrame](#getroutecommandsviaframe)|判斷哪個物件 (父框架或擁有者) 會將命令傳送至工具列。|
|[CMFCToolBar::GetRowHeight](#getrowheight)|傳回工具列按鈕的高度。|
|[CMFCToolBar::GetShowTooltips](#getshowtooltips)|指定是否要顯示工具列按鈕的工具提示。|
|[CMFCToolBar::GetSiblingToolBar](#getsiblingtoolbar)|抓取工具列的兄弟。|
|[CMFCToolBar::GetUserImages](#getuserimages)|傳回應用程式中使用者定義的工具列按鈕影像集合的指標。|
|[CMFCToolBar::HitTest](#hittest)|傳回位於指定位置之工具列按鈕的索引。|
|[CMFCToolBar::InsertButton](#insertbutton)|在工具列中插入按鈕。|
|[CMFCToolBar::InsertSeparator](#insertseparator)|在工具列中插入分隔符號。|
|[CMFCToolBar::InvalidateButton](#invalidatebutton)|使存在於所提供索引處之工具列按鈕的工作區失效。|
|[CMFCToolBar::IsAddRemoveQuickCustomize](#isaddremovequickcustomize)|決定使用者是否可以使用 [**自訂**] 功能表選項來新增或移除工具列按鈕。|
|[CMFCToolBar::IsAltCustomizeMode](#isaltcustomizemode)|指定是否使用*快速自訂*來拖曳按鈕。|
|[CMFCToolBar::IsAutoGrayInactiveImages](#isautograyinactiveimages)|指定是否啟用自動產生非作用中 (未反白顯示) 的按鈕影像。|
|[CMFCToolBar::IsBasicCommand](#isbasiccommand)|判斷命令是否在基本命令清單中。|
|[CMFCToolBar::IsButtonExtraSizeAvailable](#isbuttonextrasizeavailable)|決定工具列是否可以顯示具有延伸框線的按鈕。|
|[CMFCToolBar::IsButtonHighlighted](#isbuttonhighlighted)|決定工具列上的按鈕是否反白顯示。|
|[CMFCToolBar::IsCommandPermitted](#iscommandpermitted)|判斷是否允許命令。|
|[CMFCToolBar::IsCommandRarelyUsed](#iscommandrarelyused)|判斷是否很少使用命令 (請參閱[CMFCToolBar:: SetCommandUsageOptions](#setcommandusageoptions))。|
|[CMFCToolBar::IsCustomizeMode](#iscustomizemode)|指定工具列架構是否處於自訂模式。|
|[CMFCToolBar::IsDragButton](#isdragbutton)|決定是否正在拖曳工具列按鈕。|
|[CMFCToolBar::IsExistCustomizeButton](#isexistcustomizebutton)|決定工具列是否包含 [**自訂**] 按鈕。|
|[CMFCToolBar::IsFloating](#isfloating)|決定工具列是否為浮動。|
|[CMFCToolBar::IsLargeIcons](#islargeicons)|指定應用程式中的工具列目前是否顯示大型圖示。|
|[CMFCToolBar::IsLastCommandFromButton](#islastcommandfrombutton)|判斷最近執行的命令是否從指定的工具列按鈕傳送。|
|[CMFCToolBar::IsLocked](#islocked)|決定工具列是否已鎖定。|
|[CMFCToolBar::IsOneRowWithSibling](#isonerowwithsibling)|決定工具列及其同輩工具列是否位於相同的資料列上。|
|[CMFCToolBar::IsUserDefined](#isuserdefined)|指定工具列是否為使用者定義的。|
|[CMFCToolBar::LoadBitmap](#loadbitmap)|從應用程式資源載入工具列影像。|
|[CMFCToolBar::LoadBitmapEx](#loadbitmapex)|從應用程式資源載入工具列影像。 包含大型影像。|
|[CMFCToolBar::LoadParameters](#loadparameters)|從 Windows 登錄載入全域工具列選項。|
|[CMFCToolBar::LoadState](#loadstate)|從 Windows 登錄載入工具列狀態資訊。 (覆寫[CPane:: LoadState](../../mfc/reference/cpane-class.md#loadstate)。)|
|[CMFCToolBar::LoadToolBar](#loadtoolbar)|從應用程式資源載入工具列。|
|[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)|使用`CMFCToolBarInfo` helper 類別, 從應用程式資源載入工具列, 讓應用程式使用大型影像。|
|[CMFCToolBar::OnChangeHot](#onchangehot)|當使用者選取工具列上的按鈕時由架構呼叫。|
|[CMFCToolBar::OnFillBackground](#onfillbackground)|由架構從[CBasePane::D opaint](../../mfc/reference/cbasepane-class.md#dopaint)呼叫以填滿工具列背景。|
|[CMFCToolBar::OnReset](#onreset)|將工具列還原成其原始狀態。|
|[CMFCToolBar::OnSetAccData](#onsetaccdata)|(覆寫[CBasePane:: OnSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata)。)|
|[CMFCToolBar::OnSetDefaultButtonText](#onsetdefaultbuttontext)|將工具列按鈕的文字還原為其預設狀態。|
|`CMFCToolBar::OnUpdateCmdUI`|在內部使用。|
|[CMFCToolBar::RemoveAllButtons](#removeallbuttons)|移除工具列中的所有按鈕。|
|[CMFCToolBar::RemoveButton](#removebutton)|從工具列中移除具有指定之索引的按鈕。|
|[CMFCToolBar::RemoveStateFromRegistry](#removestatefromregistry)|從 Windows 登錄移除工具欄的狀態資訊。|
|[CMFCToolBar::ReplaceButton](#replacebutton)|以另一個工具列按鈕取代工具列按鈕。|
|[CMFCToolBar::ResetAll](#resetall)|將所有工具列還原成其原始狀態。|
|[CMFCToolBar::ResetAllImages](#resetallimages)|清除應用程式中的所有工具列影像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|還原工具列的原始狀態。|
|[CMFCToolBar::SaveState](#savestate)|將工具列的狀態資訊儲存在 Windows 登錄中。 (覆寫[CPane:: SaveState](../../mfc/reference/cpane-class.md#savestate)。)|
|`CMFCToolBar::Serialize`|(覆寫 `CBasePane::Serialize`。)|
|[CMFCToolBar::SetBasicCommands](#setbasiccommands)|設定當使用者開啟功能表時, 一律會顯示的命令清單。|
|[CMFCToolBar::SetButtonInfo](#setbuttoninfo)|設定工具列按鈕的命令識別碼、樣式和影像識別碼。|
|[CMFCToolBar::SetButtonStyle](#setbuttonstyle)|設定在指定索引處的工具列按鈕樣式。|
|[CMFCToolBar::SetButtonText](#setbuttontext)|設定工具列按鈕的文字標籤。|
|[CMFCToolBar::SetButtons](#setbuttons)|設定工具列的按鈕。|
|[CMFCToolBar::SetCommandUsageOptions](#setcommandusageoptions)|指定很少使用的命令不會出現在應用程式的功能表中。|
|[CMFCToolBar::SetCustomizeMode](#setcustomizemode)|啟用或停用應用程式中所有工具列的自訂模式。|
|[CMFCToolBar::SetGrayDisabledButtons](#setgraydisabledbuttons)|指定工具列上的停用按鈕是否呈現暗灰色, 或停用已停用按鈕的影像。|
|[CMFCToolBar::SetHeight](#setheight)|設定工具列的高度。|
|[CMFCToolBar::SetHotBorder](#sethotborder)|指定是否要熱追蹤工具列按鈕。|
|[CMFCToolBar::SetHotTextColor](#sethottextcolor)|設定熱門工具列按鈕的文字色彩。|
|[CMFCToolBar::SetLargeIcons](#setlargeicons)|指定工具列按鈕是否顯示大型圖示。|
|[CMFCToolBar::SetLockedSizes](#setlockedsizes)|設定工具列上的鎖定按鈕和鎖定影像的大小。|
|[CMFCToolBar::SetMenuSizes](#setmenusizes)|設定工具列功能表按鈕和其影像的大小。|
|[CMFCToolBar::SetNonPermittedCommands](#setnonpermittedcommands)|設定使用者無法執行的命令清單。|
|[CMFCToolBar::SetOneRowWithSibling](#setonerowwithsibling)|將工具列和其兄弟置於相同的資料列上。|
|[CMFCToolBar::SetPermament](#setpermament)|指定使用者是否可以關閉工具列。|
|[CMFCToolBar::SetRouteCommandsViaFrame](#setroutecommandsviaframe)|指定父框架或擁有者是否將命令傳送至工具列。|
|[CMFCToolBar::SetShowTooltips](#setshowtooltips)|指定架構是否顯示工具提示。|
|[CMFCToolBar::SetSiblingToolBar](#setsiblingtoolbar)|指定工具列的同級。|
|[CMFCToolBar::SetSizes](#setsizes)|指定所有工具列上按鈕和影像的大小。|
|[CMFCToolBar::SetToolBarBtnText](#settoolbarbtntext)|指定工具列上按鈕的屬性。|
|[CMFCToolBar::SetTwoRowsWithSibling](#settworowswithsibling)|將工具列和其同級置於不同的資料列上。|
|[CMFCToolBar::SetUserImages](#setuserimages)|設定應用程式中使用者定義的影像集合。|
|[CMFCToolBar::StretchPane](#stretchpane)|以垂直或水準方式伸展工具列。 (覆寫[CBasePane:: StretchPane](../../mfc/reference/cbasepane-class.md#stretchpane)。)|
|[CMFCToolBar::TranslateChar](#translatechar)|如果指定的按鍵程式碼對應到有效的鍵盤快速鍵, 則執行按鈕命令。|
|[CMFCToolBar::UpdateButton](#updatebutton)|更新指定按鈕的狀態。|
|[CMFCToolBar::WrapToolBar](#wraptoolbar)|在指定的維度內重新置放工具列按鈕。|

### <a name="protected-methods"></a>保護方法

|名稱|說明|
|----------|-----------------|
|[CMFCToolBar::AllowShowOnList](#allowshowonlist)|決定工具列是否會顯示在 [**自訂**] 對話方塊的 [**工具列**] 窗格上的清單中。|
|[CMFCToolBar::CalcMaxButtonHeight](#calcmaxbuttonheight)|計算工具列中按鈕的最大高度。|
|[CMFCToolBar::DoPaint](#dopaint)|重新繪製工具列。|
|[CMFCToolBar::DrawButton](#drawbutton)|重新繪製工具列按鈕。|
|[CMFCToolBar::DrawSeparator](#drawseparator)|在工具列上重新繪製分隔符號。|
|[CMFCToolBar::OnUserToolTip](#onusertooltip)|當按鈕的工具提示即將顯示時由架構呼叫。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBar::m_bDontScaleImages](#m_bdontscaleimages)|指定是否要縮放高 DPI 模式的工具列影像。|
|[CMFCToolBar::m_dblLargeImageRatio](#m_dbllargeimageratio)|指定大型影像的維度 (高度或寬度) 與一般影像維度之間的比例。|

## <a name="remarks"></a>備註

若要將`CMFCToolBar`物件併入您的應用程式, 請遵循下列步驟:

1. `CMFCToolBar`將物件新增至主框架視窗。

1. 當您處理主框架視窗的 WM_CREATE 訊息時, 請呼叫[CMFCToolBar:: CREATE](#create)或[CMFCToolBar:: CreateEx](#createex)來建立工具列並指定其樣式。

1. 呼叫[CBasePane:: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking)以指定停駐樣式。

若要插入特殊按鈕 (例如下拉式方塊或下拉工具列), 請在父資源中保留 [虛設] 按鈕, 並使用[CMFCToolBar:: ReplaceButton](#replacebutton)取代執行時間的 [虛擬] 按鈕。 如需詳細資訊，請參閱[逐步解說：將控制項放在](../walkthrough-putting-controls-on-toolbars.md)工具列上。

`CMFCToolBar`是 MFC 程式庫類別[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)、 [CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)和[CMFCDropDownToolBar 類別](../../mfc/reference/cmfcdropdowntoolbar-class.md)的基類。

## <a name="example"></a>範例

下例示範如何在 `CMFCToolBar` 類別中使用各種方法。 此範例示範如何設定工具列的視窗標籤文字、設定框線、設定窗格的樣式, 以及啟用出現在工具列結尾的 [**加入] 或 [移除按鈕**] 按鈕。 此程式碼片段是[IE 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>需求

**標頭:** afxtoolbar。h

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBaseToolBar](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

##  <a name="addbasiccommand"></a>CMFCToolBar:: AddBasicCommand

將功能表命令加入至當使用者開啟功能表時, 一律會顯示的命令清單。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在指定要加入的命令。

### <a name="remarks"></a>備註

開啟功能表時, 一律會顯示基本命令。 當使用者選擇觀看最近使用的命令時, 這個方法會有意義。

使用[CMFCToolBar:: SetBasicCommands](#setbasiccommands)方法來設定當使用者開啟功能表時, 一律會顯示的命令清單。 使用[CMFCToolBar:: GetBasicCommands](#getbasiccommands)方法來取出應用程式所使用的基本命令清單。

##  <a name="addcommandusage"></a>CMFCToolBar:: AddCommandUsage

將與指定命令相關聯的計數器遞增一。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>參數

*uiCommand*<br/>
在指定要遞增的命令計數器。

### <a name="remarks"></a>備註

當使用者選取功能表項目時, 架構會呼叫這個方法。

此架構會使用命令計數器來顯示最近使用的功能表項目。

這個方法會使用[CMFCCmdUsageCount:: AddCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法來遞增命令計數器。

##  <a name="addtoolbarforimagecollection"></a>CMFCToolBar:: AddToolBarForImageCollection

將使用者介面資源中的影像新增至應用程式中的影像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
在具有要載入影像之工具列的資源識別碼。

*uiBmpResID*<br/>
在具有工具列影像之點陣圖的資源識別碼。

*uiColdResID*<br/>
在具有「冷」工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
在具有功能表影像之點陣圖的資源識別碼。

*uiDisabledResID*<br/>
在已停用工具列影像之點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
在已停用功能表影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功, 則為 TRUE;如果*uiResID*或*uiBmpResID*未指定有效的資源, 或發生另一個錯誤, 則為 FALSE。

### <a name="remarks"></a>備註

呼叫這個方法以載入具有工具列影像的點陣圖, 並將它加入至工具列影像的集合。 這個方法會建立一個暫存工具列物件, 並呼叫[CMFCToolBar:: LoadToolBar](#loadtoolbar)。

##  <a name="adjustlayout"></a>CMFCToolBar:: AdjustLayout

重新計算工具列的大小和位置。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>備註

建立工具列以重新計算其大小和位置時, 請呼叫這個方法。

每次必須變更工具列配置時, 架構會呼叫這個方法。 例如, 當使用者移動另一個控制列、調整應用程式視窗的大小, 或自訂工具列時, 版面配置必須變更。

覆寫這個方法, 以在衍生自`CMFCToolbar`的類別中提供您自己的動態配置。

##  <a name="adjustsize"></a>CMFCToolBar:: AdjustSize

重新計算工具列的大小。

```
void AdjustSize();
```

### <a name="remarks"></a>備註

這個方法可確保工具列符合父框架的範圍。 如果工具列沒有父框架, 這個方法就不會執行任何操作。

如果工具列的父系不`CMFCReBar`是物件, 則[CMFCToolBar:: AdjustLayout](#adjustlayout)方法會呼叫這個方法來重新計算大小。

##  <a name="allowchangetextlabels"></a>CMFCToolBar:: AllowChangeTextLabels

指定文字標籤是否可以在工具列按鈕的 [影像] 下顯示。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果允許在影像下方顯示文字標籤, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法是由 [自訂] 對話方塊所呼叫, 用來決定是否要在選取的工具列的 [**工具列**] 頁面上啟用 [**顯示文字標籤**] 核取方塊。

預設的實值會傳回 TRUE。

覆寫衍生自`CMFCToolBar`的物件中的這個方法, 並在您不想讓使用者決定文字標籤是否顯示在影像下的工具列按鈕時傳回 FALSE。

##  <a name="allowshowonlist"></a>CMFCToolBar:: AllowShowOnList

決定工具列是否會顯示在 [**自訂**] 對話方塊的 [**工具列**] 窗格上的工具列清單中。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>傳回值

如果工具列物件可以在工具列自訂頁面的清單方塊中顯示, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法, 以判斷工具列自訂頁面上的清單是否應該包含衍生自`CMFCToolBar`的特定物件。

預設的執行一律會傳回 TRUE。 當您不想讓工具列出現在 [自訂] 對話方塊的 [工具列] 清單中時, 請覆寫這個方法。

##  <a name="aretextlabels"></a>CMFCToolBar:: AreTextLabels

指定 [影像] 底下的文字標籤目前是否顯示在工具列按鈕上。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕會在影像下方顯示文字標籤, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

使用[CMFCToolBar:: EnableTextLabels](#enabletextlabels)來指定是否要顯示文字。 預設值為 FALSE。 呼叫[CMFCToolBar:: AllowChangeTextLabels](#allowchangetextlabels) , 指定使用者是否可以在 [自訂] 對話方塊中變更此設定。

##  <a name="autograyinactiveimages"></a>CMFCToolBar:: AutoGrayInactiveImages

啟用或停用自動產生非使用中的按鈕影像。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在布林值, 指定是否要變暗非使用中的影像。 如果此參數為 TRUE, 非使用中影像會變成暗灰色。 否則, 非使用中的影像不會呈現暗灰色。

*nGrayImagePercentage*<br/>
在指定非使用中影像的亮度百分比。 如果*bEnable*為 FALSE, 則會忽略這個值。

*bRedrawAllToolbars*<br/>
在布林值, 指定是否要重繪應用程式中的所有工具列。 如果此參數為 TRUE, 這個方法會重新繪製所有工具列。

### <a name="remarks"></a>備註

如果*bEnable*為 TRUE, 則架構會使用*nGrayImagePercentage*從一般映射產生非使用中的影像。 否則, 您必須使用[CMFCToolBar:: GetColdImages](#getcoldimages)方法來提供一組非使用中的影像。 預設會停用此選項。

如需*nGrayImagePercentage*參數的詳細資訊, 請參閱[CMFCToolBarImages:: GrayImages](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

##  <a name="buttontoindex"></a>CMFCToolBar:: ButtonToIndex

傳回此工具列中指定之[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件的索引。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
在工具列按鈕物件的指標。

### <a name="return-value"></a>傳回值

工具列按鈕內部清單中的*pButton*索引;如果指定的按鈕不在此工具列上, 則為-1。

##  <a name="calcfixedlayout"></a>CMFCToolBar:: CalcFixedLayout

計算工具列的水準大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*bStretch*<br/>
在TRUE 會將工具列延展到父框架的大小。

*bHorz*<br/>
在TRUE 表示水準方向工具列;FALSE 表示垂直方向工具列。

### <a name="return-value"></a>傳回值

指定工具列大小的物件。`CSize`

### <a name="remarks"></a>備註

這個方法會使用`CMFCToolBar::CalcLayout`方法來計算工具列的大小。 如果*bStretch*為 TRUE, 它會傳遞*DWMODE*參數的 LM_STRETCH 旗標。 如果*bHorz*為 TRUE, 它會傳遞 LM_HORZ 旗標。

如需使用此方法的範例, 請參閱 VisualStudioDemo 範例。

##  <a name="calcmaxbuttonheight"></a>CMFCToolBar:: CalcMaxButtonHeight

計算工具列中按鈕的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>傳回值

按鈕的最大高度。

### <a name="remarks"></a>備註

這個方法會計算工具列上所有工具列按鈕之間的最大高度。 高度可能會因各種因素 (例如目前工具列停駐狀態) 而有所不同。

在衍生自`CMFCToolBar`的類別中覆寫這個方法, 以提供您自己的高度計算。

##  <a name="calcsize"></a>CMFCToolBar:: CalcSize

由架構在版面配置計算過程中呼叫。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>參數

*bVertDock*<br/>
在TRUE 表示要以垂直方式停駐工具列;FALSE 表示工具列會水準停駐。

### <a name="return-value"></a>傳回值

`CSize`物件, 指定工具列上按鈕的整體大小。

### <a name="remarks"></a>備註

這個方法會考慮會影響每個按鈕大小的屬性, 例如文字標籤的區域和框線大小。

如果工具列不包含任何按鈕, 這個方法會使用[CMFCToolBar:: GetButtonSize](#getbuttonsize)方法傳回單一按鈕的保留大小。

##  <a name="canbeclosed"></a>CMFCToolBar:: CanBeClosed

指定使用者是否可以關閉工具列。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>傳回值

如果使用者可以關閉工具列, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法, 以判斷使用者是否可以關閉工具列。 如果方法傳回 TRUE, 則架構會在工具列的 [系統] 功能表中啟用 [SC_CLOSE] 命令, 而使用者可以使用 [自訂] 對話方塊中工具列清單中的核取方塊來關閉工具列。

預設的實值會傳回 TRUE。 在衍生自`CMFCToolBar`的類別中覆寫這個方法, 以建立使用者無法關閉的工具列物件。

##  <a name="canberestored"></a>CMFCToolBar:: CanBeRestored

判斷系統是否可以在自訂之後, 將工具列還原成其原始狀態。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>傳回值

如果可以從應用程式資源還原工具列, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

此架構會呼叫這個方法, 以判斷工具列是否可以在自訂之後回到其原始狀態。 原始狀態會從應用程式資源載入。

如果`CanBeRestored`傳回 TRUE, 則 [自訂] 對話方塊的 [**工具列**] 頁面會啟用所選工具列的 [**重設**] 按鈕。

如果載入工具列的原始資源識別碼為非零, 則預設的執行會傳回 TRUE。 通常只能還原使用者定義的工具列。

您可以覆寫`CanBeRestored`方法, 在衍生類別中自訂此行為。

##  <a name="canfocus"></a>CMFCToolBar:: CanFocus

指定窗格是否可以接收焦點。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法會覆寫基類實[CBasePane:: CanFocus](../../mfc/reference/cbasepane-class.md#canfocus), 因為工具列物件無法接收焦點。

##  <a name="canhandlesiblings"></a>CMFCToolBar:: CanHandleSiblings

決定是否工具列和其同層級位於相同的窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>傳回值

如果工具列有一個同級和工具列, 而它的兄弟位於相同的窗格上, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

Internal CMFCCustomizeButton:: CreatePopupMenu 方法會呼叫這個方法, 以決定如何顯示 [**自訂**] 快顯功能表。 如果這個方法傳回 TRUE, 則架構會顯示**在一個資料列上顯示按鈕**, 或在**兩個數據列按鈕上顯示按鈕**。

您通常不需要使用這個方法。 若要啟用出現在工具列上的 [**自訂**] 按鈕, 請呼叫[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)方法。 若要啟用 [**在一個資料列上顯示按鈕**] 或 [**在兩個數據列上顯示按鈕**] 按鈕, 請呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar)。

##  <a name="cleanupimages"></a>CMFCToolBar:: CleanUpImages

釋放配置給工具列影像的系統資源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>備註

當應用程式關閉時, 架構會呼叫這個方法。

##  <a name="cleanuplockedimages"></a>CMFCToolBar:: CleanUpLockedImages

釋放配置給鎖定工具列影像的系統資源。

```
void CleanUpLockedImages();
```

### <a name="remarks"></a>備註

當您應用程式的視覺化樣式變更時, 請呼叫這個方法。 如需使用此方法的範例, 請參閱 VisualStudioDemo 範例。

##  <a name="commandtoindex"></a>CMFCToolBar:: CommandToIndex

使用指定的命令識別碼, 傳回工具列中按鈕的索引。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>參數

*nIDFind*<br/>
在指定命令識別碼。

*iIndexFirst*<br/>
在指定要開始的初始索引。

### <a name="return-value"></a>傳回值

如果方法成功, 則為工具列按鈕以零為基底的索引;如果沒有具有指定識別碼的按鈕, 則為-1。

### <a name="remarks"></a>備註

`CMFCToolBar`物件會維護工具列上按鈕的內部清單。 呼叫此函式可在指定按鈕的命令識別碼的情況下, 抓取清單中按鈕的索引。

如果*iIndex*大於 0, 這個方法會忽略工具列上索引小於*iIndex*的任何按鈕。

##  <a name="create"></a>CMFCToolBar:: Create

建立 `CMFCToolBar` 物件。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pParentWnd*<br/>
在工具列父視窗的指標。

*dwStyle*<br/>
在工具列樣式。 如需樣式清單, 請參閱 Windows SDK 中的[工具列控制項和按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*nID*<br/>
在工具列之子視窗的識別碼。

### <a name="return-value"></a>傳回值

如果此方法成功, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會建立控制列, 並將它附加至工具列。 它會使用 TBSTYLE_FLAT 樣式建立控制列。 如果您想要不同的控制列樣式, 請呼叫[CMFCToolBar:: CreateEx](#createex) 。

##  <a name="createex"></a>CMFCToolBar:: CreateEx

建立使用其他樣式選項的物件,例如大型圖示。`CMFCToolBar`

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pParentWnd*<br/>
在工具列父視窗的指標。

*dwCtrlStyle*<br/>
在用來建立內嵌控制列物件的其他樣式。

*dwStyle*<br/>
在工具列樣式。 如需適當樣式的清單, 請參閱[工具列控制項和按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*rcBorders*<br/>
在`CRect`物件, 指定工具列視窗框線的寬度。

*nID*<br/>
在工具列之子視窗的識別碼。

### <a name="return-value"></a>傳回值

若此方法成功, 則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法會建立控制列, 並將它附加至工具列。

當您想要提供特定樣式時, 請呼叫這個方法, 而不是[CMFCToolBar:: Create](#create) 。 例如, 將*dwCtrlStyle*設定為 TBSTYLE_FLAT |TBSTYLE_TRANSPARENT 來建立類似 Internet Explorer 4 所使用工具列的工具列。

### <a name="example"></a>範例

下列範例示範如何使用`CreateEx` `CMFCToolBar`類別的方法。 此程式碼片段是[IE 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="deactivate"></a>CMFCToolBar::D eactivate

停用工具列。

```
virtual void Deactivate();
```

### <a name="remarks"></a>備註

這個方法會停用工具列, 其方式是從反白顯示的工具列按鈕移除焦點。 當工具列失去焦點或終結時, 架構會呼叫這個方法。

##  <a name="dopaint"></a>CMFCToolBar::D oPaint

重新繪製工具列。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

### <a name="remarks"></a>備註

當工具列的一部分必須重新繪製時, 架構會呼叫這個方法。

覆寫這個方法, 以自訂衍生自之`CMFCToolBar`物件的外觀。

##  <a name="drawbutton"></a>CMFCToolBar::D rawButton

重新繪製工具列按鈕。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

*pButton*<br/>
在要繪製之按鈕的指標。

*pImages*<br/>
在工具列影像的指標。

*bHighlighted*<br/>
在如果按鈕已反白顯示, 則為 TRUE;否則為 FALSE。

*bDrawDisabledImages*<br/>
在如果停用的按鈕呈現灰色, 則為 TRUE;否則為 FALSE。

### <a name="return-value"></a>傳回值

如果已重新繪製按鈕, 則為 TRUE;如果按鈕已隱藏, 則為 FALSE。

### <a name="remarks"></a>備註

當您必須重新繪製工具列按鈕時, [CMFCToolBar::D rawbutton](#drawbutton)方法會呼叫這個方法。

如果您想要自訂工具列上按鈕的外觀, 請覆寫這個方法。

##  <a name="drawseparator"></a>CMFCToolBar::D rawSeparator

在工具列上重新繪製分隔符號。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

*rect*<br/>
在繪製分隔符號之位置的周框 (以圖元為單位)。

*bHorz*<br/>
在如果分隔符號是水準的, 則為 TRUE, 如果分隔符號是垂直, 則為 FALSE。

### <a name="remarks"></a>備註

[CMFCToolBar::D opaint](#dopaint)會針對具有 TBBS_SEPARATOR 樣式的每個[CMFCToolBar::D rawseparator](#drawseparator)物件呼叫這個方法, 而不是針對那些按鈕呼叫[CMFCToolBar::D rawbutton](#drawbutton) 。

在衍生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)的類別中覆寫這個方法, 以自訂工具列上分隔符號的外觀。 預設的實值會呼叫[CMFCVisualManager:: OnDrawSeparator](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)來繪製一個分隔符號, 其外觀是由目前的視覺管理員所決定。

##  <a name="enablecustomizebutton"></a>CMFCToolBar:: EnableCustomizeButton

啟用或停用出現在工具列上的 [自訂] 按鈕。

```
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在啟用或停用 [自訂] 按鈕。

*iCustomizeCmd*<br/>
在[自訂] 按鈕的命令 ID。

*strCustomizeText*<br/>
在[自訂] 按鈕的文字標籤。

*uiCustomizeTextResId*<br/>
在自訂按鈕標籤的資源字串識別碼。

*bQuickCustomize*<br/>
在啟用或停用功能表上從按鈕下拉的 [**新增或移除按鈕**] 選項。

### <a name="remarks"></a>備註

如果*iCustomizeCmd*為-1, 當工具列區域無法容納多個工具列按鈕時, 架構會顯示 [自訂] 按鈕。 按鈕會顯示雙向左箭號或燕號, 表示有更多按鈕。

如果*iCustomizeCmd*指定有效的命令識別碼, 而*bEnable*為 TRUE, 則一律會顯示 [自訂] 按鈕。 按鈕具有小型向下箭號, 並開啟包含命令的功能表。 此命令會使用*strCustomizeText*所指定的文字標籤。 如果*bQuickCustomize*也為 TRUE, 則功能表會顯示 [**新增或移除按鈕**] 選項。

架構會在*iCustomizeCmd*所指定的專案之前, 以動態方式將工具列區域中無法容納的任何按鈕新增至功能表。 向下箭號旁會顯示燕號。

##  <a name="enabledocking"></a>CMFCToolBar:: EnableDocking

啟用將窗格停駐到主框架。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>參數

*dwAlignment*<br/>
在指定要啟用的停駐對齊。

### <a name="remarks"></a>備註

這個方法會藉由將`CBasePane::m_dwControlBarStyle`資料成員設定為 AFX_CBRS_FLOAT, 來擴充基類的實值 ( [CBasePane:: EnableDocking](../../mfc/reference/cbasepane-class.md#enabledocking))。 然後, 這個方法會將*dwAlignment*傳遞給基類的執行。

##  <a name="enablelargeicons"></a>CMFCToolBar:: EnableLargeIcons

啟用或停用工具列按鈕上的大圖示。

```
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用大圖示, FALSE 表示停用大型圖示。

### <a name="remarks"></a>備註

根據預設, 會啟用大型圖示。

##  <a name="enablequickcustomization"></a>CMFCToolBar:: EnableQuickCustomization

啟用或停用工具列的快速自訂, 讓使用者可以按**Alt**鍵並將按鈕拖曳到新的位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示要啟用快速自訂, FALSE 則會停用快速自訂。

##  <a name="enablereflections"></a>CMFCToolBar:: EnableReflections

啟用或停用命令反映。

```
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在TRUE 表示啟用命令反映;FALSE 表示停用命令反映。

### <a name="remarks"></a>備註

呼叫這個方法, 針對包含內嵌控制項的工具列按鈕 (例如下拉式方塊) 啟用命令反映。

如需命令反映的詳細資訊, [請參閱 TN062:Windows 控制項](../../mfc/tn062-message-reflection-for-windows-controls.md)的訊息反映。

##  <a name="enabletextlabels"></a>CMFCToolBar:: EnableTextLabels

啟用或停用工具列按鈕影像底下的文字標籤。

```
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
如果文字標籤出現在工具列按鈕影像底下, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果文字標籤已啟用, 工具列上的所有按鈕都會放大, 以提供空間讓標籤顯示在影像下方。 [自訂] 對話方塊在 [**工具列**] 頁面上有 [**顯示文字標籤**] 核取方塊。 當使用者選取工具列並檢查此選項時, 架構會呼叫`EnableTextLabels`所選工具列的。 您可以從[CMFCToolBar:: AllowChangeTextLabels](#allowchangetextlabels)傳回 FALSE, 以停用衍生自[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)之物件的核取方塊。

##  <a name="fromhandlepermanent"></a>CMFCToolBar:: FromHandlePermanent

抓取`CMFCToolBar`物件的指標, 其中包含指定的視窗控制碼。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>參數

*hwnd*<br/>
在要尋找的視窗控制碼。

### <a name="return-value"></a>傳回值

`CMFCToolBar`物件的指標, 其中包含指定的視窗控制碼, 如果沒有對應`CMFCToolBar`的物件存在, 則為 Null。

### <a name="remarks"></a>備註

這個共用方法會檢查應用程式`CMFCToolBar`中包含給定視窗控制碼之物件的每個工具列。

##  <a name="getallbuttons"></a>CMFCToolBar:: GetAllButtons

傳回工具列中的唯讀按鈕清單。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>傳回值

[CObList 類別](../../mfc/reference/coblist-class.md)物件的常數參考, 其中包含[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件的集合。

##  <a name="getalltoolbars"></a>CMFCToolBar:: GetAllToolbars

傳回應用程式中所有工具列的唯讀清單。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>傳回值

包含物件集合之`CMFCToolBar` [CObList 類別](../../mfc/reference/coblist-class.md)物件的 const 參考。

##  <a name="getbasiccommands"></a>CMFCToolBar:: GetBasicCommands

傳回應用程式中定義之基本命令的唯讀清單。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>傳回值

[CList 類別](../../mfc/reference/clist-class.md)物件的 const 參考, 其中包含基本命令的集合。

### <a name="remarks"></a>備註

藉由呼叫[CMFCToolBar:: AddBasicCommand](#addbasiccommand)或[CMFCToolBar:: SetBasicCommands](#setbasiccommands)來新增基本命令。

##  <a name="getbutton"></a>CMFCToolBar:: GetButton

傳回位於指定索引處之[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件的指標。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>參數

*iIndex*<br/>
在指定要傳回之按鈕的索引。

### <a name="return-value"></a>傳回值

工具列按鈕的指標 (如果有的話);如果沒有這類按鈕, 則為 Null。

##  <a name="getbuttoninfo"></a>CMFCToolBar:: GetButtonInfo

傳回指定索引之按鈕的命令識別碼、樣式和影像索引。

```
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在在工具列上的按鈕清單中指定按鈕的索引。

*nID*<br/>
脫銷按鈕的命令 ID。

*nStyle*<br/>
脫銷按鈕的樣式。

*iImage*<br/>
脫銷按鈕影像的索引。

### <a name="remarks"></a>備註

`GetButtonInfo`方法會在指定的索引處尋找工具列按鈕, 並抓取按鈕的命令 ID、樣式和影像索引。

如果指定索引處的按鈕不存在, 架構會將*nID*和*nStyle*設定為 0, 並在方法傳回時, 將*iImage*設為-1。

##  <a name="getbuttonsize"></a>CMFCToolBar:: GetButtonSize

傳回工具列上每個按鈕的維度。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

[CSize 類別](../../atl-mfc-shared/reference/csize-class.md)物件, 指定工具列上每個按鈕的維度。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetSizes](#setsizes)或[CMFCToolBar:: SetLockedSizes](#setlockedsizes) , 以設定工具列上每個按鈕的維度。

##  <a name="getbuttonstyle"></a>CMFCToolBar:: GetButtonStyle

傳回位於指定索引之工具列按鈕的目前樣式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

值, 指定工具列按鈕的樣式。 . 如需可能樣式的清單, 請參閱[工具列控制項樣式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetButtonStyle](#setbuttonstyle)以設定工具列按鈕的樣式

##  <a name="getbuttontext"></a>CMFCToolBar:: GetButtonText

傳回具有指定索引之按鈕的文字標籤。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在工具列按鈕的索引。

*rString*<br/>
脫銷工具列按鈕的標籤文字。

### <a name="return-value"></a>傳回值

工具列按鈕的標籤文字。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetButtonText](#setbuttontext)或[CMFCToolBar:: SetToolBarBtnText](#settoolbarbtntext)以設定文字標籤。

##  <a name="getcoldimages"></a>CMFCToolBar:: GetColdImages

傳回應用程式中冷工具列按鈕影像集合的指標。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>傳回值

冷工具列按鈕影像集合的指標。

### <a name="remarks"></a>備註

「冷影像」是當使用者未與工具列按鈕互動時所使用的影像。 呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)或[CMFCToolBar:: LoadBitmap](#loadbitmap)以載入冷影像。

##  <a name="getcolumnwidth"></a>CMFCToolBar:: GetColumnWidth

傳回工具列按鈕的寬度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>傳回值

值, 指定工具列按鈕的寬度。

### <a name="remarks"></a>備註

架構會呼叫這個方法來計算工具列版面配置。 覆寫衍生類別中的這個方法, 以指定工具列的不同資料行寬度。

##  <a name="getcommandbuttons"></a>CMFCToolBar:: GetCommandButtons

從應用程式中的所有工具列, 傳回具有指定命令識別碼的按鈕清單。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在按鈕的命令 ID。

*listButtons*<br/>
脫銷接收工具列按鈕清單之[CObList 類別](../../mfc/reference/coblist-class.md)物件的參考。

### <a name="return-value"></a>傳回值

具有指定命令識別碼的按鈕數目。

##  <a name="getcount"></a>CMFCToolBar:: GetCount

傳回工具列上的按鈕和分隔符號數目。

```
int GetCount() const;
```

### <a name="return-value"></a>傳回值

工具列上的按鈕和分隔符號數目。

##  <a name="getcustomizebutton"></a>CMFCToolBar:: GetCustomizeButton

抓取與工具列相關聯`CMFCCustomizeButton`之物件的指標。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>傳回值

與工具列相關聯`CMFCCustomizeButton`之物件的指標。

### <a name="remarks"></a>備註

這個方法會抓取出現在工具列結尾處的 [**自訂**] 按鈕。 使用[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)方法, 將 [**自訂**] 按鈕新增至您的工具列。

您可以呼叫[CMFCToolBar:: IsExistCustomizeButton](#isexistcustomizebutton)方法, 以判斷工具列是否包含有效`CMFCCustomizeButton`的物件。

##  <a name="getdefaultimage"></a>CMFCToolBar:: GetDefaultImage

傳回具有指定命令識別碼之工具列按鈕的預設影像索引。

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>參數

*uiID*<br/>
在指定按鈕的命令 ID。

### <a name="return-value"></a>傳回值

共用影像清單中工具列影像的索引。

### <a name="remarks"></a>備註

使用此共用方法, 以指定的命令識別碼, 抓取工具列按鈕的預設影像索引。 傳回值是應用程式中所有工具列之 [共用] 工具列按鈕影像集合的索引。 呼叫[CMFCToolBar:: GetImages](#getimages)方法, 以取得此集合的指標。

##  <a name="getdisabledimages"></a>CMFCToolBar:: GetDisabledImages

傳回用於應用程式中停用的工具列按鈕之影像集合的指標。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>傳回值

已停用工具列按鈕影像之集合的指標。

### <a name="remarks"></a>備註

使用[CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)和[CMFCToolBar:: LoadBitmap](#loadbitmap)方法, 載入停用的工具列按鈕影像。

##  <a name="getdisabledmenuimages"></a>CMFCToolBar:: GetDisabledMenuImages

傳回用來在應用程式中停用的功能表按鈕之影像集合的指標。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>傳回值

已停用功能表影像之集合的指標。

### <a name="remarks"></a>備註

使用[CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法, 載入已停用的映射。

##  <a name="getdroppeddownmenu"></a>CMFCToolBar:: GetDroppedDownMenu

抓取目前顯示其子功能表的功能表按鈕物件指標。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>參數

*pIndex*<br/>
脫銷接收工具列按鈕集合中按鈕的索引。

### <a name="return-value"></a>傳回值

顯示其子功能表的功能表按鈕物件指標, 如果沒有功能表顯示其子功能表, 則為 Null。

### <a name="remarks"></a>備註

如果這個方法傳回非 Null 值, 而且*pIndex*不是 null, 則*pIndex*所指向的值會設定為工具列按鈕集合中功能表按鈕的索引。

##  <a name="getgraydisabledbuttons"></a>CMFCToolBar:: GetGrayDisabledButtons

指定停用按鈕的影像是否為一般按鈕影像的暗灰色版本, 或從已停用按鈕影像的集合中取得。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>傳回值

TRUE 表示將已停用按鈕的影像變暗;FALSE 表示從已停用的影像集合中取得影像。

### <a name="remarks"></a>備註

使用[CMFCToolBar:: SetGrayDisabledButtons](#setgraydisabledbuttons)從已停用影像的集合中切換暗灰色影像和影像。

##  <a name="gethighlightedbutton"></a>CMFCToolBar:: GetHighlightedButton

傳回目前反白顯示之工具列按鈕的指標。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕物件的指標;如果未反白顯示任何按鈕, 則為 Null。

### <a name="remarks"></a>備註

如果工具列按鈕具有鍵盤焦點, 則會反白顯示。 如果工具列按鈕在此應用程式中是熱追蹤的, 工具列按鈕也會反白顯示 (如需詳細資訊, 請參閱[CMFCToolBar:: GetHotBorder](#gethotborder)和[CMFCToolBar:: SetHotBorder](#sethotborder)), 而滑鼠會在沒有工具列按鈕時指向它功能表項目具有鍵盤焦點。

##  <a name="gethotborder"></a>CMFCToolBar:: GetHotBorder

決定工具列按鈕是否會進行*熱追蹤*。 如果按鈕是熱追蹤的, 當滑鼠移到它的上方時, 會反白顯示。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕是熱追蹤, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

根據預設, 工具列按鈕會受到熱追蹤。

##  <a name="gethottextcolor"></a>CMFCToolBar:: GetHotTextColor

傳回反白顯示之工具列按鈕的文字色彩。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>傳回值

[COLORREF](/windows/win32/gdi/colorref)值, 表示目前反白顯示的文字色彩。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetHotTextColor](#sethottextcolor) , 為反白顯示的工具列按鈕設定新的文字色彩。

##  <a name="gethwndlastfocus"></a>CMFCToolBar:: GetHwndLastFocus

傳回視窗的控制碼, 其中的輸入焦點剛好在工具列的前面。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>傳回值

不是衍生自[CMFCBaseToolBar 類別](../../mfc/reference/cmfcbasetoolbar-class.md)的視窗控制碼, 其先前具有輸入焦點;如果沒有這種視窗, 則為 Null。

### <a name="remarks"></a>備註

`CMFCToolBar`當控制項收到輸入焦點時, 它會將控制碼儲存到遺失焦點的視窗, 以便稍後還原。

##  <a name="getignoresettext"></a>CMFCToolBar:: GetIgnoreSetText

指定是否忽略設定按鈕標籤的呼叫。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>傳回值

如果忽略設定按鈕標籤的呼叫, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="getimages"></a>CMFCToolBar:: GetImages

傳回應用程式中預設按鈕影像集合的指標。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>傳回值

[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)物件的指標, 其中包含應用程式中所有工具列的預設影像集合。

### <a name="remarks"></a>備註

這個共用的方法可讓您存取應用程式之所有預設工具列影像的集合。 呼叫[CMFCToolBar:: LoadBitmap](#loadbitmap)方法, 將影像新增至集合。

##  <a name="getimagesize"></a>CMFCToolBar:: GetImageSize

傳回工具列按鈕影像的目前大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>傳回值

代表工具列按鈕影像目前大小的[CSize 類別](../../atl-mfc-shared/reference/csize-class.md)物件。

##  <a name="getimagesoffset"></a>CMFCToolBar:: GetImagesOffset

傳回索引位移, 用來在工具列按鈕影像的全域清單中尋找此工具列的工具列按鈕影像。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>傳回值

工具列影像的索引位移。

### <a name="remarks"></a>備註

所有工具列預設影像都會儲存在全域[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)清單中。 工具列中每個按鈕的影像都會以連續方式儲存在該清單中。 若要計算影像的索引, 請將工具列中按鈕的索引新增至該工具列按鈕影像清單開頭的位移。

呼叫[CMFCToolBar:: ButtonToIndex](#buttontoindex) , 以在指定按鈕的指標時取得工具列按鈕的索引。

呼叫[CMFCToolBar:: GetImages](#getimages)以取得工具列影像集合的指標。

##  <a name="getinvalidateitemrect"></a>CMFCToolBar:: GetInvalidateItemRect

抓取工作區的區域, 該區域必須針對指定索引處的按鈕重新繪製。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[in]要擷取工作區按鈕的索引。

*lpRect*<br/>
脫銷會接收工作區區域之 RECT 物件的指標。

### <a name="remarks"></a>備註

*LpRect*參數不得為 Null。 如果提供的索引處沒有任何按鈕, *lpRect*會接收初始化為零的 RECT 物件。

##  <a name="getitemid"></a>CMFCToolBar:: GetItemID

傳回位於指定索引之工具列按鈕的命令 ID。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

工具列按鈕的命令 ID。如果具有指定索引的按鈕不存在, 則為零。

##  <a name="getitemrect"></a>CMFCToolBar:: GetItemRect

傳回位於指定索引之按鈕的周框。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在指定工具列按鈕的索引。

*lpRect*<br/>
脫銷物件的指標`CRect` , 可接收影像周框矩形的座標。

### <a name="remarks"></a>備註

如果`CRect`指定索引處的按鈕不存在, *lpRect*點會設定為0的物件。

### <a name="example"></a>範例

下列範例示範如何使用`GetItemRect` `CMFCToolBar`類別的方法。 此程式碼片段是[IE 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

##  <a name="getlargecoldimages"></a>CMFCToolBar:: GetLargeColdImages

傳回應用程式中大型冷工具列按鈕影像集合的指標。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>傳回值

大型冷影像集合的指標。

### <a name="remarks"></a>備註

「冷影像」是當使用者未與工具列按鈕互動時所使用的影像。 呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)以載入大型冷影像。

##  <a name="getlargedisabledimages"></a>CMFCToolBar:: GetLargeDisabledImages

傳回應用程式中大型停用工具列按鈕影像集合的指標。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>傳回值

大型停用工具列按鈕影像集合的指標。

### <a name="remarks"></a>備註

大型影像是標準工具列按鈕影像的大型版本。 呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)或[CMFCToolBar:: LoadBitmap](#loadbitmap)以載入大型影像。

##  <a name="getlargeimages"></a>CMFCToolBar:: GetLargeImages

傳回應用程式中大型工具列按鈕影像集合的指標。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>傳回值

大型工具列按鈕影像集合的指標。

### <a name="remarks"></a>備註

大型影像是標準工具列按鈕影像的大型版本。 呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)以載入大型影像。

##  <a name="getlockedcoldimages"></a>CMFCToolBar:: GetLockedColdImages

傳回工具列中鎖定冷影像集合的指標。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>傳回值

鎖定之冷影像集合的指標, 如果工具列未鎖定, 則為 Null。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時, 架構所使用之一般工具列按鈕影像的版本。 「冷影像」是當使用者未與工具列按鈕互動時所使用的影像。

如果工具列未鎖定, 這個方法會傳回 Null。 如果工具列未鎖定, 這個方法也會在 Debug 組建中產生判斷提示失敗。 如需鎖定工具列的詳細資訊, 請參閱[CMFCToolBar:: IsLocked](#islocked)。

呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)方法, 以載入鎖定的冷影像。

##  <a name="getlockeddisabledimages"></a>CMFCToolBar:: GetLockedDisabledImages

傳回工具列中已鎖定之已停用影像集合的指標。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>傳回值

已鎖定之影像集合的指標, 如果工具列未鎖定, 則為 Null。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時, 架構所使用之一般工具列按鈕影像的版本。 已停用的影像是當按鈕具有 TBBS_DISABLED 樣式時, 架構所使用的影像。

如果工具列未鎖定, 這個方法會傳回 Null。 如果工具列未鎖定, 這個方法也會在 Debug 組建中產生判斷提示失敗。 如需鎖定工具列的詳細資訊, 請參閱[CMFCToolBar:: IsLocked](#islocked)。

呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)方法, 以載入已鎖定的已停用映射。

##  <a name="getlockedimages"></a>CMFCToolBar:: GetLockedImages

傳回工具列中已鎖定按鈕影像集合的指標。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>傳回值

鎖定的工具列按鈕影像之集合的指標, 如果工具列未鎖定, 則為 Null。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時, 架構所使用之一般工具列按鈕影像的版本。

如果工具列未鎖定, 這個方法會傳回 Null。 如果工具列未鎖定, 這個方法也會在 Debug 組建中產生判斷提示失敗。 如需鎖定工具列的詳細資訊, 請參閱[CMFCToolBar:: IsLocked](#islocked)。

##  <a name="getlockedimagesize"></a>CMFCToolBar:: GetLockedImageSize

傳回鎖定工具列影像的預設大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>傳回值

結構, 指定鎖定的工具列影像大小, 如果工具列未鎖定`CSize` , 則為空的結構。 `CSize`

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時, 架構所使用之一般工具列按鈕影像的版本。

如果工具列未鎖定`CSize` , 這個方法會傳回包含零寬度和零高度的結構。 如果工具列未鎖定, 這個方法也會在 Debug 組建中產生判斷提示失敗。 如需鎖定工具列的詳細資訊, 請參閱[CMFCToolBar:: IsLocked](#islocked)。

呼叫[CMFCToolBar:: SetLockedSizes](#setlockedsizes)方法來指定鎖定的影像大小。

##  <a name="getlockedmenuimages"></a>CMFCToolBar:: GetLockedMenuImages

傳回工具列中鎖定的工具列功能表影像之集合的指標。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>傳回值

鎖定的工具列功能表影像之集合的指標, 如果工具列未鎖定, 則為 Null。

### <a name="remarks"></a>備註

鎖定的影像是當使用者無法自訂工具列時, 架構所使用之一般工具列功能表影像的版本。

如果工具列未鎖定, 這個方法會傳回 Null。 如果工具列未鎖定, 這個方法也會在 Debug 組建中產生判斷提示失敗。 如需鎖定工具列的詳細資訊, 請參閱[CMFCToolBar:: IsLocked](#islocked)。

呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)方法, 以載入鎖定的功能表影像。

##  <a name="getmenubuttonsize"></a>CMFCToolBar:: GetMenuButtonSize

傳回應用程式中的功能表按鈕大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>傳回值

`CSize`物件, 表示功能表按鈕的大小 (以圖元為單位)。

### <a name="remarks"></a>備註

工具列上的功能表按鈕大小會保留為全域變數, 而且可以由此靜態方法抓取。

呼叫[CMFCToolBar:: SetMenuSizes](#setmenusizes)以設定此全域變數。

##  <a name="getmenuimages"></a>CMFCToolBar:: GetMenuImages

傳回應用程式中功能表按鈕影像集合的指標。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>傳回值

功能表影像集合的指標。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)方法以載入功能表影像。

呼叫[CMFCToolBar:: SetMenuSizes](#setmenusizes)方法, 以設定按鈕和其影像的大小。

##  <a name="getmenuimagesize"></a>CMFCToolBar:: GetMenuImageSize

傳回應用程式中功能表按鈕影像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>傳回值

`CSize`物件, 代表功能表影像的大小。

### <a name="remarks"></a>備註

這個方法會傳回工具列功能表按鈕上以全域變數形式維護的影像大小。 呼叫[CMFCToolBar:: SetMenuSizes](#setmenusizes)以設定此全域變數。

##  <a name="getorigbuttons"></a>CMFCToolBar:: GetOrigButtons

抓取工具列的非自訂按鈕集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>傳回值

工具列之非自訂按鈕清單的參考。

### <a name="remarks"></a>備註

架構會在使用者自訂工具列按鈕之前, 先建立一個複本。 [CMFCToolBar:: SetButtons](#setbuttons)方法會將所提供陣列中每個按鈕的複本加入至原始按鈕清單。 [CMFCToolBar:: RestoreOriginalState](#restoreoriginalstate)方法會從資源檔載入, 以還原工具列的原始狀態。

若要設定工具列的原始按鈕清單, 請呼叫[CMFCToolBar:: SetOrigButtons](#setorigbuttons)方法。

##  <a name="getorigresetbuttons"></a>CMFCToolBar:: GetOrigResetButtons

抓取工具列的非自訂重設按鈕集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>傳回值

工具列之非自訂重設按鈕清單的參考。

### <a name="remarks"></a>備註

當使用者在自訂模式期間按一下 [**重設**] 按鈕時, 架構會使用這個方法來還原從工具列移除的按鈕。

[CMFCToolBar:: SetButtons](#setbuttons)方法會在呼叫[CMFCToolBar:: OnReset](#onreset)方法之後, 將每個工具列按鈕的複本加入至原始重設按鈕的清單。 您可以覆寫[CMFCToolBar:: OnReset](#onreset)方法, 以自訂使用者按下 [**重設**] 按鈕之後的按鈕外觀。

##  <a name="getresourceid"></a>CMFCToolBar:: GetResourceID

抓取工具列的資源識別碼。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>傳回值

工具列的資源識別碼。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: LoadToolBarEx](#loadtoolbarex)方法, 以設定工具列的資源識別碼。

##  <a name="getroutecommandsviaframe"></a>CMFCToolBar:: GetRouteCommandsViaFrame

判斷哪個物件 (父框架或擁有者) 會將命令傳送至工具列。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>傳回值

如果父框架會將命令傳送至工具列, 則為非零。如果擁有者將命令傳送至工具列, 則為0。

### <a name="remarks"></a>備註

根據預設, 父框架會將命令傳送至工具列。 呼叫[CMFCToolBar:: SetRouteCommandsViaFrame](#setroutecommandsviaframe)以變更此行為。

如果這個方法傳回非零值, 您可以使用`CMFCToolBar::GetCommandTarget`方法來抓取父框架物件的指標。 如需使用此方法的範例, 請參閱 VisualStudioDemo 範例。

##  <a name="getrowheight"></a>CMFCToolBar:: GetRowHeight

傳回工具列按鈕的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕的高度 (以圖元為單位)。

### <a name="remarks"></a>備註

架構會呼叫這個方法來計算工具列版面配置。 覆寫衍生類別中的這個方法, 以指定工具列的不同高度。

##  <a name="getshowtooltips"></a>CMFCToolBar:: GetShowTooltips

指定是否要顯示工具列按鈕的工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>傳回值

如果工具列按鈕顯示工具提示, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

預設會顯示工具提示。 您可以藉由呼叫[CMFCToolBar:: SetShowTooltips](#setshowtooltips)來變更此靜態旗標。

##  <a name="getsiblingtoolbar"></a>CMFCToolBar:: GetSiblingToolBar

抓取工具列的兄弟。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>傳回值

同級工具列的指標。

### <a name="remarks"></a>備註

如需如何啟用**一個資料列上**的 [顯示] 按鈕和 [**在兩個數據列上顯示按鈕**] 按鈕的詳細資訊, 請參閱[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar)。

##  <a name="getuserimages"></a>CMFCToolBar:: GetUserImages

傳回應用程式中使用者定義的工具列按鈕影像集合的指標。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>傳回值

應用程式中所有工具列的使用者定義工具列按鈕影像集合的指標。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetUserImages](#setuserimages)方法, 以在應用程式中設定使用者定義影像的集合。

##  <a name="hittest"></a>CMFCToolBar:: HitTest

傳回位於指定位置之工具列按鈕的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>參數

*point*<br/>
在要測試的點 (以工作區座標表示)。

### <a name="return-value"></a>傳回值

位於指定位置之按鈕的索引, 如果沒有這類按鈕或按鈕是分隔符號, 則為-1。

##  <a name="insertbutton"></a>CMFCToolBar:: InsertButton

在工具列中插入按鈕。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>參數

*button*<br/>
在指定要插入的按鈕。

*iInsertAt*<br/>
在指定要在其上插入按鈕之以零為基底的位置。

### <a name="return-value"></a>傳回值

插入按鈕的位置, 如果發生錯誤, 則為-1。

### <a name="remarks"></a>備註

如果*iInsertAt*為-1, 這個方法會將按鈕新增至工具列按鈕清單的尾端。

呼叫[CMFCToolBar:: InsertSeparator](#insertseparator)方法, 將分隔符號插入工具列中。

##  <a name="insertseparator"></a>CMFCToolBar:: InsertSeparator

在工具列中插入分隔符號。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>參數

*iInsertAt*<br/>
在指定要插入分隔符號的位置 (以零為基底)。 這個參數必須大於0。

### <a name="return-value"></a>傳回值

插入分隔符號的位置, 如果發生錯誤, 則為-1。

### <a name="remarks"></a>備註

呼叫這個方法, 在兩個現有的按鈕之間插入分隔符號。 如果*iInsertAt*為-1, 這個方法會將分隔符號加入工具列按鈕清單的尾端。

您不能使用這個方法, 將分隔符號加入空白工具列。

呼叫[CMFCToolBar:: InsertButton](#insertbutton)方法, 將按鈕插入工具列中。

##  <a name="invalidatebutton"></a>CMFCToolBar:: InvalidateButton

使存在於所提供索引處之工具列按鈕的工作區失效。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在工具列中按鈕之以零為起始的索引。

### <a name="return-value"></a>傳回值

存在於所提供`CMFCToolBarButton`索引處之物件的指標, 如果沒有這類物件存在, 則為 Null。

### <a name="remarks"></a>備註

當此架構更新與工具列按鈕相關聯的工作區時, 會呼叫這個方法。 它會呼叫[CWnd:: InvalidateRect](../../mfc/reference/cwnd-class.md#invalidaterect)方法, 並搭配存在於所`CMFCToolBarButton`提供索引處之物件的用戶端矩形。

##  <a name="isaddremovequickcustomize"></a>CMFCToolBar:: IsAddRemoveQuickCustomize

決定使用者是否可以使用 [**自訂**] 功能表選項來新增或移除工具列按鈕。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>傳回值

如果使用者可以使用 [**自訂**] 功能表選項來修改工具列, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isaltcustomizemode"></a>CMFCToolBar:: IsAltCustomizeMode

指定是否使用*快速自訂*來拖曳按鈕。 啟用 [快速自訂] 時, 使用者可以按住 ALT 鍵並將按鈕拖曳到新的位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果使用快速自訂來拖曳按鈕, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isautograyinactiveimages"></a>CMFCToolBar:: IsAutoGrayInactiveImages

指定是否啟用自動產生非作用中 (未反白顯示) 的按鈕影像。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>傳回值

如果已啟用自動變暗非作用中影像的選項, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

您可以藉由呼叫[CMFCToolBar:: AutoGrayInactiveImages](#autograyinactiveimages)來啟用或停用非作用中映射自動變暗。

##  <a name="isbasiccommand"></a>CMFCToolBar:: IsBasicCommand

判斷命令是否在基本命令清單中。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果指定的命令屬於基本命令清單, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個靜態方法會判斷*uiCmd*所指定的命令是否屬於基本命令的全域清單。 您可以藉由呼叫[CMFCToolBar:: AddBasicCommand](#addbasiccommand)或[CMFCToolBar:: SetBasicCommands](#setbasiccommands)來變更基本命令的清單。

##  <a name="isbuttonextrasizeavailable"></a>CMFCToolBar:: IsButtonExtraSizeAvailable

決定工具列是否可以顯示具有延伸框線的按鈕。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>傳回值

如果橫條可以顯示具有額外框線大小的按鈕, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果工具列物件可以顯示具有延伸框線的按鈕, 則會傳回 TRUE。 當工具列按鈕處理[CMFCToolBarButton:: OnChangeParentWnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知時, 會呼叫這個方法, 並據以設定其內部額外的框線大小旗標。 稍後可以藉由呼叫[CMFCToolBarButton:: IsExtraSize](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)來抓取此內部旗標。

在衍生自`CMFCToolBar`的類別中覆寫這個方法, 如果您的橫條可以顯示具有額外框線大小的工具列按鈕, 則傳回 TRUE, 否則傳回 FALSE。 預設的實值會傳回 TRUE。

##  <a name="isbuttonhighlighted"></a>CMFCToolBar:: IsButtonHighlighted

決定是否反白顯示指定的按鈕。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>參數

*iButton*<br/>
在指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

如果指定的按鈕反白顯示, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="iscommandpermitted"></a>CMFCToolBar:: IsCommandPermitted

判斷是否允許命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果允許指定的命令, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個靜態方法會判斷*uiCmd*所指定的命令是否屬於非允許命令的全域清單。

您可以藉由呼叫[CMFCToolBar:: SetNonPermittedCommands](#setnonpermittedcommands)來變更不允許的命令清單。

##  <a name="iscommandrarelyused"></a>CMFCToolBar:: IsCommandRarelyUsed

判斷是否很少使用命令。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果指定的命令很少使用, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當`IsCommandRarelyUsed`發生下列一或多個狀況時, 此方法會傳回 FALSE:

- 指定的命令屬於基本命令的清單

- 指定的命令是其中一個標準命令

- 架構處於自訂模式

- 基本命令的清單是空的

- 超過 20% 的命令呼叫會呼叫指定的命令。

##  <a name="iscustomizemode"></a>CMFCToolBar:: IsCustomizeMode

指定工具列架構是否處於自訂模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果架構處於自訂模式, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

您可以藉由呼叫[CMFCToolBar:: SetCustomizeMode](#setcustomizemode)來切換自訂模式。

當使用者叫用 [自訂] 對話方塊 ( [CMFCToolBarsCustomizeDialog 類別](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) 時, 架構會變更模式。

##  <a name="isdragbutton"></a>CMFCToolBar:: IsDragButton

決定是否正在拖曳工具列按鈕。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
在工具列按鈕的指標。

### <a name="return-value"></a>傳回值

如果要拖曳指定的按鈕, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

##  <a name="isexistcustomizebutton"></a>CMFCToolBar:: IsExistCustomizeButton

決定工具列是否包含 [**自訂**] 按鈕。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>傳回值

如果工具列包含 [**自訂**] 按鈕, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果這個方法傳回 TRUE, 則[CMFCToolBar:: GetCustomizeButton](#getcustomizebutton)方法會傳回出現在工具列結尾之 [**自訂**] 按鈕的指標。

使用[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)方法, 將 [**自訂**] 按鈕新增至您的工具列。

##  <a name="isfloating"></a>CMFCToolBar:: IsFloating

決定工具列是否為浮動。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>傳回值

如果工具列是浮動的, 則為 TRUE;否則為 FALSE。

##  <a name="islargeicons"></a>CMFCToolBar:: IsLargeIcons

指定應用程式中的工具列目前是否顯示大型圖示。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>傳回值

如果應用程式使用大型圖示, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar:: SetLargeIcons](#setlargeicons)以在大型圖示和一般圖示之間切換。

當使用者在 [**自訂**] 對話方塊的 [**選項**] 頁面上切換 [**大型圖示**] 核取方塊時, 架構會自動變更模式。

##  <a name="islastcommandfrombutton"></a>CMFCToolBar:: IsLastCommandFromButton

判斷最近執行的命令是否從指定的工具列按鈕傳送。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在按鈕的指標。

### <a name="return-value"></a>傳回值

如果最後一個命令是從*pButton*指定的按鈕傳送, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會藉由呼叫`CWnd::GetCurrentMessage`來取得訊息[結構](/windows/win32/api/winuser/ns-winuser-msg)的指標。 然後, 它會將按鈕的 HWND 與`MSG::lParam`和`MSG::hwnd`成員進行比較, 以判斷按鈕是否為命令的來源。

##  <a name="islocked"></a>CMFCToolBar:: IsLocked

決定工具列是否已鎖定。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>傳回值

如果工具列已鎖定, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當使用者無法執行自訂工作 (例如重新置放工具列按鈕) 時, 這個方法會傳回 TRUE。

鎖定的工具列會使用不同的影像清單。 如需這些影像清單的詳細資訊, 請參閱[CMFCToolBar:: LoadBitmapEx](#loadbitmapex)。

##  <a name="isonerowwithsibling"></a>CMFCToolBar:: IsOneRowWithSibling

決定工具列及其同輩工具列是否位於相同的資料列上。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>傳回值

如果工具列和其兄弟位於相同的資料列上, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

[CMFCCustomizeButton:: CreatePopupMenu](internal-classes.md)方法會呼叫這個方法, 以決定如何顯示 [**自訂**] 快顯功能表。 如果這個方法傳回 TRUE, 則架構會顯示 [**在一個資料列上顯示按鈕**] 按鈕。 否則, 架構會顯示 [**在兩個數據列上顯示按鈕**] 按鈕。

您通常不需要使用這個方法。 若要啟用 [**在一個資料列上顯示按鈕**] 或 [**在兩個數據列上顯示按鈕**] 按鈕, 請呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar)。

##  <a name="isresourcechanged"></a>CMFCToolBar:: IsResourceChanged

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="issibling"></a>CMFCToolBar:: IsSibling

```
BOOL IsSibling();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isuserdefined"></a>CMFCToolBar:: IsUserDefined

指定工具列是否為使用者定義的。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>傳回值

如果工具列是由使用者所建立, 則為 TRUE;否則為 FALSE。

##  <a name="loadbitmap"></a>CMFCToolBar:: LoadBitmap

從應用程式資源載入工具列影像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
在參考熱門工具列影像之點陣圖的資源識別碼。

*uiColdResID*<br/>
在參考冷工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
在參考一般功能表影像之點陣圖的資源識別碼。

*bLocked*<br/>
在TRUE 表示鎖定工具列;否則為 FALSE。

*uiDisabledResID*<br/>
在參考已停用工具列影像之點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
在參考已停用功能表影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

[CMFCToolBar::LoadToolBarEx](#loadtoolbarex) 方法會呼叫這個方法來載入與工具列相關聯的影像。 覆寫這個方法可執行影像資源的自訂載入。

呼叫 `LoadBitmapEx` 方法可在建立工具列之後載入其他影像。

##  <a name="loadbitmapex"></a>CMFCToolBar:: LoadBitmapEx

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>參數

在*params*<br/>
在已*封鎖*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="loadlargeiconsstate"></a>  CMFCToolBar::LoadLargeIconsState

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[in] *lpszProfileName*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="loadparameters"></a>CMFCToolBar:: LoadParameters

從 Windows 登錄載入全域工具列選項。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定 Windows 登錄機碼的相對路徑。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

這個方法會載入全域參數, 例如功能表動畫類型、功能表陰影樣式, 以及是否要顯示 Windows 登錄中的大圖示。

[CWinAppEx:: LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法會在應用程式的初始化處理過程中呼叫這個方法。

##  <a name="loadstate"></a>CMFCToolBar:: LoadState

從 Windows 登錄載入工具列狀態資訊。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定 Windows 登錄機碼的相對路徑。

*nIndex*<br/>
在指定工具列的控制項 ID。

*uiID*<br/>
在指定工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會在應用程式的初始化處理過程中呼叫這個方法。 如需詳細資訊, 請參閱[CWinAppEx:: LoadState](../../mfc/reference/cwinappex-class.md#loadstate)。

##  <a name="loadtoolbar"></a>CMFCToolBar:: LoadToolBar

從應用程式資源載入工具列。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
在工具列的資源識別碼。

*uiColdResID*<br/>
在參考冷工具列影像之點陣圖的資源識別碼。

*uiMenuResID*<br/>
在參考一般功能表影像之點陣圖的資源識別碼。

*bLocked*<br/>
在布林值, 指定工具列是否已鎖定。 如果此參數為*TRUE*, 則工具列會被鎖定。 否則, 工具列不會被鎖定。

*uiDisabledResID*<br/>
在參考已停用工具列影像之點陣圖的資源識別碼。

*uiMenuDisabledResID*<br/>
在參考已停用功能表影像之點陣圖的資源識別碼。

*uiHotResID*<br/>
在參考熱門工具列影像之點陣圖的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會在初始化期間呼叫這個方法, 以載入與工具列相關聯的影像。

### <a name="example"></a>範例

下列範例示範如何`LoadToolBar` `CMFCToolBar`在類別中使用方法。 此程式碼片段是[IE 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

##  <a name="loadtoolbarex"></a>CMFCToolBar:: LoadToolBarEx

使用`CMFCToolBarInfo` helper 類別, 從應用程式資源載入工具列, 讓應用程式使用大型影像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>參數

*uiToolbarResID*<br/>
在工具列的資源識別碼。

*params*<br/>
在`CMFCToolBarInfo`物件的參考, 其中包含工具列影像的資源識別碼。

*bLocked*<br/>
在布林值, 指定工具列是否已鎖定。 如果此參數為 TRUE, 則工具列會被鎖定。 否則, 工具列不會被鎖定。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

呼叫這個方法, 從應用程式資源載入工具列影像。

##  <a name="m_dbllargeimageratio"></a>CMFCToolBar:: m_dblLargeImageRatio

指定大型影像的維度 (高度或寬度) 與一般影像維度之間的比例。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>備註

預設比例為2。 您可以變更這個值, 讓大型工具列影像變大或變小。

當您未指定一組大型影像時, 此架構會使用此資料成員。 例如, 如果您只提供大小為16x16 的小型影像集合, 而且想要讓大型影像具有大小 24x24, 請將此資料成員設定為1.5。

##  <a name="nextmenu"></a>CMFCToolBar:: NextMenu

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onbeforeremovebutton"></a>CMFCToolBar:: OnBeforeRemoveButton

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在未使用.

*dropEffect*<br/>
在未使用.

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onchangehot"></a>CMFCToolBar:: OnChangeHot

當使用者選取工具列上的按鈕時由架構呼叫。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>參數

*iHot*<br/>
在指定所選取工具列按鈕的索引;如果未選取工具列按鈕, 則為-1。

### <a name="remarks"></a>備註

覆寫這個方法, 以處理使用者在工具列上選取按鈕的通知。

##  <a name="onchangevisualmanager"></a>CMFCToolBar:: OnChangeVisualManager

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>備註

##  <a name="onfillbackground"></a>CMFCToolBar:: OnFillBackground

由架構從[CBasePane::D opaint](../../mfc/reference/cbasepane-class.md#dopaint)呼叫以填滿工具列背景。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

### <a name="remarks"></a>備註

[CMFCToolBar:](#dopaint)當工具列的背景已填滿時,:D opaint 會呼叫這個方法。 預設實作不做任何動作。

覆寫這個方法, 以在衍生類別中繪製自訂背景。

##  <a name="onglobalfontschanged"></a>CMFCToolBar:: OnGlobalFontsChanged

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>備註

##  <a name="onreset"></a>CMFCToolBar:: OnReset

將工具列還原成其原始狀態。

```
virtual void OnReset();
```

### <a name="remarks"></a>備註

覆寫這個方法, 以處理有關工具列重設的通知。

預設實作不做任何動作。 當`OnReset`工具列具有虛擬按鈕時`CMFCToolBar` , 在衍生自的類別中覆寫, 當工具列回到其原始狀態時必須予以取代。

##  <a name="onsetaccdata"></a>CMFCToolBar:: OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>參數

[in] *lVal*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onsetdefaultbuttontext"></a>CMFCToolBar:: OnSetDefaultButtonText

將工具列按鈕的文字還原為其預設狀態。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在指向要設定其文字的按鈕。

### <a name="return-value"></a>傳回值

已成功還原 TRUE ifthe 文字;否則為 FALSE。

### <a name="remarks"></a>備註

覆寫這個方法, 以處理工具列按鈕的文字變更為預設值的通知。

預設的執行會從應用程式資源載入按鈕的文字。

##  <a name="onusertooltip"></a>CMFCToolBar:: OnUserToolTip

當按鈕的工具提示即將顯示時由架構呼叫。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
在指向要顯示工具提示的工具列按鈕。

*strTTText*<br/>
脫銷接收工具提示`CString`文字之物件的參考。

### <a name="return-value"></a>傳回值

如果*strTTText*已填入工具提示文字, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當工具列按鈕的工具提示即將顯示時, 架構會呼叫這個方法。 如果`OnUserToolTip` *傳回 TRUE*, 則架構會顯示工具提示, 其中包含 strTTText中所傳回的文字。`OnUserToolTip` 否則, 工具提示會包含按鈕文字。

覆`OnUserToolTip`寫以自訂工具列按鈕的工具提示。 預設的實值會呼叫[CMFCToolBar:: OnUserToolTip](#onusertooltip)以取得工具提示文字。

##  <a name="prevmenu"></a>CMFCToolBar::P revMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="processcommand"></a>CMFCToolBar::P rocessCommand

將 WM_COMMAND 訊息張貼至擁有工具列的視窗。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
在工具列上按鈕的指標。

### <a name="return-value"></a>傳回值

這個方法一律會傳回 TRUE。 MFC 會在內部使用 FALSE 值。

### <a name="remarks"></a>備註

這個方法會藉由呼叫[CWnd::P ostmessage](../../mfc/reference/cwnd-class.md#postmessage)並傳遞指定按鈕的命令 ID 做為*wParam*參數, 將 WM_COMMAND 訊息張貼至擁有工具列的視窗中。

使用[ON_COMMAND](message-map-macros-mfc.md#on_command)宏將 WM_COMMAND 訊息對應至成員函式。

##  <a name="removeallbuttons"></a>CMFCToolBar:: RemoveAllButtons

移除工具列中的所有按鈕和分隔符號。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>備註

架構會在重新建立或終結工具列時呼叫這個方法。

##  <a name="removebutton"></a>CMFCToolBar:: RemoveButton

從工具列中移除具有指定之索引的按鈕。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
在指定要移除之按鈕的以零為基底的索引。

### <a name="return-value"></a>傳回值

如果方法成功, 則為 TRUE, 如果指定的索引無效或索引參考 [**自訂**] 按鈕, 則為 FALSE。

### <a name="remarks"></a>備註

這個方法會更新受到移除按鈕影響的其他工具列屬性。 例如, 這個方法會從工具列移除不必要的分隔符號, 並重建快速鍵的資料表。

如需 [**自訂**] 按鈕的詳細資訊, 請參閱[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)。

##  <a name="removestatefromregistry"></a>CMFCToolBar:: RemoveStateFromRegistry

從 Windows 登錄移除工具欄的狀態資訊。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定狀態資訊所在的登錄機碼。

*nIndex*<br/>
在工具列的控制項 ID。

*uiID*<br/>
在工具列的資源識別碼。 如果此參數為-1, 則這個方法會使用[CWnd:: GetDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法來取出資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會在刪除使用者定義的工具列時呼叫這個方法。

如果您將其他狀態資訊儲存在 Windows 登錄中, 請覆寫此方法。

##  <a name="replacebutton"></a>CMFCToolBar:: ReplaceButton

以另一個工具列按鈕取代工具列按鈕。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>參數

*uiCmd*<br/>
在要取代之按鈕的命令 ID。

*button*<br/>
在要插入之的`CMFCToolBarButton`參考。

*bAll*<br/>
在布林值, 指定是否要取代所有具有*uiCmd*所指定之命令識別碼的按鈕。 如果此參數為 TRUE, 則會取代具有指定命令識別碼的所有按鈕。 否則, 會取代第一個按鈕。

### <a name="return-value"></a>傳回值

已取代的按鈕數目。 如果工具列上不存在具有指定命令識別碼的按鈕, 這個方法會傳回0。

### <a name="remarks"></a>備註

當您想要新增無法從資源載入的工具列按鈕時, 請呼叫這個方法。 當您初始化工具列時, 可以在設計階段建立預留位置按鈕, 並將該按鈕取代為自訂按鈕。 如需使用此方法的範例, 請參閱 VisualStudioDemo 範例。

### <a name="example"></a>範例

下列範例示範如何`ReplaceButton` `CMFCToolBar`在類別中使用方法。 此程式碼片段是[IE 示範範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

##  <a name="resetall"></a>CMFCToolBar:: ResetAll

將所有工具列還原成其原始狀態。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>備註

這個方法會在應用程式中可還原的每個工具列上呼叫[CMFCToolBar:: RestoreOriginalState](#restoreoriginalstate)方法。 它會使用[CMFCToolBar:: CanBeRestored](#canberestored)方法來判斷是否可以還原工具列。

##  <a name="resetallimages"></a>CMFCToolBar:: ResetAllImages

清除應用程式中的所有工具列影像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>備註

這個方法會清除由[CMFCToolBar:: LoadToolBar](#loadtoolbar)和[CMFCToolBar:: LoadBitmap](#loadbitmap)方法初始化的影像集合。

##  <a name="resetimages"></a>CMFCToolBar:: ResetImages

```
virtual void ResetImages();
```

### <a name="remarks"></a>備註

##  <a name="restorefocus"></a>CMFCToolBar:: RestoreFocus

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>備註

##  <a name="restoreoriginalstate"></a>CMFCToolBar:: RestoreOriginalState

還原工具列的原始狀態。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>傳回值

如果方法成功, 則為 TRUE, 如果方法失敗或工具列是使用者定義的, 則為 FALSE。

### <a name="remarks"></a>備註

這個方法會使用[CMFCToolBar:: LoadToolBar](#loadtoolbar)方法, 從資源檔載入工具列。

當使用者在 [自訂] 對話方塊的 [**工具列**] 頁面上選擇 [**全部重設**] 按鈕時, 架構會呼叫這個方法。

##  <a name="saveparameters"></a>CMFCToolBar:: SaveParameters

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[in] *lpszProfileName*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="savestate"></a>CMFCToolBar:: SaveState

將工具列的狀態資訊儲存在 Windows 登錄中。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpszProfileName*<br/>
在指定 Windows 登錄機碼的相對路徑。

*nIndex*<br/>
在工具列的控制項 ID。

*uiID*<br/>
在工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

架構會在將應用程式狀態儲存至登錄時呼叫這個方法。 如需詳細資訊, 請參閱[CWinAppEx:: SaveState](../../mfc/reference/cwinappex-class.md#savestate)。

##  <a name="setbasiccommands"></a>CMFCToolBar:: SetBasicCommands

設定當使用者開啟功能表時, 一律會顯示的命令清單。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
在包含命令集合之`CList`物件的參考。

### <a name="remarks"></a>備註

開啟功能表時, 一律會顯示基本命令。 當使用者選擇觀看最近使用的命令時, 這個方法會有意義。

使用[CMFCToolBar:: AddBasicCommand](#addbasiccommand)方法, 將命令新增至基本命令的清單。 使用[CMFCToolBar:: GetBasicCommands](#getbasiccommands)方法來取出應用程式所使用的基本命令清單。

如需使用此方法的範例, 請參閱 Explorer 範例。

##  <a name="setbuttoninfo"></a>CMFCToolBar:: SetButtonInfo

設定工具列按鈕的命令識別碼、樣式和影像識別碼。

```
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在按鈕的以零為起始的索引, 其屬性已設定。

*nID*<br/>
在按鈕的命令 ID。

*nStyle*<br/>
在按鈕的樣式。 如需可用工具列按鈕樣式的清單, 請參閱[工具列控制項樣式](../../mfc/reference/toolbar-control-styles.md)。

*iImage*<br/>
[in]（也就是集合中工具列影像的索引）按鈕之以零為起始的影像索引。

### <a name="remarks"></a>備註

呼叫這個方法來設定工具列按鈕的屬性。

在 Debug build 中, 如果*nIndex*所指定的索引無效, 這個方法就會產生判斷提示失敗。

呼叫[CMFCToolBar:: SetButtonStyle](#setbuttonstyle)方法, 只設定按鈕的樣式。

##  <a name="setbuttons"></a>CMFCToolBar:: SetButtons

設定工具列的按鈕。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>參數

*lpIDArray*<br/>
在要插入之按鈕的命令識別碼陣列的指標。

*nIDCount*<br/>
在*LpIDArray*中的專案數。

*bRemapImages*<br/>
在布林值, 指定是否要將現有的按鈕影像與插入的按鈕產生關聯。 如果此參數為 TRUE, 則會重新對應影像。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

呼叫此方法可從工具列移除現有的按鈕, 並插入新按鈕的集合。

這個方法會將 [**自訂**] 按鈕新增至工具列, 並將 AFX_WM_RESETTOOLBAR 訊息傳送至工具列的父視窗。 如需 [**自訂**] 按鈕的詳細資訊, 請參閱[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)。

##  <a name="setbuttonstyle"></a>CMFCToolBar:: SetButtonStyle

設定在指定索引處的工具列按鈕樣式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在要設定其樣式的工具列按鈕之以零為起始的索引。

*nStyle*<br/>
在按鈕的樣式。 如需可用工具列按鈕樣式的清單, 請參閱[工具列控制項樣式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>備註

如果*nStyle*為 TBBS_DISABLED, 則此方法會移除 TBBS_PRESSED 樣式, 因為使用者無法按一下已停用的按鈕。

##  <a name="setbuttontext"></a>CMFCToolBar:: SetButtonText

設定工具列按鈕的文字標籤。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在工具列按鈕的索引。

*lpszText*<br/>
在工具列按鈕的文字標籤。 必須為非 Null。

### <a name="return-value"></a>傳回值

如果方法成功, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

如果提供的索引未參考有效的工具列按鈕, 這個方法會傳回 FALSE。

##  <a name="setcommandusageoptions"></a>CMFCToolBar:: SetCommandUsageOptions

指定很少使用的命令不會出現在應用程式的功能表中。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>參數

*nStartCount*<br/>
在指定在架構只顯示基本和最近使用的命令之前, 必須執行命令的次數。

*nMinUsagePercentage*<br/>
在命令必須執行的次數百分比, 以視為最近使用的命令。

### <a name="return-value"></a>傳回值

如果*nMinUsagePercentage*等於或大於 100, 則為 FALSE;否則為 TRUE。

### <a name="remarks"></a>備註

呼叫這個方法, 以自訂架構用來判斷基本和最近使用的功能表項目如何出現的演算法。 如需基本命令的詳細資訊, 請參閱[CMFCToolBar:: AddBasicCommand](#addbasiccommand)。

這個類別會使用`CMFCCmdUsageCount`類別來追蹤命令的使用計數。 如需此類別的詳細資訊, 請參閱[CMFCCmdUsageCount 類別](../../mfc/reference/cmfccmdusagecount-class.md)。

##  <a name="setcustomizemode"></a>CMFCToolBar:: SetCustomizeMode

啟用或停用應用程式中所有工具列的自訂模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
在布林值, 指定是否要啟用或停用自訂模式。 將此參數設定為 TRUE 以啟用自訂模式, 或設為 FALSE 以停用它。

### <a name="return-value"></a>傳回值

如果呼叫這個方法會變更自訂模式, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會調整的版面配置, 並重新繪製應用程式中的每個工具列。 呼叫[CMFCToolBar:: IsCustomizeMode](#iscustomizemode)方法, 以判斷應用程式是否處於自訂模式,

##  <a name="setgraydisabledbuttons"></a>CMFCToolBar:: SetGrayDisabledButtons

指定工具列上的無法使用按鈕是否為灰色, 或是否使用按鈕無法使用的影像。

```
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>參數

*bGrayDisabledButtons*<br/>
在布林值, 指定如何顯示無法使用的按鈕。 如果此參數為 TRUE, 則架構會變暗按鈕。 否則, 此架構會使用按鈕無法使用的影像集合。

### <a name="remarks"></a>備註

根據預設, 無法使用的按鈕會呈現灰色。

##  <a name="setheight"></a>CMFCToolBar:: SetHeight

設定工具列的高度。

```
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>參數

*cyHeight*<br/>
在工具列的高度 (以圖元為單位)。

### <a name="remarks"></a>備註

這個方法會在設定高度之後重新繪製工具列。

##  <a name="sethelpmode"></a>CMFCToolBar:: SetHelpMode

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>參數

在*bOn*<br/>

### <a name="remarks"></a>備註

##  <a name="sethot"></a>CMFCToolBar:: SetHot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>參數

在*pMenuButton*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="sethotborder"></a>CMFCToolBar:: SetHotBorder

指定是否要熱追蹤工具列按鈕。

```
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>參數

*bShowHotBorder*<br/>
在布林值, 指定是否要使用熱追蹤工具列按鈕。 如果此參數為 TRUE, 工具列會熱追蹤其按鈕。 否則, 工具列不會熱追蹤其按鈕。

### <a name="remarks"></a>備註

如果按鈕是熱追蹤, 則當滑鼠移至其上時, 架構會反白顯示按鈕。 根據預設, 每個工具列會熱追蹤其按鈕。

呼叫[CMFCToolBar:: GetHotBorder](#gethotborder)方法, 以判斷工具列是否會熱追蹤其按鈕。

##  <a name="sethottextcolor"></a>CMFCToolBar:: SetHotTextColor

設定熱門工具列按鈕的文字色彩。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>參數

*clrText*<br/>
在指定熱門追蹤之工具列按鈕的文字色彩。

### <a name="remarks"></a>備註

如需有關熱門追蹤工具列按鈕的詳細資訊, 請參閱[CMFCToolBar:: GetHotBorder](#gethotborder)和[CMFCToolBar:: SetHotBorder](#sethotborder)。

##  <a name="setignoresettext"></a>CMFCToolBar:: SetIgnoreSetText

```
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>參數

在*其中 bvalue system.boolean.true*<br/>

### <a name="remarks"></a>備註

##  <a name="setlargeicons"></a>CMFCToolBar:: SetLargeIcons

指定工具列按鈕是否顯示大型圖示。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>參數

*bLargeIcons*<br/>
在布林值, 指定要使用的圖示。 如果此參數為 TRUE, 則架構會顯示大型圖示。 否則, 架構會顯示一般圖示。

### <a name="remarks"></a>備註

當使用者在 [**自訂**] 對話方塊的 [**選項**] 索引標籤中變更 [**大型圖示**] 核取方塊的狀態時, 架構會呼叫這個方法。 這個方法會調整應用程式中的所有工具列大小。

根據預設, 架構會顯示一般圖示。

如需 [**自訂**] 對話方塊的詳細資訊, 請參閱[CMFCToolBarsCustomizeDialog 類別](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

##  <a name="setlockedsizes"></a>CMFCToolBar:: SetLockedSizes

設定工具列上的鎖定按鈕和鎖定影像的大小。

```
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
在指定鎖定工具列按鈕的大小。

*sizeImage*<br/>
在指定鎖定的工具列影像大小。

*bDontScale*<br/>
指定是否要以高 DPI 模式縮放或不鎖定工具列影像。

### <a name="remarks"></a>備註

[已鎖定] 按鈕的預設大小為23x22 圖元。 鎖定影像的預設大小為16x15 圖元。

呼叫[CMFCToolBar:: GetLockedImageSize](#getlockedimagesize)方法, 以取出鎖定影像的大小。 呼叫[CMFCToolBar:: GetButtonSize](#getbuttonsize)方法, 以取出已鎖定工具列按鈕的大小。

##  <a name="setmaskmode"></a>CMFCToolBar:: SetMaskMode

```
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>參數

在*bMasked*<br/>

### <a name="remarks"></a>備註

##  <a name="setmenusizes"></a>CMFCToolBar:: SetMenuSizes

設定工具列功能表按鈕和其影像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
在指定工具列按鈕的大小 (以圖元為單位)。

*sizeImage*<br/>
在指定工具列影像的大小 (以圖元為單位)。

### <a name="remarks"></a>備註

根據預設, 功能表按鈕及其影像的大小不會定義。

呼叫[CMFCToolBar:: GetMenuButtonSize](#getmenubuttonsize)方法來判斷功能表按鈕的大小, 以及[CMFCToolBar:: GetMenuImageSize](#getmenuimagesize)方法, 以決定功能表按鈕影像的大小。

如需使用此方法的範例, 請參閱 IEDemo 和 MSMoneyDemo 範例。

##  <a name="setnonpermittedcommands"></a>CMFCToolBar:: SetNonPermittedCommands

設定使用者無法執行的命令清單。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
在`CList`物件的參考, 其中包含使用者無法執行的命令。

### <a name="remarks"></a>備註

呼叫這個方法, 以防止使用者選取特定的命令。 例如, 基於安全性考慮, 您可能會想要防止使用者選取特定的命令。 如需使用此方法的範例, 請參閱 MDITabsDemo 和 MenuSubSet 範例。

這個方法會清除先前不允許的命令清單。 根據預設, 不允許的命令清單是空的。

##  <a name="setonerowwithsibling"></a>CMFCToolBar:: SetOneRowWithSibling

將工具列和其兄弟置於相同的資料列上。

```
void SetOneRowWithSibling();
```

### <a name="remarks"></a>備註

當使用者按一下 [**在一個資料列上顯示按鈕**] 按鈕時, 架構會呼叫這個方法。

呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar)方法, 以啟用在**一個資料列上顯示按鈕**, 或在**兩個數據列按鈕上顯示按鈕**。 如果您為此工具列呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar) , 則會將 [同輩] 工具列移到此工具列的資料列。 否則, 這個工具列會移到兄弟的資料列。

當使用者按一下 [**在兩個數據列上顯示按鈕**] 按鈕時, 架構會呼叫[CMFCToolBar:: SetTwoRowsWithSibling](#settworowswithsibling)方法。

##  <a name="setorigbuttons"></a>CMFCToolBar:: SetOrigButtons

```
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>參數

在*lstOrigButtons*<br/>

### <a name="remarks"></a>備註

##  <a name="setpermament"></a>CMFCToolBar:: SetPermament

指定使用者是否可以關閉工具列。

```
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>參數

*bPermament*<br/>
在布林值, 指定使用者是否可以關閉工具列。 如果此參數為 TRUE, 使用者就無法關閉工具列。 否則, 使用者可以關閉工具列。

### <a name="remarks"></a>備註

根據預設, 使用者可以關閉每個工具列。

呼叫[CMFCToolBar:: CanBeClosed](#canbeclosed)方法, 以判斷使用者是否可以關閉工具列。

##  <a name="setroutecommandsviaframe"></a>CMFCToolBar:: SetRouteCommandsViaFrame

指定父框架或擁有者是否將命令傳送至工具列。

```
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
在如果此參數為 TRUE, 則父框架會將命令傳送至工具列。 否則, 擁有者會將命令傳送至工具列。

### <a name="remarks"></a>備註

根據預設, 父框架會將命令傳送至工具列。 呼叫[CMFCToolBar:: GetRouteCommandsViaFrame](#getroutecommandsviaframe)方法, 以判斷父框架或擁有者是否將命令傳送至工具列。

##  <a name="setshowtooltips"></a>CMFCToolBar:: SetShowTooltips

指定架構是否顯示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
在如果此參數為 TRUE, 則架構會顯示工具提示。 否則, 架構會隱藏工具提示。

### <a name="remarks"></a>備註

根據預設, 此架構會顯示工具提示。

呼叫[CMFCToolBar:: GetShowTooltips](#getshowtooltips)方法, 以判斷架構是否顯示工具提示。

##  <a name="setsiblingtoolbar"></a>CMFCToolBar:: SetSiblingToolBar

指定工具列的同級。

```
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>參數

*pBrotherToolbar*<br/>
在同級工具列的指標。

### <a name="remarks"></a>備註

這個方法會啟用 [**在一個資料列上顯示按鈕**] 或 [在**兩個數據列上顯示**按鈕] 按鈕, 當使用者顯示 [**自訂**] 快顯功能表時顯示。 當您想要讓使用者指定相關的工具列是出現在相同的資料列或不同的資料列上時, 請呼叫這個方法。

當您啟用工具列上顯示的 [**自訂**] 按鈕之後, 請呼叫這個方法。 若要啟用 [**自訂**] 按鈕, 請呼叫[CMFCToolBar:: EnableCustomizeButton](#enablecustomizebutton)方法。

若要取出工具列的兄弟, 請呼叫[CMFCToolBar:: GetSiblingToolBar](#getsiblingtoolbar)。

##  <a name="setsizes"></a>CMFCToolBar:: SetSizes

指定所有工具列上按鈕和影像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*sizeButton*<br/>
在工具列按鈕的大小 (以圖元為單位)。

*sizeImage*<br/>
在工具列按鈕影像的大小 (以圖元為單位)。

### <a name="remarks"></a>備註

工具列按鈕的預設大小為23x22 圖元。 工具列按鈕影像的預設大小為16x15 圖元。

呼叫[CMFCToolBar:: GetImageSize](#getimagesize)方法, 以取出工具列按鈕影像的大小。 呼叫[CMFCToolBar:: GetButtonSize](#getbuttonsize)方法, 以取得工具列按鈕的大小。

##  <a name="settoolbarbtntext"></a>CMFCToolBar:: SetToolBarBtnText

指定工具列上按鈕的屬性。

```
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>參數

*nBtnIndex*<br/>
在工具列按鈕清單中工具列按鈕以零為起始的索引。

*szText*<br/>
在指定工具列按鈕的文字標籤。

*bShowText*<br/>
在如果此參數為 TRUE, 則架構會顯示文字標籤。 否則, 架構會隱藏文字標籤。

*bShowImage*<br/>
在如果此參數為 TRUE, 則架構會顯示工具列按鈕影像。 否則, 架構會隱藏工具列按鈕影像。

### <a name="remarks"></a>備註

根據預設, 此架構會顯示工具列按鈕的影像, 但不會顯示工具列按鈕的文字標籤。

在 [偵錯工具] 組建中, 如果*nBtnIndex*未參考有效的工具列按鈕, 或工具列按鈕是分隔符號, 則此方法會產生判斷提示失敗。

##  <a name="settworowswithsibling"></a>CMFCToolBar:: SetTwoRowsWithSibling

將工具列和其同級置於不同的資料列上。

```
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>備註

當使用者按一下 [**在兩個數據列上顯示按鈕**] 按鈕時, 架構會呼叫這個方法。

呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar)方法, 以啟用在**一個資料列上顯示按鈕**, 或在**兩個數據列按鈕上顯示按鈕**。 如果您為這個工具列呼叫[CMFCToolBar:: SetSiblingToolBar](#setsiblingtoolbar) , 則會將 [同輩] 工具列移到另一個資料列。 否則, 這個工具列會移到另一個資料列。

當使用者按一下 [**在一個資料列上顯示按鈕**] 按鈕時, 架構會呼叫[CMFCToolBar:: SetOneRowWithSibling](#setonerowwithsibling)方法。

##  <a name="setuserimages"></a>CMFCToolBar:: SetUserImages

設定應用程式中使用者定義的影像集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>參數

*pUserImages*<br/>
在使用者定義影像集合的指標。

### <a name="return-value"></a>傳回值

如果方法成功, 則為非零;如果指定`CMFCToolBarImages`的物件無效, 或者影像大小與工具列的預設影像大小不同, 則為0。

### <a name="remarks"></a>備註

架構會使用使用者定義的影像來繪製由使用者自訂的工具列按鈕。 *PUserImages*所指定的影像清單會在應用程式中的所有工具列之間共用。

如果指定`CMFCToolBarImages`的物件無效, 或者影像大小與工具列的預設影像大小不同, 這個方法就會在 Debug 組建中產生判斷提示失敗。

OutlookDemo、ToolTipDemo 和 VisualStudioDemo 範例會使用這個方法來設定使用者定義影像的全域集合。 他們會載入名為 UserImages 的檔案, 該檔案位於應用程式的工作目錄中。

呼叫[CMFCToolBar:: GetUserImages](#getuserimages)方法, 以取得應用程式中使用者定義影像的集合。

##  <a name="stretchpane"></a>CMFCToolBar:: StretchPane

以垂直或水準方式伸展工具列, 並視需要重新置放按鈕。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>參數

*nLength*<br/>
在用來延展窗格的量 (以圖元為單位)。

*bVert*<br/>
在若為 TRUE, 則垂直伸展窗格。 若為 FALSE, 則會水準縮放窗格。

### <a name="return-value"></a>傳回值

`CSize`物件, 指定工具列工作區的大小。

### <a name="remarks"></a>備註

這個方法會呼叫[CMFCToolBar:: WrapToolBar](#wraptoolbar)來重新調整延伸工具列內的按鈕。

傳回值是藉由呼叫[CMFCToolBar:: CalcSize](#calcsize)來判斷。

##  <a name="translatechar"></a>CMFCToolBar:: TranslateChar

如果指定的按鍵程式碼對應到有效的鍵盤快速鍵, 則執行按鈕命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>參數

*nChar*<br/>
在指定虛擬按鍵碼。 如需標準虛擬按鍵代碼的清單, 請參閱 Winuser。

### <a name="return-value"></a>傳回值

如果指定的按鍵程式碼無法列印或未對應到有效的鍵盤快速鍵, 則為 FALSE;如果指定的按鍵程式碼對應至下拉式功能表選項, 則為 TRUE;否則, 來自[CMFCToolBar::P rocesscommand](#processcommand)的傳回值。

### <a name="remarks"></a>備註

當按鍵與 ALT 鍵一起按下時, 架構會呼叫這個方法。

##  <a name="updatebutton"></a>CMFCToolBar:: UpdateButton

更新指定按鈕的狀態。

```
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在指定要更新的按鈕之以零為起始的索引。

### <a name="remarks"></a>備註

##  <a name="wraptoolbar"></a>CMFCToolBar:: WrapToolBar

在指定的維度內重新置放工具列按鈕。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>參數

*nWidth*<br/>
在工具列的最大寬度。

*nHeight*<br/>
在工具列的最大高度。 如果工具列是浮動的, 則不使用。

*pDC*<br/>
在裝置內容的指標。 如果是 Null, 則會使用工具列的裝置內容。

*nColumnWidth*<br/>
在按鈕寬度。 如果為-1, 則會使用目前的寬度。

[in] m *nRowHeight*按鈕 height。 如果為-1, 則會使用目前的高度。

### <a name="return-value"></a>傳回值

工具列上按鈕的列數。

### <a name="remarks"></a>備註

這個方法會重新置放工具列中的按鈕, 視需要將按鈕換行到其他資料列。

##  <a name="m_bdontscaleimages"></a>CMFCToolBar:: m_bDontScaleImages

指定是否要以高 DPI 模式縮放工具列影像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar 類別](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[逐步解說：將控制項放在工具列上](../../mfc/walkthrough-putting-controls-on-toolbars.md)
