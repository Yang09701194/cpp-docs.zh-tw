---
title: CMFCToolBar 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBar
- AFXTOOLBAR/CMFCToolBar
- AFXTOOLBAR/CMFCToolBar::AddBasicCommand
- AFXTOOLBAR/CMFCToolBar::AddCommandUsage
- AFXTOOLBAR/CMFCToolBar::AddToolBarForImageCollection
- AFXTOOLBAR/CMFCToolBar::AdjustLayout
- AFXTOOLBAR/CMFCToolBar::AdjustSize
- AFXTOOLBAR/CMFCToolBar::AllowChangeTextLabels
- AFXTOOLBAR/CMFCToolBar::AreTextLabels
- AFXTOOLBAR/CMFCToolBar::AutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::ButtonToIndex
- AFXTOOLBAR/CMFCToolBar::CalcFixedLayout
- AFXTOOLBAR/CMFCToolBar::CalcSize
- AFXTOOLBAR/CMFCToolBar::CanHandleSiblings
- AFXTOOLBAR/CMFCToolBar::CleanUpImages
- AFXTOOLBAR/CMFCToolBar::CleanUpLockedImages
- AFXTOOLBAR/CMFCToolBar::CanBeClosed
- AFXTOOLBAR/CMFCToolBar::CanBeRestored
- AFXTOOLBAR/CMFCToolBar::CanFocus
- AFXTOOLBAR/CMFCToolBar::CommandToIndex
- AFXTOOLBAR/CMFCToolBar::Create
- AFXTOOLBAR/CMFCToolBar::CreateEx
- AFXTOOLBAR/CMFCToolBar::Deactivate
- AFXTOOLBAR/CMFCToolBar::EnableCustomizeButton
- AFXTOOLBAR/CMFCToolBar::EnableDocking
- AFXTOOLBAR/CMFCToolBar::EnableLargeIcons
- AFXTOOLBAR/CMFCToolBar::EnableQuickCustomization
- AFXTOOLBAR/CMFCToolBar::EnableReflections
- AFXTOOLBAR/CMFCToolBar::EnableTextLabels
- AFXTOOLBAR/CMFCToolBar::FromHandlePermanent
- AFXTOOLBAR/CMFCToolBar::GetAllButtons
- AFXTOOLBAR/CMFCToolBar::GetAllToolbars
- AFXTOOLBAR/CMFCToolBar::GetBasicCommands
- AFXTOOLBAR/CMFCToolBar::GetButton
- AFXTOOLBAR/CMFCToolBar::GetButtonInfo
- AFXTOOLBAR/CMFCToolBar::GetButtonSize
- AFXTOOLBAR/CMFCToolBar::GetButtonStyle
- AFXTOOLBAR/CMFCToolBar::GetButtonText
- AFXTOOLBAR/CMFCToolBar::GetColdImages
- AFXTOOLBAR/CMFCToolBar::GetColumnWidth
- AFXTOOLBAR/CMFCToolBar::GetCommandButtons
- AFXTOOLBAR/CMFCToolBar::GetCount
- AFXTOOLBAR/CMFCToolBar::GetCustomizeButton
- AFXTOOLBAR/CMFCToolBar::GetDefaultImage
- AFXTOOLBAR/CMFCToolBar::GetDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetDisabledMenuImages
- AFXTOOLBAR/CMFCToolBar::GetDroppedDownMenu
- AFXTOOLBAR/CMFCToolBar::GetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::GetHighlightedButton
- AFXTOOLBAR/CMFCToolBar::GetHotBorder
- AFXTOOLBAR/CMFCToolBar::GetHotTextColor
- AFXTOOLBAR/CMFCToolBar::GetHwndLastFocus
- AFXTOOLBAR/CMFCToolBar::GetOVERWRITESetText
- AFXTOOLBAR/CMFCToolBar::GetImageSize
- AFXTOOLBAR/CMFCToolBar::GetImages
- AFXTOOLBAR/CMFCToolBar::GetImagesOffset
- AFXTOOLBAR/CMFCToolBar::GetInvalidateItemRect
- AFXTOOLBAR/CMFCToolBar::GetItemID
- AFXTOOLBAR/CMFCToolBar::GetItemRect
- AFXTOOLBAR/CMFCToolBar::GetLargeColdImages
- AFXTOOLBAR/CMFCToolBar::GetLargeDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLargeImages
- AFXTOOLBAR/CMFCToolBar::GetLockedColdImages
- AFXTOOLBAR/CMFCToolBar::GetLockedDisabledImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImages
- AFXTOOLBAR/CMFCToolBar::GetLockedImageSize
- AFXTOOLBAR/CMFCToolBar::GetLockedMenuImages
- AFXTOOLBAR/CMFCToolBar::GetMenuButtonSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImageSize
- AFXTOOLBAR/CMFCToolBar::GetMenuImages
- AFXTOOLBAR/CMFCToolBar::GetOrigButtons
- AFXTOOLBAR/CMFCToolBar::GetOrigResetButtons
- AFXTOOLBAR/CMFCToolBar::GetResourceID
- AFXTOOLBAR/CMFCToolBar::GetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::GetRowHeight
- AFXTOOLBAR/CMFCToolBar::GetShowTooltips
- AFXTOOLBAR/CMFCToolBar::GetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::GetUserImages
- AFXTOOLBAR/CMFCToolBar::HitTest
- AFXTOOLBAR/CMFCToolBar::InsertButton
- AFXTOOLBAR/CMFCToolBar::InsertSeparator
- AFXTOOLBAR/CMFCToolBar::InvalidateButton
- AFXTOOLBAR/CMFCToolBar::IsAddRemoveQuickCustomize
- AFXTOOLBAR/CMFCToolBar::IsAltCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsAutoGrayInactiveImages
- AFXTOOLBAR/CMFCToolBar::IsBasicCommand
- AFXTOOLBAR/CMFCToolBar::IsButtonExtraSizeAvailable
- AFXTOOLBAR/CMFCToolBar::IsButtonHighlighted
- AFXTOOLBAR/CMFCToolBar::IsCommandPermitted
- AFXTOOLBAR/CMFCToolBar::IsCommandRarelyUsed
- AFXTOOLBAR/CMFCToolBar::IsCustomizeMode
- AFXTOOLBAR/CMFCToolBar::IsDragButton
- AFXTOOLBAR/CMFCToolBar::IsExistCustomizeButton
- AFXTOOLBAR/CMFCToolBar::IsFloating
- AFXTOOLBAR/CMFCToolBar::IsLargeIcons
- AFXTOOLBAR/CMFCToolBar::IsLastCommandFromButton
- AFXTOOLBAR/CMFCToolBar::IsLocked
- AFXTOOLBAR/CMFCToolBar::IsOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::IsUserDefined
- AFXTOOLBAR/CMFCToolBar::LoadBitmap
- AFXTOOLBAR/CMFCToolBar::LoadBitmapEx
- AFXTOOLBAR/CMFCToolBar::LoadParameters
- AFXTOOLBAR/CMFCToolBar::LoadState
- AFXTOOLBAR/CMFCToolBar::LoadToolBar
- AFXTOOLBAR/CMFCToolBar::LoadToolBarEx
- AFXTOOLBAR/CMFCToolBar::OnChangeHot
- AFXTOOLBAR/CMFCToolBar::OnFillBackground
- AFXTOOLBAR/CMFCToolBar::OnReset
- AFXTOOLBAR/CMFCToolBar::OnSetAccData
- AFXTOOLBAR/CMFCToolBar::OnSetDefaultButtonText
- AFXTOOLBAR/CMFCToolBar::RemoveAllButtons
- AFXTOOLBAR/CMFCToolBar::RemoveButton
- AFXTOOLBAR/CMFCToolBar::RemoveStateFromRegistry
- AFXTOOLBAR/CMFCToolBar::ReplaceButton
- AFXTOOLBAR/CMFCToolBar::ResetAll
- AFXTOOLBAR/CMFCToolBar::ResetAllImages
- AFXTOOLBAR/CMFCToolBar::RestoreOriginalState
- AFXTOOLBAR/CMFCToolBar::SaveState
- AFXTOOLBAR/CMFCToolBar::SetBasicCommands
- AFXTOOLBAR/CMFCToolBar::SetButtonInfo
- AFXTOOLBAR/CMFCToolBar::SetButtonStyle
- AFXTOOLBAR/CMFCToolBar::SetButtonText
- AFXTOOLBAR/CMFCToolBar::SetButtons
- AFXTOOLBAR/CMFCToolBar::SetCommandUsageOptions
- AFXTOOLBAR/CMFCToolBar::SetCustomizeMode
- AFXTOOLBAR/CMFCToolBar::SetGrayDisabledButtons
- AFXTOOLBAR/CMFCToolBar::SetHeight
- AFXTOOLBAR/CMFCToolBar::SetHotBorder
- AFXTOOLBAR/CMFCToolBar::SetHotTextColor
- AFXTOOLBAR/CMFCToolBar::SetLargeIcons
- AFXTOOLBAR/CMFCToolBar::SetLockedSizes
- AFXTOOLBAR/CMFCToolBar::SetMenuSizes
- AFXTOOLBAR/CMFCToolBar::SetNonPermittedCommands
- AFXTOOLBAR/CMFCToolBar::SetOneRowWithSibling
- AFXTOOLBAR/CMFCToolBar::SetPermament
- AFXTOOLBAR/CMFCToolBar::SetRouteCommandsViaFrame
- AFXTOOLBAR/CMFCToolBar::SetShowTooltips
- AFXTOOLBAR/CMFCToolBar::SetSiblingToolBar
- AFXTOOLBAR/CMFCToolBar::SetSizes
- AFXTOOLBAR/CMFCToolBar::SetToolBarBtnText
- AFXTOOLBAR/CMFCToolBar::SetTwoRowsWithSibling
- AFXTOOLBAR/CMFCToolBar::SetUserImages
- AFXTOOLBAR/CMFCToolBar::StretchPane
- AFXTOOLBAR/CMFCToolBar::TranslateChar
- AFXTOOLBAR/CMFCToolBar::UpdateButton
- AFXTOOLBAR/CMFCToolBar::WrapToolBar
- AFXTOOLBAR/CMFCToolBar::AllowShowOnList
- AFXTOOLBAR/CMFCToolBar::CalcMaxButtonHeight
- AFXTOOLBAR/CMFCToolBar::DoPaint
- AFXTOOLBAR/CMFCToolBar::DrawButton
- AFXTOOLBAR/CMFCToolBar::DrawSeparator
- AFXTOOLBAR/CMFCToolBar::OnUserToolTip
- AFXTOOLBAR/CMFCToolBar::m_bDontScaleImages
- AFXTOOLBAR/CMFCToolBar::m_dblLargeImageRatio
helpviewer_keywords:
- CMFCToolBar [MFC], AddBasicCommand
- CMFCToolBar [MFC], AddCommandUsage
- CMFCToolBar [MFC], AddToolBarForImageCollection
- CMFCToolBar [MFC], AdjustLayout
- CMFCToolBar [MFC], AdjustSize
- CMFCToolBar [MFC], AllowChangeTextLabels
- CMFCToolBar [MFC], AreTextLabels
- CMFCToolBar [MFC], AutoGrayInactiveImages
- CMFCToolBar [MFC], ButtonToIndex
- CMFCToolBar [MFC], CalcFixedLayout
- CMFCToolBar [MFC], CalcSize
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CleanUpImages
- CMFCToolBar [MFC], CleanUpLockedImages
- CMFCToolBar [MFC], CanBeClosed
- CMFCToolBar [MFC], CanBeRestored
- CMFCToolBar [MFC], CanFocus
- CMFCToolBar [MFC], CanHandleSiblings
- CMFCToolBar [MFC], CommandToIndex
- CMFCToolBar [MFC], Create
- CMFCToolBar [MFC], CreateEx
- CMFCToolBar [MFC], Deactivate
- CMFCToolBar [MFC], EnableCustomizeButton
- CMFCToolBar [MFC], EnableDocking
- CMFCToolBar [MFC], EnableLargeIcons
- CMFCToolBar [MFC], EnableQuickCustomization
- CMFCToolBar [MFC], EnableReflections
- CMFCToolBar [MFC], EnableTextLabels
- CMFCToolBar [MFC], FromHandlePermanent
- CMFCToolBar [MFC], GetAllButtons
- CMFCToolBar [MFC], GetAllToolbars
- CMFCToolBar [MFC], GetBasicCommands
- CMFCToolBar [MFC], GetButton
- CMFCToolBar [MFC], GetButtonInfo
- CMFCToolBar [MFC], GetButtonSize
- CMFCToolBar [MFC], GetButtonStyle
- CMFCToolBar [MFC], GetButtonText
- CMFCToolBar [MFC], GetColdImages
- CMFCToolBar [MFC], GetColumnWidth
- CMFCToolBar [MFC], GetCommandButtons
- CMFCToolBar [MFC], GetCount
- CMFCToolBar [MFC], GetCustomizeButton
- CMFCToolBar [MFC], GetDefaultImage
- CMFCToolBar [MFC], GetDisabledImages
- CMFCToolBar [MFC], GetDisabledMenuImages
- CMFCToolBar [MFC], GetDroppedDownMenu
- CMFCToolBar [MFC], GetGrayDisabledButtons
- CMFCToolBar [MFC], GetHighlightedButton
- CMFCToolBar [MFC], GetHotBorder
- CMFCToolBar [MFC], GetHotTextColor
- CMFCToolBar [MFC], GetHwndLastFocus
- CMFCToolBar [MFC], GetIgnoreSetText
- CMFCToolBar [MFC], GetImageSize
- CMFCToolBar [MFC], GetImages
- CMFCToolBar [MFC], GetImagesOffset
- CMFCToolBar [MFC], GetInvalidateItemRect
- CMFCToolBar [MFC], GetItemID
- CMFCToolBar [MFC], GetItemRect
- CMFCToolBar [MFC], GetLargeColdImages
- CMFCToolBar [MFC], GetLargeDisabledImages
- CMFCToolBar [MFC], GetLargeImages
- CMFCToolBar [MFC], GetLockedColdImages
- CMFCToolBar [MFC], GetLockedDisabledImages
- CMFCToolBar [MFC], GetLockedImages
- CMFCToolBar [MFC], GetLockedImageSize
- CMFCToolBar [MFC], GetLockedMenuImages
- CMFCToolBar [MFC], GetMenuButtonSize
- CMFCToolBar [MFC], GetMenuImageSize
- CMFCToolBar [MFC], GetMenuImages
- CMFCToolBar [MFC], GetOrigButtons
- CMFCToolBar [MFC], GetOrigResetButtons
- CMFCToolBar [MFC], GetResourceID
- CMFCToolBar [MFC], GetRouteCommandsViaFrame
- CMFCToolBar [MFC], GetRowHeight
- CMFCToolBar [MFC], GetShowTooltips
- CMFCToolBar [MFC], GetSiblingToolBar
- CMFCToolBar [MFC], GetUserImages
- CMFCToolBar [MFC], HitTest
- CMFCToolBar [MFC], InsertButton
- CMFCToolBar [MFC], InsertSeparator
- CMFCToolBar [MFC], InvalidateButton
- CMFCToolBar [MFC], IsAddRemoveQuickCustomize
- CMFCToolBar [MFC], IsAltCustomizeMode
- CMFCToolBar [MFC], IsAutoGrayInactiveImages
- CMFCToolBar [MFC], IsBasicCommand
- CMFCToolBar [MFC], IsButtonExtraSizeAvailable
- CMFCToolBar [MFC], IsButtonHighlighted
- CMFCToolBar [MFC], IsCommandPermitted
- CMFCToolBar [MFC], IsCommandRarelyUsed
- CMFCToolBar [MFC], IsCustomizeMode
- CMFCToolBar [MFC], IsDragButton
- CMFCToolBar [MFC], IsExistCustomizeButton
- CMFCToolBar [MFC], IsFloating
- CMFCToolBar [MFC], IsLargeIcons
- CMFCToolBar [MFC], IsLastCommandFromButton
- CMFCToolBar [MFC], IsLocked
- CMFCToolBar [MFC], IsOneRowWithSibling
- CMFCToolBar [MFC], IsUserDefined
- CMFCToolBar [MFC], LoadBitmap
- CMFCToolBar [MFC], LoadBitmapEx
- CMFCToolBar [MFC], LoadParameters
- CMFCToolBar [MFC], LoadState
- CMFCToolBar [MFC], LoadToolBar
- CMFCToolBar [MFC], LoadToolBarEx
- CMFCToolBar [MFC], OnChangeHot
- CMFCToolBar [MFC], OnFillBackground
- CMFCToolBar [MFC], OnReset
- CMFCToolBar [MFC], OnSetAccData
- CMFCToolBar [MFC], OnSetDefaultButtonText
- CMFCToolBar [MFC], RemoveAllButtons
- CMFCToolBar [MFC], RemoveButton
- CMFCToolBar [MFC], RemoveStateFromRegistry
- CMFCToolBar [MFC], ReplaceButton
- CMFCToolBar [MFC], ResetAll
- CMFCToolBar [MFC], ResetAllImages
- CMFCToolBar [MFC], RestoreOriginalState
- CMFCToolBar [MFC], SaveState
- CMFCToolBar [MFC], SetBasicCommands
- CMFCToolBar [MFC], SetButtonInfo
- CMFCToolBar [MFC], SetButtonStyle
- CMFCToolBar [MFC], SetButtonText
- CMFCToolBar [MFC], SetButtons
- CMFCToolBar [MFC], SetCommandUsageOptions
- CMFCToolBar [MFC], SetCustomizeMode
- CMFCToolBar [MFC], SetGrayDisabledButtons
- CMFCToolBar [MFC], SetHeight
- CMFCToolBar [MFC], SetHotBorder
- CMFCToolBar [MFC], SetHotTextColor
- CMFCToolBar [MFC], SetLargeIcons
- CMFCToolBar [MFC], SetLockedSizes
- CMFCToolBar [MFC], SetMenuSizes
- CMFCToolBar [MFC], SetNonPermittedCommands
- CMFCToolBar [MFC], SetOneRowWithSibling
- CMFCToolBar [MFC], SetPermament
- CMFCToolBar [MFC], SetRouteCommandsViaFrame
- CMFCToolBar [MFC], SetShowTooltips
- CMFCToolBar [MFC], SetSiblingToolBar
- CMFCToolBar [MFC], SetSizes
- CMFCToolBar [MFC], SetToolBarBtnText
- CMFCToolBar [MFC], SetTwoRowsWithSibling
- CMFCToolBar [MFC], SetUserImages
- CMFCToolBar [MFC], StretchPane
- CMFCToolBar [MFC], TranslateChar
- CMFCToolBar [MFC], UpdateButton
- CMFCToolBar [MFC], WrapToolBar
- CMFCToolBar [MFC], AllowShowOnList
- CMFCToolBar [MFC], CalcMaxButtonHeight
- CMFCToolBar [MFC], DoPaint
- CMFCToolBar [MFC], DrawButton
- CMFCToolBar [MFC], DrawSeparator
- CMFCToolBar [MFC], OnUserToolTip
- CMFCToolBar [MFC], m_bDontScaleImages
- CMFCToolBar [MFC], m_dblLargeImageRatio
ms.assetid: e7679c01-fb94-44c0-98c6-3af955292fb5
ms.openlocfilehash: 9a90327bde693b87a53838da35adde21ed48dfbb
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754040"
---
# <a name="cmfctoolbar-class"></a>CMFCToolBar 類別

該`CMFCToolBar`類類似於[CToolBar 類](../../mfc/reference/ctoolbar-class.md),但提供了使用者介面功能的其他支援。 這包括一般工具列、含作用中影像的工具列、大圖示、頁面巡覽區按鈕、鎖定工具列、Rebar 控制項、影像下方文字、背景影像和索引標籤式工具列。 `CMFCToolBar` 類別的內建支援也包括工具列和功能表的使用者自訂、工具列和功能表之間的拖放、下拉式方塊按鈕、編輯方塊按鈕、色彩選擇器和縮合按鈕。

有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCToolBar : public CMFCBaseToolBar
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|`CMFCToolBar::CMFCToolBar`|預設建構函式。|
|`CMFCToolBar::~CMFCToolBar`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolbar::新增基本命令](#addbasiccommand)|將功能表命令添加到使用者打開選單時始終顯示的命令清單中。|
|[CMFC工具列:新增命令用法](#addcommandusage)|增加與給定命令關聯的計數器的一個。|
|[CMFCToolbar::添加工具列圖片集](#addtoolbarforimagecollection)|將使用者介面資源中的圖像添加到應用程式中的圖像集合。|
|[CMFC工具列:調整佈局](#adjustlayout)|重新計算工具列的大小和位置。 (覆蓋[CBasePane:調整佈局](../../mfc/reference/cbasepane-class.md#adjustlayout))。|
|[CMFC工具列:調整大小](#adjustsize)|重新計算工具列的大小。|
|[CMFCTool 列:允許變更文字標籤](#allowchangetextlabels)|指定文字標籤是否可以顯示在工具列按鈕上的圖像下。|
|[CMFCTool 列::文字標籤](#aretextlabels)|指定影像下的文字標籤目前是否顯示在工具列按鈕上。|
|[CMFCToolbar:自動格雷非活動影像](#autograyinactiveimages)|啟用或禁用自動生成非活動按鈕映射。|
|[CMFC工具列::按鈕索引](#buttontoindex)|返回此工具列中指定的[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)物件的索引。|
|[CMFC工具列:鈣固定佈局](#calcfixedlayout)|計算工具列的水準大小。 (覆蓋[CBasePane::CalcFixed 佈局](../../mfc/reference/cbasepane-class.md#calcfixedlayout).)|
|[CMFCToolBar::計算](#calcsize)|框架在布局計算過程中調用。 (覆蓋[CPane::計算大小](../../mfc/reference/cpane-class.md#calcsize)。|
|[CMFCToolBar::坎漢兄弟](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFCToolbar::清理圖片](#cleanupimages)|釋放分配給工具列圖像的系統資源。|
|[CMFCToolbar::清理鎖定影像](#cleanuplockedimages)|釋放為鎖定工具列圖像分配的系統資源。|
|[CMFCToolbar:可關閉](#canbeclosed)|指定使用者是否可以關閉工具列。 (覆蓋[CBasePane:可以關閉](../../mfc/reference/cbasepane-class.md#canbeclosed).)|
|[CMFCToolBar:可以還原](#canberestored)|確定系統在自定義后是否可以將工具列還原到其原始狀態。|
|[CMFCToolBar:可以集中注意力](#canfocus)|指定窗格是否可以接收焦點。 (覆蓋[CBasePane::可以聚焦](../../mfc/reference/cbasepane-class.md#canfocus).)|
|[CMFCToolBar::坎漢兄弟](#canhandlesiblings)|決定是否工具列和其同層級位於相同的窗格上。|
|[CMFC工具列::命令索引](#commandtoindex)|返回工具列中具有指定命令 ID 的按鈕的索引。|
|[CMFC工具列:建立](#create)|建立 `CMFCToolBar` 物件。|
|[CMFC工具列:建立Ex](#createex)|建立`CMFCToolBar`使用其他樣式選項(如大型圖示)的物件。|
|[CMFCToolBar::D啟動](#deactivate)|停用工具列。|
|[CMFC工具列:啟用自訂按鈕](#enablecustomizebutton)|啟用或停用工具列末尾顯示的 **「添加或刪除按鈕**」按鈕。|
|[CMFC工具列:啟用停靠](#enabledocking)|啟用窗格與主框架的停靠。 (覆蓋[CBasePane:啟用停靠](../../mfc/reference/cbasepane-class.md#enabledocking).)|
|[CMFCTool 列:啟用大型圖示](#enablelargeicons)|啟用或禁用工具列按鈕上的大型圖示。|
|[CMFCToolBar::啟用快速定制](#enablequickcustomization)|啟用或禁用工具列的快速自定義,以便用戶可以按**Alt**鍵並將按鈕拖動到新位置。|
|[CMFCToolBar::啟用反射](#enablereflections)|啟用或禁用命令反射。|
|[CMFCTool 列:啟用文字標籤](#enabletextlabels)|啟用或禁用工具列按鈕圖像下的文本標籤。|
|[CMFCToolbar::從永久處理](#fromhandlepermanent)|檢索指向包含給定視窗句柄`CMFCToolBar`的物件的指標。|
|[CMFC工具列:取得所有按鈕](#getallbuttons)|傳回工具列中的按鈕的唯讀清單。|
|[CMFC工具列:取得所有工具列](#getalltoolbars)|返回應用程式中所有工具列的唯讀清單。|
|[CMFC工具列:取得基本命令](#getbasiccommands)|返回應用程式中定義的基本命令的唯讀清單。|
|[CMFCToolBar:取得按鈕](#getbutton)|返回指向具有指定工具列`CMFCToolBarButton`按鈕索引的物件的指標。|
|[CMFCToolBar:取得按鈕資訊](#getbuttoninfo)|在指定索引處返回按鈕的命令 ID、樣式和圖像索引。|
|[CMFCToolBar::GetButtonSize](#getbuttonsize)|返回工具列上每個按鈕的尺寸。|
|[CMFC工具列:取得按鈕樣式](#getbuttonstyle)|返回位於指定索引處的工具列按鈕的當前樣式。|
|[CMFCTool 列:取得按鈕文字](#getbuttontext)|返回具有指定索引的按鈕的文本標籤。|
|[CMFCToolbar:取得冷圖像](#getcoldimages)|返回指向應用程式中冷工具列按鈕圖像集合的指標。|
|[CMFCTool 列:取得柱寬度](#getcolumnwidth)|返回工具列按鈕的寬度。|
|[CMFC工具列:抓取指令按鈕](#getcommandbuttons)|從應用程式中的所有工具列返回具有指定命令 ID 的按鈕清單。|
|[CMFC工具列:取得計數](#getcount)|傳回工具列上的按鈕和分隔符數。|
|[CMFC工具列:取得自訂按鈕](#getcustomizebutton)|檢索指向與工具列關聯的`CMFCCustomizeButton`物件的指標。|
|[CMFCTool 列:取得預設影像](#getdefaultimage)|返回具有指定命令 ID 的工具列按鈕的預設圖像的索引。|
|[CMFCToolBar:取得關閉影像](#getdisabledimages)|返回指向應用程式中用於禁用工具列按鈕的圖像集合的指標。|
|[CMFCToolbar:取得關閉的選單影像](#getdisabledmenuimages)|返回指向應用程式中禁用功能表按鈕的圖像集合的指標。|
|[CMFCToolbar:取得向下選單](#getdroppeddownmenu)|檢索指向當前顯示其子功能表的功能表按鈕物件的指標。|
|[CMFC工具列:抓取格雷關閉按鈕](#getgraydisabledbuttons)|指定禁用按鈕的圖像是常規按鈕圖像的調光版本,還是從禁用按鈕圖像的集合中獲取。|
|[CMFCToolBar:取得突顯按鈕](#gethighlightedbutton)|返回指向當前突出顯示的工具列按鈕的指標。|
|[CMFCToolBar:取得 Hot 邊框](#gethotborder)|確定工具列按鈕是否熱跟蹤。|
|[CMFCToolbar:取得HottextColor](#gethottextcolor)|返回突出顯示工具列按鈕的文字顏色。|
|[CMFCToolBar:取得 Hwnd 最後焦點](#gethwndlastfocus)|將句柄返回到工具列之前具有輸入焦點的視窗。|
|[CMFCTool 列:取得忽略集文字](#getignoresettext)|指定是否忽略對設置按鈕標籤的呼叫。|
|[CMFCTool 列:取得影像大小](#getimagesize)|傳回工具列按鈕影像的當前大小。|
|[CMFCToolBar:取得影像](#getimages)|返回指向應用程式中默認按鈕圖像集合的指標。|
|[CMFCToolBar:取得影像偏移](#getimagesoffset)|在工具列按鈕圖像的全域清單中返回用於查找此工具列工具列的工具列按鈕圖像的索引偏移量。|
|[CMFCToolbar:取得無效項目](#getinvalidateitemrect)|檢索給定索引處的按鈕必須重繪的工作區區域。|
|[CMFCTool 列:取得項目ID](#getitemid)|在指定的索引處返回工具列按鈕的命令 ID。|
|[CMFCToolbar:取得專案重新完成](#getitemrect)|在指定的索引處返回按鈕的邊界矩形。|
|[CMFCToolbar:取得大型冷圖像](#getlargecoldimages)|返回指向應用程式中大型冷工具欄按鈕圖像集合的指標。|
|[CMFCToolbar:取得大型禁用影像](#getlargedisabledimages)|返回指向應用程式中大型禁用工具列按鈕圖像集合的指標。|
|[CMFCToolBar:取得大型影像](#getlargeimages)|返回指向應用程式中大型工具列按鈕圖像集合的指標。|
|[CMFCToolbar:取得鎖定的冷圖像](#getlockedcoldimages)|返回指向工具列中鎖定冷圖像集合的指標。|
|[CMFCToolBar:取得鎖定禁用影像](#getlockeddisabledimages)|返回指向工具列中鎖定禁用圖像集合的指標。|
|[CMFCToolBar:取得鎖定影像](#getlockedimages)|返回指向工具列中鎖定按鈕圖像集合的指標。|
|[CMFCTool 列:取得鎖定影像大小](#getlockedimagesize)|傳回鎖定工具列影像的預設大小。|
|[CMFCToolbar:取得鎖定選單影像](#getlockedmenuimages)|返回指向工具列中鎖定工具列功能表圖像集合的指標。|
|[CMFC工具列:抓取選單按鈕大小](#getmenubuttonsize)|返回應用程式中功能表按鈕的大小。|
|[CMFC工具列:抓取選單影像大小](#getmenuimagesize)|返回應用程式中功能表按鈕圖像的大小。|
|[CMFCToolBar:取得選單影像](#getmenuimages)|返回指向應用程式中功能表按鈕圖像集合的指標。|
|[CMFCToolBar::取得OrigButtons](#getorigbuttons)|檢索工具列的非自定義按鈕的集合。|
|[CMFCToolBar::取得OrigReset按鈕](#getorigresetbuttons)|檢索工具列的非自定義重置按鈕的集合。|
|[CMFCToolBar:取得資源ID](#getresourceid)|檢索工具列的資源 ID。|
|[CMFC工具列:獲取路由命令ViaFrame](#getroutecommandsviaframe)|確定向工具列發送命令的物件、父幀或擁有者。|
|[CMFCToolBar:取得羅高](#getrowheight)|返回工具列按鈕的高度。|
|[CMFC工具列::取得顯示工具提示](#getshowtooltips)|指定是否為工具列按鈕顯示工具提示。|
|[CMFC工具列:取得同級工具列](#getsiblingtoolbar)|檢索工具列的同級。|
|[CMFCToolBar:取得使用者影像](#getuserimages)|返回指向應用程式中使用者定義的工具列按鈕圖像集合的指標。|
|[CMFC工具列:命中測試](#hittest)|返回位於指定位置的工具列按鈕的索引。|
|[CMFC工具列:插入按鈕](#insertbutton)|將按鈕插入工具列。|
|[CMFCToolBar:插入分離器](#insertseparator)|將分隔符插入工具列。|
|[CMFC工具列:無效按鈕](#invalidatebutton)|使提供的索引中存在的工具列按鈕的工作區無效。|
|[CMFCToolbar::isAddremove快速自定義](#isaddremovequickcustomize)|確定使用者是否可以使用 **「自訂」** 選單選項添加或刪除工具列按鈕。|
|[CMFCToolBar::IsAlt定製模式](#isaltcustomizemode)|指定是否使用*快速自定義*來拖動按鈕。|
|[CMFCToolbar:非自動格雷非活動圖像](#isautograyinactiveimages)|指定是否啟用非活動(非突出顯示)按鈕映射的自動生成。|
|[CMFCToolbar::是基本命令](#isbasiccommand)|確定命令是否位於基本命令清單中。|
|[CMFC工具列:是按鈕超尺寸可用](#isbuttonextrasizeavailable)|確定工具列是否可以顯示具有擴展邊框的按鈕。|
|[CMFCTool 列:按鍵突出顯示](#isbuttonhighlighted)|確定工具列上的按鈕是否突出顯示。|
|[CMFCTool 列:是允許的](#iscommandpermitted)|確定是否允許命令。|
|[CMFCToolbar::是命令很少使用](#iscommandrarelyused)|確定是否很少使用命令(請參閱[CMFCToolBar::set命令使用選項](#setcommandusageoptions))。|
|[CMFCToolbar:是定製模式](#iscustomizemode)|指定工具列框架是否處於自定義模式。|
|[CMFCToolBar::IsDragButton](#isdragbutton)|確定是否拖動工具列按鈕。|
|[CMFC工具列:存在客製化按鈕](#isexistcustomizebutton)|確定工具列是否包含 **「自訂」** 按鈕。|
|[CMFCToolBar:是浮動的](#isfloating)|確定工具列是否浮動。|
|[CMFCToolbar::大圖示](#islargeicons)|指定應用程式中的工具列目前是否顯示大圖示。|
|[CMFCToolbar:是來自按鈕的"正命令"](#islastcommandfrombutton)|確定最近執行的命令是否從指定的工具列按鈕發送。|
|[CMFCToolbar::鎖定](#islocked)|確定工具列是否鎖定。|
|[CMFCToolbar:與同級同一個](#isonerowwithsibling)|確定工具列及其同級工具列是否位於同一行上。|
|[CMFCTool 列:使用者定義](#isuserdefined)|指定工具列是否由使用者定義。|
|[CMFC工具列:載入點陣圖](#loadbitmap)|從應用程式資源載入工具列影像。|
|[CMFC工具列::載入位射射Ex](#loadbitmapex)|從應用程式資源載入工具列影像。 包括大圖像。|
|[CMFCToolBar:載入參數](#loadparameters)|從 Windows 註冊表載入全域工具列選項。|
|[CMFC工具列:載入狀態](#loadstate)|從 Windows 註冊表載入工具列狀態資訊。 (覆蓋[CPane:LoadState](../../mfc/reference/cpane-class.md#loadstate).)|
|[CMFC工具列:載入工具列](#loadtoolbar)|從應用程式資源載入工具列。|
|[CMFC工具列:載入工具列](#loadtoolbarex)|通過使用`CMFCToolBarInfo`幫助器類從應用程式資源載入工具列,使應用程式能夠使用大圖像。|
|[CMFCToolbar::打開](#onchangehot)|當用戶選擇工具列上的按鈕時,框架調用。|
|[CMFCToolbar::在填充背景](#onfillbackground)|由[CBasePane::DoPaint 的](../../mfc/reference/cbasepane-class.md#dopaint)框架調用以填充工具列背景。|
|[CMFCToolbar:開啟](#onreset)|將工具列還原到其原始狀態。|
|[CMFCToolbar::OnSetAccData](#onsetaccdata)|(覆蓋[CBasePane:onSetAccData](../../mfc/reference/cbasepane-class.md#onsetaccdata).)|
|[CMFC工具列:開啟預設按鈕文字](#onsetdefaultbuttontext)|將工具列按鈕的文本還原到其默認狀態。|
|`CMFCToolBar::OnUpdateCmdUI`|內部使用。|
|[CMFC工具列:刪除所有按鈕](#removeallbuttons)|從工具列中刪除所有按鈕。|
|[CMFC工具列:刪除按鈕](#removebutton)|從工具列中刪除具有指定索引的按鈕。|
|[CMFCToolbar:從註冊處刪除狀態](#removestatefromregistry)|從 Windows 註冊表中刪除工具列的狀態資訊。|
|[CMFC工具列:更換按鈕](#replacebutton)|將工具列按鈕替換為其他工具列按鈕。|
|[CMFCToolBar:重置所有](#resetall)|將所有工具列還原到其原始狀態。|
|[CMFCToolbar::重置所有圖像](#resetallimages)|清除應用程式中的所有工具列圖像集合。|
|[CMFCToolBar::RestoreOriginalState](#restoreoriginalstate)|還原工具列的原始狀態。|
|[CMFCToolBar:儲存狀態](#savestate)|在 Windows 註冊表中保存工具列的狀態資訊。 (覆蓋[CPane:儲存狀態](../../mfc/reference/cpane-class.md#savestate).)|
|`CMFCToolBar::Serialize`|(覆寫 `CBasePane::Serialize`。)|
|[CMFC工具列::設定基本命令](#setbasiccommands)|設置使用者打開功能表時始終顯示的命令清單。|
|[CMFC工具列:設定按鈕資訊](#setbuttoninfo)|設置工具列按鈕的命令 ID、樣式和圖像 ID。|
|[CMFC工具列:設定按鈕樣式](#setbuttonstyle)|設置給定索引處工具列按鈕的樣式。|
|[CMFCTool 列:設定按鈕文字](#setbuttontext)|設置工具列按鈕的文字標籤。|
|[CMFC工具列:設定按鈕](#setbuttons)|設置工具列的按鈕。|
|[CMFC工具列:設定指令使用選項](#setcommandusageoptions)|指定很少使用的命令未顯示在應用程式的功能表中時。|
|[CMFC工具列:設定自訂模式](#setcustomizemode)|為應用程式中的所有工具列啟用或禁用自定義模式。|
|[CMFC工具列::設定灰色禁用按鈕](#setgraydisabledbuttons)|指定工具列上的禁用按鈕是變暗還是禁用的圖像用於禁用的按鈕。|
|[CMFC工具列:設定高度](#setheight)|設置工具列的高度。|
|[CMFCToolbar::設置Hot邊框](#sethotborder)|指定工具列按鈕是否熱跟蹤。|
|[CMFC工具列:設定HottextColor](#sethottextcolor)|設定熱工具列按鈕的文字顏色。|
|[CMFC工具列:設定大圖示](#setlargeicons)|指定工具列按鈕是否顯示大圖示。|
|[CMFC工具列:設定鎖定大小](#setlockedsizes)|設置工具列上鎖定按鈕和鎖定圖像的大小。|
|[CMFC工具列:設定選單大小](#setmenusizes)|設置工具列功能表按鈕及其圖像的大小。|
|[CMFC工具列::設定不允許命令](#setnonpermittedcommands)|設定使用者無法執行的命令的清單。|
|[CMFCToolbar:設定同一行](#setonerowwithsibling)|將工具列及其同級放在同一行上。|
|[CMFC工具列::設定](#setpermament)|指定使用者是否可以關閉工具列。|
|[CMFC工具列::設置路由命令ViaFrame](#setroutecommandsviaframe)|指定父框架或擁有者是向工具列發送命令。|
|[CMFC工具列::設定顯示工具提示](#setshowtooltips)|指定框架是否顯示工具提示。|
|[CMFC工具列::設定同級工具列](#setsiblingtoolbar)|指定工具列的同級。|
|[CMFC工具列:設定大小](#setsizes)|指定所有工具列上的按鈕和圖像的大小。|
|[CMFC工具列:設定工具列文字](#settoolbarbtntext)|指定工具列上按鈕的屬性。|
|[CMFCTool 欄:設定雙行與同級](#settworowswithsibling)|將工具列及其同級放在單獨的行上。|
|[CMFC工具列:設定使用者影像](#setuserimages)|設置應用程式中使用者定義的映射的集合。|
|[CMFC工具列:拉伸窗格](#stretchpane)|垂直或水準拉伸工具列。 (覆蓋[CBasePane:拉伸窗格](../../mfc/reference/cbasepane-class.md#stretchpane).)|
|[CMFCToolBar:翻譯查爾](#translatechar)|如果指定的鍵代碼對應於有效的鍵盤快捷鍵,則執行按鈕命令。|
|[CMFC工具列:更新按鈕](#updatebutton)|更新指定按鈕的狀態。|
|[CMFC工具列:包裝工具列](#wraptoolbar)|在給定尺寸內重新置放工具列按鈕。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFC工具列::允許顯示清單](#allowshowonlist)|確定工具列是否顯示在 **「自訂」****對話框工具列窗格**的清單中。|
|[CMFC工具列::卡爾馬克斯按鈕高度](#calcmaxbuttonheight)|計算工具列中按鈕的最大高度。|
|[CMFCToolBar::DoPaint](#dopaint)|重新繪製工具列。|
|[CMFCToolBar::D生按鈕](#drawbutton)|重新繪製工具列按鈕。|
|[CMFCToolBar::D分離器](#drawseparator)|在工具列上重新繪製分隔符。|
|[CMFC工具列:在使用者工具提示](#onusertooltip)|當按鈕的工具提示即將顯示時,由框架調用。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFC工具列:m_bDontScaleImages](#m_bdontscaleimages)|指定在高 DPI 模式下是否縮放工具列圖像。|
|[CMFC工具列:m_dblLargeImageRatio](#m_dbllargeimageratio)|指定大型圖像的尺寸(高度或寬度)與常規圖像的尺寸之間的比率。|

## <a name="remarks"></a>備註

要將`CMFCToolBar`物件合併到應用程式中,請按照以下步驟操作:

1. 將`CMFCToolBar`物件添加到主框架視窗。

1. 處理主框架視窗的WM_CREATE消息時,調用[CMFCToolBar::創建](#create)或[CMFCToolBar:createEx](#createex)以創建工具列並指定其樣式。

1. 調用[CBasePane:啟用停靠](../../mfc/reference/cbasepane-class.md#enabledocking)以指定停靠樣式。

要插入特殊按鈕(如組合框或下拉工具列),請在父資源中保留一個虛擬按鈕,並使用[CMFCToolBar:::替換按鈕](#replacebutton)在運行時替換虛擬按鈕。 有關詳細資訊,請參閱[演練:將控制項放在工具列上](../walkthrough-putting-controls-on-toolbars.md)。

`CMFCToolBar`是 MFC 庫類[CMFCMenuBar 類](../../mfc/reference/cmfcmenubar-class.md)[、CMFCPopupMenuBar 類](../../mfc/reference/cmfcpopupmenubar-class.md)和[CMFCDropDownToolBar 類](../../mfc/reference/cmfcdropdowntoolbar-class.md)的基類。

## <a name="example"></a>範例

下例示範如何在 `CMFCToolBar` 類別中使用各種方法。 該範例展示如何設定工具列的視窗分頁的文字、設定邊框、設定窗格的樣式以及啟用工具列末尾顯示的 **「新增或刪除按鈕」** 按鈕。 此代碼段是[IE 演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#8](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_2.cpp)]

## <a name="requirements"></a>需求

**標題:** afxtoolbar.h

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CBasePane](../../mfc/reference/cbasepane-class.md)

[CPane](../../mfc/reference/cpane-class.md)

[CMFCBase工具列](../../mfc/reference/cmfcbasetoolbar-class.md)

`CMFCToolBar`

## <a name="cmfctoolbaraddbasiccommand"></a><a name="addbasiccommand"></a>CMFCToolbar::新增基本命令

將功能表命令添加到使用者打開選單時始終顯示的命令清單中。

```
static void __stdcall AddBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]指定要添加的命令。

### <a name="remarks"></a>備註

打開功能表時,始終顯示基本命令。 當用戶選擇查看最近使用的命令時,此方法是有意義的。

使用[CMFCToolBar::SetBasicCommands](#setbasiccommands)方法設置使用者打開功能表時始終顯示的命令清單。 使用[CMFCToolBar:getBasicCommands](#getbasiccommands)方法檢索應用程式使用的基本命令的清單。

## <a name="cmfctoolbaraddcommandusage"></a><a name="addcommandusage"></a>CMFC工具列:新增命令用法

增加與給定命令關聯的計數器的一個。

```
static void __stdcall AddCommandUsage(UINT uiCommand);
```

### <a name="parameters"></a>參數

*uiCommand*<br/>
[在]指定命令計數器以遞增。

### <a name="remarks"></a>備註

當用戶選擇功能表項時,框架將調用此方法。

框架使用命令計數器來顯示最近使用的功能表項。

此方法使用[CMFCCmd 使用計數::addCmd](../../mfc/reference/cmfccmdusagecount-class.md#addcmd)方法增加命令計數器。

## <a name="cmfctoolbaraddtoolbarforimagecollection"></a><a name="addtoolbarforimagecollection"></a>CMFCToolbar::添加工具列圖片集

將使用者介面資源中的圖像添加到應用程式中的圖像集合。

```
static BOOL __stdcall AddToolBarForImageCollection(
    UINT uiResID,
    UINT uiBmpResID=0,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[在]要載入影像的工具列的資源 ID。

*烏布佈雷斯ID*<br/>
[在]帶有工具列圖像的位圖的資源 ID。

*烏伊庫德雷斯ID*<br/>
[在]帶有「冷」工具欄圖像的位圖的資源 ID。

*uiMenuResID*<br/>
[在]帶功能表影像的位圖的資源 ID。

*ui禁用雷斯代碼*<br/>
[在]帶有禁用工具列圖像的位圖的資源 ID。

*uiMenu 關閉雷斯代碼*<br/>
[在]具有禁用功能表影像的點陣圖的資源 ID。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;如果*uiResID*或*uiBmpResID*未指定有效資源,或者發生其他錯誤,則 FALSE。

### <a name="remarks"></a>備註

呼叫此方法以使用工具列圖像載入點陣圖並將其添加到工具列圖像的集合中。 此方法建立一個暫時工具列物件,並呼叫[CMFCToolBar::LoadToolbar](#loadtoolbar)。

## <a name="cmfctoolbaradjustlayout"></a><a name="adjustlayout"></a>CMFC工具列:調整佈局

重新計算工具列的大小和位置。

```
virtual void AdjustLayout();
```

### <a name="remarks"></a>備註

建立工具列以重新計算其大小和位置時調用此方法。

每次必須更改工具列的佈局時,框架都會調用此方法。 例如,當使用者移動另一個控制列列、調整應用程式視窗的大小或自定義工具列時,佈局必須更改。

重寫此方法,在派生自`CMFCToolbar`的 類中提供您自己的動態佈局。

## <a name="cmfctoolbaradjustsize"></a><a name="adjustsize"></a>CMFC工具列:調整大小

重新計算工具列的大小。

```cpp
void AdjustSize();
```

### <a name="remarks"></a>備註

此方法確保工具列適合父框架的邊界。 如果工具列沒有父框架,則此方法不執行任何操作。

如果工具列的父級不是`CMFCReBar`物件[,CMFCToolBar::AdjustLayout](#adjustlayout)方法調用此方法以重新計算大小。

## <a name="cmfctoolbarallowchangetextlabels"></a><a name="allowchangetextlabels"></a>CMFCTool 列:允許變更文字標籤

指定文字標籤是否可以顯示在工具列按鈕上的圖像下。

```
virtual BOOL AllowChangeTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果允許在圖像下方顯示文本標籤,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

自定義對話框調用此方法,以確定是否啟用所選**工具列**工具列工具列頁上的 **「顯示文字標籤**」選選盒。

預設實現返回 TRUE。

在派生於`CMFCToolBar`的物件中重寫此方法,並且不希望用戶決定在圖像下方的工具列按鈕上是否顯示文本標籤時返回 FALSE。

## <a name="cmfctoolbarallowshowonlist"></a><a name="allowshowonlist"></a>CMFC工具列::允許顯示清單

確定工具列是否顯示在 **「自訂」** 對話框**工具列窗格中的**工具列清單中。

```
virtual BOOL AllowShowOnList() const;
```

### <a name="return-value"></a>傳回值

如果工具列物件可以顯示在工具列自訂頁上的清單框中,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

框架呼叫此方法以確定工具列自訂頁上的清單是否應包含派生自`CMFCToolBar`的特定物件。

預設實現始終返回 TRUE。 如果不希望工具列出現在自定義對話框中的工具列清單中,則重寫此方法。

## <a name="cmfctoolbararetextlabels"></a><a name="aretextlabels"></a>CMFCTool 列::文字標籤

指定影像下的文字標籤目前是否顯示在工具列按鈕上。

```
BOOL AreTextLabels() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕在圖像下方顯示文本標籤,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

使用[CMFCToolBar:啟用文字標籤](#enabletextlabels)以指定是否顯示文本。 預設值為 FALSE。 呼叫[CMFCToolBar::允許更改文字標籤](#allowchangetextlabels)指定使用者是否可以在自訂對話框中更改此設定。

## <a name="cmfctoolbarautograyinactiveimages"></a><a name="autograyinactiveimages"></a>CMFCToolbar:自動格雷非活動影像

啟用或禁用自動生成非活動按鈕映射。

```
static void AutoGrayInactiveImages(
    BOOL bEnable=TRUE,
    int nGrayImagePercentage=0,
    BOOL bRedrawAllToolbars=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]指定是否調暗非活動影像的布林值。 如果此參數為 TRUE,則非活動圖像將變暗。 否則,非活動圖像不會變暗。

*n 格雷影像百分比*<br/>
[在]指定非活動圖像的亮度百分比。 如果*benable*為 FALSE,則忽略此值。

*b 重新繪製所有工具列*<br/>
[在]指定是否重繪應用程式中的所有工具列的布林值。 如果此參數為 TRUE,則此方法將重繪所有工具列。

### <a name="remarks"></a>備註

如果*bEnable*為 TRUE,則框架使用*nGrayImage 百分比*從常規映射生成非活動圖像。 否則,您必須使用[CMFCToolBar::getColdImages](#getcoldimages)方法提供一組非活動映射。 預設會停用這個選項。

有關*nGrayImage 百分比*參數的詳細資訊,請參閱[CMFCToolBar 圖像::灰色影像](../../mfc/reference/cmfctoolbarimages-class.md#grayimages)。

## <a name="cmfctoolbarbuttontoindex"></a><a name="buttontoindex"></a>CMFC工具列::按鈕索引

返回此工具列中指定的[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)物件的索引。

```
int ButtonToIndex(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列按鈕物件的指標。

### <a name="return-value"></a>傳回值

工具列按鈕內部列表中*的 pButton*索引;或 -1 如果指定的按鈕不在此工具列上。

## <a name="cmfctoolbarcalcfixedlayout"></a><a name="calcfixedlayout"></a>CMFC工具列:鈣固定佈局

計算工具列的水準大小。

```
virtual CSize CalcFixedLayout(
    BOOL bStretch,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*b 伸*<br/>
[在]TRUE將工具列拉伸到父框架的大小。

*布霍茲*<br/>
[在]TRUE 可水準定向工具列;FALSE 可垂直定向工具列。

### <a name="return-value"></a>傳回值

指定`CSize`工具列大小的物件。

### <a name="remarks"></a>備註

此方法使用`CMFCToolBar::CalcLayout`方法計算工具列的大小。 如果*bStretch*為 TRUE,它將傳遞*dwMode*參數的LM_STRETCH標誌。 如果*bHorz*為 TRUE,則它傳遞LM_HORZ標誌。

有關使用此方法的示例,請參閱 VisualStudioDemo 範例。

## <a name="cmfctoolbarcalcmaxbuttonheight"></a><a name="calcmaxbuttonheight"></a>CMFC工具列::卡爾馬克斯按鈕高度

計算工具列中按鈕的最大高度。

```
virtual int CalcMaxButtonHeight();
```

### <a name="return-value"></a>傳回值

按鈕的最大高度。

### <a name="remarks"></a>備註

此方法計算工具列上所有工具列按鈕之間的最大高度。 高度可能因當前工具列停靠狀態等因素而異。

在派生的`CMFCToolBar`類別中重寫此方法,以提供您自己的高度計算。

## <a name="cmfctoolbarcalcsize"></a><a name="calcsize"></a>CMFCToolBar::計算

框架在布局計算過程中調用。

```
virtual CSize CalcSize(BOOL bVertDock);
```

### <a name="parameters"></a>參數

*bVertDock*<br/>
[在]TRUE 指定工具列垂直停靠;FALSE 以指定工具列水準停靠。

### <a name="return-value"></a>傳回值

指定`CSize`工具列上按鈕的整體大小的物件。

### <a name="remarks"></a>備註

此方法考慮影響每個按鈕大小的屬性,例如文本標籤的面積和邊框大小。

如果工具列不包含按鈕,則此方法通過使用[CMFCToolBar::getButtonSize](#getbuttonsize)方法返回單個按鈕的保留大小。

## <a name="cmfctoolbarcanbeclosed"></a><a name="canbeclosed"></a>CMFCToolbar:可關閉

指定使用者是否可以關閉工具列。

```
virtual BOOL CanBeClosed() const;
```

### <a name="return-value"></a>傳回值

如果用戶可以關閉工具列,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

框架呼叫此方法以確定使用者是否可以關閉工具列。 如果方法返回 TRUE,則框架將啟用工具列系統功能表中的SC_CLOSE命令,使用者可以使用自訂對話框中工具列清單中的複選框關閉工具列。

預設實現返回 TRUE。 在派生的`CMFCToolBar`類中重寫此方法,以製作用戶無法關閉的工具列物件。

## <a name="cmfctoolbarcanberestored"></a><a name="canberestored"></a>CMFCToolBar:可以還原

確定系統在自定義后是否可以將工具列還原到其原始狀態。

```
virtual BOOL CanBeRestored() const;
```

### <a name="return-value"></a>傳回值

如果可以從應用程式資源還原工具列,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

框架調用此方法以確定工具列在自定義后是否可以返回到其原始狀態。 原始狀態從應用程式資源載入。

如果`CanBeRestored`返回 TRUE,則自定義對話框的**工具列**頁將啟用所選工具列的 **「重置**」按鈕。

如果工具列載入時的原始資源 ID 為非零,則預設實現將返回 TRUE。 通常,無法僅還原使用者定義的工具列。

可以重寫方法以`CanBeRestored`在派生類中自定義此行為。

## <a name="cmfctoolbarcanfocus"></a><a name="canfocus"></a>CMFCToolBar:可以集中注意力

指定窗格是否可以接收焦點。

```
virtual BOOL CanFocus() const;
```

### <a name="return-value"></a>傳回值

此方法返回 FALSE。

### <a name="remarks"></a>備註

此方法重寫基類實現[CBasePane::canFocus,](../../mfc/reference/cbasepane-class.md#canfocus)因為工具列對象無法接收焦點。

## <a name="cmfctoolbarcanhandlesiblings"></a><a name="canhandlesiblings"></a>CMFCToolBar::坎漢兄弟

決定是否工具列和其同層級位於相同的窗格上。

```
BOOL CanHandleSiblings();
```

### <a name="return-value"></a>傳回值

如果工具列具有同級,工具列及其同級位於同一窗格中,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

內部 CMFC自定義按鈕::CreatePopupMenu 方法呼叫此方法以確定如何顯示 **「自訂**」彈出式功能表。 如果這個方法傳回 TRUE,則框架將顯示 **「 一行」 按鈕**, 或是在 **「兩行」 按鈕上顯示按鈕**。

您通常不需要使用這個方法。 要啟用工具列上顯示的 **「自訂**」按鈕,請調用[CMFCToolBar::啟用自訂按鈕](#enablecustomizebutton)方法。 要開啟 **「一行顯示按鈕**」 或在 **「兩行」 按鈕上顯示按鈕**,請執行電[CMFCTool 欄::設定同級工具列](#setsiblingtoolbar)。

## <a name="cmfctoolbarcleanupimages"></a><a name="cleanupimages"></a>CMFCToolbar::清理圖片

釋放分配給工具列圖像的系統資源。

```
static void CMFCToolBar::CleanUpImages();
```

### <a name="remarks"></a>備註

當應用程式關閉時,框架調用此方法。

## <a name="cmfctoolbarcleanuplockedimages"></a><a name="cleanuplockedimages"></a>CMFCToolbar::清理鎖定影像

釋放為鎖定工具列圖像分配的系統資源。

```cpp
void CleanUpLockedImages();
```

### <a name="remarks"></a>備註

當應用程式的可視樣式發生更改時,調用此方法。 有關使用此方法的示例,請參閱 VisualStudioDemo 範例。

## <a name="cmfctoolbarcommandtoindex"></a><a name="commandtoindex"></a>CMFC工具列::命令索引

返回工具列中具有指定命令 ID 的按鈕的索引。

```
int CommandToIndex(
    UINT nIDFind,
    int iIndexFirst=0) const;
```

### <a name="parameters"></a>參數

*nIDFind*<br/>
[在]指定命令識別碼。

*iIndex 第一*<br/>
[在]指定要開始的初始索引。

### <a name="return-value"></a>傳回值

如果方法成功,工具列按鈕的零索引;-1 如果沒有具有指定 ID 的按鈕。

### <a name="remarks"></a>備註

物件`CMFCToolBar`維護工具列上按鈕的內部清單。 呼叫此函式以檢索清單中給定按鈕的命令 ID 的按鈕的索引。

如果*iIndex*大於 0,則此方法將忽略工具列上索引小於*iIndex*的任何按鈕。

## <a name="cmfctoolbarcreate"></a><a name="create"></a>CMFC工具列:建立

建立 `CMFCToolBar` 物件。

```
virtual BOOL Create(
    CWnd* pParentWnd,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pparentwnd*<br/>
[在]指向工具列的父視窗的指標。

*dwStyle*<br/>
[在]工具欄樣式。 關於樣式清單,請參閱 Windows SDK 中的[工具列控制元件與按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*nID*<br/>
[在]工具列的子視窗的 ID。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法創建一個控制欄並將其附加到工具列。 它創建具有TBSTYLE_FLAT樣式的控制欄。 呼叫[CMFCTool 列:](#createex)如果您想要不同的控制列樣式,請創建 Ex。

## <a name="cmfctoolbarcreateex"></a><a name="createex"></a>CMFC工具列:建立Ex

建立`CMFCToolBar`使用其他樣式選項(如大型圖示)的物件。

```
virtual BOOL CreateEx(
    CWnd* pParentWnd,
    DWORD dwCtrlStyle=TBSTYLE_FLAT,
    DWORD dwStyle=AFX_DEFAULT_TOOLBAR_STYLE,
    CRect rcBorders=CRect(1,
    1,
    1,
    1),
    UINT nID=AFX_IDW_TOOLBAR);
```

### <a name="parameters"></a>參數

*pparentwnd*<br/>
[在]指向工具列的父視窗的指標。

*dwCtrl風格*<br/>
[在]用於創建嵌入式控制欄物件的其他樣式。

*dwStyle*<br/>
[在]工具欄樣式。 有關適當樣式的清單,請參閱[工具列控制與按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles)。

*rcBorders*<br/>
[在]指定`CRect`工具列視窗邊框寬度的物件。

*nID*<br/>
[在]工具列的子視窗的 ID。

### <a name="return-value"></a>傳回值

如果此方法成功,則非零;否則 0。

### <a name="remarks"></a>備註

此方法創建一個控制欄並將其附加到工具列。

呼叫此方法而不是[CMFCToolBar::](#create)在您想要提供特定樣式時創建。 例如,將*dwCtrlStyle*設置為TBSTYLE_FLAT |TBSTYLE_TRANSPARENT創建類似於 Internet Explorer 4 使用的工具列的工具列。

### <a name="example"></a>範例

下面的示例演示如何使用`CreateEx``CMFCToolBar`類的方法。 此代碼段是[IE 演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbardeactivate"></a><a name="deactivate"></a>CMFCToolBar::D啟動

停用工具列。

```
virtual void Deactivate();
```

### <a name="remarks"></a>備註

此方法通過從突出顯示的工具列按鈕中刪除焦點來停用工具列。 當工具列失去焦點或被銷毀時,框架將調用此方法。

## <a name="cmfctoolbardopaint"></a><a name="dopaint"></a>CMFCToolBar::DoPaint

重新繪製工具列。

```
virtual void DoPaint(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

### <a name="remarks"></a>備註

當必須重新繪製工具列的一部分時,框架將調用此方法。

重寫此方法以自定義派生自`CMFCToolBar`的物件的外觀。

## <a name="cmfctoolbardrawbutton"></a><a name="drawbutton"></a>CMFCToolBar::D生按鈕

重新繪製工具列按鈕。

```
virtual BOOL DrawButton(
    CDC* pDC,
    CMFCToolBarButton* pButton,
    CMFCToolBarImages* pImages,
    BOOL bHighlighted,
    BOOL bDrawDisabledImages);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pButton*<br/>
[在]指向要繪製的按鈕的指標。

*pImage*<br/>
[在]指向工具列圖像的指標。

*突顯突顯*<br/>
[在]如果按鈕突出顯示,則為 TRUE;如果按鈕突出顯示,則為 TRUE。否則 FALSE。

*bDraw 停用影像*<br/>
[在]如果禁用的按鈕變暗,則為 TRUE;否則 FALSE。

### <a name="return-value"></a>傳回值

如果重新繪製了按鈕,則為 TRUE;如果按鈕已隱藏,則為 FALSE。

### <a name="remarks"></a>備註

當必須重新繪製工具列按鈕時[,CMFCToolBar::DrawButton](#drawbutton)方法調用此方法。

如果要自定義工具列上按鈕的外觀,請重寫此方法。

## <a name="cmfctoolbardrawseparator"></a><a name="drawseparator"></a>CMFCToolBar::D分離器

在工具列上重新繪製分隔符。

```
virtual void DrawSeparator(
    CDC* pDC,
    const CRect& rect,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*矩形*<br/>
[在]繪製分隔符的位置的邊界矩形(以像素為單位)。

*布霍茲*<br/>
[在]如果分隔符是水準的,則為 TRUE,如果分隔符是垂直的,則 FALSE。

### <a name="remarks"></a>備註

[CMFCToolBar::DoPaint](#dopaint)針對具有TBBS_SEPARATOR樣式的每個[CMFCToolBar::D原始分離器](#drawseparator)物件調用此方法,而不是為這些按鈕調用[CMFCToolBar::DrawButton。](#drawbutton)

在從[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)派生的類中重寫此方法,以自定義工具列上分隔符的外觀。 默認實現調用[CMFCVisualManager:onDrawSeor](../../mfc/reference/cmfcvisualmanager-class.md#ondrawseparator)以繪製其外觀由當前可視化管理員決定的分隔符。

## <a name="cmfctoolbarenablecustomizebutton"></a><a name="enablecustomizebutton"></a>CMFC工具列:啟用自訂按鈕

啟用或禁用工具列上顯示的「自訂」按鈕。

```cpp
void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    const CString& strCustomizeText,
    BOOL bQuickCustomize=TRUE);

void EnableCustomizeButton(
    BOOL bEnable,
    int iCustomizeCmd,
    UINT uiCustomizeTextResId,
    BOOL bQuickCustomize=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]啟用或禁用"自定義"按鈕。

*i 客製式Cmd*<br/>
[在]「自訂」按鈕的命令 ID。

*str定製文字*<br/>
[在]「自訂」按鈕的文字標籤。

*ui 自訂文字 Resid*<br/>
[在]「自訂」按鈕標籤的資源字串 ID。

*b快速定制*<br/>
[在]啟用或禁用從按鈕下落的菜單上的「**添加或刪除按鈕」** 選項。

### <a name="remarks"></a>備註

如果*i自訂 Cmd*為 -1,則當多個工具列按鈕不適合工具列區域時,框架將顯示"自訂"按鈕。 該按鈕顯示一個雙左指向箭頭或 V 形,表示有更多的按鈕。

如果*i自訂 Cmd*指定了有效的命令 ID,並且*bEnable*為 TRUE,則始終顯示「自訂」按鈕。 該按鈕具有一個小向下箭頭,並打開包含命令的功能表。 此命令使用*str"自訂文字*"指定的文字標籤。 如果*bQuick 自訂*也為 TRUE,則功能表將顯示「**添加或刪除按鈕」** 選項。

框架動態地向功能表添加任何不適合工具列區域的按鈕,然後由*i定製 Cmd*指定的項。 V 形顯示在下箭頭旁邊。

## <a name="cmfctoolbarenabledocking"></a><a name="enabledocking"></a>CMFC工具列:啟用停靠

啟用窗格與主框架的停靠。

```
virtual void EnableDocking(DWORD dwAlignment);
```

### <a name="parameters"></a>參數

*dwalignment*<br/>
[在]指定要啟用的停靠對齊方式。

### <a name="remarks"></a>備註

此方法通過將`CBasePane::m_dwControlBarStyle`數據成員設置為AFX_CBRS_FLOAT擴展基類實現[CBasePane::啟用Docking。](../../mfc/reference/cbasepane-class.md#enabledocking) 然後,此方法將*dwalignment*傳遞給基類實現。

## <a name="cmfctoolbarenablelargeicons"></a><a name="enablelargeicons"></a>CMFCTool 列:啟用大型圖示

啟用或禁用工具列按鈕上的大型圖示。

```cpp
void EnableLargeIcons(BOOL bEnable);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用大型圖示,FALSE 可禁用大型圖示。

### <a name="remarks"></a>備註

默認情況下,將啟用大型圖示。

## <a name="cmfctoolbarenablequickcustomization"></a><a name="enablequickcustomization"></a>CMFCToolBar::啟用快速定制

啟用或禁用工具列的快速自定義,以便用戶可以按**Alt**鍵並將按鈕拖動到新位置。

```
static void EnableQuickCustomization(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用快速自定義,FALSE 禁用快速自定義。

## <a name="cmfctoolbarenablereflections"></a><a name="enablereflections"></a>CMFCToolBar::啟用反射

啟用或禁用命令反射。

```cpp
void EnableReflections(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]TRUE 啟用命令反射;FALSE 以禁用命令反射。

### <a name="remarks"></a>備註

調用此方法可啟用包含嵌入控制項(如組合框)的工具列按鈕的命令反射。

有關命令反射的詳細資訊,請參閱[TN062:Windows 控件的消息反射](../../mfc/tn062-message-reflection-for-windows-controls.md)。

## <a name="cmfctoolbarenabletextlabels"></a><a name="enabletextlabels"></a>CMFCTool 列:啟用文字標籤

啟用或禁用工具列按鈕圖像下的文本標籤。

```cpp
void EnableTextLabels(BOOL bEnable=TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
如果文字標籤顯示在工具列按鈕圖像下,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

如果啟用了文字標籤,工具列上的所有按鈕都會被放大,為顯示在圖像下的標籤提供空間。 自訂對話框在**工具列**頁面上具有 **「顯示文字標籤**」複選框。 當使用者選擇工具列並選中此選項時,框架將調用`EnableTextLabels`選定的工具列。 您可以通過從 CMFCToolBar 傳回 FALSE 來關閉從[CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)的物件的物件的複選盒[::允許更改文字標籤](#allowchangetextlabels)。

## <a name="cmfctoolbarfromhandlepermanent"></a><a name="fromhandlepermanent"></a>CMFCToolbar::從永久處理

檢索指向包含給定視窗句柄`CMFCToolBar`的物件的指標。

```
static CMFCToolBar* __stdcall FromHandlePermanent(HWND hwnd);
```

### <a name="parameters"></a>參數

*霍恩德*<br/>
[在]要查找的視窗句柄。

### <a name="return-value"></a>傳回值

指向包含給定視窗`CMFCToolBar`句柄的物件的指標,如果沒有相應的`CMFCToolBar`物件,則指向 NULL。

### <a name="remarks"></a>備註

此共用方法檢查應用程式中每個工具列中包含給定視窗句柄`CMFCToolBar`的物件。

## <a name="cmfctoolbargetallbuttons"></a><a name="getallbuttons"></a>CMFC工具列:取得所有按鈕

傳回工具列中的按鈕的唯讀清單。

```
const CObList& GetAllButtons() const;
```

### <a name="return-value"></a>傳回值

對[COblist 類](../../mfc/reference/coblist-class.md)物件的常量引用,該物件包含[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)物件的集合。

## <a name="cmfctoolbargetalltoolbars"></a><a name="getalltoolbars"></a>CMFC工具列:取得所有工具列

返回應用程式中所有工具列的唯讀清單。

```
static const CObList& GetAllToolbars();
```

### <a name="return-value"></a>傳回值

對包含物件集合的`CMFCToolBar` [COblist 類](../../mfc/reference/coblist-class.md)物件的引用。

## <a name="cmfctoolbargetbasiccommands"></a><a name="getbasiccommands"></a>CMFC工具列:取得基本命令

返回應用程式中定義的基本命令的唯讀清單。

```
static const CList<UINT,UINT>& GetBasicCommands();
```

### <a name="return-value"></a>傳回值

對包含基本命令集合的[CList 類](../../mfc/reference/clist-class.md)物件的引用。

### <a name="remarks"></a>備註

用[CMFCToolBar 新增基本指令::新增基本指令](#addbasiccommand)或[CMFCToolBar::設定基本命令](#setbasiccommands)。

## <a name="cmfctoolbargetbutton"></a><a name="getbutton"></a>CMFCToolBar:取得按鈕

在指定索引處返回指向[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)物件的指標。

```
CMFCToolBarButton* GetButton(int iIndex) const;
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[在]指定要返回的按鈕的索引。

### <a name="return-value"></a>傳回值

指向工具列按鈕的指標(如果存在);或 NULL,如果沒有這樣的按鈕。

## <a name="cmfctoolbargetbuttoninfo"></a><a name="getbuttoninfo"></a>CMFCToolBar:取得按鈕資訊

在指定索引處返回按鈕的命令 ID、樣式和圖像索引。

```cpp
void GetButtonInfo(
    int nIndex,
    UINT& nID,
    UINT& nStyle,
    int& iImage) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]在工具列上的按鈕清單中指定按鈕的索引。

*nID*<br/>
[出]按鈕的命令識別碼。

*nStyle*<br/>
[出]按鈕的樣式。

*i 影像*<br/>
[出]按鈕的圖像索引。

### <a name="remarks"></a>備註

該方法`GetButtonInfo`在指定的索引處查找工具列按鈕,並檢索該按鈕的命令 ID、樣式和圖像索引。

如果指定索引處的按鈕不存在,則框架將*nID*和*nStyle*設置為 0,當方法返回時 *,將 iImage*設置到 -1。

## <a name="cmfctoolbargetbuttonsize"></a><a name="getbuttonsize"></a>CMFC工具列:取得按鈕大小

返回工具列上每個按鈕的尺寸。

```
CSize GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

指定工具列上每個按鈕尺寸的[CSize 類](../../atl-mfc-shared/reference/csize-class.md)物件。

### <a name="remarks"></a>備註

呼叫[CMFCTool 欄:設定大小](#setsizes)或[CMFCToolBar::設定鎖定大小](#setlockedsizes)以設定工具列上每個按鈕的尺寸。

## <a name="cmfctoolbargetbuttonstyle"></a><a name="getbuttonstyle"></a>CMFC工具列:取得按鈕樣式

返回位於指定索引處的工具列按鈕的當前樣式。

```
UINT GetButtonStyle(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

指定工具列按鈕樣式的值。 . 有關可能樣式的清單,請參閱[工具列控制樣式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>備註

呼叫[CMFCTool 列:設定ButtonStyle](#setbuttonstyle)以設定工具列按鈕的樣式

## <a name="cmfctoolbargetbuttontext"></a><a name="getbuttontext"></a>CMFCTool 列:取得按鈕文字

返回具有指定索引的按鈕的文本標籤。

```
CString GetButtonText(int nIndex) const;

void GetButtonText(
    int nIndex,
    CString& rString) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]工具列按鈕的索引。

*rString*<br/>
[出]工具列按鈕的標籤文字。

### <a name="return-value"></a>傳回值

工具列按鈕的標籤文字。

### <a name="remarks"></a>備註

呼叫[CMFCTool 欄:設定按鈕文字](#setbuttontext)或[CMFCToolBar::設定工具列Btn文本](#settoolbarbtntext)以設置文本標籤。

## <a name="cmfctoolbargetcoldimages"></a><a name="getcoldimages"></a>CMFCToolbar:取得冷圖像

返回指向應用程式中冷工具列按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetColdImages();
```

### <a name="return-value"></a>傳回值

指向冷工具列按鈕圖像集合的指標。

### <a name="remarks"></a>備註

冷圖像是當使用者不與工具列按鈕交互時使用的圖像。 調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::載入位圖](#loadbitmap)以載入冷影像。

## <a name="cmfctoolbargetcolumnwidth"></a><a name="getcolumnwidth"></a>CMFCTool 列:取得柱寬度

返回工具列按鈕的寬度。

```
virtual int GetColumnWidth() const;
```

### <a name="return-value"></a>傳回值

指定工具列按鈕寬度的值。

### <a name="remarks"></a>備註

框架調用此方法來計算工具列佈局。 在派生類中重寫此方法,為工具列指定不同的列寬度。

## <a name="cmfctoolbargetcommandbuttons"></a><a name="getcommandbuttons"></a>CMFC工具列:抓取指令按鈕

從應用程式中的所有工具列返回具有指定命令 ID 的按鈕清單。

```
static int GetCommandButtons(
    UINT uiCmd,
    CObList& listButtons);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]按鈕的命令識別碼。

*清單按鈕*<br/>
[出]對接收工具列按鈕清單的[CObList 類](../../mfc/reference/coblist-class.md)物件的引用。

### <a name="return-value"></a>傳回值

具有指定命令 ID 的按鈕數。

## <a name="cmfctoolbargetcount"></a><a name="getcount"></a>CMFC工具列:取得計數

傳回工具列上的按鈕和分隔符數。

```
int GetCount() const;
```

### <a name="return-value"></a>傳回值

工具列上的按鈕和分隔符的數量。

## <a name="cmfctoolbargetcustomizebutton"></a><a name="getcustomizebutton"></a>CMFC工具列:取得自訂按鈕

檢索指向與工具列關聯的`CMFCCustomizeButton`物件的指標。

```
CMFCCustomizeButton* GetCustomizeButton();
```

### <a name="return-value"></a>傳回值

指向與工具列關聯的`CMFCCustomizeButton`物件的指標。

### <a name="remarks"></a>備註

此方法檢索顯示在工具列末尾的 **「自訂」** 按鈕。 使用[CMFCToolBar:啟用「自訂按鈕」](#enablecustomizebutton)方法將 **「自訂**」按鈕添加到工具列。

您可以調用[CMFCToolBar::Is存在自定義按鈕](#isexistcustomizebutton)方法,以確定工具列是否`CMFCCustomizeButton`包含有效 物件。

## <a name="cmfctoolbargetdefaultimage"></a><a name="getdefaultimage"></a>CMFCTool 列:取得預設影像

返回具有指定命令 ID 的工具列按鈕的預設圖像的索引。

```
static int GetDefaultImage(UINT uiID);
```

### <a name="parameters"></a>參數

*uiID*<br/>
[在]指定按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

共用圖像清單中工具列圖像的索引。

### <a name="remarks"></a>備註

使用此共享方法檢索具有指定命令 ID 的工具列按鈕的預設圖像索引。 返回值是應用程式中所有工具列的工具列按鈕圖像共用集合中的索引。 呼叫[CMFCToolBar::GetImages](#getimages)方法以取得指向此集合的指標。

## <a name="cmfctoolbargetdisabledimages"></a><a name="getdisabledimages"></a>CMFCToolBar:取得關閉影像

返回指向應用程式中用於禁用工具列按鈕的圖像集合的指標。

```
static CMFCToolBarImages* __stdcall GetDisabledImages();
```

### <a name="return-value"></a>傳回值

指向禁用工具列按鈕圖像集合的指標。

### <a name="remarks"></a>備註

使用[CMFCToolBar 編輯BoxButton 類](../../mfc/reference/cmfctoolbareditboxbutton-class.md)和[CMFCToolBar::LoadBitmap](#loadbitmap)方法載入禁用的工具列按鈕影像。

## <a name="cmfctoolbargetdisabledmenuimages"></a><a name="getdisabledmenuimages"></a>CMFCToolbar:取得關閉的選單影像

返回指向應用程式中禁用功能表按鈕的圖像集合的指標。

```
static CMFCToolBarImages* __stdcall GetDisabledMenuImages();
```

### <a name="return-value"></a>傳回值

指向禁用功能表圖像集合的指標。

### <a name="remarks"></a>備註

使用[CMFCToolBarEditBoxButton 類](../../mfc/reference/cmfctoolbareditboxbutton-class.md)方法載入禁用的影像。

## <a name="cmfctoolbargetdroppeddownmenu"></a><a name="getdroppeddownmenu"></a>CMFCToolbar:取得向下選單

檢索指向當前顯示其子功能表的功能表按鈕物件的指標。

```
CMFCToolBarMenuButton* GetDroppedDownMenu(int* pIndex = NULL) const;
```

### <a name="parameters"></a>參數

*pIndex*<br/>
[出]在工具列按鈕集合中接收按鈕的索引。

### <a name="return-value"></a>傳回值

指向功能表按鈕物件的指標,該物件顯示其子功能表或 NULL(如果沒有選單顯示其子功能表)。

### <a name="remarks"></a>備註

如果此方法返回非 NULL 值 *,pIndex*不是 NULL,則*pIndex*指向的值將設置為工具列按鈕集合中功能表按鈕的索引。

## <a name="cmfctoolbargetgraydisabledbuttons"></a><a name="getgraydisabledbuttons"></a>CMFC工具列:抓取格雷關閉按鈕

指定禁用按鈕的圖像是常規按鈕圖像的調光版本,還是從禁用按鈕圖像的集合中獲取。

```
BOOL GetGrayDisabledButtons() const;
```

### <a name="return-value"></a>傳回值

TRUE 可調暗禁用按鈕的圖像;FALSE 從禁用圖像的集合中獲取圖像。

### <a name="remarks"></a>備註

使用[CMFCToolBar:設定格雷禁用按鈕](#setgraydisabledbuttons)在調光圖像和禁用圖像集合中的圖像之間切換。

## <a name="cmfctoolbargethighlightedbutton"></a><a name="gethighlightedbutton"></a>CMFCToolBar:取得突顯按鈕

返回指向當前突出顯示的工具列按鈕的指標。

```
CMFCToolBarButton* GetHighlightedButton() const;
```

### <a name="return-value"></a>傳回值

指向工具列按鈕物件的指標;如果沒有突出顯示按鈕,則為 NULL。

### <a name="remarks"></a>備註

如果工具列按鈕具有鍵盤焦點,則該按鈕將突出顯示。 如果工具列按鈕在此應用程式中熱跟蹤,工具列按鈕也會突出顯示(有關詳細資訊,請參閱[CMFCToolBar:getHotBorder](#gethotborder)和[CMFCToolBar::SetHotBorder),](#sethotborder)並且當沒有工具列按鈕或功能表項具有鍵盤焦點時,滑鼠指向它。

## <a name="cmfctoolbargethotborder"></a><a name="gethotborder"></a>CMFCToolBar:取得 Hot 邊框

決定工具列按鈕是否*熱軌*。 如果按鈕是熱軌道的,則當滑鼠在按鈕上移動時,該按鈕會突出顯示。

```
BOOL GetHotBorder() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕熱跟蹤,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

默認情況下,工具列按鈕是熱跟蹤的。

## <a name="cmfctoolbargethottextcolor"></a><a name="gethottextcolor"></a>CMFCToolbar:取得HottextColor

返回突出顯示工具列按鈕的文字顏色。

```
static COLORREF GetHotTextColor();
```

### <a name="return-value"></a>傳回值

表示目前突顯的文字顏色的[COLORREF](/windows/win32/gdi/colorref)值。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::設定HotTextColor,](#sethottextcolor)為突出顯示的工具列按鈕設定新的文字顏色。

## <a name="cmfctoolbargethwndlastfocus"></a><a name="gethwndlastfocus"></a>CMFCToolBar:取得 Hwnd 最後焦點

將句柄返回到工具列之前具有輸入焦點的視窗。

```
HWND GetHwndLastFocus() const;
```

### <a name="return-value"></a>傳回值

未從[CMFCBaseToolBar 類](../../mfc/reference/cmfcbasetoolbar-class.md)派生的視窗句柄,該類以前具有輸入焦點;或 NULL,如果沒有這樣的視窗。

### <a name="remarks"></a>備註

當`CMFCToolBar`控件接收輸入焦點時,它會將句柄存儲到丟失焦點的視窗,以便以後可以還原焦點。

## <a name="cmfctoolbargetignoresettext"></a><a name="getignoresettext"></a>CMFCTool 列:取得忽略集文字

指定是否忽略對設置按鈕標籤的呼叫。

```
BOOL GetIgnoreSetText() const;
```

### <a name="return-value"></a>傳回值

如果忽略對設置按鈕標籤的調用,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfctoolbargetimages"></a><a name="getimages"></a>CMFCToolBar:取得影像

返回指向應用程式中默認按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetImages();
```

### <a name="return-value"></a>傳回值

指向[CMFCToolBarImages 類](../../mfc/reference/cmfctoolbarimages-class.md)物件的指標,其中包含應用程式中所有工具列的預設圖像集合。

### <a name="remarks"></a>備註

此共用方法提供對應用程式所有預設工具列映像集合的訪問。 調用[CMFCToolBar::LoadBitmap](#loadbitmap)方法以向集合中添加圖像。

## <a name="cmfctoolbargetimagesize"></a><a name="getimagesize"></a>CMFCTool 列:取得影像大小

傳回工具列按鈕影像的當前大小。

```
CSize GetImageSize() const;
```

### <a name="return-value"></a>傳回值

表示工具列按鈕圖像當前大小的[CSize 類](../../atl-mfc-shared/reference/csize-class.md)物件。

## <a name="cmfctoolbargetimagesoffset"></a><a name="getimagesoffset"></a>CMFCToolBar:取得影像偏移

在工具列按鈕圖像的全域清單中返回用於查找此工具列工具列的工具列按鈕圖像的索引偏移量。

```
int GetImagesOffset() const;
```

### <a name="return-value"></a>傳回值

工具欄圖像的索引偏移量。

### <a name="remarks"></a>備註

所有工具列預設圖像都存儲在全域[CMFCToolBar 圖像類](../../mfc/reference/cmfctoolbarimages-class.md)清單中。 工具列中每個按鈕的圖像都連續存儲在該清單中。 要計算圖像的索引,將工具列中的按鈕索引添加到該工具列按鈕的圖像清單開頭的偏移量中。

呼叫[CMFCToolBar::ButtonToIndex](#buttontoindex)以獲取工具列按鈕的索引,該按鈕給定指向該按鈕的指標。

調用[CMFCToolBar::獲取圖像](#getimages)以獲取指向工具列圖像集合的指標。

## <a name="cmfctoolbargetinvalidateitemrect"></a><a name="getinvalidateitemrect"></a>CMFCToolbar:取得無效項目

檢索給定索引處的按鈕必須重繪的工作區區域。

```
virtual void GetInvalidateItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]要為其檢索工作區的按鈕的索引。

*lpRect*<br/>
[出]指向接收工作區區域的 RECT 物件的指標。

### <a name="remarks"></a>備註

*lpRect*參數不能為 NULL。 如果提供的索引中沒有按鈕 *,lpRect*將收到初始化為零的 RECT 物件。

## <a name="cmfctoolbargetitemid"></a><a name="getitemid"></a>CMFCTool 列:取得項目ID

在指定的索引處返回工具列按鈕的命令 ID。

```
UINT GetItemID(int nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

工具列按鈕的命令 ID;如果指定索引的按鈕不存在,則為零。

## <a name="cmfctoolbargetitemrect"></a><a name="getitemrect"></a>CMFCToolbar:取得專案重新完成

在指定的索引處返回按鈕的邊界矩形。

```
virtual void GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定工具列按鈕的索引。

*lpRect*<br/>
[出]指向`CRect`接收影像邊界矩形座標的物件的指標。

### <a name="remarks"></a>備註

如果`CRect`指定索引處的按鈕不存在,*則 lpRect*點設置為 0 的物件。

### <a name="example"></a>範例

下面的示例演示如何使用`GetItemRect``CMFCToolBar`類的方法。 此代碼段是[IE 演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#9](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_4.cpp)]

## <a name="cmfctoolbargetlargecoldimages"></a><a name="getlargecoldimages"></a>CMFCToolbar:取得大型冷圖像

返回指向應用程式中大型冷工具欄按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetLargeColdImages();
```

### <a name="return-value"></a>傳回值

指向大型冷圖像集合的指標。

### <a name="remarks"></a>備註

冷圖像是當使用者不與工具列按鈕交互時使用的圖像。 調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)以載入大型冷圖像。

## <a name="cmfctoolbargetlargedisabledimages"></a><a name="getlargedisabledimages"></a>CMFCToolbar:取得大型禁用影像

返回指向應用程式中大型禁用工具列按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetLargeDisabledImages();
```

### <a name="return-value"></a>傳回值

指向大型禁用工具列按鈕圖像集合的指標。

### <a name="remarks"></a>備註

大圖像是常規工具列按鈕圖像的大版本。 調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)或[CMFCToolBar::載入點陣圖](#loadbitmap)以載入大圖像。

## <a name="cmfctoolbargetlargeimages"></a><a name="getlargeimages"></a>CMFCToolBar:取得大型影像

返回指向應用程式中大型工具列按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetLargeImages();
```

### <a name="return-value"></a>傳回值

指向大型工具列按鈕圖像集合的指標。

### <a name="remarks"></a>備註

大圖像是常規工具列按鈕圖像的大版本。 調用[CMFCToolBar::載入 BitmapEx](#loadbitmapex)以載入大圖像。

## <a name="cmfctoolbargetlockedcoldimages"></a><a name="getlockedcoldimages"></a>CMFCToolbar:取得鎖定的冷圖像

返回指向工具列中鎖定冷圖像集合的指標。

```
CMFCToolBarImages* GetLockedColdImages();
```

### <a name="return-value"></a>傳回值

指向鎖定冷圖像集合的指標,如果工具列未鎖定,則指向 NULL。

### <a name="remarks"></a>備註

鎖定的圖像是當使用者無法自定義工具列時框架使用的常規工具列按鈕圖像的版本。 冷圖像是當使用者不與工具列按鈕交互時使用的圖像。

如果工具列未鎖定,此方法將傳回 NULL。 如果工具列未鎖定,此方法還會在調試生成中生成斷言失敗。 有關鎖定工具列的詳細資訊,請參閱[CMFCToolBar::鎖定](#islocked)。

調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以載入鎖定的冷圖像。

## <a name="cmfctoolbargetlockeddisabledimages"></a><a name="getlockeddisabledimages"></a>CMFCToolBar:取得鎖定禁用影像

返回指向工具列中鎖定禁用圖像集合的指標。

```
CMFCToolBarImages* GetLockedDisabledImages();
```

### <a name="return-value"></a>傳回值

指向鎖定禁用圖像集合的指標,如果工具列未鎖定,則指向 NULL。

### <a name="remarks"></a>備註

鎖定的圖像是當使用者無法自定義工具列時框架使用的常規工具列按鈕圖像的版本。 禁用的圖像是當按鈕具有TBBS_DISABLED樣式時框架使用的圖像。

如果工具列未鎖定,此方法將傳回 NULL。 如果工具列未鎖定,此方法還會在調試生成中生成斷言失敗。 有關鎖定工具列的詳細資訊,請參閱[CMFCToolBar::鎖定](#islocked)。

調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以載入鎖定的禁用影像。

## <a name="cmfctoolbargetlockedimages"></a><a name="getlockedimages"></a>CMFCToolBar:取得鎖定影像

返回指向工具列中鎖定按鈕圖像集合的指標。

```
CMFCToolBarImages* GetLockedImages();
```

### <a name="return-value"></a>傳回值

指向鎖定工具列按鈕圖像集合的指標,如果工具列未鎖定,則指向 NULL。

### <a name="remarks"></a>備註

鎖定的圖像是當使用者無法自定義工具列時框架使用的常規工具列按鈕圖像的版本。

如果工具列未鎖定,此方法將傳回 NULL。 如果工具列未鎖定,此方法還會在調試生成中生成斷言失敗。 有關鎖定工具列的詳細資訊,請參閱[CMFCToolBar::鎖定](#islocked)。

## <a name="cmfctoolbargetlockedimagesize"></a><a name="getlockedimagesize"></a>CMFCTool 列:取得鎖定影像大小

傳回鎖定工具列影像的預設大小。

```
CSize GetLockedImageSize() const;
```

### <a name="return-value"></a>傳回值

指定`CSize`鎖定工具列圖像的大小或未鎖定工具列時的`CSize`空白 結構的結構。

### <a name="remarks"></a>備註

鎖定的圖像是當使用者無法自定義工具列時框架使用的常規工具列按鈕圖像的版本。

如果工具列未鎖定`CSize`,則此方法返回寬度為零且高度為零的結構。 如果工具列未鎖定,此方法還會在調試生成中生成斷言失敗。 有關鎖定工具列的詳細資訊,請參閱[CMFCToolBar::鎖定](#islocked)。

呼叫[CMFCToolBar::設定鎖定大小](#setlockedsizes)方法以指定鎖定的圖像大小。

## <a name="cmfctoolbargetlockedmenuimages"></a><a name="getlockedmenuimages"></a>CMFCToolbar:取得鎖定選單影像

返回指向工具列中鎖定工具列功能表圖像集合的指標。

```
CMFCToolBarImages* GetLockedMenuImages();
```

### <a name="return-value"></a>傳回值

指向鎖定工具列選單圖像集合的指標,如果工具列未鎖定,則指向 NULL。

### <a name="remarks"></a>備註

鎖定的圖像是當使用者無法自定義工具列時框架使用的常規工具列功能表圖像的版本。

如果工具列未鎖定,此方法將傳回 NULL。 如果工具列未鎖定,此方法還會在調試生成中生成斷言失敗。 有關鎖定工具列的詳細資訊,請參閱[CMFCToolBar::鎖定](#islocked)。

調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法以載入鎖定的選單圖像。

## <a name="cmfctoolbargetmenubuttonsize"></a><a name="getmenubuttonsize"></a>CMFC工具列:抓取選單按鈕大小

返回應用程式中功能表按鈕的大小。

```
static CSize GetMenuButtonSize();
```

### <a name="return-value"></a>傳回值

以`CSize`圖元為單位表示功能表按鈕大小的物件。

### <a name="remarks"></a>備註

工具列上的功能表按鈕大小將維護為全域變數,並可以使用此靜態方法檢索。

調用[CMFCToolBar::設置MenuSizes](#setmenusizes)以設定此全域變數。

## <a name="cmfctoolbargetmenuimages"></a><a name="getmenuimages"></a>CMFCToolBar:取得選單影像

返回指向應用程式中功能表按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetMenuImages();
```

### <a name="return-value"></a>傳回值

指向功能表圖像集合的指標。

### <a name="remarks"></a>備註

調用[CMFCToolBar::LoadBitmapEx](#loadbitmapex)方法來載入選單影像。

呼叫[CMFCToolBar:setMenuSizes](#setmenusizes)方法以設定按鈕的大小及其圖像。

## <a name="cmfctoolbargetmenuimagesize"></a><a name="getmenuimagesize"></a>CMFC工具列:抓取選單影像大小

返回應用程式中功能表按鈕圖像的大小。

```
static CSize GetMenuImageSize();
```

### <a name="return-value"></a>傳回值

表示`CSize`功能表影像大小的物件。

### <a name="remarks"></a>備註

此方法返回作為全域變數維護的工具列功能表按鈕上的圖像大小。 調用[CMFCToolBar::設置MenuSizes](#setmenusizes)以設定此全域變數。

## <a name="cmfctoolbargetorigbuttons"></a><a name="getorigbuttons"></a>CMFCToolBar::取得OrigButtons

檢索工具列的非自定義按鈕的集合。

```
const CObList& GetOrigButtons() const;
```

### <a name="return-value"></a>傳回值

對工具列非自訂按鈕清單的引用。

### <a name="remarks"></a>備註

框架在使用者自定義工具列按鈕之前創建一個副本。 [CMFCToolBar:SetButtons](#setbuttons)方法將所提供的陣列中每個按鈕的副本添加到原始按鈕清單中。 [CMFCToolBar:還原原始狀態](#restoreoriginalstate)方法通過從資源檔載入工具列來還原工具列的原始狀態。

要設置工具列的原始按鈕清單,請致電[CMFCToolBar::setorigButtons](#setorigbuttons)方法。

## <a name="cmfctoolbargetorigresetbuttons"></a><a name="getorigresetbuttons"></a>CMFCToolBar::取得OrigReset按鈕

檢索工具列的非自定義重置按鈕的集合。

```
const CObList& GetOrigResetButtons() const;
```

### <a name="return-value"></a>傳回值

對工具列非自定義重置按鈕清單的引用。

### <a name="remarks"></a>備註

當使用者在自定義模式下按下 **「重置」** 按鈕時,框架使用此方法還原從工具列中刪除的按鈕。

[CMFCToolBar::SetButtons](#setbuttons)方法在調用[CMFCToolBar::onReset](#onreset)方法后,將每個工具列按鈕的副本添加到原始重置按鈕清單中。 您可以重寫[CMFCToolBar::OnReset](#onreset)方法,以在使用者按下 **「重置」** 按鈕後自定義按鈕的外觀。

## <a name="cmfctoolbargetresourceid"></a><a name="getresourceid"></a>CMFCToolBar:取得資源ID

檢索工具列的資源 ID。

```
UINT GetResourceID() const;
```

### <a name="return-value"></a>傳回值

工具列的資源識別碼。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::LoadToolBarEx](#loadtoolbarex)方法以設定工具列的資源 ID。

## <a name="cmfctoolbargetroutecommandsviaframe"></a><a name="getroutecommandsviaframe"></a>CMFC工具列:獲取路由命令ViaFrame

確定向工具列發送命令的物件、父幀或擁有者。

```
BOOL GetRouteCommandsViaFrame();
```

### <a name="return-value"></a>傳回值

如果父幀向工具列發送命令,則非零;如果擁有者向工具列發送命令,則為 0。

### <a name="remarks"></a>備註

預設情況下,父框架向工具列發送命令。 調用[CMFCTool 欄:設定路由命令ViaFrame](#setroutecommandsviaframe)以更改此行為。

如果此方法返回非零值,則可以使用`CMFCToolBar::GetCommandTarget`方法檢索指向父幀對象的指標。 有關使用此方法的示例,請參閱 VisualStudioDemo 範例。

## <a name="cmfctoolbargetrowheight"></a><a name="getrowheight"></a>CMFCToolBar:取得羅高

返回工具列按鈕的高度。

```
virtual int GetRowHeight() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕的高度(以像素為單位)。

### <a name="remarks"></a>備註

框架調用此方法來計算工具列佈局。 在派生類中重寫此方法,以指定工具列的不同高度。

## <a name="cmfctoolbargetshowtooltips"></a><a name="getshowtooltips"></a>CMFC工具列::取得顯示工具提示

指定是否為工具列按鈕顯示工具提示。

```
static BOOL GetShowTooltips();
```

### <a name="return-value"></a>傳回值

如果工具列按鈕的工具提示顯示為 TRUE;如果工具列按鈕顯示工具提示,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

預設情況下,將顯示工具提示。 您可以通過調用[CMFCToolBar::setShowTool 提示](#setshowtooltips)來更改此靜態標誌。

## <a name="cmfctoolbargetsiblingtoolbar"></a><a name="getsiblingtoolbar"></a>CMFC工具列:取得同級工具列

檢索工具列的同級。

```
CMFCToolBar* GetSiblingToolBar();
```

### <a name="return-value"></a>傳回值

指向同級工具列的指標。

### <a name="remarks"></a>備註

有關如何啟用 **「一行顯示按鈕**」和 **「兩行」按鈕顯示按鈕**的詳細資訊,請參閱[CMFCToolBar:::設定SiblingToolBar](#setsiblingtoolbar)。

## <a name="cmfctoolbargetuserimages"></a><a name="getuserimages"></a>CMFCToolBar:取得使用者影像

返回指向應用程式中使用者定義的工具列按鈕圖像集合的指標。

```
static CMFCToolBarImages* GetUserImages();
```

### <a name="return-value"></a>傳回值

指向應用程式中所有工具列的使用者定義工具列按鈕圖像集合的指標。

### <a name="remarks"></a>備註

呼叫[CMFCToolBar::SetUserImage](#setuserimages)方法以設定應用程式中使用者定義的映射的集合。

## <a name="cmfctoolbarhittest"></a><a name="hittest"></a>CMFC工具列:命中測試

返回位於指定位置的工具列按鈕的索引。

```
virtual int HitTest(CPoint point);
```

### <a name="parameters"></a>參數

*點*<br/>
[在]要測試的點,在客戶端座標中。

### <a name="return-value"></a>傳回值

位於指定位置的按鈕的索引,如果沒有該按鈕或按鈕是分隔符,則為 -1。

## <a name="cmfctoolbarinsertbutton"></a><a name="insertbutton"></a>CMFC工具列:插入按鈕

將按鈕插入工具列。

```
virtual int InsertButton(
    const CMFCToolBarButton& button,
    INT_PTR iInsertAt=-1);

virtual int InsertButton(
    CMFCToolBarButton* pButton,
    int iInsertAt=-1);
```

### <a name="parameters"></a>參數

*按鈕*<br/>
[在]指定要插入的按鈕。

*iInsertAt*<br/>
[在]指定要在處插入按鈕的零基位置。

### <a name="return-value"></a>傳回值

如果發生錯誤,插入按鈕的位置或 -1。

### <a name="remarks"></a>備註

如果*iInsertAt*為 -1,則此方法將按鈕添加到工具列按鈕列表的末尾。

呼叫[CMFCToolBar:插入分隔符](#insertseparator)方法,將分隔符插入工具列。

## <a name="cmfctoolbarinsertseparator"></a><a name="insertseparator"></a>CMFCToolBar:插入分離器

將分隔符插入工具列。

```
virtual int InsertSeparator(INT_PTR iInsertAt=-1);
```

### <a name="parameters"></a>參數

*iInsertAt*<br/>
[在]指定要插入分隔符的零基位置。 此參數必須大於 0。

### <a name="return-value"></a>傳回值

插入分隔符的位置,如果發生錯誤,則為 -1。

### <a name="remarks"></a>備註

呼叫此方法以在兩個現有按鈕之間插入分隔符。 如果*iInsertAt*為 -1,則此方法將分隔符添加到工具列按鈕列表的末尾。

不能使用此方法將分隔符添加到空工具列。

呼叫[CMFCToolBar:插入按鈕](#insertbutton)方法,將按鈕插入工具列。

## <a name="cmfctoolbarinvalidatebutton"></a><a name="invalidatebutton"></a>CMFC工具列:無效按鈕

使提供的索引中存在的工具列按鈕的工作區無效。

```
CMFCToolBarButton* InvalidateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]工具列中按鈕的零基索引。

### <a name="return-value"></a>傳回值

指向在提供的索引`CMFCToolBarButton`或 NULL 上存在的物件的指標(如果沒有此類物件)。

### <a name="remarks"></a>備註

當框架更新與工具列按鈕關聯的工作區時,它將調用此方法。 它調用[CWnd:::無效重新解決](../../mfc/reference/cwnd-class.md#invalidaterect)方法,對象位於提供的`CMFCToolBarButton`索引處 的物件的用戶端矩形。

## <a name="cmfctoolbarisaddremovequickcustomize"></a><a name="isaddremovequickcustomize"></a>CMFCToolbar::isAddremove快速自定義

確定使用者是否可以使用 **「自訂」** 選單選項添加或刪除工具列按鈕。

```
BOOL IsAddRemoveQuickCustomize();
```

### <a name="return-value"></a>傳回值

如果用戶可以使用 **「自定義」** 選單選項修改工具列,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfctoolbarisaltcustomizemode"></a><a name="isaltcustomizemode"></a>CMFCToolBar::IsAlt定製模式

指定是否使用*快速自定義*來拖動按鈕。 啟用快速自定義後,用戶可以按住 Alt 鍵並將按鈕拖動到新位置。

```
static BOOL __stdcall IsAltCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果快速自定義用於拖動按鈕,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfctoolbarisautograyinactiveimages"></a><a name="isautograyinactiveimages"></a>CMFCToolbar:非自動格雷非活動圖像

指定是否啟用非活動(非突出顯示)按鈕映射的自動生成。

```
static BOOL IsAutoGrayInactiveImages();
```

### <a name="return-value"></a>傳回值

如果啟用了自動調暗非活動圖像的選項,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

您可以通過調用[CMFCToolBar::自動格雷非活動圖像](#autograyinactiveimages)來啟用或禁用非活動映射的自動調光。

## <a name="cmfctoolbarisbasiccommand"></a><a name="isbasiccommand"></a>CMFCToolbar::是基本命令

確定命令是否位於基本命令清單中。

```
static BOOL IsBasicCommand(UINT uiCmd);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果指定的命令屬於基本命令的清單,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此靜態方法確定*uiCmd*指定的命令是否屬於基本命令的全域清單。 您可以透過除錯[CMFCToolBar 來變更基本命令清單:addBasic命令](#addbasiccommand)或[CMFCToolBar::SetBasic 命令](#setbasiccommands)。

## <a name="cmfctoolbarisbuttonextrasizeavailable"></a><a name="isbuttonextrasizeavailable"></a>CMFC工具列:是按鈕超尺寸可用

確定工具列是否可以顯示具有擴展邊框的按鈕。

```
virtual BOOL IsButtonExtraSizeAvailable() const;
```

### <a name="return-value"></a>傳回值

如果條形可以顯示具有額外邊框大小的按鈕,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

工具列物件如果能夠顯示具有擴展邊框的按鈕,則返回 TRUE。 工具列按鈕在處理[CMFCToolBarButton 時調用此方法:onChangeParentwnd](../../mfc/reference/cmfctoolbarbutton-class.md#onchangeparentwnd)通知,並將相應地設置其內部額外邊框大小標誌。 稍後可以通過調用[CMFCToolBarButton 來檢索此內部標誌:是超大型](../../mfc/reference/cmfctoolbarbutton-class.md#isextrasize)。

如果條形圖可以顯示具有額外`CMFCToolBar`邊框大小的工具列按鈕,然後返回 FALSE,則在派生的類中覆蓋此方法並返回 TRUE。 預設實現返回 TRUE。

## <a name="cmfctoolbarisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CMFCTool 列:按鍵突出顯示

確定指定的按鈕是否突出顯示。

```
BOOL IsButtonHighlighted(int iButton) const;
```

### <a name="parameters"></a>參數

*iButton*<br/>
[在]指定工具列按鈕的索引。

### <a name="return-value"></a>傳回值

如果指定的按鈕突出顯示,則為 TRUE;如果指定的按鈕突出顯示,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfctoolbariscommandpermitted"></a><a name="iscommandpermitted"></a>CMFCTool 列:是允許的

確定是否允許命令。

```
static BOOL IsCommandPermitted(UINT uiCmd);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果允許指定命令,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此靜態方法確定*uiCmd*指定的命令是否屬於不允許命令的全域清單。

您可以通過調用[CMFCToolBar::setNon允許命令](#setnonpermittedcommands)來更改不允許的命令清單。

## <a name="cmfctoolbariscommandrarelyused"></a><a name="iscommandrarelyused"></a>CMFCToolbar::是命令很少使用

確定是否很少使用命令。

```
static BOOL IsCommandRarelyUsed(UINT uiCmd);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]指定要檢查的命令。

### <a name="return-value"></a>傳回值

如果很少使用指定的命令,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當`IsCommandRarelyUsed`出現以下一個或多個情況時,該方法將返回 FALSE:

- 指定的指令屬於基本指令的清單

- 指定的指令是標準指令之一

- 框架處於自訂模式

- 基本命令清單為空

- 超過 20% 的命令呼叫是對指定命令的呼叫。

## <a name="cmfctoolbariscustomizemode"></a><a name="iscustomizemode"></a>CMFCToolbar:是定製模式

指定工具列框架是否處於自定義模式。

```
static BOOL IsCustomizeMode();
```

### <a name="return-value"></a>傳回值

如果框架處於自定義模式,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

您可以透過除錯[CMFCToolBar 來切換自訂模式::設定自訂模式](#setcustomizemode)。

當使用者調用自定義對話方塊[(CMFCToolBars 自訂對話方塊類](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)) 時,框架將更改模式。

## <a name="cmfctoolbarisdragbutton"></a><a name="isdragbutton"></a>CMFCToolBar::IsDragButton

確定是否拖動工具列按鈕。

```
BOOL IsDragButton(const CMFCToolBarButton* pButton) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列按鈕的指標。

### <a name="return-value"></a>傳回值

如果正在拖動指定的按鈕,則為 TRUE;如果正在拖動指定的按鈕,則為 TRUE。否則,FALSE。

### <a name="remarks"></a>備註

## <a name="cmfctoolbarisexistcustomizebutton"></a><a name="isexistcustomizebutton"></a>CMFC工具列:存在客製化按鈕

確定工具列是否包含 **「自訂」** 按鈕。

```
BOOL IsExistCustomizeButton();
```

### <a name="return-value"></a>傳回值

如果工具列包含 **「自訂」** 按鈕,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

如果此方法返回 TRUE,[則 CMFCToolBar::獲取自訂按鈕](#getcustomizebutton)方法將返回指向工具列末尾顯示的 **「自訂**」按鈕的指標。

使用[CMFCToolBar:啟用「自訂按鈕」](#enablecustomizebutton)方法將 **「自訂**」按鈕添加到工具列。

## <a name="cmfctoolbarisfloating"></a><a name="isfloating"></a>CMFCToolBar:是浮動的

確定工具列是否浮動。

```
virtual BOOL IsFloating() const;
```

### <a name="return-value"></a>傳回值

如果工具列是浮動的,則為 TRUE;否則,FALSE。

## <a name="cmfctoolbarislargeicons"></a><a name="islargeicons"></a>CMFCToolbar::大圖示

指定應用程式中的工具列目前是否顯示大圖示。

```
static BOOL IsLargeIcons();
```

### <a name="return-value"></a>傳回值

如果應用程式使用大圖示,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

調用[CMFCToolBar:設置大圖示](#setlargeicons)以在大圖示和常規圖示之間切換。

當使用者在 **「自訂」** 對話方塊的 **「選項**」頁上切換 **「大圖示**」複選框時,框架會自動更改模式。

## <a name="cmfctoolbarislastcommandfrombutton"></a><a name="islastcommandfrombutton"></a>CMFCToolbar:是來自按鈕的"正命令"

確定最近執行的命令是否從指定的工具列按鈕發送。

```
static BOOL IsLastCommandFromButton(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向按鈕的指標。

### <a name="return-value"></a>傳回值

如果最後一個命令是從*pButton*指定的按鈕發送的,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法通過調用`CWnd::GetCurrentMessage`獲取指向[MSG 結構](/windows/win32/api/winuser/ns-winuser-msg)的指標。 然後,它將按鈕的 HWND`MSG::lParam``MSG::hwnd`與和成員進行比較,以確定該按鈕是否是命令的來源。

## <a name="cmfctoolbarislocked"></a><a name="islocked"></a>CMFCToolbar::鎖定

確定工具列是否鎖定。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>傳回值

如果工具列已鎖定,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

當使用者無法執行自定義任務(如重新置放工具列按鈕)時,此方法將返回 TRUE。

鎖定的工具列使用單獨的圖像清單。 有關這些影像清單的詳細資訊,請參閱[CMFCToolBar::LoadBitmapEx](#loadbitmapex)。

## <a name="cmfctoolbarisonerowwithsibling"></a><a name="isonerowwithsibling"></a>CMFCToolbar:與同級同一個

確定工具列及其同級工具列是否位於同一行上。

```
BOOL IsOneRowWithSibling();
```

### <a name="return-value"></a>傳回值

如果工具列及其同級位於同一行上,則為 TRUE;如果工具列及其同級位於同一行上,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

[CMFC自定義按鈕:createPopupMenu](internal-classes.md)方法調用此方法以確定如何顯示 **「自訂**」彈出式功能表。 如果此方法傳回 TRUE,則框架將顯示 **「一行」按鈕上的「顯示按鈕**」 。 否則,框架將顯示 **「兩行」按鈕上的「顯示按鈕**」。

您通常不需要使用這個方法。 要開啟 **「一行顯示按鈕**」 或在 **「兩行」 按鈕上顯示按鈕**,請執行電[CMFCTool 欄::設定同級工具列](#setsiblingtoolbar)。

## <a name="cmfctoolbarisresourcechanged"></a><a name="isresourcechanged"></a>CMFCTool 列:資源已變更

```
virtual BOOL IsResourceChanged() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarissibling"></a><a name="issibling"></a>CMFCToolBar::是兄弟

```
BOOL IsSibling();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarisuserdefined"></a><a name="isuserdefined"></a>CMFCTool 列:使用者定義

指定工具列是否由使用者定義。

```
BOOL IsUserDefined() const;
```

### <a name="return-value"></a>傳回值

如果工具列是由用戶創建的,則為 TRUE;否則 FALSE。

## <a name="cmfctoolbarloadbitmap"></a><a name="loadbitmap"></a>CMFC工具列:載入點陣圖

從應用程式資源載入工具列影像。

```
virtual BOOL LoadBitmap(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[在]引用熱工具列圖像的位圖的資源 ID。

*烏伊庫德雷斯ID*<br/>
[在]引用冷工具列圖像的位圖的資源 ID。

*uiMenuResID*<br/>
[在]引用常規功能表影像的位圖的資源 ID。

*封鎖*<br/>
[在]鎖定工具列的 TRUE;否則 FALSE。

*ui禁用雷斯代碼*<br/>
[在]引用禁用工具列圖像的點陣圖的資源 ID。

*uiMenu 關閉雷斯代碼*<br/>
[在]引用禁用功能表影像的點陣圖的資源 ID。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

[CMFCToolBar::LoadToolBarEx](#loadtoolbarex) 方法會呼叫這個方法來載入與工具列相關聯的影像。 覆寫這個方法可執行影像資源的自訂載入。

呼叫 `LoadBitmapEx` 方法可在建立工具列之後載入其他影像。

## <a name="cmfctoolbarloadbitmapex"></a><a name="loadbitmapex"></a>CMFC工具列::載入位射射Ex

```
virtual BOOL LoadBitmapEx(
    CMFCToolBarInfo& params,
    BOOL bLocked = FALSE);
```

### <a name="parameters"></a>參數

[在]*參數*<br/>
[在]*B 鎖定*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarloadlargeiconsstate"></a><a name="loadlargeiconsstate"></a>CMFC工具列:載入大圖示狀態

```
static BOOL __stdcall LoadLargeIconsState(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[在]*lpsz 設定檔名稱*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarloadparameters"></a><a name="loadparameters"></a>CMFCToolBar:載入參數

從 Windows 註冊表載入全域工具列選項。

```
static BOOL LoadParameters(LPCTSTR lpszProfileName=NULL);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定 Windows 註冊表項的相對路徑。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

此方法載入全域參數,如選單動畫類型、功能表陰影樣式以及是否顯示 Windows 註冊表中的大圖示。

[CWinAppEx:LoadState](../../mfc/reference/cwinappex-class.md#loadstate)方法將此方法稱為應用程式初始化過程的一部分。

## <a name="cmfctoolbarloadstate"></a><a name="loadstate"></a>CMFC工具列:載入狀態

從 Windows 註冊表載入工具列狀態資訊。

```
virtual BOOL LoadState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定 Windows 註冊表項的相對路徑。

*nIndex*<br/>
[在]指定工具列的控制 ID。

*uiID*<br/>
[在]指定工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

框架將此方法稱為應用程式的初始化過程的一部分。 有關詳細資訊,請參閱[CWinAppEx::載入狀態](../../mfc/reference/cwinappex-class.md#loadstate)。

## <a name="cmfctoolbarloadtoolbar"></a><a name="loadtoolbar"></a>CMFC工具列:載入工具列

從應用程式資源載入工具列。

```
virtual BOOL LoadToolBar(
    UINT uiResID,
    UINT uiColdResID=0,
    UINT uiMenuResID=0,
    BOOL bLocked=FALSE,
    UINT uiDisabledResID=0,
    UINT uiMenuDisabledResID=0,
    UINT uiHotResID=0);
```

### <a name="parameters"></a>參數

*uiResID*<br/>
[在]工具列的資源識別碼。

*烏伊庫德雷斯ID*<br/>
[在]引用冷工具列圖像的位圖的資源 ID。

*uiMenuResID*<br/>
[在]引用常規功能表影像的位圖的資源 ID。

*封鎖*<br/>
[在]指定工具列是否鎖定的布林值。 如果此參數*為 TRUE,* 則工具列將鎖定。 否則,工具列未鎖定。

*ui禁用雷斯代碼*<br/>
[在]引用禁用工具列圖像的點陣圖的資源 ID。

*uiMenu 關閉雷斯代碼*<br/>
[在]引用禁用功能表影像的點陣圖的資源 ID。

*烏霍特雷斯ID*<br/>
[在]引用熱工具列圖像的位圖的資源 ID。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

框架在初始化期間調用此方法以載入與工具列關聯的圖像。

### <a name="example"></a>範例

下面的示例演示如何在`LoadToolBar``CMFCToolBar`類中使用 方法。 此代碼段是[IE 演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#7](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_3.cpp)]

## <a name="cmfctoolbarloadtoolbarex"></a><a name="loadtoolbarex"></a>CMFC工具列:載入工具列

通過使用`CMFCToolBarInfo`幫助器類從應用程式資源載入工具列,使應用程式能夠使用大圖像。

```
virtual BOOL LoadToolBarEx(
    UINT uiToolbarResID,
    CMFCToolBarInfo& params,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>參數

*uiToolbarResID*<br/>
[在]工具列的資源識別碼。

*params*<br/>
[在]對`CMFCToolBarInfo`包含工具列圖像的資源指示的物件的引用。

*封鎖*<br/>
[在]指定工具列是否鎖定的布林值。 如果此參數為 TRUE,則工具列將鎖定。 否則,工具列未鎖定。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

調用此方法從應用程式資源載入工具列影像。

## <a name="cmfctoolbarm_dbllargeimageratio"></a><a name="m_dbllargeimageratio"></a>CMFC工具列:m_dblLargeImageRatio

指定大型圖像的尺寸(高度或寬度)與常規圖像的尺寸之間的比率。

```
AFX_IMPORT_DATA static double m_dblLargeImageRatio;
```

### <a name="remarks"></a>備註

預設比率為 2。 您可以更改此值以使大型工具列圖像變大或變小。

如果不指定一組大型圖像,則框架使用此數據成員。 例如,如果僅提供大小為 16x16 的小圖像集,並且希望大圖像的大小為 24x24,請此數據成員設置為 1.5。

## <a name="cmfctoolbarnextmenu"></a><a name="nextmenu"></a>CMFC工具列:下一個選單

```
virtual BOOL NextMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbaronbeforeremovebutton"></a><a name="onbeforeremovebutton"></a>CMFCToolbar::打開之前刪除按鈕

```
virtual BOOL OnBeforeRemoveButton(
    CMFCToolBarButton* pButton,
    DROPEFFECT dropEffect);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]閑置。

*滴效果*<br/>
[在]閑置。

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbaronchangehot"></a><a name="onchangehot"></a>CMFCToolbar::打開

當用戶選擇工具列上的按鈕時,框架調用。

```
virtual void OnChangeHot(int iHot);
```

### <a name="parameters"></a>參數

*iHot*<br/>
[在]指定選取工具列按鈕的索引;如果未選擇工具列按鈕,則為 -1。

### <a name="remarks"></a>備註

重寫此方法以處理使用者在工具列上選擇按鈕的通知。

## <a name="cmfctoolbaronchangevisualmanager"></a><a name="onchangevisualmanager"></a>CMFCToolbar::打開視覺管理員

```
virtual void OnChangeVisualManager();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbaronfillbackground"></a><a name="onfillbackground"></a>CMFCToolbar::在填充背景

由[CBasePane::DoPaint 的](../../mfc/reference/cbasepane-class.md#dopaint)框架調用以填充工具列背景。

```
virtual void OnFillBackground(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

### <a name="remarks"></a>備註

[CMFCToolBar::DoPaint](#dopaint)在工具列的背景已填充時調用此方法。 預設實作不做任何動作。

重寫此方法以在派生類中繪製自定義背景。

## <a name="cmfctoolbaronglobalfontschanged"></a><a name="onglobalfontschanged"></a>CMFCToolbar::在放大縮小字體功能 放大縮小字體功能

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbaronreset"></a><a name="onreset"></a>CMFCToolbar:開啟

將工具列還原到其原始狀態。

```
virtual void OnReset();
```

### <a name="remarks"></a>備註

重寫此方法以處理有關工具列重置的通知。

預設實作不做任何動作。 在`OnReset`工具列具有虛擬按鈕`CMFCToolBar`時派生的類中覆蓋,當工具列返回到其原始狀態時,必須替換該按鈕。

## <a name="cmfctoolbaronsetaccdata"></a><a name="onsetaccdata"></a>CMFCToolbar::OnSetAccData

```
virtual BOOL OnSetAccData(long lVal);
```

### <a name="parameters"></a>參數

[在]*lVal*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbaronsetdefaultbuttontext"></a><a name="onsetdefaultbuttontext"></a>CMFC工具列:開啟預設按鈕文字

將工具列按鈕的文本還原到其默認狀態。

```
virtual BOOL OnSetDefaultButtonText(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向正在設置其文本的按鈕。

### <a name="return-value"></a>傳回值

如果文本已成功還原,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

重寫此方法以處理工具列按鈕的文本正在更改為其預設值的通知。

預設實現從應用程式資源載入按鈕的文本。

## <a name="cmfctoolbaronusertooltip"></a><a name="onusertooltip"></a>CMFC工具列:在使用者工具提示

當按鈕的工具提示即將顯示時,由框架調用。

```
virtual BOOL OnUserToolTip(
    CMFCToolBarButton* pButton,
    CString& strTTText) const;
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向要為其顯示工具提示的工具列按鈕。

*斯特特文字*<br/>
[出]對`CString`接收工具提示文本的物件的引用。

### <a name="return-value"></a>傳回值

如果*strTTText*填充了工具提示文字,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當工具列按鈕的工具提示即將顯示時,框架調用此方法。 如果`OnUserToolTip`返回 TRUE,則框架將顯示一個工具提示,其中`OnUserToolTip`包含*strTTText*中返回的文本。 否則,工具提示包含按鈕文本。

覆蓋`OnUserToolTip`以自定義工具列按鈕的工具提示。 預設實現調用[CMFCToolBar::onUserToolTip](#onusertooltip)以獲取工具提示文本。

## <a name="cmfctoolbarprevmenu"></a><a name="prevmenu"></a>CMFCToolBar::PrevMenu

```
virtual BOOL PrevMenu();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarprocesscommand"></a><a name="processcommand"></a>CMFC工具列::P

將WM_COMMAND消息發佈到擁有工具列的視窗。

```
BOOL ProcessCommand(CMFCToolBarButton* pButton);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向工具列上的按鈕。

### <a name="return-value"></a>傳回值

此方法應始終返回 TRUE。 MFC 在內部使用 FALSE 值。

### <a name="remarks"></a>備註

此方法通過調用[CWnd::PostMessage](../../mfc/reference/cwnd-class.md#postmessage)並將指定按鈕的命令 ID 傳遞給*wParam*參數,將WM_COMMAND消息發布到擁有工具列的視窗。

使用[ON_COMMAND](message-map-macros-mfc.md#on_command)宏將WM_COMMAND消息映射到成員函數。

## <a name="cmfctoolbarremoveallbuttons"></a><a name="removeallbuttons"></a>CMFC工具列:刪除所有按鈕

從工具列中刪除所有按鈕和分隔符。

```
virtual void RemoveAllButtons();
```

### <a name="remarks"></a>備註

當重新創建或銷毀工具列時,框架將調用此方法。

## <a name="cmfctoolbarremovebutton"></a><a name="removebutton"></a>CMFC工具列:刪除按鈕

從工具列中刪除具有指定索引的按鈕。

```
virtual BOOL RemoveButton(int iIndex);
```

### <a name="parameters"></a>參數

*iIndex*<br/>
[在]指定要刪除的按鈕的零基索引。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;如果指定的索引無效或索引引用 **「自定義」** 按鈕,則為 FALSE。

### <a name="remarks"></a>備註

此方法更新受刪除按鈕影響的其他工具列屬性。 例如,此方法從工具列中刪除非必需分隔符,並重建快速鍵表。

關於 **「自訂」** 按鈕的詳細資訊,請參閱[CMFCToolBar::啟用自訂按鈕](#enablecustomizebutton)。

## <a name="cmfctoolbarremovestatefromregistry"></a><a name="removestatefromregistry"></a>CMFCToolbar:從註冊處刪除狀態

從 Windows 註冊表中刪除工具列的狀態資訊。

```
virtual BOOL RemoveStateFromRegistry(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定狀態資訊所在的註冊表項。

*nIndex*<br/>
[在]工具列的控制 ID。

*uiID*<br/>
[在]工具列的資源識別碼。 如果此參數為 -1,則此方法使用[CWnd:getDlgCtrlID](../../mfc/reference/cwnd-class.md#getdlgctrlid)方法檢索資源 ID。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

框架在刪除使用者定義的工具列時調用此方法。

如果在 Windows 註冊表中存儲其他狀態資訊,則重寫此方法。

## <a name="cmfctoolbarreplacebutton"></a><a name="replacebutton"></a>CMFC工具列:更換按鈕

將工具列按鈕替換為其他工具列按鈕。

```
int ReplaceButton(
    UINT uiCmd,
    const CMFCToolBarButton& button,
    BOOL bAll=FALSE);
```

### <a name="parameters"></a>參數

*烏伊Cmd*<br/>
[在]要替換的按鈕的命令 ID。

*按鈕*<br/>
[在]要插入的`CMFCToolBarButton`引用。

*球*<br/>
[在]指定是否取代具有*uiCmd*指定的指令 ID 的所有按鈕的布林值。 如果此參數為 TRUE,則將替換具有指定命令 ID 的所有按鈕。 否則,將替換第一個按鈕。

### <a name="return-value"></a>傳回值

替換的按鈕數。 如果工具列上不存在具有指定命令 ID 的按鈕,則此方法將返回 0。

### <a name="remarks"></a>備註

如果要添加無法從資源載入的工具列按鈕,請呼叫此方法。 您可以在設計時創建佔位符按鈕,並在初始化工具列時將該按鈕替換為自定義按鈕。 有關使用此方法的示例,請參閱 VisualStudioDemo 範例。

### <a name="example"></a>範例

下面的示例演示如何在`ReplaceButton``CMFCToolBar`類中使用 方法。 此代碼段是[IE 演示範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_IEDemo#6](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_1.h)]
[!code-cpp[NVC_MFC_IEDemo#10](../../mfc/reference/codesnippet/cpp/cmfctoolbar-class_5.cpp)]

## <a name="cmfctoolbarresetall"></a><a name="resetall"></a>CMFCToolBar:重置所有

將所有工具列還原到其原始狀態。

```
static void __stdcall ResetAll();
```

### <a name="remarks"></a>備註

此方法調用[CMFCToolBar::](#restoreoriginalstate)還原應用程式中每個工具列上可還原的工具列上的"恢復原始狀態"方法。 它使用[CMFCToolBar::CanBeRestored 方法](#canberestored)來確定是否可以還原工具列。

## <a name="cmfctoolbarresetallimages"></a><a name="resetallimages"></a>CMFCToolbar::重置所有圖像

清除應用程式中的所有工具列圖像集合。

```
static void __stdcall ResetAllImages();
```

### <a name="remarks"></a>備註

此方法清除由[CMFCToolBar::LoadToolBar](#loadtoolbar)和[CMFCToolBar::LoadBitmap](#loadbitmap)方法初始化的圖像集合。

## <a name="cmfctoolbarresetimages"></a><a name="resetimages"></a>CMFCToolBar:重置影像

```
virtual void ResetImages();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarrestorefocus"></a><a name="restorefocus"></a>CMFCToolBar:復原焦點

```
virtual void RestoreFocus();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarrestoreoriginalstate"></a><a name="restoreoriginalstate"></a>CMFCToolBar::恢復原始狀態

還原工具列的原始狀態。

```
virtual BOOL RestoreOriginalState();
```

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;如果方法失敗或工具列由使用者定義,則為 FALSE。

### <a name="remarks"></a>備註

此方法使用[CMFCToolBar::LoadToolBar](#loadtoolbar)方法從資源檔載入工具列。

當使用者選擇自定義對話框**工具列頁面上的****「全部重置」** 按鈕時,框架將呼叫此方法。

## <a name="cmfctoolbarsaveparameters"></a><a name="saveparameters"></a>CMFCToolBar::保存參數

```
static BOOL __stdcall SaveParameters(LPCTSTR lpszProfileName = NULL);
```

### <a name="parameters"></a>參數

[在]*lpsz 設定檔名稱*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsavestate"></a><a name="savestate"></a>CMFCToolBar:儲存狀態

在 Windows 註冊表中保存工具列的狀態資訊。

```
virtual BOOL SaveState(
    LPCTSTR lpszProfileName=NULL,
    int nIndex=-1,
    UINT uiID=(UINT)-1);
```

### <a name="parameters"></a>參數

*lpsz 設定檔名稱*<br/>
[在]指定 Windows 註冊表項的相對路徑。

*nIndex*<br/>
[在]工具列的控制 ID。

*uiID*<br/>
[在]工具列的資源識別碼。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

當框架將應用程式狀態保存到註冊表時,它將調用此方法。 有關詳細資訊,請參閱[CWinAppEx::保存狀態](../../mfc/reference/cwinappex-class.md#savestate)。

## <a name="cmfctoolbarsetbasiccommands"></a><a name="setbasiccommands"></a>CMFC工具列::設定基本命令

設置使用者打開功能表時始終顯示的命令清單。

```
static void __stdcall SetBasicCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
[在]對包含命令集合`CList`的物件的引用。

### <a name="remarks"></a>備註

打開功能表時,始終顯示基本命令。 當用戶選擇查看最近使用的命令時,此方法是有意義的。

使用[CMFCToolBar::AddBasicCommand](#addbasiccommand)方法將命令添加到基本命令清單中。 使用[CMFCToolBar:getBasicCommands](#getbasiccommands)方法檢索應用程式使用的基本命令的清單。

有關使用此方法的示例,請參閱資源管理員範例。

## <a name="cmfctoolbarsetbuttoninfo"></a><a name="setbuttoninfo"></a>CMFC工具列:設定按鈕資訊

設置工具列按鈕的命令 ID、樣式和圖像 ID。

```cpp
void SetButtonInfo(
    int nIndex,
    UINT nID,
    UINT nStyle,
    int iImage);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]設置其屬性的按鈕的零基索引。

*nID*<br/>
[在]按鈕的命令識別碼。

*nStyle*<br/>
[在]按鈕的樣式。 有關可用工具列按鈕樣式的清單,請參閱[工具列控制元件樣式](../../mfc/reference/toolbar-control-styles.md)。

*i 影像*<br/>
[在]按鈕的零基圖像索引(即工具列圖像集合中的索引)。

### <a name="remarks"></a>備註

呼叫此方法以設置工具列按鈕的屬性。

在除錯產生中,如果*nIndex*指定的索引無效,此方法將生成斷言失敗。

呼叫[CMFCToolBar::SetButtonStyle](#setbuttonstyle)方法,以僅設置按鈕的樣式。

## <a name="cmfctoolbarsetbuttons"></a><a name="setbuttons"></a>CMFC工具列:設定按鈕

設置工具列的按鈕。

```
virtual BOOL SetButtons(
    const UINT* lpIDArray,
    int nIDCount,
    BOOL bRemapImages=TRUE);
```

### <a name="parameters"></a>參數

*lpIDArray*<br/>
[在]指向要插入的按鈕的命令指示數陣列的指標。

*nID( N) Count*<br/>
[在]*lpIDArray*中的項數。

*bRemapImage*<br/>
[在]指定是否將現有按鈕圖像與插入的按鈕關聯的布林值。 如果此參數為 TRUE,則重新映射圖像。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零，否則為零。

### <a name="remarks"></a>備註

呼叫此方法從工具列中刪除現有按鈕並插入新按鈕的集合。

此方法將 **「自訂」** 按鈕添加到工具列,並將AFX_WM_RESETTOOLBAR訊息發送到工具列的父視窗。 關於 **「自訂」** 按鈕的詳細資訊,請參閱[CMFCToolBar::啟用自訂按鈕](#enablecustomizebutton)。

## <a name="cmfctoolbarsetbuttonstyle"></a><a name="setbuttonstyle"></a>CMFC工具列:設定按鈕樣式

設置給定索引處工具列按鈕的樣式。

```
virtual void SetButtonStyle(
    int nIndex,
    UINT nStyle);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]要設置其樣式的工具列按鈕的零基索引。

*nStyle*<br/>
[在]按鈕的樣式。 有關可用工具列按鈕樣式的清單,請參閱[工具列控制元件樣式](../../mfc/reference/toolbar-control-styles.md)。

### <a name="remarks"></a>備註

如果*TBBS_DISABLED nStyle,* 則此方法將刪除TBBS_PRESSED樣式,因為使用者無法按一下禁用的按鈕。

## <a name="cmfctoolbarsetbuttontext"></a><a name="setbuttontext"></a>CMFCTool 列:設定按鈕文字

設置工具列按鈕的文字標籤。

```
BOOL SetButtonText(
    int nIndex,
    LPCTSTR lpszText);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]工具列按鈕的索引。

*lpszText*<br/>
[在]工具列按鈕的文字標籤。 必須為非 NULL。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

如果提供的索引不引用有效的工具列按鈕,則此方法將返回 FALSE。

## <a name="cmfctoolbarsetcommandusageoptions"></a><a name="setcommandusageoptions"></a>CMFC工具列:設定指令使用選項

指定很少使用的命令未顯示在應用程式的功能表中時。

```
static BOOL SetCommandUsageOptions(
    UINT nStartCount,
    UINT nMinUsagePercentage=5);
```

### <a name="parameters"></a>參數

*N 開始計數*<br/>
[在]指定在框架僅顯示基本和最近使用的命令之前必須執行命令的次數。

*nMinUsage百分比*<br/>
[在]必須執行命令才能被視為最近使用的命令的百分比。

### <a name="return-value"></a>傳回值

如果*nMinUsage 百分比*等於或大於 100,則 FALSE;否則為 TRUE。

### <a name="remarks"></a>備註

呼叫此方法以自訂框架用於確定基本和最近使用的功能表項的顯示方式的演演演算法。 有關基本命令的詳細資訊,請參閱[CMFCToolbar::addBasic 命令](#addbasiccommand)。

此類使用`CMFCCmdUsageCount`類追蹤命令的使用計數。 有關此類的詳細資訊,請參閱[CMFCCmd 使用計數類別](../../mfc/reference/cmfccmdusagecount-class.md)。

## <a name="cmfctoolbarsetcustomizemode"></a><a name="setcustomizemode"></a>CMFC工具列:設定自訂模式

為應用程式中的所有工具列啟用或禁用自定義模式。

```
static BOOL __stdcall SetCustomizeMode(BOOL bSet=TRUE);
```

### <a name="parameters"></a>參數

*bSet*<br/>
[在]指定是啟用還是禁用自訂模式的布林值。 將此參數設定為 TRUE 以啟用自訂模式或 FALSE 以停用它。

### <a name="return-value"></a>傳回值

如果調用此方法更改自定義模式,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法調整應用程式中每個工具列的佈局並重繪每個工具列。 調用[CMFCToolBar::是自定義模式](#iscustomizemode)方法,以確定應用程式是否處於自定義模式,

## <a name="cmfctoolbarsetgraydisabledbuttons"></a><a name="setgraydisabledbuttons"></a>CMFC工具列::設定灰色禁用按鈕

指定工具列上的不可用按鈕是否變暗,或者是否使用了按鈕不可用的圖像。

```cpp
void SetGrayDisabledButtons(BOOL bGrayDisabledButtons);
```

### <a name="parameters"></a>參數

*b 格雷關閉按鈕*<br/>
[在]指定如何顯示不可用按鈕的布林值。 如果此參數為 TRUE,則框架將調暗按鈕。 否則,框架將使用按鈕不可用圖像的集合。

### <a name="remarks"></a>備註

默認情況下,不可用的按鈕會變暗。

## <a name="cmfctoolbarsetheight"></a><a name="setheight"></a>CMFC工具列:設定高度

設置工具列的高度。

```cpp
void SetHeight(int cyHeight);
```

### <a name="parameters"></a>參數

*賽高地*<br/>
[在]工具列的高度(以像素為單位)。

### <a name="remarks"></a>備註

此方法在設置高度後重繪工具列。

## <a name="cmfctoolbarsethelpmode"></a><a name="sethelpmode"></a>CMFC工具列:設定説明模式

```
static void __stdcall SetHelpMode(BOOL bOn = TRUE);
```

### <a name="parameters"></a>參數

[在]*bon*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsethot"></a><a name="sethot"></a>CMFC工具列:設定Hot

```
BOOL SetHot(CMFCToolBarButton* pMenuButton);
```

### <a name="parameters"></a>參數

[在]*pMenu 按鈕*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsethotborder"></a><a name="sethotborder"></a>CMFCToolbar::設置Hot邊框

指定工具列按鈕是否熱跟蹤。

```cpp
void SetHotBorder(BOOL bShowHotBorder);
```

### <a name="parameters"></a>參數

*b 秀霍特邊框*<br/>
[在]指定是否熱軌道工具列按鈕的布林值。 如果此參數為 TRUE,工具列熱跟蹤其按鈕。 否則,工具列不會熱跟蹤其按鈕。

### <a name="remarks"></a>備註

如果按鈕是熱軌道的,則當滑鼠在按鈕上移動時,框架將突出顯示該按鈕。 默認情況下,每個工具列熱跟蹤其按鈕。

調用[CMFCToolBar::GetHotBorder](#gethotborder)方法以確定工具列熱跟蹤其按鈕。

## <a name="cmfctoolbarsethottextcolor"></a><a name="sethottextcolor"></a>CMFC工具列:設定HottextColor

設定熱工具列按鈕的文字顏色。

```
static void SetHotTextColor(COLORREF clrText);
```

### <a name="parameters"></a>參數

*clrText*<br/>
[在]指定熱軌道工具列按鈕的文字顏色。

### <a name="remarks"></a>備註

有關熱追蹤工具列按鈕的詳細資訊,請參閱[CMFCToolBar::取得 HotBorder](#gethotborder)和[CMFCToolBar::SetHotBorder](#sethotborder)。

## <a name="cmfctoolbarsetignoresettext"></a><a name="setignoresettext"></a>CMFC工具列:設定忽略集文字

```cpp
void SetIgnoreSetText(BOOL bValue);
```

### <a name="parameters"></a>參數

[在]*bValue*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsetlargeicons"></a><a name="setlargeicons"></a>CMFC工具列:設定大圖示

指定工具列按鈕是否顯示大圖示。

```
static void SetLargeIcons(BOOL bLargeIcons=TRUE);
```

### <a name="parameters"></a>參數

*b 大圖示*<br/>
[在]指定要使用的圖示的布林值。 如果此參數為 TRUE,則框架將顯示大圖示。 否則,框架將顯示常規圖示。

### <a name="remarks"></a>備註

當使用者更改 **「自訂」** 對話方塊「**選項**」選項卡中的 **「大圖示**」複選框時,框架將調用此方法。 此方法調整應用程式中的所有工具列的大小。

預設情況下,框架顯示常規圖示。

關於 **「自訂」** 對話框的詳細資訊,請參閱[CMFCToolBars 自訂對話方塊類別](../../mfc/reference/cmfctoolbarscustomizedialog-class.md)。

## <a name="cmfctoolbarsetlockedsizes"></a><a name="setlockedsizes"></a>CMFC工具列:設定鎖定大小

設置工具列上鎖定按鈕和鎖定圖像的大小。

```cpp
void SetLockedSizes(
    SIZE sizeButton,
    SIZE sizeImage,
    BOOL bDontScale = FALSE);
```

### <a name="parameters"></a>參數

*大小按鈕*<br/>
[在]指定鎖定工具列按鈕的大小。

*大小影像*<br/>
[在]指定鎖定工具列影像的大小。

*bDontScale*<br/>
指定在高 DPI 模式下是否縮放鎖定工具列圖像。

### <a name="remarks"></a>備註

鎖定按鈕的預設大小為 23x22 圖元。 鎖定圖像的預設大小為 16x15 像素。

呼叫[CMFCToolBar::獲取鎖定圖像大小](#getlockedimagesize)方法以檢索鎖定圖像的大小。 呼叫[CMFCToolBar::取得按鈕大小](#getbuttonsize)方法以檢索鎖定工具列按鈕的大小。

## <a name="cmfctoolbarsetmaskmode"></a><a name="setmaskmode"></a>CMFC工具列:設定遮罩模式

```cpp
void SetMaskMode(BOOL bMasked);
```

### <a name="parameters"></a>參數

[在]*b*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsetmenusizes"></a><a name="setmenusizes"></a>CMFC工具列:設定選單大小

設置工具列功能表按鈕及其圖像的大小。

```
static void __stdcall SetMenuSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*大小按鈕*<br/>
[在]指定工具列按鈕的大小(以像素為單位)。

*大小影像*<br/>
[在]指定工具列圖像的大小(以像素為單位)。

### <a name="remarks"></a>備註

默認情況下,功能表按鈕及其圖像的大小未定義。

呼叫[CMFCToolBar::GetMenuButtonSize 方法](#getmenubuttonsize)以確定選單按鈕的大小和[CMFCToolBar::GetMenuImageSize](#getmenuimagesize)方法以確定功能表按鈕圖像的大小。

有關使用此方法的示例,請參閱 IEDemo 和 MSMoneyDemo 示例。

## <a name="cmfctoolbarsetnonpermittedcommands"></a><a name="setnonpermittedcommands"></a>CMFC工具列::設定不允許命令

設定使用者無法執行的命令的清單。

```
static void SetNonPermittedCommands(CList<UINT,UINT>& lstCommands);
```

### <a name="parameters"></a>參數

*lstCommands*<br/>
[在]對`CList`包含使用者無法執行的命令的物件的引用。

### <a name="remarks"></a>備註

調用此方法以防止用戶選擇某些命令。 例如,出於安全原因,您可能希望阻止使用者選擇某些命令。 有關使用此方法的範例,請參閱 MDITabsDemo 和 MenuSubSet 範例。

此方法清除以前不允許的命令清單。 預設情況下,不允許的命令清單為空。

## <a name="cmfctoolbarsetonerowwithsibling"></a><a name="setonerowwithsibling"></a>CMFCToolbar:設定同一行

將工具列及其同級放在同一行上。

```cpp
void SetOneRowWithSibling();
```

### <a name="remarks"></a>備註

當使用者按下 **「一行」按鈕的「顯示按鈕**」時,框架將調用此方法。

呼叫[CMFCToolBar::設定 SiblingToolBar](#setsiblingtoolbar)方法,以啟用 **「一行顯示按鈕**」或在 **「兩行」按鈕上顯示按鈕**。 如果為此工具列調用[CMFCToolBar:設置 SiblingToolbar,](#setsiblingtoolbar)則同級工具列將移動到此工具列的行。 否則,此工具列將移動到同級行。

當使用者按下 **「兩行」按鈕**時,框架將調用[CMFCToolBar::設置具有同級的「設定雙行」](#settworowswithsibling)方法。

## <a name="cmfctoolbarsetorigbuttons"></a><a name="setorigbuttons"></a>CMFCToolBar::設置OrigButtons

```cpp
void SetOrigButtons(const CObList& lstOrigButtons);
```

### <a name="parameters"></a>參數

[在]*lstOrigButtons*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarsetpermament"></a><a name="setpermament"></a>CMFC工具列::設定

指定使用者是否可以關閉工具列。

```cpp
void SetPermament(BOOL bPermament=TRUE);
```

### <a name="parameters"></a>參數

*bPermament*<br/>
[在]指定使用者是否可以關閉工具列的布林值。 如果此參數為 TRUE,則使用者無法關閉工具列。 否則,用戶可以關閉工具列。

### <a name="remarks"></a>備註

默認情況下,用戶可以關閉每個工具列。

調用[CMFCToolBar::CanBeClose](#canbeclosed)方法以確定使用者是否可以關閉工具列。

## <a name="cmfctoolbarsetroutecommandsviaframe"></a><a name="setroutecommandsviaframe"></a>CMFC工具列::設置路由命令ViaFrame

指定父框架或擁有者是向工具列發送命令。

```cpp
void SetRouteCommandsViaFrame(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[在]如果此參數為 TRUE,則父幀會向工具列發送命令。 否則,所有者會向工具列發送命令。

### <a name="remarks"></a>備註

預設情況下,父框架向工具列發送命令。 調用[CMFCToolBar:getRouteCommandsViaFrame](#getroutecommandsviaframe)方法,以確定父幀或擁有者是向工具列發送命令。

## <a name="cmfctoolbarsetshowtooltips"></a><a name="setshowtooltips"></a>CMFC工具列::設定顯示工具提示

指定框架是否顯示工具提示。

```
static void SetShowTooltips(BOOL bValue);
```

### <a name="parameters"></a>參數

*bValue*<br/>
[在]如果此參數為 TRUE,則框架將顯示工具提示。 否則,框架將隱藏工具提示。

### <a name="remarks"></a>備註

預設情況下,框架顯示工具提示。

呼叫[CMFCToolBar::GetShowTool 提示](#getshowtooltips)方法以確定框架是否顯示工具提示。

## <a name="cmfctoolbarsetsiblingtoolbar"></a><a name="setsiblingtoolbar"></a>CMFC工具列::設定同級工具列

指定工具列的同級。

```cpp
void SetSiblingToolBar(CMFCToolBar* pBrotherToolbar);
```

### <a name="parameters"></a>參數

*pBrother工具列*<br/>
[在]指向同級工具列的指標。

### <a name="remarks"></a>備註

此方法啟用 **「一行顯示按鈕**」或在 **「兩行」按鈕上顯示的按鈕**,當使用者顯示 **「自訂**」彈出式功能表時顯示。 如果要使用戶能夠指定相關工具列是出現在同一行還是出現在不同的行上,請調用此方法。

啟用工具列上顯示的 **「自訂」** 按鈕後,呼叫此方法。 要啟用 **「自訂」** 按鈕,請呼叫[CMFCToolBar::啟用自訂按鈕](#enablecustomizebutton)方法。

要檢查工具列的同級,請致電[CMFCToolBar::取得同級工具列](#getsiblingtoolbar)。

## <a name="cmfctoolbarsetsizes"></a><a name="setsizes"></a>CMFC工具列:設定大小

指定所有工具列上的按鈕和圖像的大小。

```
static void __stdcall SetSizes(
    SIZE sizeButton,
    SIZE sizeImage);
```

### <a name="parameters"></a>參數

*大小按鈕*<br/>
[在]工具列按鈕的大小(以像素為單位)。

*大小影像*<br/>
[在]工具列按鈕圖像的大小(以像素為單位)。

### <a name="remarks"></a>備註

工具列按鈕的預設大小為 23x22 圖元。 工具列按鈕影像的預設大小為 16x15 像素。

呼叫[CMFCToolBar::獲取圖像大小](#getimagesize)方法以檢索工具列按鈕圖像的大小。 呼叫[CMFCToolBar::取得按鈕大小](#getbuttonsize)方法以檢索工具列按鈕的大小。

## <a name="cmfctoolbarsettoolbarbtntext"></a><a name="settoolbarbtntext"></a>CMFC工具列:設定工具列文字

指定工具列上按鈕的屬性。

```cpp
void SetToolBarBtnText(
    UINT nBtnIndex,
    LPCTSTR szText=NULL,
    BOOL bShowText=TRUE,
    BOOL bShowImage=TRUE);
```

### <a name="parameters"></a>參數

*nBtnIndex*<br/>
[在]工具列按鈕清單中工具列按鈕的零基索引。

*szText*<br/>
[在]指定工具列按鈕的文字標籤。

*b 顯示文字*<br/>
[在]如果此參數為 TRUE,則框架將顯示文本標籤。 否則,框架將隱藏文本標籤。

*B 顯示影像*<br/>
[在]如果此參數為 TRUE,則框架將顯示工具列按鈕圖像。 否則,框架將隱藏工具列按鈕圖像。

### <a name="remarks"></a>備註

預設情況下,框架顯示工具列按鈕的圖像,但不顯示工具列按鈕的文本標籤。

在除錯產生中,如果*nBtnIndex*不引用有效的工具列按鈕或工具列按鈕是分隔符,則此方法將生成斷言失敗。

## <a name="cmfctoolbarsettworowswithsibling"></a><a name="settworowswithsibling"></a>CMFCTool 欄:設定雙行與同級

將工具列及其同級放在單獨的行上。

```cpp
void SetTwoRowsWithSibling();
```

### <a name="remarks"></a>備註

當使用者按下 **「兩行顯示按鈕**」按鈕時,框架將調用此方法。

呼叫[CMFCToolBar::設定 SiblingToolBar](#setsiblingtoolbar)方法,以啟用 **「一行顯示按鈕**」或在 **「兩行」按鈕上顯示按鈕**。 如果為此工具列調用[CMFCToolBar:設置 SiblingToolbar,](#setsiblingtoolbar)則同級工具列將移動到單獨的行。 否則,此工具列將移動到單獨的行。

當使用者按下 **「一行」按鈕的「顯示按鈕**」時,框架將調用[CMFCToolBar::當使用者按下「一行」按鈕時,設置OneRow With與同級](#setonerowwithsibling)方法。

## <a name="cmfctoolbarsetuserimages"></a><a name="setuserimages"></a>CMFC工具列:設定使用者影像

設置應用程式中使用者定義的映射的集合。

```
static BOOL SetUserImages(CMFCToolBarImages* pUserImages);
```

### <a name="parameters"></a>參數

*pUser 影像*<br/>
[在]指向使用者定義圖像集合的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則非零;否則 0`CMFCToolBarImages`如果指定物件無效,或者圖像大小與工具列的預設圖像大小不同。

### <a name="remarks"></a>備註

框架使用使用者定義的圖像繪製由使用者自定義的工具列按鈕。 *pUserImage*指定的圖像清單在應用程式中的所有工具列之間共用。

如果指定`CMFCToolBarImages`物件無效或圖像大小與工具列的預設圖像大小不同,則此方法會在 Debug 生成中生成斷言失敗。

OutlookDemo、ToolTipDemo 和 VisualStudioDemo 範例使用此方法設置使用者定義的圖像的全域集合。 它們載入名為 UserImages.bmp 的檔案,該檔位於應用程式的工作目錄中。

呼叫[CMFCToolBar::GetUserImage](#getuserimages)方法以檢索應用程式中使用者定義的映射的集合。

## <a name="cmfctoolbarstretchpane"></a><a name="stretchpane"></a>CMFC工具列:拉伸窗格

垂直或水準拉伸工具列,並在必要時重新置放按鈕。

```
virtual CSize StretchPane(
    int nLength,
    BOOL bVert);
```

### <a name="parameters"></a>參數

*N 長度*<br/>
[在]拉伸窗格的金額(以像素為單位)。

*bVert*<br/>
[在]如果為 TRUE,則垂直拉伸窗格。 如果 FALSE,則水準拉伸窗格。

### <a name="return-value"></a>傳回值

指定`CSize`工具列工作區大小的物件。

### <a name="remarks"></a>備註

此方法調用[CMFCToolBar:wrapToolBar](#wraptoolbar)以重新置放拉伸工具列中的按鈕。

返回值通過調用[CMFCToolBar:::CalcSize](#calcsize)來確定。

## <a name="cmfctoolbartranslatechar"></a><a name="translatechar"></a>CMFCToolBar:翻譯查爾

如果指定的鍵代碼對應於有效的鍵盤快捷鍵,則執行按鈕命令。

```
virtual BOOL TranslateChar(UINT nChar);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
[在]指定虛擬金鑰代碼。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

### <a name="return-value"></a>傳回值

如果指定的鍵碼不可列印或與有效的鍵盤快捷鍵不對應,則 FALSE;如果指定的密鑰代碼對應於下拉菜單選項,則為 TRUE;否則[,CMFCToolBar 的傳回值::Process命令](#processcommand)。

### <a name="remarks"></a>備註

當將鍵與 Alt 鍵一起按下時,框架將調用此方法。

## <a name="cmfctoolbarupdatebutton"></a><a name="updatebutton"></a>CMFC工具列:更新按鈕

更新指定按鈕的狀態。

```cpp
void UpdateButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[在]指定要更新的按鈕的零基索引。

### <a name="remarks"></a>備註

## <a name="cmfctoolbarwraptoolbar"></a><a name="wraptoolbar"></a>CMFC工具列:包裝工具列

在給定尺寸內重新置放工具列按鈕。

```
int WrapToolBar(
    int nWidth,
    int nHeight = 32767,
    CDC* pDC = NULL,
    int nColumnWidth = -1,
    int nRowHeight = -1);
```

### <a name="parameters"></a>參數

*n 寬度*<br/>
[在]工具欄的最大寬度。

*nHeight*<br/>
[在]工具列的最大高度。 如果工具列是浮動的,則不使用。

*pDC*<br/>
[在]指向設備上下文的指標。 如果為 NULL,則使用工具列的裝置上下文。

*nColumn 寬度*<br/>
[在]按鈕寬度。 如果 -1,則使用當前寬度。

[in] m *nRowHeight*按鈕高度。 如果 -1,則使用當前高度。

### <a name="return-value"></a>傳回值

工具列上的按鈕行數。

### <a name="remarks"></a>備註

此方法重新置放工具列中的按鈕,如有必要,將按鈕包裝到其他行。

## <a name="cmfctoolbarm_bdontscaleimages"></a><a name="m_bdontscaleimages"></a>CMFC工具列:m_bDontScaleImages

指定是否在高 DPI 模式下縮放工具列圖像。

```
AFX_IMPORT_DATA static BOOL m_bDontScaleImages;
```

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCMenuBar 類別](../../mfc/reference/cmfcmenubar-class.md)<br/>
[CMFCPopupMenuBar 類別](../../mfc/reference/cmfcpopupmenubar-class.md)<br/>
[CMFCDropDownToolBar 類別](../../mfc/reference/cmfcdropdowntoolbar-class.md)<br/>
[逐步解說：將控制項放在工具列上](../../mfc/walkthrough-putting-controls-on-toolbars.md)
