---
title: CMFCToolBarButton 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: 8e96740ba6755f489be07fbf8996cfa8b049314a
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754022"
---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton 類別

提供工具列的按鈕功能。

## <a name="syntax"></a>語法

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton：： CMFCToolBarButton](#cmfctoolbarbutton)|建構並初始化 `CMFCToolBarButton` 物件。|
|`CMFCToolBarButton::~CMFCToolBarButton`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton：： CanBeDropped](#canbedropped)|指定在自訂期間，使用者是否可以在工具列或功能表上放置按鈕。|
|[CMFCToolBarButton：： CanBeStored](#canbestored)|指定是否可以儲存按鈕。|
|[CMFCToolBarButton：： CanBeStretched](#canbestretched)|指定使用者是否可以在自訂期間延展按鈕。|
|[CMFCToolBarButton：： Seq.comparewith](#comparewith)|比較這個實例與提供`CMFCToolBarButton`的物件。|
|[CMFCToolBarButton：： CopyFrom](#copyfrom)|將另一個工具列按鈕的屬性複製到目前的按鈕。|
|[CMFCToolBarButton：： CreateFromOleData](#createfromoledata)|從提供`CMFCToolBarButton` `COleDataObject`的物件建立物件。|
|`CMFCToolBarButton::CreateObject`|由建立此類別類型的動態執行個體架構所使用。|
|[CMFCToolBarButton：： EnableWindow](#enablewindow)|啟用或停用滑鼠和鍵盤輸入。|
|[CMFCToolBarButton：： ExportToMenuButton](#exporttomenubutton)|將文字從工具列按鈕複製到功能表。|
|[CMFCToolBarButton：： GetClipboardFormat](#getclipboardformat)|抓取應用程式的全域剪貼簿格式。|
|[CMFCToolBarButton：： GetHwnd](#gethwnd)|抓取與工具列按鈕相關聯的視窗控制碼。|
|[CMFCToolBarButton：： GetImage](#getimage)|抓取按鈕的影像索引。|
|[CMFCToolBarButton：： GetInvalidateRect](#getinvalidaterect)|抓取必須重新繪製之按鈕工作區的區域。|
|[CMFCToolBarButton：： GetParentWnd](#getparentwnd)|抓取按鈕的父視窗。|
|[CMFCToolBarButton：： GetProtectedCommands](#getprotectedcommands)|抓取使用者無法自訂的命令清單。|
|[CMFCToolBarButton：： GetTextSize](#gettextsize)|抓取按鈕文字的大小。|
|[CMFCToolBarButton：： HasFocus](#hasfocus)|判斷按鈕是否具有目前的輸入焦點。|
|[CMFCToolBarButton：： HaveHotBorder](#havehotborder)|決定當使用者選取按鈕時，是否要顯示按鈕的框線。|
|[CMFCToolBarButton：： IsDrawImage](#isdrawimage)|決定影像是否要顯示在按鈕上。|
|[CMFCToolBarButton：： IsDrawText](#isdrawtext)|決定文字標籤是否會顯示在按鈕上。|
|[CMFCToolBarButton：： IsDroppedDown](#isdroppeddown)|決定按鈕是否顯示子功能表。|
|[CMFCToolBarButton：： IsEditable](#iseditable)|決定是否可以自訂按鈕。|
|[CMFCToolBarButton：： IsExtraSize](#isextrasize)|決定是否可以使用延伸框線來顯示按鈕。|
|[CMFCToolBarButton：： IsFirstInGroup](#isfirstingroup)|判斷按鈕是否在按鈕群組中的第一個位置。|
|[CMFCToolBarButton：： IsHidden](#ishidden)|決定是否隱藏按鈕。|
|[CMFCToolBarButton：： IsHorizontal](#ishorizontal)|判斷按鈕是否位於水準工具列上。|
|[CMFCToolBarButton：： IsLastInGroup](#islastingroup)|指定按鈕是否在其按鈕群組中的最後一個位置。|
|[CMFCToolBarButton：： IsLocked](#islocked)|判斷按鈕是否在已鎖定（不可自訂）的工具列上。|
|[CMFCToolBarButton：： IsOwnerOf](#isownerof)|判斷按鈕是否為所提供之視窗控制碼的擁有者。|
|[CMFCToolBarButton：： IsVisible](#isvisible)|決定工具列按鈕是否為可見。|
|[CMFCToolBarButton：： IsWindowVisible](#iswindowvisible)|決定是否顯示按鈕的基礎視窗控制碼。|
|[CMFCToolBarButton：： NotifyCommand](#notifycommand)|指定按鈕是否處理[WM_COMMAND](/windows/win32/menurc/wm-command)訊息。|
|[CMFCToolBarButton：： OnAddToCustomizePage](#onaddtocustomizepage)|當按鈕加入**自訂**對話方塊時由架構呼叫。|
|[CMFCToolBarButton：： OnBeforeDrag](#onbeforedrag)|指定是否可以拖曳按鈕。|
|[CMFCToolBarButton：： OnBeforeDrop](#onbeforedrop)|指定使用者是否可以將按鈕放在目標工具列上。|
|[CMFCToolBarButton：： OnCalculateSize](#oncalculatesize)|由架構呼叫，以計算指定裝置內容和停駐狀態的按鈕大小。|
|[CMFCToolBarButton：： OnCancelMode](#oncancelmode)|由架構呼叫以處理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)訊息。|
|[CMFCToolBarButton：： OnChangeParentWnd](#onchangeparentwnd)|當按鈕插入新工具列時由架構呼叫。|
|[CMFCToolBarButton：： OnClick](#onclick)|當使用者按一下滑鼠按鍵時由架構呼叫。|
|[CMFCToolBarButton：： OnClickUp](#onclickup)|當使用者放開滑鼠按鍵時由架構呼叫。|
|[CMFCToolBarButton：： OnCoNtextHelp](#oncontexthelp)|當父工具列處理 WM_HELPHITTEST 訊息時，由架構呼叫。|
|[CMFCToolBarButton：： OnCtlColor](#onctlcolor)|當父工具列處理 WM_CTLCOLOR 訊息時，由架構呼叫。|
|[CMFCToolBarButton：： OnCustomizeMenu](#oncustomizemenu)|當應用程式在父工具列上顯示快捷方式功能表時，允許按鈕修改提供的功能表。|
|[CMFCToolBarButton：： OnDblClk](#ondblclk)|當父工具列處理[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)訊息時，由架構呼叫。|
|[CMFCToolBarButton：： OnDraw](#ondraw)|由架構呼叫，使用指定的樣式和選項繪製按鈕。|
|[CMFCToolBarButton：： OnDrawOnCustomizeList](#ondrawoncustomizelist)|由架構呼叫，以在 [**自訂**] 對話方塊的 [**命令**] 窗格中繪製按鈕。|
|[CMFCToolBarButton：： OnGetCustomToolTipText](#ongetcustomtooltiptext)|由架構呼叫，以取得按鈕的自訂工具提示文字。|
|[CMFCToolBarButton：： OnGlobalFontsChanged](#onglobalfontschanged)|全域字型已變更時由架構呼叫。|
|[CMFCToolBarButton：： OnMove](#onmove)|當父工具列移動時由架構呼叫。|
|[CMFCToolBarButton：： OnShow](#onshow)|當按鈕變成可見或不可見時，由架構呼叫。|
|[CMFCToolBarButton：： OnSize](#onsize)|當父工具列變更其大小或位置，而這項變更需要變更大小的按鈕時，由架構呼叫。|
|[CMFCToolBarButton：： OnToolHitTest](#ontoolhittest)|當父工具列必須判斷某個點是否在按鈕的周框中，由架構呼叫。|
|[CMFCToolBarButton：： OnUpdateToolTip](#onupdatetooltip)|當父工具列更新其工具提示文字時，由架構呼叫。|
|[CMFCToolBarButton：:P repareDrag](#preparedrag)|當按鈕即將執行拖放作業時，由架構呼叫。|
|[CMFCToolBarButton：： Rect](#rect)|抓取按鈕的周框。|
|[CMFCToolBarButton：： ResetImageToDefault](#resetimagetodefault)|將與按鈕相關聯的影像設定為預設值。|
|[CMFCToolBarButton：： SaveBarState](#savebarstate)|儲存工具列按鈕的狀態。|
|[CMFCToolBarButton：：序列化](#serialize)|從封存讀取此物件，或將它寫入封存。 (覆寫 [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)。)|
|[CMFCToolBarButton：： SetACCData](#setaccdata)|使用工具列按鈕`CAccessibilityData`的協助工具資料填入提供的物件。|
|[CMFCToolBarButton：： SetClipboardFormatName](#setclipboardformatname)|重新命名全域剪貼簿格式。|
|[CMFCToolBarButton：： SetImage](#setimage)|設定按鈕的影像索引。|
|[CMFCToolBarButton：： SetProtectedCommands](#setprotectedcommands)|設定使用者無法自訂的命令清單。|
|[CMFCToolBarButton：： SetRadio](#setradio)|當按鈕變更其核取狀態時，由架構呼叫。|
|[CMFCToolBarButton：： SetRect](#setrect)|設定按鈕的周框。|
|[CMFCToolBarButton：： SetStyle](#setstyle)|設定按鈕的樣式。|
|[CMFCToolBarButton：： SetVisible](#setvisible)|指定按鈕是否可見。|
|[CMFCToolBarButton：： Show](#show)|顯示或隱藏按鈕。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton：： m_bImage](#m_bimage)|指定是否要在按鈕上顯示影像。|
|[CMFCToolBarButton：： m_bText](#m_btext)|指定是否要在按鈕上顯示文字標籤。|
|[CMFCToolBarButton：： m_bTextBelow](#m_btextbelow)|指定文字標籤是否會顯示在按鈕上的影像下方。|
|[CMFCToolBarButton：： m_bUserButton](#m_buserbutton)|指定按鈕是否有使用者定義的影像。|
|[CMFCToolBarButton：： m_bWholeText](#m_bwholetext)|指定按鈕是否要顯示其全文檢索標籤，即使它不符合周框。|
|[CMFCToolBarButton：： m_bWrap](#m_bwrap)|指定分隔符號旁的按鈕是否會放在下一個資料列上。|
|[CMFCToolBarButton：： m_bWrapText](#m_bwraptext)|指定是否啟用多行文字標籤。|
|[CMFCToolBarButton：： m_nID](#m_nid)|按鈕的命令 ID。|
|[CMFCToolBarButton：： m_nStyle](#m_nstyle)|按鈕的樣式。|
|[CMFCToolBarButton：： m_strText](#m_strtext)|按鈕的文字標籤。|

## <a name="remarks"></a>備註

`CMFCToolbarButton`物件是位於工具列上的控制項。 其行為類似于一般按鈕。 您可以將影像和文字標籤指派給這個物件。 工具列按鈕也可以有命令 ID。 當使用者按一下工具列按鈕時，架構會執行此識別碼所指定的命令。

您通常可以自訂工具列按鈕：使用者可以將按鈕從一個工具列拖曳至另一個工具列，以及複製、貼上、刪除和編輯文字標籤和影像。 若要防止使用者自訂工具列，您可以透過兩種方式的其中一種來鎖定工具列。 當您呼叫`bLocked` [CMFCToolBar：： LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)時，請將旗標設為 TRUE，或使用[CMFCToolBarButton：： SetProtectedCommands](#setprotectedcommands)方法，將個別按鈕的命令 ID 新增至受保護命令的全域清單。

`CMFCToolBarButton`物件會在應用程式中顯示來自工具列影像全域集合的影像。 這些集合是由父工具列（ [CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)）維護。 如需詳細資訊，請參閱[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)。

當使用者按一下工具列按鈕時，其父工具列會處理滑鼠訊息，並將適當的動作傳達給按鈕。 如果按鈕具有有效的命令識別碼，父工具列就會將 WM_COMMAND 訊息傳送至父框架。

`CMFCToolBarButton`類別是其他工具列按鈕類別的基類，例如[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)、 [CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)和[CMFCToolBarComboBoxButton 類別](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)。

## <a name="example"></a>範例

下列範例示範如何使用`CMFCToolBarButton` `CMFCToolBarButton`類別中的各種方法來設定物件。 此範例說明如何啟用滑鼠和鍵盤輸入、設定按鈕的影像索引、設定按鈕的周框，以及讓按鈕顯示。 此程式碼片段是[索引標籤控制項範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxtoolbarbutton。h

## <a name="cmfctoolbarbuttoncanbedropped"></a><a name="canbedropped"></a>CMFCToolBarButton：： CanBeDropped

指定在自訂期間，使用者是否可以在工具列或功能表上放置按鈕。

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>參數

*pToolbar*<br/>
在未使用.

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

根據預設，您可以在每個可自訂的（也就是未鎖定的）工具列上放置工具列按鈕。

這個方法的預設實值會傳回 TRUE。 覆寫這個方法，如果您想要防止使用者重新置放按鈕，則傳回 FALSE。

## <a name="cmfctoolbarbuttoncanbestored"></a><a name="canbestored"></a>CMFCToolBarButton：： CanBeStored

決定是否可以儲存按鈕。

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

架構會使用這個方法來判斷按鈕是否可以參與拖放作業。

預設的實值會傳回 TRUE。 如果您的按鈕無法儲存為拖放作業的一部分，請覆寫這個方法。 如需拖放作業的詳細資訊，請參閱[OLE 拖放](../../mfc/drag-and-drop-ole.md)。

## <a name="cmfctoolbarbuttoncanbestretched"></a><a name="canbestretched"></a>CMFCToolBarButton：： CanBeStretched

指定使用者是否可以在自訂期間延展按鈕。

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

架構會使用這個方法來判斷按鈕是否可以在自訂模式中伸展。

這個方法的預設實值會傳回 FALSE。 覆寫這個方法，以針對可變寬度控制項（例如下拉式方塊或滑杆）傳回 TRUE。

如需自訂模式的詳細資訊，請參閱[CMFCToolBar：： SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。

## <a name="cmfctoolbarbuttoncmfctoolbarbutton"></a><a name="cmfctoolbarbutton"></a>CMFCToolBarButton：： CMFCToolBarButton

建構並初始化 `CMFCToolBarButton` 物件。

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>參數

*uiID*<br/>
在按鈕的命令 ID。

*iImage*<br/>
在影像集合中按鈕的影像索引。

*lpszText*<br/>
在按鈕的文字標籤。 可以是 NULL。

*bUserButton*<br/>
在判斷按鈕是否為使用者定義的布林值。 如果此參數為 TRUE，則按鈕為 [使用者定義]。 否則，會從資源載入按鈕影像。

*阻*<br/>
在布林值，決定是否可以自訂按鈕。 如果此參數為 TRUE，則無法自訂按鈕。 否則，可以自訂按鈕。

## <a name="cmfctoolbarbuttoncomparewith"></a><a name="comparewith"></a>CMFCToolBarButton：： Seq.comparewith

比較這個實例與提供`CMFCToolBarButton`的物件。

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>參數

*另一方面*<br/>
在要與這個實例比較之物件的參考。

### <a name="return-value"></a>傳回值

如果提供的物件等於這個實例的值，則為非零，否則為。否則為0。

### <a name="remarks"></a>備註

預設的執行會判斷所提供物件的命令識別碼是否等於這個實例的命令 ID。 如果您必須執行額外的處理，以判斷兩個`CMFCToolBarButton`物件是否相等，請覆寫這個方法。

## <a name="cmfctoolbarbuttoncopyfrom"></a><a name="copyfrom"></a>CMFCToolBarButton：： CopyFrom

將另一個工具列按鈕的屬性複製到目前的按鈕。

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>參數

*src*<br/>
在要從中複製之來源按鈕的參考。

### <a name="remarks"></a>備註

呼叫這個方法，將另一個工具列按鈕複製到這個工具列按鈕。

## <a name="cmfctoolbarbuttoncreatefromoledata"></a><a name="createfromoledata"></a>CMFCToolBarButton：： CreateFromOleData

從提供`CMFCToolBarButton` `COleDataObject`的物件建立物件。

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>參數

*pDataObject*<br/>
在來源 OLE 資料物件。

### <a name="return-value"></a>傳回值

建立的 `CMFCToolBarButton` 物件。

### <a name="remarks"></a>備註

架構會使用這個方法來執行各種格式的資料傳輸。 例如， `CMFCOutlookBarPane::OnDragOver`方法會使用這個方法來執行拖放作業。

## <a name="cmfctoolbarbuttonenablewindow"></a><a name="enablewindow"></a>CMFCToolBarButton：： EnableWindow

啟用或停用滑鼠和鍵盤輸入。

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在將此參數設定為 TRUE 以啟用輸入，或設為 FALSE 以停用輸入。

### <a name="remarks"></a>備註

這個方法會呼叫`EnableWindow`函數來啟用或停用輸入。 如需詳細資訊，請參閱 Windows SDK 中的[EnableWindow](/windows/win32/api/winuser/nf-winuser-enablewindow) 。

## <a name="cmfctoolbarbuttonexporttomenubutton"></a><a name="exporttomenubutton"></a>CMFCToolBarButton：： ExportToMenuButton

將文字從工具列按鈕複製到功能表。

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>參數

*menuButton*<br/>
在[目標] 功能表按鈕的參考。

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

此架構會呼叫這個方法，將文字從工具列按鈕複製到功能表按鈕。 預設的執行會複製按鈕的文字標籤。 如果文字標籤是空的，這個方法會複製按鈕的工具提示文字。

這個方法的預設實值會傳回 TRUE。 如果您想要在架構將衍生自[CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)的物件轉換成功能表按鈕時採取其他動作，請覆寫這個方法。

## <a name="cmfctoolbarbuttongetclipboardformat"></a><a name="getclipboardformat"></a>CMFCToolBarButton：： GetClipboardFormat

抓取應用程式的全域剪貼簿格式。

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>傳回值

應用程式的全域 CLIPFORMAT 值。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以取得 OLE 資料傳輸作業的剪貼簿格式。 例如， [CMFCToolBarButton：： CreateFromOleData](#createfromoledata)方法會使用這個方法來複製來源 OLE 資料物件的資料。

這個方法會在第一次呼叫這個方法時設定全域 CLIPFORMAT 值。 對這個方法進行的所有後續呼叫都會傳回此值。

若要允許在應用程式之間進行拖放作業，請呼叫[CMFCToolBarButton：： SetClipboardFormatName](#setclipboardformatname)方法。

如需有關在 MFC 中寫字板的詳細資訊，請參閱[剪貼](../../mfc/clipboard.md)簿。

## <a name="cmfctoolbarbuttongethwnd"></a><a name="gethwnd"></a>CMFCToolBarButton：： GetHwnd

抓取與工具列按鈕相關聯的視窗控制碼。

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>傳回值

與工具列按鈕相關聯的視窗控制碼，如果工具列按鈕沒有相關聯的視窗控制碼，則為 Null。

### <a name="remarks"></a>備註

這個方法的預設實值會傳回 Null。 覆寫這個方法，以傳回特定控制項的視窗控制碼。

## <a name="cmfctoolbarbuttongetimage"></a><a name="getimage"></a>CMFCToolBarButton：： GetImage

抓取按鈕的影像索引。

```
int GetImage() const;
```

### <a name="return-value"></a>傳回值

與這個按鈕相關聯之影像的索引。

### <a name="remarks"></a>備註

如果按鈕有使用者定義的影像（也就是，如果在*bUserButton*中為 TRUE，則傳回的索引會在使用者定義的影像集合中指定影像）（請參閱[CMFCToolBar：： GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)）。 否則，索引會在從資源檔載入的影像集合中指定影像（請參閱[CMFCToolBar：： GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)）。 如需資源檔的詳細資訊，請參閱[使用資源檔](../../windows/working-with-resource-files.md)。

## <a name="cmfctoolbarbuttongetinvalidaterect"></a><a name="getinvalidaterect"></a>CMFCToolBarButton：： GetInvalidateRect

抓取必須重新繪製之按鈕工作區的區域。

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>傳回值

`CRect`物件，指定必須重新繪製的區域。

### <a name="remarks"></a>備註

這個方法的預設實值會傳回整個工作區。 如果您想要重新繪製不同的區域，請覆寫這個方法。

## <a name="cmfctoolbarbuttongetparentwnd"></a><a name="getparentwnd"></a>CMFCToolBarButton：： GetParentWnd

抓取按鈕的父視窗。

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>傳回值

按鈕的父視窗。

## <a name="cmfctoolbarbuttongetprotectedcommands"></a><a name="getprotectedcommands"></a>CMFCToolBarButton：： GetProtectedCommands

抓取使用者無法自訂的命令清單。

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>傳回值

受保護命令的清單。

### <a name="remarks"></a>備註

在自訂模式中，架構會停用受保護的工具列按鈕命令。 使用者無法在停用的工具列按鈕上執行拖放和編輯作業。

使用[CMFCToolBarButton：： SetProtectedCommands](#setprotectedcommands)方法來定義受保護命令的清單。

## <a name="cmfctoolbarbuttongettextsize"></a><a name="gettextsize"></a>CMFCToolBarButton：： GetTextSize

抓取按鈕文字的大小。

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>傳回值

大小物件，其中包含按鈕文字的大小（以圖元為單位）。

## <a name="cmfctoolbarbuttonhasfocus"></a><a name="hasfocus"></a>CMFCToolBarButton：： HasFocus

判斷按鈕是否具有目前的輸入焦點。

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>傳回值

如果按鈕具有輸入焦點，則為非零值;否則為0。

### <a name="remarks"></a>備註

如果按鈕具有輸入焦點，或為具有輸入焦點之視窗的子系或下階視窗，這個方法的預設執行就會傳回非零值。 您可以覆寫此函式以自訂此行為。

## <a name="cmfctoolbarbuttonhavehotborder"></a><a name="havehotborder"></a>CMFCToolBarButton：： HaveHotBorder

決定當使用者選取按鈕時，是否要顯示按鈕的框線。

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以決定當使用者選取工具列按鈕時，是否應顯示其框線。

預設的實值會傳回 TRUE。 您可以覆寫這個方法，以自訂此行為。

## <a name="cmfctoolbarbuttonisdrawimage"></a><a name="isdrawimage"></a>CMFCToolBarButton：： IsDrawImage

決定影像是否要顯示在按鈕上。

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>傳回值

如果按鈕上顯示影像，則為非零。否則為0。

### <a name="remarks"></a>備註

如果工具列按鈕沒有關聯的影像（ [CMFCToolBarButton：： GetImage](#getimage)會傳回-1），或[CMFCToolBarButton：： M_BIMAGE](#m_bimage)設定為 false，則這個方法會傳回 false。

## <a name="cmfctoolbarbuttonisdrawtext"></a><a name="isdrawtext"></a>CMFCToolBarButton：： IsDrawText

決定文字標籤是否會顯示在按鈕上。

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>傳回值

如果顯示文字標籤，則為非零值;否則為0。

### <a name="remarks"></a>備註

如果工具列按鈕沒有相關聯的文字標籤（ [CMFCToolBarButton：： m_strText](#m_strtext)是空的）或[CMFCToolBarButton：： M_BTEXT](#m_btext)設定為 false，則這個方法會傳回 false。

## <a name="cmfctoolbarbuttonisdroppeddown"></a><a name="isdroppeddown"></a>CMFCToolBarButton：： IsDroppedDown

決定按鈕是否顯示子功能表。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設實值會傳回 FALSE。 如果您的控制項顯示子功能表，請覆寫這個方法，以傳回 TRUE。

## <a name="cmfctoolbarbuttoniseditable"></a><a name="iseditable"></a>CMFCToolBarButton：： IsEditable

決定是否可以自訂按鈕。

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>傳回值

如果使用者可自訂按鈕，則為非零值;否則為0。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷使用者是否可以使用拖放或編輯作業來自訂工具列按鈕。

如果按鈕的命令 ID 是標準命令（您可以藉由呼叫`IsStandardCommand`函式來判斷此情況），或如果命令識別碼位於受保護命令的清單中，則預設的執行會傳回 FALSE。 如需受保護命令的詳細資訊，請參閱[CMFCToolBarButton：： GetProtectedCommands](#getprotectedcommands)和[CMFCToolBarButton：： SetProtectedCommands](#setprotectedcommands)。

覆寫此方法以自訂其行為。

## <a name="cmfctoolbarbuttonisextrasize"></a><a name="isextrasize"></a>CMFCToolBarButton：： IsExtraSize

決定是否可以使用延伸框線來顯示按鈕。

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕可以使用延伸框線來顯示，則為非零。否則為0。

### <a name="remarks"></a>備註

有數個面板會針對工具列按鈕的框線使用額外的大小（例如，[四捨五入] 按鈕）。

如果使用者將此按鈕從一個工具列移到另一個工具列，則架構會呼叫[CMFCToolBarButton：： OnChangeParentWnd](#onchangeparentwnd)方法。 [CMFCToolBarButton：： OnChangeParentWnd](#onchangeparentwnd)方法會將額外的大小旗標設定為新的父工具列（如需詳細資訊，請參閱[CMFCToolBar：： IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)）。

## <a name="cmfctoolbarbuttonisfirstingroup"></a><a name="isfirstingroup"></a>CMFCToolBarButton：： IsFirstInGroup

判斷按鈕是否在按鈕群組中的第一個位置。

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是按鈕群組中的第一個按鈕，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會將*按鈕群組*定義為位於相同資料列上的相鄰按鈕集，並以分隔符號或工具列的框線加以限制。 如果工具列按鈕參考 [**自訂**] 按鈕，這個方法就會傳回 FALSE。 如需 [**自訂**] 按鈕的詳細資訊，請參閱[CMFCToolBar：： GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。

呼叫[CMFCToolBarButton：： IsLastInGroup](#islastingroup)方法，以判斷按鈕是否在其按鈕群組中的最後一個位置。

## <a name="cmfctoolbarbuttonishidden"></a><a name="ishidden"></a>CMFCToolBarButton：： IsHidden

決定是否隱藏按鈕。

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>傳回值

如果隱藏按鈕則為非零（不可見）;否則為0。

### <a name="remarks"></a>備註

當父工具列已延展時，架構會呼叫這個方法，以判斷工具列按鈕是否可見。

如果您使用[CMFCToolBarButton：： SetVisible](#setvisible)方法將按鈕設定為不可見，請使用[CMFCToolBarButton：： IsVisible](#isvisible)來判斷工具列按鈕是否為可見。

根據預設，所有工具列按鈕都是可見的。 使用[CMFCToolBarButton：： Show](#show)方法來隱藏或顯示工具列按鈕。

## <a name="cmfctoolbarbuttonishorizontal"></a><a name="ishorizontal"></a>CMFCToolBarButton：： IsHorizontal

判斷按鈕是否位於水準工具列上。

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕位於水準工具列上，則為非零。否則為0。

### <a name="remarks"></a>備註

架構會呼叫這個方法來判斷工具列按鈕的版面配置。

這個方法會傳回`m_bHorz`資料成員。 `m_bHorz`資料成員的預設值為 TRUE;它會在每次呼叫[CMFCToolBarButton：： OnDraw](#ondraw)方法時重設。

## <a name="cmfctoolbarbuttonislastingroup"></a><a name="islastingroup"></a>CMFCToolBarButton：： IsLastInGroup

指定按鈕是否在其按鈕群組中的最後一個位置。

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是按鈕群組中的最後一個按鈕，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會將*按鈕群組*定義為位於相同資料列上的相鄰按鈕集，並以分隔符號或工具列的框線來界定。如果工具列按鈕沒有父工具列，或工具列按鈕參考 [**自訂**] 按鈕，則此方法會傳回 FALSE。 如需 [**自訂**] 按鈕的詳細資訊，請參閱[CMFCToolBar：： GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。

呼叫[CMFCToolBarButton：： IsFirstInGroup](#isfirstingroup)方法，以判斷按鈕是否在其按鈕群組中的第一個位置。

## <a name="cmfctoolbarbuttonislocked"></a><a name="islocked"></a>CMFCToolBarButton：： IsLocked

判斷按鈕是否在已鎖定（不可自訂）的工具列上。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>傳回值

如果按鈕在鎖定的工具列上，則為非零值;否則為0。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷使用者是否可以使用拖放或編輯作業來自訂工具列按鈕。 使用[CMFCToolBar：： LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)方法，在父工具列上設定 [鎖定] 屬性。 架構會將這個屬性的值傳遞給它在父工具列中插入之每個工具列按鈕（ [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)）的函式。

## <a name="cmfctoolbarbuttonisownerof"></a><a name="isownerof"></a>CMFCToolBarButton：： IsOwnerOf

判斷按鈕是否為所提供之視窗控制碼的擁有者。

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>參數

*hwnd*<br/>
在視窗控制碼。

### <a name="return-value"></a>傳回值

如果按鈕是所提供視窗控制碼的擁有者，則為非零。否則為0。

### <a name="remarks"></a>備註

如果*hwnd*參考直接視窗控制碼，或與按鈕相關聯的視窗控制碼子系，則這個方法會傳回非零值。 如果*hwnd*為 Null，這個方法會傳回0。

## <a name="cmfctoolbarbuttonisvisible"></a><a name="isvisible"></a>CMFCToolBarButton：： IsVisible

決定工具列按鈕是否為可見。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕為可見，則為非零。否則為0。

### <a name="remarks"></a>備註

您可以使用[CMFCToolBarButton：： SetVisible](#setvisible)方法來顯示或隱藏工具列按鈕。 呼叫[CMFCToolBarButton：： SetVisible](#setvisible)重新計算父工具列的版面配置之後，請在父工具列上呼叫[CPane：： AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法。

## <a name="cmfctoolbarbuttoniswindowvisible"></a><a name="iswindowvisible"></a>CMFCToolBarButton：： IsWindowVisible

決定是否顯示按鈕的基礎視窗控制碼。

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>傳回值

如果按鈕的基礎視窗控制碼是可見的，則為非零。否則為0。

### <a name="remarks"></a>備註

如果基礎視窗控制碼的樣式屬性包含 WS_VISIBLE 樣式，則這個方法會傳回非零。 如果按鈕的基礎視窗控制碼為 Null，則這個方法會傳回 FALSE。

## <a name="cmfctoolbarbuttonm_bimage"></a><a name="m_bimage"></a>CMFCToolBarButton：： m_bImage

指定是否要在按鈕上顯示影像。

```
BOOL m_bImage;
```

### <a name="remarks"></a>備註

如果此資料成員設定為 TRUE，則架構會顯示與工具列按鈕相關聯的影像。否則，架構不會顯示影像。 這個成員會影響[CMFCToolBarButton：： m_bImage](#m_bimage)方法的傳回值。

## <a name="cmfctoolbarbuttonm_btext"></a><a name="m_btext"></a>CMFCToolBarButton：： m_bText

指定是否要在按鈕上顯示文字標籤。

```
BOOL m_bText;
```

### <a name="remarks"></a>備註

如果此資料成員設定為 TRUE，則架構會顯示工具列按鈕的文字標籤。否則，架構不會顯示文字標籤。 這個成員會影響[CMFCToolBarButton：： m_bText](#m_btext)方法的傳回值。

## <a name="cmfctoolbarbuttonm_btextbelow"></a><a name="m_btextbelow"></a>CMFCToolBarButton：： m_bTextBelow

指定文字標籤是否會顯示在按鈕上的影像下方。

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>備註

如果此成員變數設定為 TRUE，則架構會在影像下方顯示按鈕的文字。 這個成員的預設值為 FALSE。

## <a name="cmfctoolbarbuttonm_buserbutton"></a><a name="m_buserbutton"></a>CMFCToolBarButton：： m_bUserButton

指定按鈕是否有使用者定義的影像

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>備註

當按鈕具有與其相關聯的使用者定義影像時，這個資料成員會設定為 TRUE。

## <a name="cmfctoolbarbuttonm_bwholetext"></a><a name="m_bwholetext"></a>CMFCToolBarButton：： m_bWholeText

指定按鈕是否要顯示其全文檢索標籤，即使它不符合周框。

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>備註

如果此資料成員設定為 TRUE，則架構會加大按鈕以顯示完整的文字標籤。 否則，架構會截斷並將省略號（ **...**）附加至文字標籤。

## <a name="cmfctoolbarbuttonm_bwrap"></a><a name="m_bwrap"></a>CMFCToolBarButton：： m_bWrap

指定分隔符號旁的按鈕是否會放在下一個資料列上。

```
BOOL m_bWrap;
```

### <a name="remarks"></a>備註

當工具列按鈕不符合目前的資料列，或當您指定版面配置（例如，每個資料列的特定工具列按鈕數目）時，此架構會將此資料成員設為 TRUE。

如果此資料成員設定為 TRUE，且工具列是水準停駐或浮動，架構會將此按鈕放在下一個資料列。

此資料成員的預設值為 FALSE。

## <a name="cmfctoolbarbuttonm_bwraptext"></a><a name="m_bwraptext"></a>CMFCToolBarButton：： m_bWrapText

指定是否啟用多行文字標籤。

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>備註

如果這個靜態成員變數為 TRUE，則架構可讓所有工具列在工具列按鈕上顯示多行文字標籤。

此資料成員的預設值為 FALSE。

## <a name="cmfctoolbarbuttonm_nid"></a><a name="m_nid"></a>CMFCToolBarButton：： m_nID

按鈕的命令 ID。

```
UINT m_nID;
```

### <a name="remarks"></a>備註

命令識別碼-1 表示按鈕是分隔符號。 所有的按鈕分隔符號都具有 TBBS_SEPARATOR 樣式。 如需按鈕樣式的詳細資訊，請參閱[CMFCToolBarButton：： m_nStyle](#m_nstyle) 。

## <a name="cmfctoolbarbuttonm_nstyle"></a><a name="m_nstyle"></a>CMFCToolBarButton：： m_nStyle

按鈕的樣式。

```
UINT m_nStyle;
```

### <a name="remarks"></a>備註

如需可用工具列按鈕樣式的清單，請參閱[工具列控制項樣式](../../mfc/reference/toolbar-control-styles.md)。

## <a name="cmfctoolbarbuttonm_strtext"></a><a name="m_strtext"></a>CMFCToolBarButton：： m_strText

按鈕的文字標籤。

```
CString m_strText;
```

### <a name="remarks"></a>備註

此資料成員包含按鈕的文字標籤。 文字標籤可以是空的。

## <a name="cmfctoolbarbuttonnotifycommand"></a><a name="notifycommand"></a>CMFCToolBarButton：： NotifyCommand

指定按鈕是否處理[WM_COMMAND](/windows/win32/menurc/wm-command)訊息。

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>參數

*iNotifyCode*<br/>
在與命令相關聯的通知訊息。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當架構即將傳送[WM_COMMAND](/windows/win32/menurc/wm-command)訊息到父視窗時，會呼叫這個方法。

根據預設，這個方法會傳回 FALSE。 如果您想要處理 WM_COMMAND 訊息，請覆寫此方法以傳回 TRUE，否則會傳回 FALSE 來表示父工具列應處理訊息。

## <a name="cmfctoolbarbuttononaddtocustomizepage"></a><a name="onaddtocustomizepage"></a>CMFCToolBarButton：： OnAddToCustomizePage

當按鈕加入**自訂**對話方塊時由架構呼叫。

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 如果您想要在將按鈕新增至 [**自訂**] 對話方塊時執行某些動作，請覆寫這個方法。

## <a name="cmfctoolbarbuttononbeforedrag"></a><a name="onbeforedrag"></a>CMFCToolBarButton：： OnBeforeDrag

指定是否可以拖曳按鈕。

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>傳回值

如果可以拖曳按鈕，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

架構會在使用者開始拖曳按鈕之前呼叫這個方法。

這個方法的預設實值會傳回 TRUE。 覆寫此方法以傳回 FALSE，以停用按鈕的拖曳。

## <a name="cmfctoolbarbuttononbeforedrop"></a><a name="onbeforedrop"></a>CMFCToolBarButton：： OnBeforeDrop

指定使用者是否可以將按鈕放在目標工具列上。

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>參數

*pTarget*<br/>
在拖放作業的目標。

### <a name="return-value"></a>傳回值

如果按鈕可以放到提供的目標工具列上，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

此架構會在按鈕放入工具列之前呼叫此方法。

這個方法的預設實值會傳回 TRUE。 覆寫此方法以傳回 FALSE，以停用指定目標上的 drop 作業。

## <a name="cmfctoolbarbuttononcalculatesize"></a><a name="oncalculatesize"></a>CMFCToolBarButton：： OnCalculateSize

由架構呼叫，以計算指定裝置內容和停駐狀態的按鈕大小。

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在顯示按鈕的裝置內容。

*sizeDefault*<br/>
在按鈕的預設大小。

*bHorz*<br/>
在父工具列的停駐狀態。 如果工具列是以水準方式停駐或浮動，則此參數為 TRUE，如果工具列已垂直停駐，則為 FALSE。

### <a name="return-value"></a>傳回值

包含`SIZE`按鈕維度的結構（以圖元為單位）。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以決定所指定裝置內容和停駐狀態的工具列按鈕大小。

預設的執行會考慮文字和影像大小（如果已顯示）、文字和影像位置（位於影像右邊或右側的文字），以及工具列停駐狀態。

如果您想要提供非標準按鈕的大小（例如，編輯方塊按鈕），請覆寫這個方法。

## <a name="cmfctoolbarbuttononcancelmode"></a><a name="oncancelmode"></a>CMFCToolBarButton：： OnCancelMode

由架構呼叫以處理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)訊息。

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 如果您想要處理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)訊息，請覆寫這個方法。

## <a name="cmfctoolbarbuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a>CMFCToolBarButton：： OnChangeParentWnd

當按鈕插入新工具列時由架構呼叫。

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>參數

*pWndParent*<br/>
在新的父視窗。

### <a name="remarks"></a>備註

按鈕會插入工具列中，例如，當使用者將它從一個工具列拖曳至另一個工具列時。

這個方法的預設執行不會執行任何操作。

## <a name="cmfctoolbarbuttononclick"></a><a name="onclick"></a>CMFCToolBarButton：： OnClick

當使用者按一下滑鼠按鍵時由架構呼叫。

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在工具列按鈕的父視窗。

*bDelay*<br/>
在如果應該使用延遲來處理訊息，則為 TRUE。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者按一下工具列按鈕時，架構會呼叫這個方法。

預設的執行不會執行任何操作，而且會傳回 FALSE。 覆寫這個方法，以在按鈕處理按一下訊息時傳回非零值。

## <a name="cmfctoolbarbuttononclickup"></a><a name="onclickup"></a>CMFCToolBarButton：： OnClickUp

當使用者放開滑鼠按鍵時由架構呼叫。

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者放開工具列按鈕時，架構會呼叫這個方法。

預設的執行不會執行任何操作，而且會傳回 FALSE。 覆寫這個方法，以在按鈕處理按一下訊息時傳回非零值。

## <a name="cmfctoolbarbuttononcontexthelp"></a><a name="oncontexthelp"></a>CMFCToolBarButton：： OnCoNtextHelp

當父工具列處理 WM_HELPHITTEST 訊息時，由架構呼叫。

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在工具列按鈕的父視窗。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作，而且會傳回 FALSE。 如果按鈕處理說明訊息，請覆寫這個方法，以傳回非零值。

如需 WM_HELPHITTEST 訊息的詳細資訊，請參閱[TN028：即時線上說明支援](../../mfc/tn028-context-sensitive-help-support.md)。

## <a name="cmfctoolbarbuttononctlcolor"></a><a name="onctlcolor"></a>CMFCToolBarButton：： OnCtlColor

當父工具列處理 WM_CTLCOLOR 訊息時，由架構呼叫。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在顯示按鈕的裝置內容。

*nCtlColor*<br/>
在特定的色彩通知。

### <a name="return-value"></a>傳回值

此為筆刷物件的控制碼，架構用來繪製按鈕的背景。

### <a name="remarks"></a>備註

當父工具列處理包含 Windows 控制項之工具列按鈕的 WM_CTLCOLOR 訊息時，架構會呼叫這個方法。 如果工具列按鈕為無視窗，則架構不會呼叫這個方法。

當工具列架構處於自訂模式，而工具列按鈕已解除鎖定時，架構會呼叫這個方法。 如需自訂模式的詳細資訊，請參閱[CMFCToolBar：： SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。 如需鎖定工具列按鈕的詳細資訊，請參閱[CMFCToolBarButton：： IsLocked](#islocked)。

預設的執行不會執行任何操作，而且會傳回 Null。

## <a name="cmfctoolbarbuttononcustomizemenu"></a><a name="oncustomizemenu"></a>CMFCToolBarButton：： OnCustomizeMenu

當應用程式在父工具列上顯示快捷方式功能表時，允許按鈕修改提供的功能表。

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>參數

*pMenu*<br/>
在要自訂的功能表。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

預設的執行不會執行任何操作，而且會傳回 FALSE。 如果您想要修改所提供功能表的內容，請覆寫這個方法，並傳回非零值。

## <a name="cmfctoolbarbuttonondblclk"></a><a name="ondblclk"></a>CMFCToolBarButton：： OnDblClk

當父工具列處理[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)訊息時，由架構呼叫。

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]-按鈕的父視窗。

### <a name="remarks"></a>備註

當父工具列處理[WM_LBUTTONDBLCLK](/windows/win32/inputdev/wm-lbuttondblclk)訊息`CMFCToolBar::OnLButtonDblClk`時，方法會呼叫這個方法。

這個方法的預設執行不會執行任何操作。

## <a name="cmfctoolbarbuttonondraw"></a><a name="ondraw"></a>CMFCToolBarButton：： OnDraw

由架構呼叫，使用指定的樣式和選項繪製按鈕。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在顯示按鈕的裝置內容。

*各種*<br/>
在按鈕的周框。

*pImages*<br/>
在與按鈕相關聯的工具列影像集合。

*bHorz*<br/>
在父工具列的停駐狀態。 當按鈕已水準停駐時，此參數為 TRUE，而當按鈕固定時則為 FALSE。

*bCustomizeMode*<br/>
在指定工具列是否處於自訂模式。 當工具列處於自訂模式時，此參數為 TRUE，而當工具列不是自訂模式時，則為 FALSE。

*bHighlight*<br/>
在指定是否反白顯示按鈕。 當按鈕反白顯示時，此參數為 TRUE，而未反白顯示按鈕時則為 FALSE。

*bDrawBorder*<br/>
在指定按鈕是否應顯示其框線。 當按鈕應該顯示其框線時，此參數為 TRUE，而當按鈕不應顯示其框線時，則為 FALSE。

*bGrayDisabledButtons*<br/>
在指定是否要為停用的按鈕加上網底，或使用已停用的影像集合。 當停用的按鈕應該加上陰影時，此參數為 TRUE，而此方法應使用已停用的影像集合時則為 FALSE。

### <a name="remarks"></a>備註

覆寫此方法以自訂工具列按鈕繪製。

## <a name="cmfctoolbarbuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a>CMFCToolBarButton：： OnDrawOnCustomizeList

由架構呼叫，以在 [**自訂**] 對話方塊的 [**命令**] 窗格中繪製按鈕。

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在顯示按鈕的裝置內容。

*各種*<br/>
在按鈕的周框。

*bSelected*<br/>
在指定是否選取按鈕。 如果此參數為 TRUE，則會選取按鈕。 如果此參數為 FALSE，則不會選取此按鈕。

### <a name="return-value"></a>傳回值

指定裝置內容上按鈕的寬度（以圖元為單位）。

### <a name="remarks"></a>備註

當按鈕即將在 [主控描繪] 清單方塊上顯示時，[自訂] 對話方塊（[**命令**] 索引標籤）會呼叫這個方法。

這個方法的預設執行會顯示按鈕的影像和文字標籤（如果有的話）。 如果按鈕的文字標籤無法使用，方法會顯示工具提示文字。

覆寫此方法以執行自訂繪圖。

## <a name="cmfctoolbarbuttonongetcustomtooltiptext"></a><a name="ongetcustomtooltiptext"></a>CMFCToolBarButton：： OnGetCustomToolTipText

由架構呼叫，以取得按鈕的自訂工具提示文字。

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>參數

*strToolTip*<br/>
脫銷接收`CString`自訂工具提示文字的物件。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當此架構顯示工具列按鈕的工具提示時，會呼叫這個方法。 如果這個方法傳回 FALSE，則架構會使用預設工具提示。

預設的執行不會執行任何操作，而且會傳回 FALSE。 覆寫這個方法，並傳回非零值，以提供工具列按鈕的自訂工具提示文字。

## <a name="cmfctoolbarbuttononglobalfontschanged"></a><a name="onglobalfontschanged"></a>CMFCToolBarButton：： OnGlobalFontsChanged

全域字型已變更時由架構呼叫。

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 覆寫這個方法，以更新用來顯示按鈕文字的字型。

## <a name="cmfctoolbarbuttononmove"></a><a name="onmove"></a>CMFCToolBarButton：： OnMove

當父工具列移動時由架構呼叫。

```
virtual void OnMove();
```

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 覆寫這個方法，以在父工具列移動時重新調整按鈕的位置。

## <a name="cmfctoolbarbuttononshow"></a><a name="onshow"></a>CMFCToolBarButton：： OnShow

當按鈕變成可見或不可見時，由架構呼叫。

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在指定按鈕是否可見。 如果此參數為 TRUE，則會顯示此按鈕。 否則，就不會顯示此按鈕。

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 覆寫此方法以更新按鈕的可見度。

## <a name="cmfctoolbarbuttononsize"></a><a name="onsize"></a>CMFCToolBarButton：： OnSize

由架構在父工具列變更其大小或位置時呼叫，而這項變更會導致按鈕變更大小。

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>參數

*iSize*<br/>
在按鈕的新寬度。

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 當父工具列的大小或位置變更時，覆寫此方法以調整按鈕的大小。

## <a name="cmfctoolbarbuttonontoolhittest"></a><a name="ontoolhittest"></a>CMFCToolBarButton：： OnToolHitTest

當父工具列必須判斷某個點是否在按鈕的周框中，由架構呼叫。

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在按鈕的父視窗。 可以是 NULL。

*pTI*<br/>
在`TOOLINFO`結構，其中包含工具提示控制項中的工具相關資訊。

### <a name="return-value"></a>傳回值

`OnMenuButtonToolHitTest`如果按鈕可以抓取父框架視窗的指標，則為的結果。否則為 FALSE。

### <a name="remarks"></a>備註

如果可以將父視窗轉換成有效的框架物件，這個方法會呼叫下列其中一種方法：

- [CMDIFrameWndEx：： OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx：： OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

## <a name="cmfctoolbarbuttononupdatetooltip"></a><a name="onupdatetooltip"></a>CMFCToolBarButton：： OnUpdateToolTip

當父工具列更新其工具提示文字時，由架構呼叫。

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>參數

*pWndParent*<br/>
在父視窗。

*iButtonIndex*<br/>
在父按鈕集合中按鈕之以零為起始的索引。

*wndToolTip*<br/>
在顯示工具提示文字的控制項。

*str*<br/>
脫銷`CString`物件，接收已更新的工具提示文字。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作，而且會傳回 FALSE。 如果您提供工具提示文字字串，請覆寫這個方法，以傳回非零值。

## <a name="cmfctoolbarbuttonpreparedrag"></a><a name="preparedrag"></a>CMFCToolBarButton：:P repareDrag

當按鈕即將執行拖放作業時，由架構呼叫。

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>參數

*srcItem*<br/>
在`COleDataSource`物件，儲存有關拖放作業的狀態資訊。

### <a name="return-value"></a>傳回值

如果作業成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法來準備工具列按鈕，以將其狀態儲存在所`COleDataSource`提供的物件中。 這個方法會將本身序列化為共用檔案，然後將該檔案傳遞至[COleDataSource：： CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata)方法，以儲存其狀態。 如需工具列按鈕序列化的詳細資訊，請參閱[CMFCToolBarButton：：序列化](#serialize)。

這個方法不會執行任何動作，如果無法儲存按鈕則傳回 TRUE （ [CMFCToolBarButton：： CanBeStored](#canbestored)方法會傳回 FALSE）。 如果在物件序列化期間發生例外狀況，則會傳回 FALSE。

如需 OLE 拖放作業的詳細資訊，請參閱[ole 拖放](../../mfc/drag-and-drop-ole.md)。

## <a name="cmfctoolbarbuttonrect"></a><a name="rect"></a>CMFCToolBarButton：： Rect

抓取按鈕的周框。

```
const CRect& Rect() const;
```

### <a name="return-value"></a>傳回值

`CRect`物件，包含按鈕的周框。

## <a name="cmfctoolbarbuttonresetimagetodefault"></a><a name="resetimagetodefault"></a>CMFCToolBarButton：： ResetImageToDefault

將與按鈕相關聯的影像設定為預設值。

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>備註

這個方法會使用[CMFCToolBar：： GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage)方法，從其父工具列抓取預設影像。 如果按鈕沒有相關聯的預設影像，這個方法會使用[CStringT：： loadstring 時](../../atl-mfc-shared/reference/cstringt-class.md#loadstring)方法，根據其字串資源來設定按鈕的文字標籤。 如需有關字串資源的詳細資訊，請參閱[使用資源檔](../../windows/working-with-resource-files.md)。

如果按鈕有使用者定義的影像，這個方法就不會執行任何操作。

## <a name="cmfctoolbarbuttonsavebarstate"></a><a name="savebarstate"></a>CMFCToolBarButton：： SaveBarState

儲存工具列按鈕的狀態。

```
virtual void SaveBarState();
```

### <a name="remarks"></a>備註

當此架構建立`CMFCToolBarButton`物件做為拖放作業的結果時，會呼叫這個方法。

這個方法的預設執行不會執行任何操作。 覆寫這個方法，將工具列按鈕的狀態儲存至外部資料源。

## <a name="cmfctoolbarbuttonserialize"></a><a name="serialize"></a>CMFCToolBarButton：：序列化

從封存讀取此物件，或將它寫入封存。

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
在要`CArchive`從中序列化或的物件。

### <a name="remarks"></a>備註

這個方法支援資料傳輸進程，例如剪貼簿或拖放作業。 它會從或將按鈕的屬性（例如識別碼、文字標籤和影像識別碼）讀取或寫入至所`CArchive`提供的物件。

如需序列化範例，請參閱[序列化：序列化物件](../../mfc/serialization-serializing-an-object.md)。

## <a name="cmfctoolbarbuttonsetaccdata"></a><a name="setaccdata"></a>CMFCToolBarButton：： SetACCData

使用工具列按鈕`CAccessibilityData`的協助工具資料填入提供的物件。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
在工具列按鈕的父視窗。

*資料*<br/>
在以`CAccessibilityData`工具列按鈕的協助工具資料填入的物件。

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

如果您的工具列按鈕未提供協助工具資料，請覆寫此方法以傳回 FALSE。

## <a name="cmfctoolbarbuttonsetclipboardformatname"></a><a name="setclipboardformatname"></a>CMFCToolBarButton：： SetClipboardFormatName

重新命名全域剪貼簿格式。

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>參數

*lpszName*<br/>
在全域剪貼簿格式的新名稱。 不能是 NULL。

### <a name="remarks"></a>備註

這個方法可以讓拖放作業在多個應用程式之間進行。 每個應用程式都必須提供相同的剪貼簿格式名稱。

您必須先呼叫這個方法，架構才會呼叫[CMFCToolBarButton：： GetClipboardFormat](#getclipboardformat)。

## <a name="cmfctoolbarbuttonsetimage"></a><a name="setimage"></a>CMFCToolBarButton：： SetImage

設定按鈕的影像索引。

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>參數

*iImage*<br/>
在工具列影像集合中影像的索引。

### <a name="remarks"></a>備註

如果工具列按鈕是分隔符號，則*iImage*會參考 [分隔符號] 按鈕的新寬度。

如果*iImage*小於零，這個方法會停用影像的繪圖，並啟用按鈕的文字標籤繪製。

## <a name="cmfctoolbarbuttonsetprotectedcommands"></a><a name="setprotectedcommands"></a>CMFCToolBarButton：： SetProtectedCommands

設定使用者無法自訂的命令清單。

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>參數

*lstCmds*<br/>
在受保護命令的清單。

### <a name="remarks"></a>備註

在自訂模式中，架構會停用受保護的工具列按鈕命令。 使用者無法在停用的工具列按鈕上執行拖放和編輯作業。

使用[CMFCToolBarButton：： GetProtectedCommands](#getprotectedcommands)方法來取出受保護命令的清單。

## <a name="cmfctoolbarbuttonsetradio"></a><a name="setradio"></a>CMFCToolBarButton：： SetRadio

當按鈕變更其核取狀態時，由架構呼叫。

```
virtual void SetRadio();
```

### <a name="remarks"></a>備註

這個方法的預設執行不會執行任何操作。 覆寫此方法，以在按鈕變更其核取狀態時執行自訂動作。

## <a name="cmfctoolbarbuttonsetrect"></a><a name="setrect"></a>CMFCToolBarButton：： SetRect

設定按鈕的周框。

```cpp
void SetRect(const CRect rect);
```

### <a name="parameters"></a>參數

*各種*<br/>
在按鈕的新周框。

### <a name="remarks"></a>備註

這個方法會在設定新的周框後呼叫[CMFCToolBarButton：： OnMove](#onmove)方法。

## <a name="cmfctoolbarbuttonsetstyle"></a><a name="setstyle"></a>CMFCToolBarButton：： SetStyle

設定按鈕的樣式。

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>參數

*nStyle*<br/>
在按鈕的新樣式。

### <a name="remarks"></a>備註

預設的執行會將[CMFCToolBarButton：： m_nStyle](#m_nstyle)資料成員設定為*nStyle*。 如果您想要執行其他處理來處理樣式變更，請覆寫這個方法。 如需有效樣式旗標的清單，請參閱[工具列控制項樣式](toolbar-control-styles.md)。

## <a name="cmfctoolbarbuttonsetvisible"></a><a name="setvisible"></a>CMFCToolBarButton：： SetVisible

指定按鈕是否可見。

```cpp
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在指定是否要顯示或隱藏按鈕的布林值。 如果此參數為 TRUE，則會顯示按鈕。 如果參數為 FALSE，則會隱藏按鈕。

### <a name="remarks"></a>備註

使用此函式來隱藏或顯示特定的工具列按鈕。 呼叫這個方法之後，請呼叫[CPane：： AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法。

## <a name="cmfctoolbarbuttonshow"></a><a name="show"></a>CMFCToolBarButton：： Show

顯示或隱藏按鈕。

```cpp
void Show(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
在指定是否要顯示或隱藏按鈕的布林值。 如果此參數為 TRUE，則會顯示按鈕。 如果參數為 FALSE，則會隱藏按鈕。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以在調整大小的父工具列時更新工具列按鈕的可見度。 當按鈕不再適用于工具列的範圍內時，架構會呼叫這個方法，並將*bShow*設為 FALSE。 此架構會呼叫這個方法，並在重新調整按鈕的大小時，將其*bShow*設為 TRUE，以符合工具列的界限。

使用[CMFCToolBarButton：： SetVisible](#setvisible)方法來設定按鈕的一般可見度。

這個方法會在更新按鈕的可見度狀態之後，呼叫[CMFCToolBarButton：： OnShow](#onshow)方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)
