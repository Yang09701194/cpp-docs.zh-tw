---
title: CMFCToolBarButton 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: 0a3af2b13eeb2775671ee89019b1562010acc059
ms.sourcegitcommit: 72583d30170d6ef29ea5c6848dc00169f2c909aa
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "58776384"
---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton 類別

提供工具列按鈕功能。

## <a name="syntax"></a>語法

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|建構並初始化 `CMFCToolBarButton` 物件。|
|`CMFCToolBarButton::~CMFCToolBarButton`|解構函式。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|指定使用者是否可以放置在自訂期間的某個工具列或功能表上的按鈕。|
|[CMFCToolBarButton::CanBeStored](#canbestored)|指定是否可以儲存 按鈕。|
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|指定使用者是否可以在自訂期間延伸按鈕。|
|[CMFCToolBarButton::CompareWith](#comparewith)|比較這個執行個體與提供`CMFCToolBarButton`物件。|
|[CMFCToolBarButton::CopyFrom](#copyfrom)|另一個工具列按鈕的屬性複製到目前的按鈕。|
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|會建立`CMFCToolBarButton`從提供的物件`COleDataObject`物件。|
|`CMFCToolBarButton::CreateObject`|由建立此類別類型的動態執行個體架構所使用。|
|[CMFCToolBarButton::EnableWindow](#enablewindow)|啟用或停用滑鼠和鍵盤輸入。|
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|複製文字從工具列按鈕的功能表。|
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|擷取應用程式的通用的剪貼簿格式。|
|[CMFCToolBarButton::GetHwnd](#gethwnd)|擷取工具列按鈕與相關聯的視窗控制代碼。|
|[CMFCToolBarButton::GetImage](#getimage)|擷取的映像索引 按鈕。|
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|擷取工作區的按鈕，必須重新繪製的區域。|
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|擷取按鈕的父視窗。|
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|擷取使用者無法自訂的命令的清單。|
|[CMFCToolBarButton::GetTextSize](#gettextsize)|擷取按鈕文字的大小。|
|[CMFCToolBarButton::HasFocus](#hasfocus)|決定按鈕是否有目前的輸入的焦點。|
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|決定當使用者選取按鈕時，是否要顯示按鈕的框線。|
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|決定是否要將影像顯示在按鈕上。|
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|決定是否要將文字標籤顯示在按鈕上。|
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|決定按鈕是否顯示子功能表。|
|[CMFCToolBarButton::IsEditable](#iseditable)|判斷是否可以自訂按鈕。|
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|判斷是否可以使用擴充的框線中顯示按鈕。|
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|決定是否在其按鈕群組中的第一個位置 按鈕。|
|[CMFCToolBarButton::IsHidden](#ishidden)|決定是否要隱藏按鈕。|
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|判斷是否位於水平工具列按鈕。|
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|指定是否在其按鈕群組中的最後一個位置 按鈕。|
|[CMFCToolBarButton::IsLocked](#islocked)|判斷是否已鎖定 （非可自訂） 工具列上按鈕。|
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|判斷提供的視窗控制代碼的擁有者是否包含按鈕。|
|[CMFCToolBarButton::IsVisible](#isvisible)|決定工具列按鈕是否可見。|
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|決定按鈕的基礎視窗控制代碼是否可見。|
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|指定是否要處理按鈕[WM_COMMAND](/windows/desktop/menurc/wm-command)訊息。|
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|加入按鈕時由架構呼叫**自訂** 對話方塊。|
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|指定是否可以拖曳的按鈕。|
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|指定使用者是否可以卸除該按鈕拖曳至 [目標] 工具列。|
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|由架構呼叫以計算的銜接狀態與指定的裝置內容的按鈕大小。|
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|由架構呼叫以處理[WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode)訊息。|
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|插入新的工具列按鈕時由架構呼叫。|
|[CMFCToolBarButton::OnClick](#onclick)|使用者按下滑鼠按鈕時由架構呼叫。|
|[CMFCToolBarButton::OnClickUp](#onclickup)|當使用者放開滑鼠按鈕時由架構呼叫。|
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|為父工具列處理 WM_HELPHITTEST 訊息時由架構呼叫。|
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|為父工具列處理 WM_CTLCOLOR 訊息時由架構呼叫。|
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|可讓應用程式為父工具列上顯示快顯功能表時，修改提供的功能表按鈕。|
|[CMFCToolBarButton::OnDblClk](#ondblclk)|由架構呼叫，當處理為父工具列[需要知道 WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk)訊息。|
|[CMFCToolBarButton::OnDraw](#ondraw)|由架構呼叫以繪製按鈕，使用指定的樣式和選項。|
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|由架構呼叫以繪製按鈕**命令**窗格**自訂** 對話方塊。|
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|由架構呼叫以擷取按鈕的自訂工具提示文字。|
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|當全域的字型變更時由架構呼叫。|
|[CMFCToolBarButton::OnMove](#onmove)|為父工具列移動時，由架構呼叫。|
|[CMFCToolBarButton::OnShow](#onshow)|由架構呼叫時按鈕會變成可見或不可見。|
|[CMFCToolBarButton::OnSize](#onsize)|為父工具列變更它的大小或位置和這項變更需要變更大小的按鈕時由架構呼叫。|
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|為父工具列必須判斷點是否在週框的按鈕時由架構呼叫。|
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|為父工具列更新其工具提示文字時，由架構呼叫。|
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|執行拖放作業按鈕時由架構呼叫。|
|[CMFCToolBarButton::Rect](#rect)|擷取按鈕的週框矩形。|
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|設定為預設值是與按鈕關聯的映像。|
|[CMFCToolBarButton::SaveBarState](#savebarstate)|儲存狀態的工具列按鈕。|
|[CMFCToolBarButton::Serialize](#serialize)|從封存讀取這個物件，或將其寫入至封存。 (覆寫 [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)。)|
|[CMFCToolBarButton::SetACCData](#setaccdata)|填入所提供`CAccessibilityData`物件從工具列按鈕的協助工具資料。|
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|重新命名通用的剪貼簿格式。|
|[CMFCToolBarButton::SetImage](#setimage)|設定按鈕的影像索引。|
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|設定使用者無法自訂的命令的清單。|
|[CMFCToolBarButton::SetRadio](#setradio)|按鈕會變更其選取的狀態時，由架構呼叫。|
|[CMFCToolBarButton::SetRect](#setrect)|設定按鈕的週框矩形。|
|[CMFCToolBarButton::SetStyle](#setstyle)|設定按鈕的樣式。|
|[CMFCToolBarButton::SetVisible](#setvisible)|指定按鈕是否可見。|
|[CMFCToolBarButton::Show](#show)|顯示或隱藏 按鈕。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarButton::m_bImage](#m_bimage)|指定是否要將影像顯示在按鈕上。|
|[CMFCToolBarButton::m_bText](#m_btext)|指定是否在按鈕上顯示的文字標籤。|
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|指定是否顯示的文字標籤下方的按鈕上的映像。|
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|指定按鈕是否有使用者定義的映像。|
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|指定按鈕是否顯示其完整的文字標籤，即使它不符合的周框中。|
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|指定分隔符號旁邊的按鈕是否會放在下一個資料列。|
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|指定是否啟用多行文字標籤。|
|[CMFCToolBarButton::m_nID](#m_nid)|按鈕的命令識別碼。|
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|按鈕的樣式。|
|[CMFCToolBarButton::m_strText](#m_strtext)|按鈕的文字標籤。|

## <a name="remarks"></a>備註

A`CMFCToolbarButton`物件是位於工具列的控制項。 其行為類似於一般的按鈕。 您可以將影像和文字標籤指派給這個物件。 工具列按鈕也可以有命令識別碼。 當使用者按一下工具列按鈕時，架構就會執行這個 ID 指定的命令。

一般而言，您可以自訂工具列按鈕： 使用者可以將按鈕從一個工具列拖曳到另一個，並複製、 貼上、 刪除和編輯文字標籤和映像。 若要避免使用者自訂工具列，您可以在下列其中一種鎖定工具列。 設定`bLocked`為 TRUE，當您呼叫的旗標[CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)，或將個別的按鈕的命令識別碼新增至受保護的命令的全域清單中，使用[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)方法。

`CMFCToolBarButton` 物件會顯示應用程式中的全域集合的工具列影像的影像。 這些集合由 [父] 工具列中，維護[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)。 如需詳細資訊，請參閱 < [CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)。

當使用者按一下工具列按鈕時，其為父工具列處理滑鼠訊息，並進行通訊的按鈕適當的動作。 如果按鈕具有有效的命令 ID，為父工具列會傳送 WM_COMMAND 訊息至父框架。

`CMFCToolBarButton`類別是基底類別的類別其他工具列按鈕，例如[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)， [CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)，和[CMFCToolBarComboBoxButton 類別](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)。

## <a name="example"></a>範例

下列範例示範如何設定`CMFCToolBarButton`使用中的各種方法的物件`CMFCToolBarButton`類別。 此範例說明如何啟用滑鼠和鍵盤輸入，設定按鈕的影像索引、 設定的週框的按鈕，並顯示按鈕。 此程式碼片段是一部分[ 索引標籤控制項範例](../../overview/visual-cpp-samples.md)。

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxtoolbarbutton.h

##  <a name="canbedropped"></a>  CMFCToolBarButton::CanBeDropped

指定使用者是否可以放置在自訂期間的某個工具列或功能表上的按鈕。

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>參數

*pToolbar*<br/>
[in]未使用。

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

根據預設，工具列按鈕可放置在每個可自訂 （亦即，未鎖定） 工具列。

這個方法的預設實作會傳回 TRUE。 覆寫這個方法，並傳回 FALSE，如果您想要防止使用者調整按鈕的位置。

##  <a name="canbestored"></a>  CMFCToolBarButton::CanBeStored

判斷是否可以儲存 按鈕。

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

架構會使用這個方法決定按鈕是否可以參與拖放作業。

預設實作會傳回 TRUE。 如果無法儲存您的按鈕拖放作業的一部分，請覆寫這個方法。 如需拖放作業的詳細資訊，請參閱 <<c0> [ 拖放 (OLE)](../../mfc/drag-and-drop-ole.md)。

##  <a name="canbestretched"></a>  CMFCToolBarButton::CanBeStretched

指定使用者是否可以在自訂期間延伸按鈕。

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

此架構使用這個方法來判斷自訂模式中是否可以自動縮放 按鈕。

這個方法的預設實作會傳回 FALSE。 覆寫這個方法，以針對變動寬度的控制項，例如下拉式方塊或滑動軸會傳回 TRUE。

如需有關自訂模式的詳細資訊，請參閱 < [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。

##  <a name="cmfctoolbarbutton"></a>  CMFCToolBarButton::CMFCToolBarButton

建構並初始化 `CMFCToolBarButton` 物件。

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>參數

*uiID*<br/>
[in]按鈕的命令識別碼。

*iImage*<br/>
[in]映像的集合中的按鈕之影像索引。

*lpszText*<br/>
[in]按鈕的文字標籤。 可以是 NULL。

*bUserButton*<br/>
[in]布林值，判斷是否為使用者定義的按鈕。 如果此參數為 TRUE 時，按鈕是使用者定義的。 否則，從資源載入按鈕影像。

*bLocked*<br/>
[in]布林值，決定是否可以自訂按鈕。 如果此參數為 TRUE，則無法自訂按鈕。 否則，可以自訂按鈕。

##  <a name="comparewith"></a>  CMFCToolBarButton::CompareWith

比較這個執行個體與提供`CMFCToolBarButton`物件。

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>參數

*other*<br/>
[in]要與這個執行個體比較的物件參考。

### <a name="return-value"></a>傳回值

如果所提供的物件等於這個執行個體的值為非零否則就是 0。

### <a name="remarks"></a>備註

預設實作會判定所提供的物件的命令識別碼是否等於這個執行個體的命令識別碼。 覆寫這個方法，如果您必須執行額外的處理，以判斷兩個`CMFCToolBarButton`物件是否相等。

##  <a name="copyfrom"></a>  CMFCToolBarButton::CopyFrom

另一個工具列按鈕的屬性複製到目前的按鈕。

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>參數

*src*<br/>
[in]要從中複製來源按鈕參考。

### <a name="remarks"></a>備註

呼叫這個方法，以將另一個工具列按鈕複製到此工具列按鈕。

##  <a name="createfromoledata"></a>  CMFCToolBarButton::CreateFromOleData

會建立`CMFCToolBarButton`從提供的物件`COleDataObject`物件。

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>參數

*pDataObject*<br/>
[in]來源的 OLE 資料物件。

### <a name="return-value"></a>傳回值

建立的 `CMFCToolBarButton` 物件。

### <a name="remarks"></a>備註

這個方法由架構用以執行各種格式的資料傳輸。 比方說，`CMFCOutlookBarPane::OnDragOver`方法會使用這個方法來執行拖放作業。

##  <a name="enablewindow"></a>  CMFCToolBarButton::EnableWindow

啟用或停用滑鼠和鍵盤輸入。

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
[in]設定此參數，以啟用輸入 true 或 FALSE 會停用的輸入。

### <a name="remarks"></a>備註

這個方法會呼叫`EnableWindow`函式來啟用或停用的輸入。 如需詳細資訊，請參閱 < [EnableWindow](/windows/desktop/api/winuser/nf-winuser-enablewindow) Windows SDK 中。

##  <a name="exporttomenubutton"></a>  CMFCToolBarButton::ExportToMenuButton

複製文字從工具列按鈕的功能表。

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>參數

*menuButton*<br/>
[in][目標] 功能表按鈕的參考。

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以從工具列按鈕的文字複製到 [功能表] 按鈕。 預設實作會將複製 按鈕的文字標籤。 如果文字標籤是空的則這個方法會複製按鈕的工具提示文字。

這個方法的預設實作會傳回 TRUE。 覆寫這個方法，如果您想要採取其他動作，當架構將轉換的物件衍生自[CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)功能表按鈕。

##  <a name="getclipboardformat"></a>  CMFCToolBarButton::GetClipboardFormat

擷取應用程式的通用的剪貼簿格式。

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>傳回值

應用程式的全域 CLIPFORMAT 值。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以擷取 OLE 資料傳輸作業的剪貼簿格式。 例如， [CMFCToolBarButton::CreateFromOleData](#createfromoledata)方法會使用這個方法將資料從來源 OLE 資料物件複製。

這個方法會設定全域 CLIPFORMAT 值第一個階段會呼叫這個方法。 所有後續的呼叫，這個方法會傳回此值。

若要允許應用程式之間進行拖放作業，請呼叫[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)方法。

如需在 MFC 中的剪貼簿的詳細資訊，請參閱[剪貼簿](../../mfc/clipboard.md)。

##  <a name="gethwnd"></a>  CMFCToolBarButton::GetHwnd

擷取工具列按鈕與相關聯的視窗控制代碼。

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>傳回值

如果工具列按鈕沒有相關聯的視窗控制代碼為關聯的工具列按鈕或 NULL 視窗控制代碼。

### <a name="remarks"></a>備註

這個方法的預設實作會傳回 NULL。 覆寫此方法以傳回特定控制項的視窗控制代碼。

##  <a name="getimage"></a>  CMFCToolBarButton::GetImage

擷取的映像索引 按鈕。

```
int GetImage() const;
```

### <a name="return-value"></a>傳回值

此按鈕相關聯的影像索引。

### <a name="remarks"></a>備註

如果按鈕有使用者定義的映像 (亦即，如果*bUserButton*為 TRUE 的建構函式)，傳回的索引指定集合中的使用者定義的映像的映像 (請參閱[CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). 否則，索引會指定映像從資源檔載入的映像的集合中 (請參閱[CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages))。 如需有關資源檔的詳細資訊，請參閱[Working with Resource Files](../../windows/working-with-resource-files.md)。

##  <a name="getinvalidaterect"></a>  CMFCToolBarButton::GetInvalidateRect

擷取工作區的按鈕，必須重新繪製的區域。

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>傳回值

A`CRect`物件，指定必須重新繪製的區域。

### <a name="remarks"></a>備註

這個方法的預設實作會傳回整個工作區。 如果您想要重新描繪的不同區域，請覆寫這個方法。

##  <a name="getparentwnd"></a>  CMFCToolBarButton::GetParentWnd

擷取按鈕的父視窗。

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>傳回值

按鈕的父視窗。

##  <a name="getprotectedcommands"></a>  CMFCToolBarButton::GetProtectedCommands

擷取使用者無法自訂的命令的清單。

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>傳回值

受保護的命令清單。

### <a name="remarks"></a>備註

在自訂模式中，架構會停用受保護的工具列按鈕命令。 使用者無法執行拖放，然後編輯在已停用的工具列按鈕上的作業。

使用[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)方法定義的清單加以保護，命令。

##  <a name="gettextsize"></a>  CMFCToolBarButton::GetTextSize

擷取按鈕文字的大小。

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>傳回值

包含的大小，以像素為單位，則按鈕文字的大小物件。

##  <a name="hasfocus"></a>  CMFCToolBarButton::HasFocus

決定按鈕是否有目前的輸入的焦點。

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>傳回值

如果按鈕有輸入的焦點，非零值否則為 0。

### <a name="remarks"></a>備註

按鈕具有輸入的焦點則是子系或子代視窗具有輸入的焦點的視窗，這個方法的預設實作會傳回非零值。 您可以覆寫此函式以自訂此行為。

##  <a name="havehotborder"></a>  CMFCToolBarButton::HaveHotBorder

決定當使用者選取按鈕時，是否要顯示按鈕的框線。

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以決定當使用者選取它，工具列按鈕是否應該顯示框線。

預設實作會傳回 TRUE。 您可以覆寫這個方法以自訂此行為。

##  <a name="isdrawimage"></a>  CMFCToolBarButton::IsDrawImage

決定是否要將影像顯示在按鈕上。

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>傳回值

如果映像會顯示在按鈕，為非零否則為 0。

### <a name="remarks"></a>備註

如果工具列按鈕不具有任何相關聯的映像，這個方法會傳回 FALSE ( [CMFCToolBarButton::GetImage](#getimage)會傳回-1) 或 if [CMFCToolBarButton::m_bImage](#m_bimage)設為 FALSE。

##  <a name="isdrawtext"></a>  CMFCToolBarButton::IsDrawText

決定是否要將文字標籤顯示在按鈕上。

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>傳回值

如果會顯示文字標籤，為非零否則為 0。

### <a name="remarks"></a>備註

如果工具列按鈕有沒有相關聯的文字標籤，這個方法會傳回 FALSE ( [CMFCToolBarButton::m_strText](#m_strtext)是空的) 或[CMFCToolBarButton::m_bText](#m_btext)設為 FALSE。

##  <a name="isdroppeddown"></a>  CMFCToolBarButton::IsDroppedDown

決定按鈕是否顯示子功能表。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設實作會傳回 FALSE。 覆寫此方法以傳回 TRUE，如果您的控制項顯示的子功能表。

##  <a name="iseditable"></a>  CMFCToolBarButton::IsEditable

判斷是否可以自訂按鈕。

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>傳回值

如果可以由使用者; 自訂按鈕，非零值。否則為 0。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷使用者是否可以使用拖放自訂工具列按鈕，或編輯作業。

如果按鈕的命令 ID 是標準命令預設實作會傳回 FALSE (您可以呼叫來判斷這`IsStandardCommand`函式) 或是的命令的識別碼是在清單中受保護的命令。 如需受保護的命令的詳細資訊，請參閱[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)並[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)。

覆寫這個方法以自訂其行為。

##  <a name="isextrasize"></a>  CMFCToolBarButton::IsExtraSize

判斷是否可以使用擴充的框線中顯示按鈕。

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕可以使用擴充的框線; 來顯示，非零值。否則為 0。

### <a name="remarks"></a>備註

數個面板框線的工具列按鈕 （比方說，圓形按鈕） 使用額外的大小。

如果使用者會移到另一個從一個工具列的這個按鈕，架構會呼叫[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)方法。 [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)方法會將設定額外的大小旗標的新的父工具列 (如需詳細資訊，請參閱[CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable))。

##  <a name="isfirstingroup"></a>  CMFCToolBarButton::IsFirstInGroup

決定是否在其按鈕群組中的第一個位置 按鈕。

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>傳回值

如果按鈕已在其按鈕群組中的第一個按鈕，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會定義*按鈕群組*為一組相鄰，位於相同的資料列，並會受限於分隔符號 或 框線 工具列的按鈕。 如果工具列按鈕指的是，這個方法會傳回 FALSE**自訂** 按鈕。 如需詳細資訊**自訂**按鈕，請參閱[CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。

呼叫[CMFCToolBarButton::IsLastInGroup](#islastingroup)方法，以判斷是否在其按鈕群組中的最後一個位置 按鈕。

##  <a name="ishidden"></a>  CMFCToolBarButton::IsHidden

決定是否要隱藏按鈕。

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>傳回值

如果會隱藏 （不可見的;） 按鈕，非零值。否則為 0。

### <a name="remarks"></a>備註

為父工具列會自動縮放以判斷工具列按鈕是否為可見時，架構會呼叫這個方法。

如果您設定為不可見的使用按鈕[CMFCToolBarButton::SetVisible](#setvisible)方法，請使用[CMFCToolBarButton::IsVisible](#isvisible)以判斷工具列按鈕是否可見。

根據預設，所有的工具列按鈕會顯示。 使用[CMFCToolBarButton::Show](#show)方法來隱藏或顯示工具列按鈕。

##  <a name="ishorizontal"></a>  CMFCToolBarButton::IsHorizontal

判斷是否位於水平工具列按鈕。

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕位於水平的工具列中，為非零否則為 0。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷工具列按鈕的版面配置。

這個方法會傳回`m_bHorz`資料成員。 預設值`m_bHorz`資料成員為 TRUE，則會在每次呼叫重設[CMFCToolBarButton::OnDraw](#ondraw)方法。

##  <a name="islastingroup"></a>  CMFCToolBarButton::IsLastInGroup

指定是否在其按鈕群組中的最後一個位置 按鈕。

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是其按鈕群組; 中的最後一個按鈕，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會定義*按鈕群組*鄰近組位於相同的資料列，並會受限於分隔符號 或 框線 工具列的按鈕為這個方法會傳回 FALSE 工具列按鈕是否沒有父工具列或工具列按鈕是指**自訂** 按鈕。 如需詳細資訊**自訂**按鈕，請參閱[CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。

呼叫[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)方法，以判斷是否在其按鈕群組中的第一個位置 按鈕。

##  <a name="islocked"></a>  CMFCToolBarButton::IsLocked

判斷是否已鎖定 （非可自訂） 工具列上按鈕。

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是開啟 鎖定工具列中，為非零否則為 0。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷使用者是否可以使用拖放自訂工具列按鈕，或編輯作業。 鎖定的屬性設定為父工具列上，使用[CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)方法。 架構會將此屬性的值傳遞給每個工具列按鈕的建構函式 ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md))，它會插入為父工具列。

##  <a name="isownerof"></a>  CMFCToolBarButton::IsOwnerOf

判斷提供的視窗控制代碼的擁有者是否包含按鈕。

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>參數

*hwnd*<br/>
[in]視窗控制代碼。

### <a name="return-value"></a>傳回值

如果按鈕是提供的視窗控制代碼; 的擁有者為非零否則為 0。

### <a name="remarks"></a>備註

方法會傳回非零值時*hwnd*是指的是直接的視窗控制代碼，或不是與按鈕關聯的視窗控制代碼的子系。 這個方法會傳回 0，如果*hwnd*是 NULL。

##  <a name="isvisible"></a>  CMFCToolBarButton::IsVisible

決定工具列按鈕是否可見。

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>傳回值

如果工具列按鈕為可見;，非零值。否則為 0。

### <a name="remarks"></a>備註

您可以顯示或隱藏工具列按鈕，使用[CMFCToolBarButton::SetVisible](#setvisible)方法。 呼叫[CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法之後呼叫中的 [父] 工具列上[CMFCToolBarButton::SetVisible](#setvisible)重新計算為父工具列的版面配置。

##  <a name="iswindowvisible"></a>  CMFCToolBarButton::IsWindowVisible

決定按鈕的基礎視窗控制代碼是否可見。

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>傳回值

非零值，如果按鈕的基礎視窗控制代碼是可見的。否則為 0。

### <a name="remarks"></a>備註

這個方法會傳回非零值，如果基礎視窗控制代碼的樣式屬性包含 WS_VISIBLE 樣式。 如果按鈕的基礎視窗控制代碼為 NULL，這個方法會傳回 FALSE。

##  <a name="m_bimage"></a>  CMFCToolBarButton::m_bImage

指定是否要將影像顯示在按鈕上。

```
BOOL m_bImage;
```

### <a name="remarks"></a>備註

如果此資料成員設為 TRUE 時，架構會顯示工具列按鈕，相關聯的映像否則，架構就不會顯示映像。 這個成員會影響傳回值[CMFCToolBarButton::m_bImage](#m_bimage)方法。

##  <a name="m_btext"></a>  CMFCToolBarButton::m_bText

指定是否在按鈕上顯示的文字標籤。

```
BOOL m_bText;
```

### <a name="remarks"></a>備註

如果此資料成員設為 TRUE 時，架構會顯示文字標籤的工具列按鈕，否則，架構就不會顯示文字標籤。 這個成員會影響傳回值[CMFCToolBarButton::m_bText](#m_btext)方法。

##  <a name="m_btextbelow"></a>  CMFCToolBarButton::m_bTextBelow

指定是否顯示的文字標籤下方的按鈕上的映像。

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>備註

如果此成員變數設定為 TRUE 時，架構就會顯示映像下方按鈕的文字。 這個成員的預設值為 FALSE。

##  <a name="m_buserbutton"></a>  CMFCToolBarButton::m_bUserButton

指定按鈕是否有使用者定義的映像

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>備註

此資料成員是設定為 TRUE，當按鈕有與其相關聯的使用者定義映像。

##  <a name="m_bwholetext"></a>  CMFCToolBarButton::m_bWholeText

指定按鈕是否顯示其完整的文字標籤，即使它不符合的周框中。

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>備註

如果此資料成員設為 TRUE 時，架構會顯示全文檢索標籤加大 按鈕。 否則會截斷架構，並附加省略符號 ( **...**) 的文字標籤。

##  <a name="m_bwrap"></a>  CMFCToolBarButton::m_bWrap

指定分隔符號旁邊的按鈕是否會放在下一個資料列。

```
BOOL m_bWrap;
```

### <a name="remarks"></a>備註

工具列按鈕不符合目前的資料列上，或是當您指定的版面配置 （例如，特定數目的每個資料列的工具列按鈕） 時，架構會將此資料成員設為 TRUE。

架構會將此按鈕放上下一個資料列中，如果此資料成員設定為 TRUE，而且此工具列會水平固定或浮動。

此資料成員的預設值為 FALSE。

##  <a name="m_bwraptext"></a>  CMFCToolBarButton::m_bWrapText

指定是否啟用多行文字標籤。

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>備註

如果此靜態成員變數為 TRUE 時，架構可讓所有的工具列，工具列按鈕上顯示多行文字標籤。

此資料成員的預設值為 FALSE。

##  <a name="m_nid"></a>  CMFCToolBarButton::m_nID

按鈕的命令識別碼。

```
UINT m_nID;
```

### <a name="remarks"></a>備註

-1 的命令識別碼，表示按鈕是分隔符號。 所有按鈕分隔符號都有 TBBS_SEPARATOR 樣式。 請參閱[CMFCToolBarButton::m_nStyle](#m_nstyle)的按鈕樣式的詳細資訊。

##  <a name="m_nstyle"></a>  CMFCToolBarButton::m_nStyle

按鈕的樣式。

```
UINT m_nStyle;
```

### <a name="remarks"></a>備註

請參閱[ToolBar 控制項樣式](../../mfc/reference/toolbar-control-styles.md)可用工具列按鈕樣式的清單。

##  <a name="m_strtext"></a>  CMFCToolBarButton::m_strText

按鈕的文字標籤。

```
CString m_strText;
```

### <a name="remarks"></a>備註

此資料成員包含按鈕的文字標籤。 文字標籤可以是空的。

##  <a name="notifycommand"></a>  CMFCToolBarButton::NotifyCommand

指定是否要處理按鈕[WM_COMMAND](/windows/desktop/menurc/wm-command)訊息。

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>參數

*iNotifyCode*<br/>
[in]與命令相關聯的通知訊息。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

要傳送時，架構會呼叫這個方法[WM_COMMAND](/windows/desktop/menurc/wm-command)父視窗的訊息。

根據預設，這個方法會傳回 FALSE。 覆寫此方法以傳回為 true，則如果您想要處理 WM_COMMAND 訊息或 FALSE，表示為父工具列應該會處理訊息。

##  <a name="onaddtocustomizepage"></a>  CMFCToolBarButton::OnAddToCustomizePage

加入按鈕時由架構呼叫**自訂** 對話方塊。

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，如果您想要加入的按鈕時執行某些動作**自訂** 對話方塊。

##  <a name="onbeforedrag"></a>  CMFCToolBarButton::OnBeforeDrag

指定是否可以拖曳的按鈕。

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>傳回值

如果可以拖曳的按鈕;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法之前使用者開始拖曳的按鈕。

這個方法的預設實作會傳回 TRUE。 覆寫此方法以傳回 FALSE 來停用的按鈕拖曳。

##  <a name="onbeforedrop"></a>  CMFCToolBarButton::OnBeforeDrop

指定使用者是否可以卸除該按鈕拖曳至 [目標] 工具列。

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>參數

*pTarget*<br/>
[in]拖放作業的目標。

### <a name="return-value"></a>傳回值

如果按鈕可拖曳至 [提供的目標] 工具列中，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法之前卸除按鈕拖曳至工具列。

這個方法的預設實作會傳回 TRUE。 覆寫此方法以傳回 FALSE 來停用指定的目標的拖放作業。

##  <a name="oncalculatesize"></a>  CMFCToolBarButton::OnCalculateSize

由架構呼叫以計算的銜接狀態與指定的裝置內容的按鈕大小。

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容，顯示的按鈕。

*sizeDefault*<br/>
[in]按鈕的預設大小。

*bHorz*<br/>
[in]為父工具列停駐狀態。 如果工具列停駐垂直，這個參數會是如果工具列會以水平方式停駐或浮動，則為 TRUE 或 FALSE。

### <a name="return-value"></a>傳回值

A`SIZE`結構，其中包含按鈕，像素為單位的大小。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以判斷指定的裝置內容的工具列按鈕的大小和停駐狀態。

預設實作會考慮的文字和影像的大小 （如果有顯示）、 文字和影像的位置 （文字低於或等於右側的映像） 和工具列停駐狀態。

如果您想要提供標準按鈕 （例如，編輯按鈕） 的大小，請覆寫這個方法。

##  <a name="oncancelmode"></a>  CMFCToolBarButton::OnCancelMode

由架構呼叫以處理[WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode)訊息。

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，如果您想要處理[WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode)訊息。

##  <a name="onchangeparentwnd"></a>  CMFCToolBarButton::OnChangeParentWnd

插入新的工具列按鈕時由架構呼叫。

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>參數

*pWndParent*<br/>
[in]新的父視窗。

### <a name="remarks"></a>備註

按鈕會插入至工具列，比方說，當使用者拖曳它從一個工具列到另一個工具列。

這個方法的預設實作會執行任何動作。

##  <a name="onclick"></a>  CMFCToolBarButton::OnClick

使用者按下滑鼠按鈕時由架構呼叫。

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]工具列按鈕的父視窗。

*bDelay*<br/>
[in]如果應該處理訊息，且延遲時間，則為 TRUE。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者按一下工具列按鈕時，架構會呼叫這個方法。

預設實作不做任何動作，且會傳回 FALSE。 覆寫此方法以傳回非零值，如果按鈕處理按一下訊息。

##  <a name="onclickup"></a>  CMFCToolBarButton::OnClickUp

當使用者放開滑鼠按鈕時由架構呼叫。

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者放開工具列按鈕時，架構會呼叫這個方法。

預設實作不做任何動作，且會傳回 FALSE。 覆寫此方法以傳回非零值，如果按鈕處理按一下訊息。

##  <a name="oncontexthelp"></a>  CMFCToolBarButton::OnContextHelp

為父工具列處理 WM_HELPHITTEST 訊息時由架構呼叫。

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]工具列按鈕的父視窗。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設實作不做任何動作，且會傳回 FALSE。 覆寫此方法以傳回非零值，如果按鈕處理說明訊息。

如需有關 WM_HELPHITTEST 訊息的詳細資訊，請參閱[TN028:即時線上說明支援](../../mfc/tn028-context-sensitive-help-support.md)。

##  <a name="onctlcolor"></a>  CMFCToolBarButton::OnCtlColor

為父工具列處理 WM_CTLCOLOR 訊息時由架構呼叫。

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容，顯示的按鈕。

*nCtlColor*<br/>
[in]特定色彩的通知。

### <a name="return-value"></a>傳回值

架構會使用來繪製按鈕背景的筆刷物件控制代碼。

### <a name="remarks"></a>備註

當處理 WM_CTLCOLOR 訊息包含 Windows 控制項的工具列按鈕為父工具列時，架構會呼叫這個方法。 無視窗的工具列按鈕是否 framework 不會呼叫這個方法。

工具列架構已自訂模式和工具列按鈕就會解除鎖定時，架構會呼叫這個方法。 如需有關自訂模式的詳細資訊，請參閱 < [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。 如需有關鎖定工具列按鈕的詳細資訊，請參閱[CMFCToolBarButton::IsLocked](#islocked)。

預設實作不做任何動作，並傳回 NULL。

##  <a name="oncustomizemenu"></a>  CMFCToolBarButton::OnCustomizeMenu

可讓應用程式為父工具列上顯示快顯功能表時，修改提供的功能表按鈕。

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>參數

*pMenu*<br/>
[in]若要自訂功能表。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作，且會傳回 FALSE。 覆寫這個方法，並傳回非零值，如果您想要修改的內容功能表。

##  <a name="ondblclk"></a>  CMFCToolBarButton::OnDblClk

由架構呼叫，當處理為父工具列[需要知道 WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk)訊息。

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]-[] 按鈕的父視窗。

### <a name="remarks"></a>備註

這個方法會呼叫`CMFCToolBar::OnLButtonDblClk`方法時處理為父工具列[需要知道 WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk)訊息。

這個方法的預設實作會執行任何動作。

##  <a name="ondraw"></a>  CMFCToolBarButton::OnDraw

由架構呼叫以繪製按鈕，使用指定的樣式和選項。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容，顯示的按鈕。

*rect*<br/>
[in]按鈕的週框。

*pImages*<br/>
[in]與按鈕關聯的工具列影像集合。

*bHorz*<br/>
[in]為父工具列停駐狀態。 [] 按鈕停駐時以水平和 FALSE 以垂直方式停駐按鈕時，此參數為 TRUE。

*bCustomizeMode*<br/>
[in]指定工具列是否為自訂模式。 當工具列在自訂模式和 FALSE 無法自訂模式工具列時，此參數為 TRUE。

*bHighlight*<br/>
[in]指定按鈕會反白顯示。 這個參數時，按鈕會反白顯示時的 TRUE 和 FALSE 按鈕不反白顯示。

*bDrawBorder*<br/>
[in]指定按鈕是否應該顯示框線。 此參數為 TRUE，當按鈕應該顯示其框線和 FALSE，當按鈕應該不會顯示其框線時。

*bGrayDisabledButtons*<br/>
[in]指定是否要加上陰影停用的按鈕，或使用已停用的映像集合。 此參數為 TRUE，當停用的按鈕應該是陰影則為 FALSE，當這個方法應該使用已停用的映像集合。

### <a name="remarks"></a>備註

覆寫這個方法以自訂工具列按鈕繪製。

##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarButton::OnDrawOnCustomizeList

由架構呼叫以繪製按鈕**命令**窗格**自訂** 對話方塊。

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容，顯示的按鈕。

*rect*<br/>
[in]按鈕的週框。

*bSelected*<br/>
[in]指定是否已選取按鈕。 如果此參數為 TRUE 時，會選取 [] 按鈕。 如果此參數為 FALSE，未選取 按鈕。

### <a name="return-value"></a>傳回值

寬度，單位為像素上指定的裝置內容的按鈕。

### <a name="remarks"></a>備註

自訂 對話方塊中會呼叫此方法 (**命令** 索引標籤) 按鈕時將顯示本身為主控描繪清單方塊上。

如果有的話，這個方法的預設實作會顯示按鈕的影像和文字標籤。 如果找不到按鈕的文字標籤，此方法會顯示工具提示文字。

覆寫這個方法，以執行自訂繪圖。

##  <a name="ongetcustomtooltiptext"></a>  CMFCToolBarButton::OnGetCustomToolTipText

由架構呼叫以擷取按鈕的自訂工具提示文字。

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>參數

*strToolTip*<br/>
[out]A`CString`收到自訂的工具提示文字的物件。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

顯示工具列按鈕的工具提示時，架構會呼叫這個方法。 如果這個方法會傳回 FALSE，則架構會使用預設的工具提示。

預設實作不做任何動作，且會傳回 FALSE。 覆寫這個方法，並傳回非零的值為工具列按鈕提供自訂的工具提示文字。

##  <a name="onglobalfontschanged"></a>  CMFCToolBarButton::OnGlobalFontsChanged

當全域的字型變更時由架構呼叫。

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，以更新用來顯示按鈕文字的字型。

##  <a name="onmove"></a>  CMFCToolBarButton::OnMove

為父工具列移動時，由架構呼叫。

```
virtual void OnMove();
```

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，以調整為父工具列移動 按鈕的位置。

##  <a name="onshow"></a>  CMFCToolBarButton::OnShow

由架構呼叫時按鈕會變成可見或不可見。

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
[in]指定按鈕是否可見。 如果此參數為 TRUE，則按鈕會顯示。 否則，按鈕看不到。

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，以更新按鈕可見。

##  <a name="onsize"></a>  CMFCToolBarButton::OnSize

為父工具列變更它的大小或位置和這項變更會使按鈕將大小變更時由架構呼叫。

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>參數

*iSize*<br/>
[in]按鈕的新寬度。

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，以調整按鈕大小的大小或位置，為父工具列的變更時。

##  <a name="ontoolhittest"></a>  CMFCToolBarButton::OnToolHitTest

為父工具列必須判斷點是否在週框的按鈕時由架構呼叫。

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]按鈕的父視窗。 可以是 NULL。

*pTI*<br/>
[in]A`TOOLINFO`結構，其中包含一項工具的工具提示控制項的相關資訊。

### <a name="return-value"></a>傳回值

結果`OnMenuButtonToolHitTest`如果按鈕可以擷取一個指向父框架視窗中; 否則為 FALSE。

### <a name="remarks"></a>備註

如果它可以轉換成有效的畫面格物件的父視窗，這個方法會呼叫下列方法之一：

- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>  CMFCToolBarButton::OnUpdateToolTip

為父工具列更新其工具提示文字時，由架構呼叫。

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>參數

*pWndParent*<br/>
[in]父視窗。

*iButtonIndex*<br/>
[in]父代按鈕集合中的按鈕之以零起始的索引。

*wndToolTip*<br/>
[in]顯示工具提示文字的控制項。

*str*<br/>
[out]A`CString`接收更新的工具提示文字的物件。

### <a name="return-value"></a>傳回值

這個方法會傳回 FALSE。

### <a name="remarks"></a>備註

這個方法的預設實作不做任何動作，且會傳回 FALSE。 覆寫此方法以傳回非零值，如果您提供的工具提示文字字串。

##  <a name="preparedrag"></a>  CMFCToolBarButton::PrepareDrag

執行拖放作業按鈕時由架構呼叫。

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>參數

*srcItem*<br/>
[in]A`COleDataSource`儲存拖放作業的狀態資訊的物件。

### <a name="return-value"></a>傳回值

如果作業成功，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以準備的工具列按鈕，以將其狀態儲存在提供`COleDataSource`物件。 此方法會將其狀態儲存序列化本身共用的檔案，然後再將該檔案，以傳遞[COleDataSource::CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata)方法。 如需有關工具列按鈕序列化的詳細資訊，請參閱[CMFCToolBarButton::Serialize](#serialize)。

這個方法不做任何動作，則傳回 TRUE，如果無法儲存按鈕 ( [CMFCToolBarButton::CanBeStored](#canbestored)方法會傳回 FALSE)。 如果發生例外狀況物件序列化時，它會傳回 FALSE。

如需有關 OLE 拖放作業的詳細資訊，請參閱[拖放 (OLE)](../../mfc/drag-and-drop-ole.md)。

##  <a name="rect"></a>  CMFCToolBarButton::Rect

擷取按鈕的週框矩形。

```
const CRect& Rect() const;
```

### <a name="return-value"></a>傳回值

A`CRect`物件，其中包含按鈕的週框矩形。

##  <a name="resetimagetodefault"></a>  CMFCToolBarButton::ResetImageToDefault

設定為預設值是與按鈕關聯的映像。

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>備註

這個方法會擷取預設映像從其父工具列利用[CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage)方法。 如果按鈕有沒有相關聯的預設映像，這個方法會藉由設定根據其字串資源按鈕的文字標籤[CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring)方法。 如需有關字串資源的詳細資訊，請參閱[Working with Resource Files](../../windows/working-with-resource-files.md)。

如果按鈕有使用者定義的映像，這個方法沒有任何作用。

##  <a name="savebarstate"></a>  CMFCToolBarButton::SaveBarState

儲存狀態的工具列按鈕。

```
virtual void SaveBarState();
```

### <a name="remarks"></a>備註

架構會呼叫這個方法會在建立時`CMFCToolBarButton`物件做為拖放作業的結果。

這個方法的預設實作會執行任何動作。 覆寫這個方法，以將工具列按鈕的狀態儲存至外部資料來源。

##  <a name="serialize"></a>  CMFCToolBarButton::Serialize

從封存讀取這個物件，或將其寫入至封存。

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
[in]`CArchive`從中或要序列化的物件。

### <a name="remarks"></a>備註

這個方法支援資料傳輸程序，例如剪貼簿或拖放作業。 讀取或寫入的按鈕，例如識別碼、 文字標籤和映像識別碼的屬性，或以提供`CArchive`物件。

如需序列化的範例，請參閱[序列化：將物件序列化為](../../mfc/serialization-serializing-an-object.md)。

##  <a name="setaccdata"></a>  CMFCToolBarButton::SetACCData

填入所提供`CAccessibilityData`物件從工具列按鈕的協助工具資料。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
[in]工具列按鈕的父視窗。

*data*<br/>
[in]A`CAccessibilityData`工具列按鈕的協助工具資料填入的物件。

### <a name="return-value"></a>傳回值

這個方法會傳回 TRUE。

### <a name="remarks"></a>備註

覆寫此方法以傳回 FALSE，如果您的工具列按鈕不會提供協助工具資料。

##  <a name="setclipboardformatname"></a>  CMFCToolBarButton::SetClipboardFormatName

重新命名通用的剪貼簿格式。

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>參數

*lpszName*<br/>
[in]通用的剪貼簿格式的新名稱。 不可以是 NULL。

### <a name="remarks"></a>備註

這個方法可讓多個應用程式之間發生的拖放作業。 每個應用程式必須提供相同的剪貼簿格式名稱。

您必須呼叫這個方法之前，架構會呼叫[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)。

##  <a name="setimage"></a>  CMFCToolBarButton::SetImage

設定按鈕的影像索引。

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>參數

*iImage*<br/>
[in]工具列影像的集合中影像的索引。

### <a name="remarks"></a>備註

工具列按鈕是否為分隔符號， *iImage*指的是 [分隔符號] 按鈕的新寬度。

如果*iImage*小於零，這個方法會停用 繪製影像並可讓繪製按鈕的文字標籤。

##  <a name="setprotectedcommands"></a>  CMFCToolBarButton::SetProtectedCommands

設定使用者無法自訂的命令的清單。

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>參數

*lstCmds*<br/>
[in]受保護的命令清單。

### <a name="remarks"></a>備註

在自訂模式中，架構會停用受保護的工具列按鈕命令。 使用者無法執行拖放，然後編輯在已停用的工具列按鈕上的作業。

使用[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)方法來擷取清單中的受保護的命令。

##  <a name="setradio"></a>  CMFCToolBarButton::SetRadio

按鈕會變更其選取的狀態時，由架構呼叫。

```
virtual void SetRadio();
```

### <a name="remarks"></a>備註

這個方法的預設實作會執行任何動作。 覆寫這個方法，以執行自訂動作時，按鈕會變成其核取的狀態。

##  <a name="setrect"></a>  CMFCToolBarButton::SetRect

設定按鈕的週框矩形。

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>參數

*rect*<br/>
[in]按鈕的新週框矩形。

### <a name="remarks"></a>備註

這個方法會呼叫[CMFCToolBarButton::OnMove](#onmove)方法之後它會設定新的週框矩形。

##  <a name="setstyle"></a>  CMFCToolBarButton::SetStyle

設定按鈕的樣式。

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>參數

*nStyle*<br/>
[in]新按鈕的樣式。

### <a name="remarks"></a>備註

預設實作集[CMFCToolBarButton::m_nStyle](#m_nstyle)資料成員，才能*nStyle*。 如果您想要執行額外的處理，以處理在樣式中的變更，請覆寫這個方法。 請參閱[ToolBar 控制項樣式](toolbar-control-styles.md)如需有效的樣式旗標的清單。

##  <a name="setvisible"></a>  CMFCToolBarButton::SetVisible

指定按鈕是否可見。

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>參數

*bShow*<br/>
[in]布林值，指定是否要顯示或隱藏按鈕。 如果此參數為 TRUE 時，會顯示 [] 按鈕。 如果參數為 FALSE，則會隱藏按鈕。

### <a name="remarks"></a>備註

使用此函式，來隱藏或顯示特定的工具列按鈕。 呼叫[CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法之後呼叫這個方法。

##  <a name="show"></a>  CMFCToolBarButton::Show

顯示或隱藏 按鈕。

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>參數

*bShow*<br/>
[in]布林值，指定是否要顯示或隱藏按鈕。 如果此參數為 TRUE 時，會顯示 [] 按鈕。 如果參數為 FALSE，則會隱藏按鈕。

### <a name="remarks"></a>備註

架構會呼叫這個方法，以更新工具列按鈕的可見性，其為父工具列調整大小時。 架構會呼叫這個方法時*bShow*不再符合工具列的範圍內的按鈕時，設定為 FALSE。 架構會呼叫這個方法時*bShow*設定為 TRUE 之後再調整按鈕的大小符合工具列的範圍內。

使用[CMFCToolBarButton::SetVisible](#setvisible)方法來設定一般按鈕的可見性。

這個方法會呼叫[CMFCToolBarButton::OnShow](#onshow)之後便會更新 [] 按鈕的可見性狀態的方法。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)
