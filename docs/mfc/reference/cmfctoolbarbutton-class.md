---
title: "CMFCToolBarButton 類別 |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
caps.latest.revision: 
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload:
- cplusplus
ms.openlocfilehash: 3aaf355d15679bdb30b7561fe28dd6f927688ede
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/21/2017
---
# <a name="cmfctoolbarbutton-class"></a>CMFCToolBarButton 類別
提供工具列按鈕功能。  
  
## <a name="syntax"></a>語法  
  
```  
class CMFCToolBarButton : public CObject  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|建構並初始化 `CMFCToolBarButton` 物件。|  
|`CMFCToolBarButton::~CMFCToolBarButton`|解構函式。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|指定使用者是否可以在自訂期間放置工具列或功能表上的按鈕。|  
|[CMFCToolBarButton::CanBeStored](#canbestored)|指定是否可以儲存 按鈕。|  
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|指定使用者是否可以在自訂期間延伸按鈕。|  
|[CMFCToolBarButton::CompareWith](#comparewith)|比較這個執行個體使用提供`CMFCToolBarButton`物件。|  
|[CMFCToolBarButton::CopyFrom](#copyfrom)|將另一個工具列按鈕的內容複製到目前的按鈕。|  
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|建立`CMFCToolBarButton`從提供的物件`COleDataObject`物件。|  
|`CMFCToolBarButton::CreateObject`|由建立此類別類型的動態執行個體架構所使用。|  
|[CMFCToolBarButton::EnableWindow](#enablewindow)|啟用或停用滑鼠和鍵盤輸入。|  
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|複製文字從工具列按鈕加入的功能表。|  
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|擷取應用程式通用的剪貼簿格式。|  
|[CMFCToolBarButton::GetHwnd](#gethwnd)|擷取工具列按鈕與相關聯的視窗控制代碼。|  
|[CMFCToolBarButton::GetImage](#getimage)|擷取映像索引 按鈕。|  
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|擷取用戶端必須重繪按鈕區域的區域。|  
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|擷取按鈕的父視窗。|  
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|擷取使用者無法自訂的命令的清單。|  
|[CMFCToolBarButton::GetTextSize](#gettextsize)|擷取按鈕文字的大小。|  
|[CMFCToolBarButton::HasFocus](#hasfocus)|決定按鈕是否有目前的輸入的焦點。|  
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|決定當使用者選擇按鈕時，是否要顯示按鈕的框線。|  
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|決定是否要將影像顯示在按鈕上。|  
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|決定是否要將文字標籤顯示在按鈕上。|  
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|決定按鈕是否顯示子功能表。|  
|[CMFCToolBarButton::IsEditable](#iseditable)|決定是否可以自訂按鈕。|  
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|決定是否可以使用擴充的框線顯示按鈕。|  
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|決定是否在按鈕群組中的第一個位置 按鈕。|  
|[CMFCToolBarButton::IsHidden](#ishidden)|決定是否要隱藏按鈕。|  
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|決定是否水平工具列位於按鈕。|  
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|指定是否在按鈕群組中的最後一個位置 按鈕。|  
|[CMFCToolBarButton::IsLocked](#islocked)|判斷是否已鎖定 （非可自訂） 工具列按鈕。|  
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|決定是否擁有者提供的視窗控制代碼 按鈕。|  
|[CMFCToolBarButton::IsVisible](#isvisible)|決定工具列按鈕是否可見。|  
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|決定基礎視窗控制代碼 按鈕是否可見。|  
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|指定是否要處理按鈕[WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591)訊息。|  
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|加入按鈕時由架構呼叫**自訂** 對話方塊。|  
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|指定是否可以拖曳按鈕。|  
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|指定使用者是否可以卸除在目標工具列上的按鈕。|  
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|由架構呼叫以計算指定之裝置內容和停駐狀態的按鈕的大小。|  
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|由架構呼叫以處理[WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615)訊息。|  
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|插入新的工具列按鈕時由架構呼叫。|  
|[CMFCToolBarButton::OnClick](#onclick)|當使用者按一下滑鼠按鈕時由架構呼叫。|  
|[CMFCToolBarButton::OnClickUp](#onclickup)|當使用者放開滑鼠按鈕時由架構呼叫。|  
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|為父工具列處理時，由架構呼叫`WM_HELPHITTEST`訊息。|  
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|為父工具列處理時，由架構呼叫`WM_CTLCOLOR`訊息。|  
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|可讓應用程式為父工具列上顯示快顯功能表時，修改提供的功能表按鈕。|  
|[CMFCToolBarButton::OnDblClk](#ondblclk)|為父工具列處理時，由架構呼叫[WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606)訊息。|  
|[CMFCToolBarButton::OnDraw](#ondraw)|由架構呼叫以繪製按鈕，使用指定的樣式和選項。|  
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|由架構呼叫以繪製按鈕**命令**窗格**自訂** 對話方塊。|  
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|由架構呼叫以擷取按鈕的自訂工具提示文字。|  
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|當全域字型變更時由架構呼叫。|  
|[CMFCToolBarButton::OnMove](#onmove)|為父工具列移動時由架構呼叫。|  
|[CMFCToolBarButton::OnShow](#onshow)|由架構呼叫時，按鈕會變成可見或不可見。|  
|[CMFCToolBarButton::OnSize](#onsize)|為父工具列變更它的大小或位置，這項變更需要變更大小的按鈕時由架構呼叫。|  
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|為父工具列必須判斷是否點中的週框的按鈕時由架構呼叫。|  
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|為父工具列更新其工具提示文字時，由架構呼叫。|  
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|執行拖放作業的按鈕時由架構呼叫。|  
|[CMFCToolBarButton::Rect](#rect)|擷取週框的按鈕。|  
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|設定為預設值與按鈕相關聯的映像。|  
|[CMFCToolBarButton::SaveBarState](#savebarstate)|儲存的工具列按鈕的狀態。|  
|[CMFCToolBarButton::Serialize](#serialize)|從封存讀取此物件，或將它寫入至封存。 (覆寫 [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize)。)|  
|[CMFCToolBarButton::SetACCData](#setaccdata)|填入提供`CAccessibilityData`物件從工具列按鈕的協助工具資料。|  
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|重新命名通用的剪貼簿格式。|  
|[CMFCToolBarButton::SetImage](#setimage)|設定按鈕的影像索引。|  
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|設定使用者無法自訂的命令的清單。|  
|[CMFCToolBarButton::SetRadio](#setradio)|按鈕變更目的選取的狀態時由架構呼叫。|  
|[CMFCToolBarButton::SetRect](#setrect)|設定按鈕的週框矩形。|  
|[CMFCToolBarButton::SetStyle](#setstyle)|設定按鈕的樣式。|  
|[CMFCToolBarButton::SetVisible](#setvisible)|指定按鈕是否可見。|  
|[CMFCToolBarButton::Show](#show)|顯示或隱藏按鈕。|  
  
### <a name="data-members"></a>資料成員  
  
|名稱|描述|  
|----------|-----------------|  
|[CMFCToolBarButton::m_bImage](#m_bimage)|指定是否在按鈕上顯示的影像。|  
|[CMFCToolBarButton::m_bText](#m_btext)|指定是否在按鈕上顯示的文字標籤。|  
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|指定是否要將文字標籤顯示底下的按鈕上的映像。|  
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|指定按鈕是否有使用者定義的映像。|  
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|指定即使無法容納的周框中 按鈕是否會顯示其完整的文字標籤。|  
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|指定分隔符號旁邊的按鈕會在下一個資料列。|  
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|指定是否啟用多行文字標籤。|  
|[CMFCToolBarButton::m_nID](#m_nid)|按鈕的命令識別碼。|  
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|按鈕的樣式。|  
|[CMFCToolBarButton::m_strText](#m_strtext)|按鈕的文字標籤。|  
  
## <a name="remarks"></a>備註  
 A`CMFCToolbarButton`物件是一個位於工具列的控制項。 其行為類似於一般按鈕。 您可以為此物件指派的映像和文字標籤。 工具列按鈕也可以有命令識別碼。 當使用者按一下工具列按鈕時，framework 就會執行這個識別碼所指定的命令。  
  
 一般而言，您可以自訂工具列按鈕： 使用者可以將按鈕從一個工具列拖曳到另一個，並複製、 貼上、 刪除和編輯文字標籤和影像。 若要防止使用者自訂工具列，您可以在其中一種鎖定工具列。 設定`bLocked`旗標設為`TRUE`當您呼叫[CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)，或使用受保護的命令之全域清單加入個別的按鈕的命令識別碼[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)方法。  
  
 `CMFCToolBarButton`物件會顯示應用程式中的工具列影像之全域集合中的映像。 這些集合由 [父] 工具列中，維護[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)。 如需詳細資訊，請參閱[CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)。  
  
 當使用者按一下工具列按鈕時，其為父工具列處理滑鼠訊息，並進行通訊的按鈕以適當的動作。 如果按鈕具有有效的命令 ID，為父工具列會傳送`WM_COMMAND`父框架的訊息。  
  
 `CMFCToolBarButton`類別是基底類別的類別其他工具列按鈕，例如[CMFCToolBarMenuButton 類別](../../mfc/reference/cmfctoolbarmenubutton-class.md)， [CMFCToolBarEditBoxButton 類別](../../mfc/reference/cmfctoolbareditboxbutton-class.md)，和[CMFCToolBarComboBoxButton 類別](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)。  
  
## <a name="example"></a>範例  
 下列範例示範如何設定`CMFCToolBarButton`物件使用中的各種方法`CMFCToolBarButton`類別。 此範例說明如何啟用滑鼠及鍵盤輸入，設定按鈕的影像索引、 設定按鈕的週框和顯示按鈕。 此程式碼片段是部分[ 索引標籤控制項範例](../../visual-cpp-samples.md)。  
  
 [!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]  
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  
  
## <a name="requirements"></a>需求  
 **標頭：** afxtoolbarbutton.h  
  
##  <a name="canbedropped"></a>CMFCToolBarButton::CanBeDropped  
 指定使用者是否可以在自訂期間放置工具列或功能表上的按鈕。  
  
```  
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pToolbar`  
 未使用。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `TRUE`。  
  
### <a name="remarks"></a>備註  
 根據預設，工具列按鈕可以卸除上每個可自訂 （也就是未鎖定） 工具列。  
  
 這個方法的預設實作會傳回`TRUE`。 覆寫這個方法，並傳回`FALSE`如果您想要防止使用者重新調整按鈕的位置。  
  
##  <a name="canbestored"></a>CMFCToolBarButton::CanBeStored  
 決定是否要儲存 按鈕。  
  
```  
virtual BOOL CanBeStored() const;  
```  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `TRUE`。  
  
### <a name="remarks"></a>備註  
 架構會使用這個方法來決定按鈕是否可以參與拖放作業。  
  
 預設實作會傳回 `TRUE`。 如果無法儲存您的按鈕拖放作業的一部分，請覆寫這個方法。 如需拖放作業的詳細資訊，請參閱[拖放 (OLE)](../../mfc/drag-and-drop-ole.md)。  
  
##  <a name="canbestretched"></a>CMFCToolBarButton::CanBeStretched  
 指定使用者是否可以在自訂期間延伸按鈕。  
  
```  
virtual BOOL CanBeStretched() const;  
```  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 架構會使用這個方法來決定按鈕是否可以延伸以自訂模式。  
  
 這個方法的預設實作會傳回`FALSE`。 覆寫此方法以傳回`TRUE`變動寬度的控制項，例如下拉式方塊或滑動軸。  
  
 如需自訂模式的詳細資訊，請參閱[CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。  
  
##  <a name="cmfctoolbarbutton"></a>CMFCToolBarButton::CMFCToolBarButton  
 建構並初始化 `CMFCToolBarButton` 物件。  
  
```  
CMFCToolBarButton(
    UINT uiID,  
    int iImage,  
    LPCTSTR lpszText=NULL,  
    BOOL bUserButton=FALSE,  
    BOOL bLocked=FALSE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `uiID`  
 按鈕的命令識別碼。  
  
 [輸入] `iImage`  
 使用的影像集合中的按鈕影像索引。  
  
 [輸入] `lpszText`  
 按鈕的文字標籤。 可以是`NULL`。  
  
 [輸入] `bUserButton`  
 布林值，判斷是否為使用者定義 按鈕。 如果這個參數是`TRUE`，是使用者定義的按鈕。 否則，從資源載入按鈕影像。  
  
 [輸入] `bLocked`  
 布林值，決定是否可以自訂按鈕。 如果這個參數是`TRUE`，無法自訂按鈕。 否則，您可以自訂按鈕。  
  
##  <a name="comparewith"></a>CMFCToolBarButton::CompareWith  
 比較這個執行個體使用提供`CMFCToolBarButton`物件。  
  
```  
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `other`  
 要與這個執行個體比較的物件參考。  
  
### <a name="return-value"></a>傳回值  
 如果所提供的物件等於這個執行個體的值為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 預設實作會決定所提供的物件的命令識別碼是否等於這個執行個體的命令識別碼。 如果您必須執行額外的處理，以判斷兩個覆寫這個方法`CMFCToolBarButton`物件是否相等。  
  
##  <a name="copyfrom"></a>CMFCToolBarButton::CopyFrom  
 將另一個工具列按鈕的內容複製到目前的按鈕。  
  
```  
virtual void CopyFrom(const CMFCToolBarButton& src);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `src`  
 要從中複製來源 按鈕參考。  
  
### <a name="remarks"></a>備註  
 呼叫這個方法，將另一個工具列按鈕複製到此工具列按鈕。  
  
##  <a name="createfromoledata"></a>CMFCToolBarButton::CreateFromOleData  
 建立`CMFCToolBarButton`從提供的物件`COleDataObject`物件。  
  
```  
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDataObject`  
 來源的 OLE 資料物件。  
  
### <a name="return-value"></a>傳回值  
 建立的 `CMFCToolBarButton` 物件。  
  
### <a name="remarks"></a>備註  
 這個方法由架構用於執行資料傳輸以各種格式。 例如，`CMFCOutlookBarPane::OnDragOver`方法使用這個方法來執行拖放作業。  
  
##  <a name="enablewindow"></a>CMFCToolBarButton::EnableWindow  
 啟用或停用滑鼠和鍵盤輸入。  
  
```  
virtual void EnableWindow(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bEnable`  
 這個參數設定為`TRUE`若要啟用的輸入，或`FALSE`停用的輸入。  
  
### <a name="remarks"></a>備註  
 這個方法會呼叫`EnableWindow`函式來啟用或停用的輸入。 如需詳細資訊，請參閱[EnableWindow](http://msdn.microsoft.com/library/windows/desktop/ms646291) Windows SDK 中。  
  
##  <a name="exporttomenubutton"></a>CMFCToolBarButton::ExportToMenuButton  
 複製文字從工具列按鈕加入的功能表。  
  
```  
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `menuButton`  
 目標功能表按鈕的參考。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `TRUE`。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以從工具列按鈕的文字複製到功能表按鈕。 預設實作會複製按鈕的文字標籤。 如果是空的文字標籤，這個方法會複製按鈕的工具提示文字。  
  
 這個方法的預設實作會傳回`TRUE`。 覆寫這個方法，如果您想要採取更多動作，當架構將轉換的物件，衍生自[CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)功能表按鈕。  
  
##  <a name="getclipboardformat"></a>CMFCToolBarButton::GetClipboardFormat  
 擷取應用程式通用的剪貼簿格式。  
  
```  
static CLIPFORMAT __stdcall GetClipboardFormat();
```  
  
### <a name="return-value"></a>傳回值  
 全域`CLIPFORMAT`應用程式的值。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以擷取 OLE 資料傳輸作業的剪貼簿格式。 例如， [CMFCToolBarButton::CreateFromOleData](#createfromoledata)方法會使用這個方法將資料從來源 OLE 資料物件複製。  
  
 這個方法會設定全域`CLIPFORMAT`值第一次呼叫這個方法。 所有後續呼叫這個方法會傳回此值。  
  
 若要允許進行應用程式之間的拖放作業，請呼叫[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)方法。  
  
 如需有關可在 MFC 中的剪貼簿的詳細資訊，請參閱[剪貼簿](../../mfc/clipboard.md)。  
  
##  <a name="gethwnd"></a>CMFCToolBarButton::GetHwnd  
 擷取工具列按鈕與相關聯的視窗控制代碼。  
  
```  
virtual HWND GetHwnd();
```  
  
### <a name="return-value"></a>傳回值  
 工具列按鈕與相關聯的視窗控制代碼或`NULL`工具列按鈕是否沒有相關聯的視窗控制代碼。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作會傳回`NULL`。 覆寫此方法以傳回特定控制項的視窗控制代碼。  
  
##  <a name="getimage"></a>CMFCToolBarButton::GetImage  
 擷取映像索引 按鈕。  
  
```  
int GetImage() const;  
```  
  
### <a name="return-value"></a>傳回值  
 這個按鈕相關聯的映像的索引。  
  
### <a name="remarks"></a>備註  
 如果按鈕具有使用者定義的映像 (亦即，如果`bUserButton`已`TRUE`建構函式中)，傳回的索引指定集合中的使用者定義的映像的映像 (請參閱[CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages))。 否則，索引會指定映像從資源檔載入的映像的集合中 (請參閱[CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages))。 如需資源檔的詳細資訊，請參閱[使用的資源檔](../../windows/working-with-resource-files.md)。  
  
##  <a name="getinvalidaterect"></a>CMFCToolBarButton::GetInvalidateRect  
 擷取用戶端必須重繪按鈕區域的區域。  
  
```  
virtual const CRect GetInvalidateRect() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`CRect`物件，指定必須重新繪製的區域。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作會傳回整個工作區。 如果您想要重新描繪的其他區域，請覆寫這個方法。  
  
##  <a name="getparentwnd"></a>CMFCToolBarButton::GetParentWnd  
 擷取按鈕的父視窗。  
  
```  
CWnd* GetParentWnd() const;  
```  
  
### <a name="return-value"></a>傳回值  
 按鈕的父視窗。  
  
##  <a name="getprotectedcommands"></a>CMFCToolBarButton::GetProtectedCommands  
 擷取使用者無法自訂的命令的清單。  
  
```  
static const CList<UINT,UINT>& GetProtectedCommands();
```  
  
### <a name="return-value"></a>傳回值  
 受保護的命令清單。  
  
### <a name="remarks"></a>備註  
 在自訂模式中，架構會停用保護 工具列按鈕命令。 使用者無法執行拖放，然後編輯在已停用的工具列按鈕上的作業。  
  
 使用[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)方法，以定義的受保護的命令。  
  
##  <a name="gettextsize"></a>CMFCToolBarButton::GetTextSize  
 擷取按鈕文字的大小。  
  
```  
SIZE GetTextSize() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`SIZE`物件，其中包含的大小，以像素為單位，則按鈕文字。  
  
##  <a name="hasfocus"></a>CMFCToolBarButton::HasFocus  
 決定按鈕是否有目前的輸入的焦點。  
  
```  
virtual BOOL HasFocus() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果按鈕具有輸入的焦點，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 如果具有輸入的焦點的按鈕，或者是子系或下階視窗具有輸入的焦點的視窗，這個方法的預設實作會傳回非零值。 您可以覆寫此函式以自訂此行為。  
  
##  <a name="havehotborder"></a>CMFCToolBarButton::HaveHotBorder  
 決定當使用者選擇按鈕時，是否要顯示按鈕的框線。  
  
```  
virtual BOOL HaveHotBorder() const;  
```  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `TRUE`。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以決定當使用者選取它，工具列按鈕是否應該顯示框線。  
  
 預設實作會傳回 `TRUE`。 您可以覆寫這個方法以自訂此行為。  
  
##  <a name="isdrawimage"></a>CMFCToolBarButton::IsDrawImage  
 決定是否要將影像顯示在按鈕上。  
  
```  
BOOL IsDrawImage() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果影像會顯示在按鈕，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 這個方法會傳回`FALSE`工具列按鈕是否沒有相關聯的映像 ( [CMFCToolBarButton::GetImage](#getimage)傳回-1) 如果[CMFCToolBarButton::m_bImage](#m_bimage)設`FALSE`。  
  
##  <a name="isdrawtext"></a>CMFCToolBarButton::IsDrawText  
 決定是否要將文字標籤顯示在按鈕上。  
  
```  
BOOL IsDrawText() const;  
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果顯示的文字標籤。否則便是 0。  
  
### <a name="remarks"></a>備註  
 這個方法會傳回`FALSE`工具列按鈕是否沒有相關聯的文字標籤 ( [CMFCToolBarButton::m_strText](#m_strtext)是空的) 或[CMFCToolBarButton::m_bText](#m_btext)設`FALSE`。  
  
##  <a name="isdroppeddown"></a>CMFCToolBarButton::IsDroppedDown  
 決定按鈕是否顯示子功能表。  
  
```  
virtual BOOL IsDroppedDown() const;  
```  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作會傳回`FALSE`。 覆寫此方法以傳回`TRUE`如果您的控制項顯示的子功能表。  
  
##  <a name="iseditable"></a>CMFCToolBarButton::IsEditable  
 決定是否可以自訂按鈕。  
  
```  
virtual BOOL IsEditable() const;  
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果可以由使用者; 自訂按鈕否則便是 0。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法來判斷使用者是否可以使用拖放自訂工具列按鈕，或編輯作業。  
  
 預設實作會傳回`FALSE`如果按鈕的命令 ID 是標準的命令 (您可以呼叫來判斷這`IsStandardCommand`函式) 或是的命令識別碼的清單中已受保護的命令。 如需受保護的命令的詳細資訊，請參閱[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)和[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)。  
  
 覆寫這個方法以自訂其行為。  
  
##  <a name="isextrasize"></a>CMFCToolBarButton::IsExtraSize  
 決定是否可以使用擴充的框線顯示按鈕。  
  
```  
virtual BOOL IsExtraSize() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果工具列按鈕可以顯示擴充的框線; 具有非零，否則便是 0。  
  
### <a name="remarks"></a>備註  
 數個面板框線的工具列按鈕 （例如圓形按鈕） 使用額外的大小。  
  
 如果使用者會從一個工具列此按鈕，移至另一個，架構會呼叫[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)方法。 [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)方法設定新的父工具列的額外大小旗標 (如需詳細資訊，請參閱[CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable))。  
  
##  <a name="isfirstingroup"></a>CMFCToolBarButton::IsFirstInGroup  
 決定是否在按鈕群組中的第一個位置 按鈕。  
  
```  
virtual BOOL IsFirstInGroup() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果按鈕的按鈕群組; 中的第一個按鈕否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 這個方法會定義*按鈕群組*為一組鄰近按鈕位於同一個資料列，並依分隔符號或工具列的框線繫結。 這個方法會傳回`FALSE`工具列按鈕是指如果**自訂** 按鈕。 如需有關**自訂**按鈕，請參閱[CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。  
  
 呼叫[CMFCToolBarButton::IsLastInGroup](#islastingroup)方法，以判斷是否在按鈕群組中的最後一個位置 按鈕。  
  
##  <a name="ishidden"></a>CMFCToolBarButton::IsHidden  
 決定是否要隱藏按鈕。  
  
```  
BOOL IsHidden() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果會隱藏按鈕 （隱藏）; 非零，否則便是 0。  
  
### <a name="remarks"></a>備註  
 為父工具列會延伸以決定是否顯示工具列按鈕時，架構會呼叫這個方法。  
  
 如果您設定為不可見的使用按鈕[CMFCToolBarButton::SetVisible](#setvisible)方法，請使用[CMFCToolBarButton::IsVisible](#isvisible)判斷工具列按鈕是否可見。  
  
 根據預設，所有的工具列按鈕會顯示。 使用[CMFCToolBarButton::Show](#show)方法，以隱藏或顯示工具列按鈕。  
  
##  <a name="ishorizontal"></a>CMFCToolBarButton::IsHorizontal  
 決定是否水平工具列位於按鈕。  
  
```  
BOOL IsHorizontal() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果工具列按鈕位於水平的工具列，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以判斷工具列按鈕的配置。  
  
 這個方法會傳回`m_bHorz`資料成員。 預設值`m_bHorz`資料成員是`TRUE`; 每次呼叫會重設[CMFCToolBarButton::OnDraw](#ondraw)方法。  
  
##  <a name="islastingroup"></a>CMFCToolBarButton::IsLastInGroup  
 指定是否在按鈕群組中的最後一個位置 按鈕。  
  
```  
virtual BOOL IsLastInGroup() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果是它的按鈕群組; 最後一個 按鈕否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 這個方法會定義*按鈕群組*為一組鄰近按鈕都位於同一個資料列，並依分隔符號或這個方法會傳回的工具列的框線繫結`FALSE`如果工具列按鈕沒有父代工具列或工具列按鈕是指**自訂** 按鈕。 如需有關**自訂**按鈕，請參閱[CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton)。  
  
 呼叫[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)方法，以判斷是否在按鈕群組中的第一個位置 按鈕。  
  
##  <a name="islocked"></a>CMFCToolBarButton::IsLocked  
 判斷是否已鎖定 （非可自訂） 工具列按鈕。  
  
```  
BOOL IsLocked() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果按鈕上的鎖定工具列，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法來判斷使用者是否可以使用拖放自訂工具列按鈕，或編輯作業。 利用鎖定的屬性設定為父工具列[CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)方法。 架構會將這個屬性的值傳遞至建構函式的每個工具列按鈕 ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md))，它會插入到為父工具列。  
  
##  <a name="isownerof"></a>CMFCToolBarButton::IsOwnerOf  
 決定是否擁有者提供的視窗控制代碼 按鈕。  
  
```  
virtual BOOL IsOwnerOf(HWND hwnd);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `hwnd`  
 視窗控制代碼。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果已提供的視窗控制代碼; 的擁有者 按鈕。否則便是 0。  
  
### <a name="remarks"></a>備註  
 此方法傳回非零，如果`hwnd`指的是直接的視窗控制代碼或子系與按鈕相關聯的視窗控制代碼。 這個方法會傳回 0，如果`hwnd`是`NULL`。  
  
##  <a name="isvisible"></a>CMFCToolBarButton::IsVisible  
 決定工具列按鈕是否可見。  
  
```  
BOOL IsVisible() const;  
```  
  
### <a name="return-value"></a>傳回值  
 為非零，工具列按鈕是否可見的。否則便是 0。  
  
### <a name="remarks"></a>備註  
 您可以顯示或隱藏工具列按鈕使用[CMFCToolBarButton::SetVisible](#setvisible)方法。 呼叫[CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法之後呼叫中的 [父] 工具列上[CMFCToolBarButton::SetVisible](#setvisible)重新計算為父工具列的版面配置。  
  
##  <a name="iswindowvisible"></a>CMFCToolBarButton::IsWindowVisible  
 決定基礎視窗控制代碼 按鈕是否可見。  
  
```  
virtual BOOL IsWindowVisible();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果基礎視窗控制代碼 按鈕是可見的。否則便是 0。  
  
### <a name="remarks"></a>備註  
 這個方法會傳回非零，如果基礎視窗控制代碼的樣式屬性包含`WS_VISIBLE`樣式。 這個方法會傳回`FALSE`按鈕的基礎視窗控制代碼是否`NULL`。  
  
##  <a name="m_bimage"></a>CMFCToolBarButton::m_bImage  
 指定是否在按鈕上顯示的影像。  
  
```  
BOOL m_bImage;  
```  
  
### <a name="remarks"></a>備註  
 如果此資料成員設定為`TRUE`，架構會顯示工具列按鈕與相關聯的映像; 否則架構不會顯示映像。 這個成員會影響傳回值[CMFCToolBarButton::m_bImage](#m_bimage)方法。  
  
##  <a name="m_btext"></a>CMFCToolBarButton::m_bText  
 指定是否在按鈕上顯示的文字標籤。  
  
```  
BOOL m_bText;  
```  
  
### <a name="remarks"></a>備註  
 如果此資料成員設定為`TRUE`，架構會顯示工具列按鈕的文字標籤，否則架構不會顯示文字標籤。 這個成員會影響傳回值[CMFCToolBarButton::m_bText](#m_btext)方法。  
  
##  <a name="m_btextbelow"></a>CMFCToolBarButton::m_bTextBelow  
 指定是否要將文字標籤顯示底下的按鈕上的映像。  
  
```  
BOOL m_bTextBelow;  
```  
  
### <a name="remarks"></a>備註  
 如果此成員變數會設為`TRUE`，架構會顯示影像下方按鈕的文字。 這個成員的預設值是`FALSE`。  
  
##  <a name="m_buserbutton"></a>CMFCToolBarButton::m_bUserButton  
 指定按鈕是否有使用者定義的映像  
  
```  
BOOL m_bUserButton;  
```  
  
### <a name="remarks"></a>備註  
 此資料成員設定為`TRUE`當按鈕具有與它相關聯的使用者定義映像。  
  
##  <a name="m_bwholetext"></a>CMFCToolBarButton::m_bWholeText  
 指定即使無法容納的周框中 按鈕是否會顯示其完整的文字標籤。  
  
```  
BOOL m_bWholeText;  
```  
  
### <a name="remarks"></a>備註  
 如果此資料成員設定為`TRUE`，架構會加大按鈕顯示的完整文字標籤。 否則，架構會截斷，並將附加的省略符號 ( **...**) 的文字標籤。  
  
##  <a name="m_bwrap"></a>CMFCToolBarButton::m_bWrap  
 指定分隔符號旁邊的按鈕會在下一個資料列。  
  
```  
BOOL m_bWrap;  
```  
  
### <a name="remarks"></a>備註  
 架構會將此資料成員設定為`TRUE`當工具列按鈕不適合目前資料列上，或是當您指定的配置 （例如，特定數目的每個資料列的工具列按鈕）。  
  
 架構在下一個資料列上放置此按鈕，此資料成員設定為`TRUE`以及工具列停駐水平或浮動。  
  
 此資料成員的預設值是`FALSE`。  
  
##  <a name="m_bwraptext"></a>CMFCToolBarButton::m_bWrapText  
 指定是否啟用多行文字標籤。  
  
```  
AFX_IMPORT_DATA static BOOL m_bWrapText;  
```  
  
### <a name="remarks"></a>備註  
 如果此靜態成員變數是`TRUE`，架構可讓所有工具列，工具列按鈕上顯示多行文字標籤。  
  
 此資料成員的預設值是`FALSE`。  
  
##  <a name="m_nid"></a>CMFCToolBarButton::m_nID  
 按鈕的命令識別碼。  
  
```  
UINT m_nID;  
```  
  
### <a name="remarks"></a>備註  
 命令 ID 是-1 指出按鈕為分隔符號。 所有按鈕分隔符號`TBBS_SEPARATOR`樣式。 請參閱[CMFCToolBarButton::m_nStyle](#m_nstyle)如需有關按鈕樣式。  
  
##  <a name="m_nstyle"></a>CMFCToolBarButton::m_nStyle  
 按鈕的樣式。  
  
```  
UINT m_nStyle;  
```  
  
### <a name="remarks"></a>備註  
 請參閱[ToolBar 控制項樣式](../../mfc/reference/toolbar-control-styles.md)可用工具列按鈕樣式的清單。  
  
##  <a name="m_strtext"></a>CMFCToolBarButton::m_strText  
 按鈕的文字標籤。  
  
```  
CString m_strText;  
```  
  
### <a name="remarks"></a>備註  
 此資料成員包含按鈕的文字標籤。 文字標籤可以是空的。  
  
##  <a name="notifycommand"></a>CMFCToolBarButton::NotifyCommand  
 指定是否要處理按鈕[WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591)訊息。  
  
```  
virtual BOOL NotifyCommand(int iNotifyCode);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `iNotifyCode`  
 與命令相關聯的通知訊息。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，當它是傳送[WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591)父視窗的訊息。  
  
 根據預設，這個方法會傳回`FALSE`。 覆寫此方法以傳回`TRUE`如果您想要處理`WM_COMMAND`訊息或`FALSE`表示為父工具列應該處理訊息。  
  
##  <a name="onaddtocustomizepage"></a>CMFCToolBarButton::OnAddToCustomizePage  
 加入按鈕時由架構呼叫**自訂** 對話方塊。  
  
```  
virtual void OnAddToCustomizePage();
```  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，如果您想要加入的按鈕時執行某些動作**自訂** 對話方塊。  
  
##  <a name="onbeforedrag"></a>CMFCToolBarButton::OnBeforeDrag  
 指定是否可以拖曳按鈕。  
  
```  
virtual BOOL OnBeforeDrag() const;  
```  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果可以拖曳按鈕。否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 使用者開始拖曳按鈕之前，架構會呼叫這個方法。  
  
 這個方法的預設實作會傳回`TRUE`。 覆寫此方法以傳回`FALSE`停用按鈕的拖曳。  
  
##  <a name="onbeforedrop"></a>CMFCToolBarButton::OnBeforeDrop  
 指定使用者是否可以卸除在目標工具列上的按鈕。  
  
```  
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pTarget`  
 拖放作業的目標。  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果按鈕可以放到提供的目標 工具列中。否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法之前按鈕拖曳至工具列上。  
  
 這個方法的預設實作會傳回`TRUE`。 覆寫此方法以傳回`FALSE`停用指定的目標上卸除作業。  
  
##  <a name="oncalculatesize"></a>CMFCToolBarButton::OnCalculateSize  
 由架構呼叫以計算指定之裝置內容和停駐狀態的按鈕的大小。  
  
```  
virtual SIZE OnCalculateSize(
    CDC* pDC,  
    const CSize& sizeDefault,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
 裝置內容顯示的按鈕。  
  
 [輸入] `sizeDefault`  
 按鈕的預設大小。  
  
 [輸入] `bHorz`  
 為父工具列停駐狀態。 這個參數是`TRUE`工具列水平停駐或浮動，如果或`FALSE`若垂直停駐工具列。  
  
### <a name="return-value"></a>傳回值  
 A`SIZE`結構，其中包含按鈕，像素為單位的維度。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以判斷指定的裝置內容的工具列按鈕的大小和停駐狀態。  
  
 預設實作會將視為文字和影像的大小 （如果顯示）、 文字和影像的位置 （的文字下方，或在右手邊的映像） 和工具列停駐狀態。  
  
 如果您想要提供非標準按鈕 （例如，編輯按鈕） 的大小，請覆寫這個方法。  
  
##  <a name="oncancelmode"></a>CMFCToolBarButton::OnCancelMode  
 由架構呼叫以處理[WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615)訊息。  
  
```  
virtual void OnCancelMode();
```  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，如果您想要處理[WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615)訊息。  
  
##  <a name="onchangeparentwnd"></a>CMFCToolBarButton::OnChangeParentWnd  
 插入新的工具列按鈕時由架構呼叫。  
  
```  
virtual void OnChangeParentWnd(CWnd* pWndParent);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWndParent`  
 新的父視窗。  
  
### <a name="remarks"></a>備註  
 按鈕會插入至工具列，比方說，當使用者拖曳它一個工具列從其他工具列。  
  
 這個方法的預設實作沒有任何作用。  
  
##  <a name="onclick"></a>CMFCToolBarButton::OnClick  
 當使用者按一下滑鼠按鈕時由架構呼叫。  
  
```  
virtual BOOL OnClick(
    CWnd* pWnd,  
    BOOL bDelay=TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWnd`  
 父視窗的工具列按鈕。  
  
 [輸入] `bDelay`  
 `TRUE`如果應該處理訊息，且延遲時間。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 當使用者按一下工具列按鈕時，架構會呼叫這個方法。  
  
 預設實作不做任何動作，並傳回`FALSE`。 覆寫此方法以傳回非零值，如果按鈕處理按一下的訊息。  
  
##  <a name="onclickup"></a>CMFCToolBarButton::OnClickUp  
 當使用者放開滑鼠按鈕時由架構呼叫。  
  
```  
virtual BOOL OnClickUp();
```  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 當使用者放開工具列按鈕時，架構會呼叫這個方法。  
  
 預設實作不做任何動作，並傳回`FALSE`。 覆寫此方法以傳回非零值，如果按鈕處理按一下的訊息。  
  
##  <a name="oncontexthelp"></a>CMFCToolBarButton::OnContextHelp  
 為父工具列處理時，由架構呼叫`WM_HELPHITTEST`訊息。  
  
```  
virtual BOOL OnContextHelp(CWnd* pWnd);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWnd`  
 父視窗的工具列按鈕。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作不做任何動作，並傳回`FALSE`。 覆寫此方法以傳回非零值，如果按鈕處理說明訊息。  
  
 如需有關`WM_HELPHITTEST`訊息，請參閱[TN028： 即時線上說明支援](../../mfc/tn028-context-sensitive-help-support.md)。  
  
##  <a name="onctlcolor"></a>CMFCToolBarButton::OnCtlColor  
 為父工具列處理時，由架構呼叫`WM_CTLCOLOR`訊息。  
  
```  
virtual HBRUSH OnCtlColor(
    CDC* pDC,  
    UINT nCtlColor);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
 裝置內容顯示的按鈕。  
  
 [輸入] `nCtlColor`  
 特定色彩的通知。  
  
### <a name="return-value"></a>傳回值  
 架構會使用來繪製按鈕的背景筆刷物件的控制代碼。  
  
### <a name="remarks"></a>備註  
 為父工具列處理時，架構會呼叫這個方法`WM_CTLCOLOR`包含 Windows 控制項的工具列按鈕的訊息。 無視窗的工具列按鈕是否架構不會呼叫這個方法。  
  
 工具列 framework 是以自訂模式和工具列按鈕已解除鎖定時，架構會呼叫這個方法。 如需自訂模式的詳細資訊，請參閱[CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode)。 如需鎖定工具列按鈕的詳細資訊，請參閱[CMFCToolBarButton::IsLocked](#islocked)。  
  
 預設實作不做任何動作，並傳回`NULL`。  
  
##  <a name="oncustomizemenu"></a>CMFCToolBarButton::OnCustomizeMenu  
 可讓應用程式為父工具列上顯示快顯功能表時，修改提供的功能表按鈕。  
  
```  
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pMenu`  
 若要自訂功能表。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 預設實作不做任何動作，並傳回`FALSE`。 覆寫這個方法，並傳回非零值，如果您想要修改提供功能表的內容。  
  
##  <a name="ondblclk"></a>CMFCToolBarButton::OnDblClk  
 為父工具列處理時，由架構呼叫[WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606)訊息。  
  
```  
virtual void OnDblClk(CWnd* pWnd);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWnd`  
 -   按鈕的父視窗。  
  
### <a name="remarks"></a>備註  
 這個方法會呼叫`CMFCToolBar::OnLButtonDblClk`方法為父工具列處理時[WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606)訊息。  
  
 這個方法的預設實作沒有任何作用。  
  
##  <a name="ondraw"></a>CMFCToolBarButton::OnDraw  
 由架構呼叫以繪製按鈕，使用指定的樣式和選項。  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rect,  
    CMFCToolBarImages* pImages,  
    BOOL bHorz=TRUE,  
    BOOL bCustomizeMode=FALSE,  
    BOOL bHighlight=FALSE,  
    BOOL bDrawBorder=TRUE,  
    BOOL bGrayDisabledButtons=TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
 裝置內容顯示的按鈕。  
  
 [輸入] `rect`  
 按鈕的週框。  
  
 [輸入] `pImages`  
 與按鈕相關聯的工具列影像集合。  
  
 [輸入] `bHorz`  
 為父工具列停駐狀態。 這個參數是`TRUE`當按鈕會停駐水平及`FALSE`當按鈕會停駐垂直。  
  
 [輸入] `bCustomizeMode`  
 指定工具列是否為自訂模式。 這個參數是`TRUE`工具列時自訂模式和`FALSE`當工具列不是以自訂模式。  
  
 [輸入] `bHighlight`  
 指定按鈕會反白顯示。 這個參數是`TRUE`按鈕反白顯示和`FALSE`時的按鈕不強調顯示。  
  
 [輸入] `bDrawBorder`  
 指定按鈕是否應顯示框線。 這個參數是`TRUE`按鈕時應該顯示框線和`FALSE`當按鈕不應該顯示框線。  
  
 [輸入] `bGrayDisabledButtons`  
 指定是否要加上陰影停用的按鈕，或使用已停用的影像集合。 這個參數是`TRUE`已停用的按鈕時應該會有陰影和`FALSE`當這個方法應該使用已停用的影像集合。  
  
### <a name="remarks"></a>備註  
 覆寫這個方法可自訂工具列按鈕繪圖。  
  
##  <a name="ondrawoncustomizelist"></a>CMFCToolBarButton::OnDrawOnCustomizeList  
 由架構呼叫以繪製按鈕**命令**窗格**自訂** 對話方塊。  
  
```  
virtual int OnDrawOnCustomizeList(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bSelected);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pDC`  
 裝置內容顯示的按鈕。  
  
 [輸入] `rect`  
 按鈕的週框。  
  
 [輸入] `bSelected`  
 指定是否已選取 [] 按鈕。 如果這個參數是`TRUE`，選取 [] 按鈕。 如果這個參數是`FALSE`，請勿選取按鈕。  
  
### <a name="return-value"></a>傳回值  
 寬度 （像素為單位指定的裝置內容上的按鈕）。  
  
### <a name="remarks"></a>備註  
 這個方法會呼叫的自訂對話方塊 (**命令** 索引標籤)  按鈕即將顯示在主控描繪清單方塊。  
  
 如果有的話，這個方法的預設實作會顯示按鈕的影像和文字標籤。 如果找不到按鈕的文字標籤，此方法會顯示工具提示文字。  
  
 覆寫這個方法，以執行自訂繪圖。  
  
##  <a name="ongetcustomtooltiptext"></a>CMFCToolBarButton::OnGetCustomToolTipText  
 由架構呼叫以擷取按鈕的自訂工具提示文字。  
  
```  
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```  
  
### <a name="parameters"></a>參數  
 [輸出] `strToolTip`  
 A`CString`物件，可接收的自訂工具提示文字。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 在顯示的工具列按鈕的工具提示時，架構會呼叫這個方法。 如果此方法傳回`FALSE`，架構會使用預設工具提示。  
  
 預設實作不做任何動作，並傳回`FALSE`。 覆寫這個方法，並傳回非零的值，以提供工具列按鈕的自訂工具提示文字。  
  
##  <a name="onglobalfontschanged"></a>CMFCToolBarButton::OnGlobalFontsChanged  
 當全域字型變更時由架構呼叫。  
  
```  
virtual void OnGlobalFontsChanged();
```  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，以更新用來顯示按鈕文字的字型。  
  
##  <a name="onmove"></a>CMFCToolBarButton::OnMove  
 為父工具列移動時由架構呼叫。  
  
```  
virtual void OnMove();
```  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，以調整按鈕的位置，為父工具列移動時。  
  
##  <a name="onshow"></a>CMFCToolBarButton::OnShow  
 由架構呼叫時，按鈕會變成可見或不可見。  
  
```  
virtual void OnShow(BOOL bShow);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bShow`  
 指定按鈕是否可見。 如果這個參數是`TRUE`，按鈕會顯示。 否則，按鈕看不到。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，以更新按鈕可見。  
  
##  <a name="onsize"></a>CMFCToolBarButton::OnSize  
 為父工具列變更它的大小或位置，這項變更會使按鈕將大小變更時由架構呼叫。  
  
```  
virtual void OnSize(int iSize);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `iSize`  
 新按鈕的寬度。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫此方法以縮放按鈕的大小或位置，為父工具列的變更時。  
  
##  <a name="ontoolhittest"></a>CMFCToolBarButton::OnToolHitTest  
 為父工具列必須判斷是否點中的週框的按鈕時由架構呼叫。  
  
```  
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,  
    TOOLINFO* pTI);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWnd`  
 按鈕的父視窗。 可以是`NULL`。  
  
 [輸入] `pTI`  
 A`TOOLINFO`結構，其中包含一項工具的工具提示控制項的相關資訊。  
  
### <a name="return-value"></a>傳回值  
 結果`OnMenuButtonToolHitTest`若按鈕可以擷取指向父框架視窗中; 否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 如果它可以轉換成有效的框架物件的父視窗，這個方法會呼叫下列方法之一：  
  
- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)  
  
- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)  
  
- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)  
  
##  <a name="onupdatetooltip"></a>CMFCToolBarButton::OnUpdateToolTip  
 為父工具列更新其工具提示文字時，由架構呼叫。  
  
```  
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,  
    int iButtonIndex,  
    CToolTipCtrl& wndToolTip,  
    CString& str);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pWndParent`  
 父視窗。  
  
 [輸入] `iButtonIndex`  
 父代按鈕集合中的按鈕之以零為起始索引。  
  
 [輸入] `wndToolTip`  
 在顯示工具提示文字的控制項。  
  
 [輸出] `str`  
 A`CString`接收更新的工具提示文字的物件。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `FALSE`。  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作不做任何動作，並傳回`FALSE`。 覆寫此方法以傳回非零值，如果您提供的工具提示文字字串。  
  
##  <a name="preparedrag"></a>CMFCToolBarButton::PrepareDrag  
 執行拖放作業的按鈕時由架構呼叫。  
  
```  
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `srcItem`  
 A`COleDataSource`儲存拖放作業的相關狀態資訊的物件。  
  
### <a name="return-value"></a>傳回值  
 `TRUE`如果作業成功。否則`FALSE`。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以準備工具列按鈕，將其狀態儲存在提供`COleDataSource`物件。 這個方法會由序列化本身共用的檔案，然後再將傳遞至該檔案來儲存其狀態[COleDataSource::CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata)方法。 如需有關工具列按鈕序列化的詳細資訊，請參閱[CMFCToolBarButton::Serialize](#serialize)。  
  
 這個方法不做任何動作，並傳回`TRUE`如果無法儲存按鈕 ( [CMFCToolBarButton::CanBeStored](#canbestored)方法會傳回`FALSE`)。 它會傳回`FALSE`物件序列化期間發生的例外狀況。  
  
 如需 OLE 拖放作業的詳細資訊，請參閱[拖放 (OLE)](../../mfc/drag-and-drop-ole.md)。  
  
##  <a name="rect"></a>CMFCToolBarButton::Rect  
 擷取週框的按鈕。  
  
```  
const CRect& Rect() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`CRect`物件，其中包含按鈕的週框矩形。  
  
##  <a name="resetimagetodefault"></a>CMFCToolBarButton::ResetImageToDefault  
 設定為預設值與按鈕相關聯的映像。  
  
```  
virtual void ResetImageToDefault();
```  
  
### <a name="remarks"></a>備註  
 這個方法會擷取預設影像從其父工具列使用[CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage)方法。 如果按鈕有沒有相關聯的預設映像，這個方法會使用設定根據其字串資源的按鈕的文字標籤[CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring)方法。 如需字串資源的詳細資訊，請參閱[使用的資源檔](../../windows/working-with-resource-files.md)。  
  
 如果按鈕具有使用者定義的映像，這個方法沒有任何作用。  
  
##  <a name="savebarstate"></a>CMFCToolBarButton::SaveBarState  
 儲存的工具列按鈕的狀態。  
  
```  
virtual void SaveBarState();
```  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法會在建立時`CMFCToolBarButton`物件做為拖放作業的結果。  
  
 這個方法的預設實作沒有任何作用。 覆寫這個方法，以將工具列按鈕的狀態儲存至外部資料來源。  
  
##  <a name="serialize"></a>CMFCToolBarButton::Serialize  
 從封存讀取此物件，或將它寫入至封存。  
  
```  
virtual void Serialize(CArchive& ar);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `ar`  
 `CArchive`從中或要序列化的物件。  
  
### <a name="remarks"></a>備註  
 這個方法支援資料傳輸程序，例如剪貼簿或拖放作業。 在讀取或寫入如識別碼、 文字標籤和映像識別碼 按鈕的屬性，或以提供`CArchive`物件。  
  
 如需序列化的範例，請參閱[序列化： 序列化物件](../../mfc/serialization-serializing-an-object.md)。  
  
##  <a name="setaccdata"></a>CMFCToolBarButton::SetACCData  
 填入提供`CAccessibilityData`物件從工具列按鈕的協助工具資料。  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,  
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `pParent`  
 父視窗的工具列按鈕。  
  
 [輸入] `data`  
 A`CAccessibilityData`工具列按鈕的協助工具資料填入的物件。  
  
### <a name="return-value"></a>傳回值  
 此方法會傳回 `TRUE`。  
  
### <a name="remarks"></a>備註  
 覆寫此方法以傳回`FALSE`如果工具列按鈕不會提供協助工具資料。  
  
##  <a name="setclipboardformatname"></a>CMFCToolBarButton::SetClipboardFormatName  
 重新命名通用的剪貼簿格式。  
  
```  
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `lpszName`  
 通用的剪貼簿格式的新名稱。 不能`NULL`。  
  
### <a name="remarks"></a>備註  
 此方法讓可能發生在多個應用程式之間的拖放作業。 每個應用程式必須提供相同的剪貼簿格式名稱。  
  
 您必須呼叫這個方法，這個架構會呼叫之前[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)。  
  
##  <a name="setimage"></a>CMFCToolBarButton::SetImage  
 設定按鈕的影像索引。  
  
```  
virtual void SetImage(int iImage);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `iImage`  
 集合中的工具列影像的影像索引。  
  
### <a name="remarks"></a>備註  
 工具列按鈕是否為分隔符號，`iImage`指的是新的分隔符號 按鈕的寬度。  
  
 如果`iImage`小於零，這個方法停用繪製影像，如此繪製按鈕的文字標籤。  
  
##  <a name="setprotectedcommands"></a>CMFCToolBarButton::SetProtectedCommands  
 設定使用者無法自訂的命令的清單。  
  
```  
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `lstCmds`  
 受保護的命令清單。  
  
### <a name="remarks"></a>備註  
 在自訂模式中，架構會停用保護 工具列按鈕命令。 使用者無法執行拖放，然後編輯在已停用的工具列按鈕上的作業。  
  
 使用[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)方法來擷取清單中的受保護的命令。  
  
##  <a name="setradio"></a>CMFCToolBarButton::SetRadio  
 按鈕變更目的選取的狀態時由架構呼叫。  
  
```  
virtual void SetRadio();
```  
  
### <a name="remarks"></a>備註  
 這個方法的預設實作沒有任何作用。 覆寫此方法時要執行自訂動作按鈕會變更其核取的狀態。  
  
##  <a name="setrect"></a>CMFCToolBarButton::SetRect  
 設定按鈕的週框矩形。  
  
```  
void SetRect(const CRect rect);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `rect`  
 新週框的按鈕。  
  
### <a name="remarks"></a>備註  
 這個方法會呼叫[CMFCToolBarButton::OnMove](#onmove)方法之後，它會設定新週框。  
  
##  <a name="setstyle"></a>CMFCToolBarButton::SetStyle  
 設定按鈕的樣式。  
  
```  
virtual void SetStyle(UINT nStyle);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nStyle`  
 新按鈕的樣式。  
  
### <a name="remarks"></a>備註  
 預設實作集[CMFCToolBarButton::m_nStyle](#m_nstyle)資料成員，才能`nStyle`。 如果您想要執行其他處理序來處理樣式中的變更，請覆寫這個方法。 請參閱[ToolBar 控制項樣式](toolbar-control-styles.md)如需有效的樣式旗標的清單。  
  
##  <a name="setvisible"></a>CMFCToolBarButton::SetVisible  
 指定按鈕是否可見。  
  
```  
void SetVisible(BOOL bShow=TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bShow`  
 布林值，指定是否要顯示或隱藏按鈕。 如果這個參數是`TRUE`，按鈕會顯示。 如果參數是`FALSE`，則會隱藏按鈕。  
  
### <a name="remarks"></a>備註  
 使用此函式，以隱藏或顯示特定工具列按鈕。 呼叫[CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate)方法之後呼叫這個方法。  
  
##  <a name="show"></a>CMFCToolBarButton::Show  
 顯示或隱藏按鈕。  
  
```  
void Show(BOOL bShow);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `bShow`  
 布林值，指定是否要顯示或隱藏按鈕。 如果這個參數是`TRUE`，按鈕會顯示。 如果參數是`FALSE`，則會隱藏按鈕。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個方法，以更新工具列按鈕的可見性，其為父工具列重新調整大小。 架構會呼叫這個方法與`bShow`設`FALSE`當按鈕不再符合工具列的範圍內。 架構會呼叫這個方法與`bShow`設`TRUE`時大小後按鈕再次符合工具列的範圍內。  
  
 使用[CMFCToolBarButton::SetVisible](#setvisible)方法來設定一般按鈕是否可見。  
  
 這個方法會呼叫[CMFCToolBarButton::OnShow](#onshow)之後便會更新按鈕的可見性狀態的方法。  
  
## <a name="see-also"></a>請參閱  
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [類別](../../mfc/reference/mfc-classes.md)   
 [CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)   
 [CMFCToolBarImages 類別](../../mfc/reference/cmfctoolbarimages-class.md)
