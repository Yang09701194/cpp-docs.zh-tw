---
title: CMFCToolBarMenuButton 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 418ef29657271010c3a12f0f15a12f45e5351aac
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81376162"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton 類別

包含快顯功能表的工具列按鈕。
有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenu按鈕:CMFCToolBarMenu按鈕](#cmfctoolbarmenubutton)|建構 `CMFCToolBarMenuButton` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenu按鈕::與比較](#comparewith)|將此實例與提供`CMFCToolBarButton`的對象進行比較。 (覆寫[CMFC 工具列按鈕::與比較](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)。|
|[CMFCToolBarMenu按鈕::抄襲](#copyfrom)|將另一個工具列按鈕的屬性複製到當前按鈕。 (覆寫[CMFCToolBar 按鈕::從](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)複製。)|
|[CMFCToolBarMenu按鈕::從Menu創建](#createfrommenu)|從 Windows 功能表句柄初始化工具列功能表。|
|[CMFCToolBarMenu按鈕::建立選單](#createmenu)|創建由工具列功能表中的命令組成的 Windows 功能表。 將句柄返回到 Windows 功能表。|
|[CMFCToolBarMenu按鈕::建立彈出選單](#createpopupmenu)|創建一個彈出式選單物件 ( [CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)) 以顯示工具列選單。|
|[CMFCToolBarMenu按鈕::啟用快速定制](#enablequickcustomize)||
|[CMFCToolBarMenu按鈕:取得命令](#getcommands)|提供對工具列功能表中命令清單的唯讀取許可權。|
|[CMFCToolBarMenu按鈕::取得圖像Rect](#getimagerect)|檢索按鈕圖像的邊界矩形。|
|[CMFCToolBarMenu按鈕::取得調色板](#getpaletterows)|當菜單處於調色板模式時,返回彈出式功能表中的行數。|
|[CMFCToolBarMenu按鈕::取得彈出選單](#getpopupmenu)|返回指向與按鈕關聯的彈出功能表物件的指標。|
|[CMFCToolBarMenu按鈕::有按鈕](#hasbutton)||
|[CMFCToolBarMenu按鈕::有熱邊框](#havehotborder)|確定當用戶選擇該按鈕時是否顯示按鈕的邊框。 (覆蓋[CMFCToolBar 按鈕::有 Hot 邊框](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|
|[CMFCToolBarMenu按鈕::是邊框](#isborder)||
|[CMFCToolBarMenu按鈕::被點擊的上選單](#isclickedonmenu)||
|[CMFCToolBarMenu按鈕::已丟棄](#isdroppeddown)|確定是否顯示彈出式功能表。|
|[CMFCToolBarMenu按鈕::空門允許](#isemptymenuallowed)|由框架調用以確定使用者是否可以從所選功能表項打開子功能表。|
|[CMFCToolBarMenu按鈕::是排他性的](#isexclusive)|確定按鈕是否處於獨佔模式,即即使使用者將指標移到其他工具列或按鈕上,彈出式功能表是否仍然保持打開狀態。|
|[CMFCToolBarMenu按鈕::isMenuPalette模式](#ismenupalettemode)|確定彈出式功能表是否處於調色板模式。|
|[CMFCToolBarMenu按鈕::是快速模式](#isquickmode)||
|[CMFCToolBarMenu按鈕::IstearoffMenu](#istearoffmenu)|確定彈出式功能表是否具有撕下欄。|
|[CMFCToolBarMenu按鈕::在之後創建彈出選單](#onaftercreatepopupmenu)||
|[CMFCToolBarMenu按鈕::在拖動前打開](#onbeforedrag)|指定是否可以拖動按鈕。 (覆寫[CMFCToolBar 按鈕::在拖動之前](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)。)|
|[CMFCToolBarMenu按鈕::在計算大小上](#oncalculatesize)|由框架呼叫,以計算指定設備上下文和停靠狀態的按鈕大小。 (覆寫[CMFC 工具列按鈕:「正在計算大小](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)」)|
|[CMFCToolBarMenu按鈕::打開取消模式](#oncancelmode)|由框架調用以處理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)消息。 (覆寫[CMFC 工具列按鈕:開啟取消模式](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).)|
|[CMFCToolBarMenu按鈕::打開更改家長](#onchangeparentwnd)|將按鈕插入到新工具列時由框架調用。 (覆寫[CMFC 工具列按鈕:開啟變更父項目](cmfctoolbarbutton-class.md#onchangeparentwnd).)|
|[CMFCToolBarMenu按鈕::點擊](#onclick)|當用戶按下滑鼠按鈕時由框架調用。 (覆寫[CMFC 工具列按鈕::按下](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|
|[CMFCToolBarMenu按鈕::點擊選單項](#onclickmenuitem)|當使用者在彈出式功能表中選擇專案時,由框架調用。|
|[CMFCToolBarMenu按鈕::在上下文説明](#oncontexthelp)|當父工具列處理WM_HELPHITTEST消息時,由框架調用。 (覆寫[CMFC 工具列按鈕:開啟上下文説明](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).)|
|[CMFCToolBarMenu按鈕::開拉](#ondraw)|框架呼叫使用指定的樣式和選項繪製按鈕。 (覆寫[CMFC 工具列按鈕::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|
|[CMFCToolBarmenu按鈕::在畫上定製清單](#ondrawoncustomizelist)|由框架呼叫以在 **「自訂」** 對話框的 **「命令」** 窗格中繪製按鈕。 (覆寫[CMFC 工具列按鈕:在「繪製」自訂清單](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).)|
|[CMFCToolBarMenu按鈕::打開彈出選單](#openpopupmenu)|當用戶打開彈出式功能表時由框架調用。|
|[CMFCToolBarMenu按鈕::重置影像到預設](#resetimagetodefault)|將與按鈕關聯的圖像設置到預設值。 (覆寫[CMFC 工具列按鈕:重置影像預設值](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).)|
|[CMFCToolBarMenu按鈕::儲存欄](#savebarstate)|保存工具列按鈕的狀態。 (覆蓋[CMFCToolBarButton::儲存欄](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|
|[CMFCToolBarMenu按鈕:序列化](#serialize)|從存檔中讀取此物件或將其寫入存檔。 (覆寫[CMFCToolBarButton:序列化](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|
|[CMFCToolBarMenu按鈕::設定ACC數據](#setaccdata)|使用工具列按鈕中的`CAccessibilityData`輔助功能數據填充提供的物件。 (覆寫[CMFC 工具列按鈕:設定ACC資料](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|
|[CMFCToolBarMenu按鈕:僅設定選單](#setmenuonly)|指定按鈕是否可以添加到工具列。|
|[CMFCToolBarMenu按鈕::設定選單調色板模式](#setmenupalettemode)|指定彈出式功能表是否處於調色板模式。|
|[CMFCToolBarMenu按鈕::設定消息](#setmessagewnd)||
|[CMFCToolBarMenu按鈕::SetRadio](#setradio)|強制工具列功能表按鈕顯示指示其已選中的圖示。|
|[CMFCToolBarMenu按鈕::設定關閉](#settearoff)|為彈出式功能表指定撕下條形標識。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenu按鈕::D原始文檔圖示](#drawdocumenticon)|在功能表按鈕上繪製一個圖示。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenu按鈕::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|如果為 TRUE,則在繪製按鈕時,框架始終調用[CFrameWndEx:onDrawMenuImage。](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)|

## <a name="remarks"></a>備註

可以`CMFCToolBarMenuButton`顯示為菜單、具有子菜單的功能表項、執行命令或顯示功能表的按鈕或僅顯示菜單的按鈕。 通過指定與建構函數`CMFCToolbarMenuButton::CMFCToolbarMenuButton`中的按鈕關聯的參數(如圖像、文本、功能表句柄和命令 ID)來確定選單按鈕的行為和外觀。

從類派生的`CMFCToolbarMenuButton`自定義類必須使用[DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)宏。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)宏在應用程式關閉時生成錯誤。

## <a name="example"></a>範例

下面的範例示範如何配置`CMFCToolBarMenuButton`物件。 該程式碼展示如何指定下拉選單處於調色板模式,並指定使用者將功能表按鈕從選單欄中拖出時創建的撕下欄的 ID。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxtoolbarmenubutton.h

## <a name="cmfctoolbarmenubuttoncmfctoolbarmenubutton"></a><a name="cmfctoolbarmenubutton"></a>CMFCToolBarMenu按鈕:CMFCToolBarMenu按鈕

建構 `CMFCToolBarMenuButton` 物件。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>參數

*src*<br/>
[在]要複製到`CMFCToolBarMenuButton``CMFCToolBarMenuButton`此物件的現有物件。

*uiID*<br/>
[在]用戶按下按鈕時要執行的命令的 ID;或 (UINT)-1 表示不直接執行命令的功能表按鈕。

*hMenu*<br/>
[在]功能表的句柄;如果按鈕沒有功能表,則為 NULL。

*i 影像*<br/>
[在]按鈕的圖像索引;或 -1 如果此按鈕沒有圖示或使用*uiID*指定的命令的圖示。 對於應用程式中的每個`CMFCToolBarImages`物件,索引都相同。

*lpszText*<br/>
[在]工具列選單按鈕的文字。

*使用者按鈕*<br/>
[在]如果按鈕顯示使用者定義的圖像,則為 TRUE;如果按鈕顯示使用者定義的圖像,則為 TRUE。如果按鈕顯示與*uiID*指定的命令關聯的預定義圖像,則 FALSE。

### <a name="remarks"></a>備註

如果*uiID*是有效的命令 ID,則當使用者單擊該命令時,該按鈕將執行該命令。 如果*hMenu*是有效的功能表句柄,則當按鈕出現在工具列或子選單中時,該按鈕會提供下拉菜單。 如果*uiID*和*hMenu*都有效,則該按鈕是一個拆分按鈕,該按鈕的一部分將在使用者按一下該命令時執行該命令,而該按鈕的一部分帶有向下箭頭,當使用者按一下功能表時,該按鈕將下拉菜單。 但是,如果*hMenu*有效,則當按鈕插入到菜單中時,使用者將無法按下該按鈕執行命令。

### <a name="example"></a>範例

下面的示例演示如何構造`CMFCToolBarMenuButton`類的物件。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

## <a name="cmfctoolbarmenubuttoncomparewith"></a><a name="comparewith"></a>CMFCToolBarMenu按鈕::與比較

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>參數

[在]*其他*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttoncopyfrom"></a><a name="copyfrom"></a>CMFCToolBarMenu按鈕::抄襲

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>參數

[在]*斯爾克*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttoncreatefrommenu"></a><a name="createfrommenu"></a>CMFCToolBarMenu按鈕::從Menu創建

從 Windows 功能表句柄初始化工具列功能表。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>參數

*hMenu*<br/>
[在]功能表的句柄。

### <a name="remarks"></a>備註

工具列選單按鈕可以顯示下拉子功能表。

框架調用此方法從功能表初始化子功能表中的命令。

## <a name="cmfctoolbarmenubuttoncreatemenu"></a><a name="createmenu"></a>CMFCToolBarMenu按鈕::建立選單

建立由工具列功能表中的命令組成的功能表。 向功能表返回句柄。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>傳回值

如果成功,則對功能表的句柄。 如果與工具列選單按鈕關聯的命令列表為空,則為 NULL。

### <a name="remarks"></a>備註

可以在派生類中重寫此方法,以自定義功能表的生成方式。

## <a name="cmfctoolbarmenubuttoncreatepopupmenu"></a><a name="createpopupmenu"></a>CMFCToolBarMenu按鈕::建立彈出選單

創建要`CMFCPopupMenu`顯示工具列功能表的物件。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>傳回值

指向顯示`CMFCPopupMenu`與工具列功能表按鈕關聯的下拉菜單的物件的指標。

### <a name="remarks"></a>備註

框架調用此方法以準備顯示與按鈕關聯的下拉菜單。

默認實現只是構造並返回一個新`CMFCPopupMenu`物件。 如果要使用派生類型的[CMFCPopupMenu 類](cmfcpopupmenu-class.md)或執行其他初始化,則重寫此方法。

## <a name="cmfctoolbarmenubuttondrawdocumenticon"></a><a name="drawdocumenticon"></a>CMFCToolBarMenu按鈕::D原始文檔圖示

在功能表按鈕上繪製文檔圖示。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*rectImage*<br/>
[在]圖像邊界矩形的座標。

*hIcon*<br/>
[在]圖示的句柄。

### <a name="remarks"></a>備註

此方法採用文檔圖示並將其繪製在功能表按鈕上,以*rectImage*指定的區域為中心。

## <a name="cmfctoolbarmenubuttonenablequickcustomize"></a><a name="enablequickcustomize"></a>CMFCToolBarMenu按鈕::啟用快速定制

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonhasbutton"></a><a name="hasbutton"></a>CMFCToolBarMenu按鈕::有按鈕

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonhavehotborder"></a><a name="havehotborder"></a>CMFCToolBarMenu按鈕::有熱邊框

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonisborder"></a><a name="isborder"></a>CMFCToolBarMenu按鈕::是邊框

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonisclickedonmenu"></a><a name="isclickedonmenu"></a>CMFCToolBarMenu按鈕::被點擊的上選單

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonisquickmode"></a><a name="isquickmode"></a>CMFCToolBarMenu按鈕::是快速模式

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttongetcommands"></a><a name="getcommands"></a>CMFCToolBarMenu按鈕:取得命令

提供對工具列功能表中命令清單的唯讀取許可權。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>傳回值

對[COblist 類別](../../mfc/reference/coblist-class.md)的引用,該物件包含[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)物件的集合。

### <a name="remarks"></a>備註

工具列選單按鈕可以顯示子選單。 您可以在建構函數中的子選單或[CMFCToolBarMenuButton 中提供命令列表:創建 FromMenu](#createfrommenu)作為功能表 (HMENU) 的句柄。 功能表將轉換為從[CMFCToolBarButton 類](../../mfc/reference/cmfctoolbarbutton-class.md)派生並`CObList`存儲在內部 物件中的物件清單。 您可以通過呼叫此方法存取此清單。

## <a name="cmfctoolbarmenubuttongetimagerect"></a><a name="getimagerect"></a>CMFCToolBarMenu按鈕::取得圖像Rect

檢索按鈕圖像的邊界矩形。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>參數

*rectImage*<br/>
[出]對接收影像邊界`CRect`矩形座標的物件的引用。

## <a name="cmfctoolbarmenubuttongetpaletterows"></a><a name="getpaletterows"></a>CMFCToolBarMenu按鈕::取得調色板

當菜單處於調色板模式時,返回下拉菜單中的行數。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>傳回值

調色板中的行數。

### <a name="remarks"></a>備註

當功能表按鈕設置為調色板模式時,功能表項將顯示在多個列中,只有有限的行數。 調用此方法以獲取行數。 您可以使用[CMFCToolBarMenuButton::setMenuPaletteMode](#setmenupalettemode)啟用或禁用調色板模式並指定行數。

## <a name="cmfctoolbarmenubuttongetpopupmenu"></a><a name="getpopupmenu"></a>CMFCToolBarMenu按鈕::取得彈出選單

返回指向表示按鈕下拉菜單的[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>傳回值

指向[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標,該物件是在框架繪製工具列選單按鈕的子功能表時創建的;如果未顯示子選單,則為 NULL。

### <a name="remarks"></a>備註

當工具列選單按鈕顯示下拉選單時,該按鈕將創建一個[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件來表示功能表。 調用此方法以獲取指向對象`CMFCPopupMenu`的指標。 不應存儲返回的指標,因為它是暫時的,並且在使用者關閉下拉菜單時無效。

## <a name="cmfctoolbarmenubuttonisdroppeddown"></a><a name="isdroppeddown"></a>CMFCToolBarMenu按鈕::已丟棄

指示當前是否顯示彈出式功能表。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>傳回值

如果工具列選單按鈕顯示其子菜單,則為 TRUE;否則 FALSE。

## <a name="cmfctoolbarmenubuttonisemptymenuallowed"></a><a name="isemptymenuallowed"></a>CMFCToolBarMenu按鈕::空門允許

指定選單項目是否顯示空子選單。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>傳回值

如果框架從當前選定的功能表項打開子功能表,即使子菜單為空,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當用戶嘗試從當前選定的功能表項打開子功能表時,框架將調用此方法。 如果子功能表為空並`IsEmptyMenuAllowed`返回 FALSE,則子選單將不會打開。

預設實現返回 FALSE。 重寫此方法以自定義此行為。

## <a name="cmfctoolbarmenubuttonisexclusive"></a><a name="isexclusive"></a>CMFCToolBarMenu按鈕::是排他性的

指示按鈕是否處於獨佔模式。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>傳回值

如果按鈕在獨佔模式下工作,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當使用者打開按鈕的彈出功能表,然後將滑鼠指標移到另一個工具列或功能表按鈕上時,彈出功能表將關閉,除非該按鈕處於獨占模式。

默認實現始終返回 FALSE。 如果要打開獨佔模式,請覆蓋派生類中的此方法。

## <a name="cmfctoolbarmenubuttonismenupalettemode"></a><a name="ismenupalettemode"></a>CMFCToolBarMenu按鈕::isMenuPalette模式

確定下拉菜單是否處於調色板模式。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>傳回值

如果啟用了調色板模式,則為 TRUE,否則為 FALSE。

### <a name="remarks"></a>備註

當功能表按鈕設置為調色板模式時,功能表項將顯示在多個列中,只有有限的行數。 調用此方法以獲取行數。 您可以通過調用[CMFCToolBarMenuButton::SetMenuPalette模式](#setmenupalettemode)來啟用或禁用調色板模式。

## <a name="cmfctoolbarmenubuttonistearoffmenu"></a><a name="istearoffmenu"></a>CMFCToolBarMenu按鈕::IstearoffMenu

指示下拉菜單是否具有撕下欄。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>傳回值

如果工具列功能表按鈕具有撕開欄,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

要啟用分接功能並設置撕下欄 ID,請致電[CMFCToolBarMenuButton::SetTearoff。](#settearoff)

## <a name="cmfctoolbarmenubuttonm_balwayscallownerdraw"></a><a name="m_balwayscallownerdraw"></a>CMFCToolBarMenu按鈕::m_bAlwaysCallOwnerDraw

指定框架是否始終在繪製按鈕時調用[CFrameWndEx:onDrawMenuImage。](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>備註

當此成員變數設置為 TRUE 時,該按鈕始終調用[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)方法以在按鈕上顯示圖像。 當`m_bAlwaysCallOwnerDraw`為 FALSE 時,如果圖像已預定義,按鈕本身將繪製圖像。 否則,它將呼叫`OnDrawMenuImage`。

## <a name="cmfctoolbarmenubuttononaftercreatepopupmenu"></a><a name="onaftercreatepopupmenu"></a>CMFCToolBarMenu按鈕::在之後創建彈出選單

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononbeforedrag"></a><a name="onbeforedrag"></a>CMFCToolBarMenu按鈕::在拖動前打開

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononcalculatesize"></a><a name="oncalculatesize"></a>CMFCToolBarMenu按鈕::在計算大小上

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*預設*<br/>
[在]*布霍茲*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononcancelmode"></a><a name="oncancelmode"></a>CMFCToolBarMenu按鈕::打開取消模式

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a>CMFCToolBarMenu按鈕::打開更改家長

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>參數

[在]*pwnd 父級*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononclick"></a><a name="onclick"></a>CMFCToolBarMenu按鈕::點擊

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>參數

[在]*pwnd*<br/>
[在]*bDelay*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttononclickmenuitem"></a><a name="onclickmenuitem"></a>CMFCToolBarMenu按鈕::點擊選單項

當使用者在下拉菜單中選擇專案時,由框架調用。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>傳回值

如果框架應繼續預設功能表項處理,則 FALSE;否則為 TRUE。 默認實現始終返回 FALSE。

### <a name="remarks"></a>備註

當用戶單擊功能表項時,框架將執行與該項關聯的命令。

要自定義功能表項處理,請覆蓋`OnClickMenuItem`從`CMFCToolBarMenuButton`類派生的類中。 您還必須覆蓋[CFrameWndEx::OnShowPopupMenu,](../../mfc/reference/cframewndex-class.md#onshowpopupmenu)並將需要特殊處理的菜單按鈕替換為派生類的實例。

## <a name="cmfctoolbarmenubuttononcontexthelp"></a><a name="oncontexthelp"></a>CMFCToolBarMenu按鈕::在上下文説明

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>參數

[在]*pwnd*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonondraw"></a><a name="ondraw"></a>CMFCToolBarMenu按鈕::開拉

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*rect*<br/>
[在]*pImage*<br/>
[在]*布霍茲*<br/>
[在]*b 客製模式*<br/>
[在]*b 高光*<br/>
[在]*bDraw邊框*<br/>
[在]*b 格雷關閉按鈕*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a>CMFCToolBarmenu按鈕::在畫上定製清單

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>參數

[在]*pDC*<br/>
[在]*rect*<br/>
[在]*b選定*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonopenpopupmenu"></a><a name="openpopupmenu"></a>CMFCToolBarMenu按鈕::打開彈出選單

當使用者打開工具列功能表按鈕的下拉菜單時,由框架調用。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指定接收下拉選單命令的視窗。 僅當工具列選單按鈕具有父視窗時,它才能為 NULL。

### <a name="return-value"></a>傳回值

成功創建並打開[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件時為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

當使用者從工具列功能表按鈕打開下拉菜單時,框架將調用此功能。

## <a name="cmfctoolbarmenubuttonresetimagetodefault"></a><a name="resetimagetodefault"></a>CMFCToolBarMenu按鈕::重置影像到預設

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonsavebarstate"></a><a name="savebarstate"></a>CMFCToolBarMenu按鈕::儲存欄

```
virtual void SaveBarState();
```

### <a name="remarks"></a>備註

當框架創建工具列按鈕作為拖放操作的結果時,它將調用此方法。 此方法調用頂級彈出式功能表的[CMFCPopupMenu::保存狀態](../../mfc/reference/cmfcpopupmenu-class.md#savestate)方法,這將導致彈出式功能表的父按鈕重新創建其功能表。

## <a name="cmfctoolbarmenubuttonserialize"></a><a name="serialize"></a>CMFCToolBarMenu按鈕:序列化

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

[在]*阿爾*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonsetaccdata"></a><a name="setaccdata"></a>CMFCToolBarMenu按鈕::設定ACC數據

設定功能區項目的協助工具資料。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
功能區項目的父視窗。

*資料*<br/>
功能區項目的協助工具資料。

### <a name="return-value"></a>傳回值

始終返回 TRUE。

### <a name="remarks"></a>備註

默認情況下,此方法設置功能區元素的輔助功能數據,並始終返回 TRUE。 覆寫此方法以設定協助工具資料並傳回值，以指出成功或失敗。

## <a name="cmfctoolbarmenubuttonsetmenuonly"></a><a name="setmenuonly"></a>CMFCToolBarMenu按鈕:僅設定選單

指定當按鈕同時具有有效的命令 ID 和子功能表時,該按鈕是作為菜單按鈕還是拆分按鈕繪製。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>參數

*僅*<br/>
[在]TRUE 顯示此按鈕為功能表按鈕時,它既具有有效的命令 ID 和子選單,則 FALSE 將此按鈕作為拆分按鈕顯示,當它同時具有有效的命令 ID 和子選單時。

### <a name="remarks"></a>備註

通常,當工具列功能表按鈕同時具有子功能表和命令 ID 時,功能表似乎是一個拆分按鈕,該按鈕具有主按鈕和附加的向下箭頭按鈕。 如果調用此方法,並且*bMenuOnly*為 TRUE,則該按鈕將顯示為單個功能表按鈕,按鈕中帶有向下箭頭。 當使用者在任一模式下按下箭頭時,子選單將打開,當使用者按下任一模式下按鈕的非箭頭部分時,框架將執行命令 。

## <a name="cmfctoolbarmenubuttonsetmenupalettemode"></a><a name="setmenupalettemode"></a>CMFCToolBarMenu按鈕::設定選單調色板模式

指定下拉菜單是否處於調色板模式。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>參數

*bMenuPalette 模式*<br/>
[在]指定下拉菜單是否處於調色板模式。

*nPaletteRows*<br/>
[在]調色板中的行數。

### <a name="remarks"></a>備註

在調色板模式下,所有功能表項都顯示為多列調色板。 使用*nPaletteRows*指定行數。

## <a name="cmfctoolbarmenubuttonsetmessagewnd"></a><a name="setmessagewnd"></a>CMFCToolBarMenu按鈕::設定消息

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>參數

[在]*pWnd 訊息*<br/>

### <a name="remarks"></a>備註

## <a name="cmfctoolbarmenubuttonsetradio"></a><a name="setradio"></a>CMFCToolBarMenu按鈕::SetRadio

設置工具列選單按鈕,在選中時顯示單選按鈕樣式圖示。

```
virtual void SetRadio();
```

### <a name="remarks"></a>備註

選中功能表按鈕時繪製時,它將調用[CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)以繪製複選標記圖示。 預設情況下,`OnDrawMenuCheck`請求目前可視管理器在選單按鈕上繪製複選框樣式複選框。 調用此方法後,當前可視管理器將改為在菜單按鈕上繪製單選按鈕樣式複選標記。 無法復原此更改。

當您調用此方法且功能表按鈕當前正在顯示時,它將刷新。

## <a name="cmfctoolbarmenubuttonsettearoff"></a><a name="settearoff"></a>CMFCToolBarMenu按鈕::設定關閉

指定下拉選單的拆解欄的 ID。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>參數

*uiBarID*<br/>
[在]指定新的拆解條 ID。

### <a name="remarks"></a>備註

呼叫此方法以指定使用者從選單欄中拖動選單按鈕時創建的撕掉欄的 ID。 如果*uiBarID*參數為 0,則使用者無法撕下功能表按鈕。

致電[CWinAppEx:啟用TearOffMenus,](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)以便在應用程式中啟用分接選單功能。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)
