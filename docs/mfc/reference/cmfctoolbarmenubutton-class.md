---
title: CMFCToolBarMenuButton 類別
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
ms.openlocfilehash: 883d6a9242066289f15e58179a03c4f609699141
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/15/2019
ms.locfileid: "69504720"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton 類別

包含快顯功能表的工具列按鈕。
如需詳細資訊, 請參閱位於 Visual Studio 安裝**的\\VC\\atlmfc\\src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|建構 `CMFCToolBarMenuButton` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|說明|
|----------|-----------------|
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|比較這個實例與提供`CMFCToolBarButton`的物件。 (覆寫[CMFCToolBarButton:: seq.comparewith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)。)|
|[CMFCToolBarMenuButton::CopyFrom](#copyfrom)|將另一個工具列按鈕的屬性複製到目前的按鈕。 (覆寫[CMFCToolBarButton:: CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)。)|
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|從 Windows 功能表控制碼初始化工具列功能表。|
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|建立 Windows 功能表, 其中包含 [工具列] 功能表中的命令。 傳回 Windows 功能表的控制碼。|
|[CMFCToolBarMenuButton::CreatePopupMenu](#createpopupmenu)|建立快顯功能表物件 ( [CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)) 以顯示 [工具列] 功能表。|
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton::GetCommands](#getcommands)|提供 [工具列] 功能表中命令清單的唯讀存取權。|
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|抓取按鈕影像的周框。|
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|當功能表處於 [調色板] 模式時, 傳回快顯功能表中的資料列數目。|
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|傳回與按鈕相關聯的快顯功能表物件指標。|
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|決定當使用者選取按鈕時, 是否要顯示按鈕的框線。 (覆寫[CMFCToolBarButton:: HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder)。)|
|[CMFCToolBarMenuButton::IsBorder](#isborder)||
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|決定是否顯示快顯功能表。|
|[CMFCToolBarMenuButton::IsEmptyMenuAllowed](#isemptymenuallowed)|由架構呼叫以判斷使用者是否可以從選取的功能表項目開啟子功能表。|
|[CMFCToolBarMenuButton::IsExclusive](#isexclusive)|決定按鈕是否處於獨佔模式, 也就是即使使用者將指標移到另一個工具列或按鈕上, 是否仍會開啟快顯功能表。|
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|決定快顯功能表是否處於 [調色板] 模式。|
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|決定快顯功能表是否有卸載的橫條。|
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|指定是否可以拖曳按鈕。 (覆寫[CMFCToolBarButton:: OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)。)|
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|由架構呼叫, 以計算指定裝置內容和停駐狀態的按鈕大小。 (覆寫[CMFCToolBarButton:: OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)。)|
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|由架構呼叫以處理[WM_CANCELMODE](/windows/win32/winmsg/wm-cancelmode)訊息。 (覆寫[CMFCToolBarButton:: OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)。)|
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|當按鈕插入新工具列時由架構呼叫。 (覆寫[CMFCToolBarButton:: OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd)。)|
|[CMFCToolBarMenuButton::OnClick](#onclick)|當使用者按一下滑鼠按鍵時由架構呼叫。 (覆寫[CMFCToolBarButton:: OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick))。|
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|當使用者在快顯功能表中選取專案時, 由架構呼叫。|
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|當父工具列處理 WM_HELPHITTEST 訊息時, 由架構呼叫。 (覆寫[CMFCToolBarButton:: OnCoNtextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp)。)|
|[CMFCToolBarMenuButton::OnDraw](#ondraw)|由架構呼叫, 使用指定的樣式和選項繪製按鈕。 (覆寫[CMFCToolBarButton:: OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw)。)|
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|由架構呼叫, 以在 [**自訂**] 對話方塊的 [**命令**] 窗格中繪製按鈕。 (覆寫[CMFCToolBarButton:: OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist)。)|
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|當使用者開啟快顯功能表時由架構呼叫。|
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|將與按鈕相關聯的影像設定為預設值。 (覆寫[CMFCToolBarButton:: ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault)。)|
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|儲存工具列按鈕的狀態。 (覆寫[CMFCToolBarButton:: SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate)。)|
|[CMFCToolBarMenuButton::Serialize](#serialize)|從封存讀取此物件, 或將它寫入封存。 (覆寫[CMFCToolBarButton:: 序列化](../../mfc/reference/cmfctoolbarbutton-class.md#serialize)。)|
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|使用工具列按鈕`CAccessibilityData`的協助工具資料填入提供的物件。 (覆寫[CMFCToolBarButton:: SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata)。)|
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|指定是否可以將按鈕加入至工具列。|
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|指定快顯功能表是否為 [調色板] 模式。|
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton::SetRadio](#setradio)|強制工具列功能表按鈕顯示圖示, 表示已選取它。|
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|指定快顯功能表的關閉列識別碼。|

### <a name="protected-methods"></a>保護方法

|名稱|說明|
|----------|-----------------|
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|在功能表按鈕上繪製圖示。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|若為 TRUE, 則當繪製按鈕時, 架構一律會呼叫[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) 。|

## <a name="remarks"></a>備註

`CMFCToolBarMenuButton`可以顯示為功能表、具有子功能表的功能表項目、執行命令或顯示功能表的按鈕, 或是只顯示功能表的按鈕。 您可以藉由指定參數 (例如影像、文字、功能表控制碼, 以及與此`CMFCToolbarMenuButton::CMFCToolbarMenuButton`函式中的按鈕相關聯的命令 ID), 來判斷功能表按鈕的行為和外觀。

從`CMFCToolbarMenuButton`類別衍生的自訂類別必須使用[DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)宏。 當應用程式關閉時, [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)宏會產生錯誤。

## <a name="example"></a>範例

下列範例示範如何設定`CMFCToolBarMenuButton`物件。 此程式碼說明如何指定下拉式功能表為 [調色板模式], 並指定當使用者將功能表按鈕拖曳至功能表列時所建立之卸載列的識別碼。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxtoolbarmenubutton.h

##  <a name="cmfctoolbarmenubutton"></a>CMFCToolBarMenuButton:: CMFCToolBarMenuButton

建構 `CMFCToolBarMenuButton` 物件。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>參數

*src*<br/>
在要複製`CMFCToolBarMenuButton`到這個`CMFCToolBarMenuButton`物件中的現有物件。

*uiID*<br/>
在使用者按一下按鈕時要執行的命令識別碼;或 (UINT)-1 代表不會直接執行命令的功能表按鈕。

*hMenu*<br/>
在功能表的控制碼;如果按鈕沒有功能表, 則為 Null。

*iImage*<br/>
在按鈕影像的索引;如果此按鈕沒有圖示或使用*uiID*所指定之命令的圖示, 則為-1。 應用程式中每個`CMFCToolBarImages`物件的索引都相同。

*lpszText*<br/>
在工具列功能表按鈕的文字。

*bUserButton*<br/>
在如果按鈕顯示使用者定義的影像, 則為 TRUE;如果按鈕顯示預先定義的影像與*uiID*所指定的命令相關聯, 則為 FALSE。

### <a name="remarks"></a>備註

如果*uiID*是有效的命令識別碼, 當使用者按一下該命令時, 按鈕就會執行該命令。 如果*hMenu*是有效的功能表控制碼, 則按鈕會在功能表中出現時, 提供下拉式功能表或子功能表中出現的下拉式選單。 如果*uiID*和*hMenu*都是有效的, 則按鈕會是一個分割按鈕, 其中的部分將會在使用者按一下時執行命令, 並在使用者按一下時, 使用向下箭號的部分, 將下拉式功能表放在功能表上。 不過, 如果*hMenu*有效, 當按鈕插入功能表時, 使用者將無法按一下按鈕來執行命令。

### <a name="example"></a>範例

下列範例示範如何建立`CMFCToolBarMenuButton`類別的物件。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

##  <a name="comparewith"></a>CMFCToolBarMenuButton:: Seq.comparewith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>參數

[in] *other*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="copyfrom"></a>CMFCToolBarMenuButton:: CopyFrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>參數

[in] *src*<br/>

### <a name="remarks"></a>備註

##  <a name="createfrommenu"></a>CMFCToolBarMenuButton:: CreateFromMenu

從 Windows 功能表控制碼初始化工具列功能表。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>參數

*hMenu*<br/>
在功能表的控制碼。

### <a name="remarks"></a>備註

工具列功能表按鈕可以顯示下拉式子功能表。

架構會呼叫這個方法, 從功能表初始化子功能表中的命令。

##  <a name="createmenu"></a>CMFCToolBarMenuButton:: CreateMenu

建立由 [工具列] 功能表中的命令所組成的功能表。 傳回功能表的控制碼。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>傳回值

如果成功, 則為功能表的控制碼。 如果與工具列功能表按鈕關聯的命令清單是空的, 則為 Null。

### <a name="remarks"></a>備註

您可以在衍生類別中覆寫這個方法, 以自訂功能表的產生方式。

##  <a name="createpopupmenu"></a>CMFCToolBarMenuButton:: CreatePopupMenu

`CMFCPopupMenu`建立物件以顯示 [工具列] 功能表。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>傳回值

`CMFCPopupMenu`物件的指標, 顯示與工具列功能表按鈕相關聯的下拉式功能表。

### <a name="remarks"></a>備註

這個方法是由架構所呼叫, 以準備顯示與按鈕相關聯的下拉式功能表。

預設的執行只會建立並傳回新`CMFCPopupMenu`的物件。 如果您想要使用[CMFCPopupMenu 類別](cmfcpopupmenu-class.md)的衍生型別, 或要執行其他初始化, 請覆寫這個方法。

##  <a name="drawdocumenticon"></a>CMFCToolBarMenuButton::D rawDocumentIcon

在功能表按鈕上繪製檔圖示。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>參數

*pDC*<br/>
在裝置內容的指標。

*rectImage*<br/>
在影像周框矩形的座標。

*hIcon*<br/>
在圖示的控制碼。

### <a name="remarks"></a>備註

這個方法會採用檔圖示, 並在功能表按鈕上繪製, 並以*rectImage*所指定的區域為中心。

##  <a name="enablequickcustomize"></a>CMFCToolBarMenuButton:: EnableQuickCustomize

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>備註

##  <a name="hasbutton"></a>CMFCToolBarMenuButton:: HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="havehotborder"></a>CMFCToolBarMenuButton:: HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isborder"></a>CMFCToolBarMenuButton:: IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isclickedonmenu"></a>CMFCToolBarMenuButton:: IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isquickmode"></a>CMFCToolBarMenuButton:: IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getcommands"></a>CMFCToolBarMenuButton:: GetCommands

提供 [工具列] 功能表中命令清單的唯讀存取權。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>傳回值

[CObList 類別](../../mfc/reference/coblist-class.md)物件的 const 參考, 其中包含[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件的集合。

### <a name="remarks"></a>備註

工具列功能表按鈕可以顯示子功能表。 您可以在[CMFCToolBarMenuButton:: CreateFromMenu](#createfrommenu)中的子功能表中提供命令清單, 做為功能表的控制碼 (HMENU)。 功能表會轉換成衍生自[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)的物件清單, 並儲存在內部`CObList`物件中。 您可以藉由呼叫這個方法來存取此清單。

##  <a name="getimagerect"></a>CMFCToolBarMenuButton:: GetImageRect

抓取按鈕影像的周框。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>參數

*rectImage*<br/>
脫銷`CRect`物件的參考, 接收影像周框矩形的座標。

##  <a name="getpaletterows"></a>CMFCToolBarMenuButton:: GetPaletteRows

當功能表處於 [調色板] 模式時, 傳回下拉式功能表中的資料列數目。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>傳回值

色板中的資料列數目。

### <a name="remarks"></a>備註

當功能表按鈕設定為 [調色板] 模式時, 功能表項目會出現在多個資料行中, 但資料列數目有限。 呼叫這個方法以取得資料列的數目。 您可以啟用或停用 [調色板] 模式, 並使用[CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode)指定資料列數目。

##  <a name="getpopupmenu"></a>CMFCToolBarMenuButton:: GetPopupMenu

傳回[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標, 表示按鈕的下拉式功能表。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>傳回值

[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標, 當架構繪製了 [工具列] 功能表按鈕的子功能表時, 就會建立這個物件;如果沒有顯示子功能表, 則為 Null。

### <a name="remarks"></a>備註

當工具列功能表按鈕顯示下拉式功能表時, 按鈕會建立[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件來表示功能表。 呼叫這個方法, 以取得`CMFCPopupMenu`物件的指標。 您不應該儲存傳回的指標, 因為它是暫時性的, 而且當使用者關閉下拉式功能表時, 就會變成無效。

##  <a name="isdroppeddown"></a>CMFCToolBarMenuButton:: IsDroppedDown

指出目前是否顯示快顯功能表。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>傳回值

如果工具列功能表按鈕顯示其子功能表, 則為 TRUE;否則為 FALSE。

##  <a name="isemptymenuallowed"></a>CMFCToolBarMenuButton:: IsEmptyMenuAllowed

指定功能表項目是否顯示空的子功能表。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>傳回值

如果架構從目前選取的功能表項目開啟子功能表, 即使子功能表是空的, 也是 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當使用者嘗試從目前選取的功能表項目開啟子功能表時, 架構會呼叫這個方法。 如果子功能表是空的`IsEmptyMenuAllowed` , 而且會傳回 FALSE, 子功能表就不會開啟。

預設的實值會傳回 FALSE。 覆寫此方法以自訂此行為。

##  <a name="isexclusive"></a>CMFCToolBarMenuButton:: IsExclusive

指出按鈕是否為獨佔模式。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是以獨佔模式運作, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當使用者開啟按鈕的快顯功能表, 然後將滑鼠指標移到另一個工具列或功能表按鈕上方時, 就會關閉快顯功能表, 除非該按鈕處於獨佔模式。

預設的執行一律會傳回 FALSE。 如果您想要開啟獨佔模式, 請在衍生類別中覆寫這個方法。

##  <a name="ismenupalettemode"></a>CMFCToolBarMenuButton:: IsMenuPaletteMode

決定下拉式功能表是否處於 [調色板] 模式。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>傳回值

如果已啟用 [調色板] 模式, 則為 TRUE, 否則為 FALSE。

### <a name="remarks"></a>備註

當功能表按鈕設定為 [調色板] 模式時, 功能表項目會出現在多個資料行中, 但資料列數目有限。 呼叫這個方法以取得資料列的數目。 您可以藉由呼叫[CMFCToolBarMenuButton:: SetMenuPaletteMode](#setmenupalettemode)來啟用或停用 [調色板] 模式。

##  <a name="istearoffmenu"></a>CMFCToolBarMenuButton:: IsTearOffMenu

指出下拉式功能表是否有細分的橫條。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>傳回值

如果工具列功能表按鈕有卸載列, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

若要啟用卸載功能並設定中斷的列識別碼, 請呼叫[CMFCToolBarMenuButton:: SetTearOff](#settearoff)。

##  <a name="m_balwayscallownerdraw"></a>CMFCToolBarMenuButton:: m_bAlwaysCallOwnerDraw

指定當繪製按鈕時, 架構是否一律會呼叫[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) 。

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>備註

當此成員變數設定為 TRUE 時, 按鈕一律會呼叫[CFrameWndEx:: OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)方法, 以在按鈕上顯示影像。 當`m_bAlwaysCallOwnerDraw`為 FALSE 時, 如果影像已預先定義, 則按鈕本身會繪製影像。 否則, 它會`OnDrawMenuImage`呼叫。

##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>備註

##  <a name="onbeforedrag"></a>CMFCToolBarMenuButton:: OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="oncalculatesize"></a>CMFCToolBarMenuButton:: OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>
在*sizeDefault*<br/>
[in] *bHorz*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="oncancelmode"></a>CMFCToolBarMenuButton:: OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>備註

##  <a name="onchangeparentwnd"></a>CMFCToolBarMenuButton:: OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>參數

[in] *pWndParent*<br/>

### <a name="remarks"></a>備註

##  <a name="onclick"></a>CMFCToolBarMenuButton:: OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>參數

[in] *pWnd*<br/>
[in] *bDelay*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onclickmenuitem"></a>CMFCToolBarMenuButton:: OnClickMenuItem

當使用者在下拉式功能表中選取專案時, 由架構呼叫。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>傳回值

如果架構應該繼續執行預設的功能表項目處理, 則為 FALSE;否則為 TRUE。 預設的執行一律會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者按一下功能表項目時, 架構會執行與該專案相關聯的命令。

若要自訂功能表項目處理, `OnClickMenuItem`請在衍生自`CMFCToolBarMenuButton`類別的類別中覆寫。 您也必須覆寫[CFrameWndEx:: OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) , 並以衍生類別的實例取代需要特殊處理的功能表按鈕。

##  <a name="oncontexthelp"></a>CMFCToolBarMenuButton:: OnCoNtextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>參數

[in] *pWnd*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="ondraw"></a>CMFCToolBarMenuButton:: OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>
在*rect*<br/>
在*pImages*<br/>
[in] *bHorz*<br/>
在*bCustomizeMode*<br/>
在*bHighlight*<br/>
[in] *bDrawBorder*<br/>
在*bGrayDisabledButtons*<br/>

### <a name="remarks"></a>備註

##  <a name="ondrawoncustomizelist"></a>CMFCToolBarMenuButton:: OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>參數

[in] *pDC*<br/>
在*rect*<br/>
在*bSelected*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="openpopupmenu"></a>CMFCToolBarMenuButton:: OpenPopupMenu

當使用者開啟工具列功能表按鈕的下拉式功能表時, 由架構呼叫。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在指定接收下拉式功能表命令的視窗。 只有當工具列功能表按鈕有父視窗時, 它才可以是 Null。

### <a name="return-value"></a>傳回值

若已成功建立並開啟[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件, 則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

當使用者從工具列功能表按鈕開啟下拉式功能表時, 架構會呼叫這個函式。

##  <a name="resetimagetodefault"></a>CMFCToolBarMenuButton:: ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>備註

##  <a name="savebarstate"></a>CMFCToolBarMenuButton:: SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>備註

當此架構建立工具列按鈕做為拖放作業的結果時, 會呼叫這個方法。 這個方法會呼叫最上層快顯功能表的[CMFCPopupMenu:: SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate)方法, 這會造成快顯功能表的父按鈕重新建立其功能表。

##  <a name="serialize"></a>CMFCToolBarMenuButton:: 序列化

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

[in] *ar*<br/>

### <a name="remarks"></a>備註

##  <a name="setaccdata"></a>CMFCToolBarMenuButton:: SetACCData

設定功能區項目的協助工具資料。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
功能區項目的父視窗。

*data*<br/>
功能區項目的協助工具資料。

### <a name="return-value"></a>傳回值

一律傳回 TRUE。

### <a name="remarks"></a>備註

根據預設, 這個方法會設定功能區專案的協助工具資料, 而且一律會傳回 TRUE。 覆寫此方法以設定協助工具資料並傳回值，以指出成功或失敗。

##  <a name="setmenuonly"></a>CMFCToolBarMenuButton:: SetMenuOnly

指定按鈕是否繪製為功能表按鈕, 或同時具有有效的命令 ID 和子功能表時的分割按鈕。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>參數

*bMenuOnly*<br/>
在TRUE 會在同時具有有效的命令識別碼和子功能表時, 將此按鈕顯示為功能表按鈕, FALSE 則會在同時具有有效的命令識別碼和子功能表時, 將此按鈕顯示為分割按鈕。

### <a name="remarks"></a>備註

一般而言, 當工具列功能表按鈕同時具有子功能表和命令 ID 時, 功能表會顯示為具有主要按鈕和附加向下箭號按鈕的分割按鈕。 如果您呼叫這個方法, 而且*bMenuOnly*為 TRUE, 則按鈕會改為顯示按鈕中有向下箭號的單一功能表按鈕。 當使用者在任一模式中按一下箭號時, 會開啟子功能表, 而當使用者在任一模式下按一下按鈕的非箭號部分時, 該架構就會執行命令。

##  <a name="setmenupalettemode"></a>CMFCToolBarMenuButton:: SetMenuPaletteMode

指定下拉式功能表是否為 [調色板] 模式。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>參數

*bMenuPaletteMode*<br/>
在指定下拉式功能表是否為 [調色板] 模式。

*nPaletteRows*<br/>
在調色板中的資料列數目。

### <a name="remarks"></a>備註

在 [調色板] 模式中, 所有功能表項目都會顯示為多行調色板。 您可以使用*nPaletteRows*來指定資料列數目。

##  <a name="setmessagewnd"></a>CMFCToolBarMenuButton:: SetMessageWnd

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>參數

[in] *pWndMessage*<br/>

### <a name="remarks"></a>備註

##  <a name="setradio"></a>CMFCToolBarMenuButton:: SetRadio

設定工具列功能表按鈕, 以在選取時顯示選項按鈕樣式圖示。

```
virtual void SetRadio();
```

### <a name="remarks"></a>備註

當您選取 [功能表] 按鈕時, 它會呼叫[CMFCVisualManager:: OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)來繪製核取記號圖示。 根據預設, `OnDrawMenuCheck`會要求目前的視覺效果管理員在功能表按鈕上繪製核取方塊樣式核取記號。 在您呼叫這個方法之後, 目前的視覺效果管理員會改為在功能表按鈕上繪製一個選項按鈕樣式核取記號。 這種變更無法復原。

當您呼叫這個方法, 而且目前正在顯示 [功能表] 按鈕時, 它會重新整理。

##  <a name="settearoff"></a>CMFCToolBarMenuButton:: SetTearOff

指定下拉式功能表的下拉列的識別碼 (ID)。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>參數

*uiBarID*<br/>
在指定新的清除橫條 ID。

### <a name="remarks"></a>備註

呼叫這個方法, 以指定當使用者將功能表按鈕拖曳至功能表列時所建立的卸載行識別碼。 如果*uiBarID*參數是 0, 使用者就無法卸載功能表按鈕。

呼叫[CWinAppEx:: EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) , 以在您的應用程式中啟用 [卸載] 功能表功能。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)
