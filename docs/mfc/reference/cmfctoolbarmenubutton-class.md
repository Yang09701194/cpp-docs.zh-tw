---
title: CMFCToolBarMenuButton 類別 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: d1002d0a6bcd8d477aa3af86e72faafa843b7565
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/25/2018
ms.locfileid: "50067458"
---
# <a name="cmfctoolbarmenubutton-class"></a>CMFCToolBarMenuButton 類別

包含快顯功能表的工具列按鈕。
如需詳細資訊，請參閱中的原始程式碼**VC\\atlmfc\\src\\mfc** Visual Studio 安裝資料夾。

## <a name="syntax"></a>語法

```
class CMFCToolBarMenuButton : public CMFCToolBarButton
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|建構 `CMFCToolBarMenuButton` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|比較這個執行個體與提供`CMFCToolBarButton`物件。 (覆寫[CMFCToolBarButton::CompareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith)。)|
|[Cmfctoolbarmenubutton:: Copyfrom](#copyfrom)|另一個工具列按鈕的屬性複製到目前的按鈕。 (覆寫[CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom)。)|
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|初始化 Windows 功能表控制代碼的工具列功能表。|
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|建立工具列功能表中的命令所組成的 Windows 功能表。 傳回的 Windows 功能表的控制代碼。|
|[Cmfctoolbarmenubutton:: Createpopupmenu](#createpopupmenu)|建立快顯功能表物件 ( [CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)) 以顯示 [工具列] 功能表。|
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||
|[CMFCToolBarMenuButton::GetCommands](#getcommands)|可唯讀存取權，讓 [工具列] 功能表中的命令清單。|
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|擷取按鈕影像的周框矩形。|
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|調色盤模式功能表時，請在快顯功能表中傳回資料列的數目。|
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|傳回與按鈕關聯的快顯功能表物件的指標。|
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|決定當使用者選取按鈕時，是否要顯示按鈕的框線。 (覆寫[CMFCToolBarButton::HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder)。)|
|[CMFCToolBarMenuButton::IsBorder](#isborder)||
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|決定是否要顯示快顯功能表。|
|[Cmfctoolbarmenubutton:: Isemptymenuallowed](#isemptymenuallowed)|由架構呼叫以判斷使用者是否可以從選取的功能表項目開啟子功能表。|
|[CMFCToolBarMenuButton::IsExclusive](#isexclusive)|決定是否 按鈕以獨佔模式，也就是快顯功能表是否保持開啟即使使用者將指標移至另一個工具列或按鈕上方。|
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|判斷是否在調色盤模式中的快顯功能表。|
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|判斷快顯功能表是否有 tear-off 列。|
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|指定是否可以拖曳的按鈕。 (覆寫[CMFCToolBarButton::OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag)。)|
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|由架構呼叫以計算的銜接狀態與指定的裝置內容的按鈕大小。 (覆寫[CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize)。)|
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|由架構呼叫以處理[WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode)訊息。 (覆寫[CMFCToolBarButton::OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode)。)|
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|插入新的工具列按鈕時由架構呼叫。 (覆寫[CMFCToolBarButton::OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd)。)|
|[CMFCToolBarMenuButton::OnClick](#onclick)|使用者按下滑鼠按鈕時由架構呼叫。 (覆寫[CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick)。)|
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|當使用者選取項目在快顯功能表中，由架構呼叫。|
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|為父工具列處理 WM_HELPHITTEST 訊息時由架構呼叫。 (覆寫[CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp)。)|
|[CMFCToolBarMenuButton::OnDraw](#ondraw)|由架構呼叫以繪製按鈕，使用指定的樣式和選項。 (覆寫[CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw)。)|
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|由架構呼叫以繪製按鈕**命令**窗格**自訂** 對話方塊。 (覆寫[CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist)。)|
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|在使用者開啟快顯功能表時，由架構呼叫。|
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|設定為預設值是與按鈕關聯的映像。 (覆寫[CMFCToolBarButton::ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault)。)|
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|儲存狀態的工具列按鈕。 (覆寫[CMFCToolBarButton::SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate)。)|
|[CMFCToolBarMenuButton::Serialize](#serialize)|從封存讀取這個物件，或將其寫入至封存。 (覆寫[CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize)。)|
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|填入所提供`CAccessibilityData`物件從工具列按鈕的協助工具資料。 (覆寫[CMFCToolBarButton::SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata)。)|
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|指定按鈕是否可以加入至工具列。|
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|指定是否在調色盤模式快顯功能表。|
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||
|[CMFCToolBarMenuButton::SetRadio](#setradio)|強制工具列的功能表按鈕，以顯示圖示，表示已選取。|
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|指定分割列的快顯功能表的識別碼。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|在 [功能表] 按鈕上繪製圖示。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|如果為 TRUE，架構會一律呼叫[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)時繪製按鈕。|

## <a name="remarks"></a>備註

A`CMFCToolBarMenuButton`可以顯示為功能表、 功能表項目具有子功能表、 按鈕，或是執行命令會顯示功能表或顯示只有 功能表的按鈕。 您指定參數，例如影像、 文字方塊、 功能表控制代碼，來判斷功能表按鈕的外觀與行為，及命令 ID 與建構函式中的按鈕相關聯`CMFCToolbarMenuButton::CMFCToolbarMenuButton`。

自訂的類別衍生自`CMFCToolbarMenuButton`類別必須使用[DECLARE_SERIAL](run-time-object-model-services.md#declare_serial)巨集。 [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate)巨集會產生錯誤，應用程式關閉時。

## <a name="example"></a>範例

下列範例示範如何設定`CMFCToolBarMenuButton`物件。 程式碼說明如何指定調色盤 模式中，為下拉式選單，並指定當使用者拖曳功能表列上的 功能表 按鈕建立 tear-off 列的識別碼。 此程式碼片段是 [WordPad 範例](../../visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

[CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)

## <a name="requirements"></a>需求

**標頭：** afxtoolbarmenubutton.h

##  <a name="cmfctoolbarmenubutton"></a>  CMFCToolBarMenuButton::CMFCToolBarMenuButton

建構 `CMFCToolBarMenuButton` 物件。

```
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,
    HMENU hMenu,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE);
```

### <a name="parameters"></a>參數

*src*<br/>
[in]將現有`CMFCToolBarMenuButton`要複製到這個物件`CMFCToolBarMenuButton`物件。

*uiID*<br/>
[in]當使用者按一下按鈕，執行命令的識別碼或者 (UINT)-1 會不會直接執行命令的功能表按鈕。

*hMenu*<br/>
[in]功能表控制代碼或者，如果按鈕沒有功能表則為 NULL。

*iImage*<br/>
[in]按鈕; 映像的索引則為-1，如果此按鈕，並沒有圖示，或針對所指定的命令會使用圖示*uiID*。 索引是針對每個相同`CMFCToolBarImages`應用程式中的物件。

*lpszText*<br/>
[in]工具列功能表按鈕的文字。

*bUserButton*<br/>
[in]如果按鈕會顯示使用者定義的影像，則為 TRUE如果按鈕會顯示與所指定的命令相關聯的預先定義的映像，則為 FALSE。 *uiID*。

### <a name="remarks"></a>備註

如果*uiID*是有效的命令 ID，按鈕會執行該命令，當使用者按一下它。 如果*hMenu*是有效的功能表的控制代碼，它必須出現在功能表中出現在子功能表或工具列時，按鈕會提供下拉式選單。 如果兩個*uiID*並*hMenu*都有效，是將執行的命令，當使用者按一下上面的部分與向下箭頭，將下拉功能表與部分分割按鈕時的使用者按一下它。 不過，如果*hMenu*是有效的使用者不能按一下按鈕來插入功能表按鈕時執行命令。

### <a name="example"></a>範例

下列範例示範如何建構的物件`CMFCToolBarMenuButton`類別。 此程式碼片段是 [WordPad 範例](../../visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]

##  <a name="comparewith"></a>  CMFCToolBarMenuButton::CompareWith

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>參數

[in]*其他*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="copyfrom"></a>  Cmfctoolbarmenubutton:: Copyfrom

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>參數

[in]*src*<br/>

### <a name="remarks"></a>備註

##  <a name="createfrommenu"></a>  CMFCToolBarMenuButton::CreateFromMenu

初始化 Windows 功能表控制代碼的工具列功能表。

```
virtual void CreateFromMenu(HMENU hMenu);
```

### <a name="parameters"></a>參數

*hMenu*<br/>
[in]功能表控制代碼。

### <a name="remarks"></a>備註

工具列功能表按鈕可以顯示下拉式選單 子功能表。

架構會呼叫這個方法來初始化的子功能表中，從功能表命令。

##  <a name="createmenu"></a>  CMFCToolBarMenuButton::CreateMenu

建立包含 [工具列] 功能表中的命令功能表。 傳回功能表的控制代碼。

```
virtual HMENU CreateMenu() const;
```

### <a name="return-value"></a>傳回值

如果處理至功能表的成功。 如果工具列功能表按鈕相關聯的命令清單是空的則為 NULL。

### <a name="remarks"></a>備註

您可以覆寫中自訂功能表的產生的方式衍生的類別，這個方法。

##  <a name="createpopupmenu"></a>  Cmfctoolbarmenubutton:: Createpopupmenu

建立`CMFCPopupMenu`物件，以顯示 [工具列] 功能表。

```
virtual CMFCPopupMenu* CreatePopupMenu();
```

### <a name="return-value"></a>傳回值

指標`CMFCPopupMenu`顯示下拉式清單功能表與工具列功能表按鈕相關聯的物件。

### <a name="remarks"></a>備註

由架構準備與按鈕關聯的下拉式選單的顯示會呼叫這個方法。

預設實作只會建構並傳回新`CMFCPopupMenu`物件。 覆寫這個方法，如果您想要使用的衍生型別[CMFCPopupMenu 類別](cmfcpopupmenu-class.md)或執行其他初始化。

##  <a name="drawdocumenticon"></a>  CMFCToolBarMenuButton::DrawDocumentIcon

在 [功能表] 按鈕上繪製文件圖示。

```
void DrawDocumentIcon(
    CDC* pDC,
    const CRect& rectImage,
    HICON hIcon);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[in]裝置內容指標。

*rectImage*<br/>
[in]影像週框矩形的座標。

*hIcon*<br/>
[in]圖示控制代碼。

### <a name="remarks"></a>備註

這個方法會採用文件圖示，並將它繪製功能表按鈕，在所指定的區域置中對齊*rectImage*。

##  <a name="enablequickcustomize"></a>  CMFCToolBarMenuButton::EnableQuickCustomize

```
void EnableQuickCustomize();
```

### <a name="remarks"></a>備註

##  <a name="hasbutton"></a>  CMFCToolBarMenuButton::HasButton

```
virtual BOOL HasButton() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="havehotborder"></a>  CMFCToolBarMenuButton::HaveHotBorder

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isborder"></a>  CMFCToolBarMenuButton::IsBorder

```
virtual BOOL IsBorder() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isclickedonmenu"></a>  CMFCToolBarMenuButton::IsClickedOnMenu

```
BOOL IsClickedOnMenu() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isquickmode"></a>  CMFCToolBarMenuButton::IsQuickMode

```
BOOL IsQuickMode();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getcommands"></a>  CMFCToolBarMenuButton::GetCommands

可唯讀存取權，讓 [工具列] 功能表中的命令清單。

```
const CObList& GetCommands() const;
```

### <a name="return-value"></a>傳回值

Const 參考[CObList 類別](../../mfc/reference/coblist-class.md)物件，其中包含的集合[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)物件。

### <a name="remarks"></a>備註

工具列功能表按鈕可以顯示子功能表。 您可以提供的建構函式或子功能表中的命令清單[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)為功能表 (HMENU) 的控制代碼。 功能表會轉換成一份物件衍生自[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)並儲存在內部`CObList`物件。 您可以藉由呼叫這個方法來存取這份清單。

##  <a name="getimagerect"></a>  CMFCToolBarMenuButton::GetImageRect

擷取按鈕影像的周框矩形。

```
void GetImageRect(CRect& rectImage);
```

### <a name="parameters"></a>參數

*rectImage*<br/>
[out]參考`CRect`接收影像週框矩形的座標的物件。

##  <a name="getpaletterows"></a>  CMFCToolBarMenuButton::GetPaletteRows

調色盤模式功能表時，請在下拉式選單中傳回資料列數目。

```
int GetPaletteRows() const;
```

### <a name="return-value"></a>傳回值

調色盤中的資料列數目。

### <a name="remarks"></a>備註

當 [功能表] 按鈕設定為調色盤模式時，功能表項目會出現在具有只在有限的資料列的多個資料行中。 呼叫這個方法來取得資料列數目。 您可以啟用或停用調色盤模式，並指定使用的資料列數目[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)。

##  <a name="getpopupmenu"></a>  CMFCToolBarMenuButton::GetPopupMenu

將指標傳回至[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件，表示按鈕的下拉式選單。

```
CMFCPopupMenu* GetPopupMenu() const;
```

### <a name="return-value"></a>傳回值

指標[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)架構所繪製的工具列功能表按鈕，子功能表時所建立的物件如果沒有子功能表會顯示，則為 NULL。

### <a name="remarks"></a>備註

當工具列功能表按鈕會顯示下拉式選單時，按鈕會建立[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)物件來代表功能表。 呼叫這個方法來取得的指標`CMFCPopupMenu`物件。 您不應該儲存傳回的指標，因為它是暫時性的當使用者關閉下拉式選單會變成無效。

##  <a name="isdroppeddown"></a>  CMFCToolBarMenuButton::IsDroppedDown

指出目前是否顯示快顯功能表。

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>傳回值

如果工具列功能表按鈕會顯示其功能表;，則為 TRUE。否則為 FALSE。

##  <a name="isemptymenuallowed"></a>  Cmfctoolbarmenubutton:: Isemptymenuallowed

指定功能表項目是否顯示空的子功能表。

```
virtual BOOL IsEmptyMenuAllowed() const;
```

### <a name="return-value"></a>傳回值

如果架構時，會開啟子功能表從目前選取之功能表項目甚至 子功能表是空的則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

當使用者嘗試開啟子功能表，從目前選取之功能表項目時，架構會呼叫這個方法。 如果是空的子功能表和`IsEmptyMenuAllowed`傳回 FALSE，就不會開啟子功能表。

預設實作會傳回 FALSE。 覆寫這個方法以自訂此行為。

##  <a name="isexclusive"></a>  CMFCToolBarMenuButton::IsExclusive

指出是否以獨佔模式 按鈕。

```
virtual BOOL IsExclusive() const;
```

### <a name="return-value"></a>傳回值

如果按鈕是以獨佔模式;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

當使用者開啟快顯功能表按鈕，然後將滑鼠指標移至另一個工具列或功能表按鈕上方時，除非按鈕處於獨佔模式，也會關閉快顯功能表。

預設實作永遠會傳回 FALSE。 如果您想要獨佔模式開啟，請覆寫這個方法在衍生類別中。

##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode

判斷是否在調色盤模式下拉式選單。

```
BOOL IsMenuPaletteMode() const;
```

### <a name="return-value"></a>傳回值

調色盤模式是否已啟用，否則為 FALSE，則為 TRUE。

### <a name="remarks"></a>備註

當功能表按鈕設調色盤模式中時，功能表項目出現在多個資料行只在有限的資料列。 呼叫這個方法來取得資料列數目。 您可以啟用或停用調色盤模式藉由呼叫[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)。

##  <a name="istearoffmenu"></a>  CMFCToolBarMenuButton::IsTearOffMenu

指出下拉式功能表是否有 tear-off 列。

```
virtual BOOL IsTearOffMenu() const;
```

### <a name="return-value"></a>傳回值

如果工具列功能表按鈕有 tear-off 列;，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

若要啟用分割功能，並設定分割列識別碼，呼叫[CMFCToolBarMenuButton::SetTearOff](#settearoff)。

##  <a name="m_balwayscallownerdraw"></a>  CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw

指定是否在 framework 一律會呼叫[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)時繪製按鈕。

```
static BOOL m_bAlwaysCallOwnerDraw;
```

### <a name="remarks"></a>備註

當這個成員變數設定為 TRUE 時，按鈕一律會呼叫[CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage)方法，以在按鈕上顯示影像。 當`m_bAlwaysCallOwnerDraw`為 FALSE 時，按鈕本身繪製影像，如果預先定義的映像。 否則，它會呼叫`OnDrawMenuImage`。

##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu

```
virtual void OnAfterCreatePopupMenu();
```

### <a name="remarks"></a>備註

##  <a name="onbeforedrag"></a>  CMFCToolBarMenuButton::OnBeforeDrag

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="oncalculatesize"></a>  CMFCToolBarMenuButton::OnCalculateSize

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>參數

[in]*pDC*<br/>
[in]*sizeDefault*<br/>
[in]*bHorz*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="oncancelmode"></a>  CMFCToolBarMenuButton::OnCancelMode

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>備註

##  <a name="onchangeparentwnd"></a>  CMFCToolBarMenuButton::OnChangeParentWnd

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>參數

[in]*pWndParent*<br/>

### <a name="remarks"></a>備註

##  <a name="onclick"></a>  CMFCToolBarMenuButton::OnClick

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay = TRUE);
```

### <a name="parameters"></a>參數

[in]*pWnd*<br/>
[in]*bDelay*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="onclickmenuitem"></a>  CMFCToolBarMenuButton::OnClickMenuItem

當使用者選取下拉式選單中的項目時，由架構呼叫。

```
virtual BOOL OnClickMenuItem();
```

### <a name="return-value"></a>傳回值

如果架構應該繼續執行預設的功能表項目處理;，則為 FALSE。否則，則為 TRUE。 預設實作永遠會傳回 FALSE。

### <a name="remarks"></a>備註

當使用者按一下功能表項目時，架構就會執行該項目與相關聯的命令。

若要自訂功能表項目處理，覆寫`OnClickMenuItem`類別衍生自中`CMFCToolBarMenuButton`類別。 您也必須覆寫[CFrameWndEx::OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu)並取代需要以衍生類別的執行個體的特殊處理的功能表按鈕。

##  <a name="oncontexthelp"></a>  CMFCToolBarMenuButton::OnContextHelp

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>參數

[in]*pWnd*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="ondraw"></a>  CMFCToolBarMenuButton::OnDraw

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz = TRUE,
    BOOL bCustomizeMode = FALSE,
    BOOL bHighlight = FALSE,
    BOOL bDrawBorder = TRUE,
    BOOL bGrayDisabledButtons = TRUE);
```

### <a name="parameters"></a>參數

[in]*pDC*<br/>
[in]*rect*<br/>
[in]*pImages*<br/>
[in]*bHorz*<br/>
[in]*bCustomizeMode*<br/>
[in]*bHighlight*<br/>
[in]*bDrawBorder*<br/>
[in]*bGrayDisabledButtons*<br/>

### <a name="remarks"></a>備註

##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarMenuButton::OnDrawOnCustomizeList

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>參數

[in]*pDC*<br/>
[in]*rect*<br/>
[in]*bSelected*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu

在使用者開啟下拉式選單中的工具列功能表按鈕時由架構呼叫。

```
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
[in]指定接收下拉式選單命令視窗。 只有當工具列功能表按鈕的父視窗，它可以是 NULL。

### <a name="return-value"></a>傳回值

TRUE 的時機[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)已建立物件，並將其開啟成功，否則為 FALSE。

### <a name="remarks"></a>備註

在使用者開啟下拉式選單，從工具列功能表按鈕時，此函式是由架構呼叫。

##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>備註

##  <a name="savebarstate"></a>  CMFCToolBarMenuButton::SaveBarState

```
virtual void SaveBarState();
```

### <a name="remarks"></a>備註

建立工具列按鈕拖放作業的結果時，架構會呼叫這個方法。 這個方法會呼叫[CMFCPopupMenu::SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate)最上層的快顯功能表，這會導致重新建立其功能表快顯功能表的 [父] 按鈕的方法。

##  <a name="serialize"></a>  CMFCToolBarMenuButton::Serialize

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>參數

[in]*ar*<br/>

### <a name="remarks"></a>備註

##  <a name="setaccdata"></a>  CMFCToolBarMenuButton::SetACCData

設定功能區項目的協助工具資料。

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>參數

*pParent*<br/>
功能區項目的父視窗。

*data*<br/>
功能區項目的協助工具資料。

### <a name="return-value"></a>傳回值

一律會傳回 TRUE。

### <a name="remarks"></a>備註

依預設這個方法會設定協助工具功能區項目的資料，並一律會傳回 TRUE。 覆寫此方法以設定協助工具資料並傳回值，以指出成功或失敗。

##  <a name="setmenuonly"></a>  CMFCToolBarMenuButton::SetMenuOnly

指定具有有效的命令 ID 和子功能表時，是否要按鈕繪製為功能表按鈕或分割按鈕。

```
void SetMenuOnly(BOOL bMenuOnly);
```

### <a name="parameters"></a>參數

*bMenuOnly*<br/>
[in]如果為 true，則此按鈕顯示為功能表按鈕，當它需要有效的命令 ID 和子功能表，FALSE 具有有效的命令 ID 和子功能表時，顯示此按鈕為分割按鈕。

### <a name="remarks"></a>備註

一般而言，當工具列功能表按鈕具有子功能表和命令 ID，在功能表顯示要向下箭號按鈕具有主要按鈕 」 和 「 附加的分隔按鈕。 如果您呼叫這個方法和*bMenuOnly*為 TRUE 時，按鈕而似乎是單一的功能表按鈕中按鈕的向下箭號。 當使用者按一下任一種模式中的箭號時，在子功能表隨即開啟，而且當使用者按一下任一種模式下，架構中的按鈕中非箭號的一部分來執行命令。

##  <a name="setmenupalettemode"></a>  CMFCToolBarMenuButton::SetMenuPaletteMode

指定是否在調色盤模式下拉式選單。

```
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,
    int nPaletteRows=1);
```

### <a name="parameters"></a>參數

*bMenuPaletteMode*<br/>
[in]指定是否在調色盤模式下拉式選單。

*nPaletteRows*<br/>
[in]調色盤中的資料列數目。

### <a name="remarks"></a>備註

在調色盤模式中，所有功能表項目會都顯示為多重資料行的調色盤。 使用指定的資料列數目*nPaletteRows*。

##  <a name="setmessagewnd"></a>  CMFCToolBarMenuButton::SetMessageWnd

```
void SetMessageWnd(CWnd* pWndMessage);
```

### <a name="parameters"></a>參數

[in]*pWndMessage*<br/>

### <a name="remarks"></a>備註

##  <a name="setradio"></a>  CMFCToolBarMenuButton::SetRadio

設定要勾選時，顯示選項按鈕樣式圖示的工具列功能表按鈕。

```
virtual void SetRadio();
```

### <a name="remarks"></a>備註

雖然已繪製的功能表按鈕時，它會呼叫[CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck)繪製核取記號圖示。 根據預設，`OnDrawMenuCheck`要求目前的視覺化管理員繪製核取方塊樣式的功能表按鈕上的核取記號。 呼叫這個方法之後，目前的視覺化管理員改為 [功能表] 按鈕上繪製選項按鈕樣式核取記號。 這項變更無法復原。

當您呼叫這個方法，以及目前顯示的功能表按鈕時，就會重新整理。

##  <a name="settearoff"></a>  CMFCToolBarMenuButton::SetTearOff

指定下拉式選單中的 tear-off 列的識別碼。

```
virtual void SetTearOff(UINT uiBarID);
```

### <a name="parameters"></a>參數

*uiBarID*<br/>
[in]指定新分割列識別碼。

### <a name="remarks"></a>備註

呼叫此方法，以指定當使用者拖曳功能表列上的 [功能表] 按鈕建立 tear-off 列的識別碼。 如果*uiBarID*參數為 0，使用者不能卸除關閉功能表按鈕。

呼叫[CWinAppEx::EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus)以啟用您的應用程式中的 tear-off 功能表功能。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBarButton 類別](../../mfc/reference/cmfctoolbarbutton-class.md)<br/>
[CMFCToolBar 類別](../../mfc/reference/cmfctoolbar-class.md)<br/>
[CMFCPopupMenu 類別](../../mfc/reference/cmfcpopupmenu-class.md)