---
title: COleClientItem 類別 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
dev_langs:
- C++
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 6d19e808ed5e03f4ef117b91070a8885e7c68438
ms.sourcegitcommit: 26fff80635bd1d51bc51899203fddfea8b29b530
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/05/2018
ms.locfileid: "37850464"
---
# <a name="coleclientitem-class"></a>COleClientItem 類別
定義 OLE 項目的容器介面。  
  
## <a name="syntax"></a>語法  
  
```  
class COleClientItem : public CDocItem  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[COleClientItem::COleClientItem](#coleclientitem)|建構 `COleClientItem` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[COleClientItem::Activate](#activate)|開啟作業的 OLE 項目，然後執行指定的動詞命令。|  
|[COleClientItem::ActivateAs](#activateas)|啟動為其他類型的項目。|  
|[COleClientItem::AttachDataObject](#attachdataobject)|存取 OLE 物件中的資料。|  
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|表示是否將容器應用程式所建立的內嵌的物件。|  
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|指出是否將容器應用程式可以建立連結的物件。|  
|[COleClientItem::CanPaste](#canpaste)|指出剪貼簿是否包含可內嵌或靜態 OLE 項目。|  
|[COleClientItem::CanPasteLink](#canpastelink)|指出剪貼簿是否包含可連結的 OLE 項目。|  
|[COleClientItem::Close](#close)|關閉伺服器的連結，但不會終結 OLE 項目。|  
|[COleClientItem::ConvertTo](#convertto)|將項目轉換成其他型別。|  
|[COleClientItem::CopyToClipboard](#copytoclipboard)|將 OLE 項目複製到剪貼簿。|  
|[COleClientItem::CreateCloneFrom](#createclonefrom)|建立現有項目的複本。|  
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|從剪貼簿中建立內嵌項目。|  
|[COleClientItem::CreateFromData](#createfromdata)|從資料物件中建立內嵌項目。|  
|[COleClientItem::CreateFromFile](#createfromfile)|從檔案建立內嵌項目。|  
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|從剪貼簿中建立連結的項目。|  
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|建立連結的項目從資料物件。|  
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|從檔案建立連結的項目。|  
|[COleClientItem::CreateNewItem](#createnewitem)|啟動伺服器應用程式，以建立新的內嵌項目。|  
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|從剪貼簿中建立靜態項目。|  
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|建立靜態項目從資料物件。|  
|[COleClientItem::Deactivate](#deactivate)|停用項目。|  
|[COleClientItem::DeactivateUI](#deactivateui)|將容器應用程式的使用者介面還原為其原始狀態。|  
|[COleClientItem::Delete](#delete)|刪除或關閉 OLE 項目，如果它已連結的項目。|  
|[COleClientItem::DoDragDrop](#dodragdrop)|執行拖放作業。|  
|[COleClientItem::DoVerb](#doverb)|執行指定的動詞命令。|  
|[COleClientItem::Draw](#draw)|繪製 OLE 項目。|  
|[COleClientItem::GetActiveView](#getactiveview)|取得就地啟動項目時所在的檢視。|  
|[COleClientItem::GetCachedExtent](#getcachedextent)|傳回 OLE 項目的矩形的界限。|  
|[COleClientItem::GetClassID](#getclassid)|取得目前項目的類別識別碼。|  
|[COleClientItem::GetClipboardData](#getclipboarddata)|取得會藉由呼叫放到剪貼簿的資料`CopyToClipboard`成員函式。|  
|[COleClientItem::GetDocument](#getdocument)|傳回`COleDocument`物件，其中包含出現的項目。|  
|[COleClientItem::GetDrawAspect](#getdrawaspect)|取得轉譯的項目目前的檢視。|  
|[COleClientItem::GetExtent](#getextent)|傳回 OLE 項目的矩形的界限。|  
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|擷取特定的 CLSID 的伺服器相關聯的圖示的控制代碼。|  
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|取得用於繪製的項目圖示的中繼檔。|  
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|傳回的項目就地編輯視窗的指標。|  
|[COleClientItem::GetItemState](#getitemstate)|取得項目的目前狀態。|  
|[COleClientItem::GetLastStatus](#getlaststatus)|傳回最後一個 OLE 作業的狀態。|  
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|傳回連結的項目 （進階功能） 的更新模式。|  
|[COleClientItem::GetType](#gettype)|傳回 OLE 項目類型 （內嵌、 連結或靜態）。|  
|[COleClientItem::GetUserType](#getusertype)|取得描述項目類型的字串。|  
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|如果項目就地啟用作用中，則傳回 TRUE。|  
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|傳回 TRUE，如果連結的項目是最新的其來源文件。|  
|[COleClientItem::IsModified](#ismodified)|傳回 TRUE 如果項目已修改，因為它是最後一個儲存。|  
|[COleClientItem::IsOpen](#isopen)|傳回 TRUE 如果項目目前的伺服器應用程式開啟。|  
|[COleClientItem::IsRunning](#isrunning)|如果項目的伺服器應用程式正在執行，則傳回 TRUE。|  
|[COleClientItem::OnActivate](#onactivate)|由架構呼叫以通知項目，則會啟動。|  
|[COleClientItem::OnActivateUI](#onactivateui)|由架構呼叫以通知項目，它就會啟動，並應該會顯示其使用者介面。|  
|[COleClientItem::OnChange](#onchange)|伺服器變更 OLE 項目時呼叫。 所需的實作。|  
|[COleClientItem::OnDeactivate](#ondeactivate)|在停用項目時，由架構呼叫。|  
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|伺服器已移除其就地使用者介面時，由架構呼叫。|  
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|由架構呼叫以取得要複製到剪貼簿的資料。|  
|[COleClientItem::OnInsertMenus](#oninsertmenus)|由架構呼叫以建立複合的功能表。|  
|[COleClientItem::OnRemoveMenus](#onremovemenus)|由架構呼叫以從組合功能表移除容器的功能表。|  
|[COleClientItem::OnSetMenu](#onsetmenu)|由架構呼叫以安裝和移除組合功能表。|  
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|由架構呼叫以顯示和隱藏控制列。|  
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|由架構呼叫以更新框架視窗的標題列。|  
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|重新啟動項目，並會復原上次的就地編輯的作業。|  
|[COleClientItem::Release](#release)|釋放連接至 OLE 連結的項目並將它關閉，如果它已開啟。 不會終結用戶端項目。|  
|[COleClientItem::Reload](#reload)|若要在呼叫之後會重新載入的項目`ActivateAs`。|  
|[COleClientItem::Run](#run)|執行項目相關聯的應用程式。|  
|[COleClientItem::SetDrawAspect](#setdrawaspect)|設定項目的目前檢視中的轉譯。|  
|[COleClientItem::SetExtent](#setextent)|設定 OLE 項目的週框矩形。|  
|[COleClientItem::SetHostNames](#sethostnames)|設定編輯 OLE 項目時，會顯示伺服器的名稱。|  
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|會快取之中繼檔，用於繪製項目的圖示。|  
|[COleClientItem::SetItemRects](#setitemrects)|設定項目的週框矩形。|  
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|設定連結的項目 （進階功能） 的更新模式。|  
|[COleClientItem::SetPrintDevice](#setprintdevice)|設定此用戶端項目之列印目標裝置。|  
|[COleClientItem::UpdateLink](#updatelink)|更新簡報快取的項目。|  
  
### <a name="protected-methods"></a>保護方法  
  
|名稱|描述|  
|----------|-----------------|  
|[COleClientItem::CanActivate](#canactivate)|由架構呼叫以判斷是否允許就地啟用。|  
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|項目的位置變更時由架構呼叫。|  
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|由架構呼叫以在啟用後復原。|  
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|由架構呼叫以捨棄的項目復原狀態資訊。|  
|[COleClientItem::OnGetClipRect](#ongetcliprect)|由架構呼叫以取得項目的裁剪矩形座標。|  
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|由架構呼叫以取得相對於檢視項目的位置。|  
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|項目就地啟動時由架構呼叫。|  
|[COleClientItem::OnScrollBy](#onscrollby)|由架構呼叫以捲動至檢視的項目。|  
|[COleClientItem::OnShowItem](#onshowitem)|由架構呼叫以顯示 OLE 項目。|  
  
## <a name="remarks"></a>備註  
 OLE 項目代表伺服器應用程式，可以插入文件 「 無縫"結合，使其顯示給使用者，是一份文件所建立和維護的資料。 結果會是 「 複合文件 」 OLE 項目和包含文件所組成。  
  
 OLE 項目可以內嵌或連結。 如果它內嵌的其資料會儲存為複合文件的一部分。 如果它連結，其資料會儲存為伺服器應用程式中，建立個別檔案的一部分，並只連結至該檔案會儲存在複合文件。 所有 OLE 項目都包含指定伺服器應用程式應該呼叫來編輯它們的資訊。  
  
 `COleClientItem` 定義數個可覆寫的函式所呼叫以回應要求，從伺服器應用程式;這些可覆寫通常做為通知。 這可讓伺服器應用程式通知編輯 OLE 項目時，可讓使用者變更的容器，或擷取在編輯期間所需的資訊。  
  
 `COleClientItem` 可以搭配[COleDocument](../../mfc/reference/coledocument-class.md)， [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)，或[COleServerDoc](../../mfc/reference/coleserverdoc-class.md)類別。 若要使用`COleClientItem`，從它衍生的類別並實作[OnChange](#onchange)成員函式，其定義的容器項目所做變更的回應方式。 若要支援就地啟用，覆寫[OnGetItemPosition](#ongetitemposition)成員函式。 此函式會提供 OLE 項目顯示位置的相關資訊。  
  
 如需使用容器介面的詳細資訊，請參閱文章[容器： 實作容器](../../mfc/containers-implementing-a-container.md)並[啟用](../../mfc/activation-cpp.md)。  
  
> [!NOTE]
>  內嵌和連結的項目，為 「 物件 」 是指 Windows SDK，並將類型的項目稱為 「 類別 」。 此參考會使用"item"的詞彙來區別 OLE 實體從對應的 c + + 物件和詞彙來區別 OLE 類別目錄從 c + + 類別的 「 類型 」。  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CDocItem](../../mfc/reference/cdocitem-class.md)  
  
 `COleClientItem`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxole.h  
  
##  <a name="activate"></a>  COleClientItem::Activate  
 呼叫此函式來執行指定的動詞，而不是[DoVerb](#doverb) ，讓您可以執行您自己處理擲回例外狀況時。  
  
```  
void Activate(
    LONG nVerb,  
    CView* pView,  
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>參數  
 *nVerb*  
 指定要執行的動詞命令。 它可以是下列其中一項：  
  
|值|意義|符號|  
|-----------|-------------|------------|  
|- 0|主動詞命令|OLEIVERB_PRIMARY|  
|- 1|次要的動詞命令|(無)|  
|- 1|顯示項目進行編輯|OLEIVERB_SHOW|  
|- 2|編輯在個別視窗中的項目|OLEIVERB_OPEN|  
|- 3|隱藏項目|OLEIVERB_HIDE|  
  
 -1 值通常是另一個動詞命令的別名。 如果不支援開啟編輯，-2 會有相同的效果，為-1。 其他值，請參閱[IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) Windows SDK 中。  
  
 *pView*  
 容器檢視視窗，其中包含 OLE 項目; 指標這用於伺服器應用程式就地啟用。 如果容器不支援就地啟用，此參數應該是 NULL。  
  
 *lpMsg*  
 造成要啟動的項目之訊息的指標。  
  
### <a name="remarks"></a>備註  
 如果伺服器應用程式使用 Microsoft Foundation 類別庫所撰寫，此函式會導致[OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb)成員函式對應`COleServerItem`来執行的物件。  
  
 如果主要動作是編輯，而且在指定為零*nVerb*允許編輯 OLE 項目啟動參數，伺服器應用程式。 如果容器應用程式支援就地啟用，請編輯可就地。 如果容器不支援就地啟用 （或如果已指定 Open 動詞），伺服器會啟動另一個視窗中，然後編輯可那里。 一般而言，當容器應用程式的使用者按兩下 OLE 項目中的主要動詞命令的值時，才*nVerb*參數會決定使用者可以採取哪些動作。 不過，如果伺服器只支援一個動作，它會該動作，不論使用哪些中指定值*nVerb*參數。  
  
 如需詳細資訊，請參閱 < [IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) Windows SDK 中。  
  
##  <a name="activateas"></a>  COleClientItem::ActivateAs  
 啟動項目，就如同所指定之類型的項目會使用 OLE 的物件轉換設備*clsidNew*。  
  
```  
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,  
    REFCLSID clsidOld,  
    REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>參數  
 *lpszUserType*  
 指向字串，表示目標使用者類型，例如 「 Word 文件。 」  
  
 *clsidOld*  
 項目的目前類別的參考識別碼。 類別識別碼應該代表類型的實際物件，因為儲存，除非它是連結。 在此情況下，它應該是 CLSID 的連結所參考的項目。 [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)自動提供項目的正確類別識別碼。  
  
 *clsidNew*  
 參考到目標類別識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 這稱為自動[COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert)。 它不通常會直接呼叫。  
  
##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject  
 呼叫此函式來初始化[COleDataObject](../../mfc/reference/coledataobject-class.md)來存取 OLE 項目中的資料。  
  
```  
void AttachDataObject(COleDataObject& rDataObject) const;  
```  
  
### <a name="parameters"></a>參數  
 *rDataObject*  
 若要參考`COleDataObject`會初始化為 OLE 項目中允許資料的存取權的物件。  
  
##  <a name="canactivate"></a>  COleClientItem::CanActivate  
 使用者要求的 OLE 項目; 在就地啟用時，由架構呼叫此函式的傳回值會決定是否允許就地啟用。  
  
```  
virtual BOOL CanActivate();
```  
  
### <a name="return-value"></a>傳回值  
 非零值，如果允許就地啟用;否則為 0。  
  
### <a name="remarks"></a>備註  
 如果容器有有效的視窗的預設實作會允許就地啟用。 覆寫這個函式，以實作特殊邏輯，以接受或拒絕的啟用要求。 比方說，太小或目前可見 OLE 項目時，可以拒絕啟動要求。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceSite::CanInPlaceActivate](http://msdn.microsoft.com/library/windows/desktop/ms691236) Windows SDK 中。  
  
##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData  
 檢查容器應用程式是否可以建立內嵌的物件從指定`COleDataObject`物件。  
  
```  
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>參數  
 *pDataObject*  
 指標[COleDataObject](../../mfc/reference/coledataobject-class.md)從中 OLE 項目是要建立的物件。  
  
### <a name="return-value"></a>傳回值  
 如果容器可以建立內嵌的物件的非零`COleDataObject`物件; 否則為 0。  
  
### <a name="remarks"></a>備註  
 `COleDataObject`類別用於資料傳輸中擷取以各種格式的資料從剪貼簿，透過拖放動作，或內嵌 OLE 項目。  
  
 容器可以使用此函式，來決定啟用或停用其編輯貼上和 [編輯選擇性貼上] 命令。  
  
 如需詳細資訊，請參閱文章[資料物件和資料來源 (OLE)](../../mfc/data-objects-and-data-sources-ole.md)。  
  
##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData  
 檢查容器應用程式是否可以建立連結的物件，從指定`COleDataObject`物件。  
  
```  
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>參數  
 *pDataObject*  
 指標[COleDataObject](../../mfc/reference/coledataobject-class.md)從中 OLE 項目是要建立的物件。  
  
### <a name="return-value"></a>傳回值  
 如果容器可以建立從連結的物件為非零`COleDataObject`物件。  
  
### <a name="remarks"></a>備註  
 `COleDataObject`類別用於資料傳輸中擷取以各種格式的資料從剪貼簿，透過拖放動作，或內嵌 OLE 項目。  
  
 容器可以使用此函式，來決定啟用或停用其編輯選擇性貼上及編輯貼上連結的命令。  
  
 如需詳細資訊，請參閱文章[資料物件和資料來源 (OLE)](../../mfc/data-objects-and-data-sources-ole.md)。  
  
##  <a name="canpaste"></a>  COleClientItem::CanPaste  
 呼叫此函式，以查看內嵌的 OLE 項目是否可以從剪貼簿貼上。  
  
```  
static BOOL PASCAL CanPaste();
```  
  
### <a name="return-value"></a>傳回值  
 如果內嵌的 OLE 項目可以貼上剪貼簿; 中，非零值。否則為 0。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778)並[OleQueryCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms683739) Windows SDK 中。  
  
##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink  
 呼叫此函式，若要查看連結的 OLE 項目是否可以從剪貼簿貼上。  
  
```  
static BOOL PASCAL CanPasteLink();
```  
  
### <a name="return-value"></a>傳回值  
 非零值，如果可以貼上連結的 OLE 項目，從剪貼簿。否則為 0。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778)並[OleQueryLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms690244) Windows SDK 中。  
  
##  <a name="close"></a>  COleClientItem::Close  
 呼叫此函式以從載入它在記憶體中的處理常式，但不執行伺服器執行狀態的載入狀態，也就是變更 OLE 項目的狀態。  
  
```  
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```  
  
### <a name="parameters"></a>參數  
 *dwCloseOption*  
 旗標，指定已載入狀態恢復時，OLE 項目儲存在哪些情況之下。 它可以包含下列值之一：  
  
- OLECLOSE_SAVEIFDIRTY 儲存 OLE 項目。  
  
- OLECLOSE_NOSAVE 不要儲存 OLE 項目。  
  
- OLECLOSE_PROMPTSAVE 提示使用者是否要儲存 OLE 項目。  
  
### <a name="remarks"></a>備註  
 當 OLE 項目不在執行時，此函式會有任何作用。  
  
 如需詳細資訊，請參閱 < [IOleObject::Close](http://msdn.microsoft.com/library/windows/desktop/ms683922) Windows SDK 中。  
  
##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem  
 建構`COleClientItem`物件，並將它新增至容器文件的文件項目集合，其中建構 c + + 物件，並不會執行任何 OLE 初始化。  
  
```  
COleClientItem(COleDocument* pContainerDoc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *pContainerDoc*  
 容器文件會包含此項目的指標。 這可以是任何[COleDocument](../../mfc/reference/coledocument-class.md)衍生項目。  
  
### <a name="remarks"></a>備註  
 如果您傳遞的 NULL 指標，會將任何加法不對容器文件。 您必須明確呼叫[COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem)。  
  
 在使用 OLE 項目之前，您必須呼叫其中一個下列建立成員函式：  
  
- [CreateFromClipboard](#createfromclipboard)  
  
- [CreateFromData](#createfromdata)  
  
- [CreateFromFile](#createfromfile)  
  
- [CreateStaticFromClipboard](#createstaticfromclipboard)  
  
- [CreateStaticFromData](#createstaticfromdata)  
  
- [CreateLinkFromClipboard](#createlinkfromclipboard)  
  
- [CreateLinkFromData](#createlinkfromdata)  
  
- [CreateLinkFromFile](#createlinkfromfile)  
  
- [CreateNewItem](#createnewitem)  
  
- [CreateCloneFrom](#createclonefrom)  
  
##  <a name="convertto"></a>  COleClientItem::ConvertTo  
 呼叫此成員函式所指定的型別轉換之項目的*clsidNew*。  
  
```  
virtual BOOL ConvertTo(REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>參數  
 *clsidNew*  
 目標類型的類別識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 這稱為自動[COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md)。 您不需要直接呼叫它。  
  
##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard  
 呼叫此函式可將 OLE 項目複製到剪貼簿。  
  
```  
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```  
  
### <a name="parameters"></a>參數  
 *bIncludeLink*  
 如果連結資訊應該複製到剪貼簿，允許貼上; 連結的項目，則為 TRUE。否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 一般而言，撰寫從 [編輯] 功能表的 [複製或剪下] 命令的訊息處理常式時呼叫此函式。 如果您想要實作複製或剪下命令，您必須在您的容器應用程式中實作的項目選取。  
  
 如需詳細資訊，請參閱 < [OleSetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms686623) Windows SDK 中。  
  
##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom  
 呼叫此函式可建立一份指定的 OLE 項目。  
  
```  
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```  
  
### <a name="parameters"></a>參數  
 *pSrcItem*  
 OLE 項目被複製的指標。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 複製等同於來源項目。 您可以使用此函式來支援復原作業。  
  
##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard  
 呼叫此函式可從剪貼簿的內容中建立內嵌項目。  
  
```  
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 一般都會呼叫此函式的訊息處理常式從的 [編輯] 功能表中的 [貼上] 命令。 (如果 framework 便會啟用 [貼上] 命令[CanPaste](#canpaste)成員函式傳回非零值。)  
  
 如需詳細資訊，請參閱 < [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createfromdata"></a>  COleClientItem::CreateFromData  
 呼叫此函式以建立內嵌項目從`COleDataObject`物件。  
  
```  
BOOL CreateFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *pDataObject*  
 指標[COleDataObject](../../mfc/reference/coledataobject-class.md)從中 OLE 項目是要建立的物件。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 資料傳輸作業，例如從剪貼簿或拖放作業中，貼上提供`COleDataObject`物件包含的資訊提供的伺服器應用程式。 它通常用在覆寫[CView::OnDrop](../../mfc/reference/cview-class.md#ondrop)。  
  
 如需詳細資訊，請參閱 < [OleCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms691211)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile  
 呼叫此函式可從檔案建立內嵌的 OLE 項目。  
  
```  
BOOL CreateFromFile(
    LPCTSTR lpszFileName,  
    REFCLSID clsid = CLSID_NULL,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *lpszFileName*  
 建立 OLE 項目檔案名稱的指標。  
  
 *clsid*  
 保留供未來使用。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 架構會呼叫這個函式從[COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)如果使用者會選擇從 [插入物件] 對話方塊中 [確定] 時已選取 [檔案] 按鈕建立。  
  
 如需詳細資訊，請參閱 < [OleCreateFromFile](http://msdn.microsoft.com/library/windows/desktop/ms690116)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard  
 呼叫此函式以建立連結的項目從剪貼簿的內容。  
  
```  
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 一般都會呼叫此函式的訊息處理常式從的 編輯 功能表上的貼上連結 命令。 (貼上連結命令中的預設實作，已啟用[COleDocument](../../mfc/reference/coledocument-class.md)如果剪貼簿包含可連結到 OLE 項目。)  
  
 如需詳細資訊，請參閱 < [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData  
 呼叫此函式以建立連結的項目，從`COleDataObject`物件。  
  
```  
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *pDataObject*  
 指標[COleDataObject](../../mfc/reference/coledataobject-class.md)從中 OLE 項目是要建立的物件。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 呼叫這個拖放作業期間當使用者指出應建立的連結。 它也可以用來處理編輯貼上 命令。 它會呼叫中的架構`COleClientItem::CreateLinkFromClipboard`然後在[COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)時已選取 [連結] 選項。  
  
 如需詳細資訊，請參閱 < [OleCreateLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms680731)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile  
 呼叫此函式可從檔案建立連結的 OLE 項目。  
  
```  
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *lpszFileName*  
 建立 OLE 項目檔案名稱的指標。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果使用者會選擇 [確定] 從 [插入物件] 對話方塊中已選取 [檔案] 按鈕建立並連結核取方塊已核取時，架構會呼叫此函式。 從呼叫[COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem)。  
  
 如需詳細資訊，請參閱 < [OleCreateLinkToFile](http://msdn.microsoft.com/library/windows/desktop/ms678434)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem  
 呼叫此函式以建立內嵌項目;此函式會啟動伺服器應用程式，可讓使用者建立 OLE 項目。  
  
```  
BOOL CreateNewItem(
    REFCLSID clsid,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *clsid*  
 可唯一識別建立的 OLE 項目類型的識別碼。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果使用者會選擇 確定 從 插入物件 對話方塊中選取 建立新的按鈕時，架構會呼叫此函式。  
  
 如需詳細資訊，請參閱 < [OleCreate](http://msdn.microsoft.com/library/windows/desktop/ms678409)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard  
 呼叫此函式來建立靜態項目從剪貼簿的內容。  
  
```  
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 靜態項目包含呈現資料，但不是原生的資料;因此就無法進行編輯。 您通常是呼叫此函式，如果[CreateFromClipboard](#createfromclipboard)成員函式會失敗。  
  
 如需詳細資訊，請參閱 < [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData  
 呼叫此函式來建立靜態的項目，從`COleDataObject`物件。  
  
```  
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>參數  
 *pDataObject*  
 指標[COleDataObject](../../mfc/reference/coledataobject-class.md)從中 OLE 項目是要建立的物件。  
  
 *轉譯*  
 旗標，指定伺服器將如何轉譯 OLE 項目。 如需可能的值，請參閱[OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) Windows SDK 中。  
  
 *cfFormat*  
 指定要建立 OLE 項目時，快取的剪貼簿資料格式。  
  
 *lpFormatEtc*  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)如果使用的結構*轉譯*OLERENDER_FORMAT 或 OLERENDER_DRAW。 只有當您想要指定超過所指定的剪貼簿格式的其他格式資訊，請為此參數提供值*cfFormat*。 如果您省略這個參數時，會使用中的其他欄位的預設值`FORMATETC`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 靜態項目包含呈現資料，但不是原生的資料;因此，就無法進行編輯。 這基本上是相同[CreateStaticFromClipboard](#createstaticfromclipboard)不同之處在於靜態項目可以建立從任意`COleDataObject`，而不只是從剪貼簿。  
  
 用於[COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem)選取靜態時。  
  
 如需詳細資訊，請參閱 < [OleCreateStaticFromData](http://msdn.microsoft.com/library/windows/desktop/ms687290)， [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507)，並[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) Windows SDK 中。  
  
##  <a name="deactivate"></a>  COleClientItem::Deactivate  
 呼叫此函式以停用 OLE 項目，並釋放任何相關聯的資源。  
  
```  
void Deactivate();
```  
  
### <a name="remarks"></a>備註  
 當使用者按一下將滑鼠停在工作區的項目範圍之外，您通常停用就地使用中 OLE 項目。 請注意，停用 OLE 項目將會捨棄其復原狀態，使其無法呼叫[ReactivateAndUndo](#reactivateandundo)成員函式。  
  
 如果您的應用程式支援復原，請勿呼叫`Deactivate`; 相反地，呼叫[DeactivateUI](#deactivateui)。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) Windows SDK 中。  
  
##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI  
 當使用者停用就地啟動項目時，請呼叫此函式。  
  
```  
void DeactivateUI();
```  
  
### <a name="remarks"></a>備註  
 此函式會還原為其原始狀態，隱藏任何功能表和其他控制項所建立的就地啟用容器應用程式的使用者介面。  
  
 此函式不會清除復原的狀態資訊項目。 資訊會保留以便[ReactivateAndUndo](#reactivateandundo)稍後可用來執行伺服器應用程式中的 [復原] 命令容器的 [復原] 命令會停用項目之後，立即選擇。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) Windows SDK 中。  
  
##  <a name="delete"></a>  COleClientItem::Delete  
 呼叫此函式來刪除容器文件中的 OLE 項目。  
  
```  
void Delete(BOOL bAutoDelete = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *bAutoDelete*  
 指定要從文件中移除項目。  
  
### <a name="remarks"></a>備註  
 此函式會呼叫[發行](#release)成員函式，依次刪除項目，永久地移除 OLE 項目文件的 c + + 物件。 如果內嵌 OLE 項目，會刪除原生資料的項目。 它一律會關閉執行中的伺服器;因此，如果項目是開啟的連結，此函式會關閉它。  
  
##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop  
 呼叫`DoDragDrop`成員函式來執行拖放作業。  
  
```  
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,  
    CPoint ptOffset,  
    BOOL bIncludeLink = FALSE,  
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,  
    LPCRECT lpRectStartDrag = NULL);
```  
  
### <a name="parameters"></a>參數  
 *lpItemRect*  
 在工作區座標 （像素為單位） 畫面上的項目矩形。  
  
 *ptOffset*  
 從位移*lpItemRect*滑鼠位置的拖曳時。  
  
 *bIncludeLink*  
 將此設定則為 TRUE 的資料應該複製到剪貼簿的連結。 請將它設定為 FALSE，如果您的伺服器應用程式不支援連結。  
  
 *dwEffects*  
 判斷拖曳來源會允許在拖曳作業的效果。  
  
 *lpRectStartDrag*  
 定義實際開始拖曳的矩形的指標。 如需詳細資訊，請參閱接下來的＜備註＞一節。  
  
### <a name="return-value"></a>傳回值  
 DROPEFFECT 值。 如果是 DROPEFFECT_MOVE，應該移除原始的資料。  
  
### <a name="remarks"></a>備註  
 拖放作業不會立即啟動。 它會等到滑鼠游標離開所指定的矩形*lpRectStartDrag*或直到經過指定的毫秒數。 如果*lpRectStartDrag*是 NULL 時，矩形的大小為一個像素。  
  
 登錄機碼設定所指定的延遲時間。 您可以變更的延遲時間，藉由呼叫[CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring)或是[cwinapp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint)。 如果您未指定延遲時間，則會使用預設值是 200 毫秒。 拖曳延遲時間會儲存，如下所示：  
  
-   Windows NT 拖曳延遲時間會儲存在 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay。  
  
-   Windows 3.x 拖曳延遲時間會儲存在獲得。INI 檔案，底下的 [Windows} 一節。  
  
-   Windows 95/98 拖曳延遲時間會儲存在成交的快取版本。INI。  
  
 如需有關如何將拖曳的延遲資訊會儲存在登錄或。INI 檔案，請參閱[WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) Windows SDK 中。  
  
##  <a name="doverb"></a>  COleClientItem::DoVerb  
 呼叫`DoVerb`執行指定的動詞命令。  
  
```  
virtual BOOL DoVerb(
    LONG nVerb,  
    CView* pView,
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>參數  
 *nVerb*  
 指定要執行的動詞命令。 它可以包含下列其中一項：  
  
|值|意義|符號|  
|-----------|-------------|------------|  
|- 0|主動詞命令|OLEIVERB_PRIMARY|  
|- 1|次要的動詞命令|(無)|  
|- 1|顯示項目進行編輯|OLEIVERB_SHOW|  
|- 2|編輯在個別視窗中的項目|OLEIVERB_OPEN|  
|- 3|隱藏項目|OLEIVERB_HIDE|  
  
 -1 值通常是另一個動詞命令的別名。 如果不支援開啟編輯，-2 會有相同的效果，為-1。 其他值，請參閱[IOleObject::DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) Windows SDK 中。  
  
 *pView*  
 指向 [檢視] 視窗中;這用於伺服器就地啟用。 如果容器應用程式不允許就地啟用，此參數應該是 NULL。  
  
 *lpMsg*  
 造成要啟動的項目之訊息的指標。  
  
### <a name="return-value"></a>傳回值  
 非零值，如果此動詞命令成功執行;否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式會呼叫[Activate](#activate)成員函式來執行此動詞命令。 它也會攔截例外狀況，並向使用者顯示訊息方塊，如果其中一個會擲回。  
  
 如果主要動作是編輯，而且在指定為零*nVerb*允許編輯 OLE 項目啟動參數，伺服器應用程式。 如果容器應用程式支援就地啟用，請編輯可就地。 如果容器不支援就地啟用 （或如果已指定 Open 動詞），伺服器會啟動另一個視窗中，然後編輯可那里。 一般而言，當容器應用程式的使用者按兩下 OLE 項目中的主要動詞命令的值時，才*nVerb*參數會決定使用者可以採取哪些動作。 不過，如果伺服器只支援一個動作，它會該動作，不論使用哪些中指定值*nVerb*參數。  
  
##  <a name="draw"></a>  COleClientItem::Draw  
 呼叫此函式以指定使用指定的裝置內容的週框矩形內繪製 OLE 項目。  
  
```  
BOOL Draw(
    CDC* pDC,  
    LPCRECT lpBounds,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>參數  
 *pDC*  
 指標[CDC](../../mfc/reference/cdc-class.md)物件，用於繪製 OLE 項目。  
  
 *lpBounds*  
 指標[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或`RECT`結構，定義要在其中繪製 OLE 項目 （以邏輯單位，取決於裝置內容） 的周框。  
  
 *nDrawAspect*  
 指定的 OLE 部分項目，也就是它應該如何顯示。 如果*nDrawAspect*為-1，使用設定的最後一個層面[SetDrawAspect](#setdrawaspect)用。 如需有關可能的值，這個旗標的詳細資訊，請參閱[SetDrawAspect](#setdrawaspect)。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 函式可以使用 OLE 項目所建立的中繼檔表示法[OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw)成員函式`COleServerItem`。  
  
 通常您會使用`Draw`螢幕顯示，並傳遞做為螢幕裝置內容*pDC*。 在此情況下，您需要指定只有前兩個參數。  
  
 *LpBounds*參數會識別在目標裝置內容 （相對於其目前的對應模式） 的矩形。 轉譯可能牽涉到將圖片的比例，而且可以由容器應用程式來加諸的檢視，顯示的檢視和最後一個列印的影像之間進行調整。  
  
 如需詳細資訊，請參閱 < [iviewobject:: Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655) Windows SDK 中。  
  
##  <a name="getactiveview"></a>  COleClientItem::GetActiveView  
 傳回在其的項目是就地啟用的檢視。  
  
```  
CView* GetActiveView() const;  
```  
  
### <a name="return-value"></a>傳回值  
 位於檢視中，指標如果項目不是就地啟用，否則為 NULL。  
  
##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent  
 呼叫此函式以擷取 OLE 項目的大小。  
  
```  
BOOL GetCachedExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>參數  
 *lpSize*  
 指標`SIZE`結構或[CSize](../../atl-mfc-shared/reference/csize-class.md)會收到的大小資訊的物件。  
  
 *nDrawAspect*  
 指定要擷取其界限的 OLE 項目的外觀。 如需可能的值，請參閱[SetDrawAspect](#setdrawaspect)。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零0，表示 OLE 項目是空白。  
  
### <a name="remarks"></a>備註  
 此函式會提供相同的資訊[GetExtent](#getextent)。 不過，您可以呼叫`GetCachedExtent`取得在處理期間的範圍資訊的其他 OLE 處理常式，例如[OnChange](#onchange)。 維度是以 MM_HIMETRIC 單位。  
  
 這可能是因為`GetCachedExtent`會使用[IViewObject2](http://msdn.microsoft.com/library/windows/desktop/ms691318)介面，而不是使用[IOleObject](http://msdn.microsoft.com/library/windows/desktop/dd542709)介面，以取得此項目的範圍。 `IViewObject2` COM 物件會快取中的先前呼叫所使用的範圍資訊[iviewobject:: Draw](http://msdn.microsoft.com/library/windows/desktop/ms688655)。  
  
 如需詳細資訊，請參閱 < [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) Windows SDK 中。  
  
##  <a name="getclassid"></a>  COleClientItem::GetClassID  
 傳回的類別識別碼的項目至所指向的記憶體*pClassID*。  
  
```  
void GetClassID(CLSID* pClassID) const;  
```  
  
### <a name="parameters"></a>參數  
 *pClassID*  
 型別識別項的指標[CLSID](http://msdn.microsoft.com/library/windows/desktop/ms691424)擷取類別識別碼。 如需 CLSID 的資訊，請參閱 Windows SDK。  
  
### <a name="remarks"></a>備註  
 類別識別碼是 128 位元數字可唯一識別的應用程式的編輯項目。  
  
 如需詳細資訊，請參閱 < [IPersist::GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) Windows SDK 中。  
  
##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData  
 呼叫此函式可取得`COleDataSource`物件，包含會呼叫放到剪貼簿的所有資料[CopyToClipboard](#copytoclipboard)成員函式。  
  
```  
void GetClipboardData(
    COleDataSource* pDataSource,  
    BOOL bIncludeLink = FALSE,  
    LPPOINT lpOffset = NULL,  
    LPSIZE lpSize = NULL);
```  
  
### <a name="parameters"></a>參數  
 *pDataSource*  
 指標[COleDataSource](../../mfc/reference/coledatasource-class.md) OLE 項目中會包含資料的物件。  
  
 *bIncludeLink*  
 如果連結的資料應包含;，則為 TRUE。否則為 FALSE。  
  
 *lpOffset*  
 滑鼠資料指標原點的像素為單位的物件的位移。  
  
 *lpSize*  
 像素為單位的物件大小。  
  
### <a name="remarks"></a>備註  
 `GetClipboardData` 預設實作會呼叫[ongetclipboarddata 而自動發生](#ongetclipboarddata)。 覆寫`OnGetClipboardData`只有當您想要提供的資料格式，除了所提供的`CopyToClipboard`。 將放在這些格式`COleDataSource`之前或之後呼叫的物件`CopyToClipboard`，然後將傳遞`COleDataSource`物件[COleDataSource::SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard)函式。 比方說，如果您想在剪貼簿上隨附其容器文件中的 OLE 項目的位置時，您會定義您自己的格式來傳遞該資訊並將它放在`COleDataSource`再呼叫`CopyToClipboard`。  
  
##  <a name="getdocument"></a>  COleClientItem::GetDocument  
 呼叫此函式可取得包含 OLE 項目的文件的指標。  
  
```  
COleDocument* GetDocument() const;  
```  
  
### <a name="return-value"></a>傳回值  
 文件，其中包含 OLE 項目指標。 如果項目不是文件的一部分，則為 NULL。  
  
### <a name="remarks"></a>備註  
 這個指標可讓您存取`COleDocument`物件做為引數傳遞`COleClientItem`建構函式。  
  
##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect  
 呼叫`GetDrawAspect`成員函式來判斷目前 「 外觀 」 或檢視中的，項目。  
  
```  
DVASPECT GetDrawAspect() const;  
```  
  
### <a name="return-value"></a>傳回值  
 DVASPECT 列舉，其值會列在參考中的值[SetDrawAspect](#setdrawaspect)。  
  
### <a name="remarks"></a>備註  
 部分指定的項目要呈現的是如何。  
  
##  <a name="getextent"></a>  COleClientItem::GetExtent  
 呼叫此函式以擷取 OLE 項目的大小。  
  
```  
BOOL GetExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```  
  
### <a name="parameters"></a>參數  
 *lpSize*  
 指標`SIZE`結構或`CSize`會收到的大小資訊的物件。  
  
 *nDrawAspect*  
 指定要擷取其界限的 OLE 項目的外觀。 如需可能的值，請參閱[SetDrawAspect](#setdrawaspect)。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零0，表示 OLE 項目是空白。  
  
### <a name="remarks"></a>備註  
 如果伺服器應用程式使用 Microsoft Foundation 類別庫所撰寫，此函式會導致[OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent)成員函式對應`COleServerItem`要呼叫的物件。 請注意，擷取的大小可能與上次所設定的大小不同[SetExtent](#setextent)成員函式; 所指定的大小`SetExtent`會被視為建議。 維度是以 MM_HIMETRIC 單位。  
  
> [!NOTE]
>  請勿呼叫`GetExtent`OLE 處理常式中，在處理這類[OnChange](#onchange)。 呼叫[GetCachedExtent](#getcachedextent)改。  
  
 如需詳細資訊，請參閱 < [IOleObject::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms692325) Windows SDK 中。  
  
##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry  
 呼叫此成員函式可擷取特定的 CLSID 的伺服器相關聯的圖示資源控制代碼。  
  
```  
HICON GetIconFromRegistry() const;  
  
static HICON GetIconFromRegistry(CLSID& clsid);
```  
  
### <a name="parameters"></a>參數  
 *clsid*  
 伺服器與圖示相關的 CLSID 的參考。  
  
### <a name="return-value"></a>傳回值  
 有效的圖示資源控制代碼，或如果找不到伺服器 」 圖示或預設的圖示，則為 NULL。  
  
### <a name="remarks"></a>備註  
 此成員函式不會啟動伺服器，或即使伺服器已在執行中，以動態方式取得圖示。 相反地，此成員函式會開啟伺服器的可執行映像，並擷取與已註冊，與伺服器相關聯的靜態圖示。  
  
##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile  
 擷取的中繼檔，用於繪製項目的圖示。  
  
```  
HGLOBAL GetIconicMetafile();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則之中繼檔控制代碼否則為 NULL。  
  
### <a name="remarks"></a>備註  
 如果沒有目前的圖示，則會傳回預設的圖示。 這由 MFC/OLE 對話方塊會自動呼叫，並通常不會直接呼叫。  
  
 此函式也會呼叫[SetIconicMetafile](#seticonicmetafile)快取之中繼檔，以供稍後使用。  
  
##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow  
 呼叫`GetInPlaceWindow`成員函式來進行就地編輯的視窗中開啟此項目取得的指標。  
  
```  
CWnd* GetInPlaceWindow();
```  
  
### <a name="return-value"></a>傳回值  
 指向的項目就地編輯視窗;為 NULL 如果項目不在作用中或它的伺服器無法使用。  
  
### <a name="remarks"></a>備註  
 只會針對就地啟用作用中的項目，就應該呼叫此函式。  
  
##  <a name="getitemstate"></a>  COleClientItem::GetItemState  
 呼叫此函式可取得 OLE 項目的目前狀態。  
  
```  
UINT GetItemState() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`COleClientItem::ItemState`列舉值，這個值可以是下列其中之一： `emptyState`， `loadedState`， `openState`， `activeState`， `activeUIState`。 如需這些狀態的資訊，請參閱文章[容器： 用戶端項目狀態](../../mfc/containers-client-item-states.md)。  
  
### <a name="remarks"></a>備註  
 若要收到 OLE 項目的狀態變更時，使用[OnChange](#onchange)成員函式。  
  
 如需詳細資訊，請參閱文章[容器： 用戶端項目狀態](../../mfc/containers-client-item-states.md)。  
  
##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus  
 傳回最後一個 OLE 作業的狀態碼。  
  
```  
SCODE GetLastStatus() const;  
```  
  
### <a name="return-value"></a>傳回值  
 SCODE 值。  
  
### <a name="remarks"></a>備註  
 成員函式會傳回 BOOL 值為 FALSE 或其他成員函式會傳回 NULL，`GetLastStatus`傳回更詳細的失敗資訊。 請注意，大部分的 OLE 成員函式會擲回例外狀況的更嚴重的錯誤。 在 SCODE 解譯的特定資訊取決於基礎 OLE 呼叫最後傳回 SCODE 值。  
  
 如需有關 SCODE 的詳細資訊，請參閱[錯誤碼的結構 COM](http://msdn.microsoft.com/library/windows/desktop/ms690088) Windows SDK 文件。  
  
##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions  
 呼叫此函式可取得 OLE 項目連結更新選項的目前值。  
  
```  
OLEUPDATE GetLinkUpdateOptions();
```  
  
### <a name="return-value"></a>傳回值  
 下列其中一個值：  
  
- OLEUPDATE_ALWAYS 更新連結的項目，可能的話。 此選項在 [連結] 對話方塊中支援自動的連結更新選項按鈕。  
  
- OLEUPDATE_ONCALL 更新連結的項目，只能在從容器應用程式的要求上 (當[UpdateLink](#updatelink)呼叫成員函式)。 此選項會支援手動連結更新選項按鈕連結 對話方塊中。  
  
### <a name="remarks"></a>備註  
 這是進階的作業。  
  
 會自動呼叫此函數[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)類別。  
  
 如需詳細資訊，請參閱 < [IOleLink::GetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680100) Windows SDK 中。  
  
##  <a name="gettype"></a>  COleClientItem::GetType  
 呼叫此函式可判斷是否 OLE 項目是內嵌或連結，或靜態。  
  
```  
OLE_OBJTYPE GetType() const;  
```  
  
### <a name="return-value"></a>傳回值  
 不帶正負號的整數，下列值之一：  
  
- OT_LINK OLE 項目是一個連結。  
  
- 內嵌 OT_EMBEDDED OLE 項目。  
  
- OT_STATIC OLE 項目是靜態，也就是只包含呈現資料，不是原生資料，並因此無法編輯。  
  
##  <a name="getusertype"></a>  COleClientItem::GetUserType  
 呼叫此函式可取得使用者可見的字串描述 OLE 項目類型，例如 「 Word 文件。 」  
  
```  
void GetUserType(
    USERCLASSTYPE nUserClassType,  
    CString& rString);
```  
  
### <a name="parameters"></a>參數  
 *nUserClassType*  
 值，指出所需的變體的描述 OLE 項目類型的字串。 這可能會有下列值之一：  
  
- USERCLASSTYPE_FULL 完整型別顯示給使用者的名稱。  
  
- USERCLASSTYPE_SHORT 的簡短名稱 （最多 15 個字元） 快顯功能表和 [編輯連結] 對話方塊中使用。  
  
- USERCLASSTYPE_APPNAME 服務類別的應用程式名稱。  
  
 *rString*  
 參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)描述 OLE 項目類型的字串是要傳回的物件。  
  
### <a name="remarks"></a>備註  
 這通常是系統註冊資料庫中的項目。  
  
 如果要求，但無法使用的完整類型名稱，會改用的簡短名稱。 如果沒有 OLE 項目類型的項目是在系統註冊資料庫，或是如果沒有任何註冊的 OLE 項目類型的使用者型別，則使用者類型目前儲存在會使用 OLE 項目。 如果該使用者的類型名稱是空字串，則會使用 「 未知的物件 」。  
  
 如需詳細資訊，請參閱 < [IOleObject::GetUserType](http://msdn.microsoft.com/library/windows/desktop/ms688643) Windows SDK 中。  
  
##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive  
 呼叫此函式來查看 OLE 項目是否就地啟用作用中。  
  
```  
BOOL IsInPlaceActive() const;  
```  
  
### <a name="return-value"></a>傳回值  
 OLE 項目就地啟用作用中; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 它會執行不同的邏輯取決於是否正在就地編輯項目。 函式會檢查目前的項目狀態是否為相等`activeState`或`activeUIState`。  
  
##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate  
 呼叫此函式，檢查 OLE 項目是否為最新狀態。  
  
```  
BOOL IsLinkUpToDate() const;  
```  
  
### <a name="return-value"></a>傳回值  
 OLE 項目最新狀態; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 連結的項目可以是過期如果已經更新其來源文件。 內嵌項目，其中包含在其中的連結可以同樣地會變成過期。 此函式會遞迴檢查的 OLE 項目。 請注意，判斷是否已過期的 OLE 項目可能耗費的資源實際上正在執行更新。  
  
 這稱為自動[COleLinksDialog](../../mfc/reference/colelinksdialog-class.md)實作。  
  
 如需詳細資訊，請參閱 < [IOleObject::IsUpToDate](http://msdn.microsoft.com/library/windows/desktop/ms686624) Windows SDK 中。  
  
##  <a name="ismodified"></a>  COleClientItem::IsModified  
 呼叫此函式，以查看是否 OLE 項目已經變更 （修改自上次儲存後）。  
  
```  
BOOL IsModified() const;  
```  
  
### <a name="return-value"></a>傳回值  
 OLE 項目已變更; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [IPersistStorage::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) Windows SDK 中。  
  
##  <a name="isopen"></a>  COleClientItem::IsOpen  
 呼叫此函式，請參閱 OLE 項目是否處於開啟狀態;也就是在個別視窗中執行的伺服器應用程式的執行個體中開啟。  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>傳回值  
 OLE 項目開啟; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 它用來判斷何時要繪製具有影線圖樣的物件。 開啟的物件應該在物件上繪製以規劃圖樣。 您可以使用[CRectTracker](../../mfc/reference/crecttracker-class.md)物件來完成這項作業。  
  
##  <a name="isrunning"></a>  COleClientItem::IsRunning  
 呼叫此函式，以查看是否正在執行的 OLE 項目;也就是項目是否已載入並執行伺服器應用程式中。  
  
```  
BOOL IsRunning() const;  
```  
  
### <a name="return-value"></a>傳回值  
 執行 OLE 項目; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [OleIsRunning](http://msdn.microsoft.com/library/windows/desktop/ms688705) Windows SDK 中。  
  
##  <a name="onactivate"></a>  COleClientItem::OnActivate  
 由架構呼叫以通知項目，它只是已啟動就緒。  
  
```  
virtual void OnActivate();
```  
  
### <a name="remarks"></a>備註  
 請注意，此函式會呼叫以指示伺服器正在執行，不是用來表示其使用者介面已安裝為不同的容器應用程式中。 此時，該物件沒有作用中的使用者介面 (不是`activeUIState`)。 它尚未安裝它的功能表或工具列。 [OnActivateUI](#onactivateui)當發生這種情況時，呼叫成員函式。  
  
 預設實作會呼叫[OnChange](#onchange) OLE_CHANGEDSTATE 做為參數具有成員函式。 覆寫這個函式來執行自訂處理的項目時就地啟用作用中。  
  
##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI  
 這個架構會呼叫`OnActivateUI`當物件已進入現用 UI 狀態。  
  
```  
virtual void OnActivateUI();
```  
  
### <a name="remarks"></a>備註  
 物件現在已安裝其工具列和功能表。  
  
 預設實作會記住伺服器的 HWND，供稍後`GetServerWindow`呼叫。  
  
##  <a name="onchange"></a>  COleClientItem::OnChange  
 當使用者修改、 儲存或關閉 OLE 項目時，由架構呼叫。  
  
```  
virtual void OnChange(
    OLE_NOTIFICATION nCode,  
    DWORD dwParam);
```  
  
### <a name="parameters"></a>參數  
 *則 nCode*  
 伺服器的原因變更此項目。 它可以包含下列值之一：  
  
- OLE_CHANGED OLE 項目外觀已變更。  
  
- 已儲存 OLE_SAVED OLE 項目。  
  
- 已關閉 OLE_CLOSED OLE 項目。  
  
- OLE_CHANGED_STATE OLE 項目已變更是從某個狀態到另一個。  
  
 *dwParam*  
 如果*則 nCode* OLE_SAVED 或 OLE_CLOSED，未使用此參數。 如果*則 nCode*是 OLE_CHANGED，這個參數指定的 OLE 項目已變更外觀。 如需可能的值，請參閱*dwParam*的參數[COleClientItem::Draw](#draw)。 如果*則 nCode*是 OLE_CHANGED_STATE，這個參數是`COleClientItem::ItemState`列舉值，並說明輸入的狀態。 它可以有下列值之一： `emptyState`， `loadedState`， `openState`， `activeState`，或`activeUIState`。  
  
### <a name="remarks"></a>備註  
 (如果使用 Microsoft Foundation 類別程式庫來撰寫伺服器應用程式，以回應呼叫此函式`Notify`成員函式`COleServerDoc`或`COleServerItem`。)預設實作將容器文件標示為已修改*則 nCode* OLE_CHANGED 或 OLE_SAVED。  
  
 OLE_CHANGED_STATE，目前的狀態傳回從[GetItemState](#getitemstate)仍會為舊的狀態，表示目前在此狀態變更之前的狀態。  
  
 覆寫此函式以回應 OLE 項目的狀態變更。 通常您會藉由讓失效的區域中顯示的項目更新項目的外觀。 在開始您的覆寫呼叫基底類別實作。  
  
##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition  
 由架構呼叫以通知 OLE 項目的寬度變更在就地啟用期間的容器。  
  
```  
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```  
  
### <a name="parameters"></a>參數  
 *rectPos*  
 表示項目的位置，相對於容器應用程式的用戶端區域。  
  
### <a name="return-value"></a>傳回值  
 已成功變更項目的位置; 如果為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 預設實作會決定新的 OLE 項目並呼叫可見的矩形[SetItemRects](#setitemrects)含有新值。 預設實作會計算項目的可見的矩形，並將該資訊傳遞至伺服器。  
  
 覆寫此函式以套用至調整大小/移動作業的特殊規則。 如果應用程式寫入在 MFC 中，這個呼叫會產生，因為伺服器稱為[COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange)。  
  
##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate  
 當 OLE 項目轉換從就地使用中狀態時，由架構呼叫 ( `activeState`) 成已載入的狀態，這表示它已停用就地啟用後。  
  
```  
virtual void OnDeactivate();
```  
  
### <a name="remarks"></a>備註  
 請注意，呼叫此函式表示的 OLE 項目關閉時，不從容器應用程式已移除其使用者介面。 當發生這種情況[OnDeactivateUI](#ondeactivateui)呼叫成員函式。  
  
 預設實作會呼叫[OnChange](#onchange) OLE_CHANGEDSTATE 做為參數具有成員函式。 覆寫這個函式來執行自訂處理，當停用就地使用中的項目。 比方說，如果您在容器應用程式中支援復原命令，您可以覆寫此函式以捨棄復原狀態，指出上次 OLE 項目上執行的作業無法復原之後的項目已停用。  
  
##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo  
 當使用者叫用 [復原] 命令，在啟動就地 OLE 項目之後，由架構呼叫。  
  
```  
virtual void OnDeactivateAndUndo();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫[DeactivateUI](#deactivateui)停用伺服器的使用者介面。 如果您要實作應用程式容器中的 [復原] 命令，請覆寫這個函式。 在您的覆寫呼叫函式的基底類別版本，然後復原您的應用程式中執行的最後一個命令。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceSite::DeactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms683743) Windows SDK 中。  
  
##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI  
 當使用者停用就地啟動項目時呼叫。  
  
```  
virtual void OnDeactivateUI(BOOL bUndoable);
```  
  
### <a name="parameters"></a>參數  
 *bUndoable*  
 指定是否可復原的編輯變更。  
  
### <a name="remarks"></a>備註  
 此函式會還原為其原始狀態，隱藏任何功能表和其他控制項所建立的就地啟用容器應用程式的使用者介面。  
  
 如果*bUndoable*為 FALSE 時，容器應停用 [復原] 命令，實際上並捨棄復原容器的狀態，因為它會指出伺服器所執行的最後一個作業是無法復原。  
  
##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState  
 當使用者執行的動作，編輯 OLE 項目時捨棄復原狀態，由架構呼叫。  
  
```  
virtual void OnDiscardUndoState();
```  
  
### <a name="remarks"></a>備註  
 預設實作不做任何動作。 如果您要實作應用程式容器中的 [復原] 命令，請覆寫這個函式。 在您的覆寫，捨棄容器應用程式的復原狀態。  
  
 如果伺服器使用 Microsoft Foundation 類別庫所撰寫，伺服器可能會導致呼叫藉由呼叫這個函式[COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate)。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceSite::DiscardUndoState](http://msdn.microsoft.com/library/windows/desktop/ms688642) Windows SDK 中。  
  
##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData  
 由架構呼叫以取得`COleDataSource`物件，其中包含的所有資料，會放入剪貼簿上呼叫[CopyToClipboard](#copytoclipboard)或[DoDragDrop](#dodragdrop)成員函式。  
  
```  
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,  
    LPPOINT lpOffset,  
    LPSIZE lpSize);
```  
  
### <a name="parameters"></a>參數  
 *bIncludeLink*  
 將此設為 true 連結資料應該複製到剪貼簿。 將此設為 false 您的伺服器應用程式不支援連結。  
  
 *lpOffset*  
 原點的像素為單位的物件的指標，將滑鼠游標的位移。  
  
 *lpSize*  
 像素為單位的物件大小的指標。  
  
### <a name="return-value"></a>傳回值  
 指標[COleDataSource](../../mfc/reference/coledatasource-class.md)物件，其中包含剪貼簿的資料。  
  
### <a name="remarks"></a>備註  
 此函式的預設實作會呼叫[GetClipboardData](#getclipboarddata)。  
  
##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect  
 這個架構會呼叫`OnGetClipRect`就地取得正在編輯之項目的裁剪方框座標的成員函式。  
  
```  
virtual void OnGetClipRect(CRect& rClipRect);
```  
  
### <a name="parameters"></a>參數  
 *rClipRect*  
 類別的物件指標[CRect](../../atl-mfc-shared/reference/crect-class.md)將保留項目的裁剪矩形座標。  
  
### <a name="remarks"></a>備註  
 座標是像素為單位，相對於容器應用程式視窗的用戶端區域。  
  
 預設實作只會傳回在其上檢視項目就地啟用作用中的用戶端矩形。  
  
##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition  
 這個架構會呼叫`OnGetItemPosition`成員函式，以就地取得正在編輯之項目的座標。  
  
```  
virtual void OnGetItemPosition(CRect& rPosition);
```  
  
### <a name="parameters"></a>參數  
 *rPosition*  
 若要參考[CRect](../../atl-mfc-shared/reference/crect-class.md)物件，包含項目的位置的座標。  
  
### <a name="remarks"></a>備註  
 座標是像素為單位，相對於容器應用程式視窗的用戶端區域。  
  
 此函式的預設實作不做任何動作。 支援就地編輯的應用程式需要它的實作。  
  
##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext  
 項目就地啟動時由架構呼叫。  
  
```  
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,  
    CFrameWnd** ppDocFrame,  
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```  
  
### <a name="parameters"></a>參數  
 *ppMainFrame*  
 主框架視窗的指標的指標。  
  
 *ppDocFrame*  
 文件框架視窗的指標的指標。  
  
 *lpFrameInfo*  
 指標[OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737)結構，將會收到框架視窗的資訊。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式用來擷取 OLE 項目的父視窗的相關資訊。  
  
 如果容器是 MDI 應用程式，預設實作會傳回的指標[CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md)物件中*ppMainFrame*和使用中的物件指標[CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)物件中*ppDocFrame*。 如果容器為 SDI 應用程式，預設實作會傳回的指標[CFrameWnd](../../mfc/reference/cframewnd-class.md)物件中*ppMainFrame* ，並傳回在 NULL *ppDocFrame*。 預設實作也會填入的成員清單*lpFrameInfo*。  
  
 預設實作不會不符合您的應用程式; 時，才會覆寫這個函式例如，如果您的應用程式有不同於 SDI 或 MDI 使用者介面典範。 這是一種進階可覆寫。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceSite::GetWindowContext](http://msdn.microsoft.com/library/windows/desktop/ms694366)並[OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) Windows SDK 中的結構。  
  
##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus  
 在就地啟用容器應用程式的功能表插入空的功能表時由架構呼叫。  
  
```  
virtual void OnInsertMenus(
    CMenu* pMenuShared,  
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```  
  
### <a name="parameters"></a>參數  
 *pMenuShared*  
 指向空的功能表。  
  
 *lpMenuWidths*  
 指向陣列的六個 LONG 值，表示了多少功能表位於每個群組的下列功能表： 檔案、 編輯、 容器物件，視窗中，說明。 容器應用程式會負責檔、 容器和視窗 功能表群組，對應至 0、 2 和 4，這個陣列的項目。  
  
### <a name="remarks"></a>備註  
 此功能表會再傳遞到伺服器，將插入它自己的功能表，建立複合的功能表。 可以重複呼叫此函式，才能建置數個複合的功能表。  
  
 預設實作中插入*pMenuShared*就地容器功能表; 也就是檔案、 容器和視窗的功能表群組。 [CDocTemplate::SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo)用來設定這個功能表資源。 預設實作也會將適當的值指派給 0、 2 和 4 中的項目*lpMenuWidths*，取決於功能表資源。 覆寫的預設實作不適合您的應用程式; 此函式比方說，如果您的應用程式不會使用文件範本關聯的文件類型的資源。 如果您覆寫這個函式，您也會覆寫[OnSetMenu](#onsetmenu)並[OnRemoveMenus](#onremovemenus)。 這是一種進階可覆寫。  
  
 如需詳細資訊，請參閱 < [ioleinplaceframe:: Insertmenus](http://msdn.microsoft.com/library/windows/desktop/ms683987) Windows SDK 中。  
  
##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus  
 由架構呼叫以就地啟用結束時，從指定的組合功能表移除容器的功能表。  
  
```  
virtual void OnRemoveMenus(CMenu* pMenuShared);
```  
  
### <a name="parameters"></a>參數  
 *pMenuShared*  
 藉由呼叫建構組合功能表會指向[OnInsertMenus](#oninsertmenus)成員函式。  
  
### <a name="remarks"></a>備註  
 預設實作會移除*pMenuShared* ，不是就地容器功能表、 檔案、 容器和視窗的功能表群組。 覆寫的預設實作不適合您的應用程式; 此函式比方說，如果您的應用程式不會使用文件範本關聯的文件類型的資源。 如果您覆寫這個函式，您應該可能覆寫[OnInsertMenus](#oninsertmenus)並[OnSetMenu](#onsetmenu)以及。 這是一種進階可覆寫。  
  
 在子功能表*pMenuShared*可能會共用由一個以上的複合 功能表中，如果伺服器已重複呼叫`OnInsertMenus`。 因此您應該刪除任何子功能表中的覆寫`OnRemoveMenus`; 您應該僅卸離。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceFrame::RemoveMenus](http://msdn.microsoft.com/library/windows/desktop/ms688685) Windows SDK 中。  
  
##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy  
 由架構呼叫以捲動 OLE 項目，以從伺服器回應要求。  
  
```  
virtual BOOL OnScrollBy(CSize sizeExtent);
```  
  
### <a name="parameters"></a>參數  
 *sizeExtent*  
 指定距離，單位為像素的 x 和 y 方向的捲動。  
  
### <a name="return-value"></a>傳回值  
 如果此項目已捲動; 非零值0，表示此項目可能不會捲動。  
  
### <a name="remarks"></a>備註  
 比方說，如果 OLE 項目是部分可見，而且使用者將移至外部可見的區域執行就地編輯時，呼叫此函式會將資料指標保持可見。 預設實作不做任何動作。 覆寫此函式以指定的數量來捲動項目。 請注意結果向下捲動，可以變更可見部分 OLE 項目。 呼叫[SetItemRects](#setitemrects)更新的項目可見的矩形。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceSite::Scroll](http://msdn.microsoft.com/library/windows/desktop/ms690291) Windows SDK 中。  
  
##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu  
 由架構呼叫兩次時就地啟用開始和結束;若要安裝 [複合] 功能表和第二次第一次 (使用*holemenu*等於 NULL) 將它移除。  
  
```  
virtual void OnSetMenu(
    CMenu* pMenuShared,  
    HOLEMENU holemenu,  
    HWND hwndActiveObject);
```  
  
### <a name="parameters"></a>參數  
 *pMenuShared*  
 藉由呼叫建構組合功能表指向[OnInsertMenus](#oninsertmenus)成員函式和`InsertMenu`函式。  
  
 *holemenu*  
 所傳回的功能表描述元的控制代碼`OleCreateMenuDescriptor`函式，或如果是要移除的分派的程式碼，則為 NULL。  
  
 *hwndActiveObject*  
 OLE 項目的 [編輯] 視窗的控制代碼。 這是會接收來自 OLE 的編輯的命令視窗。  
  
### <a name="remarks"></a>備註  
 預設實作會安裝或移除組合功能表，然後呼叫[OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831)函式來安裝或移除的分派的程式碼。 如果預設實作不適合您的應用程式，請覆寫這個函式。 如果您覆寫這個函式，您應該可能覆寫[OnInsertMenus](#oninsertmenus)並[OnRemoveMenus](#onremovemenus)以及。 這是一種進階可覆寫。  
  
 如需詳細資訊，請參閱 < [OleCreateMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms691415)， [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831)，並[ioleinplaceframe:: Setmenu](http://msdn.microsoft.com/library/windows/desktop/ms693713) Windows SDK 中。  
  
##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars  
 由架構呼叫以顯示和隱藏容器應用程式的控制列。  
  
```  
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,  
    BOOL bShow);
```  
  
### <a name="parameters"></a>參數  
 *pFrameWnd*  
 容器應用程式的框架視窗的指標。 這可以是主框架視窗或 MDI 子視窗。  
  
 *bShow*  
 指定是否要顯示或隱藏的控制列。  
  
### <a name="return-value"></a>傳回值  
 如果函式呼叫會造成控制列的狀態; 中的變更，非零值。0 在呼叫並不會變更，則*pFrameWnd*未指向容器的框架視窗。  
  
### <a name="remarks"></a>備註  
 如果控制列已在所指定的狀態，此函數會傳回 0 *bShow。* 這會發生，例如，如果隱藏的控制列和*bShow*為 FALSE。  
  
 預設實作會移除最上層框架視窗中的工具列。  
  
##  <a name="onshowitem"></a>  COleClientItem::OnShowItem  
 由架構呼叫以顯示 OLE 項目，讓它完全顯示在編輯期間。  
  
```  
virtual void OnShowItem();
```  
  
### <a name="remarks"></a>備註  
 容器應用程式支援內嵌項目的連結時，會使用 (亦即，如果您有衍生您的文件類別，從[COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md))。 在就地啟用，或當 OLE 項目會連結來源，而且使用者想對其進行編輯期間，會呼叫此函式。 預設實作會啟動在容器文件上的第一個檢視。 覆寫此函式可捲動文件，讓 OLE 項目為可見。  
  
##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle  
 若要更新框架視窗的標題列的就地啟用期間，由架構呼叫。  
  
```  
virtual BOOL OnUpdateFrameTitle();
```  
  
### <a name="return-value"></a>傳回值  
 如果此為非零的函式已成功更新框架標題，否則為零。  
  
### <a name="remarks"></a>備註  
 預設實作不會變更的框架視窗標題。 覆寫這個函式，如果您想要不同的畫面格標題您的應用程式，例如"*伺服器應用程式* - *項目*中*docname*」 （例如"MicrosoftExcel-在報表中的試算表。文件 」）。 這是一種進階可覆寫。  
  
##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo  
 呼叫此函式以重新啟用 OLE 項目，並復原最後一個期間就地編輯由使用者所執行的作業。  
  
```  
BOOL ReactivateAndUndo();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果您的容器應用程式支援 [復原] 命令，呼叫此函式，如果使用者選擇 [復原] 命令之後立即停用 OLE 項目。  
  
 如果使用 Microsoft Foundation 類別程式庫撰寫伺服器應用程式，此函式會導致伺服器呼叫[COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo)。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceObject::ReactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms691372) Windows SDK 中。  
  
##  <a name="release"></a>  COleClientItem::Release  
 呼叫此函式來清除 OLE 項目所使用的資源。  
  
```  
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```  
  
### <a name="parameters"></a>參數  
 *dwCloseOption*  
 旗標，指定已載入狀態恢復時，OLE 項目儲存在哪些情況之下。 如需可能值的清單，請參閱 < [COleClientItem::Close](#close)。  
  
### <a name="remarks"></a>備註  
 `Release` 會呼叫`COleClientItem`解構函式。  
  
 如需詳細資訊，請參閱 < [iunknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) Windows SDK 中。  
  
##  <a name="reload"></a>  COleClientItem::Reload  
 關閉並重新載入的項目。  
  
```  
BOOL Reload();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 呼叫`Reload`之後啟用項目為另一種類型的項目，藉由呼叫的函式[ActivateAs](#activateas)。  
  
##  <a name="run"></a>  COleClientItem::Run  
 執行此項目相關聯的應用程式。  
  
```  
void Run();
```  
  
### <a name="remarks"></a>備註  
 呼叫`Run`成員函式來啟動伺服器應用程式，然後再啟動項目。 這會自動進行[Activate](#activate)並[DoVerb](#doverb)，因此通常不需要呼叫此函式。 呼叫此函式，視需要來執行伺服器，才能設定項目屬性，例如[SetExtent](#setextent)，然後再執行[DoVerb](#doverb)。  
  
##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect  
 呼叫`SetDrawAspect`成員函式設定的 「 外觀 」 或項目的檢視。  
  
```  
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```  
  
### <a name="parameters"></a>參數  
 *nDrawAspect*  
 從 DVASPECT 列舉的值。 這個參數的值可以是下列其中一個：  
  
- DVASPECT_CONTENT 項目表示的方式，它可以顯示為其容器內部的內嵌物件。  
  
- 「 縮圖 」 表示法呈現 DVASPECT_THUMBNAIL 項目，以便它可以顯示在瀏覽工具。  
  
- DVASPECT_ICON 項目是以圖示表示。  
  
- DVASPECT_DOCPRINT 項目被表示，如同它已列印使用從 [檔案] 功能表的 [列印] 命令。  
  
### <a name="remarks"></a>備註  
 層面，可讓您指定所要呈現的項目有何[繪製](#draw)時的預設值為該函式*nDrawAspect*使用引數。  
  
 藉由變更圖示 （和其他對話方塊，直接呼叫 [變更圖示] 對話方塊） 會自動呼叫此函式來啟用由使用者要求時的圖示顯示外觀。  
  
##  <a name="setextent"></a>  COleClientItem::SetExtent  
 呼叫此函式可指定多少空間可供 OLE 項目。  
  
```  
void SetExtent(
    const CSize& size,  
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```  
  
### <a name="parameters"></a>參數  
 *size*  
 A [CSize](../../atl-mfc-shared/reference/csize-class.md)物件，其中包含的大小資訊。  
  
 *nDrawAspect*  
 指定其界限是要設定的 OLE 項目的外觀。 如需可能的值，請參閱[SetDrawAspect](#setdrawaspect)。  
  
### <a name="remarks"></a>備註  
 如果伺服器應用程式使用 Microsoft Foundation 類別庫所撰寫，這會導致[OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent)成員函式對應`COleServerItem`要呼叫的物件。 OLE 項目則可據以調整它的顯示畫面。 MM_HIMETRIC 單位必須是維度。 當使用者調整 OLE 項目，或如果您支援某種形式的配置交涉，請呼叫此函式。  
  
 如需詳細資訊，請參閱 < [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330) Windows SDK 中。  
  
##  <a name="sethostnames"></a>  COleClientItem::SetHostNames  
 呼叫此函式可指定容器應用程式的名稱，以及內嵌 OLE 項目容器的名稱。  
  
```  
void SetHostNames(
    LPCTSTR lpszHost,  
    LPCTSTR lpszHostObj);
```  
  
### <a name="parameters"></a>參數  
 *lpszHost*  
 使用者可見的容器應用程式名稱的指標。  
  
 *lpszHostObj*  
 包含 OLE 項目容器的識別字串的指標。  
  
### <a name="remarks"></a>備註  
 如果伺服器應用程式使用 Microsoft Foundation 類別庫所撰寫，此函式會呼叫[OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames)成員函式`COleServerDoc`文件，其中包含 OLE 項目。 當正在編輯 OLE 項目時，這項資訊可在視窗標題。 載入容器文件時，每次架構呼叫此函式的文件中的所有 OLE 項目。 `SetHostNames` 是只適用於內嵌的項目。 您不需要呼叫此函式每次啟動內嵌的 OLE 項目進行編輯。  
  
 這也稱為自動應用程式名稱與文件名稱載入物件時，或在不同的名稱下儲存檔案時。 因此，不會直接呼叫此函式通常會需要。  
  
 如需詳細資訊，請參閱 < [IOleObject::SetHostNames](http://msdn.microsoft.com/library/windows/desktop/ms680642) Windows SDK 中。  
  
##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile  
 會快取之中繼檔，用於繪製項目的圖示。  
  
```  
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```  
  
### <a name="parameters"></a>參數  
 *hMetaPict*  
 用於繪製的項目圖示的中繼檔控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 使用[GetIconicMetafile](#geticonicmetafile)来擷取之中繼檔。  
  
 *HMetaPict*參數會複製到項目; 因此， *hMetaPict*必須由呼叫端釋放。  
  
##  <a name="setitemrects"></a>  COleClientItem::SetItemRects  
 呼叫此函式可設定的周框或 OLE 項目的可見的矩形。  
  
```  
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,  
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>參數  
 *lprcPosRect*  
 包含相對於其父視窗，在工作區座標中的 OLE 項目界限的矩形的指標。  
  
 *lprcClipRect*  
 指標，該矩形包含相對於其父視窗，在工作區座標中的 OLE 項目之可見區域的界限。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫此函式[OnChangeItemPosition](#onchangeitemposition)成員函式。 位置的可見部分 OLE 項目變更時，您應該呼叫此函式。 這通常表示它呼叫從您的檢視[OnSize](../../mfc/reference/cwnd-class.md#onsize)並[OnScrollBy](../../mfc/reference/cview-class.md#onscrollby)成員函式。  
  
 如需詳細資訊，請參閱 < [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767) Windows SDK 中。  
  
##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions  
 呼叫此函式來設定所指定的連結項目的簡報的連結更新選項。  
  
```  
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```  
  
### <a name="parameters"></a>參數  
 *dwUpdateOpt*  
 此項目的連結更新選項的值。 此值必須是下列其中一項：  
  
- OLEUPDATE_ALWAYS 更新連結的項目，可能的話。 此選項在 [連結] 對話方塊中支援自動的連結更新選項按鈕。  
  
- OLEUPDATE_ONCALL 更新連結的項目，只能在從容器應用程式的要求上 (當[UpdateLink](#updatelink)呼叫成員函式)。 此選項會支援手動連結更新選項按鈕連結 對話方塊中。  
  
### <a name="remarks"></a>備註  
 一般而言，您不應該變更連結 對話方塊中的使用者所選擇的更新選項。  
  
 如需詳細資訊，請參閱 < [IOleLink::SetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680120) Windows SDK 中。  
  
##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice  
 呼叫此函式來變更此項目之列印目標裝置。  
  
```  
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);  
BOOL SetPrintDevice(const PRINTDLG* ppd);
```  
  
### <a name="parameters"></a>參數  
 *ptd*  
 指標[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)資料結構，其中包含新的列印目標裝置的相關資訊。 可以是 NULL。  
  
 *ppd*  
 指標[PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646940)資料結構，其中包含新的列印目標裝置的相關資訊。 可以是 NULL。  
  
### <a name="return-value"></a>傳回值  
 如果函式時成功則為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式會更新項目之列印目標裝置，但不會重新整理簡報快取。 若要更新的簡報快取中的項目，請呼叫[UpdateLink](#updatelink)。  
  
 此函式的引數包含 OLE 系統用來識別目標裝置的資訊。 `PRINTDLG`結構包含 Windows 用來初始化一般的 [列印] 對話方塊資訊。 使用者關閉對話方塊之後，Windows 會傳回在這個結構中的相關使用者的選取項目資訊。 `m_pd`隸屬[CPrintDialog](../../mfc/reference/cprintdialog-class.md)物件是`PRINTDLG`結構。  
  
 如需有關此結構的詳細資訊，請參閱[PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) Windows SDK 中。  
  
 如需詳細資訊，請參閱 < [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) Windows SDK 中。  
  
##  <a name="updatelink"></a>  COleClientItem::UpdateLink  
 呼叫此函式可立即更新的 OLE 項目呈現資料。  
  
```  
BOOL UpdateLink();
```  
  
### <a name="return-value"></a>傳回值  
 非零成功，否則為 0。  
  
### <a name="remarks"></a>備註  
 針對連結的項目，此函式會尋找連結來源，以取得新的簡報，如 OLE 項目。 此程序可能需要執行一或多個伺服器應用程式，這樣可能會很費時。 用於內嵌的項目，此函數操作，遞迴地檢查內嵌的項目是否包含可能已經過期的連結和更新它們。 使用者也可以手動更新個別使用 [連結] 對話方塊中的連結。  
  
 如需詳細資訊，請參閱 < [IOleLink::Update](http://msdn.microsoft.com/library/windows/desktop/ms692660) Windows SDK 中。  
  
## <a name="see-also"></a>另請參閱  
 [MFC 範例 MFCBIND](../../visual-cpp-samples.md)   
 [MFC 範例 OCLIENT](../../visual-cpp-samples.md)   
 [CDocItem 類別](../../mfc/reference/cdocitem-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [COleServerItem 類別](../../mfc/reference/coleserveritem-class.md)
