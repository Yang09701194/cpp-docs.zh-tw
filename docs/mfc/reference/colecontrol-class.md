---
title: COleControl 類別 |Microsoft Docs
ms.custom: ''
ms.date: 08/27/2018
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: d3c5f68d35c4cf77073de3f8d2e6090f62a6dae2
ms.sourcegitcommit: 913c3bf23937b64b90ac05181fdff3df947d9f1c
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/18/2018
ms.locfileid: "46050095"
---
# <a name="colecontrol-class"></a>COleControl 類別
開發 OLE 控制項的強大基底類別。

## <a name="syntax"></a>語法

```
class COleControl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|建立 `COleControl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|擷取目前控制項的外觀。|
|[COleControl::AmbientBackColor](#ambientbackcolor)|傳回環境的背景色彩屬性的值。|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|容器會傳回所指定控制項的名稱。|
|[COleControl::AmbientFont](#ambientfont)|傳回環境的字型屬性值。|
|[COleControl::AmbientForeColor](#ambientforecolor)|傳回環境的前景色彩屬性的值。|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|傳回容器的地區設定識別碼。|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|傳回容器所使用的單位的類型。|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|判斷是否應出現抓取控點。|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|決定是否應該顯示影線。|
|[COleControl::AmbientTextAlign](#ambienttextalign)|傳回容器所指定的文字對齊的類型。|
|[COleControl::AmbientUIDead](#ambientuidead)|決定控制項應該回應使用者介面動作。|
|[COleControl::AmbientUserMode](#ambientusermode)|判斷容器的模式。|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|通知容器繫結的屬性已變更。|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|若要編輯的屬性值的要求權限。|
|[COleControl::ClientToParent](#clienttoparent)|將相對於控制項的原點的點，相對於其容器的原點的點的轉譯。|
|[COleControl::ClipCaretRect](#clipcaretrect)|如果它由控制項重疊，請調整插入號的矩形。|
|[COleControl::ControlInfoChanged](#controlinfochanged)|由控制項的助憶鍵的集合變更後，請呼叫此函式。|
|[COleControl::DisplayError](#displayerror)|顯示控制項的使用者內建的錯誤事件。|
|[COleControl::DoClick](#doclick)|實作的股票`DoClick`方法。|
|[COleControl::DoPropExchange](#dopropexchange)|將序列化的屬性`COleControl`物件。|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|OLE 控制項已從 Windows 中的控制項已形成子類別，會重新繪製。|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|啟用簡單框架控制項的支援。|
|[COleControl::ExchangeExtent](#exchangeextent)|將序列化控制項的寬度和高度。|
|[COleControl::ExchangeStockProps](#exchangestockprops)|將控制項的內建屬性序列化。|
|[COleControl::ExchangeVersion](#exchangeversion)|將序列化控制的版本號碼。|
|[COleControl::FireClick](#fireclick)|股票，就會引發`Click`事件。|
|[COleControl::FireDblClick](#firedblclick)|股票，就會引發`DblClick`事件。|
|[COleControl::FireError](#fireerror)|股票，就會引發`Error`事件。|
|[COleControl::FireEvent](#fireevent)|引發自訂事件。|
|[COleControl::FireKeyDown](#firekeydown)|股票，就會引發`KeyDown`事件。|
|[COleControl::FireKeyPress](#firekeypress)|股票，就會引發`KeyPress`事件。|
|[COleControl::FireKeyUp](#firekeyup)|股票，就會引發`KeyUp`事件。|
|[COleControl::FireMouseDown](#firemousedown)|股票，就會引發`MouseDown`事件。|
|[COleControl::FireMouseMove](#firemousemove)|股票，就會引發`MouseMove`事件。|
|[COleControl::FireMouseUp](#firemouseup)|股票，就會引發`MouseUp`事件。|
|[COleControl::FireReadyStateChange](#firereadystatechange)|引發事件的控制項 [就緒] 狀態變更時。|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|改變支援的控制項的預設啟動行為`IPointerInactive`介面。|
|[COleControl::GetAmbientProperty](#getambientproperty)|傳回所指定的環境屬性的值。|
|[COleControl::GetAppearance](#getappearance)|傳回值的內建的外觀屬性。|
|[COleControl::GetBackColor](#getbackcolor)|傳回的內建的背景色彩屬性的值。|
|[COleControl::GetBorderStyle](#getborderstyle)|傳回的內建的框線樣式屬性的值。|
|[COleControl::GetCapture](#getcapture)|決定無視窗中，已啟用控制項的物件是否具有滑鼠捕捉。|
|[COleControl::GetClassID](#getclassid)|擷取控制項的 OLE 類別 ID。|
|[COleControl::GetClientOffset](#getclientoffset)|擷取控制項的矩形區域左上的角和其用戶端區域左上的角的差異。|
|[COleControl::GetClientRect](#getclientrect)|擷取控制項的用戶端區域的大小。|
|[COleControl::GetClientSite](#getclientsite)|查詢其目前的用戶端站台，其容器內的指標物件。|
|[COleControl::GetControlFlags](#getcontrolflags)|擷取控制旗標設定。|
|[COleControl::GetControlSize](#getcontrolsize)|傳回 OLE 控制項的大小與位置。|
|[COleControl::GetDC](#getdc)|提供無視窗控制項從其容器中取得的裝置內容的方法。|
|[COleControl::GetEnabled](#getenabled)|會傳回股票 Enabled 屬性的值。|
|[COleControl::GetExtendedControl](#getextendedcontrol)|擷取屬於容器的擴充的控制項物件的指標。|
|[COleControl::GetFocus](#getfocus)|判斷控制項是否具有焦點。|
|[COleControl::GetFont](#getfont)|傳回值的內建字型屬性。|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|傳回的標準`CFontHolder`物件。|
|[COleControl::GetForeColor](#getforecolor)|傳回的內建的前景色彩屬性的值。|
|[COleControl::GetHwnd](#gethwnd)|傳回內建的 hWnd 屬性的值。|
|[COleControl::GetMessageString](#getmessagestring)|提供的功能表項目中的狀態列文字。|
|[COleControl::GetNotSupported](#getnotsupported)|可防止使用者控制項的屬性值存取。|
|[COleControl::GetReadyState](#getreadystate)|傳回控制項的整備狀態。|
|[COleControl::GetRectInContainer](#getrectincontainer)|傳回相對於其容器的控制項的矩形。|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|傳回的標準的內建字型屬性。|
|[COleControl::GetText](#gettext)|傳回內建的 Text 或 Caption 屬性值。|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|覆寫以允許無視窗控制項的拖放目標拖放作業。|
|[COleControl::InitializeIIDs](#initializeiids)|通知控制項將使用的 Iid 的基底類別。|
|[COleControl::InternalGetFont](#internalgetfont)|傳回`CFontHolder`物件內建字型屬性。|
|[COleControl::InternalGetText](#internalgettext)|擷取內建的標題或文字屬性。|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|設定控制項的整備狀態並引發就緒狀態變更事件。|
|[COleControl::InvalidateControl](#invalidatecontrol)|失效的區域顯示的控制項，導致重新繪製它。|
|[COleControl::InvalidateRgn](#invalidatergn)|使給定區域內的 [容器] 視窗的用戶端區域失效。 可用來重新繪製的區域中的無視窗控制項。|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|可特製化的載入 OLE 控制項。|
|[COleControl::IsModified](#ismodified)|判斷是否已變更的控制項狀態。|
|[COleControl::IsOptimizedDraw](#isoptimizeddraw)|指出容器是否支援目前的繪圖作業最佳化的繪圖。|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|呼叫以判斷是否控制項子類別的 Windows 控制。|
|[COleControl::Load](#load)|重設任何先前的非同步資料，並起始新的負載，控制項的非同步屬性。|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|決定是否您的控制項可以停用的容器。|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|當環境的屬性變更時呼叫。|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|內建的外觀屬性已變更時呼叫。|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|內建的 BackColor 屬性變更時，會呼叫它。|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|內建的框線樣式屬性已變更時呼叫。|
|[COleControl::OnClick](#onclick)|呼叫以引發內建 Click 事件。|
|[COleControl::OnClose](#onclose)|通知控制項，`IOleControl::Close`已呼叫。|
|[COleControl::OnDoVerb](#ondoverb)|執行控制動詞後呼叫。|
|[COleControl::OnDraw](#ondraw)|當控制項被要求重繪其本身時呼叫。|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|當控制項被要求重繪其本身使用的中繼檔裝置內容時，由容器呼叫。|
|[COleControl::OnEdit](#onedit)|由 UI 啟動容器中稱為 OLE 控制項。|
|[COleControl::OnEnabledChanged](#onenabledchanged)|當股票 Enabled 屬性變更時呼叫。|
|[COleControl::OnEnumVerbs](#onenumverbs)|呼叫以列舉控制項的動詞命令的容器。|
|[COleControl::OnEventAdvise](#oneventadvise)|當連線或中斷連線，從控制項中的事件處理常式時呼叫。|
|[COleControl::OnFontChanged](#onfontchanged)|內建字型屬性已變更時呼叫。|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|內建的前景色彩屬性已變更時呼叫。|
|[COleControl::OnFreezeEvents](#onfreezeevents)|控制項的事件會凍結或解除凍結時呼叫。|
|[COleControl::OnGetColorSet](#ongetcolorset)|通知控制項，`IOleObject::GetColorSet`已呼叫。|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|提供容器的助憶鍵資訊。|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|呼叫以取得字串，表示屬性值。|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|要求將會合併具有 [容器] 功能表的控制項的功能表中的控制代碼。|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|覆寫，以擷取最接近的建議的大小和範圍模式的控制項的顯示大小。|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|傳回表示屬性的可能值的字串。|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|傳回對應到預先定義的字串值。|
|[COleControl::OnGetViewExtent](#ongetviewextent)|覆寫，以擷取控制項的顯示區域 （可以用來啟用兩次繪圖） 的大小。|
|[COleControl::OnGetViewRect](#ongetviewrect)|若要將控制項的大小轉換成矩形，從特定的位置開始覆寫。|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|覆寫，以擷取控制項的檢視狀態。|
|[COleControl::OnHideToolBars](#onhidetoolbars)|在控制項的 UI 停用時呼叫的容器。|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|覆寫將非使用中的控制下的滑鼠指標分派 WM_MOUSEMOVE 訊息至控制項的容器。|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|覆寫將非使用中的控制下的滑鼠指標分派 WM_SETCURSOR 訊息至控制項的容器。|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|已引發內建的 KeyDown 事件後呼叫。|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|已引發內建的 KeyPress 事件後呼叫。|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|內建的 KeyUp 事件已經引發之後呼叫。|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|表示要用來編輯屬性的屬性頁。|
|[COleControl::OnMnemonic](#onmnemonic)|在按下之控制項的助憶鍵時呼叫。|
|[COleControl::OnProperties](#onproperties)|已叫用控制項的"Properties"動詞時呼叫。|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|控制項的顯示重疊的指定的點是否會覆寫查詢。|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|是否將控制項的顯示重疊在指定的矩形中的任何時間點，請覆寫查詢。|
|[COleControl::OnRenderData](#onrenderdata)|由架構呼叫以擷取指定格式的資料。|
|[COleControl::OnRenderFileData](#onrenderfiledata)|由架構呼叫以擷取指定格式的檔案中的資料。|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|由架構呼叫以擷取指定格式的全域記憶體中的資料。|
|[COleControl::OnResetState](#onresetstate)|控制項的屬性重設為預設值。|
|[COleControl::OnSetClientSite](#onsetclientsite)|通知控制項，`IOleControl::SetClientSite`已呼叫。|
|[COleControl::OnSetData](#onsetdata)|控制項的資料取代為另一個值。|
|[COleControl::OnSetExtent](#onsetextent)|控制項的寬度變更後，會呼叫它。|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|呼叫之後已變更控制項的維度。|
|[COleControl::OnShowToolBars](#onshowtoolbars)|當控制項以 UI 啟動時呼叫。|
|[COleControl::OnTextChanged](#ontextchanged)|股票 Text 或 Caption 屬性變更時呼叫。|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|處理視窗訊息 （非滑鼠和鍵盤訊息），無視窗控制項。|
|[COleControl::ParentToClient](#parenttoclient)|將相對於容器的原點的點，相對於控制項的原點的點的轉譯。|
|[COleControl::PostModalDialog](#postmodaldialog)|通知容器的強制回應對話方塊已關閉。|
|[COleControl::PreModalDialog](#premodaldialog)|通知即將顯示強制回應對話方塊中的容器。|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|終結並重新建立控制項的視窗。|
|[COleControl::Refresh](#refresh)|強制重新繪製的控制項的外觀。|
|[COleControl::ReleaseCapture](#releasecapture)|滑鼠捕捉釋放。|
|[COleControl::ReleaseDC](#releasedc)|釋放容器無視窗控制項的顯示裝置內容。|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|重設控制項視窗的父代。|
|[COleControl::ResetStockProps](#resetstockprops)|初始化`COleControl`內建屬性設為預設值。|
|[COleControl::ResetVersion](#resetversion)|初始化為特定值的版本號碼。|
|[COleControl::ScrollWindow](#scrollwindow)|允許無視窗控制項捲動區域內顯示其就地使用中映像。|
|[COleControl::SelectFontObject](#selectfontobject)|放入裝置內容中，選取自訂的字型屬性。|
|[COleControl::SelectStockFont](#selectstockfont)|選取放入裝置內容中的內建字型屬性。|
|[COleControl::SerializeExtent](#serializeextent)|序列化或初始化控制項的顯示空間。|
|[COleControl::SerializeStockProps](#serializestockprops)|序列化或初始化`COleControl`內建屬性。|
|[COleControl::SerializeVersion](#serializeversion)|序列化或初始化控制項的版本資訊。|
|[COleControl::SetAppearance](#setappearance)|設定內建的外觀屬性的值。|
|[COleControl::SetBackColor](#setbackcolor)|設定內建的背景色彩屬性的值。|
|[COleControl::SetBorderStyle](#setborderstyle)|設定內建的框線樣式屬性的值。|
|[COleControl::SetCapture](#setcapture)|會使控制項的容器視窗，才會持有滑鼠捕捉的控制項的代表。|
|[COleControl::SetControlSize](#setcontrolsize)|設定位置和 OLE 控制項的大小。|
|[COleControl::SetEnabled](#setenabled)|設定內建 Enabled 屬性值。|
|[COleControl::SetFocus](#setfocus)|會使控制項的容器視窗，才會擁有輸入焦點的控制項的代表。|
|[COleControl::SetFont](#setfont)|設定內建字型屬性值。|
|[COleControl::SetForeColor](#setforecolor)|設定內建的前景色彩屬性的值。|
|[COleControl::SetInitialSize](#setinitialsize)|設定 OLE 控制項的容器中第一次顯示時的大小。|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|變更控制項的已修改的狀態。|
|[COleControl::SetNotPermitted](#setnotpermitted)|表示編輯要求已失敗。|
|[COleControl::SetNotSupported](#setnotsupported)|可防止使用者控制項的屬性值的修改。|
|[COleControl::SetRectInContainer](#setrectincontainer)|設定相對於其容器的控制項的矩形。|
|[COleControl::SetText](#settext)|設定內建的 Text 或 Caption 屬性值。|
|[COleControl::ThrowError](#throwerror)|OLE 控制項中發生錯誤的訊號。|
|[COleControl::TransformCoords](#transformcoords)|轉換協調容器和控制項之間的值。|
|[COleControl::TranslateColor](#translatecolor)|OLE_COLOR 將值轉換為 COLORREF 值。|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|決定是否環境屬性可供下一次載入控制項。|
|[COleControl::WindowProc](#windowproc)|提供的 Windows 處理程序`COleControl`物件。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|當控制項的外觀需要更新時，由架構呼叫。|
|[COleControl::DrawMetafile](#drawmetafile)|使用中繼檔裝置內容時，由架構呼叫。|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|可讓自動化方法引動過程。|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|由架構呼叫以初始化控制項支援的資料格式的清單。|

## <a name="remarks"></a>備註

衍生自`CWnd`，此類別會繼承 Windows 視窗物件的所有功能，加上額外的功能特定至 OLE，例如事件的引發和支援的方法和屬性的能力。

OLE 控制項可插入 OLE 容器應用程式，並使用雙向系統事件的引發和公開方法與屬性，以容器與容器通訊。 請注意，標準的 OLE 容器只支援 OLE 控制項的基本功能。 也就是無法支援 OLE 控制項的擴充的功能。 事件傳送至的容器控制項中發生特定動作的結果時，就會發生事件的引發。 接著，容器控制項與通訊，使用了公開一組方法和屬性類似於成員函式和 c + + 類別的資料成員。 這種方法可讓開發人員控制控制項的外觀，並在發生特定動作時，通知容器。

## <a name="windowless-controls"></a>無視窗控制項

OLE 控制項可以使用的就地啟用作用中但沒有視窗。 無視窗控制項有顯著的優點：

- 無視窗控制項都可以透明且非矩形

- 無視窗控制項減少之物件的執行個體大小和建立時間

控制項不需要 視窗。 透過單一的共用的視窗 （通常是容器的） 和分派的程式碼時，可以輕鬆地提供 視窗可提供的服務。 視窗是大部分是沒有必要的複雜度顯示在物件上。

使用無視窗啟用時，容器 （沒有視窗） 會負責提供服務，會提供控制項自己的視窗。 例如，如果您的控制項需要查詢鍵盤焦點、 查詢滑鼠捕捉，或取得裝置內容，這些作業是由容器管理。 `COleControl`無視窗作業的成員函式叫用這些容器上的作業。

容器委派啟用無視窗啟用時，輸入訊息到控制項的`IOleInPlaceObjectWindowless`介面 (的延伸模組[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)無視窗的支援)。 `COleControl`適當調整滑鼠座標之後，這個介面的實作會分派透過控制項的訊息對應，這些訊息。 您可以將對應的項目加入至訊息對應來處理一般視窗訊息，這些訊息。

在無視窗控制項中，您應該一律使用`COleControl`成員函式，而不要使用對應`CWnd`成員函式或其相關的 Windows API 函式。

只有當它們變成作用中，但非作用中-主動轉換所需的工作量會增加轉換的速度停止運作時，OLE 控制項物件也可以建立視窗。 一些情況下這是一個問題： 做為範例，請考慮之文字方塊的方格。 當增加和減少對照指標透過資料行，每個控制項必須是就地啟用完成，然後停用。 非使用中/主動轉換的速度會直接影響捲動的速度。

如需有關如何開發 OLE 控制項架構的詳細資訊，請參閱文章[MFC ActiveX 控制項](../../mfc/mfc-activex-controls.md)並[概觀： 建立 MFC ActiveX 控制項程式](../../mfc/reference/mfc-activex-control-wizard.md)。 如需最佳化 OLE 控制項，包括無視窗和無重繪閃動的控制項，請參閱[MFC ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>需求

**標頭：** afxctl.h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

傳回環境的背景色彩屬性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>傳回值

容器的環境背景色彩屬性，如果有任何目前的值。 如果不支援的屬性，此函數會傳回系統定義的 Windows 背景色彩。

### <a name="remarks"></a>備註

環境背景色彩屬性可用於所有控制項，由容器所定義。 請注意，容器不需要可支援此屬性。

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

容器已指派給控制項的名稱可以用於向使用者顯示的錯誤訊息。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>傳回值

OLE 控制項的名稱。 預設值為零長度字串。

### <a name="remarks"></a>備註

請注意，容器不需要可支援此屬性。

##  <a name="ambientfont"></a>  COleControl::AmbientFont

傳回環境的字型屬性值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>傳回值

容器的環境字型分派介面的指標。 預設值是 NULL。 如果傳回不等於 NULL，您必須負責釋放字型，藉由呼叫其[iunknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release)成員函式。

### <a name="remarks"></a>備註

環境字型屬性是由容器定義，並可供所有控制項。請注意，容器不需要可支援此屬性。

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

傳回環境的前景色彩屬性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>傳回值

容器的環境前景色彩屬性，如果有任何目前的值。 如果不支援，則此函數會傳回系統定莪 Windows 文字色彩。

### <a name="remarks"></a>備註

環境的前景色彩屬性可用於所有控制項，由容器所定義。 請注意，容器不需要可支援此屬性。

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

傳回容器的地區設定識別碼。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>傳回值

容器的 LocaleID 屬性 （如果有的話） 的值。 如果不支援這個屬性，此函數會傳回 0。

### <a name="remarks"></a>備註

控制項可以使用地區設定識別碼，來調整它的使用者介面，針對特定的地區設定。 請注意，容器不需要可支援此屬性。

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

擷取控制項物件的目前外觀設定。

```
short AmbientAppearance();
```

### <a name="return-value"></a>傳回值

控制項的外觀：

- **0**一般外觀

- **1** 3D 外觀

### <a name="remarks"></a>備註

呼叫此函式可擷取目前控制項的 DISPID_AMBIENT_APPEARANCE 屬性的值。

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

傳回容器所使用的單位的類型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>傳回值

字串，包含容器環境 ScaleUnits。 如果不支援這個屬性，此函數會傳回零長度字串。

### <a name="remarks"></a>備註

容器的環境 ScaleUnits 屬性可用來顯示位置或維度，加上所選的單位，例如 twip 還是以公分。 請注意，容器不需要可支援此屬性。

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

判斷容器是否允許控制項來顯示為其本身時使用的抓取控點。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>傳回值

如果應該顯示抓取控點，為非零否則為 0。 如果不支援這個屬性，則此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，容器不需要可支援此屬性。

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

判斷容器是否允許要顯示本身與規劃的控制項模式的時機 UI 作用。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>傳回值

非零值，如果應該顯示影線的圖樣。否則為 0。 如果不支援這個屬性，則此函式會傳回非零值。

### <a name="remarks"></a>備註

請注意，容器不需要可支援此屬性。

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

決定慣用控制項容器之環境的文字對齊方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>傳回值

容器的環境 TextAlign 屬性的狀態。 如果不支援這個屬性，此函數會傳回 0。

以下是有效的傳回值的清單：

|傳回值|意義|
|------------------|-------------|
|0|一般的對齊方式 （沒錯，文字左邊的數字）。|
|1|靠左對齊|
|2|置中|
|3|靠右對齊|

### <a name="remarks"></a>備註

此屬性可用於所有內嵌控制項，而且由容器所定義。 請注意，容器不需要可支援此屬性。

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

判斷容器是否想要回應使用者介面動作的控制項。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>傳回值

非零值，如果控制項應該回應使用者介面動作;否則為 0。 如果不支援這個屬性，此函數會傳回 0。

### <a name="remarks"></a>備註

例如，容器可能會將此設為 TRUE，在設計模式。

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

判斷容器是否在設計模式或使用者模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>傳回值

如果容器是在使用者模式; 中，非零值。否則為 0 （在設計模式） 中。 如果不支援這個屬性，此函數會傳回 TRUE。

### <a name="remarks"></a>備註

例如，容器可能會將此設為 FALSE，在設計模式。

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

繫結的屬性值已變更的訊號。

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
繫結控制項屬性的分派 ID。

### <a name="remarks"></a>備註

這必須在每次屬性變更，即使在不透過屬性進行變更的情況下的值設定方法呼叫。 請特別注意的繫結會對應至成員變數的屬性。 這類成員變數的變更，每當`BoundPropertyChanged`必須呼叫。

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

要求權限從`IPropertyNotifySink`介面來變更控制項所提供的繫結的屬性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispid*<br/>
繫結控制項屬性的分派 ID。

### <a name="return-value"></a>傳回值

非零值，如果允許變更;否則為 0。 預設值為非零值。

### <a name="remarks"></a>備註

如果權限遭到拒絕，控制項必須禁止屬性變更的值。 做法是藉由略過或失敗的嘗試將變更的屬性值的動作。

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

將轉譯的座標*pPoint*成父座標。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
在容器中 OLE 控制項的界限的指標。 非工作區，但整個控制項，包括框線和捲軸的區域。

*pPoint*<br/>
若要轉譯為父系 （容器） 座標的 OLE 用戶端區域點的指標。

### <a name="remarks"></a>備註

在輸入*pPoint*是相對於原點的 OLE 控制項 （控制項的用戶端區域的左上角） 的工作區。 在輸出*pPoint*是相對於父代 （左上角的容器） 的原點。

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

插入號矩形時調整其部分或完全涵蓋重疊的不透明物件。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
在輸入的指標[RECT](../../mfc/reference/rect-structure1.md)包含插入號區域調整的結構。 在輸出中，已調整的插入號 區域中，或如果插入號矩形完全覆蓋，則為 NULL。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

插入號是閃爍的線、 區塊或點陣圖，通常表示文字或圖形要插入的位置。

無視窗的物件無法安全地顯示插入號，而不先檢查是否有插入號部分或完全遮住重疊的物件。 若要使其成為可能的可以使用物件`ClipCaretRect`取得插入號調整 (reduced) 以確保能夠容納的裁剪區域。

建立插入號的物件所應該提交到插入號矩形`ClipCaretRect`插入號以用於調整的矩形。 如果插入號完全隱藏的這個方法會傳回 FALSE，並插入號應該不會顯示所有在此情況下。

##  <a name="colecontrol"></a>  COleControl::COleControl

建構 `COleControl` 物件。

```
COleControl();
```

### <a name="remarks"></a>備註

通常不會直接呼叫此函數。 改為 OLE 控制項通常會建立其 class factory。

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

支援的控制項的助憶鍵的集合變更時，請呼叫此函式。

```
void ControlInfoChanged();
```

### <a name="remarks"></a>備註

收到此通知之後，控制項的容器，請取得所呼叫的一組新的助憶鍵[IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)。 請注意，容器並不需要回應這項通知。

##  <a name="displayerror"></a>  COleControl::DisplayError

內建的錯誤事件處理 （除非事件處理常式已隱藏的錯誤顯示） 後，由架構呼叫。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項： 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
正在回報的錯誤描述。

*lpszSource*<br/>
產生錯誤 （通常是 OLE 控制項模組的名稱） 的模組名稱。

*lpszHelpFile*<br/>
包含描述錯誤的說明檔的名稱。

*nHelpID*<br/>
說明內容識別碼的所回報的錯誤。

### <a name="remarks"></a>備註

預設行為會顯示訊息方塊包含描述錯誤中包含的*lpszDescription*。

覆寫此函式以自訂錯誤的顯示方式。

##  <a name="doclick"></a>  COleControl::DoClick

模擬滑鼠按一下控制項上的動作。

```
void DoClick();
```

### <a name="remarks"></a>備註

可覆寫`COleControl::OnClick`會呼叫成員函式，並內建 Click 事件引發之後，如果控制項支援。

此函式受到`COleControl`做為內建方法，稱為 DoClick 基底類別。 如需詳細資訊，請參閱文章[ActiveX 控制項： 方法](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

由架構載入或儲存的資料流或屬性集合的永續性儲存體表示控制項時呼叫。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換，包括其方向的內容。

### <a name="remarks"></a>備註

此函式通常會呼叫**PX_** 系列函式來載入或儲存 OLE 控制項的特定使用者定義的屬性。

如果使用控制項精靈建立 OLE 控制項的專案，此函式的覆寫的版本會序列化所支援的內建屬性`COleControl`基底類別函式呼叫`COleControl::DoPropExchange`。 將使用者定義的屬性新增至您的 OLE 控制項您必須修改此函式，以序列化您的新屬性。 如需有關序列化的詳細資訊，請參閱文章[ActiveX 控制項： 序列化](../../mfc/mfc-activex-controls-serializing.md)。

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

OLE 控制項已從 Windows 中的控制項已形成子類別，會重新繪製。

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
控制項容器的裝置內容指標。

*rcbounds 就*<br/>
要繪製控制項的區域。

### <a name="remarks"></a>備註

呼叫此函式可適當地處理非作用中的 OLE 控制項的繪製。 此函式應該只用於 OLE 控制項子類別的 Windows 控制項，並應該呼叫`OnDraw`函式的控制項。

如需有關這個函式和子類別化 Windows 控制項的詳細資訊，請參閱文章[ActiveX 控制項： 子類別化 Windows 控制項](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)。

##  <a name="drawcontent"></a>  COleControl::DrawContent

當控制項的外觀需要更新時，由架構呼叫。

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
裝置內容指標。

*rc*<br/>
若要繪製的矩形區域。

### <a name="remarks"></a>備註

此函式直接呼叫可覆寫`OnDraw`函式。

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

使用中繼檔裝置內容時，由架構呼叫。

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
中繼檔裝置內容指標。

*rc*<br/>
若要繪製的矩形區域。

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

可讓 OLE 控制項的簡單框架特性。

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>備註

這項特性可讓您控制以支援 visual 的內含項目，其他控制項，但不是正確的 OLE 內含項目。 範例會使用數個控制項內群組方塊。 這些控制項不是 OLE 所包含，但它們位於相同的群組方塊。

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

序列化或初始化控制項的寬度 （其以 himetric 為單位的維度） 的狀態。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
指標[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件。 架構會提供此物件來建立屬性交換，包括其方向的內容。

### <a name="return-value"></a>傳回值

如果函式成功，否則為非零值否則為 0。

### <a name="remarks"></a>備註

通常會呼叫此函式的預設實作`COleControl::DoPropExchange`。

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

序列化或初始化控制項的內建屬性的狀態。

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
指標[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件。 架構會提供此物件來建立屬性交換，包括其方向的內容。

### <a name="remarks"></a>備註

通常會呼叫此函式的預設實作`COleControl::DoPropExchange`。

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

序列化或初始化控制項的版本資訊的狀態。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 架構會提供此物件來建立屬性交換，包括其方向的內容。

*dwVersionDefault*<br/>
控制項的目前版本號碼。

*bConvert*<br/>
指出是否應該將永續性資料轉換為最新的格式儲存，或保留在相同的格式載入時。

### <a name="return-value"></a>傳回值

非零值的函式成功，否則為否則為 0。

### <a name="remarks"></a>備註

一般而言，這會呼叫控制項的覆寫第一個函式`COleControl::DoPropExchange`。 載入時，此函式讀取永續性資料的版本號碼，並設定的 version 屬性[CPropExchange](../../mfc/reference/cpropexchange-class.md)據此物件。 在儲存時，此函式會寫入永續性資料的版本號碼。

如需持續性和版本控制的詳細資訊，請參閱文章[ActiveX 控制項： 序列化](../../mfc/mfc-activex-controls-serializing.md)。

##  <a name="fireclick"></a>  COleControl::FireClick

作用中的控制項上按一下滑鼠時，由架構呼叫。

```
void FireClick();
```

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行的 Click 事件的引發，控制項的事件對應都必須有內建 Click 事件定義。

##  <a name="firedblclick"></a>  COleControl::FireDblClick

當使用中的控制項上按兩下滑鼠時，由架構呼叫。

```
void FireDblClick();
```

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行 DblClick 事件的引發，控制項的事件對應都必須有已定義的內建 DblClick 事件。

##  <a name="fireerror"></a>  COleControl::FireError

內建的錯誤事件，就會引發。

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項： 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。

*lpszDescription*<br/>
正在回報的錯誤描述。

*nHelpID*<br/>
正在回報的錯誤說明識別碼。

### <a name="remarks"></a>備註

這個事件提供的發出訊號，在適當的位置，在您的程式碼中發生錯誤時，已由您控制的方式。 不同於其他內建的事件，例如按一下滑鼠按鈕或 MouseMove 引發錯誤，永遠不會由架構。

若要報告的屬性 get 函式、 屬性集函式或自動化方法期間所發生的錯誤，請呼叫[colecontrol:: Throwerror](#throwerror)。

OLE 控制項的內建錯誤事件的實作會使用 SCODE 值。 如果您的控制項使用這個事件，和適用於 Visual Basic 4.0 中，您會收到錯誤，因為在 Visual Basic 中不支援 SCODE 值。

若要修正此問題，手動變更 SCODE 參數中的控制項。ODL 檔案**長**。 此外，任何自訂事件、 方法或屬性，會使用 SCODE 參數也會導致相同的問題。

##  <a name="fireevent"></a>  COleControl::FireEvent

使用者定義的事件，從您的控制項與任意數目的選擇性引數，就會引發。

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>參數

*dispid*<br/>
要引發之事件的分派識別碼。

*pbParams*<br/>
事件的參數型別描述元。

### <a name="remarks"></a>備註

通常這個函式應該不直接呼叫。 相反地，您會在您的控制項類別宣告的事件對應區段呼叫的事件引發函式。

*PbParams*引數是以空格分隔的清單**VTS_**。 其中的一或多個值 (以空格分隔，而非逗號) 會指定函式的參數清單。 可能的值如下：

|符號|參數類型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  對於所有 variant 類型，除了 VTS_FONT 和 VTS_PICTURE，提供變異資料常數的指標，定義其他變數的常數。 這些常數會使用名為**VTS_P** `constantname`慣例。 比方說，VTS_PCOLOR 是 VTS_COLOR 常數的指標。

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

當控制項的 UI 使用中時按下按鍵時，由架構呼叫。

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
按下的按鍵的虛擬按鍵碼值的指標。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行 KeyDown 事件的引發，控制項的事件對應都必須有已定義的內建 KeyDown 事件。

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

當金鑰是按下並放開自訂控制項 UI 作用中容器內，由架構呼叫。

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
按鍵的字元值指標。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

事件的收件者可能會修改*pnChar*，例如，將所有小寫字元轉換成大寫。 如果您想要檢查修改過的字元，會覆寫`OnKeyPressEvent`。

自動引發 KeyPress 事件發生，控制項的事件對應必須已定義的內建 KeyPress 事件。

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

當自訂控制項為 UI 作用中容器內，且放開按鍵時，由架構呼叫。

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
發行的機碼的虛擬按鍵碼值的指標。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行 KeyUp 事件的引發，控制項的事件對應都必須有內建的 KeyUp 事件定義。

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

作用中的自訂控制項上按下滑鼠按鈕時由架構呼叫。

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*n 按鈕*<br/>
按下滑鼠按鈕的數值。 它可以包含下列值之一：

- LEFT_BUTTON 滑鼠左鍵已按下。

- MIDDLE_BUTTON 滑鼠按鈕已按下。

- RIGHT_BUTTON 滑鼠右按鈕已按下。

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

*x*<br/>
滑鼠按鈕已按下時，資料指標的 x 座標。 座標是相對於控制項視窗的左上角。

*y*<br/>
滑鼠按鈕已按下時，資料指標的 y 座標。 座標是相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行 MouseDown 事件的引發，控制項的事件對應都必須有已定義的內建 MouseDown 事件。

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

將游標移至作用中的自訂控制項時，由架構呼叫。

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*n 按鈕*<br/>
按下滑鼠按鈕的數值。 包含下列值的組合：

- LEFT_BUTTON 滑鼠左鍵已按下動作期間。

- MIDDLE_BUTTON 滑鼠按鈕已按下動作期間。

- RIGHT_BUTTON 滑鼠右按鈕已按下動作期間。

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

*x*<br/>
資料指標的 x 座標。 座標是相對於控制項視窗的左上角。

*y*<br/>
資料指標的 y 座標。 座標是相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

自動進行 MouseMove 事件的引發，控制項的事件對應都必須有已定義的內建 MouseMove 事件。

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

作用中的自訂控制項上放開滑鼠按鈕時由架構呼叫。

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*n 按鈕*<br/>
放開滑鼠按鈕的數值。 它可以包含下列值之一：

- 已發行 LEFT_BUTTON 滑鼠左的按鈕。

- 已發行 MIDDLE_BUTTON 滑鼠中間鍵。

- 已發行 RIGHT_BUTTON 滑鼠右按鈕。

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

*x*<br/>
資料指標時放開滑鼠按鈕的 x 座標。 座標是相對於控制項視窗的左上角。

*y*<br/>
已放開滑鼠按鈕時，資料指標的 y 座標。 座標是相對於控制項視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自訂事件，您可以判斷引發事件時。

MouseUp 事件發生的自動引發，控制項的事件對應都必須有已定義的內建 MouseUp 事件。

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

引發事件的就緒狀態控制項的目前值。

```
void FireReadyStateChange();
```

### <a name="remarks"></a>備註

[就緒] 狀態可以是下列值之一：

READYSTATE_UNINITIALIZED 預設初始設定狀態

READYSTATE_LOADING 控制項目前正在載入其屬性

已初始化 READYSTATE_LOADED 控制項

READYSTATE_INTERACTIVE 控制項有足夠的資料來進行互動式作業，但不是所有非同步資料尚未載入

READYSTATE_COMPLETE 控制項具有其所有資料

使用[GetReadyState](#getreadystate)來判斷控制項的目前的整備程度。

[InternalSetReadyState](#internalsetreadystate)就緒的狀態變更為 「 提供的值，然後呼叫`FireReadyStateChange`。

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

改變支援的控制項的預設啟動行為`IPointerInactive`介面。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>傳回值

POINTERINACTIVE 列舉中的旗標組合。 可能的旗標如下：

POINTERINACTIVE_ACTIVATEONENTRY 物件應該就地啟動當滑鼠進入它在滑鼠移動作業期間。

當滑鼠在滑鼠離開物件時，應該停用物件的 POINTERINACTIVE_DEACTIVATEONLEAVE 移動作業。

POINTERINACTIVE_ACTIVATEONDRAG 物件應該是就地啟用滑鼠拖曳至它在拖曳期間時，並卸除作業。

### <a name="remarks"></a>備註

當`IPointerInactive`介面已啟用，容器會將委派 WM_SETCURSOR 和 WM_MOUSEMOVE 訊息。 `COleControl`適當調整滑鼠座標之後，這個介面的實作會分派透過控制項的訊息對應，這些訊息。

每當容器接收 WM_SETCURSOR 或 WM_MOUSEMOVE 訊息滑鼠指標透過非作用中的物件支援`IPointerInactive`，則它應該呼叫`GetActivationPolicy`上 「 介面 」 和 「 POINTERINACTIVE 列舉中傳回的旗標。

您可以將對應的項目加入至訊息對應來處理這些訊息，就像一般視窗訊息。 在您的處理常式，請避免使用`m_hWnd`成員變數 （或使用它的任何成員函式） 且不需先檢查其值為非 NULL。

任何要執行多個設定滑鼠游標和 （或） 引發滑鼠移動事件，例如特殊的視覺化回饋提供、 應該傳回 POINTERINACTIVE_ACTIVATEONENTRY 旗標並物件繪製的意見反應，只有在使用中時。 若物件傳回此旗標，容器應該立即啟動它就地並再將它轉送觸發呼叫的相同訊息`GetActivationPolicy`。

如果傳回的 POINTERINACTIVE_ACTIVATEONENTRY 」 和 「 POINTERINACTIVE_DEACTIVATEONLEAVE 旗標，則物件只會啟用物件上方有滑鼠時。 是否只傳回 POINTERINACTIVE_ACTIVATEONENTRY 旗標，則物件只會啟用之後，當滑鼠初次進入物件。

您也可以是 OLE 拖放的目標和卸除作業非現用控制項。 這需要啟用使用者拖曳物件時，目前的控制項，以便做為置放目標可以註冊控制項的視窗。 若要讓 啟用時間在拖曳期間，會傳回 POINTERINACTIVE_ACTIVATEONDRAG 旗標：

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

所傳達的資訊`GetActivationPolicy`不會快取的容器。 相反地，每次滑鼠進入非作用中的物件，應該呼叫這個方法。

如果非作用中的物件不會要求要就地啟用滑鼠進入它時，它的容器應該後續 WM_SETCURSOR 將訊息分派至這個物件呼叫[OnInactiveSetCursor](#oninactivesetcursor)只要將滑鼠指標保留的物件。

啟用`IPointerInactive`介面通常表示您想要能夠隨時處理滑鼠訊息的控制項。 若要取得此行為，不支援的容器中`IPointerInactive`介面，您必須讓您的控制項一律啟動時顯示，表示控制項應該有 OLEMISC_ACTIVATEWHENVISIBLE 旗標，在它的其他旗標。 不過，若要避免這個旗標，從生效的容器中，支援`IPointerInactive`，您也可以指定 OLEMISC_IGNOREACTIVATEWHENVISIBLE 旗標：

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

取得容器的環境屬性的值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>參數

*dwDispid*<br/>
所需的環境屬性的分派識別碼。

*vtProp*<br/>
指定要傳回之值的類型的 variant 類型標記*pvProp*。

*pvProp*<br/>
變數會接收屬性值或傳回值的位址指標。 This 指標的實際型別必須符合所指定的型別*vtProp*。

|vtProp|PvProp 的型別|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>傳回值

支援的環境屬性; 如果為非零否則為 0。

### <a name="remarks"></a>備註

如果您使用`GetAmbientProperty`來擷取環境的 DisplayName 和 ScaleUnits 屬性，設定*vtProp*為 VT_BSTR 並*pvProp*至`CString*`。 如果您要擷取環境的字型屬性，設定*vtProp* VT_FONT 到並*pvProp*至 LPFONTDISP *。

請注意，函式已經提供通用的環境屬性，例如[AmbientBackColor](#ambientbackcolor)並[AmbientFont](#ambientfont)。

##  <a name="getappearance"></a>  COleControl::GetAppearance

實作控制項的內建的外觀屬性的 Get 函式。

```
short GetAppearance ();
```

### <a name="return-value"></a>傳回值

傳回的值會指定目前的 [外觀] 設定為**簡短**(VT_I2) 值，如果成功。 如果控制項的外觀為一般和 1 3D 控制項的外觀時，這個值會是零。

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

實作控制項的內建的背景色彩屬性的 Get 函式。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>傳回值

如果成功，傳回的值會指定目前的背景色彩為 OLE_COLOR 值時。 這個值可以藉由呼叫轉譯成 COLORREF 值`TranslateColor`。

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

實作控制項的內建的框線樣式屬性的 Get 函式。

```
short GetBorderStyle();
```

### <a name="return-value"></a>傳回值

如果控制項具有標準框線，則為 10，表示控制項有沒有框線。

##  <a name="getcapture"></a>  COleControl::GetCapture

決定是否`COleControl`物件具有滑鼠捕捉。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>傳回值

如果啟用並無視窗控制項即會傳回**這**如果控制項目前具有滑鼠擷取 （所決定的控制項容器），或如果它沒有擷取，則為 NULL。

否則，會傳回`CWnd`具有滑鼠擷取的物件 (與相同`CWnd::GetCapture`)。

### <a name="remarks"></a>備註

已啟動的無視窗控制項接收滑鼠擷取時[SetCapture](#setcapture)呼叫。

##  <a name="getclassid"></a>  COleControl::GetClassID

由架構呼叫以擷取 OLE 類別 ID 的控制項。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>參數

*pclsid*<br/>
指標位置的類別識別碼。

### <a name="return-value"></a>傳回值

如果呼叫不成功，為非零否則為 0。

### <a name="remarks"></a>備註

通常是由實作[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)。

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

擷取控制項的矩形區域左上的角和其用戶端區域左上的角的差異。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>參數

*pdxOffset*<br/>
OLE 控制項的用戶端區域的水平位移的指標。

*pdyOffset*<br/>
OLE 控制項的用戶端區域的垂直位移的指標。

### <a name="remarks"></a>備註

OLE 控制項具有其容器內的矩形區域。 控制項的用戶端區域是不包括框線和捲軸在控制項區域。 擷取位移`GetClientOffset`是控制項的矩形區域左上的角和其用戶端區域左上的角的差異。 如果您的控制項具有標準框線和捲軸以外的非工作項目，會覆寫此成員函式，以指定的位移。

##  <a name="getclientrect"></a>  COleControl::GetClientRect

擷取控制項的用戶端區域的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
指標`RECT`包含無視窗控制項的用戶端區域的維度結構，也就是控制項的大小，減去視窗框線、 框架、 捲軸等等。 *LpRect*參數會指示控制項的用戶端矩形，不是它的位置的大小。

##  <a name="getclientsite"></a>  COleControl::GetClientSite

查詢其目前的用戶端站台，其容器內的指標物件。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>傳回值

控制項的目前用戶端的站台在其容器中的指標。

### <a name="remarks"></a>備註

傳回的指標指向的執行個體`IOleClientSite`。 `IOleClientSite`容器所實作的介面是其內容物件的檢視： 它已錨定到文件，它可在此取得其存放裝置、 使用者介面和其他資源。

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

擷取控制旗標設定。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>傳回值

ControlFlags 列舉中的旗標 ORed 的組合：

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>備註

根據預設，`GetControlFlags`傳回`fastBeginPaint | clipPaintDC`。

|||
|-|-|
|`fastBeginPaint`|如果設定，請使用 begin 小畫家函式量身訂做的 OLE 控制項，而不是[BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API （預設設定）。|
|`clipPaintDC`|如果未設定標題，會停用來呼叫`IntersectClipRect`所做的`COleControl`並獲得小型的速度上的優勢。 如果您使用無視窗啟用時，此旗標沒有任何作用。|
|`pointerInactive`|如果設定，藉由啟用您的控制項為非作用中時提供滑鼠互動`COleControl`的實作`IPointerInactive`介面，預設會停用。|
|`noFlickerActivate`|如果設定，可排除額外繪圖作業和視覺重繪。 當您的控制項繪製本身相同的非作用中和作用中狀態時使用。 如果您使用無視窗啟用時，此旗標沒有任何作用。|
|`windowlessActivate`|如果設定，指出您的控制項使用無視窗啟用。|
|`canOptimizeDraw`|如果設定，表示控制項，會執行最佳化的繪圖，如果容器支援它。|

如需詳細資訊`GetControlFlags`和其他最佳化的 OLE 控制項，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

擷取 OLE 控制項視窗的大小。

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>參數

*pcx*<br/>
指定控制項的寬度，單位為像素。

*pcy*<br/>
指定控制項的高度，單位為像素。

### <a name="remarks"></a>備註

請注意，適用於控制 windows 的所有座標都是相對於控制項的左上角。

##  <a name="getdc"></a>  COleControl::GetDC

從其容器提供無視窗物件取得的螢幕 （或相容） 的裝置內容。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>參數

*lprcRect*<br/>
無視窗控制項的矩形的指標會想要在工作區座標中的控制項重繪。 NULL 表示完整的物件範圍。

*dwFlags*<br/>
繪製的裝置內容的屬性。 選項包括：

- OLEDC_NODRAW 表示物件不會用來執行任何繪圖，但只以取得資訊的顯示裝置的裝置內容。 容器只應該傳遞視窗的 DC 不會進一步處理。

- 容器繪製背景，再傳回 DC OLEDC_PAINTBKGND 要求。 物件應該使用這個旗標，如果它要求 DC 重新繪製的區域具有透明背景。

- OLEDC_OFFSCREEN 通知物件想要呈現到幕外的點陣圖，然後複製到螢幕的容器。 物件時繪製其即將執行的作業會產生大量重繪閃動，應該使用這個旗標。 容器是免費或不接受此要求。 不過，如果未設定此旗標，容器必須送回螢幕上的 DC。 這可讓物件來執行直接從螢幕的作業，例如顯示選取項目 (透過**XOR**作業)。

### <a name="return-value"></a>傳回值

容器的顯示裝置內容指標`CWnd`工作區如果成功，否則傳回值是 NULL。 顯示裝置內容可以用於後續的 GDI 函式，若要繪製工作區的容器 視窗中。

### <a name="remarks"></a>備註

[ReleaseDC](#releasedc)成員函式必須呼叫以繪製後釋出內容。 當呼叫`GetDC`，物件會傳遞他們想要在自己的工作區座標內繪製的矩形。 `GetDC` 會轉譯這些容器工作區的座標。 物件應該不會要求大於它自己的用戶端區域矩形，其大小可以使用擷取所要繪製矩形[GetClientRect](#getclientrect)。 這可防止不小心繪製他們不應在其中的物件。

##  <a name="getenabled"></a>  COleControl::GetEnabled

實作控制項的內建 Enabled 屬性的 Get 函式。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>傳回值

如果啟用控制項則為非零否則為 0。

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

取得物件代表具有一組延伸的屬性之控制項的容器，所維護的指標。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>傳回值

容器的指標的擴充控制項物件。 如果沒有可用的物件，此值會是 NULL。

這個物件可能會讓您透過操作其`IDispatch`介面。 您也可以使用`QueryInterface`取得物件所提供其他可用的介面。 不過，該物件不是需要支援一組特定的介面。 請注意，信賴憑證者的容器擴充的控制項物件的特定功能限制其他任意的容器控制項的可攜性。

### <a name="remarks"></a>備註

呼叫此函式的函式會負責釋放物件所完成的指標。 請注意，容器不需要支援此物件。

##  <a name="getfocus"></a>  COleControl::GetFocus

決定是否`COleControl`物件取得焦點。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>傳回值

如果啟用並無視窗控制項即會傳回**這**如果控制項目前具有鍵盤焦點 （所決定的控制項容器），或如果它沒有焦點，則為 NULL。

否則，會傳回`CWnd`具有焦點的物件 (與相同`CWnd::GetFocus`)。

### <a name="remarks"></a>備註

已啟動的無視窗控制項取得焦點時[SetFocus](#setfocus)呼叫。

##  <a name="getfont"></a>  COleControl::GetFont

會實作內建字型屬性的 Get 函式。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>傳回值

控制項的內建字型屬性的字型分派介面指標。

### <a name="remarks"></a>備註

請注意，呼叫端必須釋放完成時的物件。 在控制項的實作中，使用`InternalGetFont`存取控制的內建的字型物件。 如需有關如何在您的控制項中使用字型的詳細資訊，請參閱文章[ActiveX 控制項： 在 ActiveX 控制項中使用的字型](../../mfc/mfc-activex-controls-using-fonts.md)。

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

量值的文字度量資訊，針對任何`CFontHolder`控制項所擁有的物件。

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*lptm*<br/>
指標[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)結構。

*fontHolder*<br/>
若要參考[CFontHolder](../../mfc/reference/cfontholder-class.md)物件。

### <a name="remarks"></a>備註

可以使用選取這類字型[COleControl::SelectFontObject](#selectfontobject)函式。 `GetFontTextMetrics` 將會初始化`TEXTMETRIC`結構所指*lptm*相關的有效度量資訊`fontHolder`的字型，如果成功，或如果不成功，以零填入結構。 您應該使用此函式，而不是[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)時繪製控制項，因為控制項，例如任何內嵌 OLE 物件，可能需要將自己轉譯為中繼檔。

`TEXTMETRIC`結構的預設字型是重新整理時[SelectFontObject](#selectfontobject)呼叫函式。 您應該呼叫`GetFontTextMetrics`唯一之後選取內建的字型屬性，以確保它所提供的資訊無效。

##  <a name="getforecolor"></a>  COleControl::GetForeColor

會實作內建的前景色彩屬性的 Get 函式。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>傳回值

如果成功，傳回的值會指定目前的前景色彩為 OLE_COLOR 值時。 這個值可以轉譯成[COLORREF](/windows/desktop/gdi/colorref)值，藉由呼叫`TranslateColor`。

##  <a name="gethwnd"></a>  COleControl::GetHwnd

會實作內建的 hWnd 屬性的 Get 函式。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>傳回值

OLE 控制項的視窗控制代碼，如果有的話，否則為 NULL。

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

由架構呼叫以取得描述所識別的功能表項目的用途的簡短字串*nID*。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
功能表項目 id。

*rMessage*<br/>
參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件傳遞為字串傳回。

### <a name="remarks"></a>備註

這可用來取得在狀態列中顯示的訊息，而功能表項目會反白顯示。 預設實作會嘗試載入所識別的字串資源*nID*。

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

可防止使用者控制項的屬性值存取。

```
void GetNotSupported();
```

### <a name="remarks"></a>備註

如果不支援擷取控制項的使用者屬性的情況下呼叫此函式來取代任何屬性的 Get 函式。 其中一個範例是唯寫的屬性。

##  <a name="getreadystate"></a>  COleControl::GetReadyState

傳回控制項的整備狀態。

```
long GetReadyState();
```

### <a name="return-value"></a>傳回值

整備狀態為 控制項，下列值之一：

READYSTATE_UNINITIALIZED 預設初始設定狀態

READYSTATE_LOADING 控制項目前正在載入其屬性

已初始化 READYSTATE_LOADED 控制項

READYSTATE_INTERACTIVE 控制項有足夠的資料來進行互動式作業，但不是所有非同步資料尚未載入

READYSTATE_COMPLETE 控制項具有其所有資料

### <a name="remarks"></a>備註

大多數的簡單控制項永遠不需要區分 LOADED 和互動。 不過，支援的資料路徑屬性的控制項不可能已準備好進行互動式作業，直到至少部分資料以非同步方式接收。 控制項應該嘗試儘速成為互動式。

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

取得相對於容器，以裝置單位表示控制項的矩形的座標。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
控制項的座標將會複製到其中的矩形結構的指標。

### <a name="return-value"></a>傳回值

非零值，如果控制項是就地啟用作用中;否則為 0。

### <a name="remarks"></a>備註

矩形才有效，如果控制項是就地啟用作用中。

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

控制項的內建字型屬性，可以使用選取的文字度量會測量[SelectStockFont](#selectstockfont)函式。

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>參數

*lptm*<br/>
指標[TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica)結構。

### <a name="remarks"></a>備註

`GetStockTextMetrics`函式會初始化`TEXTMETRIC`所指向結構*lptm*具有有效的度量資訊，如果成功或填滿零，如果不成功的結構。 使用此函式，而不是[GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics)時繪製控制項，因為控制項，例如任何內嵌 OLE 物件，可能需要將自己轉譯為中繼檔。

`TEXTMETRIC`結構的預設字型是重新整理時`SelectStockFont`呼叫函式。 只有在選取的內建的字型，以確保它所提供的資訊是有效之後，您應該呼叫此函式。

##  <a name="gettext"></a>  COleControl::GetText

會實作內建的 Text 或 Caption 屬性的 Get 函式。

```
BSTR GetText();
```

### <a name="return-value"></a>傳回值

目前的控制項文字字串或長度為零的字串是否有任何字串值。

> [!NOTE]
>  如需有關 BSTR 資料類型的詳細資訊，請參閱[資料型別](../../mfc/reference/data-types-mfc.md)巨集和全域區段中。

### <a name="remarks"></a>備註

請注意，此函式的呼叫端必須呼叫`SysFreeString`字串傳回以免費資源。 在控制項的實作中，使用`InternalGetText`存取控制的內建的 Text 或 Caption 屬性。

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

覆寫`GetWindowlessDropTarget`當您想將無視窗控制項作為目標的 OLE 拖放作業。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>傳回值

物件的指標`IDropTarget`介面。 因為它並沒有一個視窗，所以無法註冊無視窗物件`IDropTarget`介面。 不過，若要參與拖曳和置放，無視窗的物件可以仍實作介面，並傳回它在`GetWindowlessDropTarget`。

### <a name="remarks"></a>備註

通常這會需要將控制項的視窗登錄為置放目標。 但是，由於控制項沒有自己的視窗，容器會使用它自己的視窗做為置放目標。 控制項只需要提供的實作`IDropTarget`介面的容器可以在適當時委派呼叫。 例如: 

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

通知控制項將使用的 Iid 的基底類別。

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>參數

*piidPrimary*<br/>
控制項的主要分派介面的介面 ID 的指標。

*piidEvents*<br/>
控制項的事件介面的介面 ID 的指標。

### <a name="remarks"></a>備註

若要通知的介面識別碼將會使用您的控制項的基底類別的控制項的建構函式中呼叫此函式。

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

存取您的控制項的內建字型屬性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>傳回值

參考[CFontHolder](../../mfc/reference/cfontholder-class.md)包含內建的字型物件的物件。

##  <a name="internalgettext"></a>  COleControl::InternalGetText

存取您的控制項的內建 Text 或 Caption 屬性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>傳回值

控制項的文字字串的參考。

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

設定控制項的整備狀態。

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>參數

*lNewReadyState*<br/>
整備狀態，若要設定的控制項，下列值之一：

READYSTATE_UNINITIALIZED 預設初始設定狀態

READYSTATE_LOADING 控制項目前正在載入其屬性

已初始化 READYSTATE_LOADED 控制項

READYSTATE_INTERACTIVE 控制項有足夠的資料來進行互動式作業，但不是所有非同步資料尚未載入

READYSTATE_COMPLETE 控制項具有其所有資料

### <a name="remarks"></a>備註

大多數的簡單控制項永遠不需要區分 LOADED 和互動。 不過，支援的資料路徑屬性的控制項不可能已準備好進行互動式作業，直到至少部分資料以非同步方式接收。 控制項應該嘗試儘速成為互動式。

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

強制控制項將重繪其本身。

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
控制項是即將失效的區域指標。

*bErase*<br/>
指定是否要處理的更新區域時清除的背景更新區域內。

### <a name="remarks"></a>備註

如果*lpRect*具有 NULL 值，將會重新繪製整個控制項。 如果*lpRect*不是 NULL，這表示要失效之控制項的矩形的部分。 在控制項沒有視窗中，或不在目前作用中，矩形會被忽略，而進行呼叫，用戶端站台的情況下[IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange)成員函式。 使用此函式，而不是`CWnd::InvalidateRect`或`InvalidateRect`。

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

使給定區域內的 [容器] 視窗的用戶端區域失效。

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*pRgn*<br/>
指標[CRgn](../../mfc/reference/crgn-class.md)物件，可識別要使其失效，在包含視窗的工作區座標中的 OLE 物件的顯示區域。 如果此參數為 NULL，則範圍會是整個物件。

*bErase*<br/>
指定是否要清除失效的區域內的背景。 如果為 TRUE，則會清除的背景。 如果為 FALSE，則背景會維持不變。

### <a name="remarks"></a>備註

這可用來重繪其容器內的無視窗控制項。 失效的區域，以及所有其他區域中更新區域中，已標示為要繪製的時機下一步[WM_PAINT](/windows/desktop/gdi/wm-paint)傳送訊息。

如果*bErase*的更新區域，在整個區域中，不只是在特定的組件，任何的背景部分都會清除，則為 TRUE。

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

可特製化的載入 OLE 控制項。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>傳回值

正在轉換控制項; 如果為非零否則為 0。

### <a name="remarks"></a>備註

當轉換使用 VBX 的表單控制項使用 OLE 控制項的其中一個時，則可能需要 OLE 控制項的特殊的載入程式碼。 比方說，如果您正在載入您的 OLE 控制項的執行個體，您可能必須呼叫[PX_Font](persistence-of-ole-controls.md#px_font)中您`DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

不過，VBX 控制項沒有字型物件;個別儲存每個字型屬性。 在此案例中，您會使用`IsConvertingVBX`區別這兩種案例：

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

另一種情況是如果 VBX 控制項儲存專屬的二進位資料 （在其 VBM_SAVEPROPERTY 訊息處理常式），而您的 OLE 控制項將其二進位資料儲存在不同的格式。 如果您想要您 OLE 控制項與舊版相容以 VBX 控制項，您可以閱讀這兩種舊的和新格式使用`IsConvertingVBX`藉由區分是否正在載入 VBX 控制項或 OLE 控制項的函式。

在您的控制項`DoPropExchange`函式，您可以檢查這個條件，而如果為 true，再執行載入特定的這項轉換 （例如上述範例中） 的程式碼。 如果控制項不會進行轉換，您可以執行正常負載的程式碼。 這項功能僅適用於從 VBX 對應項目正在轉換的控制項。

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

可讓自動化方法引動過程。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>傳回值

初始化的控制項; 如果為非零否則為 0。

### <a name="remarks"></a>備註

架構的實作`IDispatch::Invoke`呼叫`IsInvokeAllowed`以判斷指定的函式 (由`dispid`) 可能會叫用。 OLE 控制項的預設行為是允許自動化的方法，來初始化的控制項; 時，才會叫用不過，`IsInvokeAllowed`是虛擬函式，而且可能會覆寫必要時 （例如，當控制項用做 automation 伺服程式）。 如需詳細資訊，請參閱知識庫文章 Q166472，"如何： 使用 OLE 控制項為 Automation 伺服器。 」 知識庫文件位於[ http://support.microsoft.com ](http://support.microsoft.com/)。

##  <a name="ismodified"></a>  COleControl::IsModified

決定是否已修改控制項的狀態。

```
BOOL IsModified();
```

### <a name="return-value"></a>傳回值

如果自上次儲存; 已修改控制項的狀態，非零值。否則為 0。

### <a name="remarks"></a>備註

屬性值變更時，會修改控制項的狀態。

##  <a name="isoptimizeddraw"></a>  Colecontrol:: Isoptimizeddraw

判斷容器是否支援目前的繪圖作業最佳化的繪圖。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>傳回值

如果容器為目前的繪圖作業; 支援最佳化的繪圖，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如果支援最佳化的繪圖，然後控制項需要選取舊的畫筆、 筆刷、 字型 （等） 的物件放入裝置內容完成繪圖。

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

由架構呼叫以判斷是否控制項子類別的 Windows 控制。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>傳回值

如果控制項子類別化; 非零值否則為 0。

### <a name="remarks"></a>備註

您必須覆寫這個函式，並傳回 TRUE，如果您的 OLE 控制項的子類別的 Windows 控制項。

##  <a name="load"></a>  COleControl::Load

重設任何先前的資料，以非同步方式載入，並起始新的載入控制項的非同步屬性。

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>參數

*strNewPath*<br/>
包含參考的非同步控制項屬性的絕對位置路徑的字串指標。

*prop*<br/>
A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)實作非同步控制項屬性的物件。

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

容器可防止停用您的控制項。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>參數

*區塊*<br/>
如果鎖定，則為控制項的就地使用中狀態，則為 TRUE。如果要解除鎖定，則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則鎖定，則為非零否則為 0。

### <a name="remarks"></a>備註

請注意，每個控制項的鎖定必須搭配控制項完成後解除鎖定。 您應該只鎖定您的控制項期限很短，例如時引發事件。

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

當容器的環境屬性變更值時，由架構呼叫。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>參數

*dispID*<br/>
環境屬性有所變更，請的分派識別碼或 DISPID_UNKNOWN 如果多個屬性已變更。

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

內建的外觀屬性值變更時由架構呼叫。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>備註

如果您想要在這個屬性變更後的通知，請覆寫這個函式。 預設實作會呼叫`InvalidateControl`。

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

內建的背景色彩屬性值變更時由架構呼叫。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>備註

如果您想要在這個屬性變更後的通知，請覆寫這個函式。 預設實作會呼叫`InvalidateControl`。

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

內建的 BorderStyle 屬性值變更時由架構呼叫。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>備註

預設實作會呼叫`InvalidateControl`。

如果您想要在這個屬性變更後的通知，請覆寫這個函式。

##  <a name="onclick"></a>  COleControl::OnClick

已按下滑鼠按鈕，或已叫用 DoClick 內建方法時，由架構呼叫。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>參數

*iButton*<br/>
滑鼠按鈕的索引。 可以有下列值之一：

- LEFT_BUTTON 按下滑鼠左的按鈕。

- MIDDLE_BUTTON 按下滑鼠中間鍵。

- RIGHT_BUTTON 按下滑鼠右按鈕。

### <a name="remarks"></a>備註

預設實作會呼叫`COleControl::FireClick`。

覆寫來修改或擴充的預設處理此成員函式。

##  <a name="onclose"></a>  COleControl::OnClose

當容器呼叫該控制項時，由架構呼叫`IOleControl::Close`函式。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>參數

*dwSaveOption*<br/>
旗標，指出是否應該在載入之前儲存物件。 有效值為：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>備註

根據預設，`OnClose`將儲存的控制項物件，如果已修改並*dwSaveOption* OLECLOSE_SAVEIFDIRTY 或 OLECLOSE_PROMPTSAVE。

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

當容器呼叫，由架構呼叫`IOleObject::DoVerb`成員函式。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*iVerb*<br/>
要叫用該控制動詞索引。

*lpMsg*<br/>
導致要叫用動詞命令的 Windows 訊息指標。

*hWndParent*<br/>
控制項的父視窗控制代碼。 如果此動詞命令的執行會建立視窗 （或 windows）， *hWndParent*應做為父系。

*lpRect*<br/>
控制項，相對於容器，座標將會複製到其中 RECT 結構的指標。

### <a name="return-value"></a>傳回值

如果呼叫不成功則為非零否則為 0。

### <a name="remarks"></a>備註

預設實作會使用 ON_OLEVERB 和 ON_STDOLEVERB 的訊息對應項目，來判斷要叫用適當的函式。

覆寫這個函式來變更動詞命令的預設處理。

##  <a name="ondraw"></a>  COleControl::OnDraw

由架構呼叫以繪製指定的週框矩形，使用指定的裝置內容中的 OLE 控制項。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>參數

*pDC*<br/>
繪圖發生在哪個裝置內容。

*rcbounds 就*<br/>
控制項，包括框線的矩形區域。

*rcInvalid*<br/>
無效的控制項矩形區域。

### <a name="remarks"></a>備註

`OnDraw` 通常會呼叫進行螢幕顯示，傳遞做為螢幕裝置內容*pDC*。 *Rcbounds 就*參數會識別在目標裝置內容 （相對於其目前的對應模式） 的矩形。 *RcInvalid*參數是無效的實際矩形。 在某些情況下，這會是較小的區域，比*rcbounds 就*。

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

由架構呼叫以繪製指定的週框矩形，使用指定的中繼檔裝置內容中的 OLE 控制項。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
繪圖發生在哪個裝置內容。

*rcbounds 就*<br/>
控制項，包括框線的矩形區域。

### <a name="remarks"></a>備註

預設實作會呼叫[OnDraw](#ondraw)函式。

##  <a name="onedit"></a>  COleControl::OnEdit

使控制項由 UI 啟動。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令的 Windows 訊息指標。

*hWndParent*<br/>
控制項的父視窗控制代碼。

*lpRect*<br/>
矩形容器中控制項所使用的指標。

### <a name="return-value"></a>傳回值

如果呼叫成功則為非零否則為 0。

### <a name="remarks"></a>備註

這有相同的效果與叫用控制項的 OLEIVERB_UIACTIVATE 動詞命令。

此函式通常用於和的處理常式函式 ON_OLEVERB 訊息對應項目。 這提供"Edit"動詞命令功能表中控制項的 「 物件 」。 例如: 

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

當股票 Enabled 屬性值變更時由架構呼叫。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>備註

如果您想要在這個屬性變更後的通知，請覆寫這個函式。 預設實作會呼叫[InvalidateControl](#invalidatecontrol)。

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

當容器呼叫，由架構呼叫`IOleObject::EnumVerbs`成員函式。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>參數

*ppenumOleVerb*<br/>
指標`IEnumOLEVERB`列舉控制項的動詞命令的物件。

### <a name="return-value"></a>傳回值

非零值，如果動詞命令可供使用;否則為 0。

### <a name="remarks"></a>備註

預設實作會列舉 ON_OLEVERB 中的項目訊息對應。

覆寫這個函式來變更預設的建立方式的列舉的動詞命令。

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

當連接或中斷連線的 OLE 控制項的事件處理常式時，由架構呼叫。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>參數

*bAdvise*<br/>
TRUE 表示事件處理常式已連接到控制項。 FALSE 表示事件處理常式已中斷連線從控制項。

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

內建的字型屬性值變更時由架構呼叫。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>備註

預設實作會呼叫`COleControl::InvalidateControl`。 如果控制項子類別化 Windows 控制項，預設實作也會 WM_SETFONT 訊息傳送至控制項的視窗。

如果您想要在這個屬性變更後的通知，請覆寫這個函式。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

內建的前景色彩屬性值變更時由架構呼叫。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>備註

預設實作會呼叫`InvalidateControl`。

如果您想要在這個屬性變更後的通知，請覆寫這個函式。

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

容器呼叫之後，由架構呼叫`IOleControl::FreezeEvents`。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>參數

*bFreeze*<br/>
如果控制項的事件處理已凍結。否則為 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作。

如果您想要其他的行為，事件處理會凍結或解除凍結時，請覆寫這個函式。

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

當容器呼叫，由架構呼叫`IViewObject::GetColorSet`成員函式。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>參數

*ptd*<br/>
指向轉譯圖片的目標裝置。 這個值是 NULL，如果應該呈現圖片的預設目標裝置，通常顯示裝置。

*hicTargetDev*<br/>
指定所指定的目標裝置上的資訊內容*ptd*。 這個參數可以是裝置內容，但不是其中一定。 如果*ptd*為 NULL，就*hicTargetDev*也應該是 NULL。

*ppColorSet*<br/>
可用的色彩應該複製到其中的位置指標。 如果函式不會傳回色彩設定，則會傳回 NULL。

### <a name="return-value"></a>傳回值

非零值，如果傳回有效的色彩集;否則為 0。

### <a name="remarks"></a>備註

容器會呼叫此函式可取得要繪製 OLE 控制項所需的所有色彩。 容器可以使用取得搭配需要設定整體的調色盤色彩的色彩集。 預設實作會傳回 FALSE。

覆寫這個函式來執行這項要求的任何特殊處理。

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

當控制項容器已要求控制項的相關資訊，由架構呼叫。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>參數

*pControlInfo*<br/>
指標[檓 CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo)来填入結構。

### <a name="remarks"></a>備註

這項資訊主要是包含控制項的助憶鍵的描述。 預設實作會填滿*pControlInfo*預設資訊。

如果您的控制項需要處理助憶鍵，請覆寫這個函式。

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

由架構呼叫以取得字串，表示所識別之屬性的目前值*dispid*。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*strValue*<br/>
參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件傳遞為字串傳回。

### <a name="return-value"></a>傳回值

如果字串中傳回非零*strValue;* 反之則為 0。

### <a name="remarks"></a>備註

如果您的控制項有的屬性，其值無法直接轉換成字串，而且您想要在容器提供屬性瀏覽器中顯示的屬性的值，請覆寫這個函式。

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

取得要合併到容器的現有功能表的功能表中啟動的 UI 控制項時，由架構呼叫。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>傳回值

控制項的功能表上或如果控制項有無則為 NULL 的控點。 預設實作會傳回 NULL。

### <a name="remarks"></a>備註

如需有關合併 OLE 資源的詳細資訊，請參閱文章[功能表和資源 (OLE)](../../mfc/menus-and-resources-ole.md)。

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

呼叫以回應容器的 framework`IViewObjectEx::GetNaturalExtent`要求。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 表示包含內容、 圖示、 縮圖或列印的文件。 有效的值取自列舉[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*lindex*<br/>
物件，為感興趣的部分。 目前只支援-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)定義傳回的物件大小的目標裝置的結構。

*hicTargetDev*<br/>
指定所指定的目標裝置的資訊內容*ptd*參數物件可以從中擷取裝置度量資訊，並測試裝置的功能。 如果*ptd*是 NULL，該物件應該忽略中的值*hicTargetDev*參數。

*pExtentInfo*<br/>
指向`DVEXTENTINFO`結構，指定調整大小資料。 `DVEXTENTINFO`結構是：

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

結構成員`dwExtentMode`可能需要兩個值之一：

- DVEXTENT_CONTENT 詢問有多大的控制項應該是以完全符合 內容 （嵌入式管理單元的大小）

- DVEXTENT_INTEGRAL 時調整大小，建議的大小傳遞至控制項

*psizel*<br/>
若要調整大小的控制項所傳回的資料點。 傳回的調整大小資料設為-1，下限不調整任何維度。

### <a name="return-value"></a>傳回值

非零值，如果成功傳回，或調整大小;否則為 0。

### <a name="remarks"></a>備註

覆寫此函式可傳回物件的顯示大小的建議的大小和範圍模式中最接近`DVEXTENTINFO`結構。 預設實作會傳回 FALSE，並可讓不會調整大小。

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

由架構呼叫以取得一組預先定義的字串，表示屬性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*pStringArray*<br/>
字串陣列，以填滿中傳回的值。

*pCookieArray*<br/>
若要在以填滿的 DWORD 陣列傳回值。

### <a name="return-value"></a>傳回值

如果項目已新增為非零*pStringArray*並*pCookieArray*。

### <a name="remarks"></a>備註

如果您的控制項有一組可能的值可以以字串表示的屬性，請覆寫這個函式。 加入至每個項目的*pStringArray*，您應該加入至對應的"cookie"項目*pCookieArray。* 這些"cookie"值稍後將傳遞由架構`COleControl::OnGetPredefinedValue`函式。

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

由架構呼叫以取得對應至其中一個預先定義的覆寫先前傳回的字串值`COleControl::OnGetPredefinedStrings`。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*dwCookie*<br/>
覆寫先前傳回的 cookie 值`COleControl::OnGetPredefinedStrings`。

*lpvarOut*<br/>
指標`VARIANT`結構，透過將傳回的屬性值。

### <a name="return-value"></a>傳回值

如果已傳回的值，在為非零*lpvarOut*，否則為 0。

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

呼叫以回應容器的架構所[IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent)要求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>參數

*dwDrawAspect*<br/>
會顯示為描述表單或物件的外觀，DWORD。 有效的值取自列舉[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*lindex*<br/>
物件，為感興趣的部分。 目前只支援-1 是有效的。

*ptd*<br/>
指向[DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice)定義傳回的物件大小的目標裝置的結構。

*lpsizel*<br/>
要傳回物件大小之位置的位置點。

### <a name="return-value"></a>傳回值

非零值，如果成功地傳回範圍資訊;否則為 0。

### <a name="remarks"></a>備註

如果您的控制項使用兩段式繪圖，且其不透明且透明的組件有不同的維度，請覆寫這個函式。

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

呼叫以回應容器的 framework`IViewObjectEx::GetRect`要求。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
會顯示為描述表單或物件的外觀，DWORD。 有效的值取自列舉[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2:

- DVASPECT_CONTENT 週框矩形的整個物件。 物件的原始和大小等於傳回範圍的左上角`GetViewExtent` *。*

- 矩形的不透明區域 DVASPECT_OPAQUE 物件傳回該矩形。 其他失敗。

- 涵蓋所有的時間緊迫或透明部分 DVASPECT_TRANSPARENT 矩形。

*pRect*<br/>
指向[RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907)結構，指定應該在其中繪製物件的矩形。 此參數控制的定位和延伸的物件。

### <a name="return-value"></a>傳回值

非零值，如果成功傳回物件大小的矩形;否則為 0。

### <a name="remarks"></a>備註

物件的大小由轉換`OnGetViewRect`到特定的位置 （預設為顯示的左上的角） 開始的矩形。 如果您的控制項使用兩段式繪圖，且其不透明且透明的組件有不同的維度，請覆寫這個函式。

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

呼叫以回應容器的 framework`IViewObjectEx::GetViewStatus`要求。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>傳回值

如果成功則 forced VIEWSTATUS 列舉之值的其中一項否則為 0。 可能的值是以下的任何組合：

VIEWSTATUS_OPAQUE 物件是完全不透明的。 如果未設定此位元，則物件會包含透明的組件。 僅給與內容相關的層面，而非 DVASPECT_ICON 或 DVASPECT_DOCPRINT，適用於此位元。

VIEWSTATUS_SOLIDBKGND 物件都有單純的背景 （包含純色，不是筆刷樣式）。 VIEWSTATUS_OPAQUE 設定，而且只適用於內容方面和不適用於 DVASPECT_ICON 或 DVASPECT_DOCPRINT 時，才有意義此位元。

VIEWSTATUS_DVASPECTOPAQUE 物件支援 DVASPECT_OPAQUE。 所有 IViewObjectEx 方法採取參數也可以呼叫這方面的繪圖的外觀。

VIEWSTATUS_DVASPECTTRANSPARENT 物件支援 DVASPECT_TRANSPARENT。 所有`IViewObjectEx`採用繪圖的外觀，如這方面也可以呼叫參數的方法。

### <a name="remarks"></a>備註

如果您的控制項使用兩段式繪圖，請覆寫這個函式。 預設實作會傳回 VIEWSTATUS_OPAQUE。

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

當控制項已停用的 UI，由架構呼叫。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>備註

實作應該隱藏所顯示的所有工具列`OnShowToolbars`。

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

呼叫下滑鼠指標在 WM_MOUSEMOVE 訊息回條上的非作用中物件的容器。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
週框矩形，在包含視窗的工作區座標的物件。 會告訴物件其確切的位置和大小在螢幕上收到 WM_MOUSEMOVE 訊息時。

*x*<br/>
包含視窗的工作區座標中滑鼠位置的 x 座標。

*y*<br/>
包含視窗的工作區座標中滑鼠位置的 y 座標。

*dwKeyState*<br/>
識別鍵盤上的鍵盤輔助按鍵的目前狀態。 有效的值可以是任何 MK_CONTROL、 MK_SHIFT、 MK_ALT、 MK_BUTTON、 MK_LBUTTON、 MK_MBUTTON 和 MK_RBUTTON 的旗標的組合。

### <a name="remarks"></a>備註

請注意視窗工作區座標 （像素為單位） 用來傳遞滑鼠資料指標位置。 這麼做，可以藉由也在相同的座標系統中傳遞之物件的週框矩形。

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

呼叫下接收 WM_SETCURSOR 訊息將滑鼠指標的非作用中物件的容器。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
週框矩形，在包含視窗的工作區座標的物件。 會告訴物件其確切的位置和大小在螢幕上時接收 WM_SETCURSOR 訊息。

*x*<br/>
包含視窗的工作區座標中滑鼠位置的 x 座標。

*y*<br/>
包含視窗的工作區座標中滑鼠位置的 y 座標。

*dwMouseMsg*<br/>
WM_SETCURSOR 所發生的滑鼠訊息的識別碼。

*bSetAlways*<br/>
指定物件必須設定資料指標。 必須設定資料指標; 如果為 TRUE，該物件如果為 FALSE，資料指標沒有義務設定資料指標，並應在此情況下傳回 S_FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

請注意視窗工作區座標 （像素為單位） 用來傳遞滑鼠資料指標位置。 這麼做，可以藉由也在相同的座標系統中傳遞之物件的週框矩形。

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

在處理的內建的 KeyDown 事件後，由架構呼叫。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*NChar*<br/>
按下的按鍵虛擬按鍵碼值。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

### <a name="remarks"></a>備註

如果在引發事件之後，您的控制項需要存取金鑰的資訊，請覆寫這個函式。

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

股票已經引發 KeyPress 事件後，由架構呼叫。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>參數

*NChar*<br/>
包含虛擬按鍵碼值的按鍵。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

### <a name="remarks"></a>備註

請注意， *nChar*值可能已修改的容器。

如果您想要通知，就會發生此事件之後，請覆寫此函式。

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

在處理的內建的 KeyDown 事件後，由架構呼叫。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*NChar*<br/>
按下的按鍵虛擬按鍵碼值。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h

*nShiftState*<br/>
包含下列旗標的組合：

- 動作期間已按下 SHIFT_MASK SHIFT 鍵。

- CTRL_MASK 已按下 CTRL 鍵時的動作。

- 動作期間已按下 ALT_MASK ALT 鍵。

### <a name="remarks"></a>備註

如果在引發事件之後，您的控制項需要存取金鑰的資訊，請覆寫這個函式。

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

由架構呼叫以取得實作指定的屬性編輯的屬性頁的類別識別碼。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>參數

*dispid*<br/>
控制項屬性的分派識別碼。

*lpclsid*<br/>
指標`CLSID`結構，透過將傳回的類別識別碼。

*pbPageOptional*<br/>
傳回使用指定的屬性頁的是否為選擇性的指標。

### <a name="return-value"></a>傳回值

如果類別識別碼傳入為非零*lpclsid*，否則為 0。

### <a name="remarks"></a>備註

覆寫此函式可提供方法來叫用容器的屬性瀏覽器從您的控制項屬性頁。

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

容器已偵測到的 OLE 控制項的助憶鍵已按下時由架構呼叫。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>參數

*pMsg*<br/>
助憶鍵 (Mnemonic) 按鍵所產生之 Windows 訊息的指標。

##  <a name="onproperties"></a>  COleControl::OnProperties

已叫用容器的控制項屬性的動詞時由架構呼叫。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
叫用動詞命令的 Windows 訊息指標。

*hWndParent*<br/>
控制項的父視窗控制代碼。

*lpRect*<br/>
矩形容器中控制項所使用的指標。

### <a name="return-value"></a>傳回值

如果呼叫成功則為非零否則為 0。

### <a name="remarks"></a>備註

預設實作會顯示強制回應屬性對話方塊。

您也可以使用此函式，讓您的控制項屬性頁的顯示方式。 呼叫以`OnProperties`函式，將您的控制項父代中的控制代碼傳遞*hWndParent*參數。 在此案例中的值*lpMsg*並*lpRect*參數都會被忽略。

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

呼叫以回應容器的 framework`IViewObjectEx::QueryHitPoint`要求。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件的呈現方式。 有效的值取自列舉[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指標`RECT`結構，指定 OLE 控制項的用戶端區域的週框矩形。

*ptlLoc*<br/>
指標`POINT`結構，指定要叫用檢查點。 OLE 用戶端區域座標中指定的點。

*lCloseHint*<br/>
定義 「 關閉 」 到點檢查之點擊的距離。

*pHitResult*<br/>
指標，叫用查詢的結果。 下列其中一個值：

- HITRESULT_OUTSIDE *ptlLoc*是外部的 OLE 物件，並不會關閉。

- HITRESULT_TRANSPARENT *ptlLoc* OLE 物件，但不是接近影像的界限內。 比方說，透明的圓點可能是 HITRESULT_TRANSPARENT。

- HITRESULT_CLOSE *ptlLoc*是內部或外部的 OLE 物件，但關閉不夠，才會被視為內部物件。 小型、 精簡型，或詳細物件可能會使用此值。 即使點超出的周框矩形的物件，它可能仍會關閉 （此為所需達到小型物件）。

- HITRESULT_HIT *ptlLoc*內物件的映像。

### <a name="return-value"></a>傳回值

非零值，如果成功地傳回叫用的結果;否則為 0。 叫用是與 OLE 控制項顯示區域重疊。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否重疊指定的時間點 （叫用點）。 `QueryHitPoint` 您可以覆寫測試非矩形物件的點擊數。

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

呼叫以回應容器的 framework`IViewObjectEx::QueryHitRect`要求。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 有效的值取自列舉[DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指標`RECT`結構，指定 OLE 控制項的用戶端區域的週框矩形。

*prcLoc*<br/>
指標`RECT`結構，指定要檢查的叫用 （重疊，物件的矩形），相對於物件的左上角的矩形。

*lCloseHint*<br/>
未使用。

*pHitResult*<br/>
指標，叫用查詢的結果。 下列其中一個值：

- HITRESULT_OUTSIDE 不遇到 OLE 物件的矩形中的任何點。

- HITRESULT_HIT 的矩形中的至少一個點會在物件上的叫用。

### <a name="return-value"></a>傳回值

非零值，如果成功地傳回叫用的結果;否則為 0。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否重疊的任何時間點指定的矩形 （叫用矩形）。 `QueryHitRect` 您可以覆寫測試非矩形物件的點擊數。

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

由架構呼叫以擷取指定格式的資料。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)結構，指定用來要求資訊的格式。

*lpStgMedium*<br/>
指向[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)資料所要傳回的結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或是[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成員函式會延遲的轉譯。 此函式的預設實作會呼叫`OnRenderFileData`或`OnRenderGlobalData`分別，如果提供的存放媒體是檔案或記憶體。 如果要求的格式是 CF_METAFILEPICT 或持續性的屬性設定的格式，預設實作會呈現適當的資料，並傳回非零值。 否則，它會傳回 0，而不執行任何動作。

如果*lpStgMedium]-> [tymed*是 TYMED_NULL，應配置及填入所指定 STGMEDIUM *lpFormatEtc]-> [tymed*。 如果不是在與資料的位置，則應該填入 TYMED_NULL、 STGMEDIUM。

覆寫此函式可提供您要求的格式和媒體中的資料。 根據您的資料，您可能想要改為覆寫這個函式的其他版本的其中一個。 如果您的資料是小型且固定的大小，會覆寫`OnRenderGlobalData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。

如需詳細資訊，請參閱 <<c0> `FORMATETC` 和`STGMEDIUM`Windows SDK 中的結構。

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

由架構呼叫以擷取指定之格式的資料儲存體中的檔案時。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)結構，指定用來要求資訊的格式。

*pFile*<br/>
指向[CFile](../../mfc/reference/cfile-class.md)所在的資料是要轉譯的物件。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延遲轉譯的成員函式。 此函式的預設實作只會傳回 FALSE。

覆寫此函式可提供您要求的格式和媒體中的資料。 根據您的資料，您可能想要改為覆寫這個函式的其他版本的其中一個。 如果您想要處理多個儲存體媒介中轉移，覆寫`OnRenderData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。

如需詳細資訊，請參閱`FORMATETC`Windows SDK 中的結構。

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

由架構呼叫以指定的存放媒體是全域記憶體時，擷取指定之格式的資料。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)結構，指定用來要求資訊的格式。

*phGlobal*<br/>
指向要傳回之資料的全域記憶體控制代碼。 如果已不配置任何記憶體，則這個參數可以是 NULL。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延遲轉譯的成員函式。 此函式的預設實作只會傳回 FALSE。

如果*phGlobal*是 NULL，則應該配置並傳回新 HGLOBAL *phGlobal*。 HGLOBAL 所指定的否則為*phGlobal*應該填入資料。 資料放在 HGLOBAL 數量不得超過目前的記憶體區塊大小。 此外，無法重新配置較大的區塊。

覆寫此函式可提供您要求的格式和媒體中的資料。 根據您的資料，您可能想要改為覆寫這個函式的其他版本的其中一個。 如果您想要處理多個儲存體媒介中轉移，覆寫`OnRenderData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。

如需詳細資訊，請參閱`FORMATETC`Windows SDK 中的結構。

##  <a name="onresetstate"></a>  COleControl::OnResetState

控制項的屬性應該設定為其預設值時，由架構呼叫。

```
virtual void OnResetState();
```

### <a name="remarks"></a>備註

預設實作會呼叫[DoPropExchange](#dopropexchange)，並傳遞`CPropExchange`讓屬性設為其預設值的物件。

控制寫入器可以在此插入 OLE 控制項的初始化程式碼可覆寫。 此函式時，會呼叫[ipersiststream:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load)或是[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)失敗，或[IPersistStreamInit::InitNew](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)或[IPersistStorage:: InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew)呼叫，而不需要第一個呼叫其中一個`IPersistStream::Load`或`IPersistStorage::Load`。

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

當容器呼叫該控制項時，由架構呼叫`IOleControl::SetClientSite`函式。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>備註

根據預設，`OnSetClientSite`檢查是否已載入的資料路徑屬性，並如有需要，會呼叫`DoDataPathPropExchange`。

覆寫這個函式來執行這項通知的任何特殊處理。 特別是，此函式的覆寫應呼叫基底類別。

##  <a name="onsetdata"></a>  COleControl::OnSetData

由架構呼叫以指定的資料取代控制項的資料。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指標[FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc)結構，指定資料的格式。

*lpStgMedium*<br/>
指標[STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium)結構，位在其中的資料。

*bRelease*<br/>
如果控制項應該釋放儲存媒體中;，則為 TRUE。如果控制項應該不會釋放儲存媒體，則為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果資料中的持續性的屬性會設定格式，預設實作會據以修改控制項的狀態。 否則，預設實作沒有任何作用。 如果*bRelease*為 TRUE，則呼叫`ReleaseStgMedium`進行; 否則為 not。

覆寫這個函式將控制項的資料取代成指定的資料。

如需詳細資訊，請參閱 <<c0> `FORMATETC` 和`STGMEDIUM`Windows SDK 中的結構。

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

控制項的寬度需要變更，由於呼叫時，由架構呼叫[IOleObject::SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent)。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>參數

*lpSizeL*<br/>
指標`SIZEL`使用長整數來代表控制項，表示以 himetric 為單位的高度與寬度的結構。

### <a name="return-value"></a>傳回值

非零值，如果已接受的大小變更;否則為 0。

### <a name="remarks"></a>備註

預設實作會處理控制項的寬度調整大小。 如果控制項是就地啟用作用中，容器的呼叫`OnPosRectChanged`再進行。

覆寫這個函式來改變您的控制項預設調整大小。

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

由架構呼叫以實作呼叫[IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>參數

*lpRectPos*<br/>
指標`RECT`指出控制項的新位置和大小，相對於容器的結構。

*lpRectClip*<br/>
指標`RECT`結構表示的控制項是要裁剪的矩形區域。

### <a name="return-value"></a>傳回值

如果接受重新定位; 非零值否則為 0。

### <a name="remarks"></a>備註

預設實作自動處理重新定位和調整控制項視窗的大小，並傳回 TRUE。

覆寫這個函式來變更此函式的預設行為。

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

當控制項以 UI 啟動時由架構呼叫。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>備註

預設實作不做任何動作。

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

內建的標題或文字屬性值變更時由架構呼叫。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>備註

預設實作會呼叫`InvalidateControl`。

如果您想要在這個屬性變更後的通知，請覆寫這個函式。

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

呼叫以回應容器的 framework`IOleInPlaceObjectWindowless::OnWindowMessage`要求。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>參數

*訊息*<br/>
Windows 所傳送的訊息識別碼。

*wParam*<br/>
Windows 所傳送。 指定特定訊息的其他資訊。 此參數的內容而定的值*msg*參數。

*lParam*<br/>
Windows 所傳送。 指定特定訊息的其他資訊。 此參數的內容而定的值*msg*參數。

*plResult*<br/>
Windows 結果碼。 指定訊息處理的結果，取決於傳送的訊息。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

處理無視窗控制項的視窗訊息。 `COleControl``OnWindowlessMessage`應該用於訊息滑鼠和鍵盤訊息以外的視窗訊息。 `COleControl` 提供[SetCapture](#setcapture)並[SetFocus](#setfocus)特別為取得無視窗的 OLE 物件中的滑鼠捕捉和鍵盤焦點。

無視窗的物件不具有一個視窗，因為他們需要一個機制，讓容器分派訊息給他們。 無視窗的 OLE 物件取得訊息從其容器中，透過`OnWindowMessage`方法`IOleInPlaceObjectWindowless`介面 (的延伸模組[IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject)無視窗的支援)。 `OnWindowMessage` 不接受`HWND`參數。

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

將轉譯的座標*pPoint*成用戶端座標。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
在容器中 OLE 控制項的界限的指標。 非工作區，但整個控制項，包括框線和捲軸的區域。

*pPoint*<br/>
轉譯控制項的用戶端區域的座標為指向父代 （容器） 的指標。

*bHitTest*<br/>
指定點擊測試是在該點上執行。

### <a name="return-value"></a>傳回值

如果*bHitTest*是 FALSE，則傳回 HTNOWHERE。 如果*bHitTest*為 TRUE，否則，會傳回父代 （容器） 點所在的位置位於 OLE 控制項的工作區，而且是其中一個下列的滑鼠點擊測試的值：

- HTBORDER 框線中並沒有縮放邊框的視窗。

- HTBOTTOM 中較低的水平框線的視窗中。

- HTBOTTOMLEFT 中視窗框線的左下角。

- HTBOTTOMRIGHT 中視窗框線的右下角。

- HTCAPTION 在標題列區域中。

- HTCLIENT 中工作區中。

- HTERROR 上的螢幕背景或視窗之間的分隔線 (HTNOWHERE 相同除了`DefWndProc`Windows 函式會產生系統嗶聲，表示錯誤)。

- HTGROWBOX 大小 方塊中。

- HTHSCROLL 中水平捲軸。

- HTLEFT 中左框線的視窗中。

- HTMAXBUTTON 中最大化 按鈕。

- HTMENU 中的功能表區域中。

- HTMINBUTTON 中最小化 按鈕。

- 在畫面背景 HTNOWHERE 或視窗之間的分隔線。

- HTREDUCE 中最小化 按鈕。

- HTRIGHT 中右框線的視窗中。

- HTSIZE 大小 方塊中 （如同 HTGROWBOX）。

- 在 [HTSYSMENU 控制] 功能表或在子視窗 [關閉] 按鈕。

- HTTOP 中上方的水平框線的視窗中。

- HTTOPLEFT 中視窗框線的左上角。

- HTTOPRIGHT 中視窗框線的右上角。

- HTTRANSPARENT 在視窗中目前受到另一個視窗中。

- HTVSCROLL 在垂直捲軸。

- HTZOOM 中最大化 按鈕。

### <a name="remarks"></a>備註

在輸入*pPoint*是相對於父代 （左上角的容器） 的原點。 在輸出*pPoint*是相對於原點的 OLE 控制項 （控制項的用戶端區域的左上角） 的工作區。

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

通知容器的強制回應對話方塊已關閉。

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊的父視窗的控制代碼。

### <a name="remarks"></a>備註

顯示任何強制回應對話方塊之後，呼叫此函式。 您必須呼叫此函式，讓容器可以啟用停用任何最上層視窗`PreModalDialog`。 此函式應該搭配呼叫`PreModalDialog`。

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

通知即將顯示強制回應對話方塊中的容器。

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWndParent*<br/>
強制回應對話方塊的父視窗的控制代碼。

### <a name="remarks"></a>備註

顯示任何強制回應對話方塊之前呼叫此函式。 您必須先呼叫此函式，使容器可以停用所有最上層的視窗。 已顯示強制回應對話方塊之後，您則必須呼叫`PostModalDialog`。

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

終結並重新建立控制項的視窗。

```
void RecreateControlWindow();
```

### <a name="remarks"></a>備註

這可能需要變更視窗的樣式位元。

##  <a name="refresh"></a>  COleControl::Refresh

強制重新繪製的 OLE 控制項。

```
void Refresh();
```

### <a name="remarks"></a>備註

此函式受到`COleControl`基底類別，做為內建方法，稱為 「 重新整理。 這可讓您的 OLE 控制項的使用者重新繪製控制項，在特定時間。 如需有關這個方法的詳細資訊，請參閱文章[ActiveX 控制項： 方法](../../mfc/mfc-activex-controls-methods.md)。

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

滑鼠捕捉釋放。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果控制項目前具有滑鼠捕捉，則會釋放捕捉。 否則，此函式沒有任何作用。

##  <a name="releasedc"></a>  COleControl::ReleaseDC

釋放容器之釋放裝置內容，以便使用其他應用程式的無視窗控制項的顯示裝置內容。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
識別要釋放的容器的裝置內容。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

應用程式必須呼叫`ReleaseDC`每次呼叫[GetDC](#getdc)。

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

設定控制項的父代。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>參數

*hWndOuter*<br/>
控制項視窗的控制代碼。

*hWndParent*<br/>
新的父視窗的控制代碼。

### <a name="remarks"></a>備註

呼叫此函式來重設控制項視窗的父代。

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

初始化的狀態`COleControl`內建屬性設為預設值。

```
void ResetStockProps();
```

### <a name="remarks"></a>備註

屬性是： 外觀、 背景色彩、 框線樣式、 標題、 啟用、 字型、 前景色彩、 hWnd 和文字。 如需內建屬性的說明，請參閱 < [ActiveX 控制項： 加入內建屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

您可以使用來改善控制項的二進位初始化效能`ResetStockProps`並`ResetVersion`覆寫`COleControl::OnResetState`。 請參閱下列範例。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

初始化指定的值的版本號碼。

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>參數

*dwVersionDefault*<br/>
要指派給控制項的版本號碼。

### <a name="remarks"></a>備註

您可以使用來改善控制項的二進位初始化效能`ResetVersion`並`ResetStockProps`覆寫`COleControl::OnResetState`。 在範例，請參閱[ResetStockProps](#resetstockprops)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

可讓無視窗的 OLE 物件，以捲動內其就地使用中的 「 影像在螢幕上的區域。

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>參數

*xAmount*<br/>
以裝置為單位，水平捲動的指定單位的數量。 這個參數必須為負值，向左捲動。

*yAmount*<br/>
以裝置為單位，垂直捲動的指定單位的數量。 這個參數必須為負值，向上捲動。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或 RECT 結構，包含視窗的工作區座標中指定的 OLE 物件的工作區，以捲動時，部分。 如果*lpRect*為 NULL，就會捲動整個 OLE 物件的工作區。

*lpClipRect*<br/>
指向`CRect`物件或`RECT`結構，指定要剪輯的矩形。 在矩形內的像素會捲動。 在矩形的外面的位元不會影響，即使它們位於*lpRect*矩形。 如果*lpClipRect*是 NULL，不裁剪對捲軸的矩形。

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

放入裝置內容中選取的字型。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*pDC*<br/>
裝置內容物件的指標。

*fontHolder*<br/>
若要參考[CFontHolder](../../mfc/reference/cfontholder-class.md)物件，表示要選取的字型。

### <a name="return-value"></a>傳回值

先前選取的字型指標。 呼叫者完成使用的所有繪圖作業時*fontHolder，* 它應該傳遞為參數，來重新選取先前選取的字型[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)。

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

選取放入裝置內容中的內建字型屬性。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
裝置內容，其中將選取的字型。

### <a name="return-value"></a>傳回值

先前選取的指標`CFont`物件。 您應該使用[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)當您完成時，此字型選取回裝置內容。

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

序列化或初始化配置給控制項的顯示空間的狀態。

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
A`CArchive`来序列化或從物件。

### <a name="remarks"></a>備註

您可以使用來改善控制項的二進位的持續性效能`SerializeExtent`， `SerializeStockProps`，並`SerializeVersion`覆寫`COleControl::Serialize`。 請參閱下列範例。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

序列化或初始化的狀態`COleControl`內建屬性： 外觀、 背景色彩、 框線樣式、 標題、 已啟用、 字型、 前景色彩和文字。

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
A`CArchive`来序列化或從物件。

### <a name="remarks"></a>備註

如需內建屬性的說明，請參閱 < [ActiveX 控制項： 加入內建屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

您可以使用來改善控制項的二進位的持續性效能`SerializeStockProps`， `SerializeExtent`，並`SerializeVersion`覆寫`COleControl::Serialize`。 如需範例，請參閱位於程式碼[SerializeExtent](#serializeextent)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

序列化或初始化控制項的版本資訊的狀態。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*ar*<br/>
A`CArchive`来序列化或從物件。

*dwVersionDefault*<br/>
控制項的目前版本號碼。

*bConvert*<br/>
指出是否持續性資料應轉換成最新格式儲存，或保留在相同的格式時載入時。

### <a name="return-value"></a>傳回值

控制項版本號碼。 如果正在載入指定的封存，`SerializeVersion`傳回載入從該保存的版本。 否則，它會傳回目前載入的版本。

### <a name="remarks"></a>備註

您可以使用來改善控制項的二進位的持續性效能`SerializeVersion`， `SerializeExtent`，並`SerializeStockProps`覆寫`COleControl::Serialize`。 如需範例，請參閱位於程式碼[SerializeExtent](#serializeextent)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項： 最佳化](../../mfc/mfc-activex-controls-optimization.md)。

##  <a name="setappearance"></a>  COleControl::SetAppearance

設定控制項的內建的外觀屬性值。

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>參數

*sAppearance*<br/>
A**簡短**(VT_I2) 值，以用於您控制項的外觀。 零值以一般設定控制項的外觀，值為 1 到 3D 設定控制項的外觀。

### <a name="remarks"></a>備註

如需有關內建屬性的詳細資訊，請參閱[ActiveX 控制項： 屬性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

設定控制項的內建的背景色彩屬性值。

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>參數

*dwBackColor*<br/>
用於繪製控制項的背景 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需更多有關使用這個屬性和其他相關屬性，請參閱文章[ActiveX 控制項： 屬性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

設定控制項的內建的 BorderStyle 屬性值。

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>參數

*sBorderStyle*<br/>
新框線樣式的控制項;0 表示沒有框線，而 1 表示正常的框線。

### <a name="remarks"></a>備註

[控制] 視窗會重新建立與`OnBorderStyleChanged`呼叫。

##  <a name="setcapture"></a>  COleControl::SetCapture

會使控制項的容器視窗，才會持有滑鼠捕捉的控制項的代表。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>傳回值

指標`CWnd`先前接收到滑鼠輸入的視窗物件。

### <a name="remarks"></a>備註

如果啟用並無視窗控制項，這個函式會導致控制項的容器視窗，才會擁有滑鼠捕捉，控制項的代表。 否則，這個函式會導致控制項本身接受滑鼠捕捉的擁有權 (相同`CWnd::SetCapture`)。

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

設定 OLE 控制項視窗的大小，並通知控制項站台正在變更的容器。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>參數

*cx*<br/>
像素為單位指定控制項的新寬度。

*cy*<br/>
指定新控制項的高度，單位為像素。

### <a name="return-value"></a>傳回值

如果呼叫成功，為非零否則為 0。

### <a name="remarks"></a>備註

此函式不應用於控制項的建構函式。

請注意，適用於控制 windows 的所有座標都是相對於控制項的左上角。

##  <a name="setenabled"></a>  COleControl::SetEnabled

設定內建控制項的 Enabled 屬性值。

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>參數

*bEnabled*<br/>
若要啟用; 若是，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

設定這個屬性之後,`OnEnabledChange`呼叫。

##  <a name="setfocus"></a>  COleControl::SetFocus

會使控制項的容器視窗，才會擁有輸入焦點的控制項的代表。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>傳回值

指標`CWnd`先前的輸入焦點，則為 NULL，如果沒有這類視窗的視窗物件。

### <a name="remarks"></a>備註

如果啟用並無視窗控制項，這個函式會導致控制項的容器視窗，才會擁有輸入焦點，控制項的代表。 輸入的焦點引導至容器的視窗的鍵盤輸入和容器會分派給 OLE 物件呼叫的所有後續的鍵盤訊息`SetFocus`。 任何先前擁有輸入的焦點的視窗會失去它。

如果並非無視窗控制項的控制項，此函式會造成本身才會擁有輸入焦點的控制項 (與相同`CWnd::SetFocus`)。

##  <a name="setfont"></a>  COleControl::SetFont

設定控制項的內建的字型屬性。

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>參數

*pFontDisp*<br/>
字型分派介面指標。

##  <a name="setforecolor"></a>  COleControl::SetForeColor

設定控制項的內建的前景色彩屬性值。

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>參數

*dwForeColor*<br/>
用於繪製控制項的前景 OLE_COLOR 值。

### <a name="remarks"></a>備註

如需更多有關使用這個屬性和其他相關屬性，請參閱文章[ActiveX 控制項： 屬性](../../mfc/mfc-activex-controls-properties.md)。

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

由架構呼叫以初始化控制項支援的資料格式的清單。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>備註

此預設實作會指定兩種格式： CF_METAFILEPICT 和持續性屬性設定。

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

設定 OLE 控制項的容器中第一次顯示時的大小。

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>參數

*cx*<br/>
像素為單位的 OLE 控制項的初始寬度。

*cy*<br/>
像素為單位的 OLE 控制項的初始高度。

### <a name="remarks"></a>備註

在您設定您的控制項的初始大小的建構函式呼叫此函式。 初始大小被以裝置單位或像素為單位。 建議您控制項的建構函式中進行此呼叫。

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

變更控制項的已修改的狀態。

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*bModified*<br/>
控制項的新值的修改旗標。 TRUE 表示已修改控制項的狀態;FALSE 表示只儲存控制項的狀態。

### <a name="remarks"></a>備註

發生變更時，此函式會影響控制項的永續性狀態的呼叫。 例如，如果持續性屬性的值變更時，呼叫這個函式*bModified* **，則為 TRUE**。

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

表示編輯要求已失敗。

```
void SetNotPermitted();
```

### <a name="remarks"></a>備註

呼叫此函式時`BoundPropertyRequestEdit`失敗。 此函式會擲回的例外狀況型別的`COleDispScodeException`表示不允許設定作業。

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

可防止使用者控制項的屬性值的修改。

```
void SetNotSupported();
```

### <a name="remarks"></a>備註

不支援的屬性值，由控制項的使用者修改其中的情況下呼叫此函式來取代任何屬性的 Set 函式。 其中一個範例會唯讀的屬性。

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

設定相對於容器，以裝置單位表示控制項的矩形的座標。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
矩形，包含新座標相對於容器中控制項的指標。

### <a name="return-value"></a>傳回值

如果呼叫成功，為非零否則為 0。

### <a name="remarks"></a>備註

如果控制項已開啟，它會調整大小;否則容器的`OnPosRectChanged`呼叫函式。

##  <a name="settext"></a>  COleControl::SetText

設定您的控制項內建的標題或文字屬性的值。

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>參數

*pszText*<br/>
字元字串指標。

### <a name="remarks"></a>備註

請注意，內建的標題和文字屬性都對應到相同的值。 這表示，其中一個屬性所做的變更會自動將變更這兩個屬性。 一般情況下，控制項應該支援股票標題或文字屬性，但非兩者。

##  <a name="throwerror"></a>  Colecontrol:: Throwerror

表示在控制項中錯誤的相符項目。

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);


void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*sc*<br/>
要報告的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項： 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。

*nDescriptionID*<br/>
字串資源識別碼的例外狀況報告。

*nHelpID*<br/>
要報告的主題說明識別碼。

*pszDescription*<br/>
字串，包含要報告的例外狀況的說明。

### <a name="remarks"></a>備註

此函式應該只從呼叫 Get 或 Set 函式內的 OLE 屬性或 OLE automation 方法的實作。 如果您需要對其他時間發生的錯誤，您應該引發內建的錯誤事件。

##  <a name="transformcoords"></a>  COleControl::TransformCoords

轉換座標之間 HIMETRIC 單位和容器的原生單位的值。

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>參數

*lpptlHimetric*<br/>
指標`POINTL`結構，其中包含以 himetric 為單位的座標。

*lpptfContainer*<br/>
指標`POINTF`結構包含容器的單位大小的座標。

*flags*<br/>
下列值的組合：

- XFORMCOORDS_POSITION 的容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- 容器的單位 XFORMCOORDS_HIMETRICTOCONTAINER 轉換 himetric 為單位。

- XFORMCOORDS_CONTAINERTOHIMETRIC 轉換容器的單位，以 himetric 為單位。

### <a name="remarks"></a>備註

前兩個旗標，XFORMCOORDS_POSITION 和 XFORMCOORDS_SIZE，指出是否應該將座標視為位置或大小。 剩餘的兩個旗標表示轉換的方向。

##  <a name="translatecolor"></a>  COleControl::TranslateColor

將色彩值轉換從 OLE_COLOR 資料型別[COLORREF](/windows/desktop/gdi/colorref)資料型別。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>參數

*clrColor*<br/>
OLE_COLOR 資料類型。 如需詳細資訊，請參閱 Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor)函式。

*hpal*<br/>
選擇性的調色盤，控制代碼可以是 NULL。

### <a name="return-value"></a>傳回值

定義穩固的 RGB （紅色、 綠色、 藍色） 32 位元色彩值色彩最接近*clrColor*裝置可代表的值。

### <a name="remarks"></a>備註

此函式可以將內建的前景色彩和背景色彩屬性 COLORREF 類型所使用的轉譯[CDC](../../mfc/reference/cdc-class.md)成員函式。

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

決定控制項之後載入從持續性的狀態時，是否應該使用的環境屬性的值做為預設值。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>傳回值

Nonzero 表示環境屬性會有效;否則環境屬性將不會有效。

### <a name="remarks"></a>備註

在某些容器中，您的控制項可能不具備其環境屬性的存取權的覆寫的初始呼叫期間`COleControl::DoPropExchange`。 如果容器呼叫，這會是大小寫[IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load)或是[ipersiststorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load)才能呼叫[IOleObject::SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) （亦即，如果沒有接受 OLEMISC_SETCLIENTSITEFIRST 葒鷑糔磢）。

##  <a name="windowproc"></a>  COleControl::WindowProc

提供的 Windows 處理程序`COleControl`物件。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*message*<br/>
指定要處理 Windows 訊息。

*wParam*<br/>
提供用於處理訊息的其他資訊。 參數值取決於訊息。

*lParam*<br/>
提供用於處理訊息的其他資訊。 參數值取決於訊息。

### <a name="return-value"></a>傳回值

已發送的訊息傳回的值。

### <a name="remarks"></a>備註

呼叫此函式可將特定訊息透過控制項的訊息對應分派。

## <a name="see-also"></a>另請參閱

[MFC 範例 CIRC3](../../visual-cpp-samples.md)<br/>
[MFC 範例 TESTHELP](../../visual-cpp-samples.md)<br/>
[COlePropertyPage 類別](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 類別](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 類別](../../mfc/reference/cpictureholder-class.md)<br/>
