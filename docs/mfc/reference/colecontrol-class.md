---
title: COleControl 類別
ms.date: 08/27/2018
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
ms.openlocfilehash: 54138955b0aa61a5e307c64825f3c74fa6f592b1
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753931"
---
# <a name="colecontrol-class"></a>COleControl 類別

開發 OLE 控制項的強大基底類別。

## <a name="syntax"></a>語法

```
class COleControl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[COle 控制:COle 控制](#colecontrol)|建立 `COleControl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[COleControl:環境外觀](#ambientappearance)|檢索控件的當前外觀。|
|[COle 控制:環境背面顏色](#ambientbackcolor)|返回環境 BackColor 屬性的值。|
|[COleControl:環境顯示名稱](#ambientdisplayname)|傳回容器指定的控制項名稱。|
|[COleControl:環境字型](#ambientfont)|返回環境字體屬性的值。|
|[COleControl:環境福彩](#ambientforecolor)|返回環境 ForeColor 屬性的值。|
|[COleControl:環境區域ID](#ambientlocaleid)|返回容器的區域設置 ID。|
|[COle 控制::環境尺度單位](#ambientscaleunits)|返回容器使用的單位類型。|
|[COle 控制::環境顯示擷取](#ambientshowgrabhandles)|確定是否應顯示抓取控點。|
|[COle 控制:環境顯示填滿](#ambientshowhatching)|確定是否應顯示剖面線。|
|[COle 控制:環境文字對齊](#ambienttextalign)|傳回容器指定的文本對齊類型。|
|[COleControl:環境UIDead](#ambientuidead)|確定控件是否應回應使用者介面操作。|
|[COle 控制:環境使用者模式](#ambientusermode)|確定容器的模式。|
|[COle 控制:結合屬性已變更](#boundpropertychanged)|通知容器綁定屬性已更改。|
|[COle 控制::結合屬性要求編輯](#boundpropertyrequestedit)|請求編輯屬性值的許可權。|
|[COle 控制:客戶端到父級](#clienttoparent)|將相對於控件原點的點轉換為相對於其容器源的點。|
|[COle 控制::ClipCaretrect](#clipcaretrect)|如果傾斜矩形與控制項重疊,則調整其矩形。|
|[COle 控制:控制資訊已變更](#controlinfochanged)|在控制項處理的助記符集已更改後調用此函數。|
|[COleControl::D播放錯誤](#displayerror)|向控制項的使用者顯示庫存錯誤事件。|
|[COleControl::DoClick](#doclick)|實現庫存`DoClick`方法。|
|[COleControl::DoPropExchange](#dopropexchange)|序列化`COleControl`物件的屬性。|
|[COleControl::D超類繪畫](#dosuperclasspaint)|重繪從 Windows 控制件中子分類的 OLE 控制件。|
|[COle 控制:啟用簡單的畫面](#enablesimpleframe)|支援控件的簡單幀支援。|
|[COleControl::交換範圍](#exchangeextent)|序列化控制項的寬度和高度。|
|[COleControl::交易所股票供應商](#exchangestockprops)|序列化控制項庫存屬性。|
|[COleControl:交換版本](#exchangeversion)|序列化控制項的版本號。|
|[COle 控制:火擊](#fireclick)|觸發庫存`Click`事件。|
|[COleControl::火點點擊](#firedblclick)|觸發庫存`DblClick`事件。|
|[COle 控制:火錯誤](#fireerror)|觸發庫存`Error`事件。|
|[COle 控制:火事件](#fireevent)|觸發自定義事件。|
|[COle 控制::火鍵向下](#firekeydown)|觸發庫存`KeyDown`事件。|
|[COleControl::FireKeyPress](#firekeypress)|觸發庫存`KeyPress`事件。|
|[COle 控制:火鍵向上](#firekeyup)|觸發庫存`KeyUp`事件。|
|[COleControl:火鼠向下](#firemousedown)|觸發庫存`MouseDown`事件。|
|[COleControl:火鼠移動](#firemousemove)|觸發庫存`MouseMove`事件。|
|[COleControl:火鼠](#firemouseup)|觸發庫存`MouseUp`事件。|
|[COle 控制::火就緒狀態更改](#firereadystatechange)|當控件的就緒狀態發生更改時,觸發事件。|
|[COleControl:取得啟動策略](#getactivationpolicy)|更改支援介面的控制件的`IPointerInactive`默認啟用行為。|
|[COleControl:抓取環境屬性](#getambientproperty)|返回指定環境屬性的值。|
|[COleControl:取得外觀](#getappearance)|返回股票外觀屬性的值。|
|[COleControl:取得回歸顏色](#getbackcolor)|返回股票 BackColor 屬性的值。|
|[COle 控制:抓取邊框樣式](#getborderstyle)|返回股票 BorderStyle 屬性的值。|
|[COle 控制:抓取](#getcapture)|確定無視窗、啟動的控制件物件是否具有滑鼠捕捉。|
|[COle 控制:取得類別識別碼](#getclassid)|檢索控制件的 OLE 類 ID。|
|[COle 控制:取得客戶端位移](#getclientoffset)|檢索控件矩形區域的左上角與其工作區的左上角之間的差異。|
|[COleControl:取得客戶端](#getclientrect)|檢索控件工作區的大小。|
|[COleControl:取得客戶網站](#getclientsite)|查詢指向其容器中當前用戶端網站的指標的物件。|
|[COle 控制:取得控制旗標](#getcontrolflags)|檢索控件標誌設置。|
|[COle 控制:取得控制大小](#getcontrolsize)|傳回 OLE 控制的大小和大小。|
|[COle 控制:GetDC](#getdc)|提供一種無視窗控制項從其容器獲取設備上下文的方法。|
|[COle 控制:啟用](#getenabled)|返回股票啟用屬性的值。|
|[COle 控制:抓取延伸](#getextendedcontrol)|檢索指向屬於容器的擴展控制件物件的指標。|
|[COleControl:取得焦點](#getfocus)|確定控件是否具有焦點。|
|[COleControl:取得字型](#getfont)|返回股票字體屬性的值。|
|[COleControl:取得字型文字指標](#getfonttextmetrics)|返回`CFontHolder`物件的指標。|
|[COleControl:取得福彩](#getforecolor)|返回股票 ForeColor 屬性的值。|
|[COleControl:GetHwnd](#gethwnd)|返回股票 hWnd 屬性的值。|
|[COle 控制:抓取訊息字串](#getmessagestring)|提供功能表項的狀態欄文本。|
|[COle 控制:不受支援](#getnotsupported)|防止使用者存取控制件的屬性值。|
|[COleControl:準備狀態](#getreadystate)|返回控件的就緒狀態。|
|[COle 控制:取得 rectin 容器](#getrectincontainer)|返回控制項相對於其容器的矩形。|
|[COleControl:取得股票文字指標](#getstocktextmetrics)|返回股票字體屬性的指標。|
|[COleControl:取得文字](#gettext)|返回股票文本或標題屬性的值。|
|[COle 控制:抓取無視窗丟棄目標](#getwindowlessdroptarget)|覆蓋以允許無視窗控制項成為拖放操作的目標。|
|[COle 控制:初始化 IID](#initializeiids)|通知控項將使用的 IID 的基類。|
|[COleControl:內部取得字型](#internalgetfont)|返回股票`CFontHolder`字體屬性的物件。|
|[COleControl:內部取得文字](#internalgettext)|檢索庫存標題或文本屬性。|
|[COleControl::內部就緒狀態](#internalsetreadystate)|設置控制項的就緒狀態並觸發就緒狀態更改事件。|
|[COle 控制:無效控制](#invalidatecontrol)|使顯示的控制項的區域無效,從而導致重新繪製該控制項。|
|[COleControl:無效](#invalidatergn)|使給定區域內的容器視窗的工作區無效。 可用於重繪區域中的無視窗控制件。|
|[COleControl:正在轉換VBX](#isconvertingvbx)|允許專門載入 OLE 控制件。|
|[COle 控制:已修改](#ismodified)|確定控制項狀態是否已更改。|
|[COleControl:最佳化繪製](#isoptimizeddraw)|指示容器是否支援當前繪圖操作的優化繪圖。|
|[COle 控制:是子類控制](#issubclassedcontrol)|調用 以確定控制項是否對 Windows 控制件進行子類。|
|[COle 控制:載入](#load)|重置任何以前的異步數據,並啟動控制項的異步屬性的新負載。|
|[COle 控制:鎖定位置活動](#lockinplaceactive)|確定控件是否可以由容器停用。|
|[COleControl:關於環境屬性更改](#onambientpropertychange)|更改環境屬性時調用。|
|[COle 控制:在外觀上已變更](#onappearancechanged)|更改股票外觀屬性時調用。|
|[COle 控制:onbackColor 已變更](#onbackcolorchanged)|更改股票 BackColor 屬性時調用。|
|[COle 控制:在邊框樣式上已變更](#onborderstylechanged)|更改股票邊框樣式屬性時調用。|
|[COleControl:點擊](#onclick)|已調用以觸發庫存單擊事件。|
|[COle 控制:關閉](#onclose)|通知已調用的`IOleControl::Close`控制項。|
|[COleControl:OnDoVerb](#ondoverb)|執行控制謂詞後調用。|
|[COleControl:在畫上](#ondraw)|當請求控件重新繪製自身時調用。|
|[COleControl:在畫元檔](#ondrawmetafile)|當請求控制項裝置使用元檔裝置上下文重繪自身時,容器調用該容器。|
|[COleControl::編輯](#onedit)|容器調用 UI 啟動 OLE 控制項。|
|[COle 控制:啟用](#onenabledchanged)|更改股票啟用屬性時調用。|
|[COleControl:onEnumVerbs](#onenumverbs)|容器調用以枚舉控件的謂詞。|
|[COleControl:在事件建議](#oneventadvise)|當事件處理程式連接或與控制項斷開連接時調用。|
|[COleControl::放大縮小字型功能 放大縮小字型功能](#onfontchanged)|更改股票字體屬性時調用。|
|[COleControl:OnforeColor 已變更](#onforecolorchanged)|更改股票前顏色屬性時調用。|
|[COleControl:在凍結事件](#onfreezeevents)|當控件的事件被凍結或解凍時調用。|
|[COleControl:onGetColorSet](#ongetcolorset)|通知已調用的`IOleObject::GetColorSet`控制項。|
|[COleControl:OnGetControlInfo](#ongetcontrolinfo)|向容器提供助記符資訊。|
|[COle 控制::在GetDisplayString上](#ongetdisplaystring)|呼叫以取得表示屬性值的字串。|
|[COleControl:ongetinplacemenu](#ongetinplacemenu)|請求將與容器功能表合併的控制項功能表的句柄。|
|[COleControl:OnGet自然範圍](#ongetnaturalextent)|覆蓋以檢索控制的顯示大小,最接近建議的大小和範圍模式。|
|[COle 控制::開啟預先定義字串](#ongetpredefinedstrings)|返回表示屬性的可能值的字串。|
|[COle 控制::取得預定義值](#ongetpredefinedvalue)|返回與預定義字串對應的值。|
|[COleControl:OngetView 範圍](#ongetviewextent)|覆蓋以檢索控制件的顯示區域的大小(可用於啟用雙通道繪圖)。|
|[COleControl:OngetViewrect](#ongetviewrect)|覆蓋以將控制項大小轉換為從特定位置開始的矩形。|
|[COleControl:Onget查看狀態](#ongetviewstatus)|覆蓋以檢索控件的視圖狀態。|
|[COle 控制:在隱藏工具列上](#onhidetoolbars)|當控件被 UI 停用時,容器調用。|
|[COle 控制:在作用滑鼠移動](#oninactivemousemove)|覆蓋以將滑鼠指標下的非活動控制件的容器調度WM_MOUSEMOVE訊息發送到該控制件。|
|[COle 控制:oninactiveSetCursor](#oninactivesetcursor)|覆蓋以將滑鼠指標下的非活動控制件的容器調度WM_SETCURSOR訊息發送到該控制件。|
|[COleControl:在鍵下事件](#onkeydownevent)|在股票密鑰關閉事件已觸發后調用。|
|[COleControl::KeyPress事件](#onkeypressevent)|股票 KeyPress 事件已觸發後調用。|
|[COleControl:在KeyUpevent上](#onkeyupevent)|在股票 KeyUp 事件已觸發後調用。|
|[COleControl:在地圖屬性頁](#onmappropertytopage)|指示用於編輯屬性的屬性頁。|
|[COleControl:onMnemonic](#onmnemonic)|按下控制項的助記符鍵時調用。|
|[COle 控制:屬性](#onproperties)|調用控件的"屬性"謂詞時調用。|
|[COle 控制:在查詢命中點](#onqueryhitpoint)|覆蓋以查詢控制項的顯示是否與給定點重疊。|
|[COleControl:在查詢中](#onqueryhitrect)|覆蓋以查詢控制項的顯示是否與給定矩形中的任何點重疊。|
|[COle 控制:在渲染資料上](#onrenderdata)|框架調用以檢索指定格式的數據。|
|[COle 控制:在渲染檔案資料上](#onrenderfiledata)|框架呼叫以指定格式從檔案檢索資料。|
|[COle 控制:在渲染全域資料](#onrenderglobaldata)|框架調用以以指定格式從全域記憶體檢索數據。|
|[COle 控制:在重置狀態](#onresetstate)|將控制項的屬性重置為預設值。|
|[COleControl:在設定客戶端站台](#onsetclientsite)|通知已調用的`IOleControl::SetClientSite`控制項。|
|[COleControl:OnSetData](#onsetdata)|將控制項資料替換為另一個值。|
|[COle 控制:在設定範圍](#onsetextent)|在控制項的範圍已更改後調用。|
|[COle 控制:OnSetObjectrects](#onsetobjectrects)|更改控制項的尺寸後調用。|
|[COleControl::在顯示工具列上](#onshowtoolbars)|在啟動控制時調用。|
|[COle 控制:在文字上改變](#ontextchanged)|更改股票文本或標題屬性時調用。|
|[COleControl:無視窗訊息](#onwindowlessmessage)|處理無視窗控制件的視窗訊息(滑鼠和鍵盤消息以外的)。|
|[COleControl::P客戶](#parenttoclient)|將相對於容器原點的點轉換為相對於控件原點的點。|
|[COleControl::P模式對話](#postmodaldialog)|通知容器模式對話框已關閉。|
|[COleControl::P重新模式對話](#premodaldialog)|通知容器即將顯示模式對話方塊。|
|[COle 控制:重新建立控制視窗](#recreatecontrolwindow)|銷毀並重新建立控制項的視窗。|
|[COle 控制:刷新](#refresh)|強制重新繪製控制件的外觀。|
|[COle 控制::發佈捕獲](#releasecapture)|釋放滑鼠捕獲。|
|[COle 控制:釋放DC](#releasedc)|釋放無視窗控制件容器的顯示設備上下文。|
|[COle 控制::重父控制視窗](#reparentcontrolwindow)|重置控制視窗的父級。|
|[COle 控制::重置庫存](#resetstockprops)|將`COleControl`股票屬性初始化到其預設值。|
|[COle 控制:重置版本](#resetversion)|將版本號初始化為給定值。|
|[COle 控制:滾動視窗](#scrollwindow)|允許無視窗控制件滾動其就地活動圖像中的區域。|
|[COle 控制:選擇字型物件](#selectfontobject)|在設備上下文中選擇自定義字體屬性。|
|[COleControl:選擇庫存字型](#selectstockfont)|在設備上下文中選擇"庫存字體"屬性。|
|[COle 控制:序列化範圍](#serializeextent)|序列化或初始化控制件的顯示空間。|
|[COle 控制:序列化庫存](#serializestockprops)|序列化或初始化`COleControl`股票屬性。|
|[COle 控制:序列化版本](#serializeversion)|序列化或初始化控制件的版本資訊。|
|[COle 控制::設定外觀](#setappearance)|設置股票外觀屬性的值。|
|[COle 控制::設定回顏色](#setbackcolor)|設置股票 BackColor 屬性的值。|
|[COle 控制:設定邊框樣式](#setborderstyle)|設置股票邊界樣式屬性的值。|
|[COle 控制:設定擷取](#setcapture)|使控制項的容器視窗代表控制件獲取滑鼠捕捉。|
|[COle 控制:設定控制大小](#setcontrolsize)|設置 OLE 控制項的位置和大小。|
|[COle 控制:已開啟](#setenabled)|設置股票啟用屬性的值。|
|[COle 控制:設定焦點](#setfocus)|使控制項的容器視窗以控制的名義占用輸入焦點。|
|[COle 控制::設定字型](#setfont)|設置股票字體屬性的值。|
|[COleControl:設置福彩](#setforecolor)|設置股票 ForeColor 屬性的值。|
|[COle 控制:設定初始大小](#setinitialsize)|設置首次顯示在容器中的 OLE 控制的大小。|
|[COle 控制:設定已修改的標籤](#setmodifiedflag)|更改控制項的已修改狀態。|
|[COle 控制:設定不允許](#setnotpermitted)|指示編輯請求失敗。|
|[COle 控制:設定不支援](#setnotsupported)|防止使用者修改控制項的屬性值。|
|[COle 控制:setrectin 容器](#setrectincontainer)|設置控制件相對於其容器的矩形。|
|[COle 控制:設定文字](#settext)|設定股票文本或標題屬性的值。|
|[COle 控制::投擲錯誤](#throwerror)|指示 OLE 控制項中發生錯誤。|
|[COle 控制:轉換庫德](#transformcoords)|轉換容器和控制項之間的座標值。|
|[COleControl:翻譯顏色](#translatecolor)|將OLE_COLOR值轉換為 COLORREF 值。|
|[COle 控制:在載入期間,環境將有效](#willambientsbevalidduringload)|確定下次載入控制項時環境屬性是否可用。|
|[COle 控制::視窗 Proc](#windowproc)|為`COleControl`物件提供 Windows 過程。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[COleControl::D原始內容](#drawcontent)|當需要更新控件的外觀時,由框架調用。|
|[COleControl::D原始元檔](#drawmetafile)|使用元文件設備上下文時由框架調用。|
|[COle 控制:被呼叫允許](#isinvokeallowed)|啟用自動化方法調用。|
|[COleControl:設定初始資料格式](#setinitialdataformats)|由框架呼叫以初始化控制項支援的資料格式清單。|

## <a name="remarks"></a>備註

派生自`CWnd`的類繼承 Windows 視窗物件的所有功能以及特定於 OLE 的其他功能,如事件觸發和支援方法和屬性的功能。

OLE 控制項可以插入到 OLE 容器應用程式中,並使用事件觸發的雙向系統與容器通訊,並將方法和屬性公開到容器中。 請注意,標準 OLE 容器僅支援 OLE 控件的基本功能。 它們無法支援 OLE 控制元件的擴充功能。 當由於控制項中發生的某些操作而將事件發送到容器時,將發生事件觸發。 反過來,容器通過使用與C++類的成員函數和數據成員類似的一組公開方法和屬性與控件通信。 此方法允許開發人員控制控制件的外觀,並在發生某些操作時通知容器。

## <a name="windowless-controls"></a>無視窗控制項

OLE 控制項可以在沒有視窗的情況下就地活動使用。 沒有視窗控制的大小的優勢:

- 沒有視窗控制項可以是透明的與非矩形的

- 沒有視窗控制檔可減少物件的實體大小與建立時間

控件不需要視窗。 視窗提供的服務可透過單個共享視窗(通常是容器的視窗)和一些調度代碼輕鬆提供。 擁有視窗在物件上大多是不必要的複雜因素。

使用無視窗啟動時,容器(其中確實有一個視窗)負責提供否則由控制項自己的視窗提供的服務。 例如,如果控件需要查詢鍵盤焦點、查詢滑鼠捕獲或獲取設備上下文,則這些操作由容器管理。 無`COleControl`視窗操作成員函數在容器上調用這些操作。

啟用無視窗啟動後,容器會將輸入消息委託給控制項的`IOleInPlaceObjectWindowless`介面(用於無視窗支援的[IOleInPlace 物件的](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)擴展)。 `COleControl`此介面的實現將在適當調整滑鼠座標后通過控制項的消息映射調度這些消息。 通過將相應的項目加入消息映射,可以像普通視窗訊息一樣處理這些消息。

在無視窗控制項中`COleControl`,應始終使用成員函數,而不是相應的`CWnd`成員函數或其相關的 Windows API 函數。

OLE 控制物件也可以創建視窗,只有當它們變為活動狀態時,但非活動-主動過渡所需的工作量會上升,轉換的速度也會降低。 在某些情況下,這是一個問題:例如,考慮文本框的網格。 在列上下游標時,每個控件都必須就地啟動,然後停用。 非活動/主動過渡的速度將直接影響滾動速度。

有關開發 OLE 控制框架的詳細資訊,請參閱[文章 MFC ActiveX](../../mfc/mfc-activex-controls.md)控制和[概述:創建 MFC ActiveX 控制程式](../../mfc/reference/mfc-activex-control-wizard.md)。 有關最佳化 OLE 控制項(包括無視窗和無閃爍控制)的資訊,請參閱[MFC ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>需求

**標題:** afxctl.h

## <a name="colecontrolambientbackcolor"></a><a name="ambientbackcolor"></a>COle 控制:環境背面顏色

返回環境 BackColor 屬性的值。

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>傳回值

容器的環境 BackColor 屬性(如果有)的當前值。 如果不支援該屬性,則此函數將返回系統定義的 Windows 背景顏色。

### <a name="remarks"></a>備註

環境 BackColor 屬性可用於所有控制項,由容器定義。 請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientdisplayname"></a><a name="ambientdisplayname"></a>COleControl:環境顯示名稱

容器分配給控制項名稱可用於向使用者顯示的錯誤訊息。

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>傳回值

OLE 控制項名稱。 預設為零長度字串。

### <a name="remarks"></a>備註

請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientfont"></a><a name="ambientfont"></a>COleControl:環境字型

返回環境字體屬性的值。

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>傳回值

指向容器的環境字體調度介面的指標。 預設值是 NULL。 如果返回不等於 NULL,則負責通過調用其[INotnot:::釋放](/windows/win32/api/unknwn/nf-unknwn-iunknown-release)成員功能來釋放字體。

### <a name="remarks"></a>備註

環境字體屬性由容器定義,可供所有控制項使用。請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientforecolor"></a><a name="ambientforecolor"></a>COleControl:環境福彩

返回環境 ForeColor 屬性的值。

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>傳回值

容器的環境 ForeColor 屬性(如果有)的當前值。 如果不支援,此函數將返回系統定義的 Windows 文本顏色。

### <a name="remarks"></a>備註

環境 ForeColor 屬性可用於所有控制項,由容器定義。 請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientlocaleid"></a><a name="ambientlocaleid"></a>COleControl:環境區域ID

返回容器的區域設置 ID。

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>傳回值

容器的 LocaleID 屬性的值(如果有)。 如果不支援此屬性,則此函數返回 0。

### <a name="remarks"></a>備註

控制項可以使用區域設置ID調整其使用者介面以進行特定區域設置。 請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientappearance"></a><a name="ambientappearance"></a>COleControl:環境外觀

檢索控件對象的當前外觀設置。

```
short AmbientAppearance();
```

### <a name="return-value"></a>傳回值

控制項外觀:

- **0**平面外觀

- **1** 3D 外觀

### <a name="remarks"></a>備註

調用此函數以檢索控制件的DISPID_AMBIENT_APPEARANCE屬性的當前值。

## <a name="colecontrolambientscaleunits"></a><a name="ambientscaleunits"></a>COle 控制::環境尺度單位

返回容器使用的單位類型。

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>傳回值

包含容器的環境縮放單位的字串。 如果不支援此屬性,則此函數返回一個零長度字串。

### <a name="remarks"></a>備註

容器的環境 ScaleUnits 屬性可用於顯示位置或尺寸,這些位置或尺寸標有所選單位,如 twips 或釐米。 請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientshowgrabhandles"></a><a name="ambientshowgrabhandles"></a>COle 控制::環境顯示擷取

確定容器是否允許控件在啟動時顯示自身的抓取控點。

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>傳回值

如果應顯示抓取手柄,則非零;否則 0。 如果不支援此屬性,則此函數返回非零。

### <a name="remarks"></a>備註

請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientshowhatching"></a><a name="ambientshowhatching"></a>COle 控制:環境顯示填滿

確定容器是否允許控制者在 UI 處於活動狀態時使用陰影模式顯示自身。

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>傳回值

如果應顯示陰影圖案,則非零;否則 0。 如果不支援此屬性,則此函數返回非零。

### <a name="remarks"></a>備註

請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambienttextalign"></a><a name="ambienttextalign"></a>COle 控制:環境文字對齊

確定控制項容器首選的環境文本對齊方式。

```
short AmbientTextAlign();
```

### <a name="return-value"></a>傳回值

容器的環境文字對齊屬性的狀態。 如果不支援此屬性,則此函數返回 0。

以下是有效返回值的清單:

|傳回值|意義|
|------------------|-------------|
|0|一般對齊(右側的數字,左側的文本)。|
|1|左對齊|
|2|中心|
|3|正確證明|

### <a name="remarks"></a>備註

此屬性可用於所有嵌入的控制項,並由容器定義。 請注意,不支援此屬性不需要該容器。

## <a name="colecontrolambientuidead"></a><a name="ambientuidead"></a>COleControl:環境UIDead

確定容器是否希望控件回應使用者介面操作。

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>傳回值

如果控件應回應使用者介面操作,則非零;否則 0。 如果不支援此屬性,則此函數返回 0。

### <a name="remarks"></a>備註

例如,容器可能在設計模式下將 TRUE 設置為 TRUE。

## <a name="colecontrolambientusermode"></a><a name="ambientusermode"></a>COle 控制:環境使用者模式

確定容器是處於設計模式還是使用者模式。

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>傳回值

如果容器處於使用者模式,則非零;否則 0(在設計模式下)。 如果不支援此屬性,則此函數將返回 TRUE。

### <a name="remarks"></a>備註

例如,容器可能會在設計模式下將此設置為 FALSE。

## <a name="colecontrolboundpropertychanged"></a><a name="boundpropertychanged"></a>COle 控制:結合屬性已變更

表示綁定屬性值已更改。

```cpp
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項的綁定屬性的調度 ID。

### <a name="remarks"></a>備註

每次屬性的值發生更改時,都必須調用此值,即使在未通過屬性 Set 方法進行更改的情況下也是如此。 特別要注意映射到成員變數的綁定屬性。 任何時候,必須呼叫此類成員變數`BoundPropertyChanged`。

## <a name="colecontrolboundpropertyrequestedit"></a><a name="boundpropertyrequestedit"></a>COle 控制::結合屬性要求編輯

請求`IPropertyNotifySink`介面的許可權以更改控制項提供的綁定屬性值。

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項的綁定屬性的調度 ID。

### <a name="return-value"></a>傳回值

如果允許更改,則非零;否則 0。 默認值為非零。

### <a name="remarks"></a>備註

如果許可權被拒絕,控件不得讓屬性的值更改。 這可以通過忽略或失敗試圖更改屬性值的操作來實現。

## <a name="colecontrolclienttoparent"></a><a name="clienttoparent"></a>COle 控制:客戶端到父級

將*pPoint*的座標轉換為父座標。

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
指向容器內 OLE 控件的邊界。 不是工作區,而是整個控件的區域,包括邊框和滾動條。

*pPoint*<br/>
指向 OLE 工作區點的指標要轉換為父(容器)的座標。

### <a name="remarks"></a>備註

在輸入*pPoint*上與 OLE 控制項的工作區的原點(控制項的工作區的左上角)相關。 在輸出*pPoint*上相對於父級(容器的左上角)的原點。

## <a name="colecontrolclipcaretrect"></a><a name="clipcaretrect"></a>COle 控制::ClipCaretrect

如果傾斜矩形完全或部分被重疊的不透明物件覆蓋,則調整其矩形。

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
在輸入時,指向[RECT](/windows/win32/api/windef/ns-windef-rect)結構的指標,其中包含要調整的插入區域。 在輸出時,如果已完全覆蓋的傾斜矩形,則調整的護理區域或NULL。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

插入器是閃爍的線、塊或位圖,通常指示文本或圖形的插入位置。

如果不首先檢查隱器是否部分隱藏或完全被重疊物件隱藏,則無視窗對象無法安全地顯示隱匿。 為了使這一點成為可能,物件可以使用`ClipCaretRect`來調整(減少)貼圖,以確保其適合剪切區域。

創建 care 器的物件應將加斯特矩`ClipCaretRect`形提交 到 caret 並使用調整的矩形進行 caret。 如果 care 完全隱藏,則此方法將返回 FALSE,在這種情況下根本不應顯示該 care。

## <a name="colecontrolcolecontrol"></a><a name="colecontrol"></a>COle 控制:COle 控制

建構 `COleControl` 物件。

```
COleControl();
```

### <a name="remarks"></a>備註

通常不直接調用此功能。 相反,OLE 控制者通常由其類工廠創建。

## <a name="colecontrolcontrolinfochanged"></a><a name="controlinfochanged"></a>COle 控制:控制資訊已變更

當控件支援的助記符集已更改時,調用此功能。

```cpp
void ControlInfoChanged();
```

### <a name="remarks"></a>備註

收到此通知後,控制項的容器透過呼叫 IOleControl 取得一組新的助記符[::getControlInfo](/windows/win32/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo)。 請注意,不需要容器回應此通知。

## <a name="colecontroldisplayerror"></a><a name="displayerror"></a>COleControl::D播放錯誤

處理股票錯誤事件後由框架調用(除非事件處理程式已禁止顯示錯誤)。

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態代碼值。 有關可能代碼的完整清單,請參閱[「ActiveX 控件:高級主題」一](../../mfc/mfc-activex-controls-advanced-topics.md)文。

*lpsz描述*<br/>
報告的錯誤的說明。

*lpsz來源*<br/>
生成錯誤的模組的名稱(通常為 OLE 控制模組的名稱)。

*lpszHelp 檔案*<br/>
包含錯誤說明的說明檔的名稱。

*nHelpID*<br/>
報告錯誤的説明上下文 ID。

### <a name="remarks"></a>備註

預設行為顯示一個訊息框,包含錯誤描述,包含在*lpsz 描述中*。

重寫此函數以自定義錯誤顯示方式。

## <a name="colecontroldoclick"></a><a name="doclick"></a>COleControl::DoClick

類比控制項滑鼠按一下操作。

```cpp
void DoClick();
```

### <a name="remarks"></a>備註

將調用可`COleControl::OnClick`重寫的成員函數,如果控件支援,將觸發庫存單擊事件。

`COleControl`基類支援此功能作為股票方法(稱為 DoClick)。 有關詳細資訊,請參閱文章[ActiveX 控制項:方法](../../mfc/mfc-activex-controls-methods.md)。

## <a name="colecontroldopropexchange"></a><a name="dopropexchange"></a>COleControl::DoPropExchange

從持久儲存表示(如流或屬性集)載入或存儲控制項時由框架調用。

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 框架提供此物件以建立屬換的上下文,包括其方向。

### <a name="remarks"></a>備註

此函數通常調用**PX_** 函數系列以載入或儲存 OLE 控制項的特定使用者定義屬性。

如果控制檔精靈已用於建立 OLE 控制專案,則此函式的重寫版本將序列化基類別函式 呼`COleControl`叫`COleControl::DoPropExchange`支援的股票屬性 。 將使用者定義的屬性添加到 OLE 控制項時,需要修改此函數以序列化新屬性。 有關序列化的詳細資訊,請參閱[ActiveX 控制項:序列化](../../mfc/mfc-activex-controls-serializing.md)。

## <a name="colecontroldosuperclasspaint"></a><a name="dosuperclasspaint"></a>COleControl::D超類繪畫

重繪從 Windows 控制件中子分類的 OLE 控制件。

```cpp
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
指向控制容器的裝置上下文的指標。

*rcBunds*<br/>
要繪製控制件的區域。

### <a name="remarks"></a>備註

調用此函數以正確處理非活動 OLE 控制項的繪製。 僅當 OLE 控制項類 Windows 控制項時才應使用此`OnDraw`函數, 並且應在控制項的函數中調用。

有關此功能和子類 Windows 控制件的詳細資訊,請參閱[「ActiveX 控件:對 Windows 控制件進行子類化](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)」一文。

## <a name="colecontroldrawcontent"></a><a name="drawcontent"></a>COleControl::D原始內容

當需要更新控件的外觀時,由框架調用。

```cpp
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
指向設備上下文的指標。

*鋼筋混凝土*<br/>
要繪製的矩形區域。

### <a name="remarks"></a>備註

此函數直接調用可`OnDraw`重寫函數。

## <a name="colecontroldrawmetafile"></a><a name="drawmetafile"></a>COleControl::D原始元檔

使用元文件設備上下文時由框架調用。

```cpp
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>參數

*pDC*<br/>
指向元文件設備上下文的指標。

*鋼筋混凝土*<br/>
要繪製的矩形區域。

## <a name="colecontrolenablesimpleframe"></a><a name="enablesimpleframe"></a>COle 控制:啟用簡單的畫面

啟用 OLE 控制的簡單幀特性。

```cpp
void EnableSimpleFrame();
```

### <a name="remarks"></a>備註

此特性允許控件支援其他控制項的可視包含,但不支援真正的 OLE 遏制。 例如,一個組框,其中有多個控制項。 這些控制項不是 OLE 包含的,但它們位於同一組框中。

## <a name="colecontrolexchangeextent"></a><a name="exchangeextent"></a>COleControl::交換範圍

序列化或初始化控制項範圍的狀態(其尺寸以HIMETRIC單位為單位)。

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 框架提供此物件以建立屬換的上下文,包括其方向。

### <a name="return-value"></a>傳回值

如果函數成功,則非零;0 否則。

### <a name="remarks"></a>備註

此函數通常由`COleControl::DoPropExchange`的默認實現調用。

## <a name="colecontrolexchangestockprops"></a><a name="exchangestockprops"></a>COleControl::交易所股票供應商

序列化或初始化控制件的庫存屬性的狀態。

```cpp
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>參數

*pPX*<br/>
指向[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的指標。 框架提供此物件以建立屬換的上下文,包括其方向。

### <a name="remarks"></a>備註

此函數通常由`COleControl::DoPropExchange`的默認實現調用。

## <a name="colecontrolexchangeversion"></a><a name="exchangeversion"></a>COleControl:交換版本

序列化或初始化控制件的版本資訊的狀態。

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*pPX*<br/>
`CPropExchange` 物件的指標。 框架提供此物件以建立屬換的上下文,包括其方向。

*dwVersionDefault*<br/>
控件的當前版本號。

*b轉換*<br/>
指示在保存時是否應將持久性數據轉換為最新格式,還是以載入的相同格式進行維護。

### <a name="return-value"></a>傳回值

函數的非零成功;0 否則。

### <a name="remarks"></a>備註

通常,這將是控制項對 呼叫的第一個函`COleControl::DoPropExchange`數 。 載入時,此函數讀取持久資料的版本號,並相應地設置[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件的版本屬性。 保存時,此函數寫入持久數據的版本號。

有關持久性和版本控制的詳細資訊,請參閱[ActiveX 控制件:序列化](../../mfc/mfc-activex-controls-serializing.md)。

## <a name="colecontrolfireclick"></a><a name="fireclick"></a>COle 控制:火擊

當滑鼠按一下活動控制件時,由框架調用。

```cpp
void FireClick();
```

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發「單擊」事件,控件的事件映射必須定義庫存單擊事件。

## <a name="colecontrolfiredblclick"></a><a name="firedblclick"></a>COleControl::火點點擊

當滑鼠在活動控件上按兩下時,由框架調用。

```cpp
void FireDblClick();
```

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發 DblClick 事件,控制項的事件映射必須定義庫存 DblClick 事件。

## <a name="colecontrolfireerror"></a><a name="fireerror"></a>COle 控制:火錯誤

觸發庫存錯誤事件。

```cpp
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*scode*<br/>
要報告的狀態代碼值。 有關可能代碼的完整清單,請參閱[「ActiveX 控件:高級主題」一](../../mfc/mfc-activex-controls-advanced-topics.md)文。

*lpsz描述*<br/>
報告的錯誤的說明。

*nHelpID*<br/>
報告錯誤的幫助 ID。

### <a name="remarks"></a>備註

此事件提供了一種在代碼中適當位置發出錯誤信號的方式。 與其他股票事件(如單擊或滑鼠移動)不同,框架永遠不會觸發錯誤。

要回報在屬性取得函數、屬性集函數或自動化方法期間發生的錯誤,請呼叫[COleControl:::throwError](#throwerror)。

OLE 控制項的「庫存錯誤」事件的實現使用 SCODE 值。 如果您的控制項使用此事件,並且打算在 Visual Basic 4.0 中使用,您將收到錯誤,因為 Visual Basic 中不支援 SCODE 值。

要解決此問題,請手動更改控制件中的 SCODE 參數。ODL 檔案長 **。** 此外,使用 SCODE 參數的任何自定義事件、方法或屬性也會導致同樣的問題。

## <a name="colecontrolfireevent"></a><a name="fireevent"></a>COle 控制:火事件

使用任意數量的可選參數從控制項觸發使用者定義的事件。

```cpp
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
要觸發的事件的調度 ID。

*pbParams*<br/>
事件參數類型的描述符。

### <a name="remarks"></a>備註

通常不應直接調用此函數。 相反,您將在控制項類聲明的事件映射部分調用事件觸發函數。

*pbParams*參數是**空間**分隔VTS_清單。 其中的一或多個值 (以空格分隔，而非逗號) 會指定函式的參數清單。 可能的值如下：

|符號|參數類型|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE*|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
> 已為所有變數類型定義了其他變體常量,但提供指向變體數據常量的VTS_FONT和VTS_PICTURE除外。 這些常量使用**VTS_P**`constantname`約定命名。 例如,VTS_PCOLOR是指向VTS_COLOR常量的指標。

## <a name="colecontrolfirekeydown"></a><a name="firekeydown"></a>COle 控制::火鍵向下

當控件處於活動狀態時按下鍵時,由框架調用。

```cpp
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
指向按下密鑰的虛擬金鑰代碼值。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發 KeyDown 事件,控制件的事件映射必須定義庫存 KeyDown 事件。

## <a name="colecontrolfirekeypress"></a><a name="firekeypress"></a>COleControl::FireKeyPress

當自定義控制件在容器中為UI活動時,框架調用該鍵並釋放該鍵。

```cpp
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
指向按下的鍵的字元值的指標。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

事件的接收者可以修改*pnChar,* 例如,將所有小寫字元轉換為大寫。 如果要檢查修改後的字元,將重`OnKeyPressEvent`寫 。

要自動觸發 KeyPress 事件,控制件的事件映射必須定義庫存 KeyPress 事件。

## <a name="colecontrolfirekeyup"></a><a name="firekeyup"></a>COle 控制:火鍵向上

當自訂控制件在容器中為UI活動時釋放密鑰時,由框架調用。

```cpp
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>參數

*pnChar*<br/>
指向已釋放金鑰的虛擬金鑰代碼值。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發 KeyUp 事件,控制件的事件映射必須定義庫存 KeyUp 事件。

## <a name="colecontrolfiremousedown"></a><a name="firemousedown"></a>COleControl:火鼠向下

當滑鼠按鈕按在活動自定義控制項上時,由框架調用。

```cpp
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
按下滑鼠按鈕的數值。 它可以包含以下值之一:

- LEFT_BUTTON滑鼠左鍵按下。

- MIDDLE_BUTTON按下滑鼠中間鍵。

- RIGHT_BUTTON按下滑鼠右鍵。

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

*x*<br/>
按下滑鼠按鈕時光標的 x 座標。 座標相對於控制視窗的左上角。

*Y*<br/>
按下滑鼠按鈕時光標的 y 座標。 座標相對於控制視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發滑鼠下部事件,控件的事件映射必須定義庫存滑鼠向下事件。

## <a name="colecontrolfiremousemove"></a><a name="firemousemove"></a>COleControl:火鼠移動

當游標移動到活動自定義控制項時,由框架調用。

```cpp
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
按下的滑鼠按鈕的數值。 包含以下值的組合:

- LEFT_BUTTON操作期間按下滑鼠左鍵。

- MIDDLE_BUTTON操作期間按下滑鼠中間按鈕。

- RIGHT_BUTTON操作期間按下了滑鼠右鍵。

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

*x*<br/>
游標的 x 座標。 座標相對於控制視窗的左上角。

*Y*<br/>
游標的 y 座標。 座標相對於控制視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發 MouseMove 事件,控制件的事件映射必須定義庫存 MouseMove 事件。

## <a name="colecontrolfiremouseup"></a><a name="firemouseup"></a>COleControl:火鼠

當滑鼠按鈕釋放到活動自定義控制項上時,由框架調用。

```cpp
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>參數

*nButton*<br/>
釋放的滑鼠按鈕的數值。 其值可以是下列其中一個值：

- LEFT_BUTTON滑鼠左鍵已釋放。

- MIDDLE_BUTTON滑鼠中間鍵已釋放。

- RIGHT_BUTTON滑鼠右鍵已釋放。

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

*x*<br/>
釋放滑鼠按鈕時光標的 x 座標。 座標相對於控制視窗的左上角。

*Y*<br/>
釋放滑鼠按鈕時光標的 y 座標。 座標相對於控制視窗的左上角。

### <a name="remarks"></a>備註

如果此事件定義為自定義事件,則確定何時觸發該事件。

要自動觸發 MouseUp 事件,控制項的事件映射必須定義庫存 MouseUp 事件。

## <a name="colecontrolfirereadystatechange"></a><a name="firereadystatechange"></a>COle 控制::火就緒狀態更改

使用就緒控制狀態的當前值觸發事件。

```cpp
void FireReadyStateChange();
```

### <a name="remarks"></a>備註

就緒狀態可以是以下值之一:

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料是互動式的,但並非所有非同步資料都已載入|
|READYSTATE_COMPLETE|控制檔具有所有資料|

使用[GetReadyState](#getreadystate)確定控制項的當前就緒狀態。

[內部集就緒狀態](#internalsetreadystate)將就緒狀態更改為提供的值,然後呼`FireReadyStateChange`叫 。

## <a name="colecontrolgetactivationpolicy"></a><a name="getactivationpolicy"></a>COleControl:取得啟動策略

更改支援介面的控制件的`IPointerInactive`默認啟用行為。

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>傳回值

POINTERINACTIVE 枚舉中的標誌的組合。 可能的標誌包括:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|當滑鼠在滑鼠移動操作期間進入物件時,對象應就地啟動。|
|POINTERINACTIVE_DEACTIVATEONLEAVE|當滑鼠在滑鼠移動操作期間離開物件時,應停用該物件。|
|POINTERINACTIVE_ACTIVATEONDRAG|在拖放操作期間,當滑鼠拖動到物件上時,該物件應就地啟動。|

### <a name="remarks"></a>備註

啟用`IPointerInactive`介面后,容器將委託WM_SETCURSOR並將消息WM_MOUSEMOVE。 `COleControl`此介面的實現將在適當調整滑鼠座標后通過控制項的消息映射調度這些消息。

每當容器收到帶有滑鼠指標的WM_SETCURSOR或WM_MOUSEMOVE消息,該消息位於支援`IPointerInactive`非活動物件上時,它應`GetActivationPolicy`調用介面並從 POINTERINACTIVE 枚舉返回標誌。

通過將相應的項目加入消息映射,可以像普通視窗訊息一樣處理這些消息。 在處理程式中,避免使用`m_hWnd`成員變數(或使用它的任何成員函數),而不首先檢查其值是否為非 NULL。

任何旨在執行比設置滑鼠游標和/或觸發滑鼠移動事件(如提供特殊視覺反饋)的目標都應返回POINTERINACTIVE_ACTIVATEONENTRY標誌,並且僅在激活時繪製反饋。 如果物件返回此標誌,容器應立即就地啟動它,然後轉發它觸發調用`GetActivationPolicy`的相同消息。

如果同時返回POINTERINACTIVE_ACTIVATEONENTRY標誌和POINTERINACTIVE_DEACTIVATEONLEAVE標誌,則僅當滑鼠位於物件上時才會啟動該物件。 如果只返回POINTERINACTIVE_ACTIVATEONENTRY標誌,則僅在滑鼠首次進入物件時激活物件一次。

您可能還希望非活動控制項成為 OLE 拖放操作的目標。 這需要在使用者將物件拖動到控制項時啟動控制項,以便可以將控制項的視窗註冊為放置目標。 要在拖動過程中導致啟動,請返回POINTERINACTIVE_ACTIVATEONDRAG標誌:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

由來`GetActivationPolicy`傳遞的資訊不應由容器緩存。 相反,每次滑鼠進入非活動物件時,都應調用此方法。

如果非活動物件在滑鼠進入時未請求就地啟動,則只要滑鼠指標停留在該物件上,其容器應通過調用[OnInactiveSetCursor](#oninactivesetcursor)向此物件發送後續WM_SETCURSOR消息。

啟用介面`IPointerInactive`通常意味著您希望控件能夠隨時處理滑鼠訊息。 要在不支援`IPointerInactive`介面的容器中獲取此行為,需要在可見時始終啟動控件,這意味著控件在其雜項標誌中應具有OLEMISC_ACTIVATEWHENVISIBLE標誌。 但是,為了防止此標誌在支援`IPointerInactive`的容器中生效,還可以指定OLEMISC_IGNOREACTIVATEWHENVISIBLE標誌:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

## <a name="colecontrolgetambientproperty"></a><a name="getambientproperty"></a>COleControl:抓取環境屬性

獲取容器的環境屬性的值。

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>參數

*德迪皮德*<br/>
所需環境屬性的調度 ID。

*vtProp*<br/>
一種變體類型標記,用於指定要在*pvProp*中傳回的值的類型。

*pvProp*<br/>
指向將接收屬性值或返回值的變數位址的指標。 此指標的實際類型必須與*vtProp*指定的類型匹配。

|vtProp|pvProp 的類型|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>傳回值

如果環境屬性受支援,則非零;否則 0。

### <a name="remarks"></a>備註

如果用於`GetAmbientProperty`檢索環境顯示名稱和縮放單位屬性,則將*vtProp*設定為VT_BSTR,並將*pvProp*設定為`CString*`。 如果要檢索環境字體屬性,則將*vtProp*設置為VT_FONT,將*pvProp*設置為 LPFONTDISP*。

請注意,已經為常見的環境屬性(如[環境返回顏色](#ambientbackcolor)和環境[字體](#ambientfont))提供了函數。

## <a name="colecontrolgetappearance"></a><a name="getappearance"></a>COleControl:取得外觀

實現控制項的庫存外觀屬性的 Get 函數。

```
short GetAppearance ();
```

### <a name="return-value"></a>傳回值

返回值將當前外觀設置指定為**短**(VT_I2)值(如果成功)。 如果控件的外觀為平面,則此值為零;如果控件的外觀為 3D,則此值為 1。

## <a name="colecontrolgetbackcolor"></a><a name="getbackcolor"></a>COleControl:取得回歸顏色

實現控制項的庫存 BackColor 屬性的獲取功能。

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>傳回值

返回值將當前背景顏色指定為OLE_COLOR值(如果成功)。 此值可以轉換為與調用`TranslateColor`的 COLORREF 值。

## <a name="colecontrolgetborderstyle"></a><a name="getborderstyle"></a>COle 控制:抓取邊框樣式

實現控制項的庫存 BorderStyle 屬性的獲取函數。

```
short GetBorderStyle();
```

### <a name="return-value"></a>傳回值

如果控件具有正常邊框,則為 1;如果控件沒有邊框,則為 0。

## <a name="colecontrolgetcapture"></a><a name="getcapture"></a>COle 控制:抓取

確定`COleControl`物件是否具有滑鼠捕獲。

```
CWnd* GetCapture();
```

### <a name="return-value"></a>傳回值

如果控件已啟動且無視窗,則如果控件當前具有滑鼠捕獲(由控制項的容器確定),則返回**該**控制項;如果控制項沒有捕獲,則返回 NULL。

否則,返回具有`CWnd`滑鼠捕獲的物件(與`CWnd::GetCapture`相同)。

### <a name="remarks"></a>備註

呼叫[SetCapture](#setcapture)時,啟動的無視窗控制項將接收滑鼠捕獲。

## <a name="colecontrolgetclassid"></a><a name="getclassid"></a>COle 控制:取得類別識別碼

由框架調用以檢索控制件的 OLE 類 ID。

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>參數

*pclsid*<br/>
指向類 ID 的位置。

### <a name="return-value"></a>傳回值

如果調用不成功,則非零;否則 0。

### <a name="remarks"></a>備註

通常由[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)實現。

## <a name="colecontrolgetclientoffset"></a><a name="getclientoffset"></a>COle 控制:取得客戶端位移

檢索控件矩形區域的左上角與其工作區的左上角之間的差異。

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>參數

*pdx 位移*<br/>
指向 OLE 控制項工作區的水準偏移。

*pdy 偏移*<br/>
指向 OLE 控制項工作區的垂直偏移。

### <a name="remarks"></a>備註

OLE 控制項的容器內有一個矩形區域。 控件的工作區是控制區域,不包括邊框和滾動條。 檢索的偏移`GetClientOffset`量是控制項矩形區域的左上角與其工作區的左上角之間的差異。 如果控制項具有標準邊框和滾動條以外的非用戶端元素,請覆蓋此成員函數以指定偏移量。

## <a name="colecontrolgetclientrect"></a><a name="getclientrect"></a>COleControl:取得客戶端

檢索控件工作區的大小。

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
指向包含無`RECT`視窗控制項工作區的維度的結構的指標;即控制的大小減去視窗邊框、框架、滾動條等。 *lpRect*參數指示控制項的用戶端矩形的大小,而不是其位置。

## <a name="colecontrolgetclientsite"></a><a name="getclientsite"></a>COleControl:取得客戶網站

查詢指向其容器中當前用戶端網站的指標的物件。

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>傳回值

指向控制項的目前用戶端網站的容器中的指標。

### <a name="remarks"></a>備註

返回的指標指向 的`IOleClientSite`實例。 由`IOleClientSite`容器實現的介面是物件對其上下文的視圖:它錨定在文檔中的位置,在文檔中獲取其存儲、使用者介面和其他資源。

## <a name="colecontrolgetcontrolflags"></a><a name="getcontrolflags"></a>COle 控制:取得控制旗標

檢索控件標誌設置。

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>傳回值

控制項標誌的旗標標的 ORed 組合:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>備註

根據預設，`GetControlFlags` 會傳回 `fastBeginPaint | clipPaintDC`。

|||
|-|-|
|`fastBeginPaint`|如果設置,則使用為 OLE 控制的客機製的開始繪製函數,而不是[BeginPaint](/windows/win32/api/winuser/nf-winuser-beginpaint) API(預設情況下設定)。|
|`clipPaintDC`|如果未設置,則禁用對`IntersectClipRect``COleControl`的 調用,並獲得較小的速度優勢。 如果使用無視窗啟動,則標誌不起作用。|
|`pointerInactive`|如果設置,則通過啟用`COleControl`介面的實現(預設情況下禁用`IPointerInactive`該 介面)在控件處於非活動狀態時提供滑鼠交互。|
|`noFlickerActivate`|如果設置,則消除額外的繪圖操作和隨附的視覺閃爍。 當控件在非活動狀態和活動狀態下繪製自身時,請使用。 如果使用無視窗啟動,則標誌不起作用。|
|`windowlessActivate`|如果設置,指示控件使用無視窗啟動。|
|`canOptimizeDraw`|如果設置,則指示如果容器支援該控制項,則控制項將執行優化的繪圖。|

有關 OLE`GetControlFlags`控制項和其他最佳化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolgetcontrolsize"></a><a name="getcontrolsize"></a>COle 控制:取得控制大小

檢索 OLE 控制視窗的大小。

```cpp
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>參數

*pcx*<br/>
指定控制項的寬度(以像素為單位)。

*普西*<br/>
指定控制項的高度(以像素為單位)。

### <a name="remarks"></a>備註

請注意,控制項視窗的所有座標都相對於控制項的左上角。

## <a name="colecontrolgetdc"></a><a name="getdc"></a>COle 控制:GetDC

提供無視窗物件,以便從容器獲取螢幕(或相容)設備上下文。

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>參數

*lprcRect*<br/>
指向無視窗控制項要重繪的矩形的指標,位於控制項的用戶端座標中。 NULL 表示完整物件的範圍。

*dwFlags*<br/>
繪製設備上下文的屬性。 選項包括:

- OLEDC_NODRAW指示物件不會使用設備上下文執行任何圖形,而只是獲取有關顯示設備的資訊。 容器應簡單地通過視窗的DC,而無需進一步處理。

- OLEDC_PAINTBKGND 請求容器在返回 DC 之前繪製背景。 如果物件請求 DC 重新繪製具有透明背景的區域,則應使用此標誌。

- OLEDC_OFFSCREEN 通知容器物件希望呈現到螢幕外位圖中,然後應複製到螢幕。 當要執行的繪圖操作生成大量閃爍時,物件應使用此標誌。 容器可以自由地遵守此請求。 但是,如果未設置此標誌,容器必須將螢幕上的 DC 交回。 這允許物件執行直接螢幕操作,例如顯示選擇(透過**XOR**操作)。

### <a name="return-value"></a>傳回值

如果成功,指向容器`CWnd`工作區的顯示設備上下文;否則,返回值為 NULL。 顯示設備上下文可用於後續 GDI 函數,以在容器視窗的工作區中繪製。

### <a name="remarks"></a>備註

必須調用[ReleaseDC](#releasedc)成員函數才能在繪製後釋放上下文。 調用`GetDC`時,對象傳遞他們希望在自己的用戶端座標中繪製的矩形。 `GetDC`將這些轉換為容器工作區的座標。 物件不應請求大於其自身工作區矩形的所需繪圖矩形,其大小可以使用[GetClientRect](#getclientrect)檢索。 這樣可以防止物件無意中繪製不應繪製的位置。

## <a name="colecontrolgetenabled"></a><a name="getenabled"></a>COle 控制:啟用

實現控制項的「已啟用」屬性的獲取函數。

```
BOOL GetEnabled();
```

### <a name="return-value"></a>傳回值

如果啟用了控件,則非零;否則 0。

## <a name="colecontrolgetextendedcontrol"></a><a name="getextendedcontrol"></a>COle 控制:抓取延伸

獲取指向由容器維護的物件的指標,該物件表示具有一組擴展屬性的控制項。

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>傳回值

指向容器擴展控制件物件的指標。 如果沒有可用的物件,則值為 NULL。

此物件可以通過`IDispatch`其 介面進行操作。 您還可以使用`QueryInterface`來獲取物件提供的其他可用介面。 但是,不支援一組特定的介面不需要該物件。 請注意,依賴容器擴展控制物件的特定功能會將控制件的可移植性限制為其他任意容器。

### <a name="remarks"></a>備註

調用此函數的函數負責在完成物件後釋放指標。 請注意,不支援此物件不需要該容器。

## <a name="colecontrolgetfocus"></a><a name="getfocus"></a>COleControl:取得焦點

確定`COleControl`物件是否具有焦點。

```
CWnd* GetFocus();
```

### <a name="return-value"></a>傳回值

如果控制項已啟動且無視窗,則如果控制項目前具有鍵盤焦點(由控制項的容器確定),則傳回**該**控制件;如果控制項沒有焦點,則傳回 NULL。

否則,返回`CWnd`具有焦點的物件(與`CWnd::GetFocus`相同)。

### <a name="remarks"></a>備註

調用[SetFocus](#setfocus)時,啟動的無視窗控制件接收焦點。

## <a name="colecontrolgetfont"></a><a name="getfont"></a>COleControl:取得字型

實現股票字體屬性的獲取函數。

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>傳回值

指向控制項的庫存字型屬性的字型調度介面的指標。

### <a name="remarks"></a>備註

請注意,調用方在完成時必須釋放物件。 在控制項的實現中,使用`InternalGetFont`存取控制件的庫存字體物件。 有關在控制項中使用字體的詳細資訊,請參閱[ActiveX 控制項:在 ActiveX 控制件中使用字型](../../mfc/mfc-activex-controls-using-fonts.md)的文章。

## <a name="colecontrolgetfonttextmetrics"></a><a name="getfonttextmetrics"></a>COleControl:取得字型文字指標

測量控制項擁有的任何`CFontHolder`物件的文本指標。

```cpp
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*lptm*<br/>
指向[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

*字型持有人*<br/>
對[CFontHolder](../../mfc/reference/cfontholder-class.md)物件的引用。

### <a name="remarks"></a>備註

可以使用[COleControl::選擇字體物件](#selectfontobject)功能選擇此類字體。 `GetFontTextMetrics`將初始化`TEXTMETRIC`*lptm*指向的結構,並`fontHolder`包含有關 「字體」的有效指標資訊(如果成功);如果成功,則用零填充結構。 在繪製控制項時,應使用此函數而不是[GetTextMetrics,](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)因為控制項(與任何嵌入的 OLE 物件)一樣,可能需要將自己呈現為元檔。

呼叫`TEXTMETRIC` [SelectFontObject](#selectfontobject)函數時,將刷新預設字型的結構。 只有在選擇股票`GetFontTextMetrics`字體屬性后才能調用,以確保其提供的資訊有效。

## <a name="colecontrolgetforecolor"></a><a name="getforecolor"></a>COleControl:取得福彩

實現股票前顏色屬性的獲取函數。

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>傳回值

返回值將當前前景顏色指定為OLE_COLOR值(如果成功)。 此值可以轉換為與調用`TranslateColor`的[COLORREF](/windows/win32/gdi/colorref)值。

## <a name="colecontrolgethwnd"></a><a name="gethwnd"></a>COleControl:GetHwnd

實現股票 hWnd 屬性的獲取函數。

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>傳回值

OLE 控件的視窗句柄(如果有);否則 NULL。

## <a name="colecontrolgetmessagestring"></a><a name="getmessagestring"></a>COle 控制:抓取訊息字串

由框架呼叫以獲取描述*nID*識別的功能表項的用途的短字串。

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
功能表項 ID。

*rMessage*<br/>
對[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的引用,通過該物件將返回字串。

### <a name="remarks"></a>備註

這可用於獲取在突出顯示功能表項時在狀態列中顯示的消息。 預設實現嘗試載入*由 nID*識別的字串資源。

## <a name="colecontrolgetnotsupported"></a><a name="getnotsupported"></a>COle 控制:不受支援

防止使用者存取控制件的屬性值。

```cpp
void GetNotSupported();
```

### <a name="remarks"></a>備註

調用此函數以代替不支援控制使用者檢索該屬性的任何屬性的 Get 函數。 例如,僅寫入的屬性。

## <a name="colecontrolgetreadystate"></a><a name="getreadystate"></a>COleControl:準備狀態

返回控件的就緒狀態。

```
long GetReadyState();
```

### <a name="return-value"></a>傳回值

控制項就緒狀態,以下值之一:

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料是互動式的,但並非所有非同步資料都已載入|
|READYSTATE_COMPLETE|控制檔具有所有資料|

### <a name="remarks"></a>備註

最簡單的控制式不需要區分 LOADED 和互動式。 但是,在至少以異步方式接收某些數據之前,支援數據路徑屬性的控制項可能還沒有準備好進行互動式訪問。 控件應嘗試儘快成為互動式控制件。

## <a name="colecontrolgetrectincontainer"></a><a name="getrectincontainer"></a>COle 控制:取得 rectin 容器

獲取控制項矩形相對於容器的座標,以設備單位表示。

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
指向將控制項的座標複製到的矩形結構的指標。

### <a name="return-value"></a>傳回值

如果控件處於活動位置,則非零;否則 0。

### <a name="remarks"></a>備註

僅當控件處於活動位置時,矩形才有效。

## <a name="colecontrolgetstocktextmetrics"></a><a name="getstocktextmetrics"></a>COleControl:取得股票文字指標

測量控制的股票字型屬性的文字指標,可以使用[SelectStockFont](#selectstockfont)函數選擇該參數。

```cpp
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>參數

*lptm*<br/>
指向[TEXTMETRIC](/windows/win32/api/wingdi/ns-wingdi-textmetricw)結構的指標。

### <a name="remarks"></a>備註

如果`GetStockTextMetrics`成功,`TEXTMETRIC`該函數將初始化*lptm*指向的結構,並包含有效的指標資訊,如果成功,則用零填充結構。 在繪製控制項時,請使用此函數而不是[GetTextMetrics,](/windows/win32/api/wingdi/nf-wingdi-gettextmetrics)因為控制項(與任何嵌入的 OLE 物件)一樣,可能需要將自己呈現為元檔。

調用`TEXTMETRIC``SelectStockFont`函數時刷新預設字體的結構。 只有在選擇股票字體以確保它提供的資訊有效后,才能調用此功能。

## <a name="colecontrolgettext"></a><a name="gettext"></a>COleControl:取得文字

實現庫存文本或標題屬性的獲取函數。

```
BSTR GetText();
```

### <a name="return-value"></a>傳回值

如果不存在字串,則控制項文字字串或零長度字串的當前值。

> [!NOTE]
> 有關 BSTR 資料類型的詳細資訊,請參考巨集和全域部分中的[資料類型](../../mfc/reference/data-types-mfc.md)。

### <a name="remarks"></a>備註

請注意,此函數的調用方必須調用`SysFreeString`返回的字串才能釋放資源。 在控制項的實現中,用於`InternalGetText`存取控制件的庫存文本或標題屬性。

## <a name="colecontrolgetwindowlessdroptarget"></a><a name="getwindowlessdroptarget"></a>COle 控制:抓取無視窗丟棄目標

當`GetWindowlessDropTarget`希望無視窗控制項成為 OLE 拖放操作的目標時,請進行覆蓋。

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>傳回值

指向物件的介面的`IDropTarget`指標。 由於它沒有視窗,無視窗對象無法`IDropTarget`註冊 介面。 但是,要參與拖放,無視窗物件仍然可以實現介面並將其返回。 `GetWindowlessDropTarget`

### <a name="remarks"></a>備註

通常這會需要將控制項的視窗登錄為置放目標。 但是,由於控件沒有自己的視窗,容器將使用自己的窗口作為放置目標。 該控件只需要提供介面的實現,`IDropTarget`容器可以在適當的時間委派調用。 例如：

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

## <a name="colecontrolinitializeiids"></a><a name="initializeiids"></a>COle 控制:初始化 IID

通知控項將使用的 IID 的基類。

```cpp
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>參數

*皮迪小學*<br/>
指向控制項主調度介面的介面 ID 的指標。

*皮迪活動*<br/>
指向控制項事件介面的介面 ID 的指標。

### <a name="remarks"></a>備註

在控制項的建構函數中調用此函數,以通知控制項將使用的介面 I 的基類。

## <a name="colecontrolinternalgetfont"></a><a name="internalgetfont"></a>COleControl:內部取得字型

存取控制項的庫存字型屬性

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>傳回值

對包含庫存字體物件的[CFont Holder](../../mfc/reference/cfontholder-class.md)物件的引用。

## <a name="colecontrolinternalgettext"></a><a name="internalgettext"></a>COleControl:內部取得文字

存取控制項的庫存文本或標題屬性。

```
const CString& InternalGetText();
```

### <a name="return-value"></a>傳回值

對控制項文字字串的引用。

## <a name="colecontrolinternalsetreadystate"></a><a name="internalsetreadystate"></a>COleControl::內部就緒狀態

設置控件的就緒狀態。

```cpp
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>參數

*l NewReadyState*<br/>
要為控制項設定的準備狀態,以下值之一:

|||
|-|-|
|READYSTATE_UNINITIALIZED|預設初始化狀態|
|READYSTATE_LOADING|控制項目前正在載入屬性|
|READYSTATE_LOADED|控制項已初始化|
|READYSTATE_INTERACTIVE|控制項有足夠的資料是互動式的,但並非所有非同步資料都已載入|
|READYSTATE_COMPLETE|控制檔具有所有資料|

### <a name="remarks"></a>備註

最簡單的控制式不需要區分 LOADED 和互動式。 但是,在至少以異步方式接收某些數據之前,支援數據路徑屬性的控制項可能還沒有準備好進行互動式訪問。 控件應嘗試儘快成為互動式控制件。

## <a name="colecontrolinvalidatecontrol"></a><a name="invalidatecontrol"></a>COle 控制:無效控制

強制控件重新繪製自身。

```cpp
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
指向要失效的控件區域的指標。

*bErase*<br/>
指定在處理更新區域時是否擦除更新區域中的背景。

### <a name="remarks"></a>備註

如果*lpRect*具有 NULL 值,則將重繪整個控制項。 如果*lpRect*不是 NULL,則表示控制項矩形中要失效的部分。 如果控制項沒有視窗或目前未處於活動狀態,則忽略矩形,並調用用戶端網站的[IAdviseSink::OnViewChange](/windows/win32/api/objidl/nf-objidl-iadvisesink-onviewchange)成員函數。 使用此函數而不是`CWnd::InvalidateRect`或`InvalidateRect`。

## <a name="colecontrolinvalidatergn"></a><a name="invalidatergn"></a>COleControl:無效

使給定區域內的容器視窗的工作區無效。

```cpp
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>參數

*pRgn*<br/>
指向[CRgn](../../mfc/reference/crgn-class.md)物件的指標,用於標識 OLE 物件的顯示區域以在包含視窗的用戶端座標中失效。 如果此參數為 NULL,則範圍為整個物件。

*bErase*<br/>
指定是否要擦除無效區域中的背景。 如果為 TRUE,則背景將被刪除。 如果 FALSE,則背景保持不變。

### <a name="remarks"></a>備註

這可用於重繪容器中的無視窗控制項。 在發送下一[WM_PAINT](/windows/win32/gdi/wm-paint)消息時,將標記無效區域以及更新區域中的所有其他區域進行繪製。

如果*bErase*對於更新區域的任何部分都為 TRUE,則整個區域(而不僅僅是給定部分)的背景將被刪除。

## <a name="colecontrolisconvertingvbx"></a><a name="isconvertingvbx"></a>COleControl:正在轉換VBX

允許專門載入 OLE 控制件。

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>傳回值

如果要轉換控件,則非零;否則 0。

### <a name="remarks"></a>備註

將使用 VBX 控制項的表單轉換為使用 OLE 控制元件的窗體時,可能需要 OLE 控制項的特殊載入代碼。 例如,如果要載入 OLE 控制的實體,則可能會呼叫中的`DoPropExchange`[PX_Font:](persistence-of-ole-controls.md#px_font)

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

但是,VBX 控件沒有Font物件,因此,該控件沒有"字型"物件。每個字體屬性都單獨保存。 在這種情況下,您將使用`IsConvertingVBX`來區分這兩種情況:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

另一種情況是,如果您的 VBX 控件保存了專有二進位資料(在其VBM_SAVEPROPERTY消息處理程式中),並且 OLE 控制項以不同的格式保存其二進位資料。 如果希望 OLE 控件與 VBX 控制項向後相容,則可以透過區分是否載入 VBX 控制件或 OLE`IsConvertingVBX`控制項來讀取使用函數讀取新舊格式。

在控件的函數中`DoPropExchange`,可以檢查此條件,如果為 true,則執行特定於此轉換的負載代碼(如前面的示例)。 如果未轉換控制項,則可以執行正常的載入代碼。 此功能僅適用於從 VBX 對應控制項轉換的控制項。

## <a name="colecontrolisinvokeallowed"></a><a name="isinvokeallowed"></a>COle 控制:被呼叫允許

啟用自動化方法調用。

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>傳回值

如果控件已初始化,則非零;否則 0。

### <a name="remarks"></a>備註

框架的調用`IDispatch::Invoke``IsInvokeAllowed`的實現,以確定是否可以調用給定函數(`dispid`由標識)。 OLE 控制項預設行為是僅在已初始化該控制項時才允許調用自動化方法;但是,`IsInvokeAllowed`它是一個虛擬函數,如有必要可能會重寫(例如,當控件用作自動化伺服器時)。

## <a name="colecontrolismodified"></a><a name="ismodified"></a>COle 控制:已修改

確定控件的狀態是否已被修改。

```
BOOL IsModified();
```

### <a name="return-value"></a>傳回值

自上次保存控件狀態以來已修改,則非零;否則 0。

### <a name="remarks"></a>備註

當屬性更改值時,將修改控制項的狀態。

## <a name="colecontrolisoptimizeddraw"></a><a name="isoptimizeddraw"></a>COleControl:最佳化繪製

確定容器是否支援當前繪圖操作的優化繪圖。

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>傳回值

如果容器支援針對當前繪圖操作優化繪圖,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

如果支援優化的繪圖,則控件在繪製完成後不必在設備上下文中選擇舊物件(筆、畫筆、字體等)。

## <a name="colecontrolissubclassedcontrol"></a><a name="issubclassedcontrol"></a>COle 控制:是子類控制

由框架調用以確定控制項是否對 Windows 控制件進行子類。

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>傳回值

如果控件被子類化,則非零;否則 0。

### <a name="remarks"></a>備註

如果 OLE 控制項類為 Windows 控制項,則必須重寫此函數並返回 TRUE。

## <a name="colecontrolload"></a><a name="load"></a>COle 控制:載入

以非同步方式重置以前載入的任何資料,並啟動控制件的非同步屬性的新載入。

```cpp
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>參數

*斯特紐路徑*<br/>
指向引用非同步控制屬性的絕對位置的路徑的字串的指標。

*支柱*<br/>
實現非同步控制屬性的[CDataPath 屬性](../../mfc/reference/cdatapathproperty-class.md)物件。

## <a name="colecontrollockinplaceactive"></a><a name="lockinplaceactive"></a>COle 控制:鎖定位置活動

防止容器停用控制件。

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>參數

*塊*<br/>
如果要鎖定控件的就地活動狀態,則為 TRUE;如果要解鎖,則 FALSE。

### <a name="return-value"></a>傳回值

如果鎖成功,則非零;否則 0。

### <a name="remarks"></a>備註

請注意,每次控制鎖定都必須與完成控件的解鎖配對。 應僅在短時間內鎖定控件,例如觸發事件時。

## <a name="colecontrolonambientpropertychange"></a><a name="onambientpropertychange"></a>COleControl:關於環境屬性更改

當容器的環境屬性已更改值時,由框架調用。

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>參數

*脫從ID*<br/>
已更改的環境屬性的調度 ID,或者如果多個屬性已更改,則DISPID_UNKNOWN。

## <a name="colecontrolonappearancechanged"></a><a name="onappearancechanged"></a>COle 控制:在外觀上已變更

當股票外觀屬性值已更改時,由框架調用。

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>備註

如果要在此屬性更改後通知,則重寫此函數。 預設執行呼叫`InvalidateControl`。

## <a name="colecontrolonbackcolorchanged"></a><a name="onbackcolorchanged"></a>COle 控制:onbackColor 已變更

當股票 BackColor 屬性值已更改時,由框架調用。

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>備註

如果要在此屬性更改後通知,則重寫此函數。 預設執行呼叫`InvalidateControl`。

## <a name="colecontrolonborderstylechanged"></a><a name="onborderstylechanged"></a>COle 控制:在邊框樣式上已變更

當股票 BorderStyle 屬性值已更改時,由框架調用。

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>備註

預設執行呼叫`InvalidateControl`。

如果要在此屬性更改後通知,則重寫此函數。

## <a name="colecontrolonclick"></a><a name="onclick"></a>COleControl:點擊

當按單擊滑鼠按鈕或調用 DoClick 庫存方法時,由框架調用。

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>參數

*iButton*<br/>
滑鼠按鈕的索引。 可以具有下列其中一個值：

- LEFT_BUTTON按下滑鼠左鍵。

- MIDDLE_BUTTON單擊滑鼠中間鍵。

- RIGHT_BUTTON單擊了滑鼠右鍵。

### <a name="remarks"></a>備註

預設執行呼叫`COleControl::FireClick`。

重寫此成員函數以修改或擴展預設處理。

## <a name="colecontrolonclose"></a><a name="onclose"></a>COle 控制:關閉

當容器調用控件的`IOleControl::Close`函數時,由框架調用。

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>參數

*dwSaveOption*<br/>
指示是否應在載入之前保存物件的標誌。 有效值為：

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>備註

預設情況下,`OnClose`如果控制項物件已被修改,*並且 dwSaveOption* OLECLOSE_SAVEIFDIRTY或OLECLOSE_PROMPTSAVE,則保存該控制件物件。

## <a name="colecontrolondoverb"></a><a name="ondoverb"></a>COleControl:OnDoVerb

當容器調用`IOleObject::DoVerb`成員函數時由框架調用。

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*iVerb*<br/>
要調用的控件謂詞的索引。

*lpMsg*<br/>
指向導致調用謂詞的 Windows 消息的指標。

*hWnd 父母*<br/>
控件父視窗的句柄。 如果動詞的執行創建了一個視窗(或視窗),則應將*hWndParent*用作父項。

*lpRect*<br/>
指向 RECT 結構的指標,將控制件的座標(相對於容器)複製到該結構中。

### <a name="return-value"></a>傳回值

如果調用成功,則為非零;否則 0。

### <a name="remarks"></a>備註

預設實現使用ON_OLEVERB和ON_STDOLEVERB消息映射條目來確定要調用的正確函數。

重寫此函數以更改動詞的默認處理。

## <a name="colecontrolondraw"></a><a name="ondraw"></a>COleControl:在畫上

由框架調用,使用指定的設備上下文在指定的邊界矩形中繪製 OLE 控制件。

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>參數

*pDC*<br/>
發生繪圖的設備上下文。

*rcBunds*<br/>
控件的矩形區域,包括邊框。

*rc 無效*<br/>
控制項無效的矩形區域。

### <a name="remarks"></a>備註

`OnDraw`通常要求螢幕顯示,傳遞螢幕設備上下文為*pDC。* *rcBounds*參數識別目標設備上下文中的矩形(相對於其當前映射模式)。 *rcInvalid*參數是無效的實際矩形。 在某些情況下,這將是一個比*rcBounds*更小的區域。

## <a name="colecontrolondrawmetafile"></a><a name="ondrawmetafile"></a>COleControl:在畫元檔

由框架調用,使用指定的元檔設備上下文在指定的邊界矩形中繪製 OLE 控制件。

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>參數

*pDC*<br/>
發生繪圖的設備上下文。

*rcBunds*<br/>
控件的矩形區域,包括邊框。

### <a name="remarks"></a>備註

默認實現調用[OnDraw](#ondraw)函數。

## <a name="colecontrolonedit"></a><a name="onedit"></a>COleControl::編輯

使控件被啟動。

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
指向調用謂詞的 Windows 消息的指標。

*hWnd 父母*<br/>
控件的父視窗的句柄。

*lpRect*<br/>
指向容器中控制件使用的矩形的指標。

### <a name="return-value"></a>傳回值

如果調用成功,則非零;否則 0。

### <a name="remarks"></a>備註

這與調用控件的OLEIVERB_UIACTIVATE謂詞的效果相同。

此函數通常用作ON_OLEVERB消息映射條目的處理程式函數。 這使控制項的「物件」功能表上有「編輯」謂詞可用。 例如：

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

## <a name="colecontrolonenabledchanged"></a><a name="onenabledchanged"></a>COle 控制:啟用

當股票啟用屬性值已更改時,由框架調用。

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>備註

如果要在此屬性更改後通知,則重寫此函數。 預設執行除錯[。](#invalidatecontrol)

## <a name="colecontrolonenumverbs"></a><a name="onenumverbs"></a>COleControl:onEnumVerbs

當容器調用`IOleObject::EnumVerbs`成員函數時由框架調用。

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>參數

*佩納姆奧勒Verb*<br/>
指向枚舉控件`IEnumOLEVERB`謂詞的對象的指標。

### <a name="return-value"></a>傳回值

如果動詞可用,則非零;否則 0。

### <a name="remarks"></a>備註

默認實現枚舉消息映射中ON_OLEVERB項。

重寫此函數以更改枚舉謂詞的預設方式。

## <a name="colecontroloneventadvise"></a><a name="oneventadvise"></a>COleControl:在事件建議

當事件處理程式連接到 OLE 控制項或與 OLE 控制項斷開連接時,由框架呼叫。

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>參數

*b 建議*<br/>
TRUE 表示事件處理程式已連接到控制項。 FALSE 表示事件處理程式已斷開與控制項的連接。

## <a name="colecontrolonfontchanged"></a><a name="onfontchanged"></a>COleControl::放大縮小字型功能 放大縮小字型功能

當股票字體屬性值已更改時,由框架調用。

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>備註

預設執行呼叫`COleControl::InvalidateControl`。 如果控件正在對 Windows 控制件進行子類化,則預設實現還會向控制項的視窗發送WM_SETFONT訊息。

如果要在此屬性更改後通知,則重寫此函數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

## <a name="colecontrolonforecolorchanged"></a><a name="onforecolorchanged"></a>COleControl:OnforeColor 已變更

當股票 ForeColor 屬性值已更改時,由框架調用。

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>備註

預設執行呼叫`InvalidateControl`。

如果要在此屬性更改後通知,則重寫此函數。

## <a name="colecontrolonfreezeevents"></a><a name="onfreezeevents"></a>COleControl:在凍結事件

在容器呼叫 後由框架呼`IOleControl::FreezeEvents`叫 。

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>參數

*bFreeze*<br/>
如果控件的事件處理被凍結,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

預設實作不做任何動作。

如果要在凍結或解凍事件處理時執行其他行為,則重寫此函數。

## <a name="colecontrolongetcolorset"></a><a name="ongetcolorset"></a>COleControl:onGetColorSet

當容器調用`IViewObject::GetColorSet`成員函數時由框架調用。

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>參數

*ptd*<br/>
指向應為其呈現圖片的目標設備。 如果此值為 NULL,則應為預設目標設備(通常是顯示設備)呈現圖片。

*希塔吉特德夫*<br/>
指定*ptd*指示的目標裝置上的資訊上下文。 此參數可以是設備上下文,但不一定是設備上下文。 如果*ptd*為 NULL,*則 hicTargetDev*也應為 NULL。

*ppColorSet*<br/>
指向應使用顏色集的位置的指標。 如果函數不返回顏色集,則返回 NULL。

### <a name="return-value"></a>傳回值

如果返回有效顏色集,則非零;否則 0。

### <a name="remarks"></a>備註

容器調用此函數以獲取繪製 OLE 控制件所需的所有顏色。 容器可以使用與設定整體調色板所需的顏色一起獲取的顏色集。 預設實現返回 FALSE。

重寫此函數以執行此請求的任何特殊處理。

## <a name="colecontrolongetcontrolinfo"></a><a name="ongetcontrolinfo"></a>COleControl:OnGetControlInfo

當控件的容器請求有關控制項資訊時,由框架調用。

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>參數

*pControlInfo*<br/>
指向要填充[的 CONTROLINFO](/windows/win32/api/ocidl/ns-ocidl-controlinfo)結構的指標。

### <a name="remarks"></a>備註

此資訊主要包括控件的助記符鍵的說明。 預設實現使用預設資訊填充*pControlInfo。*

如果控件需要處理助記符鍵,請覆蓋此函數。

## <a name="colecontrolongetdisplaystring"></a><a name="ongetdisplaystring"></a>COle 控制::在GetDisplayString上

由框架呼叫以獲取表示由*dispid*識別的屬性的當前值的字串。

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項屬性的分派識別碼。

*strValue*<br/>
對[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的引用,通過該物件將返回字串。

### <a name="return-value"></a>傳回值

如果字串在*strValue*中返回,則非零;否則為 0。

### <a name="remarks"></a>備註

如果控制項具有其值不能直接轉換為字串的屬性,並且希望該屬性的值顯示在容器提供的屬性瀏覽器中,請覆蓋此函數。

## <a name="colecontrolongetinplacemenu"></a><a name="ongetinplacemenu"></a>COleControl:ongetinplacemenu

當控件被 UI 啟動以獲取要合併到容器的現有功能表中的功能表時,由框架調用。

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>傳回值

控制項選單的句柄,如果控制項沒有,則為 NULL。 預設實現返回 NULL。

### <a name="remarks"></a>備註

有關合併 OLE 資源的詳細資訊,請參閱文章[「功能表和資源」(OLE)](../../mfc/menus-and-resources-ole.md)"。

## <a name="colecontrolongetnaturalextent"></a><a name="ongetnaturalextent"></a>COleControl:OnGet自然範圍

框架回應容器`IViewObjectEx::GetNaturalExtent`請求調用。

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 表示形式包括內容、圖示、縮略圖或列印文檔。 有效值取自枚舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*利索引*<br/>
感興趣的物件的部分。 目前只有 -1 有效。

*ptd*<br/>
指向定義應為其返回物件大小的目標設備的[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)結構。

*希塔吉特德夫*<br/>
指定*由 ptd*參數指示的目標設備的資訊上下文,物件可以從中提取設備指標並測試設備的功能。 如果*ptd*為 NULL,則物件應忽略*hicTargetDev*參數中的值。

*p 範圍資訊*<br/>
指向`DVEXTENTINFO`指定大小調整的數據的結構。 結構`DVEXTENTINFO`為:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

結構成員`dwExtentMode`可以採用兩個值之一:

- DVEXTENT_CONTENT查詢控制項應有多大以完全適合內容(對齊大小)

- DVEXTENT_INTEGRAL調整大小時,將建議的大小傳遞給控制項

*普西斯爾*<br/>
點以調整控制件返回的數據大小。 對於任何未調整的維度,返回的尺寸調整數據設置為 -1。

### <a name="return-value"></a>傳回值

如果成功返回或調整大小,則非零;否則 0。

### <a name="remarks"></a>備註

重寫此函數以返回物件的顯示大小,最接近`DVEXTENTINFO`結構中建議的大小和範圍模式。 默認實現返回 FALSE,不調整大小。

## <a name="colecontrolongetpredefinedstrings"></a><a name="ongetpredefinedstrings"></a>COle 控制::開啟預先定義字串

由框架呼叫以獲取一組預定義字串,表示屬性的可能值。

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項屬性的分派識別碼。

*pStringarray*<br/>
要用返回值填充的字串陣列。

*pCookiearray*<br/>
要用返回值填充的 DWORD 陣列。

### <a name="return-value"></a>傳回值

如果元素已添加到*pStringarray*和*pCookiearray*,則非零。

### <a name="remarks"></a>備註

如果控制項具有一組可以由字串表示的可能值的屬性,請覆蓋此函數。 對於添加到*pStringArray*的每個元素,應向*pCookiearray*添加相應的「cookie」元素。 這些 cookie 值稍後可能會由框架傳遞給函數`COleControl::OnGetPredefinedValue`。

## <a name="colecontrolongetpredefinedvalue"></a><a name="ongetpredefinedvalue"></a>COle 控制::取得預定義值

由 框架呼叫以取得與以前由 重寫傳回的預定義字串之一對應`COleControl::OnGetPredefinedStrings`的值 。

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項屬性的分派識別碼。

*dwCookie*<br/>
以前由 重寫返回`COleControl::OnGetPredefinedStrings`的 Cookie 值。

*lpvarOut*<br/>
指向將返回`VARIANT`屬性值的結構的指標。

### <a name="return-value"></a>傳回值

如果以*lpvarOut*中返回值,則非零。否則 0。

## <a name="colecontrolongetviewextent"></a><a name="ongetviewextent"></a>COleControl:OngetView 範圍

由框架呼叫以回應容器的[IViewObject2:::get 範圍](/windows/win32/api/oleidl/nf-oleidl-iviewobject2-getextent)請求。

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>參數

*dwDrawAspect*<br/>
DWORD 描述要顯示物件的表單或方面。 有效值取自枚舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*利索引*<br/>
感興趣的物件的部分。 目前只有 -1 有效。

*ptd*<br/>
指向定義應為其返回物件大小的目標設備的[DVTARGETDEVICE](/windows/win32/api/objidl/ns-objidl-dvtargetdevice)結構。

*lpsizel*<br/>
指向返回物件大小的位置。

### <a name="return-value"></a>傳回值

如果成功返回範圍資訊,則非零;否則 0。

### <a name="remarks"></a>備註

如果控制項使用雙色版繪圖,並且其不透明和透明零件具有不同的尺寸,則覆蓋此函數。

## <a name="colecontrolongetviewrect"></a><a name="ongetviewrect"></a>COleControl:OngetViewrect

框架回應容器`IViewObjectEx::GetRect`請求調用。

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
DWORD 描述要顯示物件的表單或方面。 有效值取自枚舉[DVASPECT 或](/windows/win32/api/wtypes/ne-wtypes-dvaspect)DVASPECT2:

- DVASPECT_CONTENT整個對象的邊界矩形。 物件原點與大小的左上角等於傳回的範圍`GetViewExtent`*。*

- DVASPECT_OPAQUE具有矩形不透明區域的物件返回該矩形。 其他人失敗了。

- DVASPECT_TRANSPARENT矩形,覆蓋所有透明或不規則零件。

*普雷克*<br/>
指向指定在其中繪製物件的矩形的[RECTL](/windows/win32/api/windef/ns-windef-rectl)結構。 此參數控制物件的定位和拉伸。

### <a name="return-value"></a>傳回值

如果成功返回到物件的矩形大小,則非零;否則 0。

### <a name="remarks"></a>備註

物件的大小由`OnGetViewRect`從特定位置開始的矩形轉換為矩形(預設值為顯示的左上角)。 如果控制項使用雙色版繪圖,並且其不透明和透明零件具有不同的尺寸,則覆蓋此函數。

## <a name="colecontrolongetviewstatus"></a><a name="ongetviewstatus"></a>COleControl:Onget查看狀態

框架回應容器`IViewObjectEx::GetViewStatus`請求調用。

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>傳回值

如果成功,則視圖狀態枚舉的值之一;否則 0。 可能的值是以下任意組合:

|||
|-|-|
|VIEWSTATUS_OPAQUE|對像是完全不透明的。 如果未設置此位,則物件包含透明部分。 此位僅適用於與內容相關的方面,不適用於DVASPECT_ICON或DVASPECT_DOCPRINT。|
|VIEWSTATUS_SOLIDBKGND|物件具有純背景(以純色而不是畫筆圖案組成)。 僅當設置VIEWSTATUS_OPAQUE且僅適用於內容相關方面,而不是應用於DVASPECT_ICON或DVASPECT_DOCPRINT時,此位才有意義。|
|VIEWSTATUS_DVASPECTOPAQUE|對象支援DVASPECT_OPAQUE。 使用此方面可以調用所有以繪圖方面作為參數的 IViewObjectEx 方法。|
|VIEWSTATUS_DVASPECTTRANSPARENT|物件支援DVASPECT_TRANSPARENT。 可以`IViewObjectEx`使用此方面調用所有以繪圖方面為參數的方法。|

### <a name="remarks"></a>備註

如果控件使用雙通道繪圖,請覆蓋此函數。 預設實現返回VIEWSTATUS_OPAQUE。

## <a name="colecontrolonhidetoolbars"></a><a name="onhidetoolbars"></a>COle 控制:在隱藏工具列上

當控件被 UI 停用時,由框架調用。

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>備註

實現應隱藏`OnShowToolbars`顯示 的所有工具列。

## <a name="colecontroloninactivemousemove"></a><a name="oninactivemousemove"></a>COle 控制:在作用滑鼠移動

收到WM_MOUSEMOVE消息時,容器為滑鼠指標下的非活動物件調用。

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
包含視窗的用戶端座標中的物件邊界矩形。 收到WM_MOUSEMOVE消息時,告訴物件其在螢幕上的確切位置和大小。

*x*<br/>
包含視窗的客戶端座標中的滑鼠位置的 x 座標。

*Y*<br/>
包含視窗的客戶端座標中的滑鼠位置的 y 座標。

*德基州*<br/>
標識鍵盤上鍵盤修改器鍵的當前狀態。 有效值可以是任何標誌MK_CONTROL、MK_SHIFT、MK_ALT、MK_BUTTON、MK_LBUTTON、MK_MBUTTON和MK_RBUTTON的組合。

### <a name="remarks"></a>備註

請注意,視窗客戶端座標(圖元)用於傳遞滑鼠游標位置。 這可以通過在同一座標系中傳遞物件的邊界矩形來實現。

## <a name="colecontroloninactivesetcursor"></a><a name="oninactivesetcursor"></a>COle 控制:oninactiveSetCursor

收到WM_SETCURSOR消息時,容器在滑鼠指標下為非活動物件調用。

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
包含視窗的用戶端座標中的物件邊界矩形。 收到WM_SETCURSOR消息時,告訴物件其在螢幕上的確切位置和大小。

*x*<br/>
包含視窗的客戶端座標中的滑鼠位置的 x 座標。

*Y*<br/>
包含視窗的客戶端座標中的滑鼠位置的 y 座標。

*dwMouseMsg*<br/>
發生WM_SETCURSOR的滑鼠消息的標識符。

*bSetAlways*<br/>
指定物件是否必須設置游標。 如果為 TRUE,則對象必須設置游標;如果為 TRUE,則對象必須設置游標。如果 FALSE,游標沒有義務設置游標,在這種情況下應返回S_FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

請注意,視窗客戶端座標(圖元)用於傳遞滑鼠游標位置。 這可以通過在同一座標系中傳遞物件的邊界矩形來實現。

## <a name="colecontrolonkeydownevent"></a><a name="onkeydownevent"></a>COleControl:在鍵下事件

處理股票密鑰下事件後由框架調用。

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
按下密鑰的虛擬金鑰代碼值。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

### <a name="remarks"></a>備註

如果控件需要在觸發事件後訪問密鑰資訊,請覆蓋此函數。

## <a name="colecontrolonkeypressevent"></a><a name="onkeypressevent"></a>COleControl::KeyPress事件

在股票 KeyPress 事件已觸發後,由框架調用。

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
包含按下的密鑰的虛擬金鑰代碼值。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

### <a name="remarks"></a>備註

請注意,容器可能已修改*nChar*值。

如果要在此事件發生後發出通知,請覆蓋此函數。

## <a name="colecontrolonkeyupevent"></a><a name="onkeyupevent"></a>COleControl:在KeyUpevent上

處理股票密鑰下事件後由框架調用。

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>參數

*n查爾*<br/>
按下密鑰的虛擬金鑰代碼值。 有關標準虛擬金鑰代碼的清單,請參閱 Winuser.h

*nShiftState*<br/>
包含以下旗標的組合:

- SHIFT_MASK在操作過程中按下 SHIFT 鍵。

- CTRL_MASK在操作期間按下了 CTRL 鍵。

- ALT_MASK在操作過程中按下 ALT 鍵。

### <a name="remarks"></a>備註

如果控件需要在觸發事件後訪問密鑰資訊,請覆蓋此函數。

## <a name="colecontrolonmappropertytopage"></a><a name="onmappropertytopage"></a>COleControl:在地圖屬性頁

由框架呼叫以取得實現編輯指定屬性的屬性頁的類 ID。

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>參數

*不一部分*<br/>
控制項屬性的分派識別碼。

*lpclsid*<br/>
指向將返回`CLSID`類ID的結構的指標。

*pbPage 選擇*<br/>
返回指定屬性頁的使用是否可選的指示器。

### <a name="return-value"></a>傳回值

如果以*lpclsid*中返回類 ID,則非零。否則 0。

### <a name="remarks"></a>備註

重寫此函數,提供從容器的屬性瀏覽器調用控制項的屬性頁的方法。

## <a name="colecontrolonmnemonic"></a><a name="onmnemonic"></a>COleControl:onMnemonic

當容器檢測到已按下 OLE 控制項的助記符鍵時,由框架調用。

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>參數

*pMsg*<br/>
助憶鍵 (Mnemonic) 按鍵所產生之 Windows 訊息的指標。

## <a name="colecontrolonproperties"></a><a name="onproperties"></a>COle 控制:屬性

當容器調用控件的屬性謂詞時,由框架調用。

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpMsg*<br/>
指向調用謂詞的 Windows 消息的指標。

*hWnd 父母*<br/>
控件的父視窗的句柄。

*lpRect*<br/>
指向容器中控制件使用的矩形的指標。

### <a name="return-value"></a>傳回值

如果調用成功,則非零;否則 0。

### <a name="remarks"></a>備註

預設實現顯示一個模態屬性對話方塊。

您還可以使用此功能來顯示控制項的屬性頁。 呼叫函數,`OnProperties`在*hWndParent*參數中傳遞控制項父項的句柄。 在這種情況下 *,lpMsg*和*lpRect*參數的值將被忽略。

## <a name="colecontrolonqueryhitpoint"></a><a name="onqueryhitpoint"></a>COle 控制:在查詢命中點

框架回應容器`IViewObjectEx::QueryHitPoint`請求調用。

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件的表示方式。 有效值取自枚舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向指定`RECT`OLE 控制工作區邊界矩形的結構的指標。

*普特洛克*<br/>
指向結構的`POINT`指標,指定要檢查的點進行命中。 該點在 OLE 工作區座標中指定。

*L 關閉提示*<br/>
定義"接近"到已檢查命中點的距離。

*pHitResult*<br/>
指向命中查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE *ptlLoc*位於 OLE 物件外部,不關閉。

- HITRESULT_TRANSPARENT *ptlLoc*在 OLE 物件的邊界內,但不靠近圖像。 例如,可以HITRESULT_TRANSPARENT透明圓中間的點。

- HITRESULT_CLOSE *ptlLoc*位於 OLE 物件內部或外部,但足夠靠近物件,可考慮內部。 小物件、細物件或詳細物件可能會使用此值。 即使某個點位於對象的邊界矩形之外,它也可能仍然接近(這是命中小物件所必需的)。

- HITRESULT_HIT *ptlLoc*位於物件的圖像中。

### <a name="return-value"></a>傳回值

成功返回命中結果時非零;否則 0。 命中與 OLE 控制顯示區域重疊。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與給定點重疊(點擊點)。 `QueryHitPoint`可以重寫以測試非矩形物件的命中。

## <a name="colecontrolonqueryhitrect"></a><a name="onqueryhitrect"></a>COleControl:在查詢中

框架回應容器`IViewObjectEx::QueryHitRect`請求調用。

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>參數

*dwAspect*<br/>
指定物件要進行表示的方式。 有效值取自枚舉[DVASPECT](/windows/win32/api/wtypes/ne-wtypes-dvaspect)或 DVASPECT2。

*pRectBounds*<br/>
指向指定`RECT`OLE 控制工作區邊界矩形的結構的指標。

*prcLoc*<br/>
指向`RECT`指定要檢查的矩形以進行命中(與物件矩形重疊)相對於物件的左上角的指標。

*L 關閉提示*<br/>
未使用。

*pHitResult*<br/>
指向命中查詢結果的指標。 下列其中一個值：

- HITRESULT_OUTSIDE OLE 物件不會命中矩形中的點。

- HITRESULT_HIT矩形中至少有一個點是物件的命中。

### <a name="return-value"></a>傳回值

成功返回命中結果時非零;否則 0。

### <a name="remarks"></a>備註

查詢物件的顯示矩形是否與給定矩形中的任何點重疊(點擊矩形)。 `QueryHitRect`可以重寫以測試非矩形物件的命中。

## <a name="colecontrolonrenderdata"></a><a name="onrenderdata"></a>COle 控制:在渲染資料上

框架調用以檢索指定格式的數據。

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構,指定請求資訊的格式。

*lpStg 中*<br/>
指向要返回數據的[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是以前使用[延遲渲染數據](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[延遲渲染文件](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)成員函數放置在控制項物件中的格式,用於延遲渲染。 如果提供的存儲介質是檔或`OnRenderFileData`記憶體`OnRenderGlobalData`,則此函數的預設實現將調用 或 。。" 如果請求的格式CF_METAFILEPICT或持久屬性集格式,則默認實現呈現適當的數據並返回非零。 否則,它將返回 0,並且不執行任何操作。

如果*lpStg中>tymedTYMED_NULL,* 則STGMEDIUM應按*lpFormatEtc->tymed*指定分配和填充。 如果不TYMED_NULL,則 STGMEDIUM 應隨數據一起填充。

重寫此函數以請求的格式和媒體提供資料。 根據數據的不同,您可能希望重寫此函數的其他版本之一。 如果資料較小且大小固定,請重寫`OnRenderGlobalData`。 如果資料位於檔案中,或大小可變,請重寫`OnRenderFileData`。

有關詳細資訊,請參閱 Windows `FORMATETC` SDK`STGMEDIUM`中的和結構。

## <a name="colecontrolonrenderfiledata"></a><a name="onrenderfiledata"></a>COle 控制:在渲染檔案資料上

當存儲媒體是檔時,框架呼叫以指定格式檢索資料。

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構,指定請求資訊的格式。

*pFile*<br/>
指向要呈現數據的[CFile](../../mfc/reference/cfile-class.md)物件。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是以前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成員函數放置在控制項物件中的格式,用於延遲渲染。 此函數的預設實現僅返回 FALSE。

重寫此函數以請求的格式和媒體提供資料。 根據數據的不同,您可能希望重寫此函數的其他版本之一。 如果要處理多個儲存媒體,則重寫`OnRenderData`。 如果資料位於檔案中,或大小可變,請重寫`OnRenderFileData`。

有關詳細資訊,請參閱 Windows `FORMATETC` SDK 中的結構。

## <a name="colecontrolonrenderglobaldata"></a><a name="onrenderglobaldata"></a>COle 控制:在渲染全域資料

當指定的存儲媒體是全域記憶體時,框架調用以指定格式檢索資料。

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構,指定請求資訊的格式。

*phGlobal*<br/>
指向要返回數據的全域記憶體的句柄。 如果未分配記憶體,則此參數可以是 NULL。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

指定的格式是以前使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)成員函數放置在控制項物件中的格式,用於延遲渲染。 此函數的預設實現僅返回 FALSE。

如果*phGlobal*為 NULL,則應在 phGLOBAL 中分配並返回新的*HGLOBAL。* 否則 *,phGLOBAL*指定的 HGLOBAL 應填充數據。 放置在 HGLOBAL 中的數據量不得超過記憶體區塊的當前大小。 此外,塊無法重新分配到更大的大小。

重寫此函數以請求的格式和媒體提供資料。 根據數據的不同,您可能希望重寫此函數的其他版本之一。 如果要處理多個儲存媒體,則重寫`OnRenderData`。 如果資料位於檔案中,或大小可變,請重寫`OnRenderFileData`。

有關詳細資訊,請參閱 Windows `FORMATETC` SDK 中的結構。

## <a name="colecontrolonresetstate"></a><a name="onresetstate"></a>COle 控制:在重置狀態

當控件的屬性應設置為其預設值時,由框架調用。

```
virtual void OnResetState();
```

### <a name="remarks"></a>備註

預設為[DoPropExchange,](#dopropexchange)傳遞`CPropExchange`導致 屬性設定為其預設值的物件。

控制項編寫器可以在此可重寫中插入 OLE 控制程式的初始化代碼。 當[IPersistStream::載入](/windows/win32/api/objidl/nf-objidl-ipersiststream-load)或[I 持久儲存:載入](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)失敗,或[IPersistStreaminit::Ininnew](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-initnew)或[IpersistStorage::InitNew](/windows/win32/api/objidl/nf-objidl-ipersiststorage-initnew)`IPersistStream::Load`呼`IPersistStorage::Load`叫時,呼叫此函數 , 無需首先呼叫或呼叫 。

## <a name="colecontrolonsetclientsite"></a><a name="onsetclientsite"></a>COleControl:在設定客戶端站台

當容器調用控件的`IOleControl::SetClientSite`函數時,由框架調用。

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>備註

預設情況下,`OnSetClientSite`檢查是否載入資料路徑屬性,如果是否載入,則呼`DoDataPathPropExchange`叫 。

重寫此函數以執行此通知的任何特殊處理。 特別是,此函數的重寫應調用基類。

## <a name="colecontrolonsetdata"></a><a name="onsetdata"></a>COleControl:OnSetData

由框架調用以將控制項的數據替換為指定數據。

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>參數

*lpFormatEtc*<br/>
指向指定數據格式的[FORMATETC](/windows/win32/api/objidl/ns-objidl-formatetc)結構的指標。

*lpStg 中*<br/>
指向數據所在的[STGMEDIUM](/windows/win32/api/objidl/ns-objidl-ustgmedium~r1)結構的指標。

*b釋放*<br/>
如果控件應釋放存儲介質,則為 TRUE;如果控件不應釋放存儲介質,則 FALSE。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果數據採用持久屬性集格式,則默認實現將相應地修改控制項的狀態。 否則,默認實現不執行任何操作。 如果*bRelease*為`ReleaseStgMedium`TRUE,則呼叫 ;否則,不。

重寫此函數以將控制項資料替換為指定的數據。

有關詳細資訊,請參閱 Windows `FORMATETC` SDK`STGMEDIUM`中的和結構。

## <a name="colecontrolonsetextent"></a><a name="onsetextent"></a>COle 控制:在設定範圍

當需要更改控制項的範圍時,由於調用[IOleObject:::set範圍](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setextent),則由框架呼叫。

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>參數

*lpSizeL*<br/>
指向使用長整`SIZEL`數表示控件的寬度和高度的結構的指標,以 HIMETRIC 單位表示。

### <a name="return-value"></a>傳回值

如果接受大小更改,則非零;否則 0。

### <a name="remarks"></a>備註

默認實現處理控制項範圍的調整大小。 如果控件處於就地活動狀態,則對容器的`OnPosRectChanged`調用。

重寫此函數以更改控制項的預設大小調整。

## <a name="colecontrolonsetobjectrects"></a><a name="onsetobjectrects"></a>COle 控制:OnSetObjectrects

由框架呼叫以實現[對 IOleInPlace 物件的呼叫::設定物件重新物件](/windows/win32/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects)。

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>參數

*lpRectPos*<br/>
指向指示控制項相對於`RECT`容器的新位置和大小的結構的指標。

*lprectClip*<br/>
指向指示要剪切`RECT`控件的矩形區域的結構的指標。

### <a name="return-value"></a>傳回值

接受重新置放時非零;否則 0。

### <a name="remarks"></a>備註

預設實現自動處理控制器視窗的重新置放和調整大小,並傳回 TRUE。

重寫此函數以更改此函數的默認行為。

## <a name="colecontrolonshowtoolbars"></a><a name="onshowtoolbars"></a>COleControl::在顯示工具列上

當控件已啟動 UI 時,由框架呼叫。

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>備註

預設實作不做任何動作。

## <a name="colecontrolontextchanged"></a><a name="ontextchanged"></a>COle 控制:在文字上改變

當股票標題或文本屬性值發生更改時,由框架調用。

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>備註

預設執行呼叫`InvalidateControl`。

如果要在此屬性更改後通知,則重寫此函數。

## <a name="colecontrolonwindowlessmessage"></a><a name="onwindowlessmessage"></a>COleControl:無視窗訊息

框架回應容器`IOleInPlaceObjectWindowless::OnWindowMessage`請求調用。

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>參數

*味精*<br/>
由 Windows 傳遞的消息識別碼。

*wParam*<br/>
通過Windows。 指定其他特定於消息的資訊。 此參數的內容取決於*msg*參數的值。

*lParam*<br/>
通過Windows。 指定其他特定於消息的資訊。 此參數的內容取決於*msg*參數的值。

*PlResult*<br/>
視窗結果代碼。 指定消息處理的結果,並取決於發送的消息。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

處理無視窗控制件的視窗訊息。 `COleControl`應`OnWindowlessMessage`用於滑鼠消息和鍵盤消息以外的視窗訊息。 `COleControl`提供[SetCapture](#setcapture)和[SetFocus,](#setfocus)專門用於獲取無視窗 OLE 物件的滑鼠捕獲和鍵盤焦點。

由於無視窗物件沒有視窗,因此它們需要一種機制來讓容器向它們發送消息。 無視窗 OLE`OnWindowMessage``IOleInPlaceObjectWindowless`物件透過介面上的方法(用於無視窗支援的[IOleInPlace 物件的](/windows/win32/api/oleidl/nn-oleidl-ioleinplaceobject)擴展),從其容器獲取消息。 `OnWindowMessage`不採用參數`HWND`。

## <a name="colecontrolparenttoclient"></a><a name="parenttoclient"></a>COleControl::P客戶

將*pPoint*的座標轉換為客戶端座標。

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>參數

*lprcBounds*<br/>
指向容器內 OLE 控件的邊界。 不是工作區,而是整個控件的區域,包括邊框和滾動條。

*pPoint*<br/>
指向父(容器)點的指標要轉換為控制項的工作區的座標。

*bHitTest*<br/>
指定是否在點上執行命中測試。

### <a name="return-value"></a>傳回值

如果*bHitTest*是 FALSE,則返回 HTNOWHERE。 如果*bHitTest*為 TRUE,則傳回父(容器)點降落在 OLE 控制項的工作區的位置,並且是以下滑鼠命中測試值之一:

- HTBORDER 在沒有大小調整邊框的窗口的邊框中。

- HTBOTTOM 在視窗的下水平邊框中。

- 在視窗邊框的左下角。

- 在視窗邊框的右下角。

- 在標題欄區域中。

- 在用戶端區域中。

- HTERROR 在螢幕背景或視窗之間的分界線上(與 HTNOWHERE`DefWndProc`相同,只不過 Windows 功能發出系統蜂鳴音以指示錯誤)。

- 在大小框中。

- HTHSCROLL 在水準滾動條中。

- 在視窗的左側邊框中。

- HTMAXBUTTON 在最大化按鈕中。

- 在功能表區域中。

- 在最小化按鈕中。

- 在螢幕背景或視窗之間的分界線上。

- 在最小化按鈕中。

- 在視窗的右側邊框中。

- 在大小框中(與 HTGROWBOX 相同)。

- 在「控制」功能表中或在子視窗中的「關閉」按鈕中。

- HTTOP 在視窗的上水平邊框中。

- 在視窗邊框的左上角。

- 在視窗邊框的右上角。

- HTOPAQUE 目前由另一個視窗覆蓋的視窗。

- 垂直滾動欄中的 HTVSCROLL。

- 在最大化按鈕中使用 HTZOOM。

### <a name="remarks"></a>備註

在輸入*pPoint*上相對於父端的原點(容器的左上角)。 在輸出*pPoint*上相對於 OLE 控制項的工作區的原點(控制項的工作區的左上角)。

## <a name="colecontrolpostmodaldialog"></a><a name="postmodaldialog"></a>COleControl::P模式對話

通知容器模式對話框已關閉。

```cpp
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWnd 父母*<br/>
處理模式對話框的父視窗。

### <a name="remarks"></a>備註

顯示任何模式對話框後調用此函數。 必須呼叫此函數,以便容器可以啟用`PreModalDialog`由禁用的任何頂級視窗。 此函數應與調用`PreModalDialog`配對。

## <a name="colecontrolpremodaldialog"></a><a name="premodaldialog"></a>COleControl::P重新模式對話

通知容器即將顯示模式對話方塊。

```cpp
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>參數

*hWnd 父母*<br/>
處理模式對話框的父視窗。

### <a name="remarks"></a>備註

在顯示任何模式對話框之前調用此函數。 您必須呼叫此函數,以便容器可以禁用其所有頂級視窗。 顯示模式對話框後,必須呼叫`PostModalDialog`。

## <a name="colecontrolrecreatecontrolwindow"></a><a name="recreatecontrolwindow"></a>COle 控制:重新建立控制視窗

銷毀並重新建立控制項的視窗。

```cpp
void RecreateControlWindow();
```

### <a name="remarks"></a>備註

如果需要更改視窗的樣式位,則可能需要這樣做。

## <a name="colecontrolrefresh"></a><a name="refresh"></a>COle 控制:刷新

強制重新繪製 OLE 控制項。

```cpp
void Refresh();
```

### <a name="remarks"></a>備註

`COleControl`基類支援此功能作為股票方法(稱為刷新)。 這允許 OLE 控制件的使用者在特定時間重新繪製控制件。 有關此方法的詳細資訊,請參閱文章[ActiveX 控制件:方法](../../mfc/mfc-activex-controls-methods.md)。

## <a name="colecontrolreleasecapture"></a><a name="releasecapture"></a>COle 控制::發佈捕獲

釋放滑鼠捕獲。

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果控件當前具有滑鼠捕獲,則釋放捕獲。 否則,此函數不起作用。

## <a name="colecontrolreleasedc"></a><a name="releasedc"></a>COle 控制:釋放DC

釋放無視窗控制件容器的顯示設備上下文,釋放設備上下文供其他應用程式使用。

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
標識要發佈的容器設備上下文。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

應用程式必須調用`ReleaseDC` [GetDC](#getdc)的每個調用。

## <a name="colecontrolreparentcontrolwindow"></a><a name="reparentcontrolwindow"></a>COle 控制::重父控制視窗

設置控件的父級。

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>參數

*hWndouter*<br/>
控制視窗的句柄。

*hWnd 父母*<br/>
新父視窗的句柄。

### <a name="remarks"></a>備註

調用此函數以重置控制視窗的父級。

## <a name="colecontrolresetstockprops"></a><a name="resetstockprops"></a>COle 控制::重置庫存

將`COleControl`股票屬性的狀態初始化到其預設值。

```cpp
void ResetStockProps();
```

### <a name="remarks"></a>備註

屬性包括:外觀、背面顏色、邊框樣式、標題、啟用、字體、前顏色、hwnd 和文本。 有關股票屬性的說明,請參閱[ActiveX 控制項:添加股票屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

可以使用`ResetStockProps``ResetVersion`和可以提高控制項的二進位初始化性能`COleControl::OnResetState`。 請參閱下方的範例。 有關最佳化初始化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

## <a name="colecontrolresetversion"></a><a name="resetversion"></a>COle 控制:重置版本

將版本號初始化為指定值。

```cpp
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>參數

*dwVersionDefault*<br/>
要分配給控制件的版本號。

### <a name="remarks"></a>備註

可以使用`ResetVersion``ResetStockProps`和可以提高控制項的二進位初始化性能`COleControl::OnResetState`。 請參閱[ResetStock Props](#resetstockprops)上的範例。 有關最佳化初始化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolscrollwindow"></a><a name="scrollwindow"></a>COle 控制:滾動視窗

允許無視窗 OLE 物件在螢幕上滾動其就地活動圖像中的區域。

```cpp
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>參數

*x 數量*<br/>
指定水準滾動的數量(以設備單位為單位)。 此參數必須是向左滾動的負值。

*y 數量*<br/>
指定垂直滾動的數量(以設備單位為單位)。 此參數必須是負值才能向上滾動。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或 RECT 結構,該結構指定 OLE 物件要滾動的工作區部分,位於包含視窗的用戶端座標中。 如果*lpRect*為 NULL,則滾動整個 OLE 物件的工作區。

*lpClipRect*<br/>
指向指定`CRect`要剪輯`RECT`到的矩形的物件或結構。 僅滾動矩形內的圖元。 矩形外部的位不受影響,即使它們位於*lpRect*矩形中也是如此。 如果*lpClipRect*為 NULL,則滾動矩形上不執行任何剪輯。

## <a name="colecontrolselectfontobject"></a><a name="selectfontobject"></a>COle 控制:選擇字型物件

在設備上下文中選擇字型。

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>參數

*pDC*<br/>
指向設備上下文物件的指標。

*字型持有人*<br/>
引用表示要選擇的字體的[CFontHolder](../../mfc/reference/cfontholder-class.md)物件。

### <a name="return-value"></a>傳回值

指向以前選定的字體的指標。 當呼叫者完成*使用 fontHolder*的圖操作後,應重新選擇以前選擇的字型,將其作為參數傳遞給[CDC::選擇物件](../../mfc/reference/cdc-class.md#selectobject)。

## <a name="colecontrolselectstockfont"></a><a name="selectstockfont"></a>COleControl:選擇庫存字型

在設備上下文中選擇"庫存字體"屬性。

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>參數

*pDC*<br/>
將在其中選擇字體的設備上下文。

### <a name="return-value"></a>傳回值

指向以前選定的`CFont`物件的指標。 您應該使用[CDC::選擇 Object,](../../mfc/reference/cdc-class.md#selectobject)在完成後選擇此字型回裝置上下文中。

## <a name="colecontrolserializeextent"></a><a name="serializeextent"></a>COle 控制:序列化範圍

序列化或初始化分配給控制項的顯示空間的狀態。

```cpp
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
要`CArchive`序列化到或從中序列化的物件。

### <a name="remarks"></a>備註

可以使用`SerializeExtent``SerializeStockProps``SerializeVersion`和可以提高控制項的二進制持久性`COleControl::Serialize`性能, 請參閱下方的範例。 有關最佳化初始化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

## <a name="colecontrolserializestockprops"></a><a name="serializestockprops"></a>COle 控制:序列化庫存

序列化或初始化`COleControl`股票屬性的狀態:外觀、背面顏色、邊框樣式、標題、已啟用、字體、前顏色和文本。

```cpp
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>參數

*ar*<br/>
要`CArchive`序列化到或從中序列化的物件。

### <a name="remarks"></a>備註

有關股票屬性的說明,請參閱[ActiveX 控制項:添加股票屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。

可以使用`SerializeStockProps``SerializeExtent``SerializeVersion`和可以提高控制項的二進制持久性`COleControl::Serialize`性能, 例如,請參閱[序列化範圍](#serializeextent)中的代碼。 有關最佳化初始化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolserializeversion"></a><a name="serializeversion"></a>COle 控制:序列化版本

序列化或初始化控制件的版本資訊的狀態。

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>參數

*ar*<br/>
要`CArchive`序列化到或從中序列化的物件。

*dwVersionDefault*<br/>
控件的當前版本號。

*b轉換*<br/>
指示在保存持久性數據時是否應轉換為最新格式,還是以載入時的相同格式進行維護。

### <a name="return-value"></a>傳回值

控件的版本號。 如果正在載入指定的存檔,則`SerializeVersion`返回從該存檔載入的版本。 否則,它將返回當前載入的版本。

### <a name="remarks"></a>備註

可以使用`SerializeVersion``SerializeExtent``SerializeStockProps`和可以提高控制項的二進制持久性`COleControl::Serialize`性能, 例如,請參閱[序列化範圍](#serializeextent)中的代碼。 有關最佳化初始化的詳細資訊,請參閱[ActiveX 控制件:最佳化](../../mfc/mfc-activex-controls-optimization.md)。

## <a name="colecontrolsetappearance"></a><a name="setappearance"></a>COle 控制::設定外觀

設置控制的庫存外觀屬性值。

```cpp
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>參數

*s 外觀*<br/>
用於**short**控件外觀的簡短(VT_I2)值。 值為零將控制的外觀設置為平面,值1將控制項的外觀設置為3D。

### <a name="remarks"></a>備註

有關股票屬性的更多,請參閱[ActiveX 控制項:屬性](../../mfc/mfc-activex-controls-properties.md)。

## <a name="colecontrolsetbackcolor"></a><a name="setbackcolor"></a>COle 控制::設定回顏色

設置控制項庫存回顏色屬性值。

```cpp
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>參數

*dwBackColor*<br/>
用於控制項的背景繪製的OLE_COLOR值。

### <a name="remarks"></a>備註

有關使用此屬性和其他相關屬性的詳細資訊,請參閱[文章 ActiveX 控制項:屬性](../../mfc/mfc-activex-controls-properties.md)。

## <a name="colecontrolsetborderstyle"></a><a name="setborderstyle"></a>COle 控制:設定邊框樣式

設置控制的庫存 BorderStyle 屬性值。

```cpp
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>參數

*s 邊框樣式*<br/>
控件的新邊框樣式;0 表示沒有邊框,1 表示正常邊框。

### <a name="remarks"></a>備註

然後,將重新創建和`OnBorderStyleChanged`調用控制視窗。

## <a name="colecontrolsetcapture"></a><a name="setcapture"></a>COle 控制:設定擷取

使控制項的容器視窗代表控制件獲取滑鼠捕捉。

```
CWnd* SetCapture();
```

### <a name="return-value"></a>傳回值

指向以前接收滑鼠`CWnd`輸入的視窗物件的指標。

### <a name="remarks"></a>備註

如果控制項被啟動且無視窗,則此函數會導致控制件的容器視窗代表控制件獲取滑鼠捕獲。 否則,此函數會導致控件本身獲取滑鼠捕獲(與`CWnd::SetCapture`相同)。

## <a name="colecontrolsetcontrolsize"></a><a name="setcontrolsize"></a>COle 控制:設定控制大小

設置 OLE 控制視窗的大小,並通知容器控制件站台正在更改。

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>參數

*殘雪*<br/>
指定控制項的新寬度(以像素為單位)。

*cy*<br/>
指定控制項的新高度(以像素為單位)。

### <a name="return-value"></a>傳回值

如果調用成功,則非零;否則 0。

### <a name="remarks"></a>備註

此函數不應在控制的構造函數中使用。

請注意,控制項視窗的所有座標都相對於控制項的左上角。

## <a name="colecontrolsetenabled"></a><a name="setenabled"></a>COle 控制:已開啟

設置控制項的「已啟用」屬性值。

```cpp
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
如果要啟用控制項,則為 TRUE;如果要啟用該控制項,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

設定此屬性後,`OnEnabledChange`將呼叫。

## <a name="colecontrolsetfocus"></a><a name="setfocus"></a>COle 控制:設定焦點

使控制項的容器視窗以控制的名義占用輸入焦點。

```
CWnd* SetFocus();
```

### <a name="return-value"></a>傳回值

指向以前具有輸入`CWnd`焦點的視窗物件的指標,如果沒有這樣的視窗,則指向 NULL。

### <a name="remarks"></a>備註

如果控制項被啟動且無視窗,則此函數會導致控制件的容器視窗以控制項的名義獲取輸入焦點。 輸入焦點將鍵盤輸入定向到容器的視窗,容器將所有後續的鍵盤消息調度到調用`SetFocus`的 OLE 物件。 以前具有輸入焦點的任何視窗都丟失它。

如果控件不是無視窗的,則此函數會導致控制項本身佔用輸入焦點(與`CWnd::SetFocus`相同)。

## <a name="colecontrolsetfont"></a><a name="setfont"></a>COle 控制::設定字型

設置控制的庫存字型屬性。

```cpp
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>參數

*pFontDisp*<br/>
指向字體調度介面的指標。

## <a name="colecontrolsetforecolor"></a><a name="setforecolor"></a>COleControl:設置福彩

設置控制項庫存 ForeColor 屬性值。

```cpp
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>參數

*dwForeColor*<br/>
用於控制的前景繪圖的OLE_COLOR值。

### <a name="remarks"></a>備註

有關使用此屬性和其他相關屬性的詳細資訊,請參閱[文章 ActiveX 控制項:屬性](../../mfc/mfc-activex-controls-properties.md)。

## <a name="colecontrolsetinitialdataformats"></a><a name="setinitialdataformats"></a>COleControl:設定初始資料格式

由框架呼叫以初始化控制項支援的資料格式清單。

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>備註

預設實現指定兩種格式:CF_METAFILEPICT 和持久屬性集。

## <a name="colecontrolsetinitialsize"></a><a name="setinitialsize"></a>COle 控制:設定初始大小

設置首次顯示在容器中的 OLE 控制的大小。

```cpp
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>參數

*殘雪*<br/>
OLE 控制項的初始寬度(以像素為單位)。

*cy*<br/>
OLE 控制項初始高度(以像素為單位)。

### <a name="remarks"></a>備註

在建構函數中調用此函數以設置控制件的初始大小。 初始大小以設備單位或像素為單位進行測量。 建議在控制項的構造函數中進行此調用。

## <a name="colecontrolsetmodifiedflag"></a><a name="setmodifiedflag"></a>COle 控制:設定已修改的標籤

更改控制項的已修改狀態。

```cpp
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*b 修改*<br/>
控制項已修改標誌的新值。 TRUE 表示控件的狀態已被修改;FALSE 表示控件的狀態剛剛保存。

### <a name="remarks"></a>備註

每當發生會影響控件的持久狀態的更改時,請調用此函數。 例如,如果持久屬性的值發生更改,請用 b*bModified*修改**TRUE**調用此函數。

## <a name="colecontrolsetnotpermitted"></a><a name="setnotpermitted"></a>COle 控制:設定不允許

指示編輯請求失敗。

```cpp
void SetNotPermitted();
```

### <a name="remarks"></a>備註

發生故障時`BoundPropertyRequestEdit`調用此函數。 此函數將引發類型`COleDispScodeException`異常,以指示不允許設置操作。

## <a name="colecontrolsetnotsupported"></a><a name="setnotsupported"></a>COle 控制:設定不支援

防止使用者修改控制項的屬性值。

```cpp
void SetNotSupported();
```

### <a name="remarks"></a>備註

呼叫此函數以代替不支援控制使用者修改屬性值的任何屬性的 Set 函數。 例如,一個屬性是唯讀的。

## <a name="colecontrolsetrectincontainer"></a><a name="setrectincontainer"></a>COle 控制:setrectin 容器

設置控制項相對於容器的座標,以設備單位表示。

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
指向包含控制項相對於容器的新座標的矩形的指標。

### <a name="return-value"></a>傳回值

如果調用成功,則非零;否則 0。

### <a name="remarks"></a>備註

如果控件處於打開狀態,則調整控制件的大小;如果控件處於打開狀態,則調整控制件的大小。否則將呼叫容器的功能`OnPosRectChanged`。

## <a name="colecontrolsettext"></a><a name="settext"></a>COle 控制:設定文字

設定控制項庫存或文字屬性的值。

```cpp
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>參數

*pszText*<br/>
指向字串的指標。

### <a name="remarks"></a>備註

請注意,股票標題和文本屬性都映射到相同的值。 這意味著對任一屬性所做的任何更改都將自動更改這兩個屬性。 通常,控件應支援股票標題或文本屬性,但不能同時支援這兩者。

## <a name="colecontrolthrowerror"></a><a name="throwerror"></a>COle 控制::投擲錯誤

指示控件中出現錯誤。

```cpp
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);

void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>參數

*Sc*<br/>
要報告的狀態代碼值。 有關可能代碼的完整清單,請參閱[「ActiveX 控件:高級主題」一](../../mfc/mfc-activex-controls-advanced-topics.md)文。

*描述 ID*<br/>
要報告的異常的字串資源 ID。

*nHelpID*<br/>
要報告的主題的幫助 ID。

*psz描述*<br/>
包含要報告的異常的解釋的字串。

### <a name="remarks"></a>備註

此函數應僅從 OLE 屬性的 Get 或 Set 函數中調用,或實現 OLE 自動化方法。 如果需要發出其他時間發生的錯誤信號,則應觸發庫存錯誤事件。

## <a name="colecontroltransformcoords"></a><a name="transformcoords"></a>COle 控制:轉換庫德

變換 HIMETRIC 單位和容器的本機單位之間的座標值。

```cpp
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>參數

*lpptlHimetric*<br/>
指向包含`POINTL`HIMETRIC 單位座標的結構的指標。

*lpptf 容器*<br/>
指向`POINTF`容器單位大小中包含座標的結構的指標。

*flags*<br/>
以下值的組合:

- XFORMCOORDS_POSITION容器中的位置。

- XFORMCOORDS_SIZE 容器中的大小。

- XFORMCOORDS_HIMETRICTOCONTAINER將 HIMETRIC 單元轉換為容器的單位。

- XFORMCOORDS_CONTAINERTOHIMETRIC將容器的單位轉換為 HIMETRIC 單位。

### <a name="remarks"></a>備註

前兩個標誌(XFORMCOORDS_POSITION和XFORMCOORDS_SIZE)指示座標是否應被視為位置或大小。 其餘兩個標誌指示轉換方向。

## <a name="colecontroltranslatecolor"></a><a name="translatecolor"></a>COleControl:翻譯顏色

將顏色值從OLE_COLOR資料類型轉換為[COLORREF](/windows/win32/gdi/colorref)資料類型。

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>參數

*clrColor*<br/>
OLE_COLOR數據類型。 有關詳細資訊,請參閱 Windows [OleTranslateColor](/windows/win32/api/olectl/nf-olectl-oletranslatecolor)功能。

*赫帕爾*<br/>
可選調色板的句柄;可以是 NULL。

### <a name="return-value"></a>傳回值

RGB(紅色、綠色、藍色)32 位顏色值,用於定義最接近設備可以表示的*clrColor*值的純色。

### <a name="remarks"></a>備註

此功能可用於將庫存 ForeColor 和 BackColor 屬性轉換為[CDC](../../mfc/reference/cdc-class.md)成員函數使用的 COLORREF 類型。

## <a name="colecontrolwillambientsbevalidduringload"></a><a name="willambientsbevalidduringload"></a>COle 控制:在載入期間,環境將有效

確定控件是否應使用環境屬性的值作為預設值,當它隨後從其持久狀態載入時。

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>傳回值

非零表示環境屬性將有效;因此,表示環境屬性將有效。否則環境屬性將無效。

### <a name="remarks"></a>備註

在某些容器中,控制檔在初始呼叫`COleControl::DoPropExchange`重寫 期間可能無法存取其環境屬性。 如果容器調用[IPersistStreamInit::載入](/windows/win32/api/ocidl/nf-ocidl-ipersiststreaminit-load)或[IPersistStorage::在](/windows/win32/api/objidl/nf-objidl-ipersiststorage-load)調用[IOleObject::setClientSite](/windows/win32/api/oleidl/nf-oleidl-ioleobject-setclientsite)之前載入(即,如果它不符合OLEMISC_SETCLIENTSITEFIRST狀態位),則屬於這種情況。

## <a name="colecontrolwindowproc"></a><a name="windowproc"></a>COle 控制::視窗 Proc

為`COleControl`物件提供 Windows 過程。

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*message*<br/>
指定要處理的 Windows 訊息。

*wParam*<br/>
提供用於處理消息的其他資訊。 參數值取決於消息。

*lParam*<br/>
提供用於處理消息的其他資訊。 參數值取決於消息。

### <a name="return-value"></a>傳回值

調度消息的返回值。

### <a name="remarks"></a>備註

調用此函數通過控制件的消息映射調度特定消息。

## <a name="see-also"></a>另請參閱

[MFC 樣品 CIRC3](../../overview/visual-cpp-samples.md)<br/>
[MFC 樣品測試](../../overview/visual-cpp-samples.md)<br/>
[COlePropertyPage 類別](../../mfc/reference/colepropertypage-class.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CFontHolder 類別](../../mfc/reference/cfontholder-class.md)<br/>
[CPictureHolder 類別](../../mfc/reference/cpictureholder-class.md)<br/>
