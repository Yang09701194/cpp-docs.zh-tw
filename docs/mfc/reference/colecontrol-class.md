---
title: "COleControl 類別 |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- OLE controls, MFC
- windowless controls, MFC
- windowless controls
- controls [MFC], OLE
- controls [MFC], windowless
- COleControl class
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
caps.latest.revision: 25
author: mikeblome
ms.author: mblome
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 128bd124c2536d86c8b673b54abc4b5505526b41
ms.openlocfilehash: 7f98ac382549509874bd570307a05ccea5ed657a
ms.contentlocale: zh-tw
ms.lasthandoff: 05/10/2017

---
# <a name="colecontrol-class"></a>COleControl 類別
開發 OLE 控制項的強大基底類別。  
  
## <a name="syntax"></a>語法  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Members  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|說明|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|建立 `COleControl` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|說明|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|擷取目前控制項的外觀。|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|傳回環境 BackColor 屬性值。|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|容器會傳回所指定控制項的名稱。|  
|[COleControl::AmbientFont](#ambientfont)|傳回環境字型屬性值。|  
|[COleControl::AmbientForeColor](#ambientforecolor)|傳回的環境前景色彩屬性的值。|  
|[Colecontrol:: Ambientlocaleid](#ambientlocaleid)|傳回容器的地區設定識別碼。|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|傳回容器所使用的單位的類型。|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|決定是否應該顯示抓取控點。|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|決定是否應該顯示影線。|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|傳回容器所指定的文字對齊類型。|  
|[COleControl::AmbientUIDead](#ambientuidead)|決定控制項應該回應使用者介面動作。|  
|[COleControl::AmbientUserMode](#ambientusermode)|請判斷容器的模式。|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|通知容器繫結的屬性已變更。|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|若要編輯屬性值的要求權限。|  
|[COleControl::ClientToParent](#clienttoparent)|將轉譯相對於控制項的原點的點，相對於其容器的原點的點。|  
|[COleControl::ClipCaretRect](#clipcaretrect)|如果它由控制項重疊，請調整插入號矩形。|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|由控制項的助憶鍵的集合變更後，請呼叫此函式。|  
|[COleControl::DisplayError](#displayerror)|控制項的使用者顯示內建的錯誤事件。|  
|[COleControl::DoClick](#doclick)|實作的存貨`DoClick`方法。|  
|[COleControl::DoPropExchange](#dopropexchange)|序列化的屬性`COleControl`物件。|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|重新繪製已子類別化 Windows 控制項從 OLE 控制項。|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|啟用控制項支援簡單的框架。|  
|[COleControl::ExchangeExtent](#exchangeextent)|將序列化控制項的寬度和高度。|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|將序列化控制項的內建屬性。|  
|[COleControl::ExchangeVersion](#exchangeversion)|將序列化控制的版本號碼。|  
|[COleControl::FireClick](#fireclick)|引發股票`Click`事件。|  
|[COleControl::FireDblClick](#firedblclick)|引發股票`DblClick`事件。|  
|[Colecontrol:: Fireerror](#fireerror)|引發股票`Error`事件。|  
|[COleControl::FireEvent](#fireevent)|引發自訂事件。|  
|[COleControl::FireKeyDown](#firekeydown)|引發股票`KeyDown`事件。|  
|[COleControl::FireKeyPress](#firekeypress)|引發股票`KeyPress`事件。|  
|[COleControl::FireKeyUp](#firekeyup)|引發股票`KeyUp`事件。|  
|[COleControl::FireMouseDown](#firemousedown)|引發股票`MouseDown`事件。|  
|[COleControl::FireMouseMove](#firemousemove)|引發股票`MouseMove`事件。|  
|[COleControl::FireMouseUp](#firemouseup)|引發股票`MouseUp`事件。|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|引發事件的控制項就緒狀態變更時。|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|支援的控制項的預設啟動行為會改變`IPointerInactive`介面。|  
|[COleControl::GetAmbientProperty](#getambientproperty)|傳回所指定的環境屬性的值。|  
|[COleControl::GetAppearance](#getappearance)|傳回內建的外觀屬性的值。|  
|[COleControl::GetBackColor](#getbackcolor)|傳回內建的 BackColor 屬性值。|  
|[COleControl::GetBorderStyle](#getborderstyle)|傳回內建 BorderStyle 屬性值。|  
|[COleControl::GetCapture](#getcapture)|判斷無視窗，已啟用的控制項物件是否具有滑鼠捕捉。|  
|[COleControl::GetClassID](#getclassid)|擷取控制項的 OLE 類別 ID。|  
|[COleControl::GetClientOffset](#getclientoffset)|擷取控制項的矩形區域的左上的角和其工作區的左上的角的差異。|  
|[COleControl::GetClientRect](#getclientrect)|擷取控制項的工作區的大小。|  
|[COleControl::GetClientSite](#getclientsite)|查詢的物件，其目前的用戶端站台容器中的指標。|  
|[Clippaintdc](#getcontrolflags)|擷取控制旗標設定。|  
|[COleControl::GetControlSize](#getcontrolsize)|傳回 OLE 控制項的大小與位置。|  
|[COleControl::GetDC](#getdc)|提供無視窗控制項從其容器中取得的裝置內容的方法。|  
|[COleControl::GetEnabled](#getenabled)|傳回存貨 Enabled 屬性的值。|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|擷取屬於容器的擴充的控制項物件的指標。|  
|[COleControl::GetFocus](#getfocus)|決定控制項是否有焦點。|  
|[COleControl::GetFont](#getfont)|傳回內建字型屬性值。|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|傳回的標準`CFontHolder`物件。|  
|[COleControl::GetForeColor](#getforecolor)|傳回內建的前景色彩屬性的值。|  
|[COleControl::GetHwnd](#gethwnd)|傳回內建的 hWnd 屬性的值。|  
|[COleControl::GetMessageString](#getmessagestring)|提供功能表項目中的狀態列文字。|  
|[Colecontrol:: Getnotsupported](#getnotsupported)|控制項的屬性值，使用者無法存取。|  
|[COleControl::GetReadyState](#getreadystate)|傳回控制項的整備狀態。|  
|[COleControl::GetRectInContainer](#getrectincontainer)|傳回相對於其容器的控制項的矩形。|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|傳回的標準的內建字型屬性。|  
|[COleControl::GetText](#gettext)|傳回內建的 Text 或 Caption 屬性值。|  
|[Colecontrol:: Getwindowlessdroptarget](#getwindowlessdroptarget)|覆寫，以允許無視窗控制項作為目標的拖曳和卸除作業。|  
|[COleControl::InitializeIIDs](#initializeiids)|通知與控制項將使用的 Iid 的基底類別。|  
|[COleControl::InternalGetFont](#internalgetfont)|傳回`CFontHolder`內建字型屬性的物件。|  
|[COleControl::InternalGetText](#internalgettext)|擷取內建的標題或文字屬性。|  
|[Colecontrol:: Internalsetreadystate](#internalsetreadystate)|設定控制項的整備狀態並引發已備妥狀態變更事件。|  
|[COleControl::InvalidateControl](#invalidatecontrol)|失效的區域顯示的控制項，讓它重新繪製。|  
|[COleControl::InvalidateRgn](#invalidatergn)|使給定區域內的容器視窗的工作區。 可用來進行無視窗控制項重繪區域中。|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|可讓 OLE 控制項的特製化的載入。|  
|[COleControl::IsModified](#ismodified)|判斷是否已變更的控制項狀態。|  
|[Colecontrol:: Isoptimizeddraw](#isoptimizeddraw)|指出容器是否支援目前的繪圖作業最佳化的繪圖。|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|呼叫以判斷是否控制項子類別的 Windows 控制。|  
|[COleControl::Load](#load)|重設任何先前非同步資料，並起始新載入控制項非同步屬性。|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|如果您的控制項可以停用容器的決定。|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|變更環境的屬性時呼叫。|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|內建的外觀屬性變更時呼叫。|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|內建的 BackColor 屬性變更時呼叫。|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|內建 BorderStyle 屬性變更時呼叫。|  
|[COleControl::OnClick](#onclick)|呼叫以引發內建 Click 事件。|  
|[COleControl::OnClose](#onclose)|通知控制項，`IOleControl::Close`已呼叫。|  
|[COleControl::OnDoVerb](#ondoverb)|執行控制動詞後呼叫。|  
|[COleControl::OnDraw](#ondraw)|當控制項被要求重繪其本身時呼叫。|  
|[Colecontrol:: Ondrawmetafile](#ondrawmetafile)|當控制項被要求重繪其本身使用中繼檔裝置內容時，由容器呼叫。|  
|[COleControl::OnEdit](#onedit)|由 UI 啟動容器呼叫 OLE 控制項。|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|股票 Enabled 屬性已變更時呼叫。|  
|[COleControl::OnEnumVerbs](#onenumverbs)|呼叫以列舉控制項的動詞命令的容器。|  
|[COleControl::OnEventAdvise](#oneventadvise)|當連接或中斷連接控制項中的事件處理常式時呼叫。|  
|[COleControl::OnFontChanged](#onfontchanged)|內建字型屬性變更時呼叫。|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|內建的前景色彩屬性變更時呼叫。|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|控制項的事件會凍結或解除凍結時呼叫。|  
|[COleControl::OnGetColorSet](#ongetcolorset)|通知控制項，`IOleObject::GetColorSet`已呼叫。|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|提供容器的助憶鍵資訊。|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|呼叫以取得一個字串，代表屬性值。|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|要求將會合併與 [容器] 功能表的控制項功能表中的控制代碼。|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|覆寫，以擷取最接近的建議的大小和範圍模式的控制項的顯示大小。|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|傳回代表屬性的可能值的字串。|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|傳回對應到預先定義的字串值。|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|覆寫，以擷取 （可以用來啟用兩次繪圖） 控制項的顯示區域的大小。|  
|[COleControl::OnGetViewRect](#ongetviewrect)|覆寫，以將控制項的大小轉換成起始於指定位置的矩形。|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|覆寫，以擷取控制項的檢視狀態。|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|由容器控制項的 UI 停用時呼叫。|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|將滑鼠指標分派在非使用中控制項的容器的覆寫`WM_MOUSEMOVE`訊息至控制項。|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|將滑鼠指標分派在非使用中控制項的容器的覆寫`WM_SETCURSOR`訊息至控制項。|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|已經引發內建 KeyDown 事件後呼叫。|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|已經引發內建 KeyPress 事件後呼叫。|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|已經引發內建 KeyUp 事件後呼叫。|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|表示用來編輯屬性的屬性頁。|  
|[COleControl::OnMnemonic](#onmnemonic)|已按下的控制項的助憶鍵時呼叫。|  
|[COleControl::OnProperties](#onproperties)|已叫用控制項的 「 屬性 」 動詞時呼叫。|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|控制項的顯示重疊的指定的點是否會覆寫查詢。|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|是否顯示控制項的重疊給定矩形的任何時間點，請覆寫查詢。|  
|[COleControl::OnRenderData](#onrenderdata)|由架構呼叫以擷取指定格式的資料。|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|由架構呼叫以擷取指定格式的檔案中的資料。|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|由架構呼叫以擷取指定格式的全域記憶體中的資料。|  
|[COleControl::OnResetState](#onresetstate)|將控制項的屬性重設為預設值。|  
|[Colecontrol:: Onsetclientsite](#onsetclientsite)|通知控制項，`IOleControl::SetClientSite`已呼叫。|  
|[COleControl::OnSetData](#onsetdata)|控制項的資料取代為另一個值。|  
|[COleControl::OnSetExtent](#onsetextent)|控制項的寬度變更後呼叫。|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|呼叫後已變更控制項的維度。|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|當控制項以 UI 啟動時呼叫。|  
|[COleControl::OnTextChanged](#ontextchanged)|內建文字或標題 屬性變更時呼叫。|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|無視窗控制項處理視窗訊息 （非滑鼠和鍵盤訊息）。|  
|[COleControl::ParentToClient](#parenttoclient)|將轉譯相對於容器的原點的點，相對於控制項的原點的點。|  
|[COleControl::PostModalDialog](#postmodaldialog)|告知容器已關閉強制回應對話方塊。|  
|[COleControl::PreModalDialog](#premodaldialog)|通知即將顯示強制回應對話方塊中的容器。|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|終結並重新建立控制項的視窗。|  
|[COleControl::Refresh](#refresh)|會強制重新繪製的控制項的外觀。|  
|[COleControl::ReleaseCapture](#releasecapture)|釋放滑鼠捕捉。|  
|[COleControl::ReleaseDC](#releasedc)|釋放容器的無視窗控制項的顯示裝置內容。|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|重設控制項視窗的父代。|  
|[COleControl::ResetStockProps](#resetstockprops)|初始化`COleControl`內建屬性設為預設值。|  
|[COleControl::ResetVersion](#resetversion)|初始化為指定值的版本號碼。|  
|[COleControl::ScrollWindow](#scrollwindow)|允許無視窗控制項來捲動區域，顯示其就地使用中映像內。|  
|[COleControl::SelectFontObject](#selectfontobject)|放入裝置內容中，選取自訂的字型屬性。|  
|[COleControl::SelectStockFont](#selectstockfont)|選取放入裝置內容的內建字型屬性。|  
|[COleControl::SerializeExtent](#serializeextent)|序列化或初始化控制項的顯示空間。|  
|[COleControl::SerializeStockProps](#serializestockprops)|序列化或初始化`COleControl`內建屬性。|  
|[COleControl::SerializeVersion](#serializeversion)|序列化或初始化控制項的版本資訊。|  
|[COleControl::SetAppearance](#setappearance)|設定的內建的外觀屬性的值。|  
|[COleControl::SetBackColor](#setbackcolor)|設定內建的 BackColor 屬性值。|  
|[COleControl::SetBorderStyle](#setborderstyle)|設定內建 BorderStyle 屬性值。|  
|[COleControl::SetCapture](#setcapture)|會使控制項的容器視窗控制項的代表採取擁有滑鼠捕捉。|  
|[COleControl::SetControlSize](#setcontrolsize)|設定位置與 OLE 控制項的大小。|  
|[COleControl::SetEnabled](#setenabled)|設定存貨 Enabled 屬性的值。|  
|[COleControl::SetFocus](#setfocus)|會使控制項的代表採取擁有輸入焦點的控制項的容器視窗。|  
|[COleControl::SetFont](#setfont)|設定內建字型屬性值。|  
|[COleControl::SetForeColor](#setforecolor)|設定的內建的前景色彩屬性的值。|  
|[COleControl::SetInitialSize](#setinitialsize)|設定 OLE 控制項的容器中第一次顯示時的大小。|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|變更控制項的已修改的狀態。|  
|[Colecontrol:: Setnotpermitted](#setnotpermitted)|表示編輯要求已失敗。|  
|[Colecontrol:: Setnotsupported](#setnotsupported)|防止使用者控制項的屬性值的修改。|  
|[COleControl::SetRectInContainer](#setrectincontainer)|設定相對於其容器的控制項的矩形。|  
|[COleControl::SetText](#settext)|設定內建的 Text 或 Caption 屬性值。|  
|[Colecontrol:: Throwerror](#throwerror)|OLE 控制項中發生錯誤的訊號。|  
|[COleControl::TransformCoords](#transformcoords)|轉換座標容器和控制項之間的值。|  
|[COleControl::TranslateColor](#translatecolor)|將轉換**OLE_COLOR**值設定為**COLORREF**值。|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|決定是否環境屬性可以使用下一次載入控制項。|  
|[COleControl::WindowProc](#windowproc)|提供的 Windows 處理程序`COleControl`物件。|  
  
### <a name="protected-methods"></a>受保護的方法  
  
|名稱|說明|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|當控制項的外觀需要更新時由架構呼叫。|  
|[COleControl::DrawMetafile](#drawmetafile)|使用中繼檔裝置內容時，由架構呼叫。|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|可讓 automation 方法引動過程。|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|由架構呼叫以初始化此控制項所支援的資料格式的清單。|  
  
## <a name="remarks"></a>備註  
 衍生自`CWnd`，此類別會繼承 Windows 視窗物件的所有功能，加上額外的功能特定至 OLE，例如事件引發以及支援的方法和屬性的能力。  
  
 OLE 控制項可以插入 OLE 容器應用程式，並使用雙向系統的事件引發並公開方法與屬性，以容器與容器通訊。 請注意標準 OLE 容器僅支援 OLE 控制項的基本功能。 它們是不支援 OLE 控制項擴充的功能。 當事件傳送至的容器控制項中發生特定動作的結果時，就會發生事件引發。 容器通訊搭配控制項使用的方法和屬性的成員函式類似公開的集和 c + + 類別的資料成員。 這個方法可讓開發人員控制控制項的外觀，並在發生特定動作時，通知容器。  
  
## <a name="windowless-controls"></a>無視窗控制項  
 OLE 控制項可以使用的就地啟用作用中沒有視窗。 無視窗控制項有明顯的優點︰  
  
-   無視窗控制項可以是透明及非矩形  
  
-   無視窗控制項減少之物件的執行個體大小和建立時間  
  
 控制項不需要的視窗。 視窗提供的服務可以輕鬆地提供透過單一的共用的視窗 （通常是容器的） 和分派的程式碼的位元。 讓視窗，通常不需要複雜物件上。  
  
 使用無視窗啟用時，容器 （其中具有視窗） 會負責提供服務，會提供控制項自己的視窗。 例如，如果您的控制項需要查詢鍵盤焦點、 查詢滑鼠擷取，或取得裝置內容，這些作業是由容器管理。 `COleControl`[無視窗作業的成員函式](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df)叫用這些容器上的作業。  
  
 啟用無視窗啟用時，容器委派輸入訊息到控制項的`IOleInPlaceObjectWindowless`介面 (副檔名為[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)無視窗的支援)。 `COleControl`適當調整滑鼠座標之後，這個介面的實作會分派透過控制項的訊息對應，這些訊息。 您可以將對應的項目新增至訊息對應處理一般視窗訊息，這些訊息。  
  
 在無視窗控制項中，您應該一律使用`COleControl`成員函式，而不要使用對應`CWnd`成員函式或其相關的 Windows API 函式。  
  
 它們變成作用中，但非作用中現用轉換所需的工作量向上及轉換的速度效能降低時，才 OLE 控制項物件也可以建立視窗。 一些情況下這是一個問題︰ 做為範例，請考慮之文字方塊的方格。 當上下對照指標透過資料行，每個控制項必須是就地啟用，並再停用。 非作用中/主動轉換的速度會直接影響捲動的速度。  
  
 如需有關開發 OLE 控制項架構的詳細資訊，請參閱文章[MFC ActiveX 控制項](../../mfc/mfc-activex-controls.md)和[概觀︰ 建立 MFC ActiveX 控制項程式](../../mfc/reference/mfc-activex-control-wizard.md)。 如需最佳化 OLE 控制項，包括無視窗和閃爍的控制項，請參閱[MFC ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>需求  
 **標頭︰** afxctl.h  
  
##  <a name="ambientbackcolor"></a>COleControl::AmbientBackColor  
 傳回環境 BackColor 屬性值。  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>傳回值  
 容器的環境背景色彩屬性，如果有任何目前的值。 如果不支援的屬性，此函數會傳回系統定莪 Windows 背景色彩。  
  
### <a name="remarks"></a>備註  
 環境背景色彩屬性使用的所有控制項，由容器所定義。 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientdisplayname"></a>COleControl::AmbientDisplayName  
 容器已指派給控制項的名稱可以用於向使用者顯示錯誤訊息。  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>傳回值  
 OLE 控制項的名稱。 預設為零長度字串。  
  
### <a name="remarks"></a>備註  
 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientfont"></a>COleControl::AmbientFont  
 傳回環境字型屬性值。  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>傳回值  
 容器的環境字型分派介面的指標。 預設值是**NULL**。 如果傳回值不等於**NULL**，您必須負責釋放字型藉由呼叫其[Iunknown](http://msdn.microsoft.com/library/windows/desktop/ms682317)成員函式。  
  
### <a name="remarks"></a>備註  
 環境字型屬性是容器所定義，並可供所有控制項。請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientforecolor"></a>COleControl::AmbientForeColor  
 傳回的環境前景色彩屬性的值。  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>傳回值  
 容器的環境前景色彩屬性，如果有任何目前的值。 如果不支援，此函數會傳回 Windows 系統定義的文字色彩。  
  
### <a name="remarks"></a>備註  
 環境的前景色彩屬性使用的所有控制項，由容器所定義。 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientlocaleid"></a>Colecontrol:: Ambientlocaleid  
 傳回容器的地區設定識別碼。  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>傳回值  
 容器的地區設定識別碼屬性，如果有任何值。 如果不支援這個屬性，這個函數會傳回 0。  
  
### <a name="remarks"></a>備註  
 控制項可以調整為特定地區設定其使用者介面使用地區設定識別碼。 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientappearance"></a>COleControl::AmbientAppearance  
 擷取目前的控制項物件的外觀設定。  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>傳回值  
 控制項的外觀︰  
  
- **0**一般外觀  
  
- **1** 3D 外觀  
  
### <a name="remarks"></a>備註  
 呼叫此函式可擷取的目前值**DISPID_AMBIENT_APPEARANCE**控制項的屬性。  
  
##  <a name="ambientscaleunits"></a>COleControl::AmbientScaleUnits  
 傳回容器所使用的單位的類型。  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>傳回值  
 字串，包含容器的環境 ScaleUnits。 如果不支援這個屬性，這個函數會傳回零長度字串。  
  
### <a name="remarks"></a>備註  
 容器的環境 ScaleUnits 屬性可以用來顯示位置或維度，加上所選的單位，例如 twip 還是以公分。 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientshowgrabhandles"></a>COleControl::AmbientShowGrabHandles  
 請判斷容器是否允許控制項本身現用時顯示抓取控點。  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果應該顯示抓取控點。否則便是 0。 如果不支援這個屬性，此函式會傳回非零值。  
  
### <a name="remarks"></a>備註  
 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientshowhatching"></a>COleControl::AmbientShowHatching  
 決定容器是否允許控制項來顯示本身具有影線圖樣時 UI 作用。  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果應該顯示影線的圖樣。否則便是 0。 如果不支援這個屬性，此函式會傳回非零值。  
  
### <a name="remarks"></a>備註  
 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambienttextalign"></a>COleControl::AmbientTextAlign  
 判斷慣用控制項容器的環境的文字對齊方式。  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>傳回值  
 容器的環境 TextAlign 屬性的狀態。 如果不支援這個屬性，這個函數會傳回 0。  
  
 以下是有效的傳回值的清單︰  
  
|傳回值|意義|  
|------------------|-------------|  
|0|一般的對齊方式 （靠右向左文字的數字）。|  
|1|靠左對齊|  
|2|置中|  
|3|靠右對齊|  
  
### <a name="remarks"></a>備註  
 此屬性可用於所有內嵌控制項，而且由容器所定義。 請注意，容器不需要可支援此屬性。  
  
##  <a name="ambientuidead"></a>COleControl::AmbientUIDead  
 請判斷容器是否想要回應使用者介面動作的控制項。  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果控制項應回應使用者介面動作;否則便是 0。 如果不支援這個屬性，這個函數會傳回 0。  
  
### <a name="remarks"></a>備註  
 例如，容器可能會將此設**TRUE**在設計模式。  
  
##  <a name="ambientusermode"></a>COleControl::AmbientUserMode  
 決定是否容器是在設計模式或使用者模式。  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果容器是以使用者模式;否則為 0 （在設計模式）。 如果不支援這個屬性，此函式會傳回 TRUE。  
  
### <a name="remarks"></a>備註  
 例如，容器可能會將此設**FALSE**在設計模式。  
  
##  <a name="boundpropertychanged"></a>COleControl::BoundPropertyChanged  
 繫結的屬性值已變更的訊號。  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項的繫結屬性的分派識別碼。  
  
### <a name="remarks"></a>備註  
 這必須在每次屬性變更，即使在不透過屬性進行變更的情況下的值設定方法呼叫。 請特別注意的繫結會對應至成員變數的屬性。 這類成員變數的變更，每當`BoundPropertyChanged`必須呼叫。  
  
##  <a name="boundpropertyrequestedit"></a>COleControl::BoundPropertyRequestEdit  
 要求的權限`IPropertyNotifySink`介面，以變更控制項所提供的繫結的屬性值。  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項的繫結屬性的分派識別碼。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果允許變更。否則便是 0。 預設值為非零值。  
  
### <a name="remarks"></a>備註  
 如果權限遭到拒絕，控制項必須讓屬性變更的值。 這可藉由忽略或失敗的嘗試要變更屬性值的動作。  
  
##  <a name="clienttoparent"></a>COleControl::ClientToParent  
 將轉譯的座標`pPoint`為父座標。  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>參數  
 `lprcBounds`  
 OLE 控制項容器內的範圍指標。 非工作區，但整個控制項包括框線和捲軸的區域。  
  
 `pPoint`  
 若要轉譯為父系 （容器） 的座標的 OLE 用戶端區域點的指標。  
  
### <a name="remarks"></a>備註  
 在輸入`pPoint`是相對於來源的 OLE 控制項 （用戶端區域控制項的左上角） 工作區。 在輸出`pPoint`是相對於來源的父代 （的容器左上角）。  
  
##  <a name="clipcaretrect"></a>COleControl::ClipCaretRect  
 如果它完全或部分涵蓋重疊的不透明物件，請調整插入號矩形。  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `lpRect`  
 在輸入的指標[RECT](../../mfc/reference/rect-structure1.md)結構，其中包含要調整的插入號區域。 在輸出時，已調整的插入號 區域中，或**NULL**如果插入號矩形完全覆蓋。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 插入號是閃爍的線條、 區塊或點陣圖，通常表示要插入的文字或圖形。  
  
 無視窗物件無法安全地顯示插入號，先檢查是否插入號部分或完全隱藏重疊物件。 若要使其成為可能的可以使用物件`ClipCaretRect`取得插入號調整 (reduced) 以確保它符合的裁剪區域。  
  
 建立插入號的物件應該提交的插入號矩形`ClipCaretRect`插入號以用於調整的矩形。 如果插入號完全隱藏的這個方法會傳回**FALSE**而且插入號應該不會顯示所有在此情況下。  
  
##  <a name="colecontrol"></a>COleControl::COleControl  
 建構 `COleControl` 物件。  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>備註  
 通常不會直接呼叫此函式。 改為 OLE 控制項通常會建立其 class factory。  
  
##  <a name="controlinfochanged"></a>COleControl::ControlInfoChanged  
 此控制項所支援的助憶鍵的集合變更時，請呼叫此函式。  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>備註  
 在收到此通知時，控制項的容器會取得一組新的助憶鍵藉由呼叫[IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730)。 請注意，容器並不需要回應此通知。  
  
##  <a name="displayerror"></a>COleControl::DisplayError  
 內建的錯誤事件已處理 （除非事件處理常式已隱藏的錯誤顯示） 之後，由架構呼叫。  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>參數  
 *scode*  
 要回報的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項︰ 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 正在報告錯誤的描述。  
  
 *lpszSource*  
 產生錯誤 （通常 OLE 控制項模組的名稱） 之模組的名稱。  
  
 `lpszHelpFile`  
 包含描述錯誤的說明檔的名稱。  
  
 `nHelpID`  
 說明內容識別碼所回報的錯誤。  
  
### <a name="remarks"></a>備註  
 預設行為顯示訊息方塊包含描述錯誤中包含的`lpszDescription`。  
  
 覆寫此函式可自訂錯誤的顯示方式。  
  
##  <a name="doclick"></a>COleControl::DoClick  
 模擬滑鼠按一下控制項上的動作。  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>備註  
 可覆寫`COleControl::OnClick`將呼叫成員函式，並內建 Click 事件將引發，如果此控制項所支援。  
  
 此函式會受到`COleControl`做為內建方法，稱為 DoClick 基底類別。 如需詳細資訊，請參閱文章[ActiveX 控制項︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="dopropexchange"></a>COleControl::DoPropExchange  
 載入或儲存控制項的永續性儲存體表示法，例如資料流或屬性的設定時，架構呼叫。  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>參數  
 `pPX`  
 指標`CPropExchange`物件。 架構會提供此物件來建立交換的內容屬性，包括其方向。  
  
### <a name="remarks"></a>備註  
 此函式通常會呼叫**PX_**系列的函式來載入或儲存 OLE 控制項的特定使用者定義的屬性。  
  
 如果控制項精靈已經用來建立 OLE 控制項的專案，此函式的覆寫的版本會序列化所支援的內建屬性`COleControl`基底類別函式呼叫`COleControl::DoPropExchange`。 當您新增到您的 OLE 控制項的使用者定義的屬性，您必須修改此函式可序列化新的屬性。 如需序列化的詳細資訊，請參閱文章[ActiveX 控制項︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="dosuperclasspaint"></a>COleControl::DoSuperclassPaint  
 重新繪製已子類別化 Windows 控制項從 OLE 控制項。  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 控制項容器的裝置內容的指標。  
  
 `rcBounds`  
 控制項為繪製區域。  
  
### <a name="remarks"></a>備註  
 呼叫此函式可正確處理非作用中的 OLE 控制項的繪製。 此函式應該只用於如果 OLE 控制子類別的 Windows 控制項，而且應該呼叫`OnDraw`控制項的函式。  
  
 如需有關這個函式和子類別化 Windows 控制項的詳細資訊，請參閱文章[ActiveX 控制項︰ 子類別化 Windows 控制項](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md)。  
  
##  <a name="drawcontent"></a>COleControl::DrawContent  
 當控制項的外觀需要更新時由架構呼叫。  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 裝置內容的指標。  
  
 `rc`  
 在中繪製的矩形區域。  
  
### <a name="remarks"></a>備註  
 此函式直接呼叫可覆寫`OnDraw`函式。  
  
##  <a name="drawmetafile"></a>COleControl::DrawMetafile  
 使用中繼檔裝置內容時，由架構呼叫。  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 中繼檔裝置內容的指標。  
  
 `rc`  
 在中繪製的矩形區域。  
  
##  <a name="enablesimpleframe"></a>COleControl::EnableSimpleFrame  
 可讓 OLE 控制項的簡單框架特性。  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>備註  
 這種特性可讓控制項以支援 visual 的內含項目，其他控制項，但不是正確的 OLE 內含項目。 範例會使用數個內控制項群組方塊。 這些控制項不是 OLE 所包含，但在相同群組中。  
  
##  <a name="exchangeextent"></a>COleControl::ExchangeExtent  
 序列化或初始化的狀態控制項的寬度 (在其維度**HIMETRIC**單位)。  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>參數  
 `pPX`  
 指標[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件。 架構會提供此物件來建立交換的內容屬性，包括其方向。  
  
### <a name="return-value"></a>傳回值  
 如果函式成功則為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 通常會呼叫此函式的預設實作`COleControl::DoPropExchange`。  
  
##  <a name="exchangestockprops"></a>COleControl::ExchangeStockProps  
 序列化或初始化控制項的內建屬性的狀態。  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>參數  
 `pPX`  
 指標[CPropExchange](../../mfc/reference/cpropexchange-class.md)物件。 架構會提供此物件來建立交換的內容屬性，包括其方向。  
  
### <a name="remarks"></a>備註  
 通常會呼叫此函式的預設實作`COleControl::DoPropExchange`。  
  
##  <a name="exchangeversion"></a>COleControl::ExchangeVersion  
 序列化或初始化控制項的版本資訊的狀態。  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `pPX`  
 指標`CPropExchange`物件。 架構會提供此物件來建立交換的內容屬性，包括其方向。  
  
 `dwVersionDefault`  
 控制項的目前版本號碼。  
  
 `bConvert`  
 表示持續性資料是否應該轉換成最新格式儲存，或保留在相同的格式，載入時。  
  
### <a name="return-value"></a>傳回值  
 函式成功則為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 一般來說，這會是第一個函式呼叫的控制項的覆寫`COleControl::DoPropExchange`。 載入時，此函式會讀取永續性資料的版本號碼，並設定目的 version 屬性[CPropExchange](../../mfc/reference/cpropexchange-class.md)據此物件。 儲存時，此函式會寫入持續性資料的版本號碼。  
  
 如需持續性和版本控制的詳細資訊，請參閱文章[ActiveX 控制項︰ 序列化](../../mfc/mfc-activex-controls-serializing.md)。  
  
##  <a name="fireclick"></a>COleControl::FireClick  
 作用中的控制項上按一下滑鼠時由架構呼叫。  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動進行的按一下事件的引發，控制項的事件對應必須有內建 Click 事件定義。  
  
##  <a name="firedblclick"></a>COleControl::FireDblClick  
 當使用中的控制項上按兩下滑鼠時由架構呼叫。  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動發生目的 DblClick 事件的引發，控制項的事件對應必須有定義的內建目的 DblClick 事件。  
  
##  <a name="fireerror"></a>Colecontrol:: Fireerror  
 引發內建的錯誤事件。  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>參數  
 *scode*  
 要回報的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項︰ 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `lpszDescription`  
 正在報告錯誤的描述。  
  
 `nHelpID`  
 正在報告的錯誤說明識別碼。  
  
### <a name="remarks"></a>備註  
 這個事件會提供一種訊號，已在控制項中發生錯誤，在您的程式碼中的適當位置。 不同於其他內建的事件，例如 Click 或 MouseMove，由架構永遠不會引發錯誤。  
  
 若要報告屬性 get 函式、 屬性集函式或 automation 方法期間發生錯誤，請呼叫[colecontrol:: Throwerror](#throwerror)。  
  
 OLE 控制項的內建錯誤事件使用的實作`SCODE`值。 如果您的控制項使用此事件，而且適用於 Visual Basic 4.0 中，您會收到錯誤，因為`SCODE`在 Visual Basic 中不支援值。  
  
 若要修正此問題，以手動方式變更`SCODE`中控制項的參數。ODL 檔案**長**。 此外，任何自訂事件、 方法或屬性，會使用`SCODE`參數也會導致相同的問題。  
  
##  <a name="fireevent"></a>COleControl::FireEvent  
 就會引發任何數目的選擇性引數，與您控制從使用者定義事件。  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 要引發的事件分派識別碼。  
  
 `pbParams`  
 事件的參數型別描述元。  
  
### <a name="remarks"></a>備註  
 通常不是直接呼叫此函式。 相反地，您將控制項的類別宣告的事件對應區段中呼叫事件引發函式。  
  
 `pbParams`引數是以空格分隔的清單**VTS_**。 其中的一或多個值 (以空格分隔，而非逗號) 會指定函式的參數清單。 可能的值如下：  
  
|符號|參數類型|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  所有的 variant 類型已定義其他的 variant 常數例外**VTS_FONT**和**VTS_PICTURE**，可提供 variant 資料常數指標。 這些常數會使用名為**VTS_P** `constantname`慣例。 例如， **VTS_PCOLOR**是指向**VTS_COLOR**常數。  
  
##  <a name="firekeydown"></a>COleControl::FireKeyDown  
 當控制項的 UI 使用中時按下按鍵時由架構呼叫。  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>參數  
 `pnChar`  
 按下的按鍵的虛擬按鍵碼值的指標。 標準虛擬按鍵碼的清單，請參閱 Winuser.h  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動發生 KeyDown 事件的引發，控制項的事件對應必須有定義的內建 KeyDown 事件。  
  
##  <a name="firekeypress"></a>COleControl::FireKeyPress  
 索引鍵是按下並釋放自訂控制項容器內處於作用中的 UI 時由架構呼叫。  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>參數  
 `pnChar`  
 按下按鍵的字元值的指標。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 事件的收件者可能會修改`pnChar`，例如，將所有小寫字元轉換成大寫。 如果您想要檢查的已修改的字元，會覆寫`OnKeyPressEvent`。  
  
 KeyPress 事件發生的自動引發，控制項的事件對應必須有定義的內建 KeyPress 事件。  
  
##  <a name="firekeyup"></a>COleControl::FireKeyUp  
 自訂控制項處於作用中的 UI 容器內，且放開按鍵時由架構呼叫。  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>參數  
 `pnChar`  
 發行的索引鍵的虛擬按鍵碼值的指標。 標準虛擬按鍵碼的清單，請參閱 Winuser.h  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動發生 KeyUp 事件的引發，控制項的事件對應必須有定義的內建 KeyUp 事件。  
  
##  <a name="firemousedown"></a>COleControl::FireMouseDown  
 作用中的自訂控制項上按下滑鼠按鈕時由架構呼叫。  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>參數  
 `nButton`  
 按下滑鼠按鈕的數字值。 它可以包含下列值之一︰  
  
- **LEFT_BUTTON**左邊的滑鼠按鈕已按下。  
  
- **MIDDLE_BUTTON**滑鼠按鈕已按下。  
  
- **RIGHT_BUTTON**滑鼠按鈕已按下。  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
 *x*  
 滑鼠按鈕已按下時資料指標的 x 座標。 座標是相對於控制項視窗的左上角。  
  
 *y*  
 滑鼠按鈕已按下時資料指標的 y 座標。 座標是相對於控制項視窗的左上角。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 MouseDown 事件發生的自動引發，控制項的事件對應必須有定義的內建 MouseDown 事件。  
  
##  <a name="firemousemove"></a>COleControl::FireMouseMove  
 將游標移至作用中的自訂控制項時，由架構呼叫。  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>參數  
 `nButton`  
 按下滑鼠按鈕的數字值。 包含下列值的組合︰  
  
- **LEFT_BUTTON**左邊的滑鼠按鈕已按下動作期間。  
  
- **MIDDLE_BUTTON**滑鼠按鈕已按下動作期間。  
  
- **RIGHT_BUTTON**滑鼠按鈕已按下動作期間。  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
 *x*  
 資料指標的 x 座標。 座標是相對於控制項視窗的左上角。  
  
 *y*  
 資料指標的 y 座標。 座標是相對於控制項視窗的左上角。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動發生 MouseMove 事件的引發，控制項的事件對應必須有定義的內建 MouseMove 事件。  
  
##  <a name="firemouseup"></a>COleControl::FireMouseUp  
 作用中的自訂控制項上放開滑鼠按鈕時由架構呼叫。  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>參數  
 `nButton`  
 放開滑鼠按鈕的數值。 它可以包含下列值之一︰  
  
- **LEFT_BUTTON**左邊的滑鼠按鈕已釋放。  
  
- **MIDDLE_BUTTON**滑鼠按鈕已釋放。  
  
- **RIGHT_BUTTON**滑鼠按鈕已釋放。  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
 *x*  
 當滑鼠按鈕已釋放時資料指標的 x 座標。 座標是相對於控制項視窗的左上角。  
  
 *y*  
 當滑鼠按鈕已釋放之資料指標的 y 座標。 座標是相對於控制項視窗的左上角。  
  
### <a name="remarks"></a>備註  
 如果此事件會定義為自訂的事件，您可以判斷在事件引發時。  
  
 自動發生 MouseUp 事件的引發，控制項的事件對應必須有定義的內建 MouseUp 事件。  
  
##  <a name="firereadystatechange"></a>COleControl::FireReadyStateChange  
 引發事件的目前值的控制項的就緒狀態。  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>備註  
 就緒狀態可以是下列值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 預設的初始化狀態  
  
 **READYSTATE_LOADING**  
 控制項目前正在載入其屬性  
  
 **READYSTATE_LOADED**  
 已初始化控制項  
  
 **READYSTATE_INTERACTIVE**  
 控制項擁有足夠的資料為互動式，但不是所有非同步資料尚未載入  
  
 `READYSTATE_COMPLETE`  
 控制項具有所有資料  
  
 使用[GetReadyState](#getreadystate)以判斷控制項的目前整備。  
  
 [InternalSetReadyState](#internalsetreadystate)就緒狀態變更為指定的值，則會呼叫`FireReadyStateChange`。  
  
##  <a name="getactivationpolicy"></a>COleControl::GetActivationPolicy  
 支援的控制項的預設啟動行為會改變`IPointerInactive`介面。  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>傳回值  
 從旗標的組合**POINTERINACTIVE**列舉型別。 可能的旗標如下︰  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 應該就地啟動當滑鼠進入它在滑鼠移動操作物件。  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 當滑鼠離開物件在滑鼠移動作業期間，應該停用物件。  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 物件應該是就地啟動期間拖曳滑鼠拖曳上方時，卸除作業。  
  
### <a name="remarks"></a>備註  
 當`IPointerInactive`介面已啟用，容器會將委派`WM_SETCURSOR`和`WM_MOUSEMOVE`給它的訊息。 `COleControl`適當調整滑鼠座標之後，這個介面的實作會分派透過控制項的訊息對應，這些訊息。  
  
 當容器接收`WM_SETCURSOR`或`WM_MOUSEMOVE`滑鼠指標置於非作用中物件的支援與訊息`IPointerInactive`，則它應該呼叫`GetActivationPolicy`介面與傳回旗標上**POINTERINACTIVE**列舉型別。  
  
 您可以將對應的項目新增至訊息對應處理這些訊息，就像一般視窗訊息一樣。 在您的處理常式，請避免使用`m_hWnd`成員變數 （或使用它的任何成員函式） 但未先檢查其值為 「 非**NULL**。  
  
 執行多個設定滑鼠游標和 （或） 引發滑鼠移動事件供任何物件，例如提供特殊的視覺化回饋，應傳回**POINTERINACTIVE_ACTIVATEONENTRY**旗標和繪製的意見反應，只有在使用中時。 容器物件會傳回這個旗標，如果應該立即將它在就地啟用，並再轉寄觸發呼叫相同訊息`GetActivationPolicy`。  
  
 如果兩個**POINTERINACTIVE_ACTIVATEONENTRY**和**POINTERINACTIVE_DEACTIVATEONLEAVE**傳回旗標，則滑鼠移到物件時，只會啟用物件。 如果只有**POINTERINACTIVE_ACTIVATEONENTRY**傳回旗標，則當滑鼠初次進入物件之後，只會啟用物件。  
  
 您也可以作為目標的 OLE 拖曳和卸除作業非現用控制項。 這需要在使用者拖曳物件時，啟動控制項，使控制項的視窗可以登錄為置放目標。 若要使啟用時，拖曳，傳回**POINTERINACTIVE_ACTIVATEONDRAG**旗標︰  
  
 [!code-cpp[NVC_MFCAxCtl # 1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 由傳送資訊`GetActivationPolicy`不會快取由容器。 相反地，每次滑鼠進入非作用中的物件，應該呼叫這個方法。  
  
 如果非作用中的物件不是就地啟動當滑鼠進入其要求，其容器應該分派後續`WM_SETCURSOR`藉由呼叫此物件的訊息[OnInactiveSetCursor](#oninactivesetcursor) ，只要將滑鼠指標停留在物件上。  
  
 啟用`IPointerInactive`介面通常表示您想要能夠隨時處理滑鼠訊息的控制項。 若要取得此行為，不支援的容器中`IPointerInactive`必須能夠自動啟動時顯示，而且控制項的介面，表示控制項應該具有**OLEMISC_ACTIVATEWHENVISIBLE**之間其他的旗標的旗標。 不過，若要避免這個旗標從生效的容器中，支援`IPointerInactive`，您也可以指定**OLEMISC_IGNOREACTIVATEWHENVISIBLE**旗標︰  
  
 [!code-cpp[NVC_MFCAxCtl # 10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>COleControl::GetAmbientProperty  
 取得容器的環境屬性的值。  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>參數  
 *dwDispid*  
 所需的環境屬性的分派識別碼。  
  
 `vtProp`  
 指定要傳回之值的類型的變數類型標記`pvProp`。  
  
 `pvProp`  
 將接收的屬性值或傳回值的變數的位址指標。 This 指標的實際型別必須符合所指定之類型`vtProp`。  
  
|vtProp|PvProp 的型別|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**短\***|  
|`VT_I4`|**長\***|  
|`VT_R4`|**浮點數\***|  
|`VT_R8`|**double\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>傳回值  
 支援環境的屬性; 如果為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 如果您使用`GetAmbientProperty`來擷取環境的 DisplayName 和 ScaleUnits 屬性，設定`vtProp`至`VT_BSTR`和`pvProp`至**CString\***。 如果您會擷取環境的字型屬性，設定`vtProp`至**VT_FONT**和`pvProp`至**LPFONTDISP\***。  
  
 請注意，函式已經提供的共用環境的屬性，例如[AmbientBackColor](#ambientbackcolor)和[AmbientFont](#ambientfont)。  
  
##  <a name="getappearance"></a>COleControl::GetAppearance  
 實作控制項的內建外觀屬性的 Get 函式。  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>傳回值  
 傳回值指定為目前的外觀設定**簡短**( `VT_I2`) 如果成功，則值。 如果控制項的外觀，而且一般 1 3D 控制項的外觀時，這個值會是零。  
  
##  <a name="getbackcolor"></a>COleControl::GetBackColor  
 實作控制項的內建的背景色彩屬性的 Get 函式。  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>傳回值  
 傳回值，指定與目前的背景色彩**OLE_COLOR**如果成功，則值。 這個值可以轉譯成**COLORREF**值呼叫`TranslateColor`。  
  
##  <a name="getborderstyle"></a>COleControl::GetBorderStyle  
 實作控制項的內建的框線樣式屬性的 Get 函式。  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>傳回值  
 如果控制項的標準框線;，1如果控制項的框線是 0。  
  
##  <a name="getcapture"></a>COleControl::GetCapture  
 決定是否`COleControl`物件具有滑鼠捕捉。  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>傳回值  
 如果啟用並無視窗控制項即會傳回**這**如果控制項目前的滑鼠捕捉 （如同取決於控制項的容器），或**NULL**如果並沒有擷取。  
  
 反之則傳回`CWnd`具有滑鼠擷取的物件 (與相同`CWnd::GetCapture`)。  
  
### <a name="remarks"></a>備註  
 已啟動的無視窗控制項接收滑鼠捕捉時[SetCapture](#setcapture)呼叫。  
  
##  <a name="getclassid"></a>COleControl::GetClassID  
 由架構呼叫以擷取 OLE 類別 ID 的控制項。  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>參數  
 *createtable*  
 指標位置的類別識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫不成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 通常由實作[IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex)。  
  
##  <a name="getclientoffset"></a>COleControl::GetClientOffset  
 擷取控制項的矩形區域的左上的角和其工作區的左上的角的差異。  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>參數  
 *pdxOffset*  
 OLE 控制項的工作區的水平位移的指標。  
  
 *pdyOffset*  
 OLE 控制項的工作區的垂直位移的指標。  
  
### <a name="remarks"></a>備註  
 OLE 控制項有其容器中的矩形區域。 控制項的用戶端區域是排除框線和捲軸的控制項區域。 所擷取的位移`GetClientOffset`是控制項的矩形區域的左上的角和其工作區的左上的角的差異。 如果您的控制項具有非工作項目以外的標準框線和捲軸，覆寫此成員函式，以指定的位移。  
  
##  <a name="getclientrect"></a>COleControl::GetClientRect  
 擷取控制項的工作區的大小。  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>參數  
 `lpRect`  
 指標`RECT`包含無視窗控制項的用戶端區域的維度結構，也就是控制項的大小減去視窗框線、 框架、 捲軸等。 `lpRect`參數表示控制項的用戶端矩形，不是它的位置的大小。  
  
##  <a name="getclientsite"></a>COleControl::GetClientSite  
 查詢的物件，其目前的用戶端站台容器中的指標。  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>傳回值  
 控制項的目前用戶端的站台在其容器中的指標。  
  
### <a name="remarks"></a>備註  
 傳回的指標指向的執行個體`IOleClientSite`。 `IOleClientSite`容器所實作的介面是物件的 檢視其內容的︰ 它所錨定在文件中取得其存放裝置、 使用者介面及其他資源。  
  
##  <a name="getcontrolflags"></a>Clippaintdc  
 擷取控制旗標設定。  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>傳回值  
 ControlFlags 列舉中的旗標 ORed 的組合︰  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>備註  
 根據預設，`GetControlFlags`傳回`fastBeginPaint | clipPaintDC`。  
  
 `fastBeginPaint`  
 如果設定，請使用 begin 小畫家函式量身訂做的 OLE 控制項[BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362)應用程式開發介面 （預設設定）。  
  
 `clipPaintDC`  
 如果沒有設定，會停用呼叫`IntersectClipRect`由`COleControl`取得速度優點。 如果您使用無視窗啟用，此旗標會有任何作用。  
  
 `pointerInactive`  
 如果設定，藉由啟用您的控制項為非作用中時提供滑鼠互動`COleControl`的實作`IPointerInactive`介面，預設會停用。  
  
 `noFlickerActivate`  
 如果設定，可減少額外繪製作業和視覺重繪。 當您的控制項繪製本身在非現用和現用狀態時使用。 如果您使用無視窗啟用，此旗標會有任何作用。  
  
 `windowlessActivate`  
 如果設定，指出您的控制項使用無視窗啟用。  
  
 `canOptimizeDraw`  
 如果設定，表示控制項將會執行最佳化的繪圖，如果容器支援它。  
  
 如需有關`GetControlFlags`和其他最佳化的 OLE 控制項，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="getcontrolsize"></a>COleControl::GetControlSize  
 擷取 OLE 控制項視窗的大小。  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>參數  
 *pcx*  
 指定控制項的寬度，單位為像素。  
  
 *pcy*  
 指定控制項的高度，單位為像素。  
  
### <a name="remarks"></a>備註  
 請注意，所有用於控制 windows 座標是相對於控制項的左上角。  
  
##  <a name="getdc"></a>COleControl::GetDC  
 從其容器提供無視窗物件取得螢幕 （或相容） 裝置內容。  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>參數  
 *lprcRect*  
 重繪，控制項的用戶端座標中要無視窗控制項之矩形的指標。 **NULL**表示完整的物件範圍。  
  
 `dwFlags`  
 裝置內容的繪圖屬性。 選項有︰  
  
- **OLEDC_NODRAW**表示物件不會使用裝置內容，以執行任何繪製但只取得顯示裝置的相關資訊。 容器應只需傳遞而不需進一步處理視窗的 DC。  
  
- **OLEDC_PAINTBKGND**容器繪製背景，再傳回 DC 的要求。 如果它為透明的背景區域重繪作業要求的 DC 物件應該使用這個旗標。  
  
- **OLEDC_OFFSCREEN**通知物件想要轉譯成幕後點陣圖，然後複製到螢幕的容器。 當它是執行繪圖作業會產生大量的重繪閃動物件應該使用這個旗標。 容器是免費或不接受此要求。 不過，如果未設定此旗標，容器必須交回螢幕上的 DC。 這可讓物件來執行直接螢幕作業，例如顯示選取範圍 (透過**XOR**作業)。  
  
### <a name="return-value"></a>傳回值  
 容器的顯示裝置內容的指標`CWnd`用戶端區域如果成功，否則傳回值就會是**NULL**。 顯示裝置內容可以用於後續的 GDI 函式，來繪製容器的視窗的工作區中。  
  
### <a name="remarks"></a>備註  
 [ReleaseDC](#releasedc)成員函式必須呼叫以繪製之後釋出內容。 當呼叫`GetDC`，物件會傳遞他們想要在自己的用戶端座標中繪製的矩形。 `GetDC`會轉譯這些容器工作區的座標。 物件不應該要求所要繪製矩形大於它自己的用戶端區域矩形，其大小可以擷取與[GetClientRect](#getclientrect)。 這可防止不小心繪圖中它們都不應該是物件。  
  
##  <a name="getenabled"></a>COleControl::GetEnabled  
 實作控制項的內建 Enabled 屬性的 Get 函式。  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>傳回值  
 如果控制項已啟用，則為非零否則便是 0。  
  
##  <a name="getextendedcontrol"></a>COleControl::GetExtendedControl  
 取得物件代表具有一組延伸的內容控制項的容器所維護的指標。  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>傳回值  
 容器的指標的延伸控制項物件。 如果沒有可用的物件，則值是**NULL**。  
  
 此物件可能會透過管理其`IDispatch`介面。 您也可以使用`QueryInterface`取得物件提供的其他可用的介面。 不過，此物件不是需要支援一組特定的介面。 請注意，依賴特定功能的容器的擴充的控制項物件限制任意的其他容器控制項的可攜性。  
  
### <a name="remarks"></a>備註  
 呼叫此函式的函式會負責釋放指標時完成的物件。 請注意，容器不需要支援此物件。  
  
##  <a name="getfocus"></a>COleControl::GetFocus  
 決定是否`COleControl`物件具有焦點。  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>傳回值  
 如果啟用並無視窗控制項即會傳回**這**如果控制項目前具有鍵盤焦點 （如同取決於控制項的容器），或**NULL**不具有焦點時。  
  
 反之則傳回`CWnd`具有焦點的物件 (與相同`CWnd::GetFocus`)。  
  
### <a name="remarks"></a>備註  
 已啟動的無視窗控制項取得焦點時[SetFocus](#setfocus)呼叫。  
  
##  <a name="getfont"></a>COleControl::GetFont  
 實作內建字型屬性的 Get 函式。  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>傳回值  
 控制項的內建字型屬性的字型分派介面指標。  
  
### <a name="remarks"></a>備註  
 請注意，呼叫端必須釋放完成時的物件。 在控制項實作，使用`InternalGetFont`存取控制項的內建字型物件。 如需有關如何使用您的控制項字型的詳細資訊，請參閱文章[ActiveX 控制項︰ 在 ActiveX 控制項中使用的字型](../../mfc/mfc-activex-controls-using-fonts.md)。  
  
##  <a name="getfonttextmetrics"></a>COleControl::GetFontTextMetrics  
 任何量值的文字度量`CFontHolder`控制項所擁有的物件。  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>參數  
 `lptm`  
 指標[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)結構。  
  
 `fontHolder`  
 若要參考[CFontHolder](../../mfc/reference/cfontholder-class.md)物件。  
  
### <a name="remarks"></a>備註  
 可以與選取這種字型[COleControl::SelectFontObject](#selectfontobject)函式。 `GetFontTextMetrics`將初始化`TEXTMETRIC`結構所指`lptm`有效的度量資訊`fontHolder`的字型，如果成功，或如果不成功，以零填入結構。 您應該使用此函式，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)何時繪製控制項的控制項，例如任何內嵌 OLE 物件，可能是因為需要本身呈現在中繼檔。  
  
 `TEXTMETRIC`結構的預設字型為重新整理時[SelectFontObject](#selectfontobject)呼叫函式。 您應該呼叫`GetFontTextMetrics`只有選取內建字型屬性，以確保它所提供的資訊有效之後。  
  
##  <a name="getforecolor"></a>COleControl::GetForeColor  
 實作內建的前景色彩屬性的 Get 函式。  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>傳回值  
 傳回值，指定與目前的前景色彩**OLE_COLOR**如果成功，則值。 這個值可以轉譯成[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)值呼叫`TranslateColor`。  
  
##  <a name="gethwnd"></a>COleControl::GetHwnd  
 實作內建的 hWnd 屬性的 Get 函式。  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>傳回值  
 OLE 控制項的視窗控制代碼，如果有的話。否則**NULL**。  
  
##  <a name="getmessagestring"></a>COleControl::GetMessageString  
 由架構呼叫以取得描述所識別的功能表項目的用途的簡短字串`nID`。  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 功能表項目 id。  
  
 `rMessage`  
 若要參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)透過將傳回的字串物件。  
  
### <a name="remarks"></a>備註  
 這可用來取得功能表項目反白顯示的狀態列中顯示的訊息。 預設實作會嘗試載入所識別的字串資源`nID`。  
  
##  <a name="getnotsupported"></a>Colecontrol:: Getnotsupported  
 控制項的屬性值，使用者無法存取。  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>備註  
 呼叫此函式取代任何屬性的 Get 函式不支援擷取控制項的使用者屬性的位置。 一個範例是唯寫屬性。  
  
##  <a name="getreadystate"></a>COleControl::GetReadyState  
 傳回控制項的整備狀態。  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>傳回值  
 整備狀態為 控制項，下列值之一︰  
  
 **READYSTATE_UNINITIALIZED**  
 預設的初始化狀態  
  
 **READYSTATE_LOADING**  
 控制項目前正在載入其屬性  
  
 **READYSTATE_LOADED**  
 已初始化控制項  
  
 **READYSTATE_INTERACTIVE**  
 控制項擁有足夠的資料為互動式，但不是所有非同步資料尚未載入  
  
 `READYSTATE_COMPLETE`  
 控制項具有所有資料  
  
### <a name="remarks"></a>備註  
 大多數的簡單控制項永遠都不需要區分**LOADED**和`INTERACTIVE`。 不過，支援的資料路徑屬性的控制項可能無法將會互動，直到至少部分的資料以非同步方式接收。 控制項應該嘗試盡成為互動式。  
  
##  <a name="getrectincontainer"></a>COleControl::GetRectInContainer  
 取得相對於容器，以裝置的單位表示控制項的矩形座標。  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `lpRect`  
 控制項的座標複製矩形結構的指標。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果控制項是就地啟用作用中。否則便是 0。  
  
### <a name="remarks"></a>備註  
 矩形才有效，如果控制項是就地啟用作用中。  
  
##  <a name="getstocktextmetrics"></a>COleControl::GetStockTextMetrics  
 控制項的內建字型屬性，可以使用選取的文字度量會測量[SelectStockFont](#selectstockfont)函式。  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>參數  
 `lptm`  
 指標[TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132)結構。  
  
### <a name="remarks"></a>備註  
 `GetStockTextMetrics`函式會初始化`TEXTMETRIC`結構所指`lptm`有效的度量資訊，如果成功，或填入零，如果不成功的結構。 使用此函式，而不是[GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941)何時繪製控制項的控制項，例如任何內嵌 OLE 物件，可能是因為需要本身呈現在中繼檔。  
  
 `TEXTMETRIC`結構的預設字型為重新整理時`SelectStockFont`呼叫函式。 只有選取內建的字型，才能確保它所提供的資訊有效之後，您應該呼叫此函式。  
  
##  <a name="gettext"></a>COleControl::GetText  
 實作內建的 Text 或 Caption 屬性的 Get 函式。  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>傳回值  
 控制文字字串或零長度字串，如果字串不存在於目前的值。  
  
> [!NOTE]
>  如需有關`BSTR`資料類型，請參閱[資料型別](../../mfc/reference/data-types-mfc.md)巨集和全域一節。  
  
### <a name="remarks"></a>備註  
 請注意，呼叫此函式的呼叫端必須`SysFreeString`字串傳回以免費資源。 在控制項實作，使用`InternalGetText`存取控制項的內建的 Text 或 Caption 屬性。  
  
##  <a name="getwindowlessdroptarget"></a>Colecontrol:: Getwindowlessdroptarget  
 覆寫`GetWindowlessDropTarget`當您想將無視窗控制項作為目標的 OLE 拖放作業。  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>傳回值  
 物件的指標`IDropTarget`介面。 由於它並沒有視窗，無視窗物件無法註冊`IDropTarget`介面。 不過，若要參與拖曳和卸除，無視窗物件仍可以實作介面及傳回在`GetWindowlessDropTarget`。  
  
### <a name="remarks"></a>備註  
 通常這會需要將控制項的視窗登錄為置放目標。 但由於控制項沒有自己的視窗，容器會使用自己的視窗做為置放目標。 在控制項只需要提供的實作`IDropTarget`介面的容器可以委派會呼叫適當的時間。 例如:   
  
 [!code-cpp[NVC_MFCAxCtl # 2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>COleControl::InitializeIIDs  
 通知與控制項將使用的 Iid 的基底類別。  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>參數  
 *piidPrimary*  
 控制項的主要分派介面的介面 ID 的指標。  
  
 *piidEvents*  
 控制項的事件介面的介面 ID 的指標。  
  
### <a name="remarks"></a>備註  
 控制項的建構函式以通知的介面識別碼將會使用您的控制項的基底類別中呼叫此函式。  
  
##  <a name="internalgetfont"></a>COleControl::InternalGetFont  
 存取控制項的內建字型屬性  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>傳回值  
 若要參考[CFontHolder](../../mfc/reference/cfontholder-class.md)物件，其中包含內建字型物件。  
  
##  <a name="internalgettext"></a>COleControl::InternalGetText  
 存取控制項的內建的 Text 或 Caption 屬性。  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>傳回值  
 控制項的文字字串的參考。  
  
##  <a name="internalsetreadystate"></a>Colecontrol:: Internalsetreadystate  
 設定控制項的整備狀態。  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>參數  
 *lNewReadyState*  
 要設定下列值之一的控制項的整備狀態︰  
  
 **READYSTATE_UNINITIALIZED**  
 預設的初始化狀態  
  
 **READYSTATE_LOADING**  
 控制項目前正在載入其屬性  
  
 **READYSTATE_LOADED**  
 已初始化控制項  
  
 **READYSTATE_INTERACTIVE**  
 控制項擁有足夠的資料為互動式，但不是所有非同步資料尚未載入  
  
 `READYSTATE_COMPLETE`  
 控制項具有所有資料  
  
### <a name="remarks"></a>備註  
 大多數的簡單控制項永遠都不需要區分**LOADED**和`INTERACTIVE`。 不過，支援的資料路徑屬性的控制項可能無法將會互動，直到至少部分的資料以非同步方式接收。 控制項應該嘗試盡成為互動式。  
  
##  <a name="invalidatecontrol"></a>COleControl::InvalidateControl  
 強制控制項將重繪其本身。  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `lpRect`  
 控制項是即將失效的區域指標。  
  
 `bErase`  
 指定是否要處理的更新區域時清除內更新區域背景。  
  
### <a name="remarks"></a>備註  
 如果`lpRect`具有**NULL**值，將會重新繪製整個控制項。 如果`lpRect`不**NULL**，這表示控制項的矩形失效的一部分。 控制項沒有視窗中，或不在目前作用中，矩形會被忽略，而且呼叫用戶端站台的[IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337)成員函式。 使用此函式，而不是`CWnd::InvalidateRect`或`InvalidateRect`。  
  
##  <a name="invalidatergn"></a>COleControl::InvalidateRgn  
 使給定區域內的容器視窗的工作區。  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `pRgn`  
 指標[CRgn](../../mfc/reference/crgn-class.md)物件，可識別要使其失效，以包含視窗的工作區座標的 OLE 物件的顯示區域。 如果這個參數是**NULL**，範圍是整個物件。  
  
 `bErase`  
 指定是否要清除失效的區域內的背景。 如果**TRUE**，背景會被清除。 如果**FALSE**，背景會維持不變。  
  
### <a name="remarks"></a>備註  
 這可用來進行重繪容器內的無視窗控制項。 失效的區域，以及所有的其他區域中更新區域中，標示為進行繪製時的下一步 [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213)傳送訊息。  
  
 如果`bErase`是**TRUE**更新區域的任何部分，在整個區域中，不只是在特定的組件，背景會被清除。  
  
##  <a name="isconvertingvbx"></a>COleControl::IsConvertingVBX  
 可讓 OLE 控制項的特製化的載入。  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果控制項正在轉換。否則便是 0。  
  
### <a name="remarks"></a>備註  
 當轉換使用 VBX 的表單控制項以使用 OLE 控制項的其中一個時，則可能需要特殊載入的 OLE 控制項的程式碼。 例如，如果您正在載入您的 OLE 控制項的執行個體，您可能必須呼叫[PX_Font](persistence-of-ole-controls.md#px_font)中您`DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl # 3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 不過，VBX 控制項沒有 Font 物件。已個別儲存每個字型屬性。 在此情況下，您會使用`IsConvertingVBX`區別這兩種情況︰  
  
 [!code-cpp[NVC_MFCAxCtl # 4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 另一種情況是如果 VBX 控制項儲存專屬的二進位資料 (在其**VBM_SAVEPROPERTY**訊息處理常式)，您的 OLE 控制項資料並儲存其二進位格式不同。 如果您想要您的 OLE 控制項回溯相容 VBX 控制項，您可以閱讀這兩種舊的和新格式使用`IsConvertingVBX`函式，以利是否正在載入 VBX 控制項或 OLE 控制項。  
  
 在控制項的`DoPropExchange`函式，您可以檢查這個條件，並為 true，如果執行這項轉換 （例如先前範例中） 的特定程式碼載入。 如果控制項不會進行轉換，您可以執行一般的載入程式碼。 這項功能僅適用於 VBX 對應項目要轉換的控制項。  
  
##  <a name="isinvokeallowed"></a>COleControl::IsInvokeAllowed  
 可讓 automation 方法引動過程。  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果已初始化控制項。否則便是 0。  
  
### <a name="remarks"></a>備註  
 架構的實作**idispatch:: Invoke**呼叫**IsInvokeAllowed**判斷指定的函式 (由`dispid`) 可能會叫用。 OLE 控制項的預設行為是讓自動化方法，以初始化的控制項; 時，才會叫用不過， **IsInvokeAllowed**是虛擬函式，而且可能會覆寫必要 （例如，當為 automation 伺服器使用的控制項）。 如需詳細資訊，請參閱知識庫文章 Q166472，"如何︰ 使用 OLE 控制項為 Automation 伺服器。 」 知識庫文件位於[http://support.microsoft.com](http://support.microsoft.com/)。  
  
##  <a name="ismodified"></a>COleControl::IsModified  
 決定是否已修改控制項的狀態。  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>傳回值  
 為非零，如果自上次儲存; 後修改控制項的狀態否則便是 0。  
  
### <a name="remarks"></a>備註  
 屬性值變更時，會修改控制項的狀態。  
  
##  <a name="isoptimizeddraw"></a>Colecontrol:: Isoptimizeddraw  
 判斷容器是否支援目前的繪圖作業最佳化的繪圖。  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>傳回值  
 **TRUE**如果容器支援最佳化繪製目前的繪圖作業; 否則為**FALSE**。  
  
### <a name="remarks"></a>備註  
 如果支援最佳化的繪圖，然後控制項需要選取舊的畫筆、 筆刷、 字型 （等） 的物件放入裝置內容完成繪圖。  
  
##  <a name="issubclassedcontrol"></a>COleControl::IsSubclassedControl  
 由架構呼叫以判斷是否控制項子類別的 Windows 控制。  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>傳回值  
 如果控制項子類別化; 非零，否則便是 0。  
  
### <a name="remarks"></a>備註  
 您必須覆寫這個函式，並傳回**TRUE**如果您的 OLE 控制項的子類別的 Windows 控制項。  
  
##  <a name="load"></a>COleControl::Load  
 重設所有先前的資料，以非同步方式載入，並開始新載入控制項非同步屬性。  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>參數  
 *strNewPath*  
 含有參考非同步控制項屬性的絕對位置路徑的字串指標。  
  
 *p o p*  
 A [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md)實作非同步控制項屬性的物件。  
  
##  <a name="lockinplaceactive"></a>COleControl::LockInPlaceActive  
 容器可防止停用您的控制項。  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>參數  
 `bLock`  
 **TRUE**就地作用中狀態的控制項是否被鎖定。**FALSE**是否要解除鎖定。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果鎖定成功。否則便是 0。  
  
### <a name="remarks"></a>備註  
 請注意，每個控制項的鎖定必須搭配控制項完成後解除鎖定。 您應該只鎖定您的控制項短，例如時引發事件。  
  
##  <a name="onambientpropertychange"></a>COleControl::OnAmbientPropertyChange  
 當容器的環境屬性值變更時由架構呼叫。  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>參數  
 *dispID*  
 變更，環境屬性的分派識別碼或**DISPID_UNKNOWN**如果多個屬性已變更。  
  
##  <a name="onappearancechanged"></a>COleControl::OnAppearanceChanged  
 內建的外觀屬性值變更時由架構呼叫。  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>備註  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。 預設實作會呼叫`InvalidateControl`。  
  
##  <a name="onbackcolorchanged"></a>COleControl::OnBackColorChanged  
 內建的 BackColor 屬性值變更時由架構呼叫。  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>備註  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。 預設實作會呼叫`InvalidateControl`。  
  
##  <a name="onborderstylechanged"></a>COleControl::OnBorderStyleChanged  
 內建 BorderStyle 屬性值變更時由架構呼叫。  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫`InvalidateControl`。  
  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。  
  
##  <a name="onclick"></a>COleControl::OnClick  
 在按一下滑鼠按鈕，或已叫用 DoClick 內建方法時，由架構呼叫。  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>參數  
 *iButton*  
 滑鼠按鍵的索引。 可以有下列值之一︰  
  
- **LEFT_BUTTON**已按下滑鼠左的按鈕。  
  
- **MIDDLE_BUTTON**已按下滑鼠中間鍵。  
  
- **RIGHT_BUTTON**已按下滑鼠右按鈕。  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫`COleControl::FireClick`。  
  
 覆寫來修改或擴充的預設處理此成員函式。  
  
##  <a name="onclose"></a>COleControl::OnClose  
 容器控制項的呼叫時由架構呼叫**iolecontrol:: Close**函式。  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>參數  
 `dwSaveOption`  
 旗標，指出是否應該在載入之前儲存物件。 有效值為：  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>備註  
 根據預設，`OnClose`儲存控制項物件，如果已修改和`dwSaveOption`是`OLECLOSE_SAVEIFDIRTY`或`OLECLOSE_PROMPTSAVE`。  
  
##  <a name="ondoverb"></a>COleControl::OnDoVerb  
 當容器呼叫時由架構呼叫**IOleObject::DoVerb**成員函式。  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `iVerb`  
 要叫用該控制動詞索引。  
  
 `lpMsg`  
 因為要叫用動詞命令的 Windows 訊息指標。  
  
 `hWndParent`  
 控制項的父視窗控制代碼。 如果指令動詞的執行會建立一個視窗 （或 windows）`hWndParent`應該做為父代。  
  
 `lpRect`  
 將複製的控制項，相對於容器座標 RECT 結構的指標。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 預設實作會使用`ON_OLEVERB`和`ON_STDOLEVERB`訊息對應項目，來決定要叫用適當的函式。  
  
 若要變更動詞命令的預設處理此函式會覆寫。  
  
##  <a name="ondraw"></a>COleControl::OnDraw  
 由架構呼叫以繪製指定的週框矩形，使用指定的裝置內容中的 OLE 控制項。  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 繪圖發生在哪個裝置內容。  
  
 `rcBounds`  
 控制項，包括框線的矩形區域。  
  
 `rcInvalid`  
 無效的控制項矩形區域。  
  
### <a name="remarks"></a>備註  
 `OnDraw`通常會呼叫傳遞做為螢幕裝置內容的螢幕上的`pDC`。 `rcBounds`參數會識別 （相對於其目前的對應模式） 的目標裝置內容中的矩形。 `rcInvalid`參數是無效的實際矩形。 在某些情況下，這會是較小的區域，比`rcBounds`。  
  
##  <a name="ondrawmetafile"></a>Colecontrol:: Ondrawmetafile  
 由架構呼叫以繪製指定的週框矩形，使用指定的中繼檔裝置內容中的 OLE 控制項。  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 繪圖發生在哪個裝置內容。  
  
 `rcBounds`  
 控制項，包括框線的矩形區域。  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫[OnDraw](#ondraw)函式。  
  
##  <a name="onedit"></a>COleControl::OnEdit  
 使控制項由 UI 啟動。  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `lpMsg`  
 叫用動詞命令的 Windows 訊息指標。  
  
 `hWndParent`  
 控制項的父視窗控制代碼。  
  
 `lpRect`  
 矩形容器中控制項所使用的指標。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 這會有相同的效果與叫用控制項的`OLEIVERB_UIACTIVATE`動詞命令。  
  
 此函式通常會用為處理常式函式`ON_OLEVERB`訊息對應項目。 這讓"Edit"動詞命令功能表中控制項的 「 物件 」。 例如:   
  
 [!code-cpp[NVC_MFCAxCtl # 5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>COleControl::OnEnabledChanged  
 當股票 Enabled 屬性值變更時由架構呼叫。  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>備註  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。 預設實作會呼叫[InvalidateControl](#invalidatecontrol)。  
  
##  <a name="onenumverbs"></a>COleControl::OnEnumVerbs  
 當容器呼叫時由架構呼叫**IOleObject::EnumVerbs**成員函式。  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>參數  
 `ppenumOleVerb`  
 指標**IEnumOLEVERB**列舉控制項的動詞命令的物件。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果動詞命令可用。否則便是 0。  
  
### <a name="remarks"></a>備註  
 預設實作會列舉`ON_OLEVERB`訊息對應中的項目。  
  
 覆寫此函式可變更列舉動詞命令的預設方式。  
  
##  <a name="oneventadvise"></a>COleControl::OnEventAdvise  
 連接或中斷連線的 OLE 控制項的事件處理常式時由架構呼叫。  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>參數  
 `bAdvise`  
 **TRUE**表示事件處理常式已連接到控制項。 **FALSE**表示事件處理常式具有已中斷連接控制項。  
  
##  <a name="onfontchanged"></a>COleControl::OnFontChanged  
 內建字型屬性值變更時由架構呼叫。  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫`COleControl::InvalidateControl`。 如果控制項子類別化 Windows 控制項，也會傳送的預設實作**WM_SETFONT**控制項的視窗訊息。  
  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFCAxCtl # 6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>COleControl::OnForeColorChanged  
 內建的前景色彩屬性值變更時由架構呼叫。  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫`InvalidateControl`。  
  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。  
  
##  <a name="onfreezeevents"></a>COleControl::OnFreezeEvents  
 容器呼叫之後，由架構呼叫**iolecontrol:: Freezeevents**。  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>參數  
 `bFreeze`  
 **TRUE**如果控制項的事件處理已凍結，否則**FALSE**。  
  
### <a name="remarks"></a>備註  
 預設實作不做任何動作。  
  
 如果您要其他的行為，當您凍結或解除凍結事件處理時，覆寫這個函式。  
  
##  <a name="ongetcolorset"></a>COleControl::OnGetColorSet  
 當容器呼叫時由架構呼叫**IViewObject::GetColorSet**成員函式。  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>參數  
 `ptd`  
 指向以轉譯圖片的目標裝置。 如果此值為**NULL**，圖片應該呈現為預設目標裝置，通常是顯示裝置。  
  
 `hicTargetDev`  
 指定所指定的目標裝置上的資訊內容`ptd`。 這個參數可以是裝置內容，但是不一定。 If `ptd` is **NULL**, `hicTargetDev` should also be **NULL**.  
  
 *ppColorSet*  
 色彩，會使用一組應該複製到其中的位置指標。 如果函式不會傳回的色彩設定中， **NULL**傳回。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果傳回有效的色彩集。否則便是 0。  
  
### <a name="remarks"></a>備註  
 容器會呼叫此函式可取得繪製 OLE 控制項所需的所有色彩。 容器可以使用取得搭配需要設定整體色彩調色盤的色彩的色彩集。 預設實作會傳回**FALSE**。  
  
 覆寫這個函式來執行這項要求的任何特殊處理。  
  
##  <a name="ongetcontrolinfo"></a>COleControl::OnGetControlInfo  
 當控制項的容器要求控制項的相關資訊，由架構呼叫。  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>參數  
 `pControlInfo`  
 指標[檓 CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734)要填入結構。  
  
### <a name="remarks"></a>備註  
 這項資訊主要是包含控制項的助憶鍵的描述。 預設實作會填入`pControlInfo`預設資訊。  
  
 如果控制項需要處理助憶鍵，請覆寫這個函式。  
  
##  <a name="ongetdisplaystring"></a>COleControl::OnGetDisplayString  
 由架構呼叫以取得字串，代表所識別之屬性的目前值`dispid`。  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項屬性的分派識別碼。  
  
 `strValue`  
 若要參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)透過將傳回的字串物件。  
  
### <a name="return-value"></a>傳回值  
 如果字串中傳回非零， *strValue;* ，否則為 0。  
  
### <a name="remarks"></a>備註  
 如果您的控制項具有的屬性，其值無法直接轉換為字串，而且您想要在容器提供屬性瀏覽器中顯示屬性的值會覆寫這個函式。  
  
##  <a name="ongetinplacemenu"></a>COleControl::OnGetInPlaceMenu  
 當控制項的 UI 以取得合併到現有的容器的功能表的功能表啟動時由架構呼叫。  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>傳回值  
 控制項的功能表的控制代碼或**NULL**控制項有無。 預設實作會傳回**NULL**。  
  
### <a name="remarks"></a>備註  
 如需有關合併 OLE 資源的詳細資訊，請參閱文章[功能表和資源 (OLE)](../../mfc/menus-and-resources-ole.md)。  
  
##  <a name="ongetnaturalextent"></a>COleControl::OnGetNaturalExtent  
 為了回應容器的架構呼叫**IViewObjectEx::GetNaturalExtent**要求。  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>參數  
 `dwAspect`  
 指定物件要進行表示的方式。 表示包含內容、 圖示、 縮圖或列印文件。 有效的值取自列舉[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *lindex*  
 物件，為感興趣的部分。 目前只有-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)結構定義傳回的物件大小的目標裝置。  
  
 `hicTargetDev`  
 指定所指定的目標裝置的資訊內容`ptd`參數物件可以從中擷取裝置度量資訊，並測試裝置的功能。 如果`ptd`是**NULL**，該物件應該忽略中的值`hicTargetDev`參數。  
  
 *pExtentInfo*  
 指向**DVEXTENTINFO**結構，指定調整大小資料。 **DVEXTENTINFO**結構是︰  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 結構成員`dwExtentMode`可以採用兩個值的其中一個︰  
  
- **DVEXTENT_CONTENT**詢問有多大的控制項應該是以完全符合內容 （嵌入式管理單元的大小）  
  
- **DVEXTENT_INTEGRAL**調整大小時，將建議的大小傳遞至控制項  
  
 `psizel`  
 若要調整大小的控制項所傳回的資料點。 傳回的調整大小資料設定為-1 代表不進行調整任何維度。  
  
### <a name="return-value"></a>傳回值  
 如果成功傳回，或調整大小; 非零，否則便是 0。  
  
### <a name="remarks"></a>備註  
 覆寫此函式可傳回建議的大小和範圍模式中最接近物件的顯示大小**DVEXTENTINFO**結構。 預設實作會傳回**FALSE** ，並讓沒有進行調整的大小。  
  
##  <a name="ongetpredefinedstrings"></a>COleControl::OnGetPredefinedStrings  
 由架構呼叫以取得一組預先定義的字串，代表屬性的可能值。  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項屬性的分派識別碼。  
  
 `pStringArray`  
 字串陣列，以填滿中傳回的值。  
  
 `pCookieArray`  
 A`DWORD`要傳回的值填入陣列。  
  
### <a name="return-value"></a>傳回值  
 如果項目已加入為非零`pStringArray`和`pCookieArray`。  
  
### <a name="remarks"></a>備註  
 如果您的控制項具有一組可以表示為字串的可能值的屬性，請覆寫這個函式。 每個項目加入至`pStringArray`，您應該加入至對應的"cookie"項目*pCookieArray。* 這些"cookie"值稍後將傳遞至架構`COleControl::OnGetPredefinedValue`函式。  
  
##  <a name="ongetpredefinedvalue"></a>COleControl::OnGetPredefinedValue  
 由架構呼叫以取得對應至其中一個預先定義的覆寫先前傳回的字串值`COleControl::OnGetPredefinedStrings`。  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項屬性的分派識別碼。  
  
 `dwCookie`  
 覆寫先前傳回的 cookie 值`COleControl::OnGetPredefinedStrings`。  
  
 `lpvarOut`  
 指標**VARIANT**結構透過將傳回的屬性值。  
  
### <a name="return-value"></a>傳回值  
 如果有傳回值，則為非零`lpvarOut`; 否則為 0。  
  
##  <a name="ongetviewextent"></a>COleControl::OnGetViewExtent  
 為了回應容器的架構呼叫[IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032)要求。  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>參數  
 *dwDrawAspect*  
 `DWORD`描述哪些表單或外觀時，物件就是會顯示。 有效的值取自列舉[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 *lindex*  
 物件，為感興趣的部分。 目前只有-1 是有效的。  
  
 `ptd`  
 指向[DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613)結構定義傳回的物件大小的目標裝置。  
  
 *lpsizel*  
 要傳回的物件大小之位置的位置點。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果成功傳回範圍資訊。否則便是 0。  
  
### <a name="remarks"></a>備註  
 如果您的控制項使用兩段式繪圖，且其不透明和透明組件具有不同維度，請覆寫這個函式。  
  
##  <a name="ongetviewrect"></a>COleControl::OnGetViewRect  
 為了回應容器的架構呼叫**IViewObjectEx::GetRect**要求。  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>參數  
 `dwAspect`  
 `DWORD`描述哪些表單或外觀時，物件就是會顯示。 有效的值取自列舉[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**:  
  
- `DVASPECT_CONTENT`將整個物件的週框。 在物件的來源和大小等於傳回的程度的左上角**GetViewExtent***。*  
  
- **DVASPECT_OPAQUE**與矩形的不透明區域的物件傳回的矩形。 其他失敗。  
  
- **DVASPECT_TRANSPARENT**涵蓋所有的時間緊迫或透明部分的矩形。  
  
 `pRect`  
 指向[RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907)結構，指定應該在其中繪製物件的矩形。 此參數控制的定位和延伸的物件。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果成功傳回物件大小的矩形。否則便是 0。  
  
### <a name="remarks"></a>備註  
 物件的大小由轉換`OnGetViewRect`到特定位置 （預設值是顯示畫面的左上的角） 開始的矩形。 如果您的控制項使用兩段式繪圖，且其不透明和透明組件具有不同維度，請覆寫這個函式。  
  
##  <a name="ongetviewstatus"></a>COleControl::OnGetViewStatus  
 為了回應容器的架構呼叫**IViewObjectEx::GetViewStatus**要求。  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>傳回值  
 其中一個值的**forced VIEWSTATUS**列舉型別，如果成功，則為，否則為 0。 值可以是下列任何組合︰  
  
 **VIEWSTATUS_OPAQUE**  
 物件是完全不透明的。 如果未設定此位元，物件會包含透明的組件。 此位元只適用於內容相關的層面和不`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_SOLIDBKGND**  
 物件有透明背景 （由純色，筆刷模式組成）。 此位元是有意義才**VIEWSTATUS_OPAQUE**設定而且僅適用於內容相關的層面和不`DVASPECT_ICON`或`DVASPECT_DOCPRINT`。  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 物件支援**DVASPECT_OPAQUE**。 所有**IViewObjectEx**採用繪圖的外觀，如參數也可以呼叫這方面的方法。  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 物件支援**DVASPECT_TRANSPARENT**。 所有**IViewObjectEx**採用繪圖的外觀，如參數也可以呼叫這方面的方法。  
  
### <a name="remarks"></a>備註  
 如果您的控制項使用兩段式繪圖，覆寫這個函式。 預設實作會傳回**VIEWSTATUS_OPAQUE**。  
  
##  <a name="onhidetoolbars"></a>COleControl::OnHideToolBars  
 當控制項的 UI 停用時由架構呼叫。  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>備註  
 實作應該隱藏所有顯示的工具列`OnShowToolbars`。  
  
##  <a name="oninactivemousemove"></a>COleControl::OnInactiveMouseMove  
 由下滑鼠指標在收到的非作用中物件的容器呼叫`WM_MOUSEMOVE`訊息。  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>參數  
 `lprcBounds`  
 週框矩形中，以包含視窗的工作區座標的物件。 在螢幕上的確切位置和大小告知物件時`WM_MOUSEMOVE`收到訊息。  
  
 *x*  
 用戶端座標中的包含視窗的滑鼠位置的 x 座標。  
  
 *y*  
 用戶端座標中的包含視窗的滑鼠位置的 y 座標。  
  
 `dwKeyState`  
 識別鍵盤輔助按鍵在鍵盤上的目前狀態。 有效的值可以是任何旗標的組合**MK_CONTROL**， **MK_SHIFT**， **MK_ALT**， **MK_BUTTON**， **MK_LBUTTON**， **MK_MBUTTON**，和**MK_RBUTTON**。  
  
### <a name="remarks"></a>備註  
 請注意視窗工作區座標 （像素為單位） 用來傳遞滑鼠游標位置。 這樣做可能也會將物件的週框矩形傳遞相同的座標系統中。  
  
##  <a name="oninactivesetcursor"></a>COleControl::OnInactiveSetCursor  
 由下滑鼠指標在收到的非作用中物件的容器呼叫`WM_SETCURSOR`訊息。  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>參數  
 `lprcBounds`  
 週框矩形中，以包含視窗的工作區座標的物件。 在螢幕上的確切位置和大小告知物件時`WM_SETCURSOR`收到訊息。  
  
 *x*  
 用戶端座標中的包含視窗的滑鼠位置的 x 座標。  
  
 *y*  
 用戶端座標中的包含視窗的滑鼠位置的 y 座標。  
  
 *dwMouseMsg*  
 滑鼠訊息的識別項`WM_SETCURSOR`發生。  
  
 *bSetAlways*  
 指定物件必須設定資料指標。 如果**TRUE**，物件必須設定資料指標; 如果**FALSE**，資料指標不義務設定游標，而且應該會傳回**S_FALSE**在此情況下。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 請注意視窗工作區座標 （像素為單位） 用來傳遞滑鼠游標位置。 這樣做可能也會將物件的週框矩形傳遞相同的座標系統中。  
  
##  <a name="onkeydownevent"></a>COleControl::OnKeyDownEvent  
 已處理的內建 KeyDown 事件之後，由架構呼叫。  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>參數  
 `nChar`  
 按下的按鍵虛擬按鍵碼值。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
### <a name="remarks"></a>備註  
 如果控制項需要索引鍵資訊的存取權之後在引發事件, 會覆寫這個函式。  
  
##  <a name="onkeypressevent"></a>COleControl::OnKeyPressEvent  
 由架構呼叫之後的存貨已經引發 KeyPress 事件。  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>參數  
 `nChar`  
 包含虛擬按鍵碼值的按鍵。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h  
  
### <a name="remarks"></a>備註  
 請注意，`nChar`值可能被修改的容器。  
  
 如果您想要通知之後就會發生此事件，請覆寫這個函式。  
  
##  <a name="onkeyupevent"></a>COleControl::OnKeyUpEvent  
 已處理的內建 KeyDown 事件之後，由架構呼叫。  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>參數  
 `nChar`  
 按下的按鍵虛擬按鍵碼值。 如需標準虛擬按鍵碼的清單，請參閱 Winuser.h  
  
 `nShiftState`  
 包含下列旗標的組合︰  
  
- **SHIFT_MASK**動作期間按下 SHIFT 鍵。  
  
- **CTRL_MASK**動作期間按下 CTRL 鍵。  
  
- **ALT_MASK**動作期間按下 ALT 鍵。  
  
### <a name="remarks"></a>備註  
 如果控制項需要索引鍵資訊的存取權之後在引發事件, 會覆寫這個函式。  
  
##  <a name="onmappropertytopage"></a>COleControl::OnMapPropertyToPage  
 由架構呼叫以取得實作指定的屬性編輯的屬性頁類別識別碼。  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>參數  
 `dispid`  
 控制項屬性的分派識別碼。  
  
 `lpclsid`  
 指標**CLSID**結構透過將傳回的類別識別碼。  
  
 *pbPageOptional*  
 傳回是否在指定的屬性頁的使用是選擇性的指標。  
  
### <a name="return-value"></a>傳回值  
 如果在傳回的類別識別碼的非零， `lpclsid`; 否則為 0。  
  
### <a name="remarks"></a>備註  
 覆寫此函式可提供方法來叫用容器的屬性瀏覽器從您的控制項屬性頁。  
  
##  <a name="onmnemonic"></a>COleControl::OnMnemonic  
 容器已偵測到的 OLE 控制項的助憶鍵已按下時由架構呼叫。  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>參數  
 `pMsg`  
 助憶鍵 (Mnemonic) 按鍵所產生之 Windows 訊息的指標。  
  
##  <a name="onproperties"></a>COleControl::OnProperties  
 已叫用容器的控制項屬性的動詞時由架構呼叫。  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `lpMsg`  
 叫用動詞命令的 Windows 訊息指標。  
  
 `hWndParent`  
 控制項的父視窗控制代碼。  
  
 `lpRect`  
 矩形容器中控制項所使用的指標。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 預設實作會顯示強制回應屬性對話方塊。  
  
 您也可以使用此函式會造成您的控制項屬性頁的顯示。 呼叫以`OnProperties`函式，將控制項的父代中的控制代碼傳遞`hWndParent`參數。 在此情況下，值`lpMsg`和`lpRect`參數被忽略。  
  
##  <a name="onqueryhitpoint"></a>COleControl::OnQueryHitPoint  
 為了回應容器的架構呼叫**IViewObjectEx::QueryHitPoint**要求。  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>參數  
 `dwAspect`  
 指定物件的呈現方式。 有效的值取自列舉[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指標`RECT`結構，指定 OLE 控制項的用戶端區域的周框矩形。  
  
 `ptlLoc`  
 指標**點**結構，指定要叫用檢查點。 在 OLE 用戶端區域的座標指定點。  
  
 `lCloseHint`  
 定義 「 關閉 」 的點檢查叫用的距離。  
  
 `pHitResult`  
 指標叫用查詢的結果。 下列其中一個值：  
  
- **HITRESULT_OUTSIDE** `ptlLoc`是外部的 OLE 物件，並不會關閉。  
  
- **HITRESULT_TRANSPARENT** *ptlLoc*界限的 OLE 物件，但不是接近映像內。 例如，可能是透明的圓點**HITRESULT_TRANSPARENT**。  
  
- **HITRESULT_CLOSE** `ptlLoc`是內部或外部的 OLE 物件，但關閉不夠，才會被視為內部物件。 小型、 精簡，或詳細物件可能會使用此值。 即使 「 點 」 是外部週框矩形的物件仍可能會關閉 （此為所需的小型物件叫用）。  
  
- **HITRESULT_HIT** `ptlLoc`內物件的影像。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果成功傳回叫用的結果。否則便是 0。 叫用次數是與 OLE 控制項顯示區域重疊。  
  
### <a name="remarks"></a>備註  
 查詢物件的顯示矩形是否重疊指定的點 （點擊點）。 `QueryHitPoint`您可以覆寫測試針對非矩形的物件。  
  
##  <a name="onqueryhitrect"></a>COleControl::OnQueryHitRect  
 為了回應容器的架構呼叫**IViewObjectEx::QueryHitRect**要求。  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>參數  
 `dwAspect`  
 指定物件要進行表示的方式。 有效的值取自列舉[DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318)或**DVASPECT2**。  
  
 `pRectBounds`  
 指標`RECT`結構，指定 OLE 控制項的用戶端區域的周框矩形。  
  
 *prcLoc*  
 指標`RECT`結構，指定要檢查的叫用 （與物件矩形重疊），相對於物件的左上角的矩形。  
  
 `lCloseHint`  
 未使用。  
  
 `pHitResult`  
 指標叫用查詢的結果。 下列其中一個值：  
  
- **HITRESULT_OUTSIDE**的矩形中的任何點叫用的 OLE 物件。  
  
- **HITRESULT_HIT**的矩形中的至少一個點會在物件上的叫用。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果成功傳回叫用的結果。否則便是 0。  
  
### <a name="remarks"></a>備註  
 查詢物件的顯示矩形是否重疊的任何時間點指定的矩形 （點擊矩形）。 `QueryHitRect`您可以覆寫測試針對非矩形的物件。  
  
##  <a name="onrenderdata"></a>COleControl::OnRenderData  
 由架構呼叫以擷取指定格式的資料。  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>參數  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)結構，指定用來要求資訊的格式。  
  
 `lpStgMedium`  
 指向[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)資料所要傳回的結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)或[DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata)延遲轉譯為成員函式。 此函式的預設實作會呼叫`OnRenderFileData`或`OnRenderGlobalData`分別，如果提供的儲存體中的檔案或記憶體。 如果要求的格式是`CF_METAFILEPICT`或永續性的屬性設定格式，預設實作會呈現適當的資料，並傳回非零值。 否則，它會傳回 0，不做任何動作。  
  
 如果*lpStgMedium]-> [tymed*是**TYMED_NULL**、 **STGMEDIUM**應該配置，並填入所指定*lpFormatEtc]-> [tymed*。 如果沒有**TYMED_NULL**、 **STGMEDIUM**應填入資料的位置。  
  
 覆寫此函式可提供您要求的格式和 「 中 」 的資料。 根據您的資料，您可以改為覆寫這個函式的其他版本的其中一個。 如果您的資料是小型且固定的大小，會覆寫`OnRenderGlobalData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。  
  
 如需詳細資訊，請參閱**FORMATETC**和**STGMEDIUM**中結構[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderfiledata"></a>COleControl::OnRenderFileData  
 由架構呼叫以擷取指定的格式中的資料儲存媒體為檔案時。  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>參數  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)結構，指定用來要求資訊的格式。  
  
 `pFile`  
 指向[CFile](../../mfc/reference/cfile-class.md)資料為呈現的物件。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延遲轉譯的成員函式。 此函式的預設實作只會傳回**FALSE**。  
  
 覆寫此函式可提供您要求的格式和 「 中 」 的資料。 根據您的資料，您可以改為覆寫這個函式的其他版本的其中一個。 如果您想要處理多個儲存媒體，覆寫`OnRenderData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。  
  
 如需詳細資訊，請參閱**FORMATETC**結構[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onrenderglobaldata"></a>COleControl::OnRenderGlobalData  
 由架構呼叫以時指定的儲存體中是全域記憶體擷取資料，以指定的格式。  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>參數  
 `lpFormatEtc`  
 指向[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)結構，指定用來要求資訊的格式。  
  
 `phGlobal`  
 指向全域記憶體資料所要傳回的控制代碼。 如果已不配置任何記憶體，這個參數可以是**NULL**。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 指定的格式是其中一個先前放置在控制項物件使用[DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata)延遲轉譯的成員函式。 此函式的預設實作只會傳回**FALSE**。  
  
 如果`phGlobal`是**NULL**，然後新`HGLOBAL`應該配置並傳回`phGlobal`。 否則，`HGLOBAL`所指定`phGlobal`應填入資料。 資料量置於`HGLOBAL`不能超過目前的記憶體區塊大小。 此外，無法重新配置較大的區塊。  
  
 覆寫此函式可提供您要求的格式和 「 中 」 的資料。 根據您的資料，您可以改為覆寫這個函式的其他版本的其中一個。 如果您想要處理多個儲存媒體，覆寫`OnRenderData`。 如果您在檔案中，或資料的大小不固定，覆寫`OnRenderFileData`。  
  
 如需詳細資訊，請參閱**FORMATETC**結構[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onresetstate"></a>COleControl::OnResetState  
 當控制項的屬性應該設定為其預設值，由架構呼叫。  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫[DoPropExchange](#dopropexchange)，並傳遞`CPropExchange`會導致屬性設為其預設值的物件。  
  
 控制寫入器可以在此插入 OLE 控制項的初始化程式碼可覆寫。 此函式時，會呼叫[IPersistStream::Load](http://msdn.microsoft.com/library/windows/desktop/ms680568)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)失敗，或[IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234)或[IPersistStorage::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194)呼叫時，不含第一個呼叫**IPersistStream::Load**或**ipersiststorage:: Load**。  
  
##  <a name="onsetclientsite"></a>Colecontrol:: Onsetclientsite  
 容器控制項的呼叫時由架構呼叫**IOleControl::SetClientSite**函式。  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>備註  
 根據預設，`OnSetClientSite`會檢查是否載入資料路徑屬性，而如果是，呼叫`DoDataPathPropExchange`。  
  
 覆寫這個函式來執行這項通知的任何特殊處理。 特別是，此函式的覆寫應呼叫基底類別。  
  
##  <a name="onsetdata"></a>COleControl::OnSetData  
 由架構呼叫以將控制項的資料取代為指定的資料。  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>參數  
 `lpFormatEtc`  
 指標[FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177)結構，指定資料的格式。  
  
 `lpStgMedium`  
 指標[STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812)結構中資料的所在。  
  
 `bRelease`  
 **TRUE**控制項應該釋出儲存媒體中; 如果**FALSE**如果控制項不應該釋出儲存媒體。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果資料持續性的屬性中設定格式，預設實作會據此修改控制項的狀態。 否則，預設實作沒有任何作用。 如果`bRelease`是**TRUE**，然後呼叫**ReleaseStgMedium**進行; 否則為 not。  
  
 覆寫此函式可將控制項的資料取代為指定的資料。  
  
 如需詳細資訊，請參閱**FORMATETC**和**STGMEDIUM**中結構[!INCLUDE[winSDK](../../atl/includes/winsdk_md.md)]。  
  
##  <a name="onsetextent"></a>COleControl::OnSetExtent  
 當控制項的寬度需要變更，由於呼叫時由架構呼叫[IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330)。  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>參數  
 `lpSizeL`  
 指標**大小**使用之長整數來代表控制項，以表示的高度與寬度結構**HIMETRIC**單位。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果已接受的大小變更。否則便是 0。  
  
### <a name="remarks"></a>備註  
 預設實作會處理控制項的寬度調整大小。 如果控制項是就地啟用作用中，容器的呼叫**OnPosRectChanged**再進行。  
  
 覆寫此函式可變更您的控制項的預設調整大小。  
  
##  <a name="onsetobjectrects"></a>COleControl::OnSetObjectRects  
 由架構呼叫以實作呼叫[IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767)。  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>參數  
 *lpRectPos*  
 表示控制項的新位置和大小，相對於容器 RECT 結構的指標。  
  
 `lpRectClip`  
 指標`RECT`結構，表示控制項是裁剪矩形區域。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果已接受重新定位。否則便是 0。  
  
### <a name="remarks"></a>備註  
 預設實作自動重新定位和調整大小的控制項視窗的控點，並傳回**TRUE**。  
  
 覆寫這個函式來變更此函式的預設行為。  
  
##  <a name="onshowtoolbars"></a>COleControl::OnShowToolBars  
 當控制項以 UI 啟動時由架構呼叫。  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>備註  
 預設實作不做任何動作。  
  
##  <a name="ontextchanged"></a>COleControl::OnTextChanged  
 內建的標題或文字屬性值變更時由架構呼叫。  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>備註  
 預設實作會呼叫`InvalidateControl`。  
  
 如果您想要在這個屬性變更之後的通知，請覆寫這個函式。  
  
##  <a name="onwindowlessmessage"></a>COleControl::OnWindowlessMessage  
 為了回應容器的架構呼叫**IOleInPlaceObjectWindowless::OnWindowMessage**要求。  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>參數  
 `msg`  
 Windows 所傳送的訊息識別碼。  
  
 `wParam`  
 Windows 所傳送。 指定特定訊息的其他資訊。 此參數的內容而定的值`msg`參數。  
  
 `lParam`  
 Windows 所傳送。 指定特定訊息的其他資訊。 此參數的內容而定的值`msg`參數。  
  
 *plResult*  
 Windows 結果碼。 指定訊息處理的結果，取決於訊息傳送。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 處理無視窗控制項的視窗訊息。 `COleControl``OnWindowlessMessage`應該用於訊息滑鼠和鍵盤訊息以外的視窗訊息。 `COleControl`提供[SetCapture](#setcapture)和[SetFocus](#setfocus)特別為取得無視窗的 OLE 物件中的滑鼠擷取和鍵盤焦點。  
  
 由於無視窗物件沒有視窗，他們需要一個機制，讓容器分派訊息傳送到這些。 無視窗的 OLE 物件取得訊息其容器，從透過`OnWindowMessage`方法`IOleInPlaceObjectWindowless`介面 (副檔名為[IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646)無視窗的支援)。 `OnWindowMessage`不接受`HWND`參數。  
  
##  <a name="parenttoclient"></a>COleControl::ParentToClient  
 將轉譯的座標`pPoint`為用戶端座標。  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>參數  
 `lprcBounds`  
 OLE 控制項容器內的範圍指標。 非工作區，但整個控制項包括框線和捲軸的區域。  
  
 `pPoint`  
 轉譯控制項的用戶端區域的座標為指向父 （容器） 的指標。  
  
 `bHitTest`  
 指定點擊測試執行的點上。  
  
### <a name="return-value"></a>傳回值  
 如果`bHitTest`是**FALSE**，傳回**HTNOWHERE**。 如果`bHitTest`是**TRUE**、 會傳回在其父代 （容器） 點的位置載入的 OLE 控制項的工作區中，而且是其中一個的下列滑鼠點擊測試的值︰  
  
- **HTBORDER**中視窗框線的沒有縮放邊框。  
  
- **HTBOTTOM**中較低的水平框線的視窗。  
  
- **HTBOTTOMLEFT**視窗框線的左下角。  
  
- **HTBOTTOMRIGHT**視窗框線的右下角。  
  
- **HTCAPTION**標題列區域中。  
  
- **HTCLIENT**工作區中。  
  
- **HTERROR**螢幕背景或視窗之間的分隔線 (相同**HTNOWHERE**不同之處在於**DefWndProc** Windows 函式會產生系統嗶聲，表示錯誤)。  
  
- **HTGROWBOX**大小方塊中。  
  
- **HTHSCROLL**水平捲軸。  
  
- **HTLEFT**左框線的視窗中。  
  
- **HTMAXBUTTON**中最大化 按鈕。  
  
- **HTMENU**功能表區域中。  
  
- **HTMINBUTTON**中最小化按鈕。  
  
- **HTNOWHERE**螢幕背景或視窗之間的分隔線。  
  
- **HTREDUCE**中最小化按鈕。  
  
- **HTRIGHT**中視窗的右框線。  
  
- **HTSIZE**大小方塊中 (相同**HTGROWBOX**)。  
  
- **HTSYSMENU**在控制項功能表或子視窗中 [關閉] 按鈕。  
  
- **HTTOP**上方的水平框線的視窗中。  
  
- **HTTOPLEFT**視窗框線的左上角。  
  
- **HTTOPRIGHT**視窗框線的右上角。  
  
- **HTTRANSPARENT**中目前所涵蓋的另一個視窗的視窗。  
  
- **HTVSCROLL**垂直捲軸。  
  
- **HTZOOM**中最大化 按鈕。  
  
### <a name="remarks"></a>備註  
 在輸入`pPoint`是相對於來源的父代 （的容器左上角）。 在輸出`pPoint`是相對於來源的 OLE 控制項 （用戶端區域控制項的左上角） 工作區。  
  
##  <a name="postmodaldialog"></a>COleControl::PostModalDialog  
 告知容器已關閉強制回應對話方塊。  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>參數  
 `hWndParent`  
 強制回應對話方塊中的父視窗的控制代碼。  
  
### <a name="remarks"></a>備註  
 顯示任何強制回應對話方塊之後呼叫此函式。 您必須呼叫此函式，使容器可以啟用停用任何最上層視窗`PreModalDialog`。 此函式應該搭配呼叫`PreModalDialog`。  
  
##  <a name="premodaldialog"></a>COleControl::PreModalDialog  
 通知即將顯示強制回應對話方塊中的容器。  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>參數  
 `hWndParent`  
 強制回應對話方塊中的父視窗的控制代碼。  
  
### <a name="remarks"></a>備註  
 顯示任何強制回應對話方塊之前呼叫此函式。 您必須呼叫此函式，因此容器可以停用所有最上層的視窗。 已顯示強制回應對話方塊後，然後您必須呼叫`PostModalDialog`。  
  
##  <a name="recreatecontrolwindow"></a>COleControl::RecreateControlWindow  
 終結並重新建立控制項的視窗。  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>備註  
 這可能需要變更視窗的樣式位元。  
  
##  <a name="refresh"></a>COleControl::Refresh  
 會強制重新繪製的 OLE 控制項。  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>備註  
 此函式會受到`COleControl`基底類別做為內建方法，呼叫重新整理。 這可讓 OLE 控制項的使用者在特定時間重新繪製控制項。 如需有關這個方法的詳細資訊，請參閱文章[ActiveX 控制項︰ 方法](../../mfc/mfc-activex-controls-methods.md)。  
  
##  <a name="releasecapture"></a>COleControl::ReleaseCapture  
 釋放滑鼠捕捉。  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果控制項目前具有滑鼠擷取，則會擷取發行。 否則，此函式沒有任何作用。  
  
##  <a name="releasedc"></a>COleControl::ReleaseDC  
 釋放容器的無視窗控制項時，釋放由其他應用程式使用的裝置內容顯示裝置內容。  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 識別要釋放的容器裝置內容。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 應用程式必須呼叫`ReleaseDC`每次呼叫[GetDC](#getdc)。  
  
##  <a name="reparentcontrolwindow"></a>COleControl::ReparentControlWindow  
 設定控制項的父代。  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>參數  
 *hWndOuter*  
 控制項視窗的控制代碼。  
  
 `hWndParent`  
 新的父視窗的控制代碼。  
  
### <a name="remarks"></a>備註  
 呼叫此函式可重設控制項視窗的父代。  
  
##  <a name="resetstockprops"></a>COleControl::ResetStockProps  
 初始化的狀態`COleControl`內建屬性設為預設值。  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>備註  
 屬性是︰ 外觀、 背景色彩、 框線樣式、 標題、 啟用、 字型、 前景色彩、 hWnd 和文字。 如需內建屬性的說明，請參閱[ActiveX 控制項︰ 加入內建屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 您可以使用來改善控制項的二進位初始化效能`ResetStockProps`和`ResetVersion`覆寫`COleControl::OnResetState`。 請參閱下列範例。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFCAxCtl # 7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>COleControl::ResetVersion  
 初始化為指定值的版本號碼。  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>參數  
 `dwVersionDefault`  
 要指派給控制項的版本號碼。  
  
### <a name="remarks"></a>備註  
 您可以使用來改善控制項的二進位初始化效能`ResetVersion`和`ResetStockProps`覆寫`COleControl::OnResetState`。 請參閱在範例[ResetStockProps](#resetstockprops)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="scrollwindow"></a>COleControl::ScrollWindow  
 允許捲動的區域在螢幕上其就地使用中映像內無視窗的 OLE 物件。  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>參數  
 `xAmount`  
 在裝置單位，水平捲動的指定單位的數量。 這個參數必須為負值，向左捲動。  
  
 `yAmount`  
 在裝置單位中，垂直捲動的指定單位的數量。 這個參數必須為負值，向上捲動。  
  
 `lpRect`  
 指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或 RECT 結構，以包含視窗的工作區座標指定捲動，OLE 物件的工作區的一部分。 如果`lpRect`是**NULL**，捲動整個 OLE 物件的工作區。  
  
 `lpClipRect`  
 指向`CRect`物件或`RECT`結構，指定要剪輯的矩形。 在矩形內部的像素將捲動。 即使是在矩形外的位元不受影響`lpRect`矩形。 如果`lpClipRect`是**NULL**，沒有裁剪部分不會對捲動矩形。  
  
##  <a name="selectfontobject"></a>COleControl::SelectFontObject  
 放入裝置內容中選取的字型。  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 裝置內容物件指標。  
  
 `fontHolder`  
 若要參考[CFontHolder](../../mfc/reference/cfontholder-class.md)物件，代表要選取的字型。  
  
### <a name="return-value"></a>傳回值  
 先前選取的字型指標。 呼叫端已經完成使用的所有繪圖作業時*fontHolder，*它應該藉由傳遞為參數，以重新選取先前選取的字型[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)。  
  
##  <a name="selectstockfont"></a>COleControl::SelectStockFont  
 選取放入裝置內容的內建字型屬性。  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>參數  
 `pDC`  
 裝置內容，其中將選取的字型。  
  
### <a name="return-value"></a>傳回值  
 先前選取的指標`CFont`物件。 您應該使用[cdc:: selectobject](../../mfc/reference/cdc-class.md#selectobject)完成時，這種字型選取回裝置內容。  
  
##  <a name="serializeextent"></a>COleControl::SerializeExtent  
 序列化或初始化分配給控制項的顯示空間的狀態。  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>參數  
 `ar`  
 A`CArchive`往或來自序列化的物件。  
  
### <a name="remarks"></a>備註  
 您可以使用來改善控制項的二進位的持續性效能`SerializeExtent`， `SerializeStockProps`，和`SerializeVersion`覆寫**COleControl::Serialize**。 請參閱下列範例。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFCAxCtl # 8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>COleControl::SerializeStockProps  
 序列化或初始化的狀態`COleControl`內建屬性︰ 外觀、 背景色彩、 框線樣式、 標題、 啟用、 字型、 前景色彩和文字。  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>參數  
 `ar`  
 A`CArchive`往或來自序列化的物件。  
  
### <a name="remarks"></a>備註  
 如需內建屬性的說明，請參閱[ActiveX 控制項︰ 加入內建屬性](../../mfc/mfc-activex-controls-adding-stock-properties.md)。  
  
 您可以使用來改善控制項的二進位的持續性效能`SerializeStockProps`， `SerializeExtent`，和`SerializeVersion`覆寫**COleControl::Serialize**。 如需範例，請參閱 < 在程式碼[SerializeExtent](#serializeextent)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="serializeversion"></a>COleControl::SerializeVersion  
 序列化或初始化控制項的版本資訊的狀態。  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `ar`  
 A`CArchive`往或來自序列化的物件。  
  
 `dwVersionDefault`  
 控制項的目前版本號碼。  
  
 `bConvert`  
 指出是否永續性資料應該轉換成最新格式儲存，或保留在相同的格式時載入時。  
  
### <a name="return-value"></a>傳回值  
 控制項版本號碼。 如果載入指定的封存，`SerializeVersion`傳回載入從該保存的版本。 否則，它會傳回目前載入的版本。  
  
### <a name="remarks"></a>備註  
 您可以使用來改善控制項的二進位的持續性效能`SerializeVersion`， `SerializeExtent`，和`SerializeStockProps`覆寫**COleControl::Serialize**。 如需範例，請參閱 < 在程式碼[SerializeExtent](#serializeextent)。 進一步最佳化初始化的詳細資訊，請參閱[ActiveX 控制項︰ 最佳化](../../mfc/mfc-activex-controls-optimization.md)。  
  
##  <a name="setappearance"></a>COleControl::SetAppearance  
 設定控制項的內建的外觀屬性值。  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>參數  
 *sAppearance*  
 A**簡短**( `VT_I2`) 要用於程式控制項的外觀的值。 零值以一般設定控制項的外觀和 1 的值設定為 3D 控制項的外觀。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊的內建屬性，請參閱[ActiveX 控制項︰ 屬性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setbackcolor"></a>COleControl::SetBackColor  
 設定控制項的內建的 BackColor 屬性值。  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>參數  
 *dwBackColor*  
 **OLE_COLOR**来用於背景繪製控制項的值。  
  
### <a name="remarks"></a>備註  
 如需有關使用這個屬性和其他相關的屬性，請參閱文章[ActiveX 控制項︰ 屬性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setborderstyle"></a>COleControl::SetBorderStyle  
 設定控制項的內建的 BorderStyle 屬性值。  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>參數  
 *sBorderStyle*  
 新的框線樣式，用於控制;0 表示沒有框線，而 1 表示一般的框線。  
  
### <a name="remarks"></a>備註  
 [控制] 視窗就會重新建立和`OnBorderStyleChanged`呼叫。  
  
##  <a name="setcapture"></a>COleControl::SetCapture  
 會使控制項的容器視窗控制項的代表採取擁有滑鼠捕捉。  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>傳回值  
 指標**CWnd**先前收到滑鼠輸入的 window 物件。  
  
### <a name="remarks"></a>備註  
 如果啟用並無視窗控制項，這個函式會導致控制項代表採取滑鼠捕捉，擁有控制項的容器視窗。 否則，這個函式會導致控制項本身需要擁有滑鼠捕捉 (相同`CWnd::SetCapture`)。  
  
##  <a name="setcontrolsize"></a>COleControl::SetControlSize  
 設定 OLE 控制項視窗的大小，並通知控制項站台正在變更的容器。  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>參數  
 `cx`  
 指定新控制項的寬度，單位為像素。  
  
 `cy`  
 指定新控制項的高度，單位為像素。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 此函式不應該用於控制項的建構函式。  
  
 請注意，所有用於控制 windows 座標是相對於控制項的左上角。  
  
##  <a name="setenabled"></a>COleControl::SetEnabled  
 設定內建控制項的 Enabled 屬性值。  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>參數  
 `bEnabled`  
 **TRUE**控制項是否已啟用，否則**FALSE**。  
  
### <a name="remarks"></a>備註  
 設定這個屬性之後, **OnEnabledChange**呼叫。  
  
##  <a name="setfocus"></a>COleControl::SetFocus  
 會使控制項的代表採取擁有輸入焦點的控制項的容器視窗。  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>傳回值  
 指標**CWnd**先前擁有輸入的焦點的視窗物件或**NULL**如果沒有這類視窗。  
  
### <a name="remarks"></a>備註  
 如果啟用並無視窗控制項，這個函式會導致控制項的容器視窗控制項的代表採取擁有輸入焦點。 輸入的焦點會將導向至容器的視窗的鍵盤輸入而容器會分派給呼叫的 OLE 物件的所有後續的鍵盤訊息`SetFocus`。 任何先前擁有輸入的焦點的視窗會失去它。  
  
 如果控制項不是無視窗，這個函式會導致本身需要擁有輸入焦點的控制項 (相同`CWnd::SetFocus`)。  
  
##  <a name="setfont"></a>COleControl::SetFont  
 設定控制項的內建字型屬性。  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>參數  
 *pFontDisp*  
 字型分派介面指標。  
  
##  <a name="setforecolor"></a>COleControl::SetForeColor  
 設定控制項的內建的前景色彩屬性值。  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>參數  
 *dwForeColor*  
 **OLE_COLOR**用於繪製控制項的前景的值。  
  
### <a name="remarks"></a>備註  
 如需有關使用這個屬性和其他相關的屬性，請參閱文章[ActiveX 控制項︰ 屬性](../../mfc/mfc-activex-controls-properties.md)。  
  
##  <a name="setinitialdataformats"></a>COleControl::SetInitialDataFormats  
 由架構呼叫以初始化此控制項所支援的資料格式的清單。  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>備註  
 預設實作會指定兩種格式︰`CF_METAFILEPICT`和持續性的屬性集。  
  
##  <a name="setinitialsize"></a>COleControl::SetInitialSize  
 設定 OLE 控制項的容器中第一次顯示時的大小。  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>參數  
 `cx`  
 初始像素為單位的 OLE 控制項的寬度。  
  
 `cy`  
 像素為單位的 OLE 控制項的初始高度。  
  
### <a name="remarks"></a>備註  
 若要設定您控制的初始大小您建構函式中呼叫此函式。 以裝置單位或像素為單位的初始大小。 建議您將控制項的建構函式中進行這個呼叫。  
  
##  <a name="setmodifiedflag"></a>COleControl::SetModifiedFlag  
 變更控制項的已修改的狀態。  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `bModified`  
 控制項新的值修改的旗標。 **TRUE**指出已經修改控制項的狀態。**FALSE**表示只儲存控制項的狀態。  
  
### <a name="remarks"></a>備註  
 呼叫此函式，每次變更發生時，會影響控制項的永續性狀態。 例如，如果持續性屬性的值變更時，呼叫這個函式`bModified` **TRUE**。  
  
##  <a name="setnotpermitted"></a>Colecontrol:: Setnotpermitted  
 表示編輯要求已失敗。  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>備註  
 呼叫此函式時`BoundPropertyRequestEdit`失敗。 此函式會擲回的例外狀況型別的**COleDispScodeException**來表示，不允許設定作業。  
  
##  <a name="setnotsupported"></a>Colecontrol:: Setnotsupported  
 防止使用者控制項的屬性值的修改。  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>備註  
 呼叫此函式取代任何屬性的 Set 函式不支援修改控制項的使用者屬性值的位置。 其中一個範例會唯讀的屬性。  
  
##  <a name="setrectincontainer"></a>COleControl::SetRectInContainer  
 設定相對於容器，以裝置的單位表示控制項的矩形座標。  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `lpRect`  
 矩形，包含控制項的新的座標相對於容器指標。  
  
### <a name="return-value"></a>傳回值  
 如果呼叫成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 如果控制項已開啟，它會調整大小;否則容器的**OnPosRectChanged**呼叫函式。  
  
##  <a name="settext"></a>COleControl::SetText  
 設定控制項的內建的標題或文字屬性的值。  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>參數  
 `pszText`  
 字元字串指標。  
  
### <a name="remarks"></a>備註  
 請注意，內建的標題和文字屬性會對應到相同的值。 這表示可能是屬性所做的變更將會自動變更這兩個屬性。 一般情況下，控制項應該支援股票標題或文字屬性，但非兩者。  
  
##  <a name="throwerror"></a>Colecontrol:: Throwerror  
 表示控制項中的錯誤次數。  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>參數  
 `sc`  
 要回報的狀態碼值。 如需可能的程式碼的完整清單，請參閱文章[ActiveX 控制項︰ 進階主題](../../mfc/mfc-activex-controls-advanced-topics.md)。  
  
 `nDescriptionID`  
 字串資源 ID 例外狀況的報告。  
  
 `nHelpID`  
 要報告的主題說明識別碼。  
  
 `pszDescription`  
 字串，包含要報告的例外狀況的說明。  
  
### <a name="remarks"></a>備註  
 此函式應該只從呼叫 Get 或 Set 函式中的 OLE 屬性或 OLE automation 方法的實作。 如果您需要發出信號，在其他時間發生的錯誤，您應該引發內建的錯誤事件。  
  
##  <a name="transformcoords"></a>COleControl::TransformCoords  
 轉換座標之間的值**HIMETRIC**單位和容器的原生單位。  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>參數  
 *lpptlHimetric*  
 指標**POINTL**結構包含在座標**HIMETRIC**單位。  
  
 *lpptfContainer*  
 指標**POINTF**結構，其中包含容器的單位大小的座標。  
  
 `flags`  
 下列值的組合︰  
  
- **XFORMCOORDS_POSITION**容器中的位置。  
  
- **XFORMCOORDS_SIZE**容器中的大小。  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER**轉換**HIMETRIC**單位容器的單位。  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC**轉換容器的單位**HIMETRIC**單位。  
  
### <a name="remarks"></a>備註  
 前兩個旗標， **XFORMCOORDS_POSITION**和**XFORMCOORDS_SIZE**，指出是否應該將座標視為位置或大小。 其餘的兩個旗標會指出轉換的方向。  
  
##  <a name="translatecolor"></a>COleControl::TranslateColor  
 將轉換中的色彩值**OLE_COLOR**資料型別[COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449)資料型別。  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>參數  
 `clrColor`  
 A **OLE_COLOR**資料型別。 如需詳細資訊，請參閱 Windows [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353)函式。  
  
 `hpal`  
 選擇性的調色盤; 的控制代碼可以是**NULL**。  
  
### <a name="return-value"></a>傳回值  
 RGB （紅色、 綠色、 藍色） 32 位元色彩值定義實線色彩最接近`clrColor`裝置可以表示的值。  
  
### <a name="remarks"></a>備註  
 此函式可以轉譯至內建的前景色彩和背景色彩屬性**COLORREF**所使用的類型[CDC](../../mfc/reference/cdc-class.md)成員函式。  
  
##  <a name="willambientsbevalidduringload"></a>COleControl::WillAmbientsBeValidDuringLoad  
 決定控制項之後載入從永續性狀態時，是否應該使用的環境屬性的值做為預設值。  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>傳回值  
 非零代表環境的內容會有效。否則環境屬性將不再有效。  
  
### <a name="remarks"></a>備註  
 在某些容器中，您的控制項可能沒有存取至其環境屬性的覆寫的初始呼叫期間`COleControl::DoPropExchange`。 這是大小寫，如果容器呼叫[IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730)或[ipersiststorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557)之前呼叫[IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (亦即，如果它不會接受**OLEMISC_SETCLIENTSITEFIRST**葒鷑糔磢)。  
  
##  <a name="windowproc"></a>COleControl::WindowProc  
 提供的 Windows 處理程序`COleControl`物件。  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>參數  
 `message`  
 指定要處理的 Windows 訊息。  
  
 `wParam`  
 提供用於處理訊息的其他資訊。 參數值取決於訊息。  
  
 `lParam`  
 提供用於處理訊息的其他資訊。 參數值取決於訊息。  
  
### <a name="return-value"></a>傳回值  
 發送的訊息傳回的值。  
  
### <a name="remarks"></a>備註  
 呼叫此函式可透過控制項的訊息對應的特定訊息分派。  
  
## <a name="see-also"></a>另請參閱  
 [MFC 範例 CIRC3](../../visual-cpp-samples.md)   
 [MFC 範例 TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage 類別](../../mfc/reference/colepropertypage-class.md)   
 [CWnd 類別](../../mfc/reference/cwnd-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [CFontHolder 類別](../../mfc/reference/cfontholder-class.md)   
 [CPictureHolder 類別](../../mfc/reference/cpictureholder-class.md)

