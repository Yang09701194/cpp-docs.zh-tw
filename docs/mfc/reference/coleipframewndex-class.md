---
title: COleIPFrameWndEx 類別
ms.date: 11/04/2016
f1_keywords:
- COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AddPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::AdjustDockingLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::DockPaneLeftOf
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableAutoHidePanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnableDocking
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::EnablePaneMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetActivePopup
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetContainerFrameWindow
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDefaultResId
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetDockingManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMainFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetMenuBar
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetTearOffBars
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::GetToolbarButtonToolTipText
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InsertPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsMenuBarAvailable
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::IsPointNearDockSite
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::LoadFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseDockingPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCloseMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnClosePopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnCmdMsg
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuImage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnDrawMenuLogo
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMenuButtonToolHitTest
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnMoveMiniFrame
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnSetPreviewMode
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowCustomizePane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPanes
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnShowPopupMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::OnTearOffMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PaneFromPoint
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::PreTranslateMessage
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RecalcLayout
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::RemovePaneFromDockManager
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetDockState
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::SetupToolbarMenu
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::ShowPane
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::WinHelpA
- AFXOLEIPFRAMEWNDEX/COleIPFrameWndEx::InitUserToobars
helpviewer_keywords:
- COleIPFrameWndEx [MFC], AddDockSite
- COleIPFrameWndEx [MFC], AddPane
- COleIPFrameWndEx [MFC], AdjustDockingLayout
- COleIPFrameWndEx [MFC], DockPane
- COleIPFrameWndEx [MFC], DockPaneLeftOf
- COleIPFrameWndEx [MFC], EnableAutoHidePanes
- COleIPFrameWndEx [MFC], EnableDocking
- COleIPFrameWndEx [MFC], EnablePaneMenu
- COleIPFrameWndEx [MFC], GetActivePopup
- COleIPFrameWndEx [MFC], GetContainerFrameWindow
- COleIPFrameWndEx [MFC], GetDefaultResId
- COleIPFrameWndEx [MFC], GetDockFrame
- COleIPFrameWndEx [MFC], GetDockingManager
- COleIPFrameWndEx [MFC], GetMainFrame
- COleIPFrameWndEx [MFC], GetMenuBar
- COleIPFrameWndEx [MFC], GetPane
- COleIPFrameWndEx [MFC], GetTearOffBars
- COleIPFrameWndEx [MFC], GetToolbarButtonToolTipText
- COleIPFrameWndEx [MFC], InsertPane
- COleIPFrameWndEx [MFC], IsMenuBarAvailable
- COleIPFrameWndEx [MFC], IsPointNearDockSite
- COleIPFrameWndEx [MFC], LoadFrame
- COleIPFrameWndEx [MFC], OnCloseDockingPane
- COleIPFrameWndEx [MFC], OnCloseMiniFrame
- COleIPFrameWndEx [MFC], OnClosePopupMenu
- COleIPFrameWndEx [MFC], OnCmdMsg
- COleIPFrameWndEx [MFC], OnDrawMenuImage
- COleIPFrameWndEx [MFC], OnDrawMenuLogo
- COleIPFrameWndEx [MFC], OnMenuButtonToolHitTest
- COleIPFrameWndEx [MFC], OnMoveMiniFrame
- COleIPFrameWndEx [MFC], OnSetPreviewMode
- COleIPFrameWndEx [MFC], OnShowCustomizePane
- COleIPFrameWndEx [MFC], OnShowPanes
- COleIPFrameWndEx [MFC], OnShowPopupMenu
- COleIPFrameWndEx [MFC], OnTearOffMenu
- COleIPFrameWndEx [MFC], PaneFromPoint
- COleIPFrameWndEx [MFC], PreTranslateMessage
- COleIPFrameWndEx [MFC], RecalcLayout
- COleIPFrameWndEx [MFC], RemovePaneFromDockManager
- COleIPFrameWndEx [MFC], SetDockState
- COleIPFrameWndEx [MFC], SetupToolbarMenu
- COleIPFrameWndEx [MFC], ShowPane
- COleIPFrameWndEx [MFC], WinHelpA
- COleIPFrameWndEx [MFC], InitUserToobars
ms.assetid: ebff1560-a1eb-4854-af00-95d4a192bd55
ms.openlocfilehash: 1dd57494c6fe153346dd99e2472f507d1ebb1c26
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81753865"
---
# <a name="coleipframewndex-class"></a>COleIPFrameWndEx 類別

`COleIPFrameWndEx` 類別會實作支援 MFC 的 OLE 容器。 您必須從 `COleIPFrameWndEx` 類別衍生應用程式的就地框架視窗類別，而不是從 [COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)類別來衍生。
有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class COleIPFrameWndEx : public COleIPFrameWnd
```

## <a name="members"></a>成員

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[COleIPFramewndEx::添加網站](#adddocksite)||
|[COleIPFramewndEx::添加窗格](#addpane)||
|[COleIPFramewndEx::調整對接佈局](#adjustdockinglayout)||
|[COleIPFramewndEx::Dockpane](#dockpane)||
|[COleIPframewndEx::Dockpane左側](#dockpaneleftof)|將窗格停駐在另一個窗格的左邊。|
|[COleIPFrameWndEx::啟用自動隱藏窗格](#enableautohidepanes)||
|[COleIPFramewndEx::啟用對接](#enabledocking)||
|[COleIPFramewndEx::啟用PaneMenu](#enablepanemenu)||
|[COleIPFramewndEx:取得主動彈出](#getactivepopup)|將指標傳回到目前顯示的快顯功能表。|
|[COleIPFramewndEx:抓取容器框架視窗](#getcontainerframewindow)||
|[COleIPFramewndEx:取得預設Resid](#getdefaultresid)|在載入視窗時傳回您指定的框架視窗資源識別碼。|
|[COleIPFramewndEx::獲取DockFrame](#getdockframe)||
|[COleIPFramewndEx::取得對接管理器](#getdockingmanager)||
|[COleIPFramewndEx::取得主線](#getmainframe)||
|[COleIPFramewndEx::獲取功能表列](#getmenubar)|將指標傳回到附加在框架視窗的功能表列物件。|
|[COleIPFramewndEx::GetPane](#getpane)||
|[COleIPFramewndEx::取得關閉條形](#gettearoffbars)|傳回分割狀態的窗格物件清單。|
|[COleIPFramewndEx::取得工具列按鈕工具提示文字](#gettoolbarbuttontooltiptext)|架構先呼叫，再顯示工具提示按鈕。|
|[COleIPFramewndEx::插入窗格](#insertpane)||
|[COleIPFramewndEx::isMenuBar可用](#ismenubaravailable)|決定功能表列物件的指標是否不是 `NULL`。|
|[COleIPFramewndEx::IsPointNearDockSite](#ispointneardocksite)||
|[COleIPFramewndEx::載入幀](#loadframe)|(覆寫 `COleIPFrameWnd::LoadFrame`。)|
|[COleIPFramewndEx::關閉對接窗格](#onclosedockingpane)||
|[COleIPFramewndEx::在關閉迷你框架上](#oncloseminiframe)||
|[COleIPFramewndEx::在關閉彈出功能表上](#onclosepopupmenu)|架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。|
|[COleIPFramewndEx::OnCmdMsg](#oncmdmsg)|(覆寫 `CFrameWnd::OnCmdMsg`。)|
|[COleIPFramewndEx::在畫上功能表圖像](#ondrawmenuimage)|架構在繪製與功能表項目相關聯的映像時所呼叫。|
|[COleIPFramewndEx::在DrawMenulogo](#ondrawmenulogo)|架構在 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件處理 WM_PAINT 訊息時所呼叫。|
|[COleIPFramewndEx::在MenuButton工具命中測試](#onmenubuttontoolhittest)|架構在 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理 WM_NCHITTEST 訊息時所呼叫。|
|[COleIPFramewndEx::移動迷你框架](#onmoveminiframe)||
|[COleIPFramewndEx::打開預覽模式](#onsetpreviewmode)|呼叫這個成員函式，在預覽列印模式裡外設定應用程式的主框架視窗。 (覆寫 [CFrameWnd::OnSetPreviewMode](../../mfc/reference/cframewnd-class.md#onsetpreviewmode)。)|
|[COleIPFramewndEx::在顯示定製窗格上](#onshowcustomizepane)||
|[COleIPFramewndEx::在顯示窗格](#onshowpanes)||
|[COleIPFramewndEx::在顯示彈出選單](#onshowpopupmenu)|架構在啟動快顯功能表時所呼叫。|
|[COleIPFramewndEx::在TearoffMenu上](#ontearoffmenu)|架構在啟動有分割列的功能表時所呼叫。|
|[COleIPFramewndEx::P從點](#panefrompoint)||
|[COleIPFramewndEx::P重新翻譯訊息](#pretranslatemessage)|(覆寫 `COleIPFrameWnd::PreTranslateMessage`。)|
|[COleIPFrameWndEx:recalclayout](#recalclayout)|(覆寫 `COleIPFrameWnd::RecalcLayout`。)|
|[COleIPFramewndEx::從Dock管理器中刪除Pane](#removepanefromdockmanager)||
|[COleIPFramewndEx::SetDockstate](#setdockstate)|將指定的停駐狀態套用到屬於框架視窗的窗格。|
|[COleIPFramewndEx::設定工具列選單](#setuptoolbarmenu)|藉由搜尋虛設項目並替換成指定的使用者定義項目，修改工具列物件。|
|[COleIPFramewndEx::顯示窗格](#showpane)||
|[COleIPFramewndEx::溫説明](#winhelpa)|架構所呼叫以起始 WinHelp 應用程式或內容說明。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[COleIPFramewndEx::InituserToobars](#initusertoobars)|告知架構初始化指派給使用者定義工具列的控制項識別碼範圍。|

## <a name="example"></a>範例

下例示範如何建立 `COleIPFrameWndEx` 類別的執行個體子類別並覆寫其方法。 此範例示範如何覆寫 `OnDestory` 方法、 `RepositionFrame` 方法、 `RecalcLayout` 方法和 `CalcWindowRect` 方法。 此程式碼片段是 [WordPad 範例](../../overview/visual-cpp-samples.md)的一部分。

[!code-cpp[NVC_MFC_WordPad#1](../../mfc/reference/codesnippet/cpp/coleipframewndex-class_1.cpp)]

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

[CFrameWnd](../../mfc/reference/cframewnd-class.md)

[COleIPFrameWnd](../../mfc/reference/coleipframewnd-class.md)

[COleIPFrameWndEx](../../mfc/reference/coleipframewndex-class.md)

## <a name="requirements"></a>需求

**標頭：** afxoleipframewndex.h

## <a name="coleipframewndexadddocksite"></a><a name="adddocksite"></a>COleIPFramewndEx::添加網站

```cpp
void AddDockSite();
```

### <a name="remarks"></a>備註

## <a name="coleipframewndexaddpane"></a><a name="addpane"></a>COleIPFramewndEx::添加窗格

```
BOOL AddPane(
    CBasePane* pControlBar,
    BOOL bTail = TRUE);
```

### <a name="parameters"></a>參數

[在]*p控制列*<br/>
[在]*b泰爾*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexadjustdockinglayout"></a><a name="adjustdockinglayout"></a>COleIPFramewndEx::調整對接佈局

```
virtual void AdjustDockingLayout(HDWP hdwp = NULL);
```

### <a name="parameters"></a>參數

[在]*hdwp*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexdockpane"></a><a name="dockpane"></a>COleIPFramewndEx::Dockpane

```cpp
void DockPane(
    CBasePane* pBar,
    UINT nDockBarID = 0,
    LPCRECT lpRect = NULL);
```

### <a name="parameters"></a>參數

[在]*pBar*<br/>
[在]*nDockBarID*<br/>
[在]*lpRect*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexdockpaneleftof"></a><a name="dockpaneleftof"></a>COleIPframewndEx::Dockpane左側

將窗格停駐在另一個窗格的左邊。

```
BOOL DockPaneLeftOf(
    CPane* pBar,
    CPane* pLeftOf);
```

### <a name="parameters"></a>參數

*pBar*<br/>
[在]指向要停靠的窗格的指標。

*左撇子*<br/>
[在]指向用作源的窗格的指標。

### <a name="return-value"></a>傳回值

如果操作成功,則返回 TRUE。 否則傳回 FALSE。

### <a name="remarks"></a>備註

調用此方法以預定義的順序停靠多個窗格物件。 此方法將*pBar*指定的窗格停靠到*pLeftOf*指定的窗格的左側。

## <a name="coleipframewndexenableautohidepanes"></a><a name="enableautohidepanes"></a>COleIPFrameWndEx::啟用自動隱藏窗格

```
BOOL EnableAutoHidePanes(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

[在]*dwDock 風格*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexenabledocking"></a><a name="enabledocking"></a>COleIPFramewndEx::啟用對接

```
BOOL EnableDocking(DWORD dwDockStyle);
```

### <a name="parameters"></a>參數

[在]*dwDock 風格*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexenablepanemenu"></a><a name="enablepanemenu"></a>COleIPFramewndEx::啟用PaneMenu

```cpp
void EnablePaneMenu(
    BOOL bEnable,
    UINT uiCustomizeCmd,
    const CString& strCustomizeLabel,
    UINT uiViewToolbarsMenuEntryID,
    BOOL bContextMenuShowsToolbarsOnly = FALSE,
    BOOL bViewMenuShowsToolbarsOnly = FALSE);
```

### <a name="parameters"></a>參數

[在]*b 啟用*<br/>
[在]*ui 客製化Cmd*<br/>
[在]*str定製標籤*<br/>
[在]*uiView 工具列選單入口ID*<br/>
[在]*bContextMenu 只顯示工具列*<br/>
[在]*b 只檢視選單顯示工具列*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexgetactivepopup"></a><a name="getactivepopup"></a>COleIPFramewndEx:取得主動彈出

返回指向當前顯示的彈出式功能表的指標。

```
CMFCPopupMenu* GetActivePopup() const;
```

### <a name="return-value"></a>傳回值

指向活動彈出功能表的指標;否則 NULL。

### <a name="remarks"></a>備註

使用此方法獲取指向當前顯示的[CMFCPopupMenu 類](../../mfc/reference/cmfcpopupmenu-class.md)物件的指標。

## <a name="coleipframewndexgetcontainerframewindow"></a><a name="getcontainerframewindow"></a>COleIPFramewndEx:抓取容器框架視窗

```
COleCntrFrameWndEx* GetContainerFrameWindow();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexgetdefaultresid"></a><a name="getdefaultresid"></a>COleIPFramewndEx:取得預設Resid

返回框架視窗載入功能表時指定的功能表資源 ID。

```
UINT GetDefaultResId() const;
```

### <a name="return-value"></a>傳回值

返回功能表的資源 ID,如果框架視窗沒有功能表欄,則返回 0。

### <a name="remarks"></a>備註

調用此函數以檢索幀窗口通過調用`COleIPFrameWndEx::LoadFrame`載入功能表資源時指定的資源 ID。

## <a name="coleipframewndexgetdockframe"></a><a name="getdockframe"></a>COleIPFramewndEx::獲取DockFrame

```
CFrameWnd* GetDockFrame();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexgetdockingmanager"></a><a name="getdockingmanager"></a>COleIPFramewndEx::取得對接管理器

```
CDockingManager* GetDockingManager();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexgetmainframe"></a><a name="getmainframe"></a>COleIPFramewndEx::取得主線

```
CFrameWnd* GetMainFrame();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexgetmenubar"></a><a name="getmenubar"></a>COleIPFramewndEx::獲取功能表列

將指標傳回到附加在框架視窗的功能表列物件。

```
const CMFCMenuBar* GetMenuBar() const;
```

### <a name="return-value"></a>傳回值

指向功能表欄物件的指標。

### <a name="remarks"></a>備註

使用此函數可以檢索指向屬於`COleIPFrameWndEx`物件的功能表欄物件的指標。

## <a name="coleipframewndexgetpane"></a><a name="getpane"></a>COleIPFramewndEx::GetPane

```
CBasePane* GetPane(UINT nID);
```

### <a name="parameters"></a>參數

[在]*nID*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexgettearoffbars"></a><a name="gettearoffbars"></a>COleIPFramewndEx::取得關閉條形

傳回分割狀態的窗格物件清單。

```
const CObList& GetTearOffBars() const;
```

### <a name="return-value"></a>傳回值

對包含指向`CObList`[CBasePane 類](../../mfc/reference/cbasepane-class.md)派生物件的指標集合的物件的引用。

### <a name="remarks"></a>備註

該`COleIPFrameWndEx`物件將撕下功能表的集合保留為[CBasePane 類](../../mfc/reference/cbasepane-class.md)派生物件的清單。 使用此方法檢索對此清單的引用。

## <a name="coleipframewndexgettoolbarbuttontooltiptext"></a><a name="gettoolbarbuttontooltiptext"></a>COleIPFramewndEx::取得工具列按鈕工具提示文字

架構先呼叫，再顯示工具提示按鈕。

```
virtual BOOL GetToolbarButtonToolTipText(
    CMFCToolBarButton* pButton,
    CString& strTTText);
```

### <a name="parameters"></a>參數

*pButton*<br/>
[在]指向按鈕。

*斯特特文字*<br/>
[在]指向工具提示文字的指標。

### <a name="return-value"></a>傳回值

預設實現返回 0。

### <a name="remarks"></a>備註

重寫此函數以自訂工具列按鈕上工具提示的顯示。

## <a name="coleipframewndexinitusertoobars"></a><a name="initusertoobars"></a>COleIPFramewndEx::InituserToobars

指定框架分配給使用者定義的工具列的控制項識別範圍。

```cpp
void InitUserToolbars(
    LPCTSTR lpszRegEntry,
    UINT uiUserToolbarFirst,
    UINT uiUserToolbarLast)
```

### <a name="parameters"></a>參數

*lpszRegEntry*<br/>
[在]庫存儲使用者工具列設置的註冊表項。

*uiUserToolbar 優先*<br/>
[在]分配給第一個使用者定義的工具列的控制 ID。

*uiUser 工具列最後*<br/>
[在]分配給最後一個使用者定義的工具列的控制 ID。

### <a name="remarks"></a>備註

使用此函數可以初始化一系列控制項,以便分配給使用者動態定義的工具列。 參數*uiUserToolbarFirst*和*uiUserToolbarLast*定義一系列允許的工具列控制項 ID。 要禁用創建使用者定義的工具列,請將*uiUserToolbarFirst*或*uiUserToolbar"設置為*-1"。

## <a name="coleipframewndexinsertpane"></a><a name="insertpane"></a>COleIPFramewndEx::插入窗格

```
BOOL InsertPane(
    CBasePane* pControlBar,
    CBasePane* pTarget,
    BOOL bAfter = TRUE);
```

### <a name="parameters"></a>參數

[在]*p控制列*<br/>
[在]*p 目標*<br/>
[在]*b 後*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexismenubaravailable"></a><a name="ismenubaravailable"></a>COleIPFramewndEx::isMenuBar可用

確定指向選單列物件的指標是否為 NULL

```
BOOL IsMenuBarAvailable() const;
```

### <a name="return-value"></a>傳回值

如果框架視窗具有功能表欄,則返回非零值;如果框架視窗具有菜單欄,則返回非零值。否則返回 0。

### <a name="remarks"></a>備註

呼叫此方法以確定幀視窗是否維護指向其選單欄物件的非 NULL 指標。

## <a name="coleipframewndexispointneardocksite"></a><a name="ispointneardocksite"></a>COleIPFramewndEx::IsPointNearDockSite

```
BOOL IsPointNearDockSite(
    CPoint point,
    DWORD& dwBarAlignment,
    BOOL& bOuterEdge) const;
```

### <a name="parameters"></a>參數

[在]*點*<br/>
[在]*dwBaralignment*<br/>
[在]*bouterEdge*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexloadframe"></a><a name="loadframe"></a>COleIPFramewndEx::載入幀

```
virtual BOOL LoadFrame(
    UINT nIDResource,
    DWORD dwDefaultStyle = WS_OVERLAPPEDWINDOW | FWS_ADDTOTITLE,
    CWnd* pParentWnd = NULL,
    CCreateContext* pContext = NULL);
```

### <a name="parameters"></a>參數

[在]*nID資源*<br/>
[在]*dwDefault 樣式*<br/>
[在]*pparentwnd*<br/>
[在]*pContext*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexonclosedockingpane"></a><a name="onclosedockingpane"></a>COleIPFramewndEx::關閉對接窗格

```
virtual BOOL OnCloseDockingPane(CDockablePane*);
```

### <a name="parameters"></a>參數

[在]*可停靠窗格&#42;*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexoncloseminiframe"></a><a name="oncloseminiframe"></a>COleIPFramewndEx::在關閉迷你框架上

```
virtual BOOL OnCloseMiniFrame(CPaneFrameWnd*);
```

### <a name="parameters"></a>參數

[在]*CPaneFramewnd&#42;*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexonclosepopupmenu"></a><a name="onclosepopupmenu"></a>COleIPFramewndEx::在關閉彈出功能表上

架構在作用中的快顯功能表處理 WM_DESTROY 訊息時所呼叫。

```
virtual void OnClosePopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向彈出功能表物件的指標。

### <a name="remarks"></a>備註

重寫此方法,在物件處理WM_DESTROY`CMFCPopupMenu`消息時接收來自它們的通知。

## <a name="coleipframewndexoncmdmsg"></a><a name="oncmdmsg"></a>COleIPFramewndEx::OnCmdMsg

```
virtual BOOL OnCmdMsg(
    UINT nID,
    int nCode,
    void* pExtra,
    AFX_CMDHANDLERINFO* pHandlerInfo);
```

### <a name="parameters"></a>參數

[在]*nID*<br/>
[在]*n代碼*<br/>
[在]*pExtra*<br/>
[在]*pHandlerInfo*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexondrawmenuimage"></a><a name="ondrawmenuimage"></a>COleIPFramewndEx::在畫上功能表圖像

繪製與功能表項關聯的圖像時,由框架調用。

```
virtual BOOL OnDrawMenuImage(
    CDC* pDC,
    const CMFCToolBarMenuButton* pMenuButton,
    const CRect& rectImage);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pMenu 按鈕*<br/>
[在]指向功能表按鈕。

*rectImage*<br/>
[在]與功能表項關聯的圖像。

### <a name="return-value"></a>傳回值

默認實現不執行任何操作,並返回 0。

### <a name="remarks"></a>備註

如果要為屬於`COleIPFrameWndEx`派生對象擁有的功能表欄的功能表項自定義圖像繪圖,請重寫此方法。

## <a name="coleipframewndexondrawmenulogo"></a><a name="ondrawmenulogo"></a>COleIPFramewndEx::在DrawMenulogo

架構在 [CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)物件處理 WM_PAINT 訊息時所呼叫。

```
virtual void OnDrawMenuLogo(
    CDC* pDC,
    CMFCPopupMenu* pMenu,
    const CRect& rectLogo);
```

### <a name="parameters"></a>參數

*pDC*<br/>
[在]指向設備上下文的指標。

*pMenu*<br/>
[在]指向彈出功能表物件的指標。

*雷科洛格*<br/>
[在]指向要顯示的徽標。

### <a name="remarks"></a>備註

重寫此方法,在與`COleIPFrameWndEx`派生對象擁有的功能表欄關聯的彈出式功能表上顯示徽標。 預設實作不做任何動作。

## <a name="coleipframewndexonmenubuttontoolhittest"></a><a name="onmenubuttontoolhittest"></a>COleIPFramewndEx::在MenuButton工具命中測試

當[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)物件處理WM_NCHITTEST消息時,由框架調用。

```
virtual BOOL OnMenuButtonToolHitTest(
    CMFCToolBarButton* pButton,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>參數

[in] pButton 指標指向功能表按鈕。

[出] pTI`TOOLINFO`指標到結構。

### <a name="return-value"></a>傳回值

默認實現不執行任何操作,並返回 0。 如果實現填充*pTI*參數,則應返回非零值。

### <a name="remarks"></a>備註

重寫此方法以提供有關特定功能表項的工具提示資訊。

## <a name="coleipframewndexonmoveminiframe"></a><a name="onmoveminiframe"></a>COleIPFramewndEx::移動迷你框架

```
virtual BOOL OnMoveMiniFrame(CWnd* pFrame);
```

### <a name="parameters"></a>參數

[在]*pFrame*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexonsetpreviewmode"></a><a name="onsetpreviewmode"></a>COleIPFramewndEx::打開預覽模式

```
virtual void OnSetPreviewMode(
    BOOL bPreview,
    CPrintPreviewState* pState);
```

### <a name="parameters"></a>參數

[在]*b預覽*<br/>
[在]*pState*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexonshowcustomizepane"></a><a name="onshowcustomizepane"></a>COleIPFramewndEx::在顯示定製窗格上

```
virtual BOOL OnShowCustomizePane(
    CMFCPopupMenu* pMenuPane,
    UINT uiToolbarID);
```

### <a name="parameters"></a>參數

[在]*pMenuPane*<br/>
[在]*uiToolbarID*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexonshowpanes"></a><a name="onshowpanes"></a>COleIPFramewndEx::在顯示窗格

```
virtual BOOL OnShowPanes(BOOL bShow);
```

### <a name="parameters"></a>參數

[在]*b 顯示*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexonshowpopupmenu"></a><a name="onshowpopupmenu"></a>COleIPFramewndEx::在顯示彈出選單

顯示彈出式功能表時由框架呼叫。

```
virtual BOOL OnShowPopupMenu(CMFCPopupMenu* pMenuPopup);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向要顯示的彈出式功能表的指標。

### <a name="return-value"></a>傳回值

預設實現不執行任何操作,並返回非零值。 如果無法顯示彈出式功能表,則實現應返回 FALSE。

### <a name="remarks"></a>備註

重寫此方法以自定義彈出式功能表的顯示。 例如,您可以將功能表按鈕更改為顏色功能表按鈕或初始化撕線。

## <a name="coleipframewndexontearoffmenu"></a><a name="ontearoffmenu"></a>COleIPFramewndEx::在TearoffMenu上

當使用者選擇具有撕開欄的功能表時,由框架調用。

```
virtual BOOL OnTearOffMenu(
    CMFCPopupMenu* pMenuPopup,
    CPane* pBar);
```

### <a name="parameters"></a>參數

*pMenuPopup*<br/>
[在]指向用戶選擇的彈出式功能表的指標。

*pBar*<br/>
[在]指向承載功能表的窗格的指標。

### <a name="return-value"></a>傳回值

如果希望框架啟動彈出式功能表,則為 TRUE;否則 FALSE。 預設值為 TRUE。

### <a name="remarks"></a>備註

如果要自定義撕開欄的設置,請覆蓋此函數。

## <a name="coleipframewndexpanefrompoint"></a><a name="panefrompoint"></a>COleIPFramewndEx::P從點

```
CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    bool bExactBar,
    CRuntimeClass* pRTCBarType) const;

CBasePane* PaneFromPoint(
    CPoint point,
    int nSensitivity,
    DWORD& dwAlignment,
    CRuntimeClass* pRTCBarType) const;
```

### <a name="parameters"></a>參數

[在]*點*<br/>
[在]*nSensitivity*<br/>
[在]*bExactBar*<br/>
[在]*pRTCBar 類型*<br/>
[在]*dwalignment*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexpretranslatemessage"></a><a name="pretranslatemessage"></a>COleIPFramewndEx::P重新翻譯訊息

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>參數

[在]*pMsg*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="coleipframewndexrecalclayout"></a><a name="recalclayout"></a>COleIPFrameWndEx:recalclayout

```
virtual void RecalcLayout(BOOL bNotify = TRUE);
```

### <a name="parameters"></a>參數

[在]*b 通知*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexremovepanefromdockmanager"></a><a name="removepanefromdockmanager"></a>COleIPFramewndEx::從Dock管理器中刪除Pane

```cpp
void RemovePaneFromDockManager(
    CBasePane* pControlBar,
    BOOL bDestroy,
    BOOL bAdjustLayout,
    BOOL bAutoHide,
    CBasePane* pBarReplacement);
```

### <a name="parameters"></a>參數

[在]*p控制列*<br/>
[在]*b破壞*<br/>
[在]*b 調整佈局*<br/>
[在]*bAutoHide*<br/>
[在]*pBar 取代*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexsetdockstate"></a><a name="setdockstate"></a>COleIPFramewndEx::SetDockstate

將指定的停靠狀態應用於屬於框架視窗的窗格。

```cpp
void SetDockState(const CDockState& state);
```

### <a name="parameters"></a>參數

*state*<br/>
[在]指定停靠狀態。

### <a name="remarks"></a>備註

使用此函數可為屬於`COleIPFrameWndEx`物件的窗格指定新的停靠狀態。

## <a name="coleipframewndexsetuptoolbarmenu"></a><a name="setuptoolbarmenu"></a>COleIPFramewndEx::設定工具列選單

藉由搜尋虛設項目並替換成指定的使用者定義項目，修改工具列物件。

```cpp
void SetupToolbarMenu(
    CMenu& menu,
    const UINT uiViewUserToolbarCmdFirst,
    const UINT uiViewUserToolbarCmdLast);
```

### <a name="parameters"></a>參數

*選單*<br/>
[在]對要修改的[CMenu](../../mfc/reference/cmenu-class.md)物件的引用。

*uiViewUserToolbarCmdFirst*<br/>
[在]指定第一個使用者定義的命令。

*uiViewUserToolbarCmdLast*<br/>
[在]指定最後一個使用者定義的命令。

### <a name="remarks"></a>備註

## <a name="coleipframewndexshowpane"></a><a name="showpane"></a>COleIPFramewndEx::顯示窗格

```cpp
void ShowPane(
    CBasePane* pBar,
    BOOL bShow,
    BOOL bDelay,
    BOOL bActivate);
```

### <a name="parameters"></a>參數

[在]*pBar*<br/>
[在]*b 顯示*<br/>
[在]*bDelay*<br/>
[在]*b 啟動*<br/>

### <a name="remarks"></a>備註

## <a name="coleipframewndexwinhelpa"></a><a name="winhelpa"></a>COleIPFramewndEx::溫説明

架構所呼叫以起始 WinHelp 應用程式或內容說明。

```
virtual void WinHelp(
    DWORD dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>參數

[in] dwData 指定*nCmd*指定的幫助類型所需的數據。

*nCmd*<br/>
[在]指定請求的幫助類型。 有關可能值的清單及其如何影響*dwData*參數,請參閱 Windows SDK 中的[WinHelp 函數](/windows/win32/api/winuser/nf-winuser-winhelpw)。

### <a name="remarks"></a>備註

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CFrameWndEx 類別](../../mfc/reference/cframewndex-class.md)<br/>
[CMDIFrameWndEx 類別](../../mfc/reference/cmdiframewndex-class.md)
