---
title: CRichEditCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: 07c3c864e91d8aebc8d70f54fed4286a24986208
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81368278"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl 類別

提供 Windows Rich Edit 控制項的功能。

## <a name="syntax"></a>語法

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[克里希編輯::克里希編輯](#cricheditctrl)|建構 `CRichEditCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[克里希編輯::罐粘貼](#canpaste)|確定剪貼簿的內容是否可以貼上到此豐富的編輯控制項中。|
|[克里希編輯::坎雷多](#canredo)|確定控件的重做佇列中是否有任何操作。|
|[克里希編輯::坎恩多](#canundo)|確定是否可以撤銷編輯操作。|
|[克里希編輯::查里波斯](#charfrompos)|檢索有關最接近編輯控制項工作區中指定點的字元的資訊。|
|[克里希編輯::清除](#clear)|清除當前選擇。|
|[克里希編輯::複製](#copy)|將目前選擇複製到剪貼簿。|
|[克里希編輯:建立](#create)|創建 Windows 豐富的編輯控制項並將其`CRichEditCtrl`與此 物件關聯。|
|[克里希編輯::建立Ex](#createex)|使用指定的擴展 Windows 樣式創建 Windows 豐富的編輯控制項`CRichEditCtrl`,並將其與此物件關聯。|
|[克里希編輯::切](#cut)|將當前選擇剪下到剪貼簿。|
|[克里希編輯::D播放樂隊](#displayband)|顯示此`CRichEditCtrl`物件的部分內容。|
|[克里希編輯::空UndoBuffer](#emptyundobuffer)|重置(清除)此`CRichEditCtrl`物件的撤銷標誌。|
|[克里希編輯::尋找文字](#findtext)|在此`CRichEditCtrl`物件中尋找文字。|
|[克里希編輯::尋找WordBreak](#findwordbreak)|在指定字元位置之前或之後查找下一個單詞中斷,或檢索有關該位置字元的資訊。|
|[克里希編輯::格式範圍](#formatrange)|為目標輸出裝置設定一系列文本的格式。|
|[克里希編輯::獲取查波斯](#getcharpos)|確定給定字元在此`CRichEditCtrl`物件中的位置。|
|[克里希編輯::取得預設字元格式](#getdefaultcharformat)|檢索此`CRichEditCtrl`物件中的目前預設字元格式屬性。|
|[克里希編輯::取得事件遮罩](#geteventmask)|檢索此`CRichEditCtrl`物件的事件掩碼。|
|[克里希編輯::獲取第一可見線](#getfirstvisibleline)|確定此`CRichEditCtrl`物件中最上面可見的線。|
|[克里希編輯::獲取IRichEditOle](#getiricheditole)|檢索指向此豐富編輯控件`IRichEditOle`的介面的指標。|
|[克里希編輯::獲取限制文字](#getlimittext)|獲取使用者可以在此`CRichEditCtrl`物件中輸入的文本量的限制。|
|[克里希編輯::獲取線](#getline)|從此`CRichEditCtrl`物件檢索一行文本。|
|[克里希編輯::獲取線計數](#getlinecount)|檢索此`CRichEditCtrl`物件中的行數。|
|[克里希編輯::獲取修改](#getmodify)|確定自上次保存以來此`CRichEditCtrl`物件的內容是否已更改。|
|[克里希編輯::取得選項](#getoptions)|檢索豐富的編輯控制項選項。|
|[克里希編輯::取得帕拉格式](#getparaformat)|檢索此`CRichEditCtrl`物件中當前所選內容中的段落格式屬性。|
|[克里希編輯::取得標點](#getpunctuation)|檢索富編輯控制件的當前標點符號字元。 此消息僅在操作系統的亞洲語言版本中可用。|
|[克里希編輯::獲取雷ct](#getrect)|檢索此`CRichEditCtrl`物件的格式矩形。|
|[克里希編輯::取得重名稱](#getredoname)|檢索控件重做佇列中下一個操作的類型(如果有)。|
|[克里希編輯::GetSel](#getsel)|獲取此`CRichEditCtrl`物件中當前選擇的起始位置和結束位置。|
|[克里希編輯::取得選擇字元格式](#getselectioncharformat)|檢索此`CRichEditCtrl`物件中當前選擇中的字元格式屬性。|
|[克里希編輯::取得選擇類型](#getselectiontype)|檢索此`CRichEditCtrl`物件中當前選擇中的內容類型。|
|[克里希編輯::獲取塞爾文字](#getseltext)|取得此`CRichEditCtrl`物件中選取的內容的文字|
|[克里希編輯::獲取文本長度](#gettextlength)|檢索此`CRichEditCtrl`物件中文本的長度(以字元表示)。 不包括終止空字元。|
|[克里希編輯::獲取文本長度Ex](#gettextlengthex)|檢索富編輯檢視中的字元或位元組數。 接受標誌清單以指示在富編輯控制項中確定文字長度的方法|
|[克里希編輯::取得文字模式](#gettextmode)|檢索當前文本模式並撤銷富編輯控制件的級別。|
|[克里希編輯::獲取文本範圍](#gettextrange)|檢索指定的文本範圍。|
|[克里希編輯::獲取Undo名稱](#getundoname)|檢索下一個撤銷操作的類型(如果有)。|
|[克里希編輯Ctrl::取得WordWrap模式](#getwordwrapmode)|檢索富編輯控制件的當前換字和換字選項。 此消息僅在操作系統的亞洲語言版本中可用。|
|[克里希編輯::隱藏選擇](#hideselection)|顯示或隱藏當前選擇。|
|[克里希編輯::限制文字](#limittext)|限制用戶可以在`CRichEditCtrl`物件中輸入的文本量。|
|[克里希編輯::線從查爾](#linefromchar)|確定哪行包含給定的字元。|
|[克里希編輯::線索引](#lineindex)|檢索此`CRichEditCtrl`物件中給定行的字元索引。|
|[克里希編輯::線長](#linelength)|檢索此`CRichEditCtrl`物件中給定行的長度。|
|[克里希編輯::線羅](#linescroll)|捲動此`CRichEditCtrl`物件中的文字。|
|[克里希編輯::Paste](#paste)|將剪貼簿的內容插入到此豐富的編輯控制項中。|
|[克里希編輯::P特別](#pastespecial)|以指定的數據格式將剪貼簿的內容插入到此豐富的編輯控制項中。|
|[克里希編輯::P從查爾](#posfromchar)|檢索編輯控制項中指定字元的工作區座標。|
|[克里希編輯::重做](#redo)|重做控件重做佇列中的下一個操作。|
|[克里希編輯::替換塞爾](#replacesel)|將此`CRichEditCtrl`物件的目前選擇替換為指定文本。|
|[克里希編輯::請求調整](#requestresize)|強制此`CRichEditCtrl`物件發送請求調整通知大小。|
|[克里希編輯Ctrl:設定自動 URL偵測](#setautourldetect)|指示自動 URL 檢測在豐富的編輯控制項中是否處於活動狀態。|
|[克里希編輯::設定背景顏色](#setbackgroundcolor)|設定此`CRichEditCtrl`物件的背景顏色。|
|[克里希編輯::設定預設字元格式](#setdefaultcharformat)|設定此`CRichEditCtrl`物件中的目前預設字元格式屬性。|
|[克里希編輯::設定事件遮罩](#seteventmask)|設置此`CRichEditCtrl`物件的事件掩碼。|
|[克里希編輯::設定修改](#setmodify)|設置或清除此`CRichEditCtrl`物件的修改標誌。|
|[克里希編輯::設定Ole回調](#setolecallback)|設置此`IRichEditOleCallback`富編輯控制件的 COM 物件。|
|[克里希編輯::設定選項](#setoptions)|設置此`CRichEditCtrl`物件的選項。|
|[克里希編輯::SetParaFormat](#setparaformat)|設定此`CRichEditCtrl`物件中當前選區中的段落格式屬性。|
|[克里希編輯::設定標定](#setpunctuation)|設置富編輯控制件的標點字元。 此消息僅在操作系統的亞洲語言版本中可用。|
|[克里希編輯::僅集讀取](#setreadonly)|設定此`CRichEditCtrl`物件的唯讀選項。|
|[克里希編輯::塞特雷茨](#setrect)|設定此`CRichEditCtrl`物件的格式矩形。|
|[克里希編輯::塞特塞爾](#setsel)|設置此`CRichEditCtrl`物件中的選擇。|
|[克里希編輯::設定選擇字元格式](#setselectioncharformat)|設定此`CRichEditCtrl`物件中當前選擇的字元格式屬性。|
|[克里希編輯::設定目標設備](#settargetdevice)|設置此`CRichEditCtrl`物件的目標輸出設備。|
|[克里希編輯::設定文字模式](#settextmode)|設置富編輯控制件的文本模式或撤銷級別。 如果控制項包含文字,則消息將失敗。|
|[克里希編輯::設置Undo限制](#setundolimit)|設置可存儲在撤銷佇列中的最大操作數。|
|[克里希編輯::SetWordCharFormat](#setwordcharformat)|設定此`CRichEditCtrl`物件中當前單詞中的字元格式屬性。|
|[克里希編輯Ctrl::SetWordWrap模式](#setwordwrapmode)|設置豐富的編輯控制項的換行和斷字選項。 此消息僅在操作系統的亞洲語言版本中可用。|
|[克里希編輯::停止分組打字](#stopgrouptyping)|阻止控制項將其他鍵入操作收集到當前撤消操作中。 控制項將下一個鍵入操作(如果有)儲存在復原佇列中的新操作中。|
|[克里希編輯::流](#streamin)|將輸入串流中的文字插入到`CRichEditCtrl`此物件中。|
|[克里希編輯::流出](#streamout)|將此`CRichEditCtrl`物件的文本儲存到輸出流中。|
|[克里希編輯::撤銷](#undo)|反轉上次編輯操作。|

## <a name="remarks"></a>備註

"富編輯控制件"是使用者可以在其中輸入和編輯文本的視窗。 文本可以分配字元和段落格式,並可以包括嵌入的 OLE 物件。 豐富的編輯控制項為文字格式設定提供了程式設計介面。 然而，應用程式必須實作所有必要的使用者介面元件，讓使用者能夠執行格式化作業。

此 Windows 通用控件`CRichEditCtrl`(因此是類)僅適用於在 Windows 95/98 和 Windows NT 版本 3.51 及更高版本下運行的程式。 該`CRichEditCtrl`類支援 Windows SDK 豐富的編輯控制項的版本 2.0 和 3.0。

> [!CAUTION]
> 如果在對話框中使用豐富的編輯控件(無論您的應用程式是 SDI、MDI 還是基於對話方塊),則必須在顯示對話框之前調用[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)一次。 呼叫這個函式的一般位置是在程式的 `InitInstance` 成員函式中。 只需在第一次顯示對話方塊時呼叫它一次。 如果您使用 `AfxInitRichEdit`，不需要呼叫 `CRichEditView`。

有關`CRichEditCtrl`使用的詳細資訊,請參閱:

- [控制項](../../mfc/controls-mfc.md)

- [使用 CRichEditCtrl](../../mfc/using-cricheditctrl.md)

有關在 MFC 應用程式中使用富編輯控件的範例,請參閱[WORDPAD](../../overview/visual-cpp-samples.md)範例應用程式。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

## <a name="cricheditctrlcanpaste"></a><a name="canpaste"></a>克里希編輯::罐粘貼

確定富編輯控制件是否可以貼上指定的剪貼簿格式。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>參數

*nFormat*<br/>
要查詢的剪貼簿數據格式。 此參數可以是預定義的剪貼簿格式之一,也可以是[註冊剪貼簿格式](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)返回的值。

### <a name="return-value"></a>傳回值

如果可以粘貼剪貼板格式,則非零;否則 0。

### <a name="remarks"></a>備註

如果*nFormat*為`CanPaste`0,將嘗試剪貼簿上當前的任何格式。

有關詳細資訊,請參閱 windows SDK[中EM_CANPASTE](/windows/win32/Controls/em-canpaste)消息和[註冊剪貼簿格式](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)功能。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

## <a name="cricheditctrlcanredo"></a><a name="canredo"></a>克里希編輯::坎雷多

確定重做佇列是否包含任何操作。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>傳回值

如果重做佇列包含操作,則非零,否則為 0。

### <a name="remarks"></a>備註

要發現重做佇列中的操作名稱,請致電[CRichEditCtrl::getRedoName](#getredoname)。 要重新做最近的復原操作,請呼叫[Redo](#redo)。

有關詳細資訊,請參閱 Windows SDK 中的[EM_CANREDO。](/windows/win32/Controls/em-canredo)

## <a name="cricheditctrlcanundo"></a><a name="canundo"></a>克里希編輯::坎恩多

確定是否可以撤銷上次編輯操作。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>傳回值

如果最後一個編輯操作可以通過調用[撤銷](#undo)成員函數撤銷,則非零;0,如果它不能撤銷。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_CANUNDO。](/windows/win32/Controls/em-canundo)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

## <a name="cricheditctrlcharfrompos"></a><a name="charfrompos"></a>克里希編輯::查里波斯

檢索參數*pt*指定的點處有關字元的資訊。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
包含指定點的座標的[CPoint](../../atl-mfc-shared/reference/cpoint-class.md)物件。

### <a name="return-value"></a>傳回值

離指定點最近的字元的零基字元索引。 如果指定的點超出控件中的最後一個字元,則返回值指示控件中的最後一個字元。

### <a name="remarks"></a>備註

此成員函數適用於豐富的編輯控制項。 要取得編輯控制項的資訊,請致電[CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)。

有關詳細資訊,請參閱 Windows SDK 中的[EM_CHARFROMPOS。](/windows/win32/Controls/em-charfrompos)

## <a name="cricheditctrlclear"></a><a name="clear"></a>克里希編輯::清除

刪除(清除)富編輯控制項中的當前選擇(如果有)。

```
void Clear();
```

### <a name="remarks"></a>備註

可以通過調用[復原](#undo)成員`Clear`函數撤銷執行的刪除。

要刪除當前選擇並將已刪除的內容放在剪貼簿上,請呼叫[「剪切](#cut)」成員函數。

有關詳細資訊,請參閱 Windows SDK 中的[WM_CLEAR。](/windows/win32/dataxchg/wm-clear)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

## <a name="cricheditctrlcopy"></a><a name="copy"></a>克里希編輯::複製

將富編輯控制件中的當前選擇(如果有)複製到剪貼簿。

```
void Copy();
```

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[WM_COPY。](/windows/win32/dataxchg/wm-copy)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

## <a name="cricheditctrlcreate"></a><a name="create"></a>克里希編輯:建立

創建 Windows 豐富的編輯控制項並將其`CRichEditCtrl`與此 物件關聯。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定編輯控制項樣式。 套用下面 **「備註」** 部份中列出的視窗樣式的群組,並編輯 Windows SDK 中描述的[控制元件樣式](/windows/win32/Controls/edit-control-styles)。

*矩形*<br/>
指定編輯控制項大小和位置。 可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/windows/win32/api/windef/ns-windef-rect)結構。

*pparentwnd*<br/>
指定編輯控制項的父視窗(通常是[CDialog)。](../../mfc/reference/cdialog-class.md) 它不得為 NULL。

*nID*<br/>
指定編輯控制項的識別碼。

### <a name="return-value"></a>傳回值

初始化成功時非零;否則,0。

### <a name="remarks"></a>備註

分兩步`CRichEditCtrl`構造物件。 首先,調用[CRichEditCtrl](#cricheditctrl)構造函數`Create`,然後調用,這將創建 Windows 編輯控件`CRichEditCtrl`並將其附加到 物件。

使用此函數創建豐富的編輯控制項時,首先必須載入必要的公共控制程式庫。 要載入庫,請致電全域函數[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit),後者又初始化了公共控制項庫。 在此過程中,您只需要`AfxInitRichEdit`調用一次。

執行`Create`時,Windows[WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)會將WM_NCCREATE、WM_NCCALCSIZE、WM_CREATE和[WM_GETMINMAXINFO消息發送到](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)編輯[WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)[WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)控制項。

默認情況下,這些消息由`CWnd`基類中的[OnNcCreate、OnNcCalcsize、OnCreate](../../mfc/reference/cwnd-class.md#onnccreate)和[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)成員[OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)[OnCreate](../../mfc/reference/cwnd-class.md#oncreate)函數處理。 要擴展預設消息處理,從`CRichEditCtrl`派生類,向新類添加消息映射,並重寫上述消息處理程式成員函數。 例如`OnCreate`,重寫以執行新類所需的初始化。

將以下[視窗樣式](../../mfc/reference/styles-used-by-mfc.md#window-styles)應用於編輯控制項。

- WS_CHILD永遠。

- WS_VISIBLE通常。

- WS_DISABLED很少。

- WS_GROUP組控件。

- WS_TABSTOP在製表順序中包括編輯控制件。

有關視窗樣式的詳細資訊,請參閱在 Windows SDK 中[建立視窗](/windows/win32/api/winuser/nf-winuser-createwindoww)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

## <a name="cricheditctrlcreateex"></a><a name="createex"></a>克里希編輯::建立Ex

創建控制項(子視窗),並將其與`CRichEditCtrl`物件關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要創建的控制項的擴充樣式。 有關擴展 Windows 樣式的清單,請參閱 Windows SDK 中[創建 WindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定編輯控制項樣式。 應用[「創建](#create)和[編輯控制件樣式](/windows/win32/Controls/edit-control-styles)**的備註**」部分中列出的視窗樣式的組合,在 Windows SDK 中介紹。

*矩形*<br/>
對[RECT](/previous-versions/dd162897\(v=vs.85\))結構的引用,描述要創建的視窗的大小和位置,在*pParentWnd*的用戶端座標中。

*pparentwnd*<br/>
指向控件的父視窗的指標。

*nID*<br/>
控制項的子視窗 ID。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx``Create`而不是應用擴展的 Windows 樣式,由 Windows 擴充樣式前言**WS_EX_** 指定。

## <a name="cricheditctrlcricheditctrl"></a><a name="cricheditctrl"></a>克里希編輯::克里希編輯

建構 `CRichEditCtrl` 物件。

```
CRichEditCtrl();
```

### <a name="remarks"></a>備註

使用[「創建」](#create)建構 Windows 豐富的編輯控制項。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

## <a name="cricheditctrlcut"></a><a name="cut"></a>克里希編輯::切

刪除(剪切)富編輯控制項中的當前選擇(如果有),並將刪除的文本複製到剪貼簿。

```
void Cut();
```

### <a name="remarks"></a>備註

可以通過調用[復原](#undo)成員`Cut`函數撤銷執行的刪除。

要刪除當前選擇而不將刪除的文本放入剪貼簿,請呼叫[「清除](#clear)」成員函數。

有關詳細資訊,請參閱 Windows SDK 中的[WM_CUT。](/windows/win32/dataxchg/wm-cut)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

## <a name="cricheditctrldisplayband"></a><a name="displayband"></a>克里希編輯::D播放樂隊

顯示富編輯控制件(文字和 OLE 項)的部分內容,如之前由[FormatRange](#formatrange)格式。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>參數

*p 顯示雷ct*<br/>
指向[RECT](/windows/win32/api/windef/ns-windef-rect)或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件的指標,指定要顯示文本的設備區域。

### <a name="return-value"></a>傳回值

如果格式化文本的顯示成功,則非零,否則為 0。

### <a name="remarks"></a>備註

文字和 OLE 項被剪切到指標*pDisplayRect*指定的區域。

有關詳細資訊,請參閱 Windows SDK 中的[EM_DISPLAYBAND。](/windows/win32/Controls/em-displayband)

### <a name="example"></a>範例

  請參考[CRichEditCtrl 的範例::格式範圍](#formatrange)。

## <a name="cricheditctrlemptyundobuffer"></a><a name="emptyundobuffer"></a>克里希編輯::空UndoBuffer

重置(清除)此富編輯控制件的撤消標誌。

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>備註

控制項現在將無法撤消上次編輯操作。 每當可以撤銷富編輯控件中的操作時,都會設置撤消標誌。

每當調用[CWnd](../../mfc/reference/cwnd-class.md)成員函數[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)時,撤銷標誌都會自動清除。

有關詳細資訊,請參閱 Windows SDK 中的[EM_EMPTYUNDOBUFFER。](/windows/win32/Controls/em-emptyundobuffer)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

## <a name="cricheditctrlfindtext"></a><a name="findtext"></a>克里希編輯::尋找文字

尋找富編輯控制件中的文字。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>參數

*dwFlags*<br/>
有關可能值的清單,請參閱 Windows SDK 中[EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex)中的*wParam。*

*pFindText*<br/>
指向[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)結構的指標,提供搜索的參數,並返回找到匹配的範圍。

### <a name="return-value"></a>傳回值

下一個匹配項的零基字元位置;- 1,如果沒有更多的匹配。

### <a name="remarks"></a>備註

通過在`FINDTEXTEX`結構中的[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構中設置正確的範圍參數,可以向上或向下搜索。

有關詳細資訊,請參閱[EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex) Windows SDK 中的消息和[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

## <a name="cricheditctrlfindwordbreak"></a><a name="findwordbreak"></a>克里希編輯::尋找WordBreak

在*nStart*指定的位置之前或之後查找下一個單詞中斷。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>參數

*n代碼*<br/>
指示要執行的操作。 有關可能值的清單,請參閱 Windows SDK 中EM_FINDWORDBREAK參數*代碼*的說明。

*N 開始*<br/>
從中開始的零基字元位置。

### <a name="return-value"></a>傳回值

基於參數*nCode*。 有關詳細資訊,請參閱 Windows SDK 中的[EM_FINDWORDBREAK。](/windows/win32/Controls/em-findwordbreak)

### <a name="remarks"></a>備註

您可以使用此成員函數檢索有關給定位置的字元的資訊。

## <a name="cricheditctrlformatrange"></a><a name="formatrange"></a>克里希編輯::格式範圍

在特定設備的豐富編輯控制項中設置一系列文本。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>參數

*普夫爾*<br/>
指向包含輸出設備資訊的[FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange)結構的指標。 NULL 表示可以釋放富編輯控制項中的快取資訊。

*b 顯示*<br/>
指示是否應呈現文本。 如果 FALSE,則僅測量文本。

### <a name="return-value"></a>傳回值

適合區域的最後一個字元的索引加上一個字元。

### <a name="remarks"></a>備註

通常,此調用後跟對[DisplayBand](#displayband)的調用。

有關詳細資訊,請參閱[EM_FORMATRANGE](/windows/win32/Controls/em-formatrange) Windows SDK 中的消息和[FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

## <a name="cricheditctrlgetcharpos"></a><a name="getcharpos"></a>克里希編輯::獲取查波斯

獲取此`CRichEditCtrl`物件中給定字元的位置(左上角)。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>參數

*l查爾*<br/>
字元的零基索引。

### <a name="return-value"></a>傳回值

*由 lChar*指定的字元的左上角的位置。

### <a name="remarks"></a>備註

該字元通過給出其零基索引值來指定。 如果*lChar*大`CRichEditCtrl`於此 物件中最後一個字元的索引,則返回值指定`CRichEditCtrl`剛剛經過此 物件中最後一個字元的字元位置的座標。

有關詳細資訊,請參閱 Windows SDK 中的[EM_POSFROMCHAR。](/windows/win32/Controls/em-posfromchar)

## <a name="cricheditctrlgetdefaultcharformat"></a><a name="getdefaultcharformat"></a>克里希編輯::取得預設字元格式

取得此`CRichEditCtrl`物件的預設字元格式屬性。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中,指向包含預設字元`CHARFORMAT`格式屬性的結構的指標。

在第二個版本中,指向`CHARFORMAT2`結構的指標(該結構是結構的 Rich Edit 2.0`CHARFORMAT`擴展名)包含預設字元格式屬性。

### <a name="return-value"></a>傳回值

cf`dwMask`資料*cf*成員 。它指定了預設字元格式屬性。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK`CHARFORMAT``CHARFORMAT2`中EM_GETCHARFORMAT 消息以及和結構。

### <a name="example"></a>範例

  請參考[設定 DefaultCharFormat 的範例](#setdefaultcharformat)。

## <a name="cricheditctrlgeteventmask"></a><a name="geteventmask"></a>克里希編輯::取得事件遮罩

獲取此`CRichEditCtrl`物件的事件掩碼。

```
long GetEventMask() const;
```

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件的事件遮罩。

### <a name="remarks"></a>備註

事件遮罩指定`CRichEditCtrl`物件傳送到其父視窗的通知訊息。

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETEVENTMASK。](/windows/win32/Controls/em-geteventmask)

### <a name="example"></a>範例

  請參閱[CRichEditCtrl 的範例::SetEventMask](#seteventmask)。

## <a name="cricheditctrlgetfirstvisibleline"></a><a name="getfirstvisibleline"></a>克里希編輯::獲取第一可見線

確定此`CRichEditCtrl`物件中最上面可見的線。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件中最上可見線的基於零的索引。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETFIRSTVISIBLELINE。](/windows/win32/Controls/em-getfirstvisibleline)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

## <a name="cricheditctrlgetiricheditole"></a><a name="getiricheditole"></a>克里希編輯::獲取IRichEditOle

訪問此`IRichEditOle``CRichEditCtrl`對象的介面。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>傳回值

指向[IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole)介面的指標,該介面可用於`CRichEditCtrl`訪問 此物件的 OLE 功能;如果介面無法訪問,則為 NULL。

### <a name="remarks"></a>備註

使用此介面可以存取`CRichEditCtrl`此物件的OLE功能。

有關詳細資訊,請參閱[EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface)消息和[IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole)介面在 Windows SDK 中。

## <a name="cricheditctrlgetlimittext"></a><a name="getlimittext"></a>克里希編輯::獲取限制文字

獲取此`CRichEditCtrl`物件的文本限制。

```
long GetLimitText() const;
```

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件的當前文本限制(以位元組為單位)。

### <a name="remarks"></a>備註

文本限制是文本的最大量,以位元組為單位,豐富的編輯控制項可以接受。

有關詳細資訊,請參閱在 Windows SDK 中的[EM_GETLIMITTEXT。](/windows/win32/Controls/em-getlimittext)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

## <a name="cricheditctrlgetline"></a><a name="getline"></a>克里希編輯::獲取線

從此`CRichEditCtrl`物件檢索一行文本。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要檢索的行的基於零的索引。

*lpszBuffer*<br/>
指向緩衝區以接收文本。 緩衝區的第一個單詞必須指定可複製到緩衝區的最大位元組數。

*nMaxLength*<br/>
可以複製到*lpszBuffer*的最大字元數。 第二種形式將`GetLine`此值放入*lpszBuffer*指定的緩衝區的第一個單詞中。

### <a name="return-value"></a>傳回值

複製到*lpszBuffer*的字元數。

### <a name="remarks"></a>備註

複製的行不包含終止空字元。

> [!NOTE]
> 由於緩衝區的第一個單詞存儲要複製的字元數,因此請確保緩衝區至少為 4 位元組長。

有關詳細資訊,請參閱 windows SDK 中的[EM_GETLINE。](/windows/win32/Controls/em-getline)

### <a name="example"></a>範例

  請參閱[GetLineCount](#getlinecount)的範例。

## <a name="cricheditctrlgetlinecount"></a><a name="getlinecount"></a>克里希編輯::獲取線計數

檢索物件中的`CRichEditCtrl`行數。

```
int GetLineCount() const;
```

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件中的行數。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETLINECOUNT。](/windows/win32/Controls/em-getlinecount)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

## <a name="cricheditctrlgetmodify"></a><a name="getmodify"></a>克里希編輯::獲取修改

確定此`CRichEditCtrl`物件的內容是否已被修改。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>傳回值

如果此`CRichEditCtrl`物件中的文本已修改,則非零;否則 0。

### <a name="remarks"></a>備註

Windows 維護一個內部標誌,指示富編輯控件的內容是否已更改。 首次創建編輯控制件時,將清除此標誌,也可以通過調用[SetModify](#setmodify)成員函數清除。

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETMODIFY。](/windows/win32/Controls/em-getmodify)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

## <a name="cricheditctrlgetoptions"></a><a name="getoptions"></a>克里希編輯::取得選項

檢索當前為富編輯控件設置的選項。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>傳回值

當前選項標誌值的組合。 有關這些值的清單,請參閱[EM_SETOPTIONS](/windows/win32/Controls/em-setoptions)消息中的*fOptions*參數,如 Windows SDK 中所述。

## <a name="cricheditctrlgetparaformat"></a><a name="getparaformat"></a>克里希編輯::取得帕拉格式

取得目前選擇的段落格式屬性。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>參數

*普夫*<br/>
在第一個版本中,指向[PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)結構的指標,用於保存當前選擇的段落格式屬性。

在第二個版本中,指向[PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)結構的指標(它是結構的富編輯 2.0`PARAFORMAT`擴展名)包含預設字元格式屬性。

### <a name="return-value"></a>傳回值

pf`dwMask`的*pf*資料成員 。 它指定在當前選擇過程中一致的段落格式屬性。

### <a name="remarks"></a>備註

如果選擇了多個段落 *,pf*將接收第一個選定段落的屬性。 返回值指定在整個選擇過程中一致的屬性。

有關詳細資訊,請參閱[EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat)消息以及`PARAFORMAT``PARAFORMAT2`Windows SDK 中的和結構。

### <a name="example"></a>範例

  請參考[CRichEditCtrl 的範例::SetParaFormat](#setparaformat)。

## <a name="cricheditctrlgetpunctuation"></a><a name="getpunctuation"></a>克里希編輯::取得標點

取得富編輯控制項中的當前標點符號字元。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>參數

*fType*<br/>
標點類型標誌,如 Windows SDK 中[EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation) *fType*參數中所述。

*lpPunc*<br/>
指向[標點結構](/windows/win32/api/richedit/ns-richedit-punctuation)的指標,如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果操作成功,則非零,否則為 0。

### <a name="remarks"></a>備註

此成員函數僅提供操作系統的亞洲語言版本。

## <a name="cricheditctrlgetrect"></a><a name="getrect"></a>克里希編輯::獲取雷ct

檢索此`CRichEditCtrl`物件的格式矩形。

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指向[RECT](/windows/win32/api/windef/ns-windef-rect)的指標以`CRichEditCtrl`接收此 物件的格式矩形。

### <a name="remarks"></a>備註

格式矩形是文字的邊界矩形。 此值與`CRichEditCtrl`物件的大小無關。

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETRECT。](/windows/win32/Controls/em-getrect)

### <a name="example"></a>範例

  請參閱[「限制文本」](#limittext)的範例。

## <a name="cricheditctrlgetredoname"></a><a name="getredoname"></a>克里希編輯::取得重名稱

檢索重做佇列中下一個可用操作的類型(如果有)。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>傳回值

如果成功,`GetRedoName`則返回[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)枚舉類型,指示控制項重做佇列中下一個操作的類型。 如果重做隊列為空,或者佇列中的重做操作為未知類型,`GetRedoName`則返回 0。

### <a name="remarks"></a>備註

可以復原或重新做的操作類型包括鍵入、刪除、拖放、剪切和貼上操作。 此資訊對於為撤銷和重做操作提供擴展使用者介面的應用程式非常有用,例如可重執行的操作的下拉清單框。

## <a name="cricheditctrlgetsel"></a><a name="getsel"></a>克里希編輯::GetSel

檢索此`CRichEditCtrl`物件中當前選擇的邊界。

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>參數

*鉻*<br/>
引用[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構以接收當前選擇的邊界。

*nStartChar*<br/>
當前所選內容中第一個字元的從零為基礎的索引。

*nEndChar*<br/>
當前所選內容中最後一個字元的零基索引。

### <a name="remarks"></a>備註

此函數的兩種形式提供了獲取所選內容邊界的替代方法。 這些表格的簡要說明如下:

- **GetSel(** `cr` **)** 此表單使用具有`CHARRANGE`其`cpMin`和`cpMax`成員的結構來返回邊界。

- **GetSel(** `nStartChar` **,** `nEndChar` **)** 此表單傳回參數*nStartChar*和*nEndChar*中的邊界。

如果開頭`cpMin`( 或*nStartChar*)`cpMax`為 0,並且結束 ( 或*nEndChar*) 為 - 1, 則選擇包括所有內容。

有關詳細資訊,請參閱[EM_EXGETSEL](/windows/win32/Controls/em-exgetsel) Windows SDK 中的消息和[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

## <a name="cricheditctrlgetselectioncharformat"></a><a name="getselectioncharformat"></a>克里希編輯::取得選擇字元格式

取得目前選取內容的字元格式屬性。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中,指向[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標以接收當前選擇的字元格式屬性。

在第二個版本中,指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標,該結構是結構的富編輯 2.0`CHARFORMAT`擴展, 用於接收當前選擇的字元格式屬性。

### <a name="return-value"></a>傳回值

cf`dwMask`資料*cf*成員 。它指定在當前選擇過程中一致的字元格式屬性。

### <a name="remarks"></a>備註

*cf*參數接收當前選擇中第一個字元的屬性。 返回值指定在整個選擇過程中一致的屬性。

有關詳細資訊,請參閱[Windows](/windows/win32/Controls/em-getcharformat) SDK`CHARFORMAT``CHARFORMAT2`中EM_GETCHARFORMAT 消息和和結構。

### <a name="example"></a>範例

  請參閱[設定選擇字元格式](#setselectioncharformat)的範例。

## <a name="cricheditctrlgetselectiontype"></a><a name="getselectiontype"></a>克里希編輯::取得選擇類型

確定此`CRichEditCtrl`物件中的選擇類型。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>傳回值

指示當前所選內容的標誌。 以下旗標的組合:

- SEL_EMPTY 表示沒有當前選擇。

- SEL_TEXT 指示當前所選內容包含文本。

- SEL_OBJECT指示當前所選內容至少包含一個 OLE 項。

- SEL_MULTICHAR 指示當前所選內容包含多個文字字元。

- SEL_MULTIOBJECT指示當前選擇包含多個 OLE 物件。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_SELECTIONTYPE。](/windows/win32/Controls/em-selectiontype)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

## <a name="cricheditctrlgetseltext"></a><a name="getseltext"></a>克里希編輯::獲取塞爾文字

從此`CRichEditCtrl`物件的當前選擇中檢索文字。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>參數

*lpBuf*<br/>
指向緩衝區以接收當前所選內容中的文本。

### <a name="return-value"></a>傳回值

取決於表單:

- **取得塞爾文字(** `lpBuf` **)** 複製到*lpBuf*的字元數,不包括 null 終止。

- **取得塞爾文字( )** 包含目前選擇的字串。

### <a name="remarks"></a>備註

如果使用第一個窗體**GetSelText(),**`lpBuf`**)** 則必須確保緩衝區足夠大,足以容納它將接收的文本。 呼叫[GetSel](#getsel)以確定目前選取內容中的字元數。

有關詳細資訊,請參閱 Windows SDK 中的[EM_GETSELTEXT。](/windows/win32/Controls/em-getseltext)

### <a name="example"></a>範例

  請參考[CRichEditCtrl 的範例::取得選擇類型](#getselectiontype)。

## <a name="cricheditctrlgettextlength"></a><a name="gettextlength"></a>克里希編輯::獲取文本長度

檢索此`CRichEditCtrl`物件中文本的長度(以字元形式),不包括終止空字元。

```
long GetTextLength() const;
```

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件中的文字長度。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[WM_GETTEXTLENGTH。](/windows/win32/winmsg/wm-gettextlength)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

## <a name="cricheditctrlgettextlengthex"></a><a name="gettextlengthex"></a>克里希編輯::獲取文本長度Ex

計算富編輯控制件中的文本長度。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>參數

*dwFlags*<br/>
指定用於確定文本長度的方法的值。 此成員可以是 Windows SDK 中描述的[GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex)標誌成員中列出的一個或多個值。

*u代碼頁*<br/>
用於轉換的代碼頁(CP_ACP用於 ANSI 代碼頁,Unicode 為 1200)。

### <a name="return-value"></a>傳回值

編輯控制項中的字元或位元組數。 如果在*dwFlags*中設置了不相容標誌,則此成員函數將返回E_INVALIDARG。

### <a name="remarks"></a>備註

`GetTextLengthEx`提供了確定文本長度的其他方法。 它支援富編輯 2.0 功能。 有關詳細資訊,請參閱有關 Windows SDK 中的[豐富編輯控制件](/windows/win32/Controls/about-rich-edit-controls)的資訊。

## <a name="cricheditctrlgettextmode"></a><a name="gettextmode"></a>克里希編輯::取得文字模式

檢索當前文本模式並撤銷富編輯控制件的級別。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>傳回值

一組來自[TEXTMODE](/windows/win32/api/richedit/ne-richedit-textmode)枚舉類型的位標誌,如 Windows SDK 中所述。 這些標誌指示控制項的當前文本模式和復原等級。

## <a name="cricheditctrlgettextrange"></a><a name="gettextrange"></a>克里希編輯::獲取文本範圍

獲取指定的字元範圍。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>參數

*n第一*<br/>
緊鄰範圍中第一個字元的字元位置索引。

*n 上次*<br/>
緊隨範圍中最後一個字元之後的字元位置。

*refString*<br/>
對將接收文本的[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的引用。

### <a name="return-value"></a>傳回值

複製的字元數,不包括終止空字元。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱在 Windows SDK 中[EM_GETTEXTRANGE。](/windows/win32/Controls/em-gettextrange)

`GetTextRange`支援"豐富編輯 2.0"功能。 有關詳細資訊,請參閱有關 Windows SDK 中的[豐富編輯控制件](/windows/win32/Controls/about-rich-edit-controls)的資訊。

## <a name="cricheditctrlgetundoname"></a><a name="getundoname"></a>克里希編輯::獲取Undo名稱

檢索撤消佇列中下一個可用操作的類型(如果有)。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>傳回值

如果復原操作位於控制項的復原佇列中,`GetUndoName`則傳回[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)枚舉類型,指示佇列中下一個操作的類型。 如果撤銷隊列為空,或者佇列中的撤銷操作為未知類型,則`GetUndoName`返回 0。

### <a name="remarks"></a>備註

可以復原或重新做的操作類型包括鍵入、刪除、拖放、剪切和貼上操作。 此資訊對於為撤銷和重做操作提供擴展使用者介面的應用程式非常有用,例如可以撤銷的操作的下拉清單框。

## <a name="cricheditctrlgetwordwrapmode"></a><a name="getwordwrapmode"></a>克里希編輯Ctrl::取得WordWrap模式

檢索富編輯控制件的當前換字和換字選項。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>傳回值

當前換字和斷字選項。 這些選項在 Windows SDK 中[EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode)中介紹。

### <a name="remarks"></a>備註

此成員函數僅適用於操作系統的亞洲語言版本。

## <a name="cricheditctrlhideselection"></a><a name="hideselection"></a>克里希編輯::隱藏選擇

更改所選內容的可見性。

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>參數

*bHide*<br/>
指示選區是應顯示還是隱藏,TRUE 以隱藏所選內容。

*bPerm*<br/>
指示所選內容的可見性此更改是否為永久性的。

### <a name="remarks"></a>備註

當*bPerm*為 TRUE 時`CRichEditCtrl`,它將更改 此物件的ECO_NOHIDESEL選項。 關於這個選項的簡要說明,請參閱[設定選項](#setoptions)。 可以使用此函數設置此`CRichEditCtrl`物件的所有選項。

有關詳細資訊,請參閱 Windows SDK 中的[EM_HIDESELECTION。](/windows/win32/Controls/em-hideselection)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

## <a name="cricheditctrllimittext"></a><a name="limittext"></a>克里希編輯::限制文字

限制用戶可以在編輯控制項中輸入的文本長度。

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>參數

*n查理斯*<br/>
指定使用者可以輸入的文本的長度(以位元組為單位)。 如果此參數為 0(預設值),則文本長度設置為 64K 位元組。

### <a name="remarks"></a>備註

變更文字限制僅限制使用者可以輸入的文本。 它對編輯控制件中已有的任何文本沒有影響,也不會影響 在`CWnd`中[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)成員函數複製到編輯控制項的文本的長度。 如果應用程式使用 函`SetWindowText`數將更多的文本放入編輯控制項中,而不是調用`LimitText`中 指定的文本,則使用者可以刪除編輯控制項中的任何文本。 但是,文本限制將阻止使用者用新文本替換現有文本,除非刪除當前選擇會導致文本低於文本限制。

> [!NOTE]
> 對於文本限制,每個 OLE 項都計為單個字元。

有關詳細資訊,請參閱 Windows SDK 中的[EM_EXLIMITTEXT。](/windows/win32/Controls/em-exlimittext)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

## <a name="cricheditctrllinefromchar"></a><a name="linefromchar"></a>克里希編輯::線從查爾

檢索包含指定字元索引的行號的行號。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
在編輯控制項的文本中包含所需字元的零基索引值,或包含 -1。 如果*nIndex*為 -1,則指定當前線,即包含 caret 的行。

### <a name="return-value"></a>傳回值

包含*nIndex*指定的字元索引的行的零基行號。 如果*nIndex*為 -1,則傳回包含所選內容的第一個字元的行數。 如果沒有選擇,則返回當前行號。

### <a name="remarks"></a>備註

字元索引是從富編輯控件開始的字元數。 對於字元計數,OLE 項計為單個字元。

有關詳細資訊,請參閱在 Windows SDK 中的[EM_EXLINEFROMCHAR。](/windows/win32/Controls/em-exlinefromchar)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

## <a name="cricheditctrllineindex"></a><a name="lineindex"></a>克里希編輯::線索引

檢索此`CRichEditCtrl`物件中的行的字元索引。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>參數

*n 線*<br/>
在編輯控制項的文本中包含所需行的索引值,或包含 -1。 如果*nLine*為 -1,則指定當前線,即包含 caret 的行。

### <a name="return-value"></a>傳回值

如果指定的行號大於編輯控制項中的行數,則以*nLine*或 -1 指定的行的字元索引。

### <a name="remarks"></a>備註

字元索引是從富編輯控件的開頭到指定行的字元數。

有關詳細資訊,請參閱 Windows SDK 中的[EM_LINEINDEX。](/windows/win32/controls/em-lineindex)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

## <a name="cricheditctrllinelength"></a><a name="linelength"></a>克里希編輯::線長

檢索富編輯控件中的行的長度。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>參數

*n 線*<br/>
指定要檢索長度的行中字元的字元索引。 如果此參數為 -1,則返回當前行的長度(包含加斯特的行),不包括行內任何選定文本的長度。 當`LineLength`為單行編輯控件調用時,將忽略此參數。

### <a name="return-value"></a>傳回值

當`LineLength`調用多行編輯控件時,返回值是*nLine*指定的行的長度(在 TCHAR 中)。  它不包括行尾的回車字元。 當`LineLength`調用單行編輯控件時,返回值是編輯控制件中文本的長度(在 TCHAR 中)。 如果 nLine 大於控制項中的字元數,則返回值為零。

### <a name="remarks"></a>備註

使用[LineIndex](#lineindex)成員函數檢`CRichEditCtrl`索此 物件中給定行號的字元索引。

有關詳細資訊,請參閱 Windows SDK 中的[EM_LINELENGTH。](/windows/win32/Controls/em-linelength)

### <a name="example"></a>範例

  請參閱[LineIndex](#lineindex)的範例。

## <a name="cricheditctrllinescroll"></a><a name="linescroll"></a>克里希編輯::線羅

捲動多行編輯控制項的文字。

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>參數

*n線*<br/>
指定要垂直滾動的行數。

*n查理斯*<br/>
指定要水平滾動的字元位置數。 如果富編輯控制件具有ES_RIGHT或ES_CENTER樣式,則忽略此值。 [編輯樣式](../../mfc/reference/styles-used-by-mfc.md#edit-styles)在[「創建」](#create)中指定。

### <a name="remarks"></a>備註

編輯控制項不會垂直捲動超過編輯控制項中的最後一行文本。 如果當前行加上*nLines*指定的行數超過編輯控制件中的行總數,則調整該值,以便編輯控制項的最後一行滾動到編輯控制視窗的頂部。

`LineScroll`可用於水準滾動超過任何行的最後一個字元。

有關詳細資訊,請參閱 Windows SDK 中的[EM_LINESCROLL。](/windows/win32/Controls/em-linescroll)

### <a name="example"></a>範例

  請參考[第一可見線的範例](#getfirstvisibleline)。

## <a name="cricheditctrlpaste"></a><a name="paste"></a>克里希編輯::Paste

將剪輯簿中的資料插入`CRichEditCtrl`插入點(插入器的位置)

```
void Paste();
```

### <a name="remarks"></a>備註

僅當剪貼簿以識別格式包含數據時,才會插入數據。

有關詳細資訊,請參閱 Windows SDK 中的[WM_PASTE。](/windows/win32/dataxchg/wm-paste)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

## <a name="cricheditctrlpastespecial"></a><a name="pastespecial"></a>克里希編輯::P特別

將特定剪貼簿格式的數據貼上此`CRichEditCtrl`物件中。

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>參數

*nClip 格式*<br/>
要貼上到此`CRichEditCtrl`物件的剪貼簿格式。

*dvAspect*<br/>
要從剪貼簿檢索數據的設備方面。

*hMF*<br/>
處理包含要粘貼的物件的標誌性檢視的元檔。

### <a name="remarks"></a>備註

新材料插入插入點,即插入點的位置。

有關詳細資訊,請參閱 Windows SDK 中的[EM_PASTESPECIAL。](/windows/win32/Controls/em-pastespecial)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

## <a name="cricheditctrlposfromchar"></a><a name="posfromchar"></a>克里希編輯::P從查爾

檢索編輯控制項中指定字元的工作區座標。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>參數

*n查爾*<br/>
字元的零基索引。

### <a name="return-value"></a>傳回值

字元的位置(x,y)。 對於單行編輯控件,y 座標始終為零。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_POSFROMCHAR。](/windows/win32/Controls/em-posfromchar)

## <a name="cricheditctrlredo"></a><a name="redo"></a>克里希編輯::重做

重做控件重做佇列中的下一個操作。

```
BOOL Redo();
```

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

有關詳細資訊,請參閱 Windows SDK 中的[EM_REDO。](/windows/win32/Controls/em-redo)

## <a name="cricheditctrlreplacesel"></a><a name="replacesel"></a>克里希編輯::替換塞爾

將此`CRichEditCtrl`物件的目前選擇替換為指定的文本。

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>參數

*lpsz 新文字*<br/>
包含取代文字的 null 連接字串的指標。

*bCanUndo*<br/>
要指定可以撤銷此函數,請為此參數的值設置為 TRUE。 預設值為 FALSE。

### <a name="remarks"></a>備註

要取代此`CRichEditCtrl`物件中的所有文字,請使用[CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。

如果沒有當前選擇,則替換文本將插入插入點,即當前插入位置。

此函數將使用現有字元格式格式化插入的文本。 替換整個文字範圍(在調用`SetSel``ReplaceSel`前調用 (0,-1))時,段落字元的末尾保留前一段的格式,該格式由新插入的文本繼承。

有關詳細資訊,請參閱 Windows SDK 中的[EM_REPLACESEL。](/windows/win32/Controls/em-replacesel)

### <a name="example"></a>範例

  請參閱[LineIndex](#lineindex)的範例。

## <a name="cricheditctrlrequestresize"></a><a name="requestresize"></a>克里希編輯::請求調整

強制此`CRichEditCtrl`物件向其父視窗發送EN_REQUESTRESIZE通知消息。

```
void RequestResize();
```

### <a name="remarks"></a>備註

此函數在[CWnd:onSize](../../mfc/reference/cwnd-class.md#onsize)`CRichEditCtrl`處理無 底對象期間非常有用。

有關詳細資訊,請參閱[EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize)消息和Windows SDK中[有關豐富編輯控制項](/windows/win32/Controls/about-rich-edit-controls)的無**底豐富編輯控制項**部分。

## <a name="cricheditctrlsetautourldetect"></a><a name="setautourldetect"></a>克里希編輯Ctrl:設定自動 URL偵測

設置豐富的編輯控制項以自動檢測 URL。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
指定控制項是否設定為自動檢測 URL。 如果為 TRUE,則啟用它。 如果 FALSE,則將其禁用。

### <a name="return-value"></a>傳回值

如果成功,則為零,否則為非零。 例如,由於記憶體不足,消息可能會失敗。

### <a name="remarks"></a>備註

如果啟用,富編輯控件將掃描文本以確定它是否與標準 URL 格式匹配。 有關這些 URL 格式的清單,請參閱在 Windows SDK 中[EM_AUTOURLDETECT。](/windows/win32/Controls/em-autourldetect)

> [!NOTE]
> 如果編輯控制項`SetAutoURLDetect`對 URL 以外的文字使用CFE_LINK效果,請不要設定為 TRUE。 `SetAutoURLDetect`啟用 URL 的此效果,並關閉所有其他文字。 有關CFE_LINK效果的詳細資訊,請參閱[EN_LINK。](/windows/win32/Controls/en-link)

## <a name="cricheditctrlsetbackgroundcolor"></a><a name="setbackgroundcolor"></a>克里希編輯::設定背景顏色

設定此`CRichEditCtrl`物件的背景顏色。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>參數

*bSysColor*<br/>
指示是否應將背景顏色設置為系統值。 如果此值為 TRUE,則*忽略 cr。*

*鉻*<br/>
請求的背景顏色。 僅在*bSysColor*為 FALSE 時才使用。

### <a name="return-value"></a>傳回值

此`CRichEditCtrl`物件的上一個背景顏色。

### <a name="remarks"></a>備註

背景顏色可以設定為系統值或指定的[COLORREF](/windows/win32/gdi/colorref)值。

有關詳細資訊,請參閱[EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor) Windows SDK 中的消息和[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

## <a name="cricheditctrlsetdefaultcharformat"></a><a name="setdefaultcharformat"></a>克里希編輯::設定預設字元格式

設定此`CRichEditCtrl`物件中新文字的字元格式屬性。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中,指向包含新預設字元格式屬性的[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標。

在第二個版本中,指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標,該結構是結構的富編輯 2.0`CHARFORMAT`擴展, 包含預設字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

只有`dwMask`*cf*成員指定的屬性由此函數更改。

有關詳細資訊,請參閱[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)消息以及`CHARFORMAT``CHARFORMAT2`Windows SDK 中的和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

## <a name="cricheditctrlseteventmask"></a><a name="seteventmask"></a>克里希編輯::設定事件遮罩

設置此`CRichEditCtrl`物件的事件掩碼。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>參數

*dwEventMask*<br/>
此`CRichEditCtrl`物件的新事件遮罩。

### <a name="return-value"></a>傳回值

上一個事件掩碼。

### <a name="remarks"></a>備註

事件遮罩指定`CRichEditCtrl`物件傳送到其父視窗的通知訊息。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETEVENTMASK。](/windows/win32/Controls/em-seteventmask)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

## <a name="cricheditctrlsetmodify"></a><a name="setmodify"></a>克里希編輯::設定修改

設置或清除編輯控制件的修改標誌。

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*b 修改*<br/>
TRUE 的值表示文本已被修改,FALSE 值表示未修改。 默認情況下,將設置修改後的標誌。

### <a name="remarks"></a>備註

修改後的標誌指示編輯控制件中的文本是否已修改。 每當使用者更改文本時,都會自動設置它。 可以使用[GetModify](#getmodify)成員函數檢索其值。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETMODIFY。](/windows/win32/Controls/em-setmodify)

### <a name="example"></a>範例

  請參閱[GetModify](#getmodify)的範例。

## <a name="cricheditctrlsetolecallback"></a><a name="setolecallback"></a>克里希編輯::設定Ole回調

為此`CRichEditCtrl`物件提供`IRichEditOleCallback`用於訪問 OLE 相關資源和資訊的物件。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>參數

*pCallback*<br/>
指向此`CRichEditCtrl`物件將用於獲取 OLE 相關資源和資訊的[IRichEditOle 回檔](/windows/win32/api/richole/nn-richole-iricheditolecallback)物件的指標。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

此`CRichEditCtrl`物件將調用[IUnknown::AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref)以增加*pCallback*指定的 COM 物件的使用計數。

有關詳細資訊,請參閱[EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback)訊息和[IRichEditOle Callback](/windows/win32/api/richole/nn-richole-iricheditolecallback)介面在 Windows SDK 中。

## <a name="cricheditctrlsetoptions"></a><a name="setoptions"></a>克里希編輯::設定選項

設置此`CRichEditCtrl`物件的選項。

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>參數

*wOp*<br/>
指示操作的類型。 下列其中一個值：

- ECOOP_SET 將選項設定為*dwFlags*指定的選項。

- ECOOP_OR將當前選項與*dwFlags*指定的選項合併。

- ECOOP_AND 只保留*dwFlags*也指定的當前選項。

- ECOOP_XOR邏輯上獨佔或當前選項與*dwFlags*指定的選項。

*dwFlags*<br/>
豐富的編輯選項。 標誌值列在「備註」 部分。

### <a name="remarks"></a>備註

這些選項可以是以下值的組合:

- ECO_AUTOWORDSELECTION按兩下自動單詞選擇。

- ECO_AUTOVSCROLL當使用者在行尾鍵入字元時,自動將文本向右滾動 10 個字元。 當使用者按下 ENTER 鍵時,控制項將所有文本滾動回位置零。

- ECO_AUTOHSCROLL當使用者按下最後一行的 ENTER 鍵時,自動向上滾動一頁文本。

- ECO_NOHIDESEL否定編輯控制件的默認行為。 當控件失去輸入焦點時,默認行為將隱藏所選內容,並在控件接收輸入焦點時顯示所選內容。 如果指定ECO_NOHIDESEL,則所選文本將反轉,即使控件沒有焦點也是如此。

- ECO_READONLY 防止使用者在編輯控制項中鍵入或編輯文本。

- ECO_WANTRETURN 指定當使用者在對話方塊中將文本輸入多行富編輯控制件時按 ENTER 鍵時插入回車符。 如果不指定此樣式,則按 ENTER 鍵會向富編輯控制件的父視窗發送命令,該視窗類似於按一下父視窗的預設按鈕(例如,對話方塊中的"確定"按鈕)。 此樣式對單行編輯控件沒有影響。

- ECO_SAVESEL當控件失去焦點時保留選擇。 默認情況下,當控件重新獲得焦點時,將選擇控制項的整個內容。

- ECO_VERTICAL以垂直方向繪製文本和物件。 僅適用於亞洲語言。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETOPTIONS。](/windows/win32/Controls/em-setoptions)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

## <a name="cricheditctrlsetparaformat"></a><a name="setparaformat"></a>克里希編輯::SetParaFormat

設定此`CRichEditCtrl`物件中當前選擇的段落格式屬性。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>參數

*普夫*<br/>
在第一個版本中,指向包含新預設段落格式屬性的[PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)結構的指標。

在第二個版本中,指向[PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)結構的指標(它是結構的富編輯 2.0`PARAFORMAT`擴展名)包含預設字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

只有`dwMask`*pf*成員指定的屬性由此函數更改。

有關詳細資訊,請參閱[windows](/windows/win32/Controls/em-setparaformat) SDK`PARAFORMAT``PARAFORMAT2`中EM_SETPARAFORMAT消息和和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

## <a name="cricheditctrlsetpunctuation"></a><a name="setpunctuation"></a>克里希編輯::設定標定

在豐富的編輯控制項中設置標點符號。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>參數

*fType*<br/>
標點符號。 有關可能值的清單,請參閱 Windows SDK 中[EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation) *fType*參數。

*lpPunc*<br/>
指向[標點結構](/windows/win32/api/richedit/ns-richedit-punctuation)的指標,如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果成功,則非零,否則為 0。

### <a name="remarks"></a>備註

此成員函數僅適用於操作系統的亞洲語言版本。

## <a name="cricheditctrlsetreadonly"></a><a name="setreadonly"></a>克里希編輯::僅集讀取

更改此`CRichEditCtrl`物件的ECO_READONLY選項。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>參數

*b 唯讀*<br/>
指示是否應唯`CRichEditCtrl`讀此物件。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

關於這個選項的簡要說明,請參閱[設定選項](#setoptions)。 可以使用此函數設置此`CRichEditCtrl`物件的所有選項。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETREADONLY。](/windows/win32/Controls/em-setreadonly)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

## <a name="cricheditctrlsetrect"></a><a name="setrect"></a>克里希編輯::塞特雷茨

設定此`CRichEditCtrl`物件的格式矩形。

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指向[RECT](/windows/win32/api/windef/ns-windef-rect)的指標,指示格式矩形的新邊界。

### <a name="remarks"></a>備註

格式矩形是文字的限制矩形。 限制矩形與富編輯控制件視窗的大小無關。 首次創建`CRichEditCtrl`此物件時,格式矩形的大小與視窗的工作區大小相同。 用於`SetRect`使格式矩形大於或小於富編輯視窗。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETRECT。](/windows/win32/Controls/em-setrect)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

## <a name="cricheditctrlsetsel"></a><a name="setsel"></a>克里希編輯::塞特塞爾

在此`CRichEditCtrl`物件中設置選擇。

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>參數

*nStartChar*<br/>
所選內容的第一個字元的從零為基礎的索引。

*nEndChar*<br/>
所選內容的最後一個字元的零基索引。

*鉻*<br/>
保存當前選擇邊界的[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構。

### <a name="remarks"></a>備註

此函數的兩種形式提供了設置所選內容邊界的替代方法。 這些表格的簡要說明如下:

- **塞塞爾(** `cr` **)** 此表單使用具有`CHARRANGE``cpMin`其`cpMax`和成員的結構來設置邊界。

- **SetSel(**`nStartChar`套裝 **,** `nEndChar` ( **)** 此表單使用參數*nStartChar*和*nEndChar*來設定邊界。

care 被放置在所選內容的末尾,由起始 (或*nStartChar)* 和結束 (`cpMax``cpMin`或*nEndChar)* 索引的較大指示。 此函數滾動 的內容`CRichEditCtrl`, 以便 caret 可見。

要選擇此`CRichEditCtrl`物件中的所有文本,請呼`SetSel`叫 起始索引為 0,結束索引為 - 1。

有關詳細資訊,請參閱 windows SDK 中[EM_EXSETSEL](/windows/win32/Controls/em-exsetsel)消息和[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構。

### <a name="example"></a>範例

  請參閱[GetSel](#getsel)的範例。

## <a name="cricheditctrlsetselectioncharformat"></a><a name="setselectioncharformat"></a>克里希編輯::設定選擇字元格式

設定此`CRichEditCtrl`物件中目前選擇區中文字的字元格式屬性。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中,指向[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標,其中包含當前選擇的新字元格式屬性。

在第二個版本中,指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標,該結構是結構的富編輯 2.0`CHARFORMAT`擴展, 包含當前選擇的新字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

只有`dwMask`*cf*成員指定的屬性由此函數更改。

有關詳細資訊,請參閱 Windows [EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat) SDK 中`CHARFORMAT`EM_SETCHARFORMAT`CHARFORMAT2`和和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

## <a name="cricheditctrlsettargetdevice"></a><a name="settargetdevice"></a>克里希編輯::設定目標設備

設定用於`CRichEditCtrl`此物件中 WYSIWYG(您所看到的是您得到的內容)格式的目標設備和線寬度。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>參數

*hDC*<br/>
處理新目標設備的設備上下文。

*L 線寬度*<br/>
用於格式化的線寬度。

*直流*<br/>
新目標設備的[CDC。](../../mfc/reference/cdc-class.md)

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

如果此函數成功,則豐富的編輯控件擁有作為參數傳遞的設備上下文。 在這種情況下,調用函數不應破壞設備上下文。

有關詳細資訊,請參閱 Windows SDK 中的[EM_SETTARGETDEVICE。](/windows/win32/Controls/em-settargetdevice)

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

## <a name="cricheditctrlsettextmode"></a><a name="settextmode"></a>克里希編輯::設定文字模式

設置文本模式或撤銷並重做富編輯控制項的重做級別。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>參數

*fMode*<br/>
指定控制項的文字模式和復原等級參數的新設定。 有關可能值的清單,請參閱 Windows SDK 中[EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode)模式參數。

### <a name="return-value"></a>傳回值

如果成功,則為零,否則為非零。

### <a name="remarks"></a>備註

有關文本模式的說明,請參閱 Windows SDK 中的EM_SETTEXTMODE。

如果控制式包含文本,則此成員函數將失敗。 要確保控制項為空,請發送帶有空字串[WM_SETTEXT](/windows/win32/winmsg/wm-settext)消息。

## <a name="cricheditctrlsetundolimit"></a><a name="setundolimit"></a>克里希編輯::設置Undo限制

設置可存儲在撤銷佇列中的最大操作數。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>參數

*n 限制*<br/>
指定可在復原佇列中儲存的最大操作數。 設置為零以禁用撤銷。

### <a name="return-value"></a>傳回值

富編輯控制件的新最大復原操作數。

### <a name="remarks"></a>備註

默認情況下,撤銷佇列中的最大操作數為 100。 如果增加此數位,則必須有足夠的可用記憶體來容納新數位。 為了更好的性能,將限制設置為盡可能小的值。

## <a name="cricheditctrlsetwordcharformat"></a><a name="setwordcharformat"></a>克里希編輯::SetWordCharFormat

設定此`CRichEditCtrl`物件中目前選取單字的字元格式屬性。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中,指向[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標,其中包含當前所選單詞的新字元格式屬性。

在第二個版本中,指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標,該結構是結構的富編輯 2.0`CHARFORMAT`擴展, 包含當前所選單詞的新字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功,則非零;否則,0。

### <a name="remarks"></a>備註

只有`dwMask`*cf*成員指定的屬性由此函數更改。

有關詳細資訊,請參閱[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)消息以及`CHARFORMAT``CHARFORMAT2`Windows SDK 中的和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

## <a name="cricheditctrlsetwordwrapmode"></a><a name="setwordwrapmode"></a>克里希編輯Ctrl::SetWordWrap模式

設置豐富的編輯控制項的換行和斷字選項。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>參數

*uFlags*<br/>
要設置的換行和換字的選項。 有關可能選項的清單,請參閱 Windows SDK 中的[EM_SETWORDWRAPMODE。](/windows/win32/Controls/em-setwordwrapmode)

### <a name="return-value"></a>傳回值

當前換字和斷字選項。

### <a name="remarks"></a>備註

此消息僅在操作系統的亞洲語言版本中可用。

## <a name="cricheditctrlstopgrouptyping"></a><a name="stopgrouptyping"></a>克里希編輯::停止分組打字

阻止控制項將其他鍵入操作收集到當前撤消操作中。

```
void StopGroupTyping();
```

### <a name="remarks"></a>備註

控制項將下一個鍵入操作(如果有)儲存在復原佇列中的新操作中。

有關詳細資訊,請參閱 Windows SDK 中的[EM_STOPGROUPTYPING。](/windows/win32/Controls/em-stopgrouptyping)

## <a name="cricheditctrlstreamin"></a><a name="streamin"></a>克里希編輯::流

將此`CRichEditCtrl`物件中的文字取代為指定輸入串流中的文字。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>參數

*nFormat*<br/>
標記指定輸入數據格式。 如需詳細資訊，請參閱「備註」一節。

*es*<br/>
指定輸入流的[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。 如需詳細資訊，請參閱「備註」一節。

### <a name="return-value"></a>傳回值

從輸入流讀取的字元數。

### <a name="remarks"></a>備註

*nFormat*的值必須為以下值之一:

- SF_TEXT 表示僅讀取文本。

- SF_RTF 指示讀取文本和格式。

其中任一值都可以與SFF_SELECTION結合使用。 如果指定SFF_SELECTION,`StreamIn`則將目前選擇替換為輸入流的內容。 如果未指定,`StreamIn`則取代`CRichEditCtrl`此 物件的所有內容。

在`EDITSTREAM`參數*es*中,指定一個回調函數,該函數用文本填充緩衝區。 重複調用此回調函數,直到輸入流耗盡。

有關詳細資訊,請參閱[EM_STREAMIN](/windows/win32/Controls/em-streamin) Windows SDK 中的消息和[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

## <a name="cricheditctrlstreamout"></a><a name="streamout"></a>克里希編輯::流出

將此`CRichEditCtrl`物件的內容寫入指定的輸出流。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>參數

*nFormat*<br/>
標記指定輸出數據格式。 如需詳細資訊，請參閱「備註」一節。

*es*<br/>
指定輸出流的[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。 如需詳細資訊，請參閱「備註」一節。

### <a name="return-value"></a>傳回值

寫入輸出流的字元數。

### <a name="remarks"></a>備註

*nFormat*的值必須為以下值之一:

- SF_TEXT 表示僅寫入文本。

- SF_RTF 指示書寫文本和格式。

- SF_RTFNOOBJS指示書寫文本和格式,將 OLE 項替換為空格。

- SF_TEXTIZED指示使用 OLE 項的文本表示形式書寫文本和格式。

其中任何一個值都可以與SFF_SELECTION結合使用。 如果指定SFF_SELECTION,`StreamOut`則將當前選擇寫入輸出流。 如果未指定,則`StreamOut`寫出此`CRichEditCtrl`物件的全部內容。

在`EDITSTREAM`參數*es*中,指定一個回調函數,該函數用文本填充緩衝區。 重複調用此回調函數,直到輸出流耗盡。

有關詳細資訊,請參閱[EM_STREAMOUT](/windows/win32/Controls/em-streamout) Windows SDK 中的消息和[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

## <a name="cricheditctrlundo"></a><a name="undo"></a>克里希編輯::撤銷

撤銷富編輯控制件中的最後一個操作。

```
BOOL Undo();
```

### <a name="return-value"></a>傳回值

如果撤銷操作成功,則非零;否則,0。

### <a name="remarks"></a>備註

撤銷操作也可以撤銷。 例如, 可以使用第一次呼叫 回復已移除的`Undo`文字 。 只要沒有干預編輯操作,就可以使用第二個調用`Undo`再次刪除文本。

有關詳細資訊,請參閱 Windows SDK 中的[EM_UNDO。](/windows/win32/Controls/em-undo)

### <a name="example"></a>範例

  請參閱[CanUndo](#canundo)的範例。

## <a name="see-also"></a>另請參閱

[MFC 樣品 WORDPAD](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CEdit Class](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView 類別](../../mfc/reference/cricheditview-class.md)
