---
title: CRichEditCtrl 類別 |Microsoft Docs
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
dev_langs:
- C++
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 2847bf32a51a63e39d80839fed1b46fac18f29dc
ms.sourcegitcommit: 9a0905c03a73c904014ec9fd3d6e59e4fa7813cd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/29/2018
ms.locfileid: "43215787"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl 類別
提供 Windows Rich Edit 控制項的功能。  
  
## <a name="syntax"></a>語法  
  
```  
class CRichEditCtrl : public CWnd  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|建構 `CRichEditCtrl` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CRichEditCtrl::CanPaste](#canpaste)|決定是否剪貼簿的內容可以貼到此 rich edit 控制項。|  
|[CRichEditCtrl::CanRedo](#canredo)|判斷是否有任何控制項的重做佇列中的動作。|  
|[CRichEditCtrl::CanUndo](#canundo)|決定是否的編輯作業可以進行復原。|  
|[CRichEditCtrl::CharFromPos](#charfrompos)|擷取最接近的編輯控制項工作區中的指定點之字元的相關資訊。|  
|[CRichEditCtrl::Clear](#clear)|清除目前的選取項目。|  
|[CRichEditCtrl::Copy](#copy)|將目前的選取範圍複製到剪貼簿。|  
|[CRichEditCtrl::Create](#create)|建立 Windows rich edit 控制項，並將其與此相關聯`CRichEditCtrl`物件。|  
|[CRichEditCtrl::CreateEx](#createex)|建立具有指定 Windows rich edit 控制項，擴充 Windows 樣式，並關聯這`CRichEditCtrl`物件。|  
|[CRichEditCtrl::Cut](#cut)|剪下目前的選取範圍至剪貼簿。|  
|[CRichEditCtrl::DisplayBand](#displayband)|顯示這個內容的部分`CRichEditCtrl`物件。|  
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|重設 （清除） 復原旗標，這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::FindText](#findtext)|在這個文字會找出`CRichEditCtrl`物件。|  
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|尋找下一個字組分隔符號之前或之後指定的字元位置，或擷取的字元，該位置的相關資訊。|  
|[CRichEditCtrl::FormatRange](#formatrange)|格式化某個範圍的目標輸出裝置的文字。|  
|[CRichEditCtrl::GetCharPos](#getcharpos)|判斷指定的字元，在這個位置`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|擷取目前的預設字元格式設定屬性在這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetEventMask](#geteventmask)|擷取這個事件遮罩`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|判斷在這個最上層的可見行`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|擷取的指標`IRichEditOle`此 rich edit 控制項的介面。|  
|[CRichEditCtrl::GetLimitText](#getlimittext)|取得所需的使用者可以輸入此文字的限制`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetLine](#getline)|這會擷取文字行`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetLineCount](#getlinecount)|擷取中的行數`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetModify](#getmodify)|判斷這個內容`CRichEditCtrl`上次儲存以來已經變更的物件。|  
|[CRichEditCtrl::GetOptions](#getoptions)|擷取豐富的編輯控制項的選項。|  
|[CRichEditCtrl::GetParaFormat](#getparaformat)|擷取段落格式屬性目前的選取範圍，在此`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|擷取目前的標點符號字元如 rich edit 控制項。 此訊息是作業系統的僅適用於亞洲語言版本。|  
|[CRichEditCtrl::GetRect](#getrect)|這會擷取格式化矩形`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetRedoName](#getredoname)|如果控制項中的任何重做佇列，請擷取下一個動作中，型別。|  
|[CRichEditCtrl::GetSel](#getsel)|取得起始和結束目前的選取範圍，在此位置`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|擷取格式化屬性，在此目前的選取範圍中的字元`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|擷取目前的選取範圍，在此內容的型別`CRichEditCtrl`物件。|  
|[CRichEditCtrl::GetSelText](#getseltext)|在此取得目前的選取範圍的文字`CRichEditCtrl`物件|  
|[CRichEditCtrl::GetTextLength](#gettextlength)|擷取文字的長度，以字元為單位，在此`CRichEditCtrl`物件。 不包含結束的 null 字元。|  
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|擷取字元或在 rich edit 檢視表中的位元組的數目。 接受旗標以指出判斷 rich edit 控制項中文字的長度的方法清單|  
|[CRichEditCtrl::GetTextMode](#gettextmode)|擷取目前文字模式和復原層級的 rich edit 控制項。|  
|[CRichEditCtrl::GetTextRange](#gettextrange)|擷取指定的文字範圍。|  
|[CRichEditCtrl::GetUndoName](#getundoname)|如果有的話，請擷取下一個復原動作的類型。|  
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|擷取目前的自動換行和 rich edit 控制項的 word 重大選項。 此訊息是作業系統的僅適用於亞洲語言版本。|  
|[CRichEditCtrl::HideSelection](#hideselection)|顯示或隱藏目前的選取範圍。|  
|[CRichEditCtrl::LimitText](#limittext)|限制使用者可以輸入的文字數量`CRichEditCtrl`物件。|  
|[CRichEditCtrl::LineFromChar](#linefromchar)|判斷哪一行包含指定的字元。|  
|[CRichEditCtrl::LineIndex](#lineindex)|擷取指定行中的字元索引`CRichEditCtrl`物件。|  
|[CRichEditCtrl::LineLength](#linelength)|擷取在指定行的長度`CRichEditCtrl`物件。|  
|[CRichEditCtrl::LineScroll](#linescroll)|將此文字捲動`CRichEditCtrl`物件。|  
|[CRichEditCtrl::Paste](#paste)|插入此 rich edit 控制項中的剪貼簿的內容。|  
|[CRichEditCtrl::PasteSpecial](#pastespecial)|插入指定的資料格式的此 rich edit 控制項中的剪貼簿的內容。|  
|[CRichEditCtrl::PosFromChar](#posfromchar)|擷取指定的字元，在編輯控制項中的用戶端區域座標。|  
|[CRichEditCtrl::Redo](#redo)|重做控制項的重做佇列中的下一個動作。|  
|[CRichEditCtrl::ReplaceSel](#replacesel)|取代目前的選取範圍，在此`CRichEditCtrl`含有指定文字的物件。|  
|[CRichEditCtrl::RequestResize](#requestresize)|會強制此`CRichEditCtrl`傳送要求調整通知的物件。|  
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|指出是否使用 rich edit 控制項中自動 URL 偵測。|  
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|在此設定的背景色彩`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|設定目前的預設字元格式設定屬性在這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetEventMask](#seteventmask)|設定事件遮罩這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetModify](#setmodify)|設定或清除修改的旗標，這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetOLECallback](#setolecallback)|設定`IRichEditOleCallback`此 rich edit 控制項的 COM 物件。|  
|[CRichEditCtrl::SetOptions](#setoptions)|設定這個選項`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetParaFormat](#setparaformat)|設定段落格式，在此目前的選取範圍中的屬性`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|設定 rich edit 控制項的標點符號字元。 此訊息是作業系統的僅適用於亞洲語言版本。|  
|[CRichEditCtrl::SetReadOnly](#setreadonly)|設定唯讀選項，這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetRect](#setrect)|設定這個格式化矩形`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetSel](#setsel)|在此設定選取項目`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|設定字元，格式化目前選取範圍中的屬性`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|設定這個目標輸出裝置`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetTextMode](#settextmode)|設定 rich edit 控制項的文字模式或復原層級。 如果控制項包含文字，就會失敗的訊息。|  
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|設定可以儲存在復原佇列中的動作的最大數目。|  
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|設定的字元格式中目前字組，在此屬性`CRichEditCtrl`物件。|  
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|將豐富的自動換行和斷字功能選項的編輯控制項。 此訊息是作業系統的僅適用於亞洲語言版本。|  
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|停止控制項收集其他輸入目前的復原動作的動作。 如果到新的動作復原佇列中的任何，控制項就會儲存下, 一步 的輸入動作。|  
|[CRichEditCtrl::StreamIn](#streamin)|插入文字的輸入資料流從這個`CRichEditCtrl`物件。|  
|[CRichEditCtrl::StreamOut](#streamout)|會從這個文字儲存`CRichEditCtrl`輸出資料流中的物件。|  
|[CRichEditCtrl::Undo](#undo)|復原上次的編輯作業。|  
  
## <a name="remarks"></a>備註  
 「 Rich edit 控制項 」 是一個視窗，讓使用者輸入及編輯文字。 文字字元和段落格式，可指派，而且可以包含內嵌的 OLE 物件。 Rich edit 控制項的格式化文字，提供程式設計介面。 然而，應用程式必須實作所有必要的使用者介面元件，讓使用者能夠執行格式化作業。  
  
 這個 Windows 通用控制項 (並因此`CRichEditCtrl`類別) 僅適用於 Windows 95/98 和 Windows NT 的版本 3.51 下執行的程式和更新版本。 `CRichEditCtrl`類別支援的版本 2.0 和 3.0 的 Windows SDK 豐富的編輯控制項。  
  
> [!CAUTION]
>  如果您使用 rich edit 控制項在對話方塊中 (無論您的應用程式是 SDI、 MDI 或對話方塊架構)，您必須呼叫[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)一旦方塊會顯示對話方塊之前。 呼叫這個函式的一般位置是在程式的 `InitInstance` 成員函式中。 只需在第一次顯示對話方塊時呼叫它一次。 如果您使用 `AfxInitRichEdit`，不需要呼叫 `CRichEditView`。  
  
 如需有關使用`CRichEditCtrl`，請參閱：  
  
- [控制項](../../mfc/controls-mfc.md)  
  
- [使用 CRichEditCtrl](../../mfc/using-cricheditctrl.md)  
  
-   眭妎踱恅 Q259949： 資訊： SetCaretPos() 是不適合與 CEdit 或 CRichEditCtrl 控制項  
  
 使用 rich edit 控制項的 MFC 應用程式中的範例，請參閱[WORDPAD](../../visual-cpp-samples.md)範例應用程式。  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CRichEditCtrl`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxcmn.h  
  
##  <a name="canpaste"></a>  CRichEditCtrl::CanPaste  
 判斷 rich edit 控制項是否可以貼上指定的剪貼簿格式。  
  
```  
BOOL CanPaste(UINT nFormat = 0) const;  
```  
  
### <a name="parameters"></a>參數  
 *nFormat*  
 要查詢的剪貼簿資料格式。 這個參數可以是其中一個預先定義的剪貼簿格式或所傳回的值[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata)。  
  
### <a name="return-value"></a>傳回值  
 如果可以貼上剪貼簿格式，為非零否則為 0。  
  
### <a name="remarks"></a>備註  
 如果*nFormat*為 0，`CanPaste`將重試目前在剪貼簿上的任何格式。  
  
 如需詳細資訊，請參閱 < [EM_CANPASTE](/windows/desktop/Controls/em-canpaste)訊息並[RegisterClipboardFormat](/windows/desktop/api/winuser/nf-winuser-registerclipboardformata) Windows SDK 中的函式。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]  
  
##  <a name="canredo"></a>  CRichEditCtrl::CanRedo  
 判斷是否重做佇列包含的任何動作。  
  
```  
BOOL CanRedo() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果重做佇列包含動作，否則為 0，非零值。  
  
### <a name="remarks"></a>備註  
 若要探索的重做佇列中的作業名稱，請呼叫[CRichEditCtrl::GetRedoName](#getredoname)。 若要取消復原最新的復原作業，請呼叫[重做](#redo)。  
  
 如需詳細資訊，請參閱 < [EM_CANREDO](/windows/desktop/Controls/em-canredo) Windows SDK 中。  
  
##  <a name="canundo"></a>  CRichEditCtrl::CanUndo  
 決定是否可以復原上次的編輯作業。  
  
```  
BOOL CanUndo() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果可以復原上次的編輯作業，藉由呼叫為非零[復原](#undo)成員函式; 0，如果無法復原。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_CANUNDO](/windows/desktop/Controls/em-canundo) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]  
  
##  <a name="charfrompos"></a>  CRichEditCtrl::CharFromPos  
 擷取參數所指定的點字元的相關資訊*pt*。  
  
```  
int CharFromPos(CPoint pt) const;  
```  
  
### <a name="parameters"></a>參數  
 *太平洋時間*  
 A [CPoint](../../atl-mfc-shared/reference/cpoint-class.md)物件，其中包含指定點的座標。  
  
### <a name="return-value"></a>傳回值  
 最接近指定點之字元的以零為起始的字元索引。 如果指定的點超出控制項中的最後一個字元，傳回值，表示控制項中的最後一個字元。  
  
### <a name="remarks"></a>備註  
 此成員函式的運作方式與 rich edit 控制項。 若要取得編輯控制項的資訊，請呼叫[CEdit::CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)。  
  
 如需詳細資訊，請參閱 < [EM_CHARFROMPOS](/windows/desktop/Controls/em-charfrompos) Windows SDK 中。  
  
##  <a name="clear"></a>  CRichEditCtrl::Clear  
 刪除 （清除） 的目前選取範圍 （如果有的話） 的豐富編輯控制項。  
  
```  
void Clear();
```  
  
### <a name="remarks"></a>備註  
 刪除由`Clear`可以藉由呼叫復原[復原](#undo)成員函式。  
  
 若要刪除目前選取範圍，並放置到剪貼簿上已刪除的內容，請呼叫[剪下](#cut)成員函式。  
  
 如需詳細資訊，請參閱 < [WM_CLEAR](/windows/desktop/dataxchg/wm-clear) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]  
  
##  <a name="copy"></a>  CRichEditCtrl::Copy  
 複製目前的選取範圍 （如果有的話） 在 rich edit 控制項到剪貼簿。  
  
```  
void Copy();
```  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [WM_COPY](/windows/desktop/dataxchg/wm-copy) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]  
  
##  <a name="create"></a>  CRichEditCtrl::Create  
 建立 Windows rich edit 控制項，並將其與此相關聯`CRichEditCtrl`物件。  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 *cheaderctrl:: Create*  
 指定編輯控制項的樣式。 適用於所列出的視窗樣式的組合 **< 備註 > 一**一節，以及[編輯控制項的樣式](/windows/desktop/Controls/edit-control-styles)Windows SDK 中所述。  
  
 *rect*  
 指定編輯控制項的大小和位置。 可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](../../mfc/reference/rect-structure1.md)結構。  
  
 *pParentWnd*  
 指定編輯控制項的父視窗 (通常[CDialog](../../mfc/reference/cdialog-class.md))。 它必須不是 NULL。  
  
 *nID*  
 指定編輯控制項的識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果初始化成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 您建構`CRichEditCtrl`兩個步驟中的物件。 首先，呼叫[CRichEditCtrl](#cricheditctrl)建構函式，然後呼叫`Create`，這會建立 Windows 編輯控制項，並將它附加至`CRichEditCtrl`物件。  
  
 當您建立 rich edit 控制項使用這個函式時，首先您必須載入所需的通用控制項程式庫。 若要載入程式庫，呼叫全域函式[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)，其接著初始化通用控制項程式庫。 您必須呼叫`AfxInitRichEdit`在流程中的一次。  
  
 當`Create`執行時，Windows 會傳送[WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)， [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)， [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)，並[WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)編輯控制項的訊息。  
  
 根據預設，處理這些訊息[OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate)， [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)， [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)，以及[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)成員函式在 `CWnd`基底類別。 若要擴充的預設訊息處理，衍生的類別`CRichEditCtrl`、 將訊息對應新增至新的類別，並覆寫上述的訊息處理常式成員函式。 覆寫`OnCreate`，例如，若要執行的新類別所需的初始設定。  
  
 套用下列[的視窗樣式](../../mfc/reference/styles-used-by-mfc.md#window-styles)至編輯控制項。  
  
- WS_CHILD 一律。  
  
- WS_VISIBLE 通常。  
  
- WS_DISABLED 很少。  
  
- WS_GROUP 來群組控制項。  
  
- WS_TABSTOP 若要包含 tab 鍵順序編輯控制項。  
  
 如需有關視窗樣式的詳細資訊，請參閱[CreateWindow](https://msdn.microsoft.com/library/windows/desktop/ms632679) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]  
  
##  <a name="createex"></a>  CRichEditCtrl::CreateEx  
 建立控制項 （子視窗），並將它與關聯`CRichEditCtrl`物件。  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 *dwExStyle*  
 指定正在建立之控制項的延伸的樣式。 如需延伸的 Windows 樣式的清單，請參閱 < *dwExStyle*參數[CreateWindowEx](https://msdn.microsoft.com/library/windows/desktop/ms632680) Windows SDK 中。  
  
 *cheaderctrl:: Create*  
 指定編輯控制項的樣式。 適用於所列出的視窗樣式的組合 **< 備註 > 一**一節[建立](#create)並[編輯控制項的樣式](/windows/desktop/Controls/edit-control-styles)Windows SDK 中所述。  
  
 *rect*  
 參考[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構描述的大小和位置，在中建立工作區座標中的視窗*pParentWnd*。  
  
 *pParentWnd*  
 是控制項的父視窗的指標。  
  
 *nID*  
 控制項的子視窗識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 使用`CreateEx`而非`Create`套用延伸的 Windows 樣式，由 Windows 延伸的樣式前置詞**WS_EX_**。  
  
##  <a name="cricheditctrl"></a>  CRichEditCtrl::CRichEditCtrl  
 建構 `CRichEditCtrl` 物件。  
  
```  
CRichEditCtrl();
```  
  
### <a name="remarks"></a>備註  
 使用[建立](#create)建構 Windows rich edit 控制項。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]  
  
##  <a name="cut"></a>  CRichEditCtrl::Cut  
 刪除 （剪下） 中目前選取範圍 （如果有的話） 的豐富編輯控制項，並將已刪除的文字複製到剪貼簿。  
  
```  
void Cut();
```  
  
### <a name="remarks"></a>備註  
 刪除由`Cut`可以藉由呼叫復原[復原](#undo)成員函式。  
  
 若要刪除目前選取範圍，不需將刪除的文字放到剪貼簿，請呼叫[清除](#clear)成員函式。  
  
 如需詳細資訊，請參閱 < [WM_CUT](/windows/desktop/dataxchg/wm-cut) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]  
  
##  <a name="displayband"></a>  CRichEditCtrl::DisplayBand  
 顯示部分內容的 rich edit 控制項 （文字和 OLE 項目），如先前來格式化[FormatRange](#formatrange)。  
  
```  
BOOL DisplayBand(LPRECT pDisplayRect);
```  
  
### <a name="parameters"></a>參數  
 *pDisplayRect*  
 指標[RECT](../../mfc/reference/rect-structure1.md)或是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件，指定要顯示的文字之裝置的區域。  
  
### <a name="return-value"></a>傳回值  
 如果格式化的文字顯示成功，否則 0，非零值。  
  
### <a name="remarks"></a>備註  
 文字和 OLE 項目會裁剪為指標所指定的區域*pDisplayRect*。  
  
 如需詳細資訊，請參閱 < [EM_DISPLAYBAND](/windows/desktop/Controls/em-displayband) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[CRichEditCtrl::FormatRange](#formatrange)。  
  
##  <a name="emptyundobuffer"></a>  CRichEditCtrl::EmptyUndoBuffer  
 （清除） 會重設此 rich edit 控制項的復原旗標。  
  
```  
void EmptyUndoBuffer();
```  
  
### <a name="remarks"></a>備註  
 控制項現在無法復原上次的編輯作業。 Rich edit 控制項中的作業可以進行復原時，會設定復原旗標。  
  
 每當您呼叫時，就會自動清除復原旗標[CWnd](../../mfc/reference/cwnd-class.md)成員函式[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。  
  
 如需詳細資訊，請參閱 < [EM_EMPTYUNDOBUFFER](/windows/desktop/Controls/em-emptyundobuffer) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]  
  
##  <a name="findtext"></a>  CRichEditCtrl::FindText  
 尋找在 rich edit 控制項中的文字。  
  
```  
long FindText(
    DWORD dwFlags,  
    FINDTEXTEX* pFindText) const;  
```  
  
### <a name="parameters"></a>參數  
 *dwFlags*  
 如需可能值的清單，請參閱 < *wParam*中[EM_FINDTEXTEXT](/windows/desktop/Controls/em-findtextex) Windows SDK 中。  
  
 *pFindText*  
 指標[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa)結構提供搜尋參數並傳回找到相符項的範圍。  
  
### <a name="return-value"></a>傳回值  
 以零為起始的字元位置的下一個相符項-1，表示有沒有更多的相符項目。  
  
### <a name="remarks"></a>備註  
 您可以搜尋是增加或相應減少設定中的適當的範圍參數[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)結構內`FINDTEXTEX`結構。  
  
 如需詳細資訊，請參閱 < [EM_FINDTEXTEX](/windows/desktop/Controls/em-findtextex)訊息並[FINDTEXTEX](/windows/desktop/api/richedit/ns-richedit-_findtextexa) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]  
  
##  <a name="findwordbreak"></a>  CRichEditCtrl::FindWordBreak  
 之前或之後所指定的位置尋找下一個字組分隔符號*n*。  
  
```  
DWORD FindWordBreak(
    UINT nCode,  
    DWORD nStart) const;  
```  
  
### <a name="parameters"></a>參數  
 *則 nCode*  
 表示要採取的動作。 如需可能值的清單，請參閱參數的描述*程式碼*EM_FINDWORDBREAK Windows sdk 中。  
  
 *n*  
 從要啟動的以零為起始的字元位置。  
  
### <a name="return-value"></a>傳回值  
 根據參數*則 nCode*。 如需詳細資訊，請參閱 < [EM_FINDWORDBREAK](/windows/desktop/Controls/em-findwordbreak) Windows SDK 中。  
  
### <a name="remarks"></a>備註  
 您可以使用此成員函式來擷取字元的指定位置的相關資訊。  
  
##  <a name="formatrange"></a>  CRichEditCtrl::FormatRange  
 格式化在特定裝置的 rich edit 控制項中的文字範圍。  
  
```  
long FormatRange(
    FORMATRANGE* pfr,  
    BOOL bDisplay = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *pfr*  
 指標[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange)結構也包含在輸出裝置的相關資訊。 NULL 表示可釋出 rich edit 控制項中的快取的資訊。  
  
 *bDisplay*  
 指出是否應該轉譯的文字。 如果為 FALSE，是只測量的文字。  
  
### <a name="return-value"></a>傳回值  
 適合於的區域加一的最後一個字元索引。  
  
### <a name="remarks"></a>備註  
 一般而言，這個呼叫後面接著呼叫[DisplayBand](#displayband)。  
  
 如需詳細資訊，請參閱 < [EM_FORMATRANGE](/windows/desktop/Controls/em-formatrange)訊息並[FORMATRANGE](/windows/desktop/api/richedit/ns-richedit-_formatrange) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]  
  
##  <a name="getcharpos"></a>  CRichEditCtrl::GetCharPos  
 取得指定的字元，在這個位置 （左上角）`CRichEditCtrl`物件。  
  
```  
CPoint GetCharPos(long lChar) const;  
```  
  
### <a name="parameters"></a>參數  
 *lChar*  
 字元的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 所指定的字元的左上角的位置*lChar*。  
  
### <a name="remarks"></a>備註  
 藉由提供其以零為起始的索引值，指定的字元。 如果*lChar*大於最後一個字元，在此索引`CRichEditCtrl`物件，傳回的值在此指定剛好超過最後一個字元的字元位置的座標`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) Windows SDK 中。  
  
##  <a name="getdefaultcharformat"></a>  CRichEditCtrl::GetDefaultCharFormat  
 取得格式化這個屬性的預設字元`CRichEditCtrl`物件。  
  
```  
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;  
```  
  
### <a name="parameters"></a>參數  
 *cf*  
 在第一個版本中，指標`CHARFORMAT`結構預設字元格式的屬性。  
  
 在第二個版本中，指標`CHARFORMAT2`結構，也就是 Rich Edit 2.0 延伸模組來`CHARFORMAT`結構中，保留預設字元格式的屬性。  
  
### <a name="return-value"></a>傳回值  
 `dwMask`資料成員*cf*。它會指定預設字元格式的屬性。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 EM_GETCHARFORMAT 訊息並`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
  範例，請參閱[SetDefaultCharFormat](#setdefaultcharformat)。  
  
##  <a name="geteventmask"></a>  CRichEditCtrl::GetEventMask  
 取得這個事件遮罩`CRichEditCtrl`物件。  
  
```  
long GetEventMask() const;  
```  
  
### <a name="return-value"></a>傳回值  
 這個事件遮罩`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 事件遮罩指定通知訊息`CRichEditCtrl`物件傳送至其父視窗。  
  
 如需詳細資訊，請參閱 < [EM_GETEVENTMASK](/windows/desktop/Controls/em-geteventmask) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[CRichEditCtrl::SetEventMask](#seteventmask)。  
  
##  <a name="getfirstvisibleline"></a>  CRichEditCtrl::GetFirstVisibleLine  
 判斷在這個最上層的可見行`CRichEditCtrl`物件。  
  
```  
int GetFirstVisibleLine() const;  
```  
  
### <a name="return-value"></a>傳回值  
 以零起始的索引，在這個最上方顯示的線條的`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_GETFIRSTVISIBLELINE](/windows/desktop/Controls/em-getfirstvisibleline) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]  
  
##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle  
 存取`IRichEditOle`介面，這個`CRichEditCtrl`物件。  
  
```  
IRichEditOle* GetIRichEditOle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole)介面，可用來存取這個`CRichEditCtrl`物件之 OLE 功能;如果介面不能存取，則為 NULL。  
  
### <a name="remarks"></a>備註  
 使用此介面來存取這個`CRichEditCtrl`物件之 OLE 功能。  
  
 如需詳細資訊，請參閱 < [EM_GETOLEINTERFACE](/windows/desktop/Controls/em-getoleinterface)訊息並[IRichEditOle](/windows/desktop/api/richole/nn-richole-iricheditole) Windows SDK 中的介面。  
  
##  <a name="getlimittext"></a>  CRichEditCtrl::GetLimitText  
 取得此文字限制`CRichEditCtrl`物件。  
  
```  
long GetLimitText() const;  
```  
  
### <a name="return-value"></a>傳回值  
 目前文字的限制，以位元組為單位，此`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 文字限制是文字，以位元組為單位的最大數量可接受的 rich edit 控制項。  
  
 如需詳細資訊，請參閱 < [EM_GETLIMITTEXT](/windows/desktop/Controls/em-getlimittext) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]  
  
##  <a name="getline"></a>  CRichEditCtrl::GetLine  
 這會擷取文字行`CRichEditCtrl`物件。  
  
```  
int GetLine(
    int nIndex,  
    LPTSTR lpszBuffer) const;  
  
int GetLine(
    int nIndex,  
    LPTSTR lpszBuffer,  
    int nMaxLength) const;  
```  
  
### <a name="parameters"></a>參數  
 *nIndex*  
 要擷取的行之以零起始的索引。  
  
 *lpszBuffer*  
 指向接收文字的緩衝區。 緩衝區的第一個字組必須指定最大可以複製到緩衝區的位元組數。  
  
 *nMaxLength*  
 最大可以複製到的字元數*lpszBuffer*。 第二個形式`GetLine`將此值放入所指定的緩衝區之第一個單字*lpszBuffer*。  
  
### <a name="return-value"></a>傳回值  
 複製到的字元數*lpszBuffer*。  
  
### <a name="remarks"></a>備註  
 所複製的行不包含結束的 null 字元。  
  
> [!NOTE]
>  因為緩衝區的第一個文字存放區複製的字元數，請確定您的緩衝區是至少 4 個位元組長。  
  
 如需詳細資訊，請參閱 < [EM_GETLINE](/windows/desktop/Controls/em-getline) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[GetLineCount](#getlinecount)。  
  
##  <a name="getlinecount"></a>  CRichEditCtrl::GetLineCount  
 擷取中的總行數`CRichEditCtrl`物件。  
  
```  
int GetLineCount() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在此的行數`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_GETLINECOUNT](/windows/desktop/Controls/em-getlinecount) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]  
  
##  <a name="getmodify"></a>  CRichEditCtrl::GetModify  
 判斷這個內容`CRichEditCtrl`已修改的物件。  
  
```  
BOOL GetModify() const;  
```  
  
### <a name="return-value"></a>傳回值  
 非零值的文字，在此`CRichEditCtrl`修改的物件; 否則為 0。  
  
### <a name="remarks"></a>備註  
 Windows 會維護內部的旗標，指出是否已變更的 rich edit 控制項的內容。 當編輯控制項第一次建立，而且也可以藉由呼叫清除時，系統會清除這個旗標[SetModify](#setmodify)成員函式。  
  
 如需詳細資訊，請參閱 < [EM_GETMODIFY](/windows/desktop/Controls/em-getmodify) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]  
  
##  <a name="getoptions"></a>  CRichEditCtrl::GetOptions  
 擷取目前設定的 rich edit 控制項的選項。  
  
```  
UINT GetOptions() const;  
```  
  
### <a name="return-value"></a>傳回值  
 目前的選項旗標值的組合。 如需這些值的清單，請參閱 < *Stored*中的參數[EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions)訊息、 Windows SDK 中所述。  
  
##  <a name="getparaformat"></a>  CRichEditCtrl::GetParaFormat  
 取得段落格式化目前選取範圍的屬性。  
  
```  
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;  
```  
  
### <a name="parameters"></a>參數  
 *pf*  
 在第一個版本中，指標[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat)結構以容納的段落格式化目前選取範圍的屬性。  
  
 在第二個版本中，指標[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)結構，也就是 Rich Edit 2.0 延伸模組來`PARAFORMAT`結構中，保留預設字元格式的屬性。  
  
### <a name="return-value"></a>傳回值  
 `dwMask`資料成員*pf*。 它會指定的段落格式化目前選取範圍中一致的屬性。  
  
### <a name="remarks"></a>備註  
 如果選取多個段落*pf*接收第一個選取的段落的屬性。 傳回值會指定哪一個屬性都是選取範圍中一致。  
  
 如需詳細資訊，請參閱 < [EM_GETPARAFORMAT](/windows/desktop/Controls/em-getparaformat)訊息並`PARAFORMAT`和`PARAFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
  範例，請參閱[CRichEditCtrl::SetParaFormat](#setparaformat)。  
  
##  <a name="getpunctuation"></a>  CRichEditCtrl::GetPunctuation  
 Rich edit 控制項中取得目前的標點符號字元。  
  
```  
BOOL GetPunctuation(
    UINT fType,  
    PUNCTUATION* lpPunc) const;  
```  
  
### <a name="parameters"></a>參數  
 *fType*  
 標點符號類型旗標，如中所述*fType*的參數[EM_GETPUNCTUATION](/windows/desktop/Controls/em-getpunctuation) Windows SDK 中。  
  
 *lpPunc*  
 指標[標點符號](/windows/desktop/api/richedit/ns-richedit-_punctuation)結構，在 Windows SDK 中所述。  
  
### <a name="return-value"></a>傳回值  
 如果作業成功，則為 0，非零值。  
  
### <a name="remarks"></a>備註  
 此成員函式可以使用只有亞洲語言版本的作業系統。  
  
##  <a name="getrect"></a>  CRichEditCtrl::GetRect  
 這會擷取格式化矩形`CRichEditCtrl`物件。  
  
```  
void GetRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>參數  
 *lpRect*  
 [CRect](../../atl-mfc-shared/reference/crect-class.md)或指標[RECT](../../mfc/reference/rect-structure1.md)接收這個格式化矩形`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 格式化矩形是文字的週框矩形。 此值無關的大小`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_GETRECT](/windows/desktop/Controls/em-getrect) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[LimitText](#limittext)。  
  
##  <a name="getredoname"></a>  CRichEditCtrl::GetRedoName  
 如果有的話，請擷取下一個重做佇列中可用動作的類型。  
  
```  
UNDONAMEID GetRedoName() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果成功，`GetRedoName`會傳回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid)列舉型別，表示控制項的重做佇列中的下一個動作的類型。 如果重做佇列是空的或在佇列中的重做動作是未知的類型，`GetRedoName`會傳回 0。  
  
### <a name="remarks"></a>備註  
 可以復原或重做的動作類型包括輸入、 刪除、 拖放、 剪下和貼上作業。 這項資訊可用於進行復原和取消復原作業，例如 redoable 動作的下拉式清單方塊中提供擴充的使用者介面的應用程式。  
  
##  <a name="getsel"></a>  CRichEditCtrl::GetSel  
 擷取目前的選取範圍，在這個界限`CRichEditCtrl`物件。  
  
```  
void GetSel(CHARRANGE& cr) const;  
  
void GetSel(
    long& nStartChar,  
    long& nEndChar) const;  
```  
  
### <a name="parameters"></a>參數  
 *cr*  
 若要參考[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)接收目前的選取範圍的界限的結構。  
  
 *nStartChar*  
 目前的選取範圍中的第一個字元的以零為起始索引。  
  
 *nEndChar*  
 目前的選取範圍中的最後一個字元的以零為起始索引。  
  
### <a name="remarks"></a>備註  
 此函式的兩種形式提供替代方式，以取得選取範圍的界限。 請依照下列這些形式的簡短描述：  
  
- **GetSel (** `cr` **)** 這個表單用`CHARRANGE`結構和其`cpMin`並`cpMax`傳回界限的成員。  
  
- **GetSel (** `nStartChar` **，** `nEndChar` **)** 這種形式的參數中傳回界限*nStartChar*和*nEndChar*.  
  
 如果選取項目包含的所有項目開始 (`cpMin`或*nStartChar*) 是 0，而結尾 (`cpMax`或*nEndChar*) 是-1。  
  
 如需詳細資訊，請參閱 < [EM_EXGETSEL](/windows/desktop/Controls/em-exgetsel)訊息並[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]  
  
##  <a name="getselectioncharformat"></a>  CRichEditCtrl::GetSelectionCharFormat  
 取得字元格式化目前選取範圍的屬性。  
  
```  
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;  
```  
  
### <a name="parameters"></a>參數  
 *cf*  
 在第一個版本中，指標[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)結構，以接收到下列字元格式的目前選取範圍的屬性。  
  
 在第二個版本中，指標[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)結構，也就是 Rich Edit 2.0 延伸模組來`CHARFORMAT`結構，以接收到下列字元格式的目前選取範圍的屬性。  
  
### <a name="return-value"></a>傳回值  
 `dwMask`資料成員*cf*。它會指定字元格式的目前選取範圍中一致的屬性。  
  
### <a name="remarks"></a>備註  
 *Cf*參數目前的選取範圍中收到的第一個字元的屬性。 傳回值會指定哪一個屬性都是選取範圍中一致。  
  
 如需詳細資訊，請參閱 < [EM_GETCHARFORMAT](/windows/desktop/Controls/em-getcharformat)訊息並`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
  範例，請參閱[SetSelectionCharFormat](#setselectioncharformat)。  
  
##  <a name="getselectiontype"></a>  CRichEditCtrl::GetSelectionType  
 在此選取項目類型會決定`CRichEditCtrl`物件。  
  
```  
WORD GetSelectionType() const;  
```  
  
### <a name="return-value"></a>傳回值  
 旗標，指出目前的選取範圍的內容。 下列旗標的組合：  
  
- SEL_EMPTY 表示沒有目前的選取項目。  
  
- SEL_TEXT 表示目前的選取範圍包含文字。  
  
- SEL_OBJECT 表示目前的選取範圍包含至少一個 OLE 項目。  
  
- SEL_MULTICHAR 表示目前的選取範圍包含多個文字字元。  
  
- SEL_MULTIOBJECT 表示目前的選取範圍包含多個 OLE 物件。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_SELECTIONTYPE](/windows/desktop/Controls/em-selectiontype) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]  
  
##  <a name="getseltext"></a>  CRichEditCtrl::GetSelText  
 在此目前的選取範圍中擷取文字`CRichEditCtrl`物件。  
  
```  
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;  
```  
  
### <a name="parameters"></a>參數  
 *lpBuf*  
 目前的選取範圍中接收文字的緩衝區指標。  
  
### <a name="return-value"></a>傳回值  
 取決於表單：  
  
- **GetSelText (** `lpBuf` **)** 複製到的字元數*lpBuf*，但不包含 null 結束。  
  
- **GetSelText （)** 字串，包含目前的選取範圍。  
  
### <a name="remarks"></a>備註  
 如果您使用第一個表單， **GetSelText (** `lpBuf` **)**，您必須確定緩衝區是否夠大，它將會收到的文字。 呼叫[GetSel](#getsel)來判斷目前的選取範圍中的字元數。  
  
 如需詳細資訊，請參閱 < [EM_GETSELTEXT](/windows/desktop/Controls/em-getseltext) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[CRichEditCtrl::GetSelectionType](#getselectiontype)。  
  
##  <a name="gettextlength"></a>  CRichEditCtrl::GetTextLength  
 擷取文字的長度，以字元為單位，在此`CRichEditCtrl`物件，不包括結束的 null 字元。  
  
```  
long GetTextLength() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在這個文字的長度`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [WM_GETTEXTLENGTH](/windows/desktop/winmsg/wm-gettextlength) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]  
  
##  <a name="gettextlengthex"></a>  CRichEditCtrl::GetTextLengthEx  
 計算在 rich edit 控制項中文字的長度。  
  
```  
long GetTextLengthEx(
    DWORD dwFlags,  
    UINT uCodePage = -1) const;  
```  
  
### <a name="parameters"></a>參數  
 *dwFlags*  
 值，指定要用來判斷文字長度的方法。 這個成員可以是其中一個或多個值的旗標成員中所列[GETTEXTLENGTHEX](/windows/desktop/api/richedit/ns-richedit-_gettextlengthex) Windows SDK 中所述。  
  
 *uCodePage*  
 翻譯 （ANSI 字碼頁，Unicode 的 1200 cp_acp） 解譯的字碼頁。  
  
### <a name="return-value"></a>傳回值  
 字元或編輯控制項中的位元組數目。 如果在已設定不相容的旗標*dwFlags*，此成員函式會傳回 E_INVALIDARG。  
  
### <a name="remarks"></a>備註  
 `GetTextLengthEx` 提供其他方法可決定文字的長度。 它支援的 Rich Edit 2.0 功能。 請參閱[關於 Rich Edit 控制項](/windows/desktop/Controls/about-rich-edit-controls)Windows SDKfor 中的詳細資訊。  
  
##  <a name="gettextmode"></a>  CRichEditCtrl::GetTextMode  
 擷取目前文字模式和復原層級的 rich edit 控制項。  
  
```  
UINT GetTextMode() const;  
```  
  
### <a name="return-value"></a>傳回值  
 位元旗標，從一組[TEXTMODE](/windows/desktop/api/richedit/ne-richedit-tagtextmode)列舉型別，在 Windows SDK 中所述。 旗標會指出目前的文字模式，而且復原的控制層級。  
  
##  <a name="gettextrange"></a>  CRichEditCtrl::GetTextRange  
 取得指定的字元範圍。  
  
```  
int GetTextRange(
    int nFirst,  
    int nLast,  
    CString& refString) const;  
```  
  
### <a name="parameters"></a>參數  
 *nFirst*  
 立即在範圍中之前的第一個字元的字元位置的索引。  
  
 *n 上次*  
 緊接在範圍內的最後一個字元的字元位置。  
  
 *refString*  
 參考[CString](../../atl-mfc-shared/reference/cstringt-class.md)會收到文字的物件。  
  
### <a name="return-value"></a>傳回值  
 複製的字元數目，不包括結束的 null 字元。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_GETTEXTRANGE](/windows/desktop/Controls/em-gettextrange) Windows SDK 中。  
  
 `GetTextRange` 支援的 Rich Edit 2.0 功能。 請參閱[關於 Rich Edit 控制項](/windows/desktop/Controls/about-rich-edit-controls)Windows SDKfor 中的詳細資訊。  
  
##  <a name="getundoname"></a>  CRichEditCtrl::GetUndoName  
 如果有的話，請擷取復原佇列中的下一個可用動作的類型。  
  
```  
UNDONAMEID GetUndoName() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果復原動作會在控制項的復原佇列中，`GetUndoName`會傳回[UNDONAMEID](/windows/desktop/api/richedit/ne-richedit-_undonameid)表示佇列中的下一個動作類型的列舉型別。 如果復原佇列是空的或在佇列中的復原動作是否是未知的類型，`GetUndoName`會傳回 0。  
  
### <a name="remarks"></a>備註  
 可以復原或重做的動作類型包括輸入、 刪除、 拖放、 剪下和貼上作業。 這項資訊可用於進行復原和取消復原作業，例如可復原的動作的下拉式清單方塊中提供擴充的使用者介面的應用程式。  
  
##  <a name="getwordwrapmode"></a>  CRichEditCtrl::GetWordWrapMode  
 擷取目前的自動換行和 rich edit 控制項的 word 重大選項。  
  
```  
UINT GetWordWrapMode() const;  
```  
  
### <a name="return-value"></a>傳回值  
 目前的自動換行和斷詞的選項。 這些選項如下所述[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) Windows SDK 中。  
  
### <a name="remarks"></a>備註  
 此成員函式是作業系統的僅適用於亞洲語言版本。  
  
##  <a name="hideselection"></a>  CRichEditCtrl::HideSelection  
 變更選取項目的可見性。  
  
```  
void HideSelection(
    BOOL bHide,  
    BOOL bPerm);
```  
  
### <a name="parameters"></a>參數  
 *bHide*  
 指出是否選取項目應該要顯示或隱藏，則為 TRUE，隱藏選取範圍。  
  
 *bPerm*  
 指出是否在選取的可見性的這項變更應為永久性。  
  
### <a name="remarks"></a>備註  
 當*bPerm*為 TRUE 時，它會變更這個 ECO_NOHIDESEL 選項`CRichEditCtrl`物件。 此選項的簡短描述，請參閱 < [SetOptions](#setoptions)。 您可以使用此函式來設定所有的選項`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_HIDESELECTION](/windows/desktop/Controls/em-hideselection) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]  
  
##  <a name="limittext"></a>  CRichEditCtrl::LimitText  
 限制使用者可以輸入編輯控制項文字的長度。  
  
```  
void LimitText(long nChars = 0);
```  
  
### <a name="parameters"></a>參數  
 *nChars*  
 指定使用者可以輸入文字的長度 （以位元組為單位）。 如果此參數為 0 （預設值），文字長度設為 64k 位元組。  
  
### <a name="remarks"></a>備註  
 變更文字限制會限制只有使用者可以輸入的文字。 它不會影響任何文字中已有編輯控制項，也不會影響複製到編輯控制項的文字長度[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)成員函式中的`CWnd`。 如果應用程式使用`SetWindowText`函式，將更多的文字編輯控制項的呼叫中指定以外`LimitText`，使用者可以刪除任何編輯控制項中的文字。 不過，文字限制會防止使用者以新文字取代現有的文字，除非刪除目前選取範圍會導致低於文字限制的文字。  
  
> [!NOTE]
>  文字限制，每個 OLE 項目會計算為單一字元。  
  
 如需詳細資訊，請參閱 < [EM_EXLIMITTEXT](/windows/desktop/Controls/em-exlimittext) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]  
  
##  <a name="linefromchar"></a>  CRichEditCtrl::LineFromChar  
 擷取包含指定的字元索引的那一行的行號。  
  
```  
long LineFromChar(long nIndex) const;  
```  
  
### <a name="parameters"></a>參數  
 *nIndex*  
 包含編輯控制項的文字中所需的字元的以零為起始的索引值，或包含-1。 如果*nIndex*為-1，它會指定目前這一行，也就是包含插入號的行。  
  
### <a name="return-value"></a>傳回值  
 包含所指定的字元索引的那一行的以零為起始的行號*nIndex*。 如果*nIndex*為-1，會傳回包含選取範圍的第一個字元的行號。 如果沒有選取範圍，則會傳回目前的行號。  
  
### <a name="remarks"></a>備註  
 字元索引是 rich edit 控制項的開頭字元數。 用於字元計數，OLE 項目會視為單一字元。  
  
 如需詳細資訊，請參閱 < [EM_EXLINEFROMCHAR](/windows/desktop/Controls/em-exlinefromchar) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]  
  
##  <a name="lineindex"></a>  CRichEditCtrl::LineIndex  
 擷取中這一行的字元索引`CRichEditCtrl`物件。  
  
```  
int LineIndex(int nLine = -1) const;  
```  
  
### <a name="parameters"></a>參數  
 *n 行*  
 包含編輯控制項的文字行的索引值，或包含-1。 如果*n 行*為-1，它會指定目前這一行，也就是包含插入號的行。  
  
### <a name="return-value"></a>傳回值  
 在指定的行的字元索引*n 行*或-1 大於指定的行號，然後在編輯控制項中的行數。  
  
### <a name="remarks"></a>備註  
 字元索引是 rich edit 控制項的開頭到指定的行的字元數目。  
  
 如需詳細資訊，請參閱 < [EM_LINEINDEX](https://msdn.microsoft.com/library/windows/desktop/bb761611) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]  
  
##  <a name="linelength"></a>  CRichEditCtrl::LineLength  
 擷取 rich edit 控制項中的資料行的長度。  
  
```  
int LineLength(int nLine = -1) const;  
```  
  
### <a name="parameters"></a>參數  
 *n 行*  
 其長度是要擷取列中指定字元的字元索引。 如果這個參數是-1，會傳回目前的行 （包含插入號的行） 的長度，不包括任何選取的行內的文字。 當`LineLength`稱為單行編輯控制項，會忽略這個參數。  
  
### <a name="return-value"></a>傳回值  
 當`LineLength`稱為對於多行編輯控制項，傳回值是長度 （以 TCHAR) 所指定的行*n 行*。  它不包含行尾的歸位字元。 當`LineLength`稱為單行編輯控制項，傳回的值屬於的長度 （以 TCHAR) 編輯控制項中的文字。 如果 n 行大於控制項中的字元數，則傳回的值為零。
  
### <a name="remarks"></a>備註  
 使用[LineIndex](#lineindex)成員函式，以取得在這個給定的行號的字元索引`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_LINELENGTH](/windows/desktop/Controls/em-linelength) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[LineIndex](#lineindex)。  
  
##  <a name="linescroll"></a>  CRichEditCtrl::LineScroll  
 捲動的多行編輯控制項的文字。  
  
```  
void LineScroll(
    int nLines,  
    int nChars = 0);
```  
  
### <a name="parameters"></a>參數  
 *nLines*  
 指定要垂直捲動行的數。  
  
 *nChars*  
 指定以水平捲動的字元位置數目。 Rich edit 控制項是否 ES_RIGHT] 或是 [ES_CENTER 樣式，則會忽略此值。 [編輯樣式](../../mfc/reference/styles-used-by-mfc.md#edit-styles)括住[建立](#create)。  
  
### <a name="remarks"></a>備註  
 編輯控制項不會以垂直方式捲動過去的文字編輯控制項中的最後一行。 如果目前的行加上所指定的行數*nLines*超過的編輯控制項中的總行數，此值會調整，以便編輯控制項的最後一行會捲動至編輯控制項視窗的頂端。  
  
 `LineScroll` 可用來水平捲動的任一行之最後一個字元。  
  
 如需詳細資訊，請參閱 < [EM_LINESCROLL](/windows/desktop/Controls/em-linescroll) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[GetFirstVisibleLine](#getfirstvisibleline)。  
  
##  <a name="paste"></a>  CRichEditCtrl::Paste  
 將資料從剪貼簿`CRichEditCtrl`的插入點，插入號位置。  
  
```  
void Paste();
```  
  
### <a name="remarks"></a>備註  
 只有當剪貼簿包含可辨識的格式的資料插入資料。  
  
 如需詳細資訊，請參閱 < [WM_PASTE](/windows/desktop/dataxchg/wm-paste) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]  
  
##  <a name="pastespecial"></a>  CRichEditCtrl::PasteSpecial  
 將資料以特定的剪貼簿格式貼到這個`CRichEditCtrl`物件。  
  
```  
void PasteSpecial(
    UINT nClipFormat,  
    DWORD dvAspect = 0,  
    HMETAFILE hMF = 0);
```  
  
### <a name="parameters"></a>參數  
 *nClipFormat*  
 剪貼簿格式貼上這`CRichEditCtrl`物件。  
  
 *dvAspect*  
 若要從剪貼簿擷取資料的裝置外觀。  
  
 *hMF*  
 包含要貼上之物件的圖示檢視的中繼檔的控制代碼。  
  
### <a name="remarks"></a>備註  
 在插入點，插入號位置插入新的資料。  
  
 如需詳細資訊，請參閱 < [EM_PASTESPECIAL](/windows/desktop/Controls/em-pastespecial) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]  
  
##  <a name="posfromchar"></a>  CRichEditCtrl::PosFromChar  
 擷取指定的字元，在編輯控制項中的用戶端區域座標。  
  
```  
CPoint PosFromChar(UINT nChar) const;  
```  
  
### <a name="parameters"></a>參數  
 *NChar*  
 字元的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 字元、 （x，y） 的位置。 單行編輯控制項，y 座標永遠是零。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_POSFROMCHAR](/windows/desktop/Controls/em-posfromchar) Windows SDK 中。  
  
##  <a name="redo"></a>  CRichEditCtrl::Redo  
 重做控制項的重做佇列中的下一個動作。  
  
```  
BOOL Redo();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 如需詳細資訊，請參閱 < [EM_REDO](/windows/desktop/Controls/em-redo) Windows SDK 中。  
  
##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel  
 取代目前的選取範圍，在此`CRichEditCtrl`物件使用指定的文字。  
  
```  
void ReplaceSel(
    LPCTSTR lpszNewText,  
    BOOL bCanUndo = FALSE);
```  
  
### <a name="parameters"></a>參數  
 *lpszNewText*  
 以 null 終止的字串，包含取代文字的指標。  
  
 *bCanUndo*  
 若要指定此函式可以復原，設定此參數的值為 TRUE。 預設值為 FALSE。  
  
### <a name="remarks"></a>備註  
 在這所有的文字來取代`CRichEditCtrl`物件，請使用[CWnd::SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。  
  
 如果沒有目前的選取項目，取代文字會插入在插入點，也就是目前的插入號位置。  
  
 此函式會將現有的字元格式格式化插入的文字。 取代整份文字時 (藉由呼叫`SetSel`（0，-1） 再呼叫`ReplaceSel`)，沒有結尾段落字元會保留之前的段落格式，這在繼承的新插入的文字。  
  
 如需詳細資訊，請參閱 < [EM_REPLACESEL](/windows/desktop/Controls/em-replacesel) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[LineIndex](#lineindex)。  
  
##  <a name="requestresize"></a>  CRichEditCtrl::RequestResize  
 會強制此`CRichEditCtrl`EN_REQUESTRESIZE 通知訊息傳送至其父視窗的物件。  
  
```  
void RequestResize();
```  
  
### <a name="remarks"></a>備註  
 此函式是在期間非常有用[CWnd::OnSize](../../mfc/reference/cwnd-class.md#onsize)處理無底邊`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_REQUESTRESIZE](/windows/desktop/Controls/em-requestresize)訊息並**無底邊 Rich Edit 控制項**一節[關於 Rich Edit 控制項](/windows/desktop/Controls/about-rich-edit-controls)Windows SDK 中。  
  
##  <a name="setautourldetect"></a>  CRichEditCtrl::SetAutoURLDetect  
 設定自動偵測 URL 的 rich edit 控制項。  
  
```  
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *bEnable*  
 指定是否要將控制項設為自動偵測的 URL。 如果為 TRUE，它會將它啟用。 如果為 FALSE，它會停用。  
  
### <a name="return-value"></a>傳回值  
 如果成功，否則為非零的值為零。 例如，訊息可能會失敗，因為記憶體不足。  
  
### <a name="remarks"></a>備註  
 如果啟用，rich edit 控制項就會掃描要判斷它是否符合標準的 URL 格式的文字。 如需這些 URL 格式的清單，請參閱 < [EM_AUTOURLDETECT](/windows/desktop/Controls/em-autourldetect) Windows SDK 中。  
  
> [!NOTE]
>  請勿設定`SetAutoURLDetect`為 TRUE，如果您編輯的控制項使用 CFE_LINK 效果的 Url 以外的文字。 `SetAutoURLDetect` 啟用此效果的 Url 和停用它的所有其他的文字。 請參閱[EN_LINK](/windows/desktop/Controls/en-link)如 CFE_LINK 效果的詳細資訊。  
  
##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor  
 此設定的背景色彩`CRichEditCtrl`物件。  
  
```  
COLORREF SetBackgroundColor(
    BOOL bSysColor,  
    COLORREF cr);
```  
  
### <a name="parameters"></a>參數  
 *bSysColor*  
 表示是否應該設定的背景色彩的系統值。 如果此值為 TRUE， *cr*會被忽略。  
  
 *cr*  
 要求的背景色彩。 使用的才*bSysColor*為 FALSE。  
  
### <a name="return-value"></a>傳回值  
 先前的背景色彩，此`CRichEditCtrl`物件。  
  
### <a name="remarks"></a>備註  
 系統值，或指定，就可以設定的背景色彩[COLORREF](/windows/desktop/gdi/colorref)值。  
  
 如需詳細資訊，請參閱 < [EM_SETBKGNDCOLOR](/windows/desktop/Controls/em-setbkgndcolor)訊息並[COLORREF](/windows/desktop/gdi/colorref) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]  
  
##  <a name="setdefaultcharformat"></a>  CRichEditCtrl::SetDefaultCharFormat  
 設定格式化屬性在這個新的文字字元`CRichEditCtrl`物件。  
  
```  
BOOL SetDefaultCharFormat(CHARFORMAT& cf);  
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>參數  
 *cf*  
 在第一個版本中，指標[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)結構，其中包含新的預設字元格式的屬性。  
  
 在第二個版本中，指標[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)結構，也就是 Rich Edit 2.0 延伸模組來`CHARFORMAT`結構，包含預設字元格式的屬性。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 指定的屬性`dwMask`隸屬*cf*由此函式會變更。  
  
 如需詳細資訊，請參閱 < [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)訊息並`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]  
  
##  <a name="seteventmask"></a>  CRichEditCtrl::SetEventMask  
 設定事件遮罩這個`CRichEditCtrl`物件。  
  
```  
DWORD SetEventMask(DWORD dwEventMask);
```  
  
### <a name="parameters"></a>參數  
 *dwEventMask*  
 這個新的事件遮罩`CRichEditCtrl`物件。  
  
### <a name="return-value"></a>傳回值  
 先前的事件遮罩。  
  
### <a name="remarks"></a>備註  
 事件遮罩指定通知訊息`CRichEditCtrl`物件傳送至其父視窗。  
  
 如需詳細資訊，請參閱 < [EM_SETEVENTMASK](/windows/desktop/Controls/em-seteventmask) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]  
  
##  <a name="setmodify"></a>  CRichEditCtrl::SetModify  
 設定或清除編輯控制項修改的旗標。  
  
```  
void SetModify(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *bModified*  
 如果為 true 值表示已修改的文字，，和 FALSE 值，指出它是未經修改。 根據預設，會設定已修改的旗標。  
  
### <a name="remarks"></a>備註  
 修改的旗標表示已修改的文字編輯控制項中。 它會自動設定的每當使用者變更文字。 可以使用擷取該值[GetModify](#getmodify)成員函式。  
  
 如需詳細資訊，請參閱 < [EM_SETMODIFY](/windows/desktop/Controls/em-setmodify) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[GetModify](#getmodify)。  
  
##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback  
 提供此`CRichEditCtrl`物件`IRichEditOleCallback`物件，用來存取與 OLE 相關資源和資訊。  
  
```  
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```  
  
### <a name="parameters"></a>參數  
 *pCallback*  
 指標[IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback)物件這個`CRichEditCtrl`物件會使用以 OLE 相關資源和資訊。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 這`CRichEditCtrl`物件會呼叫[iunknown:: Addref](/windows/desktop/api/unknwn/nf-unknwn-iunknown-addref)遞增所指定的 COM 物件的使用計數*pCallback*。  
  
 如需詳細資訊，請參閱 < [EM_SETOLECALLBACK](/windows/desktop/Controls/em-setolecallback)訊息並[IRichEditOleCallback](/windows/desktop/api/richole/nn-richole-iricheditolecallback) Windows SDK 中的介面。  
  
##  <a name="setoptions"></a>  CRichEditCtrl::SetOptions  
 設定這個選項`CRichEditCtrl`物件。  
  
```  
void SetOptions(
    WORD wOp,  
    DWORD dwFlags);
```  
  
### <a name="parameters"></a>參數  
 *wOp*  
 表示作業的類型。 下列其中一個值：  
  
- ECOOP_SET 所指定的設定選項*dwFlags*。  
  
- ECOOP_OR 結合使用指定的選項的目前*dwFlags*。  
  
- ECOOP_AND 保留只目前的選項，也會藉由指定*dwFlags*。  
  
- ECOOP_XOR 邏輯互斥 OR 運算的目前選項所指定的*dwFlags*。  
  
 *dwFlags*  
 豐富的編輯選項。 旗標值詳列於 < 備註 > 一節。  
  
### <a name="remarks"></a>備註  
 選項可以是下列值的組合：  
  
- ECO_AUTOWORDSELECTION 自動文字選取範圍上的按兩下。  
  
- 當使用者在行結尾處輸入字元時，會自動 ECO_AUTOVSCROLL 捲動 10 個字元的文字靠右。 當使用者按下 ENTER 鍵時，捲動至位置為零的所有文字控制項。  
  
- 在使用者的最後一行按 ENTER 鍵時，會自動 ECO_AUTOHSCROLL 捲動一頁的文字。  
  
- ECO_NOHIDESEL 變換正負號的編輯控制項的預設行為。 當控制項失去輸入的焦點，並顯示選取項目，當控制項收到輸入的焦點時，預設的行為就會隱藏選取範圍。 如果您指定 ECO_NOHIDESEL，選取的文字被顛倒的即使控制項沒有焦點。  
  
- ECO_READONLY 可防止使用者輸入或編輯在編輯控制項中的文字。  
  
- ECO_WANTRETURN 指定當使用者按下 ENTER 鍵，同時在多行豐富輸入文字時，插入歸位字元，編輯控制項在對話方塊中。 如果您未指定此樣式，按下 ENTER 鍵會將命令傳送至 rich edit 控制項的父視窗，這會模擬按一下父視窗的預設按鈕 （例如，在對話方塊中 [確定] 按鈕）。 此樣式並不會影響單行編輯控制項。  
  
- ECO_SAVESEL 控制項失去焦點時，會保留選取項目。 根據預設，當它重新取得焦點時，會選取控制項的整個內容。  
  
- ECO_VERTICAL 繪製文字和以垂直方向的物件。 適用於亞洲語言的語言。  
  
 如需詳細資訊，請參閱 < [EM_SETOPTIONS](/windows/desktop/Controls/em-setoptions) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]  
  
##  <a name="setparaformat"></a>  CRichEditCtrl::SetParaFormat  
 設定段落格式屬性目前的選取範圍，在此`CRichEditCtrl`物件。  
  
```  
BOOL SetParaFormat(PARAFORMAT& pf);  
BOOL SetParaFormat(PARAFORMAT2& pf);
```  
  
### <a name="parameters"></a>參數  
 *pf*  
 在第一個版本中，指標[PARAFORMAT](/windows/desktop/api/richedit/ns-richedit-_paraformat)結構，其中包含新的預設段落格式屬性。  
  
 在第二個版本中，指標[PARAFORMAT2](/windows/desktop/api/richedit/ns-richedit-paraformat2)結構，也就是 Rich Edit 2.0 延伸模組來`PARAFORMAT`結構中，保留預設字元格式的屬性。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 指定的屬性`dwMask`隸屬*pf*由此函式會變更。  
  
 如需詳細資訊，請參閱 < [EM_SETPARAFORMAT](/windows/desktop/Controls/em-setparaformat)訊息並`PARAFORMAT`和`PARAFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]  
  
##  <a name="setpunctuation"></a>  CRichEditCtrl::SetPunctuation  
 設定在 rich edit 控制項中的標點符號。  
  
```  
BOOL SetPunctuation(
    UINT fType,  
    PUNCTUATION* lpPunc);
```  
  
### <a name="parameters"></a>參數  
 *fType*  
 標點符號的旗標。 如需可能值的清單，請參閱 < *fType*參數[EM_SETPUNCTUATION](/windows/desktop/Controls/em-setpunctuation) Windows SDK 中。  
  
 *lpPunc*  
 指標[標點符號](/windows/desktop/api/richedit/ns-richedit-_punctuation)結構，在 Windows SDK 中所述。  
  
### <a name="return-value"></a>傳回值  
 非零值，如果成功，否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式是適用於僅亞洲語言版本的作業系統。  
  
##  <a name="setreadonly"></a>  CRichEditCtrl::SetReadOnly  
 變更這個 ECO_READONLY 選項`CRichEditCtrl`物件。  
  
```  
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *bReadOnly*  
 表示如果這個`CRichEditCtrl`物件應該為唯讀。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 此選項的簡短描述，請參閱 < [SetOptions](#setoptions)。 您可以使用此函式來設定所有的選項`CRichEditCtrl`物件。  
  
 如需詳細資訊，請參閱 < [EM_SETREADONLY](/windows/desktop/Controls/em-setreadonly) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]  
  
##  <a name="setrect"></a>  CRichEditCtrl::SetRect  
 設定這個格式化矩形`CRichEditCtrl`物件。  
  
```  
void SetRect(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 *lpRect*  
 [CRect](../../atl-mfc-shared/reference/crect-class.md)或指標[RECT](../../mfc/reference/rect-structure1.md) ，指出格式化矩形的新界限。  
  
### <a name="remarks"></a>備註  
 格式化矩形是文字限制的矩形。 豐富的編輯控制項視窗的大小限制的矩形無關。 當這`CRichEditCtrl`第一次建立物件，格式化矩形是相同的視窗工作區的大小。 使用`SetRect`大於或小於豐富的編輯視窗進行格式化的矩形。  
  
 如需詳細資訊，請參閱 < [EM_SETRECT](/windows/desktop/Controls/em-setrect) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]  
  
##  <a name="setsel"></a>  CRichEditCtrl::SetSel  
 設定在這個選取項目`CRichEditCtrl`物件。  
  
```  
void SetSel(
    long nStartChar,  
    long nEndChar);  
  
void SetSel(CHARRANGE& cr);
```  
  
### <a name="parameters"></a>參數  
 *nStartChar*  
 選取範圍的第一個字元的以零為起始索引。  
  
 *nEndChar*  
 選取範圍的最後一個字元的以零為起始索引。  
  
 *cr*  
 [CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange)結構，其中包含目前的選取範圍的界限。  
  
### <a name="remarks"></a>備註  
 此函式的兩種形式提供替代的方式，來設定選取範圍的界限。 請依照下列這些形式的簡短描述：  
  
- **SetSel (** `cr` **)** 這個表單用`CHARRANGE`結構和其`cpMin`並`cpMax`設定界限的成員。  
  
- **SetSel (** `nStartChar` **，** `nEndChar` **)** 此表單可以使用的參數*nStartChar*和*nEndChar*設定界限。  
  
 插入號會放在所啟動的較大表示選取範圍結尾 (`cpMin`或是*nStartChar*) 和結束 (`cpMax`或是*nEndChar*) 索引。 此函式將內容捲動`CRichEditCtrl`以便顯示插入號。  
  
 若要在此選取所有文字`CRichEditCtrl`物件，請呼叫`SetSel`使用起始索引為 0 且結束索引為-1。  
  
 如需詳細資訊，請參閱 < [EM_EXSETSEL](/windows/desktop/Controls/em-exsetsel)訊息並[CHARRANGE](/windows/desktop/api/richedit/ns-richedit-_charrange) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
  範例，請參閱[GetSel](#getsel)。  
  
##  <a name="setselectioncharformat"></a>  CRichEditCtrl::SetSelectionCharFormat  
 設定字元，格式化目前選取範圍中的文字屬性`CRichEditCtrl`物件。  
  
```  
BOOL SetSelectionCharFormat(CHARFORMAT& cf);  
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>參數  
 *cf*  
 在第一個版本中，指標[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)結構，其中包含新的字元格式化屬性目前的選取範圍。  
  
 在第二個版本中，指標[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)結構，也就是 Rich Edit 2.0 延伸模組來`CHARFORMAT`結構，包含新的字元格式化目前選取範圍的屬性。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 指定的屬性`dwMask`隸屬*cf*由此函式會變更。  
  
 如需詳細資訊，請參閱 < [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)並`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]  
  
##  <a name="settargetdevice"></a>  CRichEditCtrl::SetTargetDevice  
 設定用於所見即所得的目標裝置與線條寬度 （所見即所得） 中格式化`CRichEditCtrl`物件。  
  
```  
BOOL SetTargetDevice(
    HDC hDC,  
    long lLineWidth);

 
BOOL SetTargetDevice(
    CDC& dc,  
    long lLineWidth);
```  
  
### <a name="parameters"></a>參數  
 *hDC*  
 新的目標裝置的裝置內容的控制代碼。  
  
 *lLineWidth*  
 要用來格式化的線條寬度。  
  
 *dc*  
 [CDC](../../mfc/reference/cdc-class.md)新的目標裝置。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 如果此函式成功，rich edit 控制項擁有的裝置做為參數傳遞的內容。 在此情況下，呼叫的函式不應終結的裝置內容。  
  
 如需詳細資訊，請參閱 < [EM_SETTARGETDEVICE](/windows/desktop/Controls/em-settargetdevice) Windows SDK 中。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]  
  
##  <a name="settextmode"></a>  CRichEditCtrl::SetTextMode  
 設定 rich edit 控制項的文字模式或復原與取消復原層級。  
  
```  
BOOL SetTextMode(UINT fMode);
```  
  
### <a name="parameters"></a>參數  
 *fMode*  
 指定控制項的文字模式和復原層級的參數的新設定。 如需可能值的清單，請參閱的模式參數[EM_SETTEXTMODE](/windows/desktop/Controls/em-settextmode) Windows SDK 中。  
  
### <a name="return-value"></a>傳回值  
 如果成功，否則為非零的值為零。  
  
### <a name="remarks"></a>備註  
 文字模式的描述，請參閱 Windows SDK 中的 EM_SETTEXTMODE。  
  
 如果控制項包含文字，此成員函式將會失敗。 若要確定控制項是空白，傳送[WM_SETTEXT](/windows/desktop/winmsg/wm-settext)訊息為空字串。  
  
##  <a name="setundolimit"></a>  CRichEditCtrl::SetUndoLimit  
 設定可以儲存在復原佇列中的動作的最大數目。  
  
```  
UINT SetUndoLimit(UINT nLimit);
```  
  
### <a name="parameters"></a>參數  
 *nLimit*  
 指定可儲存復原佇列中的動作的最大數目。 設定為零表示停用復原。  
  
### <a name="return-value"></a>傳回值  
 新的恢復動作進行充分的最大數目的編輯控制項。  
  
### <a name="remarks"></a>備註  
 根據預設，復原佇列中的動作數目上限為 100。 如果您增加這個數字時，必須有足夠的記憶體來容納新的數字。 為了達到最佳效能，設定最小的可能值的限制。  
  
##  <a name="setwordcharformat"></a>  CRichEditCtrl::SetWordCharFormat  
 設定字元，格式化目前選取的字，以此屬性`CRichEditCtrl`物件。  
  
```  
BOOL SetWordCharFormat(CHARFORMAT& cf);  
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```  
  
### <a name="parameters"></a>參數  
 *cf*  
 在第一個版本中，指標[CHARFORMAT](/windows/desktop/api/richedit/ns-richedit-_charformat)結構，其中包含新的字元格式設定屬性的目前選取的字。  
  
 在第二個版本中，指標[CHARFORMAT2](/windows/desktop/api/richedit/ns-richedit-charformat2a)結構，也就是 Rich Edit 2.0 延伸模組來`CHARFORMAT`結構，包含新的字元格式化目前選取的字屬性。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 指定的屬性`dwMask`隸屬*cf*由此函式會變更。  
  
 如需詳細資訊，請參閱 < [EM_SETCHARFORMAT](/windows/desktop/Controls/em-setcharformat)訊息並`CHARFORMAT`和`CHARFORMAT2`Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]  
  
##  <a name="setwordwrapmode"></a>  CRichEditCtrl::SetWordWrapMode  
 將豐富的自動換行和斷字功能選項的編輯控制項。  
  
```  
UINT SetWordWrapMode(UINT uFlags) const;  
```  
  
### <a name="parameters"></a>參數  
 *uFlags*  
 若要設定自動換行和斷詞選項。 如需可能的選項，請參閱[EM_SETWORDWRAPMODE](/windows/desktop/Controls/em-setwordwrapmode) Windows SDK 中。  
  
### <a name="return-value"></a>傳回值  
 目前的自動換行和斷字功能選項。  
  
### <a name="remarks"></a>備註  
 此訊息是作業系統的僅適用於亞洲語言版本。  
  
##  <a name="stopgrouptyping"></a>  CRichEditCtrl::StopGroupTyping  
 停止控制項收集其他輸入目前的復原動作的動作。  
  
```  
void StopGroupTyping();
```  
  
### <a name="remarks"></a>備註  
 如果到新的動作復原佇列中的任何，控制項就會儲存下, 一步 的輸入動作。  
  
 如需詳細資訊，請參閱 < [EM_STOPGROUPTYPING](/windows/desktop/Controls/em-stopgrouptyping) Windows SDK 中。  
  
##  <a name="streamin"></a>  CRichEditCtrl::StreamIn  
 取代此文字`CRichEditCtrl`物件中指定的輸入資料流的文字。  
  
```  
long StreamIn(
    int nFormat,  
    EDITSTREAM& es);
```  
  
### <a name="parameters"></a>參數  
 *nFormat*  
 指定的輸入的資料格式旗標。 如需詳細資訊，請參閱＜備註＞一節。  
  
 *es*  
 [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream)結構，指定輸入資料流。 如需詳細資訊，請參閱＜備註＞一節。  
  
### <a name="return-value"></a>傳回值  
 從輸入資料流讀取的字元數。  
  
### <a name="remarks"></a>備註  
 值*nFormat*必須是下列其中之一：  
  
- SF_TEXT 表示讀取純文字。  
  
- SF_RTF 表示讀取的文字和格式。  
  
 其中一個值可以結合 SFF_SELECTION。 如果指定 SFF_SELECTION`StreamIn`取代輸入資料流的內容中的目前的選取範圍。 如果未指定，`StreamIn`這整個內容取代`CRichEditCtrl`物件。  
  
 在 `EDITSTREAM`參數*es*，指定填滿的文字緩衝區的回呼函式。 此回呼函式稱為重複，直到用完的輸入資料流。  
  
 如需詳細資訊，請參閱 < [EM_STREAMIN](/windows/desktop/Controls/em-streamin)訊息並[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]  
  
 [!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]  
  
##  <a name="streamout"></a>  CRichEditCtrl::StreamOut  
 寫出這個內容`CRichEditCtrl`指定的輸出資料流的物件。  
  
```  
long StreamOut(
    int nFormat,  
    EDITSTREAM& es);
```  
  
### <a name="parameters"></a>參數  
 *nFormat*  
 指定的輸出資料的格式旗標。 如需詳細資訊，請參閱＜備註＞一節。  
  
 *es*  
 [EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream)結構，指定輸出資料流。 如需詳細資訊，請參閱＜備註＞一節。  
  
### <a name="return-value"></a>傳回值  
 寫入輸出資料流的字元數。  
  
### <a name="remarks"></a>備註  
 值*nFormat*必須是下列其中之一：  
  
- SF_TEXT 指出寫入純文字。  
  
- SF_RTF 表示寫入文字和格式。  
  
- SF_RTFNOOBJS 表示寫入文字和格式設定、 OLE 項目取代空格。  
  
- SF_TEXTIZED 表示寫入文字和格式設定，以文字表示的 OLE 項目。  
  
 這些值可以結合 SFF_SELECTION。 如果指定 SFF_SELECTION`StreamOut`寫出到輸出資料流目前的選取範圍。 如果未指定，`StreamOut`寫出這樣的整個內容`CRichEditCtrl`物件。  
  
 在 `EDITSTREAM`參數*es*，指定填滿的文字緩衝區的回呼函式。 此回呼函式稱為重複，直到用完的輸出資料流。  
  
 如需詳細資訊，請參閱 < [EM_STREAMOUT](/windows/desktop/Controls/em-streamout)訊息並[EDITSTREAM](/windows/desktop/api/richedit/ns-richedit-_editstream) Windows SDK 中的結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]  
  
 [!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]  
  
##  <a name="undo"></a>  CRichEditCtrl::Undo  
 復原上次作業的 rich edit 控制項中。  
  
```  
BOOL Undo();
```  
  
### <a name="return-value"></a>傳回值  
 如果復原作業成功則為非零否則就是 0。  
  
### <a name="remarks"></a>備註  
 復原作業也會復原。 例如，您可以在其中還原刪除的文字，與第一次呼叫`Undo`。 只要沒有任何中介的編輯作業，您可以移除第二個呼叫一次的文字`Undo`。  
  
 如需詳細資訊，請參閱 < [EM_UNDO](/windows/desktop/Controls/em-undo) Windows SDK 中。  
  
### <a name="example"></a>範例  
  範例，請參閱[CanUndo](#canundo)。  
  
## <a name="see-also"></a>另請參閱  
 [MFC 範例 WORDPAD](../../visual-cpp-samples.md)   
 [CWnd 類別](../../mfc/reference/cwnd-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [CEdit 類別](../../mfc/reference/cedit-class.md)   
 [CRichEditView 類別](../../mfc/reference/cricheditview-class.md)
