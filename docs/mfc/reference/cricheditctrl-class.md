---
title: CRichEditCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CRichEditCtrl
- AFXCMN/CRichEditCtrl
- AFXCMN/CRichEditCtrl::CRichEditCtrl
- AFXCMN/CRichEditCtrl::CanPaste
- AFXCMN/CRichEditCtrl::CanRedo
- AFXCMN/CRichEditCtrl::CanUndo
- AFXCMN/CRichEditCtrl::CharFromPos
- AFXCMN/CRichEditCtrl::Clear
- AFXCMN/CRichEditCtrl::Copy
- AFXCMN/CRichEditCtrl::Create
- AFXCMN/CRichEditCtrl::CreateEx
- AFXCMN/CRichEditCtrl::Cut
- AFXCMN/CRichEditCtrl::DisplayBand
- AFXCMN/CRichEditCtrl::EmptyUndoBuffer
- AFXCMN/CRichEditCtrl::FindText
- AFXCMN/CRichEditCtrl::FindWordBreak
- AFXCMN/CRichEditCtrl::FormatRange
- AFXCMN/CRichEditCtrl::GetCharPos
- AFXCMN/CRichEditCtrl::GetDefaultCharFormat
- AFXCMN/CRichEditCtrl::GetEventMask
- AFXCMN/CRichEditCtrl::GetFirstVisibleLine
- AFXCMN/CRichEditCtrl::GetIRichEditOle
- AFXCMN/CRichEditCtrl::GetLimitText
- AFXCMN/CRichEditCtrl::GetLine
- AFXCMN/CRichEditCtrl::GetLineCount
- AFXCMN/CRichEditCtrl::GetModify
- AFXCMN/CRichEditCtrl::GetOptions
- AFXCMN/CRichEditCtrl::GetParaFormat
- AFXCMN/CRichEditCtrl::GetPunctuation
- AFXCMN/CRichEditCtrl::GetRect
- AFXCMN/CRichEditCtrl::GetRedoName
- AFXCMN/CRichEditCtrl::GetSel
- AFXCMN/CRichEditCtrl::GetSelectionCharFormat
- AFXCMN/CRichEditCtrl::GetSelectionType
- AFXCMN/CRichEditCtrl::GetSelText
- AFXCMN/CRichEditCtrl::GetTextLength
- AFXCMN/CRichEditCtrl::GetTextLengthEx
- AFXCMN/CRichEditCtrl::GetTextMode
- AFXCMN/CRichEditCtrl::GetTextRange
- AFXCMN/CRichEditCtrl::GetUndoName
- AFXCMN/CRichEditCtrl::GetWordWrapMode
- AFXCMN/CRichEditCtrl::HideSelection
- AFXCMN/CRichEditCtrl::LimitText
- AFXCMN/CRichEditCtrl::LineFromChar
- AFXCMN/CRichEditCtrl::LineIndex
- AFXCMN/CRichEditCtrl::LineLength
- AFXCMN/CRichEditCtrl::LineScroll
- AFXCMN/CRichEditCtrl::Paste
- AFXCMN/CRichEditCtrl::PasteSpecial
- AFXCMN/CRichEditCtrl::PosFromChar
- AFXCMN/CRichEditCtrl::Redo
- AFXCMN/CRichEditCtrl::ReplaceSel
- AFXCMN/CRichEditCtrl::RequestResize
- AFXCMN/CRichEditCtrl::SetAutoURLDetect
- AFXCMN/CRichEditCtrl::SetBackgroundColor
- AFXCMN/CRichEditCtrl::SetDefaultCharFormat
- AFXCMN/CRichEditCtrl::SetEventMask
- AFXCMN/CRichEditCtrl::SetModify
- AFXCMN/CRichEditCtrl::SetOLECallback
- AFXCMN/CRichEditCtrl::SetOptions
- AFXCMN/CRichEditCtrl::SetParaFormat
- AFXCMN/CRichEditCtrl::SetPunctuation
- AFXCMN/CRichEditCtrl::SetReadOnly
- AFXCMN/CRichEditCtrl::SetRect
- AFXCMN/CRichEditCtrl::SetSel
- AFXCMN/CRichEditCtrl::SetSelectionCharFormat
- AFXCMN/CRichEditCtrl::SetTargetDevice
- AFXCMN/CRichEditCtrl::SetTextMode
- AFXCMN/CRichEditCtrl::SetUndoLimit
- AFXCMN/CRichEditCtrl::SetWordCharFormat
- AFXCMN/CRichEditCtrl::SetWordWrapMode
- AFXCMN/CRichEditCtrl::StopGroupTyping
- AFXCMN/CRichEditCtrl::StreamIn
- AFXCMN/CRichEditCtrl::StreamOut
- AFXCMN/CRichEditCtrl::Undo
helpviewer_keywords:
- CRichEditCtrl [MFC], CRichEditCtrl
- CRichEditCtrl [MFC], CanPaste
- CRichEditCtrl [MFC], CanRedo
- CRichEditCtrl [MFC], CanUndo
- CRichEditCtrl [MFC], CharFromPos
- CRichEditCtrl [MFC], Clear
- CRichEditCtrl [MFC], Copy
- CRichEditCtrl [MFC], Create
- CRichEditCtrl [MFC], CreateEx
- CRichEditCtrl [MFC], Cut
- CRichEditCtrl [MFC], DisplayBand
- CRichEditCtrl [MFC], EmptyUndoBuffer
- CRichEditCtrl [MFC], FindText
- CRichEditCtrl [MFC], FindWordBreak
- CRichEditCtrl [MFC], FormatRange
- CRichEditCtrl [MFC], GetCharPos
- CRichEditCtrl [MFC], GetDefaultCharFormat
- CRichEditCtrl [MFC], GetEventMask
- CRichEditCtrl [MFC], GetFirstVisibleLine
- CRichEditCtrl [MFC], GetIRichEditOle
- CRichEditCtrl [MFC], GetLimitText
- CRichEditCtrl [MFC], GetLine
- CRichEditCtrl [MFC], GetLineCount
- CRichEditCtrl [MFC], GetModify
- CRichEditCtrl [MFC], GetOptions
- CRichEditCtrl [MFC], GetParaFormat
- CRichEditCtrl [MFC], GetPunctuation
- CRichEditCtrl [MFC], GetRect
- CRichEditCtrl [MFC], GetRedoName
- CRichEditCtrl [MFC], GetSel
- CRichEditCtrl [MFC], GetSelectionCharFormat
- CRichEditCtrl [MFC], GetSelectionType
- CRichEditCtrl [MFC], GetSelText
- CRichEditCtrl [MFC], GetTextLength
- CRichEditCtrl [MFC], GetTextLengthEx
- CRichEditCtrl [MFC], GetTextMode
- CRichEditCtrl [MFC], GetTextRange
- CRichEditCtrl [MFC], GetUndoName
- CRichEditCtrl [MFC], GetWordWrapMode
- CRichEditCtrl [MFC], HideSelection
- CRichEditCtrl [MFC], LimitText
- CRichEditCtrl [MFC], LineFromChar
- CRichEditCtrl [MFC], LineIndex
- CRichEditCtrl [MFC], LineLength
- CRichEditCtrl [MFC], LineScroll
- CRichEditCtrl [MFC], Paste
- CRichEditCtrl [MFC], PasteSpecial
- CRichEditCtrl [MFC], PosFromChar
- CRichEditCtrl [MFC], Redo
- CRichEditCtrl [MFC], ReplaceSel
- CRichEditCtrl [MFC], RequestResize
- CRichEditCtrl [MFC], SetAutoURLDetect
- CRichEditCtrl [MFC], SetBackgroundColor
- CRichEditCtrl [MFC], SetDefaultCharFormat
- CRichEditCtrl [MFC], SetEventMask
- CRichEditCtrl [MFC], SetModify
- CRichEditCtrl [MFC], SetOLECallback
- CRichEditCtrl [MFC], SetOptions
- CRichEditCtrl [MFC], SetParaFormat
- CRichEditCtrl [MFC], SetPunctuation
- CRichEditCtrl [MFC], SetReadOnly
- CRichEditCtrl [MFC], SetRect
- CRichEditCtrl [MFC], SetSel
- CRichEditCtrl [MFC], SetSelectionCharFormat
- CRichEditCtrl [MFC], SetTargetDevice
- CRichEditCtrl [MFC], SetTextMode
- CRichEditCtrl [MFC], SetUndoLimit
- CRichEditCtrl [MFC], SetWordCharFormat
- CRichEditCtrl [MFC], SetWordWrapMode
- CRichEditCtrl [MFC], StopGroupTyping
- CRichEditCtrl [MFC], StreamIn
- CRichEditCtrl [MFC], StreamOut
- CRichEditCtrl [MFC], Undo
ms.assetid: 2be52788-822c-4c27-aafd-2471231e74eb
ms.openlocfilehash: b3c02c8c2754ce7edb40cff5e44efb74a16353fc
ms.sourcegitcommit: 180f63704f6ddd07a4172a93b179cf0733fd952d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/06/2019
ms.locfileid: "70741534"
---
# <a name="cricheditctrl-class"></a>CRichEditCtrl 類別

提供 Windows Rich Edit 控制項的功能。

## <a name="syntax"></a>語法

```
class CRichEditCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CRichEditCtrl::CRichEditCtrl](#cricheditctrl)|建構 `CRichEditCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CRichEditCtrl::CanPaste](#canpaste)|決定是否可以將剪貼簿的內容貼入這個 rich edit 控制項。|
|[CRichEditCtrl::CanRedo](#canredo)|判斷控制項的重做佇列中是否有任何動作。|
|[CRichEditCtrl::CanUndo](#canundo)|決定是否可以復原編輯作業。|
|[CRichEditCtrl::CharFromPos](#charfrompos)|在編輯控制項的工作區中，抓取最接近指定點之字元的相關資訊。|
|[CRichEditCtrl::Clear](#clear)|清除目前的選取範圍。|
|[CRichEditCtrl::Copy](#copy)|將目前的選取範圍複製到剪貼簿。|
|[CRichEditCtrl::Create](#create)|建立 Windows rtf 編輯控制項，並將其與這個`CRichEditCtrl`物件相關聯。|
|[CRichEditCtrl::CreateEx](#createex)|使用指定的擴充視窗樣式建立 Windows rich edit 控制項，並將其與這個`CRichEditCtrl`物件相關聯。|
|[CRichEditCtrl::Cut](#cut)|將目前的選取範圍剪下至剪貼簿。|
|[CRichEditCtrl::DisplayBand](#displayband)|顯示此`CRichEditCtrl`物件的部分內容。|
|[CRichEditCtrl::EmptyUndoBuffer](#emptyundobuffer)|重設（清除）這個`CRichEditCtrl`物件的復原旗標。|
|[CRichEditCtrl::FindText](#findtext)|尋找這個`CRichEditCtrl`物件內的文字。|
|[CRichEditCtrl::FindWordBreak](#findwordbreak)|尋找在指定的字元位置之前或之後的下一個斷詞，或抓取該位置之字元的相關資訊。|
|[CRichEditCtrl::FormatRange](#formatrange)|格式化目標輸出裝置的文字範圍。|
|[CRichEditCtrl::GetCharPos](#getcharpos)|判斷這個`CRichEditCtrl`物件中指定字元的位置。|
|[CRichEditCtrl::GetDefaultCharFormat](#getdefaultcharformat)|抓取此`CRichEditCtrl`物件中目前的預設字元格式屬性。|
|[CRichEditCtrl::GetEventMask](#geteventmask)|抓取這個`CRichEditCtrl`物件的事件遮罩。|
|[CRichEditCtrl::GetFirstVisibleLine](#getfirstvisibleline)|決定此`CRichEditCtrl`物件中最上層的可見線。|
|[CRichEditCtrl::GetIRichEditOle](#getiricheditole)|抓取此 rich edit 控制項`IRichEditOle`介面的指標。|
|[CRichEditCtrl::GetLimitText](#getlimittext)|取得使用者可在此`CRichEditCtrl`物件中輸入的文字量限制。|
|[CRichEditCtrl::GetLine](#getline)|從此`CRichEditCtrl`物件抓取一行文字。|
|[CRichEditCtrl::GetLineCount](#getlinecount)|抓取此`CRichEditCtrl`物件中的行數。|
|[CRichEditCtrl::GetModify](#getmodify)|判斷這個`CRichEditCtrl`物件的內容在上次儲存之後是否已變更。|
|[CRichEditCtrl::GetOptions](#getoptions)|抓取 rich edit 控制項選項。|
|[CRichEditCtrl::GetParaFormat](#getparaformat)|抓取此`CRichEditCtrl`物件中目前選取範圍內的段落格式屬性。|
|[CRichEditCtrl::GetPunctuation](#getpunctuation)|抓取 rich edit 控制項的目前標點符號字元。 此訊息僅適用于作業系統的亞洲語言版本。|
|[CRichEditCtrl::GetRect](#getrect)|抓取這個`CRichEditCtrl`物件的格式化矩形。|
|[CRichEditCtrl::GetRedoName](#getredoname)|在控制項的重做佇列中，捕獲下一個動作的類型（如果有的話）。|
|[CRichEditCtrl::GetSel](#getsel)|取得這個`CRichEditCtrl`物件中目前選取範圍的開始和結束位置。|
|[CRichEditCtrl::GetSelectionCharFormat](#getselectioncharformat)|抓取此`CRichEditCtrl`物件中目前選取範圍內的字元格式屬性。|
|[CRichEditCtrl::GetSelectionType](#getselectiontype)|抓取此`CRichEditCtrl`物件中目前選取範圍內的內容類型。|
|[CRichEditCtrl::GetSelText](#getseltext)|取得此`CRichEditCtrl`物件中目前選取範圍的文字|
|[CRichEditCtrl::GetTextLength](#gettextlength)|抓取此`CRichEditCtrl`物件中文字的長度（以字元為單位）。 不包含終止的 null 字元。|
|[CRichEditCtrl::GetTextLengthEx](#gettextlengthex)|抓取 rich edit 視圖中的字元數或位元組數。 接受旗標清單，以指示在 rich edit 控制項中判斷文字長度的方法|
|[CRichEditCtrl::GetTextMode](#gettextmode)|抓取 rich edit 控制項的目前文字模式和復原層級。|
|[CRichEditCtrl::GetTextRange](#gettextrange)|抓取指定的文字範圍。|
|[CRichEditCtrl::GetUndoName](#getundoname)|抓取下一個復原動作的類型（如果有的話）。|
|[CRichEditCtrl::GetWordWrapMode](#getwordwrapmode)|抓取 rich edit 控制項的目前文字換行和斷詞選項。 此訊息僅適用于作業系統的亞洲語言版本。|
|[CRichEditCtrl::HideSelection](#hideselection)|顯示或隱藏目前的選取範圍。|
|[CRichEditCtrl::LimitText](#limittext)|限制使用者可在`CRichEditCtrl`物件中輸入的文字數量。|
|[CRichEditCtrl::LineFromChar](#linefromchar)|判斷哪一行包含指定的字元。|
|[CRichEditCtrl::LineIndex](#lineindex)|抓取此`CRichEditCtrl`物件中指定行的字元索引。|
|[CRichEditCtrl::LineLength](#linelength)|抓取此`CRichEditCtrl`物件中指定行的長度。|
|[CRichEditCtrl::LineScroll](#linescroll)|滾動此`CRichEditCtrl`物件中的文字。|
|[CRichEditCtrl::Paste](#paste)|將剪貼簿的內容插入這個 rich edit 控制項。|
|[CRichEditCtrl::PasteSpecial](#pastespecial)|以指定的資料格式，將剪貼簿的內容插入此 rich edit 控制項。|
|[CRichEditCtrl::PosFromChar](#posfromchar)|抓取編輯控制項中指定之字元的工作區座標。|
|[CRichEditCtrl::Redo](#redo)|重新執行控制項的重做佇列中的下一個動作。|
|[CRichEditCtrl::ReplaceSel](#replacesel)|以指定的文字取代這個`CRichEditCtrl`物件中目前的選取範圍。|
|[CRichEditCtrl::RequestResize](#requestresize)|強制此`CRichEditCtrl`物件傳送要求調整大小通知。|
|[CRichEditCtrl::SetAutoURLDetect](#setautourldetect)|指出 rich edit 控制項中的自動 URL 偵測是否為作用中。|
|[CRichEditCtrl::SetBackgroundColor](#setbackgroundcolor)|設定這個`CRichEditCtrl`物件中的背景色彩。|
|[CRichEditCtrl::SetDefaultCharFormat](#setdefaultcharformat)|設定這個`CRichEditCtrl`物件中目前的預設字元格式屬性。|
|[CRichEditCtrl::SetEventMask](#seteventmask)|設定這個`CRichEditCtrl`物件的事件遮罩。|
|[CRichEditCtrl::SetModify](#setmodify)|設定或清除此`CRichEditCtrl`物件的修改旗標。|
|[CRichEditCtrl::SetOLECallback](#setolecallback)|設定這個`IRichEditOleCallback` rich edit 控制項的 COM 物件。|
|[CRichEditCtrl::SetOptions](#setoptions)|設定這個`CRichEditCtrl`物件的選項。|
|[CRichEditCtrl::SetParaFormat](#setparaformat)|設定此`CRichEditCtrl`物件中目前選取範圍內的段落格式屬性。|
|[CRichEditCtrl::SetPunctuation](#setpunctuation)|設定 rich edit 控制項的標點符號字元。 此訊息僅適用于作業系統的亞洲語言版本。|
|[CRichEditCtrl::SetReadOnly](#setreadonly)|設定這個`CRichEditCtrl`物件的唯讀選項。|
|[CRichEditCtrl::SetRect](#setrect)|設定這個`CRichEditCtrl`物件的格式化矩形。|
|[CRichEditCtrl::SetSel](#setsel)|設定此`CRichEditCtrl`物件中的選取範圍。|
|[CRichEditCtrl::SetSelectionCharFormat](#setselectioncharformat)|設定這個`CRichEditCtrl`物件中目前選取範圍內的字元格式屬性。|
|[CRichEditCtrl::SetTargetDevice](#settargetdevice)|設定這個`CRichEditCtrl`物件的目標輸出裝置。|
|[CRichEditCtrl::SetTextMode](#settextmode)|設定 rich edit 控制項的文字模式或復原層級。 如果控制項包含文字，訊息就會失敗。|
|[CRichEditCtrl::SetUndoLimit](#setundolimit)|設定可儲存在復原佇列中的動作數目上限。|
|[CRichEditCtrl::SetWordCharFormat](#setwordcharformat)|設定這個`CRichEditCtrl`物件中目前單字的字元格式屬性。|
|[CRichEditCtrl::SetWordWrapMode](#setwordwrapmode)|設定 rich edit 控制項的自動換行和斷字選項。 此訊息僅適用于作業系統的亞洲語言版本。|
|[CRichEditCtrl::StopGroupTyping](#stopgrouptyping)|停止控制項，使其無法在目前的復原動作中收集其他輸入動作。 控制項會將下一個輸入動作（如果有的話）儲存至復原佇列中的新動作。|
|[CRichEditCtrl::StreamIn](#streamin)|將輸入資料流程中的文字插入這個`CRichEditCtrl`物件。|
|[CRichEditCtrl::StreamOut](#streamout)|將此`CRichEditCtrl`物件的文字儲存至輸出資料流程。|
|[CRichEditCtrl::Undo](#undo)|反轉上次編輯作業。|

## <a name="remarks"></a>備註

「Rich edit 控制項」是一種視窗，使用者可以在其中輸入和編輯文字。 文字可以被指派字元和段落格式，而且可以包含內嵌的 OLE 物件。 Rich edit 控制項會提供用來格式化文字的程式設計介面。 然而，應用程式必須實作所有必要的使用者介面元件，讓使用者能夠執行格式化作業。

這個 Windows 通用控制項（因此`CRichEditCtrl`類別）僅適用于在 windows 95/98 和 windows NT 3.51 版和更新版本下執行的程式。 `CRichEditCtrl`類別支援 Windows SDK rich edit 控制項的2.0 和3.0 版。

> [!CAUTION]
>  如果您在對話方塊中使用 rich edit 控制項（不論您的應用程式是 SDI、MDI 還是以對話方塊為基礎），就必須在對話方塊顯示之前呼叫[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)一次。 呼叫這個函式的一般位置是在程式的 `InitInstance` 成員函式中。 只需在第一次顯示對話方塊時呼叫它一次。 如果您使用 `AfxInitRichEdit`，不需要呼叫 `CRichEditView`。

如需有關使用`CRichEditCtrl`的詳細資訊，請參閱：

- [控制項](../../mfc/controls-mfc.md)

- [使用 CRichEditCtrl](../../mfc/using-cricheditctrl.md)

如需在 MFC 應用程式中使用 rich edit 控制項的範例，請參閱[WORDPAD](../../overview/visual-cpp-samples.md)範例應用程式。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CRichEditCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

##  <a name="canpaste"></a>CRichEditCtrl：： CanPaste

決定 rich edit 控制項是否可以貼上指定的剪貼簿格式。

```
BOOL CanPaste(UINT nFormat = 0) const;
```

### <a name="parameters"></a>參數

*nFormat*<br/>
要查詢的剪貼簿資料格式。 這個參數可以是其中一個預先定義的剪貼簿格式，或[RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)所傳回的值。

### <a name="return-value"></a>傳回值

如果可以貼上剪貼簿格式，則為非零。否則為0。

### <a name="remarks"></a>備註

如果*nFormat*為0， `CanPaste`將會嘗試任何目前在剪貼簿上的格式。

如需詳細資訊，請參閱 Windows SDK 中的[EM_CANPASTE](/windows/win32/Controls/em-canpaste)訊息和[RegisterClipboardFormat](/windows/win32/api/winuser/nf-winuser-registerclipboardformatw)函數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#1](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_1.cpp)]

##  <a name="canredo"></a>CRichEditCtrl：： CanRedo

判斷重做佇列是否包含任何動作。

```
BOOL CanRedo() const;
```

### <a name="return-value"></a>傳回值

如果重做佇列包含動作，則為非零，否則為0。

### <a name="remarks"></a>備註

若要探索重做佇列中的作業名稱，請呼叫[CRichEditCtrl：： GetRedoName](#getredoname)。 若要重做最近的復原作業，請呼叫[redo](#redo)。

如需詳細資訊，請參閱 Windows SDK 中的[EM_CANREDO](/windows/win32/Controls/em-canredo) 。

##  <a name="canundo"></a>CRichEditCtrl：： CanUndo

判斷上次編輯作業是否可以復原。

```
BOOL CanUndo() const;
```

### <a name="return-value"></a>傳回值

如果上次編輯作業可以藉由呼叫[Undo](#undo)成員函式來復原，則為非零值;如果無法復原，則為0。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_CANUNDO](/windows/win32/Controls/em-canundo) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#2](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_2.cpp)]

##  <a name="charfrompos"></a>CRichEditCtrl：： CharFromPos

在參數*pt*所指定的點上，抓取字元的相關資訊。

```
int CharFromPos(CPoint pt) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
包含指定點座標的[CPoint](../../atl-mfc-shared/reference/cpoint-class.md)物件。

### <a name="return-value"></a>傳回值

最接近指定點的字元之以零為基底的字元索引。 如果指定的點超出控制項中的最後一個字元，則傳回值會指出控制項中的最後一個字元。

### <a name="remarks"></a>備註

這個成員函式可與 rich edit 控制項搭配使用。 若要取得編輯控制項的資訊，請呼叫[CEdit：： CharFromPos](../../mfc/reference/cedit-class.md#charfrompos)。

如需詳細資訊，請參閱 Windows SDK 中的[EM_CHARFROMPOS](/windows/win32/Controls/em-charfrompos) 。

##  <a name="clear"></a>CRichEditCtrl：： Clear

刪除（清除） rich edit 控制項中目前的選取範圍（如果有的話）。

```
void Clear();
```

### <a name="remarks"></a>備註

您`Clear`可以藉由呼叫[Undo](#undo)成員函式來復原所執行的刪除作業。

若要刪除目前的選取範圍，並將已刪除的內容放在剪貼簿上，請呼叫[剪](#cut)下成員函式。

如需詳細資訊，請參閱 Windows SDK 中的[WM_CLEAR](/windows/win32/dataxchg/wm-clear) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#3](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_3.cpp)]

##  <a name="copy"></a>CRichEditCtrl：： Copy

將 rich edit 控制項中目前的選取範圍（如果有的話）複製到剪貼簿。

```
void Copy();
```

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[WM_COPY](/windows/win32/dataxchg/wm-copy) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#4](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_4.cpp)]

##  <a name="create"></a>CRichEditCtrl：： Create

建立 Windows rtf 編輯控制項，並將其與這個`CRichEditCtrl`物件相關聯。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定編輯控制項的樣式。 套用下面 [**備註**] 一節所列的視窗樣式組合，以及 [[編輯控制項樣式](/windows/win32/Controls/edit-control-styles)]，如 Windows SDK 中所述。

*rect*<br/>
指定編輯控制項的大小和位置。 可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[矩形](/windows/win32/api/windef/ns-windef-rect)結構。

*pParentWnd*<br/>
指定編輯控制項的父視窗（通常是[CDialog](../../mfc/reference/cdialog-class.md)）。 不得為 Null。

*nID*<br/>
指定編輯控制項的識別碼。

### <a name="return-value"></a>傳回值

如果初始化成功，則為非零;否則為0。

### <a name="remarks"></a>備註

您可以使用`CRichEditCtrl`兩個步驟來建立物件。 首先，呼叫[CRichEditCtrl](#cricheditctrl)的函式，然後`Create`呼叫，它會建立 Windows 編輯控制項並將它`CRichEditCtrl`附加至物件。

當您使用此函式建立 rich edit 控制項時，必須先載入必要的通用控制項程式庫。 若要載入程式庫，請呼叫全域函式[AfxInitRichEdit](application-information-and-management.md#afxinitrichedit)，這會接著初始化通用控制項程式庫。 您只需要在`AfxInitRichEdit`進程中呼叫一次。

當`Create`執行時，Windows 會將[WM_NCCREATE](../../mfc/reference/cwnd-class.md#onnccreate)、 [WM_NCCALCSIZE](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [WM_CREATE](../../mfc/reference/cwnd-class.md#oncreate)和[WM_GETMINMAXINFO](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)訊息傳送至編輯控制項。

根據預設，這些`CWnd`訊息會由基類中的[OnNcCreate](../../mfc/reference/cwnd-class.md#onnccreate)、 [OnNcCalcSize](../../mfc/reference/cwnd-class.md#onnccalcsize)、 [OnCreate](../../mfc/reference/cwnd-class.md#oncreate)和[OnGetMinMaxInfo](../../mfc/reference/cwnd-class.md#ongetminmaxinfo)成員函式來處理。 若要擴充預設訊息處理，請從`CRichEditCtrl`衍生類別，將訊息對應加入至新的類別，並覆寫上述的訊息處理常式成員函式。 例如`OnCreate`，覆寫以執行新類別所需的初始化。

將下列[視窗樣式](../../mfc/reference/styles-used-by-mfc.md#window-styles)套用至編輯控制項。

- WS_CHILD 一律為。

- 通常是 WS_VISIBLE。

- WS_DISABLED 很少。

- WS_GROUP 至 [群組] 控制項。

- WS_TABSTOP 以在 tab 鍵順序中包含編輯控制項。

如需視窗樣式的詳細資訊，請參閱 Windows SDK 中的[CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#5](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_5.cpp)]

##  <a name="createex"></a>CRichEditCtrl：： CreateEx

建立控制項（子視窗），並將它與`CRichEditCtrl`物件產生關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定所要建立之控制項的延伸樣式。 如需擴充 Windows 樣式的清單，請參閱 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定編輯控制項的樣式。 套用 [[建立](#create)和[編輯控制項樣式](/windows/win32/Controls/edit-control-styles)] 的 [**備註**] 區段中所列的視窗樣式組合，如 Windows SDK 中所述。

*rect*<br/>
[矩形](/previous-versions/dd162897\(v=vs.85\))結構的參考，描述要建立之視窗的大小和位置，以*pParentWnd*的用戶端座標表示。

*pParentWnd*<br/>
做為控制項父系之視窗的指標。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而非來套用擴充的 windows 樣式（由 Windows 擴充樣式指定于 WS_EX_ 的前面） `Create` 。

##  <a name="cricheditctrl"></a>CRichEditCtrl：： CRichEditCtrl

建構 `CRichEditCtrl` 物件。

```
CRichEditCtrl();
```

### <a name="remarks"></a>備註

使用 [[建立](#create)] 來建立 Windows rich edit 控制項。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#6](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_6.cpp)]

##  <a name="cut"></a>CRichEditCtrl：： Cut

刪除（剪下） rich edit 控制項中目前的選取範圍（如果有的話），並將刪除的文字複製到剪貼簿。

```
void Cut();
```

### <a name="remarks"></a>備註

您`Cut`可以藉由呼叫[Undo](#undo)成員函式來復原所執行的刪除作業。

若要刪除目前的選取範圍，而不將已刪除的文字放入剪貼簿中，請呼叫[Clear](#clear)成員函式。

如需詳細資訊，請參閱 Windows SDK 中的[WM_CUT](/windows/win32/dataxchg/wm-cut) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#7](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_7.cpp)]

##  <a name="displayband"></a>CRichEditCtrl：:D isplayBand

顯示 rich edit 控制項（文字和 OLE 專案）的部分內容，如先前的[FormatRange](#formatrange)格式。

```
BOOL DisplayBand(LPRECT pDisplayRect);
```

### <a name="parameters"></a>參數

*pDisplayRect*<br/>
[RECT](/windows/win32/api/windef/ns-windef-rect)或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件的指標，指定要顯示文字的裝置區域。

### <a name="return-value"></a>傳回值

如果格式化文字的顯示成功，則為非零，否則為0。

### <a name="remarks"></a>備註

文字和 OLE 專案會裁剪至指標*pDisplayRect*所指定的區域。

如需詳細資訊，請參閱 Windows SDK 中的[EM_DISPLAYBAND](/windows/win32/Controls/em-displayband) 。

### <a name="example"></a>範例

  請參閱[CRichEditCtrl：： FormatRange](#formatrange)的範例。

##  <a name="emptyundobuffer"></a>CRichEditCtrl：： EmptyUndoBuffer

重設（清除）此 rich edit 控制項的復原旗標。

```
void EmptyUndoBuffer();
```

### <a name="remarks"></a>備註

控制項現在將無法復原最後編輯的作業。 當 rich edit 控制項內的作業可以復原時，就會設定 undo 旗標。

每當您呼叫[CWnd](../../mfc/reference/cwnd-class.md)成員函式[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)時，就會自動清除復原旗標。

如需詳細資訊，請參閱 Windows SDK 中的[EM_EMPTYUNDOBUFFER](/windows/win32/Controls/em-emptyundobuffer) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#8](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_8.cpp)]

##  <a name="findtext"></a>CRichEditCtrl：： FindText

尋找 rich edit 控制項中的文字。

```
long FindText(
    DWORD dwFlags,
    FINDTEXTEX* pFindText) const;
```

### <a name="parameters"></a>參數

*dwFlags*<br/>
如需可能值的清單，請參閱 Windows SDK 中[EM_FINDTEXTEXT](/windows/win32/Controls/em-findtextex)的*wParam* 。

*pFindText*<br/>
[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)結構的指標，提供搜尋的參數，並傳回找到相符項的範圍。

### <a name="return-value"></a>傳回值

下一個相符的以零為基底的字元位置;如果沒有相符專案，則為-1。

### <a name="remarks"></a>備註

您可以在`FINDTEXTEX`結構內的[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構中設定適當的範圍參數，以向上或向下搜尋。

如需詳細資訊，請參閱 Windows SDK 中的[EM_FINDTEXTEX](/windows/win32/Controls/em-findtextex)訊息和[FINDTEXTEX](/windows/win32/api/richedit/ns-richedit-findtextexw)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#9](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_9.cpp)]

##  <a name="findwordbreak"></a>CRichEditCtrl：： FindWordBreak

尋找*n 開始*指定之位置之前或之後的下一個斷詞。

```
DWORD FindWordBreak(
    UINT nCode,
    DWORD nStart) const;
```

### <a name="parameters"></a>參數

*nCode*<br/>
表示要採取的動作。 如需可能值的清單，請參閱 Windows SDK 中 EM_FINDWORDBREAK 之參數程式*代碼*的描述。

*nStart*<br/>
要從其開始之以零為起始的字元位置。

### <a name="return-value"></a>傳回值

根據參數*nCode*。 如需詳細資訊，請參閱 Windows SDK 中的[EM_FINDWORDBREAK](/windows/win32/Controls/em-findwordbreak) 。

### <a name="remarks"></a>備註

您可以使用這個成員函式來抓取指定位置之字元的相關資訊。

##  <a name="formatrange"></a>CRichEditCtrl：： FormatRange

針對特定裝置，格式化 rich edit 控制項中的文字範圍。

```
long FormatRange(
    FORMATRANGE* pfr,
    BOOL bDisplay = TRUE);
```

### <a name="parameters"></a>參數

*pfr*<br/>
[FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange)結構的指標，其中包含輸出裝置的相關資訊。 Null 表示可以釋放 rich edit 控制項中的快取資訊。

*bDisplay*<br/>
指出是否應該呈現文字。 如果為 FALSE，則只會測量文字。

### <a name="return-value"></a>傳回值

符合區域加一的最後一個字元的索引。

### <a name="remarks"></a>備註

一般來說，此呼叫會接著呼叫[DisplayBand](#displayband)。

如需詳細資訊，請參閱 Windows SDK 中的[EM_FORMATRANGE](/windows/win32/Controls/em-formatrange)訊息和[FORMATRANGE](/windows/win32/api/richedit/ns-richedit-formatrange)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#10](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_10.cpp)]

##  <a name="getcharpos"></a>CRichEditCtrl：： GetCharPos

取得這個`CRichEditCtrl`物件內指定字元的位置（左上角）。

```
CPoint GetCharPos(long lChar) const;
```

### <a name="parameters"></a>參數

*lChar*<br/>
以零為基底的字元索引。

### <a name="return-value"></a>傳回值

*LChar*所指定之字元的左上角位置。

### <a name="remarks"></a>備註

字元是藉由提供其以零為基底的索引值來指定。 如果*lChar*大於這個`CRichEditCtrl`物件中最後一個字元的索引，則傳回值會指定緊接在這個`CRichEditCtrl`物件中最後一個字元之後的字元位置座標。

如需詳細資訊，請參閱 Windows SDK 中的[EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) 。

##  <a name="getdefaultcharformat"></a>CRichEditCtrl：： GetDefaultCharFormat

取得這個`CRichEditCtrl`物件的預設字元格式屬性。

```
DWORD GetDefaultCharFormat(CHARFORMAT& cf) const;  DWORD GetDefaultCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中，包含預設字元`CHARFORMAT`格式屬性之結構的指標。

在第二個版本中， `CHARFORMAT2`結構的指標，這是`CHARFORMAT`結構的豐富編輯2.0 延伸模組，保留預設的字元格式屬性。

### <a name="return-value"></a>傳回值

Cf `dwMask`的資料成員。它指定了預設的字元格式屬性。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 EM_GETCHARFORMAT 訊息和`CHARFORMAT` Windows SDK `CHARFORMAT2`中的和結構。

### <a name="example"></a>範例

  請參閱[SetDefaultCharFormat](#setdefaultcharformat)的範例。

##  <a name="geteventmask"></a>CRichEditCtrl：： GetEventMask

取得這個`CRichEditCtrl`物件的事件遮罩。

```
long GetEventMask() const;
```

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件的事件遮罩。

### <a name="remarks"></a>備註

事件遮罩會指定`CRichEditCtrl`物件傳送至其父視窗的通知訊息。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETEVENTMASK](/windows/win32/Controls/em-geteventmask) 。

### <a name="example"></a>範例

  請參閱[CRichEditCtrl：： SetEventMask](#seteventmask)的範例。

##  <a name="getfirstvisibleline"></a>CRichEditCtrl：： GetFirstVisibleLine

決定此`CRichEditCtrl`物件中最上層的可見線。

```
int GetFirstVisibleLine() const;
```

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件中最上方可見行的以零為起始的索引。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETFIRSTVISIBLELINE](/windows/win32/Controls/em-getfirstvisibleline) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#11](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_11.cpp)]

##  <a name="getiricheditole"></a>  CRichEditCtrl::GetIRichEditOle

存取此`IRichEditOle` `CRichEditCtrl`物件的介面。

```
IRichEditOle* GetIRichEditOle() const;
```

### <a name="return-value"></a>傳回值

[IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole)介面的指標，可用於存取此`CRichEditCtrl`物件的 OLE 功能;如果無法存取介面，則為 Null。

### <a name="remarks"></a>備註

使用此介面來存取此`CRichEditCtrl`物件的 OLE 功能。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETOLEINTERFACE](/windows/win32/Controls/em-getoleinterface)訊息和[IRichEditOle](/windows/win32/api/richole/nn-richole-iricheditole)介面。

##  <a name="getlimittext"></a>CRichEditCtrl：： GetLimitText

取得這個`CRichEditCtrl`物件的文字限制。

```
long GetLimitText() const;
```

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件目前的文字限制（以位元組為單位）。

### <a name="remarks"></a>備註

文字限制是 rtf 編輯控制項可以接受的最大文字量（以位元組為單位）。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETLIMITTEXT](/windows/win32/Controls/em-getlimittext) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#12](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_12.cpp)]

##  <a name="getline"></a>CRichEditCtrl：： GetLine

從此`CRichEditCtrl`物件抓取一行文字。

```
int GetLine(
    int nIndex,
    LPTSTR lpszBuffer) const;

int GetLine(
    int nIndex,
    LPTSTR lpszBuffer,
    int nMaxLength) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要取出的行之以零為起始的索引。

*lpszBuffer*<br/>
指向要接收文字的緩衝區。 緩衝區的第一個字必須指定可複製到緩衝區的最大位元組數目。

*nMaxLength*<br/>
可以複製到*lpszBuffer*中的最大字元數。 第二種形式`GetLine`會將此值放在*lpszBuffer*所指定之緩衝區的第一個字組中。

### <a name="return-value"></a>傳回值

複製到*lpszBuffer*中的字元數。

### <a name="remarks"></a>備註

複製的行不包含終止的 null 字元。

> [!NOTE]
>  由於緩衝區的第一個字組會儲存要複製的字元數，因此請確定您的緩衝區長度至少為4個位元組。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETLINE](/windows/win32/Controls/em-getline) 。

### <a name="example"></a>範例

  請參閱[GetLineCount](#getlinecount)的範例。

##  <a name="getlinecount"></a>CRichEditCtrl：： GetLineCount

抓取`CRichEditCtrl`物件中的行數。

```
int GetLineCount() const;
```

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件中的行數。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETLINECOUNT](/windows/win32/Controls/em-getlinecount) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#13](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_13.cpp)]

##  <a name="getmodify"></a>CRichEditCtrl：： GetModify

判斷這個`CRichEditCtrl`物件的內容是否已修改。

```
BOOL GetModify() const;
```

### <a name="return-value"></a>傳回值

如果已修改這個`CRichEditCtrl`物件中的文字，則為非零，否則為0。

### <a name="remarks"></a>備註

Windows 會維護一個內部旗標，指出 rich edit 控制項的內容是否已經變更。 第一次建立編輯控制項時，會清除此旗標，而且也可以藉由呼叫[SetModify](#setmodify)成員函式來清除。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETMODIFY](/windows/win32/Controls/em-getmodify) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#14](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_14.cpp)]

##  <a name="getoptions"></a>CRichEditCtrl：： GetOptions

抓取目前為 rich edit 控制項設定的選項。

```
UINT GetOptions() const;
```

### <a name="return-value"></a>傳回值

目前選項旗標值的組合。 如需這些值的清單，請參閱[EM_SETOPTIONS](/windows/win32/Controls/em-setoptions)訊息中的*fOptions*參數，如 Windows SDK 中所述。

##  <a name="getparaformat"></a>CRichEditCtrl：： GetParaFormat

取得目前選取範圍的段落格式屬性。

```
DWORD GetParaFormat(PARAFORMAT& pf) const;  DWORD GetParaFormat(PARAFORMAT2& pf) const;
```

### <a name="parameters"></a>參數

*pf*<br/>
在第一個版本中， [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)結構的指標，用來保存目前選取範圍的段落格式屬性。

在第二個版本中，指向[PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)結構的指標，這是`PARAFORMAT`結構的豐富編輯2.0 延伸模組，保留預設的字元格式屬性。

### <a name="return-value"></a>傳回值

`dwMask` *Pf*的資料成員。 它會指定在目前選取範圍中一致的段落格式屬性。

### <a name="remarks"></a>備註

如果選取一個以上的段落， *pf*會接收第一個選取段落的屬性。 傳回值會指定哪些屬性在整個選取範圍中是一致的。

如需詳細資訊，請參閱[EM_GETPARAFORMAT](/windows/win32/Controls/em-getparaformat)訊息和`PARAFORMAT` Windows SDK `PARAFORMAT2`中的和結構。

### <a name="example"></a>範例

  請參閱[CRichEditCtrl：： SetParaFormat](#setparaformat)的範例。

##  <a name="getpunctuation"></a>CRichEditCtrl：： GetPunctuation

取得 rich edit 控制項中目前的標點符號字元。

```
BOOL GetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc) const;
```

### <a name="parameters"></a>參數

*fType*<br/>
標點符號類型旗標，如 Windows SDK 中[EM_GETPUNCTUATION](/windows/win32/Controls/em-getpunctuation)的*fType*參數中所述。

*lpPunc*<br/>
[標點符號](/windows/win32/api/richedit/ns-richedit-punctuation)結構的指標，如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果作業成功，則為非零，否則為0。

### <a name="remarks"></a>備註

這個成員函式僅適用于作業系統的亞洲語言版本。

##  <a name="getrect"></a>CRichEditCtrl：： GetRect

抓取這個`CRichEditCtrl`物件的格式化矩形。

```
void GetRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*lpRect*<br/>
[CRect](../../atl-mfc-shared/reference/crect-class.md)或指向[矩形](/windows/win32/api/windef/ns-windef-rect)的指標，以接收這個`CRichEditCtrl`物件的格式化矩形。

### <a name="remarks"></a>備註

格式化矩形是文字的周框。 這個值與`CRichEditCtrl`物件的大小無關。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETRECT](/windows/win32/Controls/em-getrect) 。

### <a name="example"></a>範例

  請參閱[LimitText](#limittext)的範例。

##  <a name="getredoname"></a>CRichEditCtrl：： GetRedoName

抓取重做佇列中下一個可用動作的類型（如果有的話）。

```
UNDONAMEID GetRedoName() const;
```

### <a name="return-value"></a>傳回值

如果成功， `GetRedoName`會傳回[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)列舉類型，指出控制項的重做佇列中下一個動作的類型。 如果重做佇列是空的，或佇列中的 redo 動作屬於未知的類型， `GetRedoName`則會傳回0。

### <a name="remarks"></a>備註

可以復原或重做的動作類型包括輸入、刪除、拖放、剪下和貼上作業。 這項資訊對於提供復原和重做作業的擴充使用者介面的應用程式很有用，例如 redoable 動作的下拉式清單方塊。

##  <a name="getsel"></a>CRichEditCtrl：： GetSel

抓取這個`CRichEditCtrl`物件中目前選取範圍的範圍。

```
void GetSel(CHARRANGE& cr) const;

void GetSel(
    long& nStartChar,
    long& nEndChar) const;
```

### <a name="parameters"></a>參數

*cr*<br/>
[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構的參考，用來接收目前選取範圍的範圍。

*nStartChar*<br/>
目前選取範圍中第一個字元之以零為基底的索引。

*nEndChar*<br/>
目前選取範圍中最後一個字元的以零為基底的索引。

### <a name="remarks"></a>備註

這兩種形式的函式會提供替代方式來取得選取範圍的範圍。 這些表單的簡短說明如下：

- **GetSel （** `cr` **）：** 此`cpMax` 表單會使用結構及其和成員來傳回界限。`cpMin` `CHARRANGE`

- **GetSel （** `nStartChar` **，** ）此表單會傳回 nStartChar 和 nEndChar 參數中的界限。 `nEndChar`

如果開頭（`cpMin`或*nStartChar*）為0，且結尾（`cpMax`或*nEndChar*）為-1，則選項會包含所有專案。

如需詳細資訊，請參閱 Windows SDK 中的[EM_EXGETSEL](/windows/win32/Controls/em-exgetsel)訊息和[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#15](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_15.cpp)]

##  <a name="getselectioncharformat"></a>CRichEditCtrl：： GetSelectionCharFormat

取得目前選取範圍的字元格式屬性。

```
DWORD GetSelectionCharFormat(CHARFORMAT& cf) const;  DWORD GetSelectionCharFormat(CHARFORMAT2& cf) const;
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中，是[CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標，用來接收目前選取範圍的字元格式屬性。

在第二個版本中，指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標，這是`CHARFORMAT`結構的豐富編輯2.0 延伸模組，用來接收目前選取範圍的字元格式屬性。

### <a name="return-value"></a>傳回值

Cf `dwMask`的資料成員。它會指定在目前選取範圍中一致的字元格式屬性。

### <a name="remarks"></a>備註

*Cf*參數會接收目前選取範圍中第一個字元的屬性。 傳回值會指定哪些屬性在整個選取範圍中是一致的。

如需詳細資訊，請參閱[EM_GETCHARFORMAT](/windows/win32/Controls/em-getcharformat)訊息和`CHARFORMAT` Windows SDK `CHARFORMAT2`中的和結構。

### <a name="example"></a>範例

  請參閱[SetSelectionCharFormat](#setselectioncharformat)的範例。

##  <a name="getselectiontype"></a>CRichEditCtrl：： GetSelectionType

決定此`CRichEditCtrl`物件中的選取範圍類型。

```
WORD GetSelectionType() const;
```

### <a name="return-value"></a>傳回值

旗標，指出目前選取範圍的內容。 下列旗標的組合：

- SEL_EMPTY 表示沒有目前的選取專案。

- SEL_TEXT 表示目前的選取範圍包含文字。

- SEL_OBJECT 表示目前的選取範圍至少包含一個 OLE 專案。

- SEL_MULTICHAR 表示目前的選取範圍包含一個以上的文字字元。

- SEL_MULTIOBJECT 表示目前的選取範圍包含一個以上的 OLE 物件。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_SELECTIONTYPE](/windows/win32/Controls/em-selectiontype) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#16](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_16.cpp)]

##  <a name="getseltext"></a>CRichEditCtrl：： GetSelText

從這個`CRichEditCtrl`物件中的目前選取範圍抓取文字。

```
long GetSelText(LPSTR lpBuf) const;  CString GetSelText() const;
```

### <a name="parameters"></a>參數

*lpBuf*<br/>
要在目前選取專案中接收文字之緩衝區的指標。

### <a name="return-value"></a>傳回值

取決於下列表單：

- **GetSelText （** `lpBuf` **）** 複製到*lpBuf*中的字元數，不包括 null 終止。

- **GetSelText （）** 包含目前選取範圍的字串。

### <a name="remarks"></a>備註

如果您使用第一個表單**GetSelText （** `lpBuf` **）** ，您必須確定緩衝區夠大，足以容納它要接收的文字。 呼叫[GetSel](#getsel)來判斷目前選取範圍中的字元數。

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETSELTEXT](/windows/win32/Controls/em-getseltext) 。

### <a name="example"></a>範例

  請參閱[CRichEditCtrl：： GetSelectionType](#getselectiontype)的範例。

##  <a name="gettextlength"></a>CRichEditCtrl：： GetTextLength

抓取此`CRichEditCtrl`物件中文字的長度（以字元為單位），不包括終止的 null 字元。

```
long GetTextLength() const;
```

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件中的文字長度。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[WM_GETTEXTLENGTH](/windows/win32/winmsg/wm-gettextlength) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#17](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_17.cpp)]

##  <a name="gettextlengthex"></a>CRichEditCtrl：： GetTextLengthEx

計算 rich edit 控制項中文字的長度。

```
long GetTextLengthEx(
    DWORD dwFlags,
    UINT uCodePage = -1) const;
```

### <a name="parameters"></a>參數

*dwFlags*<br/>
值，指定要用來決定文字長度的方法。 這個成員可以是 Windows SDK 中所述[GETTEXTLENGTHEX](/windows/win32/api/richedit/ns-richedit-gettextlengthex)旗標成員中所列的一或多個值。

*uCodePage*<br/>
翻譯的字碼頁（ANSI 字碼頁為 CP_ACP，Unicode 為1200）。

### <a name="return-value"></a>傳回值

編輯控制項中的字元數或位元組數。 如果在*dwFlags*中設定了不相容的旗標，此成員函式會傳回 E_INVALIDARG。

### <a name="remarks"></a>備註

`GetTextLengthEx`提供其他方式來決定文字的長度。 它支援豐富的編輯2.0 功能。 如需詳細資訊，請參閱 Windows SDKfor 中的[Rich Edit 控制項](/windows/win32/Controls/about-rich-edit-controls)。

##  <a name="gettextmode"></a>CRichEditCtrl：： GetTextMode

抓取 rich edit 控制項的目前文字模式和復原層級。

```
UINT GetTextMode() const;
```

### <a name="return-value"></a>傳回值

來自[TEXTMODE](/windows/win32/api/richedit/ne-richedit-textmode)列舉類型的一組位旗標，如 Windows SDK 中所述。 旗標會指出控制項目前的文字模式和復原層級。

##  <a name="gettextrange"></a>CRichEditCtrl：： GetTextRange

取得指定的字元範圍。

```
int GetTextRange(
    int nFirst,
    int nLast,
    CString& refString) const;
```

### <a name="parameters"></a>參數

*nFirst*<br/>
範圍中第一個字元之前的字元位置索引。

*nLast*<br/>
緊接在範圍中最後一個字元之後的字元位置。

*refString*<br/>
將接收文字之[CString](../../atl-mfc-shared/reference/cstringt-class.md)物件的參考。

### <a name="return-value"></a>傳回值

已複製的字元數，不包括終止的 null 字元。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_GETTEXTRANGE](/windows/win32/Controls/em-gettextrange) 。

`GetTextRange`支援 Rich Edit 2.0 功能。 如需詳細資訊，請參閱 Windows SDKfor 中的[Rich Edit 控制項](/windows/win32/Controls/about-rich-edit-controls)。

##  <a name="getundoname"></a>CRichEditCtrl：： GetUndoName

抓取復原佇列中下一個可用動作的類型（如果有的話）。

```
UNDONAMEID GetUndoName() const;
```

### <a name="return-value"></a>傳回值

如果復原動作在控制項的復原佇列中， `GetUndoName`則會傳回[UNDONAMEID](/windows/win32/api/richedit/ne-richedit-undonameid)列舉類型，指出佇列中下一個動作的類型。 如果復原佇列是空的，或佇列中的復原動作屬於未知的類型， `GetUndoName`則會傳回0。

### <a name="remarks"></a>備註

可以復原或重做的動作類型包括輸入、刪除、拖放、剪下和貼上作業。 這項資訊對於提供復原和重做作業的擴充使用者介面的應用程式很有用，例如可以復原的動作下拉式清單方塊。

##  <a name="getwordwrapmode"></a>CRichEditCtrl：： GetWordWrapMode

抓取 rich edit 控制項的目前文字換行和斷詞選項。

```
UINT GetWordWrapMode() const;
```

### <a name="return-value"></a>傳回值

目前的文字換行和斷詞選項。 Windows SDK 中的[EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode)會說明這些選項。

### <a name="remarks"></a>備註

這個成員函式僅適用于亞洲語言版本的作業系統。

##  <a name="hideselection"></a>CRichEditCtrl：： HideSelection

變更選取範圍的可見度。

```
void HideSelection(
    BOOL bHide,
    BOOL bPerm);
```

### <a name="parameters"></a>參數

*bHide*<br/>
指出是否應該顯示或隱藏選取範圍，TRUE 表示隱藏選取範圍。

*bPerm*<br/>
指出選取範圍中的這項變更是否應為永久性。

### <a name="remarks"></a>備註

當*bPerm*為 TRUE 時，它會變更此`CRichEditCtrl`物件的 ECO_NOHIDESEL 選項。 如需此選項的簡短描述，請參閱[SetOptions](#setoptions)。 您可以使用這個函數來設定這個`CRichEditCtrl`物件的所有選項。

如需詳細資訊，請參閱 Windows SDK 中的[EM_HIDESELECTION](/windows/win32/Controls/em-hideselection) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#18](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_18.cpp)]

##  <a name="limittext"></a>  CRichEditCtrl::LimitText

限制使用者可以在編輯控制項中輸入的文字長度。

```
void LimitText(long nChars = 0);
```

### <a name="parameters"></a>參數

*nChars*<br/>
指定使用者可以輸入之文字的長度（以位元組為單位）。 如果此參數為0（預設值），則文字長度會設定為64K 位元組。

### <a name="remarks"></a>備註

變更文字限制只會限制使用者可以輸入的文字。 它不會影響任何已經在編輯控制項中的文字，也不會影響中`CWnd`的[SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)成員函式複製到編輯控制項的文字長度。 如果應用程式使用`SetWindowText`函式將更多文字放入編輯控制項中`LimitText`，而不是呼叫中指定的，則使用者可以刪除編輯控制項中的任何文字。 不過，文字限制會讓使用者無法以新的文字取代現有的文字，除非刪除目前的選取範圍會導致文字低於文字限制。

> [!NOTE]
>  針對文字限制，每個 OLE 專案都會計算為單一字元。

如需詳細資訊，請參閱 Windows SDK 中的[EM_EXLIMITTEXT](/windows/win32/Controls/em-exlimittext) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#19](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_19.cpp)]

##  <a name="linefromchar"></a>CRichEditCtrl：： LineFromChar

抓取包含指定字元索引之行的行號。

```
long LineFromChar(long nIndex) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
包含編輯控制項文字中所需字元的以零為基底的索引值，或包含-1。 如果*nIndex*為-1，則會指定目前的行，也就是包含插入號的行。

### <a name="return-value"></a>傳回值

包含*nIndex*所指定之字元索引的行之以零為起始的行號。 如果*nIndex*為-1，則會傳回包含選取範圍之第一個字元的行號。 如果沒有選取專案，則會傳回目前的行號。

### <a name="remarks"></a>備註

字元索引是來自 rich edit 控制項開頭的字元數。 針對字元計數，OLE 專案會計算為單一字元。

如需詳細資訊，請參閱 Windows SDK 中的[EM_EXLINEFROMCHAR](/windows/win32/Controls/em-exlinefromchar) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#20](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_20.cpp)]

##  <a name="lineindex"></a>CRichEditCtrl：： LineIndex

抓取此`CRichEditCtrl`物件中一行的字元索引。

```
int LineIndex(int nLine = -1) const;
```

### <a name="parameters"></a>參數

*nLine*<br/>
在編輯控制項的文字中包含所需行的索引值，或包含-1。 如果*n 行*為-1，則會指定目前的行，也就是包含插入號的行。

### <a name="return-value"></a>傳回值

在*n 行*中指定之行的字元索引，如果指定的行號大於編輯控制項中的行數，則為-1。

### <a name="remarks"></a>備註

字元索引是從 rich edit 控制項開頭到指定行的字元數。

如需詳細資訊，請參閱 Windows SDK 中的[EM_LINEINDEX](/windows/win32/controls/em-lineindex) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#21](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_21.cpp)]

##  <a name="linelength"></a>CRichEditCtrl：： LineLength

抓取 rich edit 控制項中的行長度。

```
int LineLength(int nLine = -1) const;
```

### <a name="parameters"></a>參數

*nLine*<br/>
指定要抓取其長度之行中字元的字元索引。 如果此參數為-1，則會傳回目前行的長度（包含插入號的行），而不包含該行內任何選取文字的長度。 針對`LineLength`單一行編輯控制項呼叫時，會忽略這個參數。

### <a name="return-value"></a>傳回值

針對`LineLength`多行編輯控制項呼叫時，傳回值是*n 行*所指定之行的長度（以 TCHAR）。  它不會在行尾包含回車符。 針對`LineLength`單行編輯控制項呼叫時，傳回值是編輯控制項中文字的長度（以 TCHAR）。 如果 N 行大於控制項中的字元數，則傳回值為零。

### <a name="remarks"></a>備註

使用[LineIndex](#lineindex)成員函式來抓取此`CRichEditCtrl`物件中指定行號的字元索引。

如需詳細資訊，請參閱 Windows SDK 中的[EM_LINELENGTH](/windows/win32/Controls/em-linelength) 。

### <a name="example"></a>範例

  請參閱[LineIndex](#lineindex)的範例。

##  <a name="linescroll"></a>CRichEditCtrl：： LineScroll

滾動多行編輯控制項的文字。

```
void LineScroll(
    int nLines,
    int nChars = 0);
```

### <a name="parameters"></a>參數

*nLines*<br/>
指定要垂直捲動的行數。

*nChars*<br/>
指定要水準滾動的字元位置數目。 如果 rich edit 控制項具有 ES_RIGHT 或 ES_CENTER 樣式，則會忽略這個值。 [[建立](#create)] 中會指定[編輯樣式](../../mfc/reference/styles-used-by-mfc.md#edit-styles)。

### <a name="remarks"></a>備註

編輯控制項不會垂直捲動超過編輯控制項中的最後一行文字。 如果目前的行加上*nLines*所指定的行數超過編輯控制項中的總行數，則會調整值，使編輯控制項的最後一行滾動到編輯控制項視窗的頂端。

`LineScroll`可以用來水準滾動到任何一行的最後一個字元之後。

如需詳細資訊，請參閱 Windows SDK 中的[EM_LINESCROLL](/windows/win32/Controls/em-linescroll) 。

### <a name="example"></a>範例

  請參閱[GetFirstVisibleLine](#getfirstvisibleline)的範例。

##  <a name="paste"></a>CRichEditCtrl：:P aste

將剪貼簿中的資料插入至`CRichEditCtrl`插入點的，插入號的位置。

```
void Paste();
```

### <a name="remarks"></a>備註

只有當剪貼簿包含可識別格式的資料時，才會插入資料。

如需詳細資訊，請參閱 Windows SDK 中的[WM_PASTE](/windows/win32/dataxchg/wm-paste) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#22](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_22.cpp)]

##  <a name="pastespecial"></a>CRichEditCtrl：:P asteSpecial

將特定剪貼簿格式的資料貼入這個`CRichEditCtrl`物件。

```
void PasteSpecial(
    UINT nClipFormat,
    DWORD dvAspect = 0,
    HMETAFILE hMF = 0);
```

### <a name="parameters"></a>參數

*nClipFormat*<br/>
要貼入這個`CRichEditCtrl`物件的剪貼簿格式。

*dvAspect*<br/>
要從剪貼簿抓取之資料的裝置層面。

*hMF*<br/>
中繼檔的控制碼，其中包含要貼入之物件的 iconic 視圖。

### <a name="remarks"></a>備註

新的材料會插入插入點，即插入號的位置。

如需詳細資訊，請參閱 Windows SDK 中的[EM_PASTESPECIAL](/windows/win32/Controls/em-pastespecial) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#23](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_23.cpp)]

##  <a name="posfromchar"></a>CRichEditCtrl：:P osFromChar

抓取編輯控制項中指定之字元的工作區座標。

```
CPoint PosFromChar(UINT nChar) const;
```

### <a name="parameters"></a>參數

*nChar*<br/>
字元之以零為基底的索引。

### <a name="return-value"></a>傳回值

字元的位置，（x，y）。 針對單行編輯控制項，y 座標一律為零。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_POSFROMCHAR](/windows/win32/Controls/em-posfromchar) 。

##  <a name="redo"></a>  CRichEditCtrl::Redo

重新執行控制項的重做佇列中的下一個動作。

```
BOOL Redo();
```

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如需詳細資訊，請參閱 Windows SDK 中的[EM_REDO](/windows/win32/Controls/em-redo) 。

##  <a name="replacesel"></a>  CRichEditCtrl::ReplaceSel

以指定的文字取代這個`CRichEditCtrl`物件中目前的選取範圍。

```
void ReplaceSel(
    LPCTSTR lpszNewText,
    BOOL bCanUndo = FALSE);
```

### <a name="parameters"></a>參數

*lpszNewText*<br/>
包含取代文字之以 null 終止之字串的指標。

*bCanUndo*<br/>
若要指定此函數可以復原，請將此參數的值設定為 TRUE。 預設值為 FALSE。

### <a name="remarks"></a>備註

若要取代這個`CRichEditCtrl`物件中的所有文字，請使用[CWnd：： SetWindowText](../../mfc/reference/cwnd-class.md#setwindowtext)。

如果沒有目前的選取範圍，則會在插入點插入取代文字，也就是目前的插入號位置。

此函式會將插入的文字格式化為現有的字元格式。 取代整個範圍的文字（在呼叫`SetSel` `ReplaceSel`之前呼叫（0，-1））時，會保留前一段段落的格式，並由新插入的文字繼承。

如需詳細資訊，請參閱 Windows SDK 中的[EM_REPLACESEL](/windows/win32/Controls/em-replacesel) 。

### <a name="example"></a>範例

  請參閱[LineIndex](#lineindex)的範例。

##  <a name="requestresize"></a>CRichEditCtrl：： RequestResize

強制此`CRichEditCtrl`物件將 EN_REQUESTRESIZE 通知訊息傳送至其父視窗。

```
void RequestResize();
```

### <a name="remarks"></a>備註

在無底邊`CRichEditCtrl`物件的[CWnd：： OnSize](../../mfc/reference/cwnd-class.md#onsize)處理期間，這個函數非常有用。

如需詳細資訊，請參閱關於 Windows SDK 中[豐富編輯控制項](/windows/win32/Controls/about-rich-edit-controls)的[EM_REQUESTRESIZE](/windows/win32/Controls/em-requestresize)訊息和**無底邊 rich edit 控制項**一節。

##  <a name="setautourldetect"></a>CRichEditCtrl：： SetAutoURLDetect

將 rich edit 控制項設定為自動偵測 URL。

```
BOOL SetAutoURLDetect(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
指定控制項是否設定為自動偵測 URL。 若為 TRUE，則會啟用。 如果為 FALSE，則表示已停用。

### <a name="return-value"></a>傳回值

如果成功，則為零，否則為非零。 例如，訊息可能會因為記憶體不足而失敗。

### <a name="remarks"></a>備註

啟用時，rich edit 控制項會掃描文字，以判斷它是否符合標準的 URL 格式。 如需這些 URL 格式的清單，請參閱 Windows SDK 中的[EM_AUTOURLDETECT](/windows/win32/Controls/em-autourldetect) 。

> [!NOTE]
>  如果您的`SetAutoURLDetect`編輯控制項針對 url 以外的文字使用 CFE_LINK 效果，請勿將設定為 TRUE。 `SetAutoURLDetect`會對 Url 啟用這種效果，並將它停用於所有其他文字。 如需 CFE_LINK 效果的詳細資訊，請參閱[EN_LINK](/windows/win32/Controls/en-link) 。

##  <a name="setbackgroundcolor"></a>  CRichEditCtrl::SetBackgroundColor

設定這個`CRichEditCtrl`物件的背景色彩。

```
COLORREF SetBackgroundColor(
    BOOL bSysColor,
    COLORREF cr);
```

### <a name="parameters"></a>參數

*bSysColor*<br/>
指出是否應將背景色彩設定為系統值。 如果此值為 TRUE，則會忽略*cr* 。

*cr*<br/>
要求的背景色彩。 只有在*bSysColor*為 FALSE 時才會使用。

### <a name="return-value"></a>傳回值

這個`CRichEditCtrl`物件先前的背景色彩。

### <a name="remarks"></a>備註

背景色彩可以設定為系統值或指定的[COLORREF](/windows/win32/gdi/colorref)值。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETBKGNDCOLOR](/windows/win32/Controls/em-setbkgndcolor)訊息和[COLORREF](/windows/win32/gdi/colorref)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#24](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_24.cpp)]

##  <a name="setdefaultcharformat"></a>CRichEditCtrl：： SetDefaultCharFormat

設定這個`CRichEditCtrl`物件中新文字的字元格式屬性。

```
BOOL SetDefaultCharFormat(CHARFORMAT& cf);
BOOL SetDefaultCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中， [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標，其中包含新的預設字元格式屬性。

在第二個版本中，指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標，這是`CHARFORMAT`結構的豐富編輯2.0 延伸模組，其中包含預設的字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式只會變更`dwMask` *cf*的成員所指定的屬性。

如需詳細資訊，請參閱[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)訊息和`CHARFORMAT` Windows SDK `CHARFORMAT2`中的和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#25](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_25.cpp)]

##  <a name="seteventmask"></a>CRichEditCtrl：： SetEventMask

設定這個`CRichEditCtrl`物件的事件遮罩。

```
DWORD SetEventMask(DWORD dwEventMask);
```

### <a name="parameters"></a>參數

*dwEventMask*<br/>
這個`CRichEditCtrl`物件的新事件遮罩。

### <a name="return-value"></a>傳回值

先前的事件遮罩。

### <a name="remarks"></a>備註

事件遮罩會指定`CRichEditCtrl`物件傳送至其父視窗的通知訊息。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETEVENTMASK](/windows/win32/Controls/em-seteventmask) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#26](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_26.cpp)]

##  <a name="setmodify"></a>CRichEditCtrl：： SetModify

設定或清除編輯控制項的修改旗標。

```
void SetModify(BOOL bModified = TRUE);
```

### <a name="parameters"></a>參數

*bModified*<br/>
值為 TRUE 時，表示已修改文字，而值為 FALSE 則表示未修改。 根據預設，已修改的旗標已設定。

### <a name="remarks"></a>備註

修改過的旗標會指出是否已修改編輯控制項內的文字。 每當使用者變更文字時，就會自動設定它。 它的值可以使用[GetModify](#getmodify)成員函式來抓取。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETMODIFY](/windows/win32/Controls/em-setmodify) 。

### <a name="example"></a>範例

  請參閱[GetModify](#getmodify)的範例。

##  <a name="setolecallback"></a>  CRichEditCtrl::SetOLECallback

提供`IRichEditOleCallback`物件`CRichEditCtrl`給這個物件，用來存取 OLE 相關資源和資訊。

```
BOOL SetOLECallback(IRichEditOleCallback* pCallback);
```

### <a name="parameters"></a>參數

*pCallback*<br/>
[IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback)物件的指標，這個`CRichEditCtrl`物件將用來取得 OLE 相關的資源和資訊。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個`CRichEditCtrl`物件會呼叫[IUnknown：： AddRef](/windows/win32/api/unknwn/nf-unknwn-iunknown-addref) ，以遞增*pCallback*所指定之 COM 物件的使用計數。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETOLECALLBACK](/windows/win32/Controls/em-setolecallback)訊息和[IRichEditOleCallback](/windows/win32/api/richole/nn-richole-iricheditolecallback)介面。

##  <a name="setoptions"></a>CRichEditCtrl：： SetOptions

設定這個`CRichEditCtrl`物件的選項。

```
void SetOptions(
    WORD wOp,
    DWORD dwFlags);
```

### <a name="parameters"></a>參數

*wOp*<br/>
表示作業的類型。 下列其中一個值：

- ECOOP_SET 會將選項設定為*dwFlags*所指定的選項。

- ECOOP_OR 結合了目前的選項與*dwFlags*所指定的選項。

- ECOOP_AND 只會保留*dwFlags*也指定的目前選項。

- ECOOP_XOR 以邏輯方式排除，或使用*dwFlags*所指定的目前選項。

*dwFlags*<br/>
豐富的編輯選項。 旗標值會列在 [備註] 區段中。

### <a name="remarks"></a>備註

這些選項可以是下列值的組合：

- 按兩下時，ECO_AUTOWORDSELECTION 自動選取文字。

- 當使用者在行尾輸入字元時，ECO_AUTOVSCROLL 會自動將文字向右滾動10個字元。 當使用者按下 ENTER 鍵時，控制項會將所有文字全部回復到位置零。

- 當使用者在最後一行按下 ENTER 鍵時，ECO_AUTOHSCROLL 會自動將文字向上滾動一頁。

- ECO_NOHIDESEL 會否定編輯控制項的預設行為。 當控制項失去輸入焦點時，預設行為會隱藏選取範圍，並在控制項收到輸入焦點時顯示選取範圍。 如果您指定 ECO_NOHIDESEL，則即使控制項沒有焦點，選取的文字也會反轉。

- ECO_READONLY 可防止使用者輸入或編輯編輯控制項中的文字。

- ECO_WANTRETURN 指定當使用者按下 ENTER 鍵，同時在對話方塊中輸入文字到多行 rich edit 控制項時，所要插入的回車。 如果您未指定此樣式，按 ENTER 鍵會將命令傳送至 rich edit 控制項的父視窗，這會模擬按一下父視窗的預設按鈕（例如，對話方塊中的 [確定] 按鈕）。 此樣式不會影響單行編輯控制項。

- 當控制項失去焦點時，ECO_SAVESEL 會保留選取專案。 根據預設，在重新取得焦點時，會選取控制項的完整內容。

- ECO_VERTICAL 會以垂直方向繪製文字和物件。 僅適用于亞洲語言。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETOPTIONS](/windows/win32/Controls/em-setoptions) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#27](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_27.cpp)]

##  <a name="setparaformat"></a>CRichEditCtrl：： SetParaFormat

設定這個`CRichEditCtrl`物件中目前選取範圍的段落格式屬性。

```
BOOL SetParaFormat(PARAFORMAT& pf);
BOOL SetParaFormat(PARAFORMAT2& pf);
```

### <a name="parameters"></a>參數

*pf*<br/>
在第一個版本中， [PARAFORMAT](/windows/win32/api/richedit/ns-richedit-paraformat)結構的指標，其中包含新的預設段落格式屬性。

在第二個版本中，指向[PARAFORMAT2](/windows/win32/api/richedit/ns-richedit-paraformat2)結構的指標，這是`PARAFORMAT`結構的豐富編輯2.0 延伸模組，保留預設的字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式只會變更`dwMask` *pf*的成員所指定的屬性。

如需詳細資訊，請參閱[EM_SETPARAFORMAT](/windows/win32/Controls/em-setparaformat)訊息和`PARAFORMAT` Windows SDK `PARAFORMAT2`中的和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#28](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_28.cpp)]

##  <a name="setpunctuation"></a>CRichEditCtrl：： SetPunctuation

設定 rich edit 控制項中的標點符號。

```
BOOL SetPunctuation(
    UINT fType,
    PUNCTUATION* lpPunc);
```

### <a name="parameters"></a>參數

*fType*<br/>
標點符號。 如需可能值的清單，請參閱 Windows SDK 中[EM_SETPUNCTUATION](/windows/win32/Controls/em-setpunctuation)的*fType*參數。

*lpPunc*<br/>
[標點符號](/windows/win32/api/richedit/ns-richedit-punctuation)結構的指標，如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果成功，則為非零，否則為0。

### <a name="remarks"></a>備註

這個成員函式僅適用于亞洲語言版本的作業系統。

##  <a name="setreadonly"></a>CRichEditCtrl：： SetReadOnly

變更這個`CRichEditCtrl`物件的 ECO_READONLY 選項。

```
BOOL SetReadOnly(BOOL bReadOnly = TRUE);
```

### <a name="parameters"></a>參數

*bReadOnly*<br/>
指出此`CRichEditCtrl`物件是否應為唯讀。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如需此選項的簡短描述，請參閱[SetOptions](#setoptions)。 您可以使用這個函數來設定這個`CRichEditCtrl`物件的所有選項。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETREADONLY](/windows/win32/Controls/em-setreadonly) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#29](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_29.cpp)]

##  <a name="setrect"></a>CRichEditCtrl：： SetRect

設定這個`CRichEditCtrl`物件的格式化矩形。

```
void SetRect(LPCRECT lpRect);
```

### <a name="parameters"></a>參數

*lpRect*<br/>
[矩形](/windows/win32/api/windef/ns-windef-rect)的[CRect](../../atl-mfc-shared/reference/crect-class.md)或指標，表示格式化矩形的新邊界。

### <a name="remarks"></a>備註

格式化矩形是文字的限制矩形。 限制矩形與 rich edit 控制項視窗的大小無關。 第一`CRichEditCtrl`次建立此物件時，格式化矩形的大小與視窗的工作區相同。 用`SetRect`來使格式化矩形大於或小於 rich edit 視窗。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETRECT](/windows/win32/Controls/em-setrect) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#30](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_30.cpp)]

##  <a name="setsel"></a>CRichEditCtrl：： SetSel

設定此`CRichEditCtrl`物件內的選取範圍。

```
void SetSel(
    long nStartChar,
    long nEndChar);

void SetSel(CHARRANGE& cr);
```

### <a name="parameters"></a>參數

*nStartChar*<br/>
選取範圍中第一個字元之以零為基底的索引。

*nEndChar*<br/>
選取範圍中最後一個字元的以零為起始的索引。

*cr*<br/>
[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構，其中包含目前選取範圍的範圍。

### <a name="remarks"></a>備註

這兩種形式的函式會提供替代方式來設定選取範圍的界限。 這些表單的簡短說明如下：

- **SetSel （** `cr` **）：** 此表單會使用`cpMin` `cpMax`結構及其和成員來設定界限。 `CHARRANGE`

- **SetSel （** `nStartChar` **，** ）此表單會使用 nStartChar 和 nEndChar 參數來設定界限。 `nEndChar`

插入號會放在開始`cpMin` （或*nStartChar*）和結束（`cpMax`或*nEndChar*）索引的較大範圍所指示的選取專案結尾。 此函式會滾動的內容`CRichEditCtrl` ，以便顯示插入號。

若要選取此`CRichEditCtrl`物件中的所有文字，請呼叫`SetSel` ，其起始索引為0，而結束索引為-1。

如需詳細資訊，請參閱 Windows SDK 中的[EM_EXSETSEL](/windows/win32/Controls/em-exsetsel)訊息和[CHARRANGE](/windows/win32/api/richedit/ns-richedit-charrange)結構。

### <a name="example"></a>範例

  請參閱[GetSel](#getsel)的範例。

##  <a name="setselectioncharformat"></a>CRichEditCtrl：： SetSelectionCharFormat

為這個`CRichEditCtrl`物件中目前選取範圍內的文字設定字元格式屬性。

```
BOOL SetSelectionCharFormat(CHARFORMAT& cf);
BOOL SetSelectionCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中， [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標，其中包含目前選取範圍的新字元格式屬性。

在第二個版本中，指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標，這是`CHARFORMAT`結構的豐富編輯2.0 延伸模組，其中包含目前選取範圍的新字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式只會變更`dwMask` *cf*的成員所指定的屬性。

如需詳細資訊，請參閱[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)和`CHARFORMAT`中`CHARFORMAT2`的和結構（在 Windows SDK 中）。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#31](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_31.cpp)]

##  <a name="settargetdevice"></a>CRichEditCtrl：： SetTargetDevice

設定在此`CRichEditCtrl`物件中，用於 WYSIWYG 的目標裝置和線條寬度（您所看到的內容）。

```
BOOL SetTargetDevice(
    HDC hDC,
    long lLineWidth);

BOOL SetTargetDevice(
    CDC& dc,
    long lLineWidth);
```

### <a name="parameters"></a>參數

*hDC*<br/>
新目標裝置之裝置內容的控制碼。

*lLineWidth*<br/>
用於格式化的線條寬度。

*dc*<br/>
新目標裝置的[CDC](../../mfc/reference/cdc-class.md) 。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如果此函式成功，rich edit 控制項會擁有做為參數傳遞的裝置內容。 在這種情況下，呼叫函式不應該摧毀裝置內容。

如需詳細資訊，請參閱 Windows SDK 中的[EM_SETTARGETDEVICE](/windows/win32/Controls/em-settargetdevice) 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#32](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_32.cpp)]

##  <a name="settextmode"></a>CRichEditCtrl：： SetTextMode

設定 rich edit 控制項的文字模式或復原和重做層級。

```
BOOL SetTextMode(UINT fMode);
```

### <a name="parameters"></a>參數

*fMode*<br/>
指定控制項的文字模式和復原層級參數的新設定。 如需可能值的清單，請參閱 Windows SDK 中[EM_SETTEXTMODE](/windows/win32/Controls/em-settextmode)的 mode 參數。

### <a name="return-value"></a>傳回值

如果成功，則為零，否則為非零。

### <a name="remarks"></a>備註

如需文字模式的說明，請參閱 Windows SDK 中的 EM_SETTEXTMODE。

如果控制項包含文字，此成員函式會失敗。 若要確定控制項是空的，請傳送具有空字串的[WM_SETTEXT](/windows/win32/winmsg/wm-settext)訊息。

##  <a name="setundolimit"></a>CRichEditCtrl：： SetUndoLimit

設定可儲存在復原佇列中的動作數目上限。

```
UINT SetUndoLimit(UINT nLimit);
```

### <a name="parameters"></a>參數

*nLimit*<br/>
指定可儲存在復原佇列中的動作數目上限。 設定為零可停用復原。

### <a name="return-value"></a>傳回值

Rich edit 控制項的新復原動作最大數目。

### <a name="remarks"></a>備註

根據預設，復原佇列中的動作數目上限為100。 如果您增加此數位，則必須有足夠的可用記憶體來容納新的數位。 為獲得較佳的效能，請將限制設定為最小的可能值。

##  <a name="setwordcharformat"></a>CRichEditCtrl：： SetWordCharFormat

設定這個`CRichEditCtrl`物件中目前選取之單字的字元格式屬性。

```
BOOL SetWordCharFormat(CHARFORMAT& cf);
BOOL SetWordCharFormat(CHARFORMAT2& cf);
```

### <a name="parameters"></a>參數

*cf*<br/>
在第一個版本中， [CHARFORMAT](/windows/win32/api/richedit/ns-richedit-charformata)結構的指標，其中包含目前所選取單字的新字元格式屬性。

在第二個版本中，指向[CHARFORMAT2](/windows/win32/api/richedit/ns-richedit-charformat2w)結構的指標，這是`CHARFORMAT`結構的豐富編輯2.0 延伸模組，其中包含目前所選取文字的新字元格式屬性。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

此函式只會變更`dwMask` *cf*的成員所指定的屬性。

如需詳細資訊，請參閱[EM_SETCHARFORMAT](/windows/win32/Controls/em-setcharformat)訊息和`CHARFORMAT` Windows SDK `CHARFORMAT2`中的和結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#33](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_33.cpp)]

##  <a name="setwordwrapmode"></a>CRichEditCtrl：： SetWordWrapMode

設定 rich edit 控制項的自動換行和斷字選項。

```
UINT SetWordWrapMode(UINT uFlags) const;
```

### <a name="parameters"></a>參數

*uFlags*<br/>
要設定為自動換行和斷詞的選項。 如需可能的選項清單，請參閱 Windows SDK 中的[EM_SETWORDWRAPMODE](/windows/win32/Controls/em-setwordwrapmode) 。

### <a name="return-value"></a>傳回值

目前的換行和斷字選項。

### <a name="remarks"></a>備註

此訊息僅適用于作業系統的亞洲語言版本。

##  <a name="stopgrouptyping"></a>CRichEditCtrl：： StopGroupTyping

停止控制項，使其無法在目前的復原動作中收集其他輸入動作。

```
void StopGroupTyping();
```

### <a name="remarks"></a>備註

控制項會將下一個輸入動作（如果有的話）儲存至復原佇列中的新動作。

如需詳細資訊，請參閱 Windows SDK 中的[EM_STOPGROUPTYPING](/windows/win32/Controls/em-stopgrouptyping) 。

##  <a name="streamin"></a>CRichEditCtrl：： StreamIn

以指定之輸入`CRichEditCtrl`資料流程中的文字取代此物件中的文字。

```
long StreamIn(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>參數

*nFormat*<br/>
指定輸入資料格式的旗標。 如需詳細資訊，請參閱＜備註＞一節。

*es*<br/>
指定輸入資料流程的[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。 如需詳細資訊，請參閱＜備註＞一節。

### <a name="return-value"></a>傳回值

從輸入資料流程讀取的字元數。

### <a name="remarks"></a>備註

*NFormat*的值必須是下列其中一項：

- SF_TEXT 表示唯讀取文字。

- SF_RTF 表示讀取文字和格式。

其中一個值可以與 SFF_SELECTION 結合。 如果指定 SFF_SELECTION， `StreamIn`則會將目前的選取範圍取代為輸入資料流程的內容。 如果未指定， `StreamIn`會取代這個`CRichEditCtrl`物件的整個內容。

在參數 es 中，您可以指定以文字填滿緩衝區的回呼函數。 `EDITSTREAM` 此回呼函式會重複呼叫，直到輸入資料流程耗盡為止。

如需詳細資訊，請參閱 Windows SDK 中的[EM_STREAMIN](/windows/win32/Controls/em-streamin)訊息和[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#34](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_34.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#35](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_35.cpp)]

##  <a name="streamout"></a>CRichEditCtrl：： StreamOut

將此`CRichEditCtrl`物件的內容寫出至指定的輸出資料流程。

```
long StreamOut(
    int nFormat,
    EDITSTREAM& es);
```

### <a name="parameters"></a>參數

*nFormat*<br/>
指定輸出資料格式的旗標。 如需詳細資訊，請參閱＜備註＞一節。

*es*<br/>
指定輸出資料流程的[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。 如需詳細資訊，請參閱＜備註＞一節。

### <a name="return-value"></a>傳回值

寫入輸出資料流程的字元數。

### <a name="remarks"></a>備註

*NFormat*的值必須是下列其中一項：

- SF_TEXT 表示只寫入文字。

- SF_RTF 表示寫入文字和格式。

- SF_RTFNOOBJS 表示寫入文字和格式，並以空格取代 OLE 專案。

- SF_TEXTIZED 表示使用 OLE 專案的文字表示來撰寫文字和格式。

這些值中的任何一個都可以與 SFF_SELECTION 結合。 如果指定 SFF_SELECTION， `StreamOut`則會將目前的選取範圍寫出至輸出資料流程。 如果未指定， `StreamOut`會寫出這個`CRichEditCtrl`物件的完整內容。

在參數 es 中，您可以指定以文字填滿緩衝區的回呼函數。 `EDITSTREAM` 此回呼函數會重複呼叫，直到輸出資料流程耗盡為止。

如需詳細資訊，請參閱 Windows SDK 中的[EM_STREAMOUT](/windows/win32/Controls/em-streamout)訊息和[EDITSTREAM](/windows/win32/api/richedit/ns-richedit-editstream)結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CRichEditCtrl#36](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_36.cpp)]

[!code-cpp[NVC_MFC_CRichEditCtrl#37](../../mfc/reference/codesnippet/cpp/cricheditctrl-class_37.cpp)]

##  <a name="undo"></a>CRichEditCtrl：： Undo

復原 rich edit 控制項中的最後一個作業。

```
BOOL Undo();
```

### <a name="return-value"></a>傳回值

如果復原作業成功，則為非零;否則為0。

### <a name="remarks"></a>備註

復原作業也可以復原。 例如，您可以在第一次呼叫`Undo`時還原已刪除的文字。 只要沒有中間的編輯作業，您就可以在第二次呼叫`Undo`時，再次移除文字。

如需詳細資訊，請參閱 Windows SDK 中的[EM_UNDO](/windows/win32/Controls/em-undo) 。

### <a name="example"></a>範例

  請參閱[CanUndo](#canundo)的範例。

## <a name="see-also"></a>另請參閱

[MFC 範例 WORDPAD](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CEdit 類別](../../mfc/reference/cedit-class.md)<br/>
[CRichEditView 類別](../../mfc/reference/cricheditview-class.md)
