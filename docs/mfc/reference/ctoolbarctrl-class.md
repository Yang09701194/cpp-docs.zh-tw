---
title: "CToolBarCtrl 類別 |Microsoft 文件"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: cpp-windows
ms.tgt_pltfrm: 
ms.topic: reference
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
dev_langs: C++
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
caps.latest.revision: "22"
author: mikeblome
ms.author: mblome
manager: ghogen
ms.workload: cplusplus
ms.openlocfilehash: 054e3de4daa7d5bd25583286e958c0c9b07c4090
ms.sourcegitcommit: 8fa8fdf0fbb4f57950f1e8f4f9b81b4d39ec7d7a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/21/2017
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 類別
提供 Windows 工具列通用控制項的功能。  
  
## <a name="syntax"></a>語法  
  
```  
class CToolBarCtrl : public CWnd  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|建構 `CToolBarCtrl` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CToolBarCtrl::AddBitmap](#addbitmap)|將一或多個點陣圖按鈕影像加入至可用工具列控制項的按鈕影像清單。|  
|[CToolBarCtrl::AddButtons](#addbuttons)|將一或多個按鈕加入至工具列控制項。|  
|[CToolBarCtrl::AddString](#addstring)|新增新的字串，做為資源識別碼，工具列的內部清單的字串來傳遞。|  
|[CToolBarCtrl::AddStrings](#addstrings)|加入新的字串或 null 分隔的字串，工具列的內部清單的字串緩衝區的指標傳遞的字串。|  
|[CToolBarCtrl::AutoSize](#autosize)|調整工具列控制項的大小。|  
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|變更目前的工具列控制項中按鈕的點陣圖。|  
|[CToolBarCtrl::CheckButton](#checkbutton)|會檢查或清除在工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|擷取與指定的命令識別碼相關聯的按鈕以零為起始的索引。|  
|[CToolBarCtrl::Create](#create)|建立工具列控制項，並將它附加至`CToolBarCtrl`物件。|  
|[CToolBarCtrl::CreateEx](#createex)|使用指定的 Windows 延伸樣式建立工具列控制項，並將它附加至`CToolBarCtrl`物件。|  
|[CToolBarCtrl::Customize](#customize)|顯示 [自訂工具列] 對話方塊。|  
|[CToolBarCtrl::DeleteButton](#deletebutton)|從工具列控制項中刪除按鈕。|  
|[CToolBarCtrl::EnableButton](#enablebutton)|啟用或停用工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|擷取工具列設定錨點反白顯示。|  
|[CToolBarCtrl::GetBitmap](#getbitmap)|擷取在工具列中的按鈕相關聯的點陣圖的索引。|  
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|取得與工具列的點陣圖相關聯的旗標。|  
|[CToolBarCtrl::GetButton](#getbutton)|擷取指定的按鈕，在工具列控制項中的相關資訊。|  
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|擷取工具列控制項中目前的按鈕數目。|  
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|擷取在工具列中按鈕的資訊。|  
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|擷取目前的寬度和高度工具列按鈕，像素為單位。|  
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|擷取目前的工具列控制項的色彩配置。|  
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|擷取映像清單工具列控制項用來顯示停用按鈕。|  
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|擷取[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)工具列控制項的介面。|  
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|擷取工具列控制項的延伸的樣式。|  
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|擷取映像清單工具列控制項用來顯示 「 熱 」 按鈕。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。|  
|[CToolBarCtrl::GetHotItem](#gethotitem)|擷取作用中工具列項目的索引。|  
|[CToolBarCtrl::GetImageList](#getimagelist)|擷取工具列控制項中用來顯示按鈕為預設狀態的影像清單。|  
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|擷取目前的插入標記的工具列。|  
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|擷取用來繪製工具列插入標記的色彩。|  
|[CToolBarCtrl::GetItemRect](#getitemrect)|擷取的按鈕，在工具列控制項中的週框矩形。|  
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|擷取所有可見的按鈕和工具列中的分隔線的總大小。|  
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|擷取工具列按鈕上顯示的文字資料列的數目上限。|  
|[CToolBarCtrl::GetMetrics](#getmetrics)|擷取工具列控制項的度量。|  
|[CToolBarCtrl::GetPadding](#getpadding)|擷取目前的工具列控制項的水平和垂直填補。|  
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|擷取目前的工具列控制項用來代表按鈕已按下狀態的影像清單。|  
|[CToolBarCtrl::GetRect](#getrect)|擷取指定的工具列按鈕的週框矩形。|  
|[CToolBarCtrl::GetRows](#getrows)|擷取目前顯示在工具列中按鈕的資料列數目。|  
|[CToolBarCtrl::GetState](#getstate)|擷取指定的按鈕，在工具列控制項中，例如它、 按下，是否啟用檢查的狀態相關資訊。|  
|[CToolBarCtrl::GetString](#getstring)|擷取工具列字串。|  
|[CToolBarCtrl::GetStyle](#getstyle)|擷取目前正在使用工具列控制項的樣式。|  
|[CToolBarCtrl::GetToolTips](#gettooltips)|如果任何與工具列控制項相關聯，請擷取工具提示控制項的控制代碼。|  
|[CToolBarCtrl::HideButton](#hidebutton)|隱藏或顯示在工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::HitTest](#hittest)|決定工具列控制項中點所在的位置。|  
|[CToolBarCtrl::Indeterminate](#indeterminate)|設定或清除指定的按鈕，在工具列控制項中的不定 （灰色） 狀態。|  
|[CToolBarCtrl::InsertButton](#insertbutton)|在工具列控制項中插入按鈕。|  
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|擷取在工具列中的點的插入標記資訊。|  
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|指示是否要檢查在工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|指示是否已啟用工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|指示是否隱藏工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|會檢查工具列按鈕反白顯示狀態。|  
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|會告知工具列控制項中指定的按鍵的狀態是否為不定 （灰色）。|  
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|指示是否要按下工具列控制項中指定的按鈕。|  
|[CToolBarCtrl::LoadImages](#loadimages)|載入工具列控制項的影像清單中的點陣圖。|  
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|工具列按鈕對應的對應字元。|  
|[CToolBarCtrl::MarkButton](#markbutton)|在工具列控制項中設定指定按鈕反白顯示的狀態。|  
|[CToolBarCtrl::MoveButton](#movebutton)|將按鈕從一個索引移到另一個。|  
|[CToolBarCtrl::PressButton](#pressbutton)|釋放在工具列控制項中指定的按鈕或按下。|  
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|新的點陣圖，取代目前的工具列控制項中現有的點陣圖。|  
|[CToolBarCtrl::RestoreState](#restorestate)|還原工具列控制項的狀態。|  
|[CToolBarCtrl::SaveState](#savestate)|儲存工具列控制項的狀態。|  
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|設定錨點反白顯示的工具列設定。|  
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|設定要加入至工具列控制項的點陣圖影像的大小。|  
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|在工具列中設定現有的按鈕的資訊。|  
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|設定要加入至工具列控制項的按鈕的大小。|  
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|指定的大小`TBBUTTON`結構。|  
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|工具列控制項中設定的最小和最大按鈕的寬度。|  
|[CToolBarCtrl::SetCmdID](#setcmdid)|設定指定的餂鈕蒢傳送至主控視窗的命令識別碼。|  
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|設定目前的工具列控制項的色彩配置。|  
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|設定工具列控制項將使用的影像清單來顯示停用按鈕。|  
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Win32 函式中設定的旗標[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，用來繪製文字中指定的矩形中，格式是根據旗標的設定方式。|  
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|設定工具列控制項的延伸的樣式。|  
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|設定影像清單，工具列控制項會將用來顯示 「 熱 」 按鈕。|  
|[CToolBarCtrl::SetHotItem](#sethotitem)|在工具列中，設定作用的項目。|  
|[CToolBarCtrl::SetImageList](#setimagelist)|設定映像清單工具列將用來顯示處於預設狀態的按鈕。|  
|[CToolBarCtrl::SetIndent](#setindent)|在工具列控制項中設定的第一個按鈕的縮排。|  
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|設定目前的插入標記的工具列。|  
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製工具列插入標記的色彩。|  
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|設定顯示在工具列按鈕上的文字資料列數目上限。|  
|[CToolBarCtrl::SetMetrics](#setmetrics)|設定工具列控制項的度量。|  
|[CToolBarCtrl::SetOwner](#setowner)|設定要接收通知訊息，從工具列控制項的視窗。|  
|[CToolBarCtrl::SetPadding](#setpadding)|設定目前的工具列控制項的水平和垂直填補。|  
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|設定目前的工具列控制項用來代表按鈕已按下狀態的影像清單。|  
|[CToolBarCtrl::SetRows](#setrows)|設定顯示在工具列中按鈕的資料列數目。|  
|[CToolBarCtrl::SetState](#setstate)|在工具列控制項中設定指定的按鈕的狀態。|  
|[CToolBarCtrl::SetStyle](#setstyle)|設定工具列控制項的樣式。|  
|[CToolBarCtrl::SetToolTips](#settooltips)|將工具提示控制項與工具列控制項產生關聯。|  
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|設定工具列控制項的視覺化樣式。|  
  
## <a name="remarks"></a>備註  
 這個控制項 (因此`CToolBarCtrl`類別) 僅適用於 Windows 95/98、 Windows NT 的版本 3.51 下執行的程式和更新版本。  
  
 Windows 工具列通用控制項是包含一或多個按鈕的矩形的子視窗。 這些按鈕可以顯示點陣圖影像、 字串，或兩者。 當使用者選擇按鈕時，它會將命令訊息傳送至工具列的擁有者視窗中。 一般而言，在工具列中的按鈕對應至應用程式的功能表; 中的項目它們提供更直接的方法，讓使用者存取應用程式的命令。  
  
 `CToolBarCtrl`物件包含數個重要的內部資料結構： 一份按鈕影像點陣圖或影像清單、 的按鈕標籤字串清單，以及一份`TBBUTTON`結構關聯一個影像和/或所在位置的樣式，字串的狀態，以及命令識別碼按鈕。 每個這些資料結構的項目都有以零為起始的索引。 您可以使用之前`CToolBarCtrl`物件，您必須設定這些資料結構。 字串清單，只可以用於按鈕標籤。您無法從工具列擷取字串。  
  
 若要使用 `CToolBarCtrl` 物件，您通常會執行下列步驟：  
  
1.  建構 `CToolBarCtrl` 物件。  
  
2.  呼叫[建立](#create)建立 Windows 工具列通用控制項並將其附加至`CToolBarCtrl`物件。 表示使用樣式，例如工具列的樣式**TBSTYLE_TRANSPARENT**透明工具列或**TBSTYLE_DROPDOWN**支援下拉式清單樣式按鈕的工具列。  
  
3.  找出您要如何顯示在工具列上的按鈕：  
  
    -   若要使用點陣圖影像的按鈕，加入按鈕點陣圖工具列藉由呼叫[AddBitmap](#addbitmap)。  
  
    -   若要使用從影像清單的按鈕顯示的影像，指定影像清單藉由呼叫[SetImageList](#setimagelist)， [SetHotImageList](#sethotimagelist)，或[SetDisabledImageList](#setdisabledimagelist)。  
  
    -   若要使用字串標籤按鈕，將字串加入至工具列藉由呼叫[AddString](#addstring)及/或[AddStrings](#addstrings)。  
  
4.  藉由呼叫在工具列上加入按鈕結構[AddButtons](#addbuttons)。  
  
5.  如果您想在不是主控視窗的工具列按鈕的工具提示`CFrameWnd`，您需要處理**TTN_NEEDTEXT**工具列的主控視窗中的訊息中所述[處理工具提示通知](../../mfc/handling-tool-tip-notifications.md). 如果父視窗的工具列衍生自`CFrameWnd`，而不需要任何額外的工作，您會顯示工具提示，因為`CFrameWnd`提供的預設處理常式。  
  
6.  如果您想讓使用者能夠自訂工具列時，處理是主控視窗中的自訂通知訊息中所述[處理自訂告知](../../mfc/handling-customization-notifications.md)。  
  
 您可以使用[SaveState](#savestate)工具列控制項的目前狀態儲存在登錄中和[RestoreState](#restorestate)以還原先前儲存在登錄中的資訊為基礎的狀態。 除了儲存工具列狀態之間的應用程式使用，應用程式通常儲存狀態之前使用者開始自訂工具列，以防使用者稍後想要將工具列還原成原始狀態。  
  
## <a name="support-for-internet-explorer-version-40-and-later"></a>Internet Explorer 版本 4.0 和更新版本的支援  
 若要支援 Internet Explorer 4.0 或更新版本，版本中引進的功能 MFC 會提供影像清單的支援和透明和一般樣式的工具列上的控制項。  
  
 透明工具列可讓您在工具列底下的用戶端，透過顯示。 若要建立透明工具列，同時使用**TBSTYLE_FLAT**和**TBSTYLE_TRANSPARENT**樣式。 透明工具列功能的熱追蹤。也就是說，當滑鼠指標移工具列上的作用中的按鈕，按鈕的外觀會變更。 建立工具列只**TBSTYLE_FLAT**樣式將包含按鈕不透明的。  
  
 影像清單的支援可讓控制項更靈活彈性，預設行為，作用中影像，並已停用映像。 使用[GetImageList](#getimagelist)， [GetHotImageList](#gethotimagelist)，和[GetDisabledImageList](#getdisabledimagelist)具有操作根據其狀態影像的透明工具列：  
  
 如需有關使用`CToolBarCtrl`，請參閱[控制項](../../mfc/controls-mfc.md)和[使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CToolBarCtrl`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxcmn.h  
  
##  <a name="addbitmap"></a>CToolBarCtrl::AddBitmap  
 將一或多個按鈕的影像加入至按鈕影像儲存在工具列控制項的清單。  
  
```  
int AddBitmap(
    int nNumButtons,  
    UINT nBitmapID);

 
int AddBitmap(
    int nNumButtons,  
    CBitmap* pBitmap);
```  
  
### <a name="parameters"></a>參數  
 `nNumButtons`  
 在點陣圖中的按鈕影像的數目。  
  
 `nBitmapID`  
 包含按鈕影像或將影像之點陣圖的資源識別碼。  
  
 `pBitmap`  
 指標`CBitmap`包含按鈕影像或映像以新增的物件。  
  
### <a name="return-value"></a>傳回值  
 以零為起始的第一個新的映像成功; 如果索引否則為-1。  
  
### <a name="remarks"></a>備註  
 您可以使用 Windows API [CreateMappedBitmap](http://msdn.microsoft.com/library/windows/desktop/bb787467)對應之前加入至工具列點陣圖的色彩。 如果您要傳入的指標**CBitMap**物件，您必須確定該點陣圖並不會終結之前終結工具列。  
  
##  <a name="addbuttons"></a>CToolBarCtrl::AddButtons  
 將一或多個按鈕加入至工具列控制項。  
  
```  
BOOL AddButtons(
    int nNumButtons,  
    LPTBBUTTON lpButtons);
```  
  
### <a name="parameters"></a>參數  
 `nNumButtons`  
 若要加入的按鈕數目。  
  
 `lpButtons`  
 陣列中的位址`TBBUTTON`結構，其中包含要加入按鈕的相關資訊。 必須有相同數目的陣列中的項目，以所指定的按鈕`nNumButtons`。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 `lpButtons`指標會指向陣列`TBBUTTON`結構。 每個`TBBUTTON`結構將按鈕加入與按鈕的樣式、 映像及/或字串、 命令識別碼的狀態，以及使用者定義的資料產生關聯：  
  
 `typedef struct _TBBUTTON {`  
  
 `int iBitmap;// zero-based index of button image`  
  
 `int idCommand;  // command to be sent when button pressed`  
  
 `BYTE fsState;   // button state--see below`  
  
 `BYTE fsStyle;   // button style--see below`  
  
 `DWORD dwData;   // application-defined value`  
  
 `int iString;// zero-based index of button label string`  
  
 `} TBBUTTON;`  
  
 成員如下所示：  
  
 **iBitmap**  
 按鈕影像，-1，如果沒有此按鈕影像的以零為起始的索引。  
  
 **idCommand**  
 關聯按鈕的命令識別項。 此識別碼會傳送**WM_COMMAND**訊息選擇按鈕時。 如果**fsStyle**成員具有`TBSTYLE_SEP`值，這個成員必須是零。  
  
 **fsState**  
 按鈕狀態旗標。 它可以是下列值的組合：  
  
- `TBSTATE_CHECKED`按鈕的**TBSTYLE_CHECKED**樣式，並按下。  
  
- `TBSTATE_ENABLED`[] 按鈕，接受使用者輸入。 沒有此狀態的按鈕不接受使用者輸入，並會變成灰色。  
  
- `TBSTATE_HIDDEN`按鈕看不到，並無法接收使用者輸入。  
  
- `TBSTATE_INDETERMINATE`按鈕會變成灰色。  
  
- `TBSTATE_PRESSED`按鈕已按下。  
  
- `TBSTATE_WRAP`分行符號會遵循 [] 按鈕。 按鈕還必須`TBSTATE_ENABLED`狀態。  
  
 **fsStyle**  
 按鈕樣式。 它可以是下列值的組合：  
  
- `TBSTYLE_BUTTON`建立標準的按鈕。  
  
- `TBSTYLE_CHECK`建立已按下或未按下狀態每次使用者按一下切換按鈕。 按下狀態時，按鈕會有不同的背景色彩。  
  
- `TBSTYLE_CHECKGROUP`建立核取按鈕保持已按下群組中的另一個按鈕按下為止。  
  
- `TBSTYLE_GROUP`建立直到按下群組中的另一個按鈕是處於已按下按鈕。  
  
- `TBSTYLE_SEP`建立提供小的缺口按鈕群組之間的分隔符號。 具有此樣式的按鈕不會接收使用者輸入。  
  
 `dwData`  
 使用者定義的資料。  
  
 **iString**  
 要做為按鈕的標籤，-1 表示任何字串，此按鈕的字串以零為起始的索引。  
  
 映像及/或您提供的索引必須先前已加入至工具列控制項的字串清單使用[AddBitmap](#addbitmap)， [AddString](#addstring)，及/或[AddStrings](#addstrings)。  
  
##  <a name="addstring"></a>CToolBarCtrl::AddString  
 新增新的字串，做為資源識別碼，工具列的內部清單的字串來傳遞。  
  
```  
int AddString(UINT nStringID);
```  
  
### <a name="parameters"></a>參數  
 *nStringID*  
 若要加入至工具列控制項的字串清單的字串資源的資源識別碼。  
  
### <a name="return-value"></a>傳回值  
 第一個成功; 如果加入的新字串的以零起始的索引否則為-1。  
  
##  <a name="addstrings"></a>CToolBarCtrl::AddStrings  
 將新的字串加入至可供工具列控制項的字串清單。  
  
```  
int AddStrings(LPCTSTR lpszStrings);
```  
  
### <a name="parameters"></a>參數  
 *lpszStrings*  
 包含要加入工具列的字串清單的一或多個 null 終止字串緩衝區的位址。 最後一個的字串必須以兩個 null 字元結束。  
  
### <a name="return-value"></a>傳回值  
 第一個成功; 如果加入的新字串的以零起始的索引否則為-1。  
  
### <a name="remarks"></a>備註  
 在緩衝區中的字串必須以 null 字元分隔。 您必須確定的最後一個字串有兩個 null 結束字元。 若要正確地格式化常數字串，您可以撰寫成：  
  
 [!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]  
  
 或：  
  
 [!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]  
  
 您不應該傳遞`CString`物件，因為它不可以有一個以上的 null 字元這個函式`CString`。  
  
##  <a name="autosize"></a>CToolBarCtrl::AutoSize  
 調整整個工具列控制項的大小。  
  
```  
void AutoSize();
```  
  
### <a name="remarks"></a>備註  
 父視窗大小變更時，或在工具列的大小變更 （例如，當您設定的按鈕或點陣圖的大小，或將字串） 時，您應該呼叫此函式。  
  
##  <a name="changebitmap"></a>CToolBarCtrl::ChangeBitmap  
 變更目前的工具列控制項中按鈕的點陣圖。  
  
```  
BOOL ChangeBitmap(
    int idButton,   
    int iBitmap);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `idButton`|要接收新的點陣圖按鈕的命令識別碼。|  
|[輸入] `iBitmap`|目前的工具列控制項影像清單中的映像的以零為起始的索引。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功為 `true`；否則為 `false`。  
  
### <a name="remarks"></a>備註  
 如果此方法成功，則系統會顯示指定的映像中指定的按鈕。  
  
 這個方法會傳送[TB_CHANGEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787301) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會變更的點陣圖**檔案儲存**的點陣圖按鈕**有關** 按鈕。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]  
  
##  <a name="checkbutton"></a>CToolBarCtrl::CheckButton  
 會檢查或清除在工具列控制項中指定的按鈕。  
  
```  
BOOL CheckButton(
    int nID,  
    BOOL bCheck = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 若要檢查或清除 按鈕的命令識別碼。  
  
 *bCheck*  
 **TRUE**檢查 按鈕， **FALSE**來加以清除。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 當已核取按鈕時，它會顯示已按下。 如果您想要將一個以上的按鈕狀態變更，請考慮呼叫[SetState](#setstate)改為。  
  
##  <a name="commandtoindex"></a>CToolBarCtrl::CommandToIndex  
 擷取與指定的命令識別碼相關聯的按鈕以零為起始的索引。  
  
```  
UINT CommandToIndex(UINT nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 命令 ID 的按鈕索引您想要尋找。  
  
### <a name="return-value"></a>傳回值  
 按鈕與命令識別碼相關聯的以零為起始的索引  
  
### <a name="remarks"></a>備註  
  
##  <a name="create"></a>CToolBarCtrl::Create  
 建立工具列控制項，並將它附加至`CToolBarCtrl`物件。  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 `dwStyle`  
 指定工具列控制項的樣式。 工具列，一定要有**WS_CHILD**樣式。 此外，指定工具列的樣式和的視窗樣式的任意組合，如底下所述**備註**。  
  
 `rect`  
 選擇性地指定工具列控制項的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構。  
  
 `pParentWnd`  
 指定工具列控制項的父視窗。 它不得為**NULL**。  
  
 `nID`  
 指定工具列控制項的 id。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 您建構`CToolBarCtrl`分成兩個步驟。 首先，呼叫建構函式，然後再呼叫**建立**，建立工具列控制項，並將它附加至`CToolBarCtrl`物件。 在工具列控制項中套用下列視窗樣式。  
  
- **WS_CHILD**一律  
  
- **WS_VISIBLE**通常  
  
- **WS_DISABLED**很少  
  
 請參閱[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)說明的視窗樣式的 Windows SDK 中。  
  
 （選擇性） 將套用的組合[通用控制項樣式](http://msdn.microsoft.com/library/windows/desktop/bb775498)、 Windows SDK 中所述。  
  
 套用至控制項或按鈕本身的 toolbar 樣式的組合。 主題會描述樣式[工具列控制項和按鈕樣式](http://msdn.microsoft.com/library/windows/desktop/bb760439)Windows SDK 中。  
  
 若要使用擴充的工具列的樣式，呼叫[SetExtendedStyle](#setextendedstyle)呼叫之後**建立**。 若要建立使用延伸的視窗樣式的工具列，呼叫[CToolBarCtrl::CreateEx](#createex)而不是**建立**。  
  
 工具列控制項將會自動設定的大小和工具列視窗的位置。 高度為基礎的工具列中按鈕的高度。 寬度是父視窗的用戶端區域的寬度相同。 `CCS_TOP`和`CCS_BOTTOM`樣式會判斷工具列是否位於沿著頂端或底部的 工作區。 根據預設，工具列上有`CCS_TOP`樣式。  
  
##  <a name="createex"></a>CToolBarCtrl::CreateEx  
 建立控制項 （子視窗），並將它與相關聯`CToolBarCtrl`物件。  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 `dwExStyle`  
 指定正在建立的控制項的延伸的樣式。 如需延伸的視窗樣式的清單，請參閱`dwExStyle`參數[CreateWindowEx](http://msdn.microsoft.com/library/windows/desktop/ms632680) Windows SDK 中。  
  
 `dwStyle`  
 指定工具列控制項的樣式。 工具列，一定要有**WS_CHILD**樣式。 此外，您可以指定工具列的樣式和的視窗樣式的任意組合中所述**備註**區段[建立](#create)。  
  
 `rect`  
 若要參考[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構描述的大小和位置來建立，用戶端座標中之視窗`pParentWnd`。  
  
 `pParentWnd`  
 為控制項的父視窗的指標。  
  
 `nID`  
 控制項的子視窗識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 使用`CreateEx`而不是[建立](#create)套用延伸的視窗樣式，由 Windows 擴充的樣式序言**WS_EX_**。 **CreateEx**建立具有所指定的延伸視窗樣式控制項， `dwExStyle`。 設定擴充特定控制項使用的樣式[SetExtendedStyle](#setextendedstyle)。 例如，使用`CreateEx`設定做為這類樣式**WS_EX_CONTEXTHELP**，但使用`SetExtendedStyle`設定做為這類樣式**TBSTYLE_EX_DRAWDDARROWS**。 如需詳細資訊，請參閱中所述的樣式[工具列擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb760430)Windows SDK 中。  
  
##  <a name="ctoolbarctrl"></a>CToolBarCtrl::CToolBarCtrl  
 建構 `CToolBarCtrl` 物件。  
  
```  
CToolBarCtrl();
```  
  
### <a name="remarks"></a>備註  
 您必須呼叫[建立](#create)才可以使用工具列。  
  
##  <a name="customize"></a>CToolBarCtrl::Customize  
 顯示 [自訂工具列] 對話方塊。  
  
```  
void Customize();
```  
  
### <a name="remarks"></a>備註  
 這個對話方塊可讓使用者自訂工具列加入和刪除按鈕。 若要支援自訂，工具列的父視窗必須處理自訂告知訊息中所述[處理自訂告知](../../mfc/handling-customization-notifications.md)。 將工具列必須也已經建立具有`CCS_ADJUSTABLE`樣式中所述[CToolBarCtrl::Create](#create)。  
  
 如需詳細資訊，請參閱知識庫文章 Q241850: PRB： 呼叫 CToolBarCtrl::Customize 不會保留自訂的對話方塊可見。  
  
##  <a name="deletebutton"></a>CToolBarCtrl::DeleteButton  
 從工具列控制項中刪除按鈕。  
  
```  
BOOL DeleteButton(int nIndex);
```  
  
### <a name="parameters"></a>參數  
 `nIndex`  
 [刪除] 按鈕的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
  
##  <a name="enablebutton"></a>CToolBarCtrl::EnableButton  
 啟用或停用工具列控制項中指定的按鈕。  
  
```  
BOOL EnableButton(
    int nID,  
    BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 若要啟用或停用按鈕的命令識別碼。  
  
 `bEnable`  
 **TRUE**啟用按鈕。**FALSE**來停用按鈕。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 在已啟用 按鈕，可以按下並檢查。 如果您想要將一個以上的按鈕狀態變更，請考慮呼叫[SetState](#setstate)改為。  
  
##  <a name="getanchorhighlight"></a>CToolBarCtrl::GetAnchorHighlight  
 擷取工具列設定錨點反白顯示。  
  
```  
BOOL GetAnchorHighlight() const;  
```  
  
### <a name="return-value"></a>傳回值  
 如果是非零值，錨點反白顯示已啟用。 如果是零，錨點反白顯示已停用。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETANCHORHIGHLIGHT](http://msdn.microsoft.com/library/windows/desktop/bb787313)、 Windows SDK 中所述。  
  
##  <a name="getbitmap"></a>CToolBarCtrl::GetBitmap  
 擷取在工具列中的按鈕相關聯的點陣圖的索引。  
  
```  
int GetBitmap(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 命令按鈕點陣圖索引是要擷取的識別碼。  
  
### <a name="return-value"></a>傳回值  
 傳回索引的點陣圖，如果成功，否則為零。  
  
### <a name="remarks"></a>備註  
 實作功能[TB_GETBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787315) Windows SDK 中。  
  
##  <a name="getbitmapflags"></a>CToolBarCtrl::GetBitmapFlags  
 擷取從工具列的點陣圖旗標。  
  
```  
UINT GetBitmapFlags() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A **UINT**具有**TBBF_LARGE**設定旗標，如果顯示可以清除否則支援大型工具列點陣圖。  
  
### <a name="remarks"></a>備註  
 建立工具列之後但在之前加入至工具列的點陣圖，您應該呼叫它。 傳回值會指出是否顯示或不支援大型點陣圖。 若顯示器支援大型點陣圖，而且如果您選擇使用它們，請呼叫[SetBitmapSize](#setbitmapsize)和[SetButtonSize](#setbuttonsize)才能加入您的大型點陣圖使用[AddBitmap](#addbitmap)。  
  
##  <a name="getbutton"></a>CToolBarCtrl::GetButton  
 擷取指定的按鈕，在工具列控制項中的相關資訊。  
  
```  
BOOL GetButton(
    int nIndex,  
    LPTBBUTTON lpButton) const;  
```  
  
### <a name="parameters"></a>參數  
 `nIndex`  
 要擷取資訊按鈕的以零為起始的索引。  
  
 `lpButton`  
 位址`TBBUTTON`會收到一份按鈕資訊的結構。 請參閱[CToolBarCtrl::AddButtons](#addbuttons)有關`TBBUTTON`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
##  <a name="getbuttoncount"></a>CToolBarCtrl::GetButtonCount  
 擷取工具列控制項中目前的按鈕數目。  
  
```  
int GetButtonCount() const;  
```  
  
### <a name="return-value"></a>傳回值  
 按鈕的計數。  
  
##  <a name="getbuttoninfo"></a>CToolBarCtrl::GetButtonInfo  
 擷取在工具列中按鈕的資訊。  
  
```  
int GetButtonInfo(
    int nID,  
    TBBUTTONINFO* ptbbi) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 按鈕的識別項。  
  
 `ptbbi`  
 指標[TBBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb760478)接收按鈕資訊的結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功; 按鈕的以零起始的索引否則為-1。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb787321)、 Windows SDK 中所述。  
  
##  <a name="getbuttonsize"></a>CToolBarCtrl::GetButtonSize  
 取得工具列按鈕的大小。  
  
```  
DWORD GetButtonSize() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`DWORD`寬度和高度與中的值取代 LOWORD HIWORD，會分別包含的值。  
  
##  <a name="getbuttontext"></a>CToolBarCtrl::GetButtonText  
 擷取指定目前的工具列控制項上按鈕的顯示文字。  
  
```  
CString GetButtonText(int idButton) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `idButton`|擷取其顯示文字按鈕的識別項。|  
  
### <a name="return-value"></a>傳回值  
 A [CString](../../atl-mfc-shared/using-cstring.md) ，其中包含指定的按鈕的顯示文字。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_GETBUTTONTEXT](http://msdn.microsoft.com/library/windows/desktop/bb787325) Windows SDK 中所述的訊息。  
  
##  <a name="getcolorscheme"></a>CToolBarCtrl::GetColorScheme  
 擷取目前的工具列控制項的色彩配置。  
  
```  
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸出] `lpColorScheme`|指標[新增的色彩配置](http://msdn.microsoft.com/library/windows/desktop/bb775502)接收色彩配置資訊的結構。 此方法傳回時，結構描述的反白顯示色彩和工具列控制項的陰影色彩。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功為 `true`；否則為 `false`。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_GETCOLORSCHEME](http://msdn.microsoft.com/library/windows/desktop/bb787327) Windows SDK 中所述的訊息。  
  
##  <a name="getdisabledimagelist"></a>CToolBarCtrl::GetDisabledImageList  
 擷取映像清單工具列控制項用來顯示停用按鈕。  
  
```  
CImageList* GetDisabledImageList() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或**NULL**如果沒有已停用映像清單設定。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETDISABLEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787329)、 Windows SDK 中所述。 MFC 實作`GetDisabledImageList`使用`CImageList`物件，其中包含的工具列控制項的按鈕映像，而不是影像清單控制代碼。  
  
##  <a name="getdroptarget"></a>CToolBarCtrl::GetDropTarget  
 擷取[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)工具列控制項的介面。  
  
```  
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;  
```  
  
### <a name="parameters"></a>參數  
 `ppDropTarget`  
 指標[IDropTarget](http://msdn.microsoft.com/library/windows/desktop/ms679679)介面指標。 如果發生錯誤， **NULL**指標放在此位址。  
  
### <a name="return-value"></a>傳回值  
 傳回`HRESULT`值，指出成功或失敗的作業。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETOBJECT](http://msdn.microsoft.com/library/windows/desktop/bb787343)、 Windows SDK 中所述。  
  
##  <a name="getextendedstyle"></a>CToolBarCtrl::GetExtendedStyle  
 擷取工具列控制項的延伸的樣式。  
  
```  
DWORD GetExtendedStyle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A `DWORD` ，代表目前工具列控制項的使用中的延伸的樣式。 如需樣式的清單，請參閱[工具列擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb760430)，Windows SDK 中。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb787331)、 Windows SDK 中所述。  
  
##  <a name="gethotimagelist"></a>CToolBarCtrl::GetHotImageList  
 擷取映像清單工具列控制項用來顯示 「 熱 」 按鈕。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。  
  
```  
CImageList* GetHotImageList() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或**NULL**如果沒有已停用映像清單設定。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETHOTIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787334)、 Windows SDK 中所述。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。  
  
##  <a name="gethotitem"></a>CToolBarCtrl::GetHotItem  
 擷取作用中工具列項目的索引。  
  
```  
int GetHotItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在工具列中作用的項目以零為起始的索引。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETHOTITEM](http://msdn.microsoft.com/library/windows/desktop/bb787336)、 Windows SDK 中所述。  
  
##  <a name="getimagelist"></a>CToolBarCtrl::GetImageList  
 擷取工具列控制項中用來顯示按鈕為預設狀態的影像清單。  
  
```  
CImageList* GetImageList() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或**NULL**如果任何影像清單不設定。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787337)、 Windows SDK 中所述。  
  
##  <a name="getinsertmark"></a>CToolBarCtrl::GetInsertMark  
 擷取目前的插入標記的工具列。  
  
```  
void GetInsertMark(TBINSERTMARK* ptbim) const;  
```  
  
### <a name="parameters"></a>參數  
 `ptbim`  
 指標[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)接收插入標記的結構。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb787338)、 Windows SDK 中所述。  
  
##  <a name="getinsertmarkcolor"></a>CToolBarCtrl::GetInsertMarkColor  
 擷取用來繪製工具列插入標記的色彩。  
  
```  
COLORREF GetInsertMarkColor() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A **COLORREF**值，包含目前的插入標記色彩。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb787339)、 Windows SDK 中所述。  
  
##  <a name="getitemrect"></a>CToolBarCtrl::GetItemRect  
 擷取的按鈕，在工具列控制項中的週框矩形。  
  
```  
BOOL GetItemRect(
    int nIndex,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>參數  
 `nIndex`  
 要擷取資訊按鈕的以零為起始的索引。  
  
 `lpRect`  
 位址[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件，可接收的週框的座標。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式不會擷取其狀態設定為按鈕之周框`TBSTATE_HIDDEN`。  
  
##  <a name="getmaxsize"></a>CToolBarCtrl::GetMaxSize  
 擷取所有可見的按鈕和工具列中的分隔線的總大小。  
  
```  
BOOL GetMaxSize(LPSIZE pSize) const;  
```  
  
### <a name="parameters"></a>參數  
 `pSize`  
 指標[大小](http://msdn.microsoft.com/library/windows/desktop/dd145106)接收項目的大小的結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETMAXSIZE](http://msdn.microsoft.com/library/windows/desktop/bb787341)、 Windows SDK 中所述。  
  
##  <a name="getmaxtextrows"></a>CToolBarCtrl::GetMaxTextRows  
 擷取工具列按鈕上顯示的文字資料列的數目上限。  
  
```  
int GetMaxTextRows() const;  
```  
  
### <a name="return-value"></a>傳回值  
 工具列按鈕上顯示的文字資料列的數目上限。  
  
##  <a name="getmetrics"></a>CToolBarCtrl::GetMetrics  
 擷取的計量`CToolBarCtrl`物件。  
  
```  
void GetMetrics(LPTBMETRICS ptbm) const;  
```  
  
### <a name="parameters"></a>參數  
 `ptbm`  
 指標[TBMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb760482)結構`CToolBarCtrl`物件。  
  
### <a name="remarks"></a>備註  
 此成員函式模擬的功能[TB_GETMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb787342)訊息、 Windows SDK 中所述。  
  
##  <a name="getpadding"></a>CToolBarCtrl::GetPadding  
 擷取目前的工具列控制項的水平和垂直填補。  
  
```  
BOOL GetPadding(
    int* pnHorzPadding,   
    int* pnVertPadding) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸出] `pnHorzPadding`|整數，接收的水平填補工具列控制項的像素為單位。|  
|[輸出] `pnVertPadding`|工具列控制項的垂直填補接收像素為單位的整數。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功為 `true`；否則為 `false`。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_GETPADDING](http://msdn.microsoft.com/library/windows/desktop/bb787344) Windows SDK 中所述的訊息。  
  
##  <a name="getpressedimagelist"></a>CToolBarCtrl::GetPressedImageList  
 擷取目前的工具列控制項用來代表按鈕已按下狀態的影像清單。  
  
```  
CImageList* GetPressedImageList();
```  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md) ，其中包含目前的控制項影像清單或`NULL`如果沒有這類映像清單設定。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_GETPRESSEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787345) Windows SDK 中所述的訊息。  
  
##  <a name="getrect"></a>CToolBarCtrl::GetRect  
 擷取指定的工具列按鈕的週框矩形。  
  
```  
BOOL GetRect(
    int nID,  
    LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 按鈕的識別項。  
  
 `lpRect`  
 指標[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)接收週框矩形資訊的結構。  
  
### <a name="return-value"></a>傳回值  
 **TRUE**如果成功，否則**FALSE**。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETRECT](http://msdn.microsoft.com/library/windows/desktop/bb787346)、 Windows SDK 中所述。  
  
##  <a name="getrows"></a>CToolBarCtrl::GetRows  
 擷取資料列的目前顯示的工具列控制項的按鈕數目。  
  
```  
int GetRows() const;  
```  
  
### <a name="return-value"></a>傳回值  
 資料列的目前顯示在工具列上的按鈕數目。  
  
### <a name="remarks"></a>備註  
 請注意，資料列數目一律將其中一個除非以建立工具列`TBSTYLE_WRAPABLE`樣式。  
  
##  <a name="getstate"></a>CToolBarCtrl::GetState  
 擷取指定的按鈕，在工具列控制項中，例如它、 按下，是否啟用檢查的狀態相關資訊。  
  
```  
int GetState(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 要擷取資訊按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功時，按鈕狀態資訊或者-1，否則為。 按鈕的狀態資訊可以是中所列的值組合[CToolBarCtrl::AddButtons](#addbuttons)。  
  
### <a name="remarks"></a>備註  
 此函式是特別有用，如果您想要擷取一個以上的按鈕狀態。 若要只擷取一個狀態，請使用下列成員函式的其中一個： [IsButtonEnabled](#isbuttonenabled)， [IsButtonChecked](#isbuttonchecked)， [IsButtonPressed](#isbuttonpressed)， [IsButtonHidden](#isbuttonhidden)，或[IsButtonIndeterminate](#isbuttonindeterminate)。 不過，`GetState`成員函式是唯一的方法，可偵測`TBSTATE_WRAP`按鈕狀態。  
  
##  <a name="getstring"></a>CToolBarCtrl::GetString  
 擷取工具列字串。  
  
```  
int GetString(
    int nString,  
    LPTSTR lpstrString,  
    int cchMaxLen) const;  
  
int GetString(
    int nString,  
    CString& str) const;  
```  
  
### <a name="parameters"></a>參數  
 *nString*  
 字串的索引。  
  
 *lpstrString*  
 用來傳回字串之緩衝區的指標。  
  
 *cchMaxLen*  
 以位元組為單位的緩衝區長度。  
  
 `str`  
 字串。  
  
### <a name="return-value"></a>傳回值  
 如果成功，字串的長度-1，如果不是。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_GETSTRING](http://msdn.microsoft.com/library/windows/desktop/bb787349)、 Windows SDK 中所述。  
  
##  <a name="getstyle"></a>CToolBarCtrl::GetStyle  
 取得目前套用至工具列控制項的樣式。  
  
```  
DWORD GetStyle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 A`DWORD`包含的組合[toolbar 控制項樣式](http://msdn.microsoft.com/library/windows/desktop/bb760439)、 Windows SDK 中所述。  
  
##  <a name="gettooltips"></a>CToolBarCtrl::GetToolTips  
 如果任何與工具列控制項相關聯，請擷取工具提示控制項的控制代碼。  
  
```  
CToolTipCtrl* GetToolTips() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)與工具列相關聯的物件或**NULL**如果工具列有沒有相關聯的工具提示控制項。  
  
### <a name="remarks"></a>備註  
 工具列控制項通常會建立並維護它自己的工具提示控制項，因為大部分的程式不需要呼叫此函式。  
  
##  <a name="hittest"></a>CToolBarCtrl::HitTest  
 決定工具列控制項中點所在的位置。  
  
```  
int HitTest(LPPOINT ppt) const;  
```  
  
### <a name="parameters"></a>參數  
 `ppt`  
 指標[點](http://msdn.microsoft.com/library/windows/desktop/dd162805)結構，包含點擊測試中的 x 座標**x**成員和 y 座標點擊的測試中**y**成員。 座標是相對於工具列的用戶端區域。  
  
### <a name="return-value"></a>傳回值  
 整數值，指出工具列上的某個點的位置。 如果值為零或正值，此傳回值會是點在於 nonseparator 項目的以零為起始的索引。  
  
 如果傳回的值為負數，點不位於按鈕。 傳回值的絕對值是分隔符號項目或最接近的 nonseparator 項目的索引。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_HITTEST](http://msdn.microsoft.com/library/windows/desktop/bb787360)、 Windows SDK 中所述。  
  
##  <a name="hidebutton"></a>CToolBarCtrl::HideButton  
 隱藏或顯示在工具列控制項中指定的按鈕。  
  
```  
BOOL HideButton(
    int nID,  
    BOOL bHide = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 顯示或隱藏按鈕的命令識別碼。  
  
 `bHide`  
 **TRUE**表示隱藏按鈕， **FALSE**顯示它。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 如果您想要將一個以上的按鈕狀態變更，請考慮呼叫[SetState](#setstate)改為。  
  
##  <a name="indeterminate"></a>CToolBarCtrl::Indeterminate  
 設定或清除指定的按鈕，在工具列控制項中的不定狀態。  
  
```  
BOOL Indeterminate(
    int nID,  
    BOOL bIndeterminate = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 其不確定的狀態是設定或已清除 按鈕的命令識別碼。  
  
 *bIndeterminate*  
 **TRUE**設定指定的按鈕不確定狀態**FALSE**來加以清除。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 不確定顯示按鈕呈現灰色，例如使用文書處理器的方式在工具列上 [粗體] 按鈕看起來時選取的文字包含粗體和規則的字元。 如果您想要將一個以上的按鈕狀態變更，請考慮呼叫[SetState](#setstate)改為。  
  
##  <a name="insertbutton"></a>CToolBarCtrl::InsertButton  
 在工具列控制項中插入按鈕。  
  
```  
BOOL InsertButton(
    int nIndex,  
    LPTBBUTTON lpButton);
```  
  
### <a name="parameters"></a>參數  
 `nIndex`  
 按鈕的以零為起始的索引。 此函式插入此按鈕左邊的 [新增] 按鈕。  
  
 `lpButton`  
 位址`TBBUTTON`結構，其中包含要插入按鈕的相關資訊。 請參閱[CToolBarCtrl::AddButtons](#addbuttons)的說明`TBBUTTON`結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 映像及/或您提供的索引必須先前已加入至工具列控制項的字串清單使用[AddBitmap](#addbitmap)， [AddString](#addstring)，及/或[AddStrings](#addstrings)。  
  
##  <a name="insertmarkhittest"></a>CToolBarCtrl::InsertMarkHitTest  
 擷取在工具列中的點的插入標記資訊。  
  
```  
BOOL InsertMarkHitTest(
    LPPOINT ppt,  
    LPTBINSERTMARK ptbim) const;  
```  
  
### <a name="parameters"></a>參數  
 `ppt`  
 指標[點](http://msdn.microsoft.com/library/windows/desktop/dd162805)協調結構，其中包含的點擊的測試，相對於用戶端區域的工具列。  
  
 `ptbim`  
 指標[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)接收插入標記資訊的結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_INSERTMARKHITTEST](http://msdn.microsoft.com/library/windows/desktop/bb787367)、 Windows SDK 中所述。  
  
##  <a name="isbuttonchecked"></a>CToolBarCtrl::IsButtonChecked  
 決定是否要檢查在工具列控制項中指定的按鈕。  
  
```  
BOOL IsButtonChecked(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 在工具列中按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果核取按鈕; 非零，否則為零。  
  
### <a name="remarks"></a>備註  
 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。  
  
##  <a name="isbuttonenabled"></a>CToolBarCtrl::IsButtonEnabled  
 判斷是否已啟用工具列控制項中指定的按鈕。  
  
```  
BOOL IsButtonEnabled(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 在工具列中按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果已啟用 按鈕。否則為零。  
  
### <a name="remarks"></a>備註  
 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。  
  
##  <a name="isbuttonhidden"></a>CToolBarCtrl::IsButtonHidden  
 決定是否要隱藏工具列控制項中指定的按鈕。  
  
```  
BOOL IsButtonHidden(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 在工具列中按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 為非零，如果會隱藏按鈕。否則為零。  
  
### <a name="remarks"></a>備註  
 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。  
  
##  <a name="isbuttonhighlighted"></a>CToolBarCtrl::IsButtonHighlighted  
 會檢查工具列按鈕反白顯示狀態。  
  
```  
BOOL IsButtonHighlighted(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nID`  
 工具列按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 如果按鈕會反白顯示的正整數值，0，表示按鈕不會反白顯示，或是-1 的錯誤，就會發生。  
  
##  <a name="isbuttonindeterminate"></a>CToolBarCtrl::IsButtonIndeterminate  
 決定工具列控制項中指定的按鈕為不定。  
  
```  
BOOL IsButtonIndeterminate(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nID`  
 在工具列中按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 正整數如果按鈕是不定，如果零按鈕的逸出序列是不確定或-1 如果發生錯誤，就會發生。  
  
### <a name="remarks"></a>備註  
 不確定顯示按鈕呈現灰色，例如使用文書處理器的方式在工具列上 [粗體] 按鈕看起來時選取的文字包含粗體和規則的字元。 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。  
  
##  <a name="isbuttonpressed"></a>CToolBarCtrl::IsButtonPressed  
 決定是否要按下工具列控制項中指定的按鈕。  
  
```  
BOOL IsButtonPressed(int nID) const;  
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 在工具列中按鈕的命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 非零，如果按下按鈕，否則為零。  
  
### <a name="remarks"></a>備註  
 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。  
  
##  <a name="loadimages"></a>CToolBarCtrl::LoadImages  
 載入工具列控制項的影像清單中的點陣圖。  
  
```  
void LoadImages(
    int iBitmapID,  
    HINSTANCE hinst);
```  
  
### <a name="parameters"></a>參數  
 *iBitmapID*  
 包含要載入的影像之點陣圖的 ID。 若要指定點陣圖資源，請將此參數設定為點陣圖資源的識別碼，並設定`hInst`至**NULL**。 點陣圖資源將會加入影像清單的單一映像。 您可以藉由設定加入標準、 系統定莪點陣圖*hinst*至**HINST_COMMCTRL**並將此參數設定為下列識別碼的其中一個：  
  
|點陣圖 ID|描述|  
|---------------|-----------------|  
|IDB_HIST_LARGE_COLOR|大總管點陣圖|  
|IDB_HIST_SMALL_COLOR|總管點陣圖小的大小|  
|IDB_STD_LARGE_COLOR|大標準點陣圖|  
|IDB_STD_SMALL_COLOR|小型大小的標準點陣圖|  
|IDB_VIEW_LARGE_COLOR|檢視點陣圖大|  
|IDB_VIEW_SMALL_COLOR|檢視小型大小的點陣圖|  
  
 *hinst*  
 程式呼叫的應用程式的執行個體控制代碼。 這個參數可以是**HINST_COMMCTRL**載入標準映像清單。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_LOADIMAGES](http://msdn.microsoft.com/library/windows/desktop/bb787381)、 Windows SDK 中所述。  
  
##  <a name="mapaccelerator"></a>CToolBarCtrl::MapAccelerator  
 工具列按鈕對應的對應字元。  
  
```  
BOOL MapAccelerator(
    TCHAR chAccel,  
    UINT* pIDBtn);
```  
  
### <a name="parameters"></a>參數  
 `chAccel`  
 要對應的對應字元。 這個字元是相同按鈕的文字中標有底線的字元。  
  
 *pIDBtn*  
 指標**UINT**接收對應於加速器中指定的按鈕的命令識別碼`chAccel`。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_MAPACCELERATOR](http://msdn.microsoft.com/library/windows/desktop/bb787383)、 Windows SDK 中所述。  
  
##  <a name="markbutton"></a>CToolBarCtrl::MarkButton  
 在工具列控制項中設定指定按鈕反白顯示的狀態。  
  
```  
BOOL MarkButton(
    int nID,  
    BOOL fHighlight = TRUE);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 按鈕的識別項。  
  
 `fHighlight`  
 指定要設定的反白顯示狀態。 根據預設， **TRUE**。 如果設定為**FALSE**，按鈕設為其預設狀態。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_MARKBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787385)、 Windows SDK 中所述。  
  
##  <a name="movebutton"></a>CToolBarCtrl::MoveButton  
 將按鈕從一個索引移到另一個。  
  
```  
BOOL MoveButton(
    UINT nOldPos,  
    UINT nNewPos);
```  
  
### <a name="parameters"></a>參數  
 *nOldPos*  
 要移動的按鈕之以零為起始索引。  
  
 *nNewPos*  
 按鈕的目的以零為起始的索引。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_MOVEBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787387)、 Windows SDK 中所述。  
  
##  <a name="pressbutton"></a>CToolBarCtrl::PressButton  
 釋放在工具列控制項中指定的按鈕或按下。  
  
```  
BOOL PressButton(int nID, BOOL bPress = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `nID`  
 按下或放開按鈕的命令識別碼。  
  
 [輸入] `bPress`  
 `true`按下指定的按鈕。`false`釋放指定的按鈕。 預設值是 `true`。  
  
### <a name="return-value"></a>傳回值  
 如果方法成功，則為 `true`，否則為 `false`。  
  
### <a name="remarks"></a>備註  
 如果您想要將一個以上的按鈕狀態變更，請考慮呼叫[SetState](#setstate)改為。  
  
 這個方法會傳送[TB_PRESSBUTTON](http://msdn.microsoft.com/library/windows/desktop/bb787389) Windows SDK 中所述的訊息。  
  
##  <a name="replacebitmap"></a>CToolBarCtrl::ReplaceBitmap  
 新的點陣圖，取代目前的工具列控制項中現有的點陣圖。  
  
```  
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `pReplaceBitmap`|指標[TBREPLACEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb760484)結構，描述要被取代的點陣圖和新的點陣圖。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功為 `true`；否則為 `false`。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_REPLACEBITMAP](http://msdn.microsoft.com/library/windows/desktop/bb787391) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例以不同的點陣圖，取代 [標準] 工具列的點陣圖。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]  
  
##  <a name="restorestate"></a>CToolBarCtrl::RestoreState  
 還原工具列控制項的狀態從參數所指定的登錄中的位置。  
  
```  
void RestoreState(
    HKEY hKeyRoot,  
    LPCTSTR lpszSubKey,  
    LPCTSTR lpszValueName);
```  
  
### <a name="parameters"></a>參數  
 `hKeyRoot`  
 識別目前開啟的索引鍵，或任何下列預先定義保留的控制代碼值的登錄中：  
  
- **HKEY_CLASSES_ROOT**  
  
- **HKEY_CURRENT_USER**  
  
- **HKEY_LOCAL_MACHINE**  
  
- **HKEY_USERS**  
  
 `lpszSubKey`  
 指向以 null 終止的字串，包含值，在相關聯的子機碼名稱。 這個參數可以是 null 或空字串的指標。 如果參數是**NULL**，值會加入至所識別的索引鍵`hKeyRoot`參數。  
  
 `lpszValueName`  
 指向字串，包含要擷取之值的名稱。 如果具有此名稱的值尚未存在機碼中，函式會將其加入索引鍵。  
  
##  <a name="savestate"></a>CToolBarCtrl::SaveState  
 將工具列控制項的狀態儲存在登錄中參數所指定的位置。  
  
```  
void SaveState(
    HKEY hKeyRoot,  
    LPCTSTR lpszSubKey,  
    LPCTSTR lpszValueName);
```  
  
### <a name="parameters"></a>參數  
 `hKeyRoot`  
 識別目前開啟的索引鍵，或任何下列預先定義保留的控制代碼值的登錄中：  
  
- **HKEY_CLASSES_ROOT**  
  
- **HKEY_CURRENT_USER**  
  
- **HKEY_LOCAL_MACHINE**  
  
- **HKEY_USERS**  
  
 `lpszSubKey`  
 指向以 null 終止的字串，包含值，在相關聯的子機碼名稱。 這個參數可以是 null 或空字串的指標。 如果參數是**NULL**，值會加入至所識別的索引鍵`hKeyRoot`參數。  
  
 `lpszValueName`  
 指向字串，包含要設定之值的名稱。 如果具有此名稱的值尚未存在機碼中，函式會將其加入索引鍵。  
  
##  <a name="setanchorhighlight"></a>CToolBarCtrl::SetAnchorHighlight  
 設定錨點反白顯示的工具列設定。  
  
```  
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```  
  
### <a name="parameters"></a>參數  
 [輸入] `fAnchor`  
 指定是否錨點反白顯示已啟用或停用。 如果這個值是零，將會啟用錨點反白顯示。 如果此值為零，錨點反白顯示將會停用  
  
### <a name="return-value"></a>傳回值  
 先前的錨點設定。 如果反白顯示已啟用，這個值不是零。 如果未啟用反白顯示，這個值會是零。  
  
### <a name="remarks"></a>備註  
 這個方法會實作的 Win32 訊息行為[TB_SETANCHORHIGHLIGHT](http://msdn.microsoft.com/library/windows/desktop/bb787396)、 Windows SDK 中所述。  
  
##  <a name="setbitmapsize"></a>CToolBarCtrl::SetBitmapSize  
 設定要加入至工具列控制項之實際點陣圖影像的大小。  
  
```  
BOOL SetBitmapSize(CSize size);
```  
  
### <a name="parameters"></a>參數  
 `size`  
 寬度和高度，單位為像素點陣圖影像。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 只加入工具列中的任何點陣圖之前，必須呼叫此函數。 如果應用程式未明確設定點陣圖大小，它會預設為 16 x 15 像素為單位。  
  
##  <a name="setbuttoninfo"></a>CToolBarCtrl::SetButtonInfo  
 在工具列中設定現有的按鈕的資訊。  
  
```  
BOOL SetButtonInfo(
    int nID,  
    TBBUTTONINFO* ptbbi);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 按鈕的識別項。  
  
 `ptbbi`  
 指標[TBBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb760478)接收按鈕資訊的結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 成員函式實作的 Win32 訊息行為[TB_SETBUTTONINFO](http://msdn.microsoft.com/library/windows/desktop/bb787413)、 Windows SDK 中所述。  
  
##  <a name="setbuttonsize"></a>CToolBarCtrl::SetButtonSize  
 工具列控制項中，設定按鈕的大小。  
  
```  
BOOL SetButtonSize(CSize size);
```  
  
### <a name="parameters"></a>參數  
 `size`  
 寬度和高度，單位為像素的按鈕。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 按鈕的大小必須至少與它所含括的點陣圖大小一樣大。 只加入工具列中的任何點陣圖之前，必須呼叫此函數。 如果應用程式未明確設定按鈕的大小，它會預設為 24 x 22 像素為單位。  
  
### <a name="example"></a>範例  
  請參閱範例的[CToolBar::GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)。  
  
##  <a name="setbuttonstructsize"></a>CToolBarCtrl::SetButtonStructSize  
 指定的大小`TBBUTTON`結構。  
  
```  
void SetButtonStructSize(int nSize);
```  
  
### <a name="parameters"></a>參數  
 `nSize`  
 大小，以位元組為單位的`TBBUTTON`結構。  
  
### <a name="remarks"></a>備註  
 如果您想要儲存中的額外資料`TBBUTTON`結構，您無法衍生新的結構從`TBBUTTON`，將成員加入您需要或是建立新的結構，其中包含`TBBUTTON`結構做為其第一個成員。 然後，您可以呼叫此函式來得知工具列控制項的新的結構大小。  
  
 請參閱[CToolBarCtrl::AddButtons](#addbuttons)如需有關`TBBUTTON`結構。  
  
##  <a name="setbuttonwidth"></a>CToolBarCtrl::SetButtonWidth  
 工具列控制項中設定的最小和最大按鈕的寬度。  
  
```  
BOOL SetButtonWidth(
    int cxMin,  
    int cxMax);
```  
  
### <a name="parameters"></a>參數  
 `cxMin`  
 最小按鈕寬度，單位為像素。 工具列按鈕絕對不會比此值較窄。  
  
 *cxMax*  
 最大按鈕寬度，單位為像素。 如果按鈕文字太長，控制項會顯示它具有省略符號的點。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETBUTTONWIDTH](http://msdn.microsoft.com/library/windows/desktop/bb787417)、 Windows SDK 中所述。  
  
##  <a name="setcmdid"></a>CToolBarCtrl::SetCmdID  
 設定指定的餂鈕蒢將傳送至主控視窗的命令識別碼。  
  
```  
BOOL SetCmdID(
    int nIndex,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 `nIndex`  
 命令 ID 是要設定的按鈕之以零為起始索引。  
  
 `nID`  
 將選取的按鈕設定為命令識別碼。  
  
### <a name="return-value"></a>傳回值  
 傳回非零，如果登錄成功。否則為零。  
  
##  <a name="setcolorscheme"></a>CToolBarCtrl::SetColorScheme  
 設定目前的工具列控制項的色彩配置。  
  
```  
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `lpColorScheme`|指標[新增的色彩配置](http://msdn.microsoft.com/library/windows/desktop/bb775502)結構描述的反白顯示色彩和工具列控制項的陰影色彩。|  
  
### <a name="remarks"></a>備註  
 這個方法沒有任何作用，如果[!INCLUDE[windowsver](../../build/reference/includes/windowsver_md.md)]設定視覺化佈景主題。  
  
 這個方法會傳送[TB_SETCOLORSCHEME](http://msdn.microsoft.com/library/windows/desktop/bb787421) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會設定目前工具列控制項的色彩配置。 程式碼範例將每個工具按鈕紅色的左端和頂端邊緣和右邊緣和下邊緣藍色。 當使用者按下按鈕時，會變成藍色按鈕的紅色邊緣和其藍色邊緣會變成紅色。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]  
  
##  <a name="setdisabledimagelist"></a>CToolBarCtrl::SetDisabledImageList  
 設定工具列控制項將使用的影像清單來顯示停用按鈕。  
  
```  
CImageList* SetDisabledImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>參數  
 `pImageList`  
 指標`CImageList`物件，其中包含可供工具列控制項來顯示停用按鈕映像的映像。  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)先前使用工具列控制項來顯示停用按鈕影像的物件。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETDISABLEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787423)、 Windows SDK 中所述。 MFC 實作`SetDisabledImageList`使用`CImageList`物件，其中包含已停用的按鈕的工具列控制項的映像，而不是影像清單控制代碼。  
  
##  <a name="setdrawtextflags"></a>CToolBarCtrl::SetDrawTextFlags  
 Win32 函式中設定的旗標[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，用來繪製文字中指定的矩形中，格式是根據旗標的設定方式。  
  
```  
DWORD SetDrawTextFlags(
    DWORD dwMask,  
    DWORD dwDTFlags);
```  
  
### <a name="parameters"></a>參數  
 `dwMask`  
 一或多個 Win32 函式中指定的 DT_ 旗標的組合[DrawText](http://msdn.microsoft.com/library/windows/desktop/dd162498)，表示中的位元`dwDTFlags`繪製文字時所使用。  
  
 `dwDTFlags`  
 一或多個 Win32 函式中指定的 DT_ 旗標的組合`DrawText`，指示如何將繪製按鈕的文字。 這個值會傳遞至`DrawText`時繪製按鈕文字。  
  
### <a name="return-value"></a>傳回值  
 A`DWORD`包含前一個繪製旗標的文字。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETDRAWTEXTFLAGS](http://msdn.microsoft.com/library/windows/desktop/bb787425)、 Windows SDK 中所述。 此成員函式中的 Win32 函式設定的旗標`DrawText`，其上繪製的文字中指定的矩形中，格式是根據旗標的設定方式。  
  
##  <a name="setextendedstyle"></a>CToolBarCtrl::SetExtendedStyle  
 設定工具列控制項的延伸的樣式。  
  
```  
DWORD SetExtendedStyle(DWORD dwExStyle);
```  
  
### <a name="parameters"></a>參數  
 `dwExStyle`  
 值，指定新的延伸的樣式。 這個參數可以是擴充樣式工具列的組合。  
  
### <a name="return-value"></a>傳回值  
 A `DWORD` ，代表先前擴充樣式。 如需樣式的清單，請參閱[工具列擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb760430)，Windows SDK 中。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb787427)、 Windows SDK 中所述。  
  
##  <a name="sethotimagelist"></a>CToolBarCtrl::SetHotImageList  
 設定影像清單，工具列控制項會將用來顯示 「 熱 」 按鈕。  
  
```  
CImageList* SetHotImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>參數  
 `pImageList`  
 指標`CImageList`物件，其中包含要由工具列控制項用來顯示作用中的按鈕影像的影像。  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)先前使用工具列控制項來顯示作用中的按鈕影像的物件。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETHOTIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787429)、 Windows SDK 中所述。  
  
 MFC 實作`SetHotImageList`使用`CImageList`物件，其中包含的工具列控制項的作用中的按鈕映像，而不是影像清單控制代碼。 當指標位於其上方時，作用中的按鈕會反白顯示。  
  
##  <a name="sethotitem"></a>CToolBarCtrl::SetHotItem  
 在工具列中，設定作用的項目。  
  
```  
int SetHotItem(int nHot);
```  
  
### <a name="parameters"></a>參數  
 *nHot*  
 將成為作用的項目以零為起始的索引編號。 如果此值為-1，沒有任何項目會作用。  
  
### <a name="return-value"></a>傳回值  
 上一個熱門項目，則為-1 時沒有作用的項目索引。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETHOTITEM](http://msdn.microsoft.com/library/windows/desktop/bb787431)、 Windows SDK 中所述。  
  
##  <a name="setimagelist"></a>CToolBarCtrl::SetImageList  
 設定映像清單工具列將用來顯示處於預設狀態的按鈕。  
  
```  
CImageList* SetImageList(CImageList* pImageList);
```  
  
### <a name="parameters"></a>參數  
 `pImageList`  
 指標`CImageList`物件，其中包含要由工具列控制項用來在預設狀態顯示按鈕影像的影像。  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md)先前使用工具列控制項來顯示按鈕影像預設狀態中的物件。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787433)、 Windows SDK 中所述。  
  
 MFC 實作`SetImageList`使用`CImageList`物件，其中包含的工具列控制項的按鈕映像，而不是影像清單控制代碼。  
  
##  <a name="setindent"></a>CToolBarCtrl::SetIndent  
 在工具列控制項中設定的第一個按鈕的縮排。  
  
```  
BOOL SetIndent(int iIndent);
```  
  
### <a name="parameters"></a>參數  
 *iIndent*  
 像素為單位指定縮排 的值。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
##  <a name="setinsertmark"></a>CToolBarCtrl::SetInsertMark  
 設定目前的插入標記的工具列。  
  
```  
void SetInsertMark(TBINSERTMARK* ptbim);
```  
  
### <a name="parameters"></a>參數  
 `ptbim`  
 指標[TBINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb760480)結構，包含插入標記。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb787437)、 Windows SDK 中所述。  
  
##  <a name="setinsertmarkcolor"></a>CToolBarCtrl::SetInsertMarkColor  
 設定用來繪製工具列插入標記的色彩。  
  
```  
COLORREF SetInsertMarkColor(COLORREF clrNew);
```  
  
### <a name="parameters"></a>參數  
 `clrNew`  
 A **COLORREF**包含新插入標記色彩值。  
  
### <a name="return-value"></a>傳回值  
 A **COLORREF**值，包含前一個插入標記色彩。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 Win32 訊息行為[TB_SETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb787439)、 Windows SDK 中所述。  
  
##  <a name="setmaxtextrows"></a>CToolBarCtrl::SetMaxTextRows  
 設定顯示在工具列按鈕上的文字資料列數目上限。  
  
```  
BOOL SetMaxTextRows(int iMaxRows);
```  
  
### <a name="parameters"></a>參數  
 *iMaxRows*  
 若要設定的資料列的數目上限。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
##  <a name="setmetrics"></a>CToolBarCtrl::SetMetrics  
 設定的度量`CToolBarCtrl`物件。  
  
```  
void SetMetrics(LPTBMETRICS ptbm);
```  
  
### <a name="parameters"></a>參數  
 `ptbm`  
 指標[TBMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb760482)結構`CToolBarCtrl`物件。  
  
### <a name="remarks"></a>備註  
 此成員函式模擬的功能[TB_SETMETRICS](http://msdn.microsoft.com/library/windows/desktop/bb787446)訊息、 Windows SDK 中所述。  
  
##  <a name="setowner"></a>CToolBarCtrl::SetOwner  
 設定工具列控制項的主控視窗。  
  
```  
void SetOwner(CWnd* pWnd);
```  
  
### <a name="parameters"></a>參數  
 `pWnd`  
 指標`CWnd`或`CWnd`-衍生將成為新的擁有者視窗工具列控制項的物件。  
  
### <a name="remarks"></a>備註  
 主控視窗會收到通知，從工具列的視窗。  
  
##  <a name="setpadding"></a>CToolBarCtrl::SetPadding  
 設定目前的工具列控制項的水平和垂直填補。  
  
```  
DWORD SetPadding(
    int nHorzPadding,   
    int nVertPadding);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `nHorzPadding`|指定水平填補工具列控制項的像素為單位。|  
|[輸入] `nVertPadding`|指定工具列控制項的垂直填補像素為單位。|  
  
### <a name="return-value"></a>傳回值  
 A`DWORD`其低字包含之前的水平填補值，而其高 word 包含先前的垂直填補值。 填補值會以像素為單位測量。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_SETPADDING](http://msdn.microsoft.com/library/windows/desktop/bb787448) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會設定目前工具列控制項的水平和垂直填補到 20 像素為單位。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]  
  
##  <a name="setpressedimagelist"></a>CToolBarCtrl::SetPressedImageList  
 設定目前的工具列控制項用來代表按鈕已按下狀態的影像清單。  
  
```  
CImagelist* SetPressedImageList(
    int iImageID,   
    CImageList* pImageList);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[輸入] `iImageID`|影像清單的以零為起始的索引。 如果您使用只有一個影像清單，請將這個參數設定為零。|  
|[輸入] `pImageList`|指標[CImageList](../../mfc/reference/cimagelist-class.md)包含新的映像清單。|  
  
### <a name="return-value"></a>傳回值  
 指標[CImageList](../../mfc/reference/cimagelist-class.md) ，其中包含目前的控制項，先前的影像清單或`NULL`如果不設定了任何這類影像清單。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TB_SETPRESSEDIMAGELIST](http://msdn.microsoft.com/library/windows/desktop/bb787453) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會設定成預設映像清單相同的已按下的影像清單。  
  
 [!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]  
  
##  <a name="setrows"></a>CToolBarCtrl::SetRows  
 會要求工具列控制項調整大小的資料列要求的數目。  
  
```  
void SetRows(
    int nRows,  
    BOOL bLarger,  
    LPRECT lpRect);
```  
  
### <a name="parameters"></a>參數  
 `nRows`  
 要求的資料列數目。  
  
 `bLarger`  
 指示是否要使用多個資料列或較少的資料列，如果工具列無法調整大小的資料列要求的數目。  
  
 `lpRect`  
 指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構，將會收到新週框的工具列。  
  
### <a name="remarks"></a>備註  
 如果工具列無法自行調整大小的要求的數目或資料列，它會調整本身大小為下一個較大或下一個較小有效的大小，根據的值`bLarger`。 如果`bLarger`是**TRUE**，新的資料列數目將會大於要求的數目。 如果`bLarger`是**FALSE**，新的資料列數目將會小於要求的數目。  
  
 如果，所有資料列具有相同數目的按鈕 （除了可能是最後一個資料列） 都可以排列按鈕的工具列正確給定的資料列數目。 例如，包含四個按鈕的工具列無法不調整為三個資料列因為最後兩個資料列會有要短。 如果您嘗試將以三個資料列大小，您會收到四個資料列，如果`bLarger`已**TRUE**以及兩個資料列如果`bLarger`已**FALSE**。  
  
 如果工具列有分隔符號，當給定的資料列數目是有效的規則是更複雜。 版面配置，除非群組無法容納一個資料列上數個資料列會永遠不會中斷 （按鈕以在第一個分隔符號） 和最後一個群組中按鈕的按鈕群組計算。  
  
 如果群組不符合上一個資料列下, 一個群組會啟動下一個資料列上，即使它可容納大型群組的結束位置的資料列。 此規則的目的是讓更值得注意的大型群組之間的分離。 產生的垂直分隔符號會視為資料列。  
  
 也請注意，`SetRows`成員函式一律會選擇導致工具列最小的配置。 建立包含的工具列`TBSTYLE_WRAPABLE`樣式，然後調整控制項的大小只會套用指定的控制項的寬度，上面所述的方法。  
  
 只能使用所建立的工具列呼叫此函式`TBSTYLE_WRAPABLE`樣式。  
  
##  <a name="setstate"></a>CToolBarCtrl::SetState  
 在工具列控制項中設定指定的按鈕的狀態。  
  
```  
BOOL SetState(
    int nID,  
    UINT nState);
```  
  
### <a name="parameters"></a>參數  
 `nID`  
 命令按鈕的識別碼。  
  
 `nState`  
 狀態旗標。 它可以是值中的按鈕狀態的列出值組合[CToolBarCtrl::AddButtons](#addbuttons)。  
  
### <a name="return-value"></a>傳回值  
 如果成功則不為零，否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式是特別有用，如果您想要設定一個以上的按鈕狀態。 若要只設定一個狀態，使用下列成員函式： [EnableButton](#enablebutton)， [CheckButton](#checkbutton)， [HideButton](#hidebutton)，[未定](#indeterminate)，或[PressButton](#pressbutton)。  
  
##  <a name="setstyle"></a>CToolBarCtrl::SetStyle  
 設定工具列控制項的樣式。  
  
```  
void SetStyle(DWORD dwStyle);
```  
  
### <a name="parameters"></a>參數  
 `dwStyle`  
 A`DWORD`包含的組合[toolbar 控制項樣式](http://msdn.microsoft.com/library/windows/desktop/bb760439)、 Windows SDK 中所述。  
  
##  <a name="settooltips"></a>CToolBarCtrl::SetToolTips  
 將工具提示控制項與工具列控制項產生關聯。  
  
```  
void SetToolTips(CToolTipCtrl* pTip);
```  
  
### <a name="parameters"></a>參數  
 *pTip*  
 指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件。  
  
##  <a name="setwindowtheme"></a>CToolBarCtrl::SetWindowTheme  
 設定的視覺化樣式`CToolBarCtrl`物件。  
  
```  
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```  
  
### <a name="parameters"></a>參數  
 `pszSubAppName`  
 包含的工具列的視覺樣式設定為 Unicode 字串指標。  
  
### <a name="return-value"></a>傳回值  
 不使用傳回的值。  
  
### <a name="remarks"></a>備註  
 此成員函式模擬的功能[TB_SETWINDOWTHEME](http://msdn.microsoft.com/library/windows/desktop/bb787465)訊息、 Windows SDK 中所述。  
  
## <a name="see-also"></a>請參閱  
 [MFC 範例 CMNCTRL1](../../visual-cpp-samples.md)   
 [MFC 範例 MFCIE](../../visual-cpp-samples.md)   
 [CWnd 類別](../../mfc/reference/cwnd-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [CToolBar 類別](../../mfc/reference/ctoolbar-class.md)
