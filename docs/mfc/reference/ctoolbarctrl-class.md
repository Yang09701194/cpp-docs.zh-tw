---
title: CToolBarCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: d2214af96f3eba7d1b1d3c8e52f0c82873b982d7
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/31/2018
ms.locfileid: "50462997"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 類別

提供 Windows 工具列通用控制項的功能。

## <a name="syntax"></a>語法

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl::CToolBarCtrl](#ctoolbarctrl)|建構 `CToolBarCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl::AddBitmap](#addbitmap)|按鈕的工具列控制項，您可以使用映像清單中新增一或多個點陣圖按鈕映像。|
|[CToolBarCtrl::AddButtons](#addbuttons)|將一個或多個按鈕加入至工具列控制項中。|
|[CToolBarCtrl::AddString](#addstring)|加入新的字串，傳遞做為資源識別碼，工具列的內部清單的字串。|
|[CToolBarCtrl::AddStrings](#addstrings)|加入新的字串或 null 分隔的字串，工具列的內部清單的字串之緩衝區的指標傳遞的字串。|
|[CToolBarCtrl::AutoSize](#autosize)|調整工具列控制項的大小。|
|[CToolBarCtrl::ChangeBitmap](#changebitmap)|變更按鈕，以在目前的工具列控制項中的點陣圖。|
|[CToolBarCtrl::CheckButton](#checkbutton)|檢查或清除指定的按鈕，在工具列控制項中。|
|[CToolBarCtrl::CommandToIndex](#commandtoindex)|擷取與指定的命令識別碼相關聯的按鈕之以零起始的索引。|
|[CToolBarCtrl::Create](#create)|建立工具列控制項，並將它附加至`CToolBarCtrl`物件。|
|[CToolBarCtrl::CreateEx](#createex)|使用指定的 Windows 延伸樣式中建立工具列控制項，並將它附加至`CToolBarCtrl`物件。|
|[CToolBarCtrl::Customize](#customize)|顯示 [自訂工具列] 對話方塊。|
|[CToolBarCtrl::DeleteButton](#deletebutton)|從工具列控制項中刪除按鈕。|
|[CToolBarCtrl::EnableButton](#enablebutton)|啟用或停用工具列控制項中指定的按鈕。|
|[CToolBarCtrl::GetAnchorHighlight](#getanchorhighlight)|擷取工具列設定錨點反白顯示。|
|[CToolBarCtrl::GetBitmap](#getbitmap)|擷取點陣圖相關聯的按鈕的工具列中的索引。|
|[CToolBarCtrl::GetBitmapFlags](#getbitmapflags)|取得與工具列的點陣圖相關聯的旗標。|
|[CToolBarCtrl::GetButton](#getbutton)|擷取指定的按鈕，在工具列控制項中的相關資訊。|
|[CToolBarCtrl::GetButtonCount](#getbuttoncount)|擷取目前在工具列控制項中的按鈕數目。|
|[CToolBarCtrl::GetButtonInfo](#getbuttoninfo)|擷取按鈕的工具列中的資訊。|
|[CToolBarCtrl::GetButtonSize](#getbuttonsize)|擷取目前的寬度和高度，單位為像素的工具列按鈕。|
|[CToolBarCtrl::GetColorScheme](#getcolorscheme)|擷取目前的工具列控制項的色彩配置。|
|[CToolBarCtrl::GetDisabledImageList](#getdisabledimagelist)|擷取映像清單工具列控制項用來顯示停用按鈕。|
|[CToolBarCtrl::GetDropTarget](#getdroptarget)|擷取[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)工具列控制項的介面。|
|[CToolBarCtrl::GetExtendedStyle](#getextendedstyle)|擷取工具列控制項的延伸的樣式。|
|[CToolBarCtrl::GetHotImageList](#gethotimagelist)|擷取映像清單工具列控制項用來顯示 「 熱 」 按鈕。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。|
|[CToolBarCtrl::GetHotItem](#gethotitem)|擷取作用中工具列項目的索引。|
|[CToolBarCtrl::GetImageList](#getimagelist)|擷取映像清單工具列控制項用來在其預設狀態中顯示按鈕。|
|[CToolBarCtrl::GetInsertMark](#getinsertmark)|擷取目前的插入標記的工具列。|
|[CToolBarCtrl::GetInsertMarkColor](#getinsertmarkcolor)|擷取用來繪製的工具列插入標記的色彩。|
|[CToolBarCtrl::GetItemRect](#getitemrect)|擷取工具列控制項中的按鈕的週框矩形。|
|[CToolBarCtrl::GetMaxSize](#getmaxsize)|擷取所有可見的按鈕和工具列中的分隔符號的大小總計。|
|[CToolBarCtrl::GetMaxTextRows](#getmaxtextrows)|擷取工具列按鈕上顯示的文字資料列的數目上限。|
|[CToolBarCtrl::GetMetrics](#getmetrics)|擷取工具列控制項的計量。|
|[CToolBarCtrl::GetPadding](#getpadding)|擷取目前的工具列控制項的水平和垂直邊框距離。|
|[CToolBarCtrl::GetPressedImageList](#getpressedimagelist)|擷取映像清單目前的工具列控制項用來表示處於已按下狀態的按鈕。|
|[CToolBarCtrl::GetRect](#getrect)|擷取指定的工具列按鈕的週框矩形。|
|[CToolBarCtrl::GetRows](#getrows)|擷取目前顯示在工具列上的按鈕的資料列數目。|
|[CToolBarCtrl::GetState](#getstate)|擷取指定的按鈕，在工具列控制項中，例如它、 按下，是否啟用檢查的狀態相關資訊。|
|[CToolBarCtrl::GetString](#getstring)|擷取工具列字串。|
|[CToolBarCtrl::GetStyle](#getstyle)|擷取目前正在使用工具列控制項的樣式。|
|[CToolBarCtrl::GetToolTips](#gettooltips)|如果任何項目，與工具列控制項產生關聯，請擷取工具提示控制項的控制代碼。|
|[CToolBarCtrl::HideButton](#hidebutton)|隱藏或顯示指定的按鈕在工具列控制項中。|
|[CToolBarCtrl::HitTest](#hittest)|判斷點落在工具列控制項中的位置。|
|[CToolBarCtrl::Indeterminate](#indeterminate)|設定或清除不定 （灰色） 狀態的工具列控制項中指定的按鈕。|
|[CToolBarCtrl::InsertButton](#insertbutton)|在工具列控制項中插入按鈕。|
|[CToolBarCtrl::InsertMarkHitTest](#insertmarkhittest)|擷取點，以在工具列中的插入標記資訊。|
|[CToolBarCtrl::IsButtonChecked](#isbuttonchecked)|會指示是否要檢查在工具列控制項中指定的按鈕。|
|[CToolBarCtrl::IsButtonEnabled](#isbuttonenabled)|會告知是否已啟用工具列控制項中指定的按鈕。|
|[CToolBarCtrl::IsButtonHidden](#isbuttonhidden)|會指示是否要隱藏工具列控制項中指定的按鈕。|
|[CToolBarCtrl::IsButtonHighlighted](#isbuttonhighlighted)|檢查反白顯示狀態的工具列按鈕。|
|[CToolBarCtrl::IsButtonIndeterminate](#isbuttonindeterminate)|會告知工具列控制項中指定的按鈕的狀態是否不定 （灰色）。|
|[CToolBarCtrl::IsButtonPressed](#isbuttonpressed)|會告知是否按下工具列控制項中指定的按鈕。|
|[CToolBarCtrl::LoadImages](#loadimages)|將點陣圖載入到工具列控制項的影像清單中。|
|[CToolBarCtrl::MapAccelerator](#mapaccelerator)|在工具列按鈕對應的加速器字元。|
|[CToolBarCtrl::MarkButton](#markbutton)|設定反白顯示狀態指定按鈕的工具列控制項中。|
|[CToolBarCtrl::MoveButton](#movebutton)|將按鈕從一個索引移動到另一個。|
|[CToolBarCtrl::PressButton](#pressbutton)|按下或釋放工具列控制項中指定的按鈕。|
|[CToolBarCtrl::ReplaceBitmap](#replacebitmap)|新的點陣圖，取代目前的工具列控制項中現有的點陣圖。|
|[CToolBarCtrl::RestoreState](#restorestate)|還原工具列控制項的狀態。|
|[CToolBarCtrl::SaveState](#savestate)|儲存的工具列控制項的狀態。|
|[CToolBarCtrl::SetAnchorHighlight](#setanchorhighlight)|設定錨點反白顯示的工具列設定。|
|[CToolBarCtrl::SetBitmapSize](#setbitmapsize)|設定要加入至工具列控制項的點陣圖影像的大小。|
|[CToolBarCtrl::SetButtonInfo](#setbuttoninfo)|在工具列中，設定現有按鈕的資訊。|
|[CToolBarCtrl::SetButtonSize](#setbuttonsize)|設定要加入至工具列控制項按鈕的大小。|
|[CToolBarCtrl::SetButtonStructSize](#setbuttonstructsize)|指定的大小`TBBUTTON`結構。|
|[CToolBarCtrl::SetButtonWidth](#setbuttonwidth)|設定工具列控制項中的最小和最大按鈕寬度。|
|[CToolBarCtrl::SetCmdID](#setcmdid)|設定指定的按鈕按下時要傳送給主控視窗的命令識別碼。|
|[CToolBarCtrl::SetColorScheme](#setcolorscheme)|設定目前的工具列控制項的色彩配置。|
|[CToolBarCtrl::SetDisabledImageList](#setdisabledimagelist)|設定來顯示停用按鈕的工具列控制項會使用影像清單。|
|[CToolBarCtrl::SetDrawTextFlags](#setdrawtextflags)|Win32 函式中設定的旗標[DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext)，用來繪製在指定的矩形中，根據旗標的設定方式進行格式化的文字。|
|[CToolBarCtrl::SetExtendedStyle](#setextendedstyle)|設定工具列控制項的延伸的樣式。|
|[CToolBarCtrl::SetHotImageList](#sethotimagelist)|設定影像清單，工具列控制項會將用來顯示 「 熱 」 按鈕。|
|[CToolBarCtrl::SetHotItem](#sethotitem)|在工具列中，設定作用的項目。|
|[CToolBarCtrl::SetImageList](#setimagelist)|設定影像清單工具列將用來顯示其預設狀態中的按鈕。|
|[CToolBarCtrl::SetIndent](#setindent)|在工具列控制項中設定的第一個按鈕的縮排。|
|[CToolBarCtrl::SetInsertMark](#setinsertmark)|設定目前的插入標記的工具列。|
|[CToolBarCtrl::SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製的工具列插入標記的色彩。|
|[CToolBarCtrl::SetMaxTextRows](#setmaxtextrows)|設定顯示於工具列按鈕上的文字資料列數目上限。|
|[CToolBarCtrl::SetMetrics](#setmetrics)|設定工具列控制項的計量。|
|[CToolBarCtrl::SetOwner](#setowner)|設定從工具列控制項接收通知訊息的視窗。|
|[CToolBarCtrl::SetPadding](#setpadding)|設定目前的工具列控制項的水平和垂直邊框距離。|
|[CToolBarCtrl::SetPressedImageList](#setpressedimagelist)|設定映像清單，其中目前的工具列控制項用來表示處於已按下狀態的按鈕。|
|[CToolBarCtrl::SetRows](#setrows)|設定顯示在工具列上的按鈕的資料列數目。|
|[CToolBarCtrl::SetState](#setstate)|在工具列控制項中設定指定的按鈕的狀態。|
|[CToolBarCtrl::SetStyle](#setstyle)|設定工具列控制項的樣式。|
|[CToolBarCtrl::SetToolTips](#settooltips)|將工具提示控制項與工具列控制項產生關聯。|
|[CToolBarCtrl::SetWindowTheme](#setwindowtheme)|設定工具列控制項的視覺化樣式。|

## <a name="remarks"></a>備註

這個控制項 (並因此`CToolBarCtrl`類別) 僅適用於 Windows 95/98 和 Windows NT 版 3.51 下執行的程式和更新版本。

Windows 工具列通用控制項是包含一或多個按鈕的矩形的子視窗。 這些按鈕可以顯示點陣圖影像、 字串或兩者。 當使用者選擇按鈕時，它會傳送給工具列的主控視窗的命令訊息。 通常，會在工具列中的按鈕對應至應用程式的功能表中的項目它們提供更直接的方式，讓使用者存取應用程式的命令。

`CToolBarCtrl` 物件包含數個重要的內部資料結構： 一份按鈕的影像點陣圖或影像清單、 一份按鈕標籤字串，以及一份`TBBUTTON`結構建立關聯的映像及/或字串的位置，樣式，其狀態，及命令 ID按鈕。 每個這些資料結構的項目被指以零為起始的索引。 您可以使用之前`CToolBarCtrl`物件時，您必須設定這些資料結構。 字串清單，僅適用於按鈕標籤;您無法從工具列，來擷取字串。

若要使用 `CToolBarCtrl` 物件，您通常會執行下列步驟：

1. 建構 `CToolBarCtrl` 物件。

1. 呼叫[Create](#create)建立 Windows 工具列通用控制項，並將其附加至`CToolBarCtrl`物件。 藉由使用樣式，例如透明工具列 TBSTYLE_TRANSPARENT 或 TBSTYLE_DROPDOWN 支援樣式下拉式按鈕的工具列，表示工具列的樣式。

1. 找出您要如何顯示的工具列上的按鈕：

   - 若要使用點陣圖影像的按鈕，將按鈕點陣圖加入工具列藉由呼叫[AddBitmap](#addbitmap)。

   - 若要使用從影像清單的按鈕顯示的影像，指定影像清單，藉由呼叫[SetImageList](#setimagelist)， [SetHotImageList](#sethotimagelist)，或[SetDisabledImageList](#setdisabledimagelist)。

   - 若要使用字串標籤的按鈕，將字串加入至工具列藉由呼叫[AddString](#addstring)及/或[AddStrings](#addstrings)。

1. 新增至工具列按鈕結構，藉由呼叫[AddButtons](#addbuttons)。

1. 如果您想要在不是主控視窗的工具列按鈕的工具提示`CFrameWnd`，您需要處理的 TTN_NEEDTEXT 訊息在工具列的 [擁有者] 視窗中所述[處理工具提示通知](../../mfc/handling-tool-tip-notifications.md)。 如果父視窗的工具列衍生自`CFrameWnd`，而不需要任何額外的工作，您會顯示工具提示，因為`CFrameWnd`提供的預設處理常式。

1. 如果您想讓使用者能夠自訂工具列時，處理是主控視窗中的自訂通知訊息中所述[處理自訂告知](../../mfc/handling-customization-notifications.md)。

您可以使用[SaveState](#savestate)以儲存在登錄中的工具列控制項的目前狀態並[RestoreState](#restorestate)以還原先前儲存在登錄中的資訊為基礎的狀態。 除了儲存工具列狀態之間的應用程式的使用，應用程式通常將狀態儲存之前使用者開始自訂工具列，如果使用者稍後想要還原成原始狀態的工具列。

## <a name="support-for-internet-explorer-version-40-and-later"></a>Internet Explorer 版本 4.0 和更新版本的支援

若要支援 Internet Explorer 4.0 或更新版本，版本中引進的功能 MFC 提供映像清單支援和透明且一般樣式工具列控制項。

透明工具列可讓透過顯示在工具列底下的用戶端。 若要建立透明的工具列，請使用 TBSTYLE_FLAT 和 TBSTYLE_TRANSPARENT 樣式。 透明工具列功能熱追蹤;也就是當滑鼠指標移工具列上的作用中的按鈕，按鈕的外觀會變更。 建立具有 TBSTYLE_FLAT 樣式的工具列會包含不透明的按鈕。

映像清單支援可讓控制項更大彈性的預設行為，作用中影像，並已停用的映像。 使用[GetImageList](#getimagelist)， [GetHotImageList](#gethotimagelist)，並[GetDisabledImageList](#getdisabledimagelist)與透明的工具列，來操作的映像，根據其狀態：

如需有關使用`CToolBarCtrl`，請參閱 <<c2> [ 控制項](../../mfc/controls-mfc.md)並[使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

##  <a name="addbitmap"></a>  CToolBarCtrl::AddBitmap

儲存在工具列控制項的按鈕映像清單中新增一或多個按鈕映像。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>參數

*nNumButtons*<br/>
點陣圖中的按鈕影像的數目。

*nBitmapID*<br/>
包含按鈕的映像或映像以新增之點陣圖的資源識別碼。

*pBitmap*<br/>
指標`CBitmap`包含按鈕的映像或映像以新增的物件。

### <a name="return-value"></a>傳回值

如果成功，第一個新影像的以零起始的索引否則為-1。

### <a name="remarks"></a>備註

您可以使用 Windows API [CreateMappedBitmap](/windows/desktop/api/commctrl/nf-commctrl-createmappedbitmap)對應之前加入工具列的點陣圖的色彩。 如果您傳遞的指標`CBitMap`物件時，您必須確定該點陣圖並不會終結之前之後工具列會終結。

##  <a name="addbuttons"></a>  CToolBarCtrl::AddButtons

將一個或多個按鈕加入至工具列控制項中。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>參數

*nNumButtons*<br/>
若要新增的按鈕數目。

*lpButtons*<br/>
陣列的位址`TBBUTTON`結構，其中包含要加入按鈕的相關資訊。 必須有相同數目的陣列中的項目為所指定的按鈕*nNumButtons*。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

*LpButtons*指標會指向陣列`TBBUTTON`結構。 每個`TBBUTTON`結構將加入與按鈕的樣式、 映像及/或字串、 命令識別碼的狀態，以及使用者定義資料的按鈕：

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

的成員如下所示：

- `iBitmap`

   按鈕影像，-1，如果沒有此按鈕的影像之以零起始索引。

- `idCommand`

   命令與按鈕關聯的識別項。 此識別碼會傳送 WM_COMMAND 訊息中，則選擇該按鈕時。 如果`fsStyle`成員具有 TBSTYLE_SEP 值，這個成員必須是零。

- `fsState`

   按鈕狀態旗標。 它可以是下列值的組合：

   - TBSTATE_CHECKED 按鈕 TBSTYLE_CHECKED 樣式，並按下。

   - TBSTATE_ENABLED 按鈕接受使用者輸入。 沒有此狀態的按鈕不接受使用者輸入，並會變為灰色。

   - TBSTATE_HIDDEN 按鈕看不到，且無法接收使用者輸入。

   - TBSTATE_INDETERMINATE 按鈕會變為灰色。

   - TBSTATE_PRESSED 按鈕已按下。

   - TBSTATE_WRAP 的分行符號會遵循 按鈕。 按鈕也必須擁有 TBSTATE_ENABLED 狀態。

- `fsStyle`

   按鈕樣式。 它可以是下列值的組合：

   - TBSTYLE_BUTTON 建立標準按鈕。

   - TBSTYLE_CHECK 建立按鈕來切換使用已按下和未按下狀態每次使用者按下它。 處於已按下狀態時，按鈕會有不同的背景色彩。

   - TBSTYLE_CHECKGROUP 建立直到按下群組中的另一個按鈕，按下保持核取按鈕。

   - TBSTYLE_GROUP 建立直到群組中的另一個按鈕按下按鈕處於已按下。

   - TBSTYLE_SEP 建立分隔符號，提供按鈕群組之間有小型的間隙。 具有此樣式的按鈕不會接收使用者輸入。

- `dwData`

   使用者定義的資料。

- `iString`

   要做為按鈕的標籤，-1，如果沒有此按鈕字串的字串以零為起始的索引。

使用的映像及/或您提供的索引必須有先前已加入至工具列控制項的字串清單[AddBitmap](#addbitmap)， [AddString](#addstring)，和/或[AddStrings](#addstrings)。

##  <a name="addstring"></a>  CToolBarCtrl::AddString

加入新的字串，傳遞做為資源識別碼，工具列的內部清單的字串。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>參數

*nStringID*<br/>
若要將工具列控制項的字串清單的字串資源的資源識別碼。

### <a name="return-value"></a>傳回值

如果成功，新增的第一個新字串以零起始的索引否則為-1。

##  <a name="addstrings"></a>  CToolBarCtrl::AddStrings

將新的字串加入至供工具列控制項的字串清單中。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>參數

*lpszStrings*<br/>
包含要加入至工具列的字串清單的一或多個 null 結尾字串的緩衝區位址。 最後一個字串必須以兩個 null 字元結束。

### <a name="return-value"></a>傳回值

如果成功，新增的第一個新字串以零起始的索引否則為-1。

### <a name="remarks"></a>備註

緩衝區中的字串必須以 null 字元分隔。 您必須確定的最後一個字串，有兩個 null 結束字元。 若要正確格式化的常數字串，您可能會撰寫為：

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

或：

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

您不應該傳遞`CString`物件，此函式，因為它不可以有一個以上的 null 字元`CString`。

##  <a name="autosize"></a>  CToolBarCtrl::AutoSize

調整整個工具列控制項的大小。

```
void AutoSize();
```

### <a name="remarks"></a>備註

當父視窗的大小變更時，或在工具列的大小變更 （例如，當您設定的按鈕或點陣圖的大小，或加入的字串） 時，您應該呼叫此函式。

##  <a name="changebitmap"></a>  CToolBarCtrl::ChangeBitmap

變更按鈕，以在目前的工具列控制項中的點陣圖。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*idButton*|[in]要接收新的點陣圖按鈕命令識別項。|
|*iBitmap*|[in]目前的工具列控制項的影像清單中的映像的以零為起始的索引。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

如果這個方法成功，則系統會顯示指定的映像中指定的按鈕。

這個方法會傳送[TB_CHANGEBITMAP](/windows/desktop/Controls/tb-changebitmap)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會變更的點陣圖**檔案儲存**的點陣圖按鈕**有關** 按鈕。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

##  <a name="checkbutton"></a>  CToolBarCtrl::CheckButton

檢查或清除指定的按鈕，在工具列控制項中。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
若要檢查或清除按鈕命令識別項。

*bCheck*<br/>
若為 true，則核取按鈕，為 FALSE，則將其清除。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

當按鈕已核取時，它會顯示已按下。 如果您想要變更多個按鈕的狀態，請考慮呼叫[SetState](#setstate)改。

##  <a name="commandtoindex"></a>  CToolBarCtrl::CommandToIndex

擷取與指定的命令識別碼相關聯的按鈕之以零起始的索引。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
命令 ID 的按鈕索引，您會想要尋找。

### <a name="return-value"></a>傳回值

命令識別碼相關聯的按鈕以零為起始的索引

### <a name="remarks"></a>備註

##  <a name="create"></a>  CToolBarCtrl::Create

建立工具列控制項，並將它附加至`CToolBarCtrl`物件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*cheaderctrl:: Create*<br/>
指定工具列控制項的樣式。 工具列一定要有 WS_CHILD 樣式。 此外，指定 toolbar 樣式和視窗樣式的任意組合，如底下所述**備註**。

*rect*<br/>
選擇性地指定工具列控制項的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構。

*pParentWnd*<br/>
指定工具列控制項的父視窗。 它必須不是 NULL。

*nID*<br/>
指定工具列控制項的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

您建構`CToolBarCtrl`兩個步驟。 首先，呼叫建構函式，並接著呼叫`Create`，這會建立工具列控制項，並將它附加至`CToolBarCtrl`物件。 在工具列控制項中套用下列的視窗樣式。

- WS_CHILD 一律

- WS_VISIBLE 通常

- WS_DISABLED 很少

請參閱[CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa) Windows sdk for 視窗樣式的描述。

（選擇性） 適用於多種[常見的控制項樣式](/windows/desktop/Controls/common-control-styles)、 Windows SDK 中所述。

套用至控制項或按鈕本身的 toolbar 樣式的組合。 主題中說明的樣式[工具列控制項和按鈕樣式](/windows/desktop/Controls/toolbar-control-and-button-styles)Windows SDK 中。

若要使用擴充的工具列的樣式，呼叫[SetExtendedStyle](#setextendedstyle)在您呼叫後`Create`。 若要建立具有延伸的視窗樣式的工具列，呼叫[CToolBarCtrl::CreateEx](#createex)而不是`Create`。

工具列控制項自動設定的大小和位置的 [工具列] 視窗。 高度為基礎的工具列中按鈕的高度。 寬度是父視窗的用戶端區域的寬度相同。 CCS_TOP 和 CCS_BOTTOM 樣式會判斷工具列是否位於沿著頂端或底部的 工作區。 根據預設，工具列會有 CCS_TOP 樣式。

##  <a name="createex"></a>  CToolBarCtrl::CreateEx

建立控制項 （子視窗），並將它與關聯`CToolBarCtrl`物件。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定正在建立之控制項的延伸的樣式。 如需延伸的 Windows 樣式的清單，請參閱 < *dwExStyle*參數[CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) Windows SDK 中。

*cheaderctrl:: Create*<br/>
指定工具列控制項的樣式。 工具列一定要有 WS_CHILD 樣式。 此外，您可以指定 toolbar 樣式和視窗樣式的任何組合中所述**備註**一節[建立](#create)。

*rect*<br/>
參考[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構描述的大小和位置，在中建立工作區座標中的視窗*pParentWnd*。

*pParentWnd*<br/>
是控制項的父視窗的指標。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而非[建立](#create)套用延伸的 Windows 樣式，由 Windows 延伸的樣式前置詞**WS_EX_**。 `CreateEx` 建立具有所指定的擴充 Windows 樣式的控制項*dwExStyle*。 設定擴充特定控制項使用的樣式[SetExtendedStyle](#setextendedstyle)。 例如，使用`CreateEx`將這類樣式設定為 WS_EX_CONTEXTHELP，但使用`SetExtendedStyle`將這類樣式設定為 TBSTYLE_EX_DRAWDDARROWS。 如需詳細資訊，請參閱中所述的樣式[Toolbar 擴充樣式](/windows/desktop/Controls/toolbar-extended-styles)Windows SDK 中。

##  <a name="ctoolbarctrl"></a>  CToolBarCtrl::CToolBarCtrl

建構 `CToolBarCtrl` 物件。

```
CToolBarCtrl();
```

### <a name="remarks"></a>備註

您必須呼叫[建立](#create)以便讓工具列發揮效用。

##  <a name="customize"></a>  CToolBarCtrl::Customize

顯示 [自訂工具列] 對話方塊。

```
void Customize();
```

### <a name="remarks"></a>備註

此對話方塊可讓使用者自訂工具列加入和刪除按鈕。 若要支援自訂，工具列的父視窗必須處理自訂通知訊息中所述[處理自訂告知](../../mfc/handling-customization-notifications.md)。 您的工具列必須也已建立 CCS_ADJUSTABLE 樣式中所述[CToolBarCtrl::Create](#create)。

##  <a name="deletebutton"></a>  CToolBarCtrl::DeleteButton

從工具列控制項中刪除按鈕。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
[刪除] 按鈕之以零起始索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

##  <a name="enablebutton"></a>  CToolBarCtrl::EnableButton

啟用或停用工具列控制項中指定的按鈕。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
若要啟用或停用按鈕命令識別項。

*bEnable*<br/>
TRUE 表示啟用按鈕，如果為 false，則停用按鈕。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

已啟用 按鈕，它可以按下並檢查。 如果您想要變更多個按鈕的狀態，請考慮呼叫[SetState](#setstate)改。

##  <a name="getanchorhighlight"></a>  CToolBarCtrl::GetAnchorHighlight

擷取工具列設定錨點反白顯示。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>傳回值

如果是非零值，錨點反白顯示已啟用。 如果是零，錨點反白顯示已停用。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-getanchorhighlight)、 Windows SDK 中所述。

##  <a name="getbitmap"></a>  CToolBarCtrl::GetBitmap

擷取點陣圖相關聯的按鈕的工具列中的索引。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
點陣圖索引是要擷取的按鈕命令識別項。

### <a name="return-value"></a>傳回值

傳回點陣圖，如果成功或零，否則為的索引。

### <a name="remarks"></a>備註

實作的功能[TB_GETBITMAP](/windows/desktop/Controls/tb-getbitmap) Windows SDK 中。

##  <a name="getbitmapflags"></a>  CToolBarCtrl::GetBitmapFlags

擷取工具列點陣圖旗標。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>傳回值

已設定如果顯示可支援大型的工具列點陣圖 TBBF_LARGE 旗標 UINT 否則清除。

### <a name="remarks"></a>備註

建立工具列之後，但是加入工具列的點陣圖之前，您應該呼叫它。 傳回的值會指出是否顯示是否支援大型點陣圖。 如果顯示支援大型點陣圖，而且如果您選擇使用它們，請呼叫[SetBitmapSize](#setbitmapsize)並[SetButtonSize](#setbuttonsize)加入 大型點陣圖使用之前[AddBitmap](#addbitmap)。

##  <a name="getbutton"></a>  CToolBarCtrl::GetButton

擷取指定的按鈕，在工具列控制項中的相關資訊。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要擷取資訊的按鈕之以零起始索引。

*lpButton*<br/>
解決的`TBBUTTON`會收到一份按鈕資訊的結構。 請參閱[CToolBarCtrl::AddButtons](#addbuttons)如需`TBBUTTON`結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

##  <a name="getbuttoncount"></a>  CToolBarCtrl::GetButtonCount

擷取目前在工具列控制項中的按鈕數目。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>傳回值

按鈕的計數。

##  <a name="getbuttoninfo"></a>  CToolBarCtrl::GetButtonInfo

擷取按鈕的工具列中的資訊。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的識別項。

*ptbbi*<br/>
指標[TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa)接收按鈕資訊的結構。

### <a name="return-value"></a>傳回值

[] 按鈕，如果成功則為起始的索引否則為-1。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETBUTTONINFO](/windows/desktop/Controls/tb-getbuttoninfo)、 Windows SDK 中所述。

##  <a name="getbuttonsize"></a>  CToolBarCtrl::GetButtonSize

取得工具列按鈕的大小。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

寬度和高度與中的值取代 LOWORD HIWORD，會分別包含 DWORD 值。

##  <a name="getbuttontext"></a>  CToolBarCtrl::GetButtonText

擷取目前的工具列控制項上的指定按鈕的顯示文字。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*idButton*|[in]擷取其顯示文字的按鈕的識別項。|

### <a name="return-value"></a>傳回值

A [CString](../../atl-mfc-shared/using-cstring.md) ，其中包含指定的按鈕的顯示文字。

### <a name="remarks"></a>備註

這個方法會傳送[TB_GETBUTTONTEXT](/windows/desktop/Controls/tb-getbuttontext)訊息，Windows SDK 中所述。

##  <a name="getcolorscheme"></a>  CToolBarCtrl::GetColorScheme

擷取目前的工具列控制項的色彩配置。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*lpColorScheme*|[out]指標[新增的色彩配置](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme)接收色彩配置資訊的結構。 當這個方法傳回時，結構描述的反白顯示色彩和陰影色彩的工具列控制項。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TB_GETCOLORSCHEME](/windows/desktop/Controls/tb-getcolorscheme)訊息，Windows SDK 中所述。

##  <a name="getdisabledimagelist"></a>  CToolBarCtrl::GetDisabledImageList

擷取映像清單工具列控制項用來顯示停用按鈕。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或如果沒有已停用的映像清單設定為 NULL。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-getdisabledimagelist)、 Windows SDK 中所述。 MFC 實作`GetDisabledImageList`使用`CImageList`物件，其中包含工具列控制項的按鈕映像，而不是影像清單的控制代碼。

##  <a name="getdroptarget"></a>  CToolBarCtrl::GetDropTarget

擷取[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)工具列控制項的介面。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>參數

*ppDropTarget*<br/>
指標[IDropTarget](/windows/desktop/api/oleidl/nn-oleidl-idroptarget)介面指標。 發生錯誤時，則為 NULL 指標被放置在這個位址。

### <a name="return-value"></a>傳回值

傳回 HRESULT 值，指出成功或失敗的作業。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETOBJECT](/windows/desktop/Controls/tb-getobject)、 Windows SDK 中所述。

##  <a name="getextendedstyle"></a>  CToolBarCtrl::GetExtendedStyle

擷取工具列控制項的延伸的樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

表示目前使用工具列控制項中的擴充的樣式 DWORD。 如需樣式的清單，請參閱 < [Toolbar 擴充樣式](/windows/desktop/Controls/toolbar-extended-styles)，Windows SDK 中。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETEXTENDEDSTYLE](/windows/desktop/Controls/tb-getextendedstyle)、 Windows SDK 中所述。

##  <a name="gethotimagelist"></a>  CToolBarCtrl::GetHotImageList

擷取映像清單工具列控制項用來顯示 「 熱 」 按鈕。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或如果沒有已停用的映像清單設定為 NULL。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETHOTIMAGELIST](/windows/desktop/Controls/tb-gethotimagelist)、 Windows SDK 中所述。 當滑鼠指標位於其上方時，作用中的按鈕會反白顯示。

##  <a name="gethotitem"></a>  CToolBarCtrl::GetHotItem

擷取作用中工具列項目的索引。

```
int GetHotItem() const;
```

### <a name="return-value"></a>傳回值

在工具列中作用的項目以零為起始的索引。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETHOTITEM](/windows/desktop/Controls/tb-gethotitem)、 Windows SDK 中所述。

##  <a name="getimagelist"></a>  CToolBarCtrl::GetImageList

擷取映像清單工具列控制項用來在其預設狀態中顯示按鈕。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)物件，或如果沒有映像清單設定為 NULL。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETIMAGELIST](/windows/desktop/Controls/tb-getimagelist)、 Windows SDK 中所述。

##  <a name="getinsertmark"></a>  CToolBarCtrl::GetInsertMark

擷取目前的插入標記的工具列。

```
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>參數

*ptbim*<br/>
指標[TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark)接收插入標記的結構。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETINSERTMARK](/windows/desktop/Controls/tb-getinsertmark)、 Windows SDK 中所述。

##  <a name="getinsertmarkcolor"></a>  CToolBarCtrl::GetInsertMarkColor

擷取用來繪製的工具列插入標記的色彩。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

COLORREF 值，包含目前的插入標記色彩。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETINSERTMARKCOLOR](/windows/desktop/Controls/tb-getinsertmarkcolor)、 Windows SDK 中所述。

##  <a name="getitemrect"></a>  CToolBarCtrl::GetItemRect

擷取工具列控制項中的按鈕的週框矩形。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要擷取資訊的按鈕之以零起始索引。

*lpRect*<br/>
位址[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件接收指定的週框的座標。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此函式不會擷取其狀態會設為 TBSTATE_HIDDEN 按鈕的周框矩形。

##  <a name="getmaxsize"></a>  CToolBarCtrl::GetMaxSize

擷取所有可見的按鈕和工具列中的分隔符號的大小總計。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>參數

*pSize*<br/>
指標[大小](https://msdn.microsoft.com/library/windows/desktop/dd145106)結構會接收項目的大小。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETMAXSIZE](/windows/desktop/Controls/tb-getmaxsize)、 Windows SDK 中所述。

##  <a name="getmaxtextrows"></a>  CToolBarCtrl::GetMaxTextRows

擷取工具列按鈕上顯示的文字資料列的數目上限。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕上顯示的文字資料列的數目上限。

##  <a name="getmetrics"></a>  CToolBarCtrl::GetMetrics

擷取的計量`CToolBarCtrl`物件。

```
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>參數

*ptbm*<br/>
指標[TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics)結構`CToolBarCtrl`物件。

### <a name="remarks"></a>備註

此成員函式會模擬[TB_GETMETRICS](/windows/desktop/Controls/tb-getmetrics)訊息、 Windows SDK 中所述。

##  <a name="getpadding"></a>  CToolBarCtrl::GetPadding

擷取目前的工具列控制項的水平和垂直邊框距離。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pnHorzPadding*|[out]整數，接收工具列控制項的水平的填補像素為單位。|
|*pnVertPadding*|[out]整數，接收的工具列控制項中，垂直的填補像素為單位。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TB_GETPADDING](/windows/desktop/Controls/tb-getpadding)訊息，Windows SDK 中所述。

##  <a name="getpressedimagelist"></a>  CToolBarCtrl::GetPressedImageList

擷取映像清單目前的工具列控制項用來表示處於已按下狀態的按鈕。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md) ，包含目前的控制項，則為 NULL 的映像清單，如果沒有這類映像清單設定。

### <a name="remarks"></a>備註

這個方法會傳送[TB_GETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-getpressedimagelist)訊息，Windows SDK 中所述。

##  <a name="getrect"></a>  CToolBarCtrl::GetRect

擷取指定的工具列按鈕的週框矩形。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的識別項。

*lpRect*<br/>
指標[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)接收的週框矩形資訊的結構。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETRECT](/windows/desktop/Controls/tb-getrect)、 Windows SDK 中所述。

##  <a name="getrows"></a>  CToolBarCtrl::GetRows

擷取目前工具列控制項所顯示的按鈕的資料列數目。

```
int GetRows() const;
```

### <a name="return-value"></a>傳回值

目前顯示在工具列上的按鈕的資料列數目。

### <a name="remarks"></a>備註

請注意，資料列數目將永遠是一個除非 TBSTYLE_WRAPABLE 樣式建立的工具列。

##  <a name="getstate"></a>  CToolBarCtrl::GetState

擷取指定的按鈕，在工具列控制項中，例如它、 按下，是否啟用檢查的狀態相關資訊。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要擷取資訊的按鈕命令識別項。

### <a name="return-value"></a>傳回值

如果成功時，按鈕狀態資訊或者-1，否則為。 按鈕的狀態資訊可以在所列的值的組合[CToolBarCtrl::AddButtons](#addbuttons)。

### <a name="remarks"></a>備註

此函式是特別有用，如果您想要擷取一個以上的按鈕狀態。 若要只擷取一種狀態，請使用下列成員函式的其中一個： [IsButtonEnabled](#isbuttonenabled)， [IsButtonChecked](#isbuttonchecked)， [IsButtonPressed](#isbuttonpressed)， [IsButtonHidden](#isbuttonhidden)，或[IsButtonIndeterminate](#isbuttonindeterminate)。 不過，`GetState`成員函式是唯一的方法，可偵測 TBSTATE_WRAP 按鈕狀態。

##  <a name="getstring"></a>  CToolBarCtrl::GetString

擷取工具列字串。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>參數

*字串*<br/>
字串的索引。

*lpstrString*<br/>
用來傳回字串之緩衝區的指標。

*cchMaxLen*<br/>
以位元組為單位的緩衝區長度。

*str*<br/>
字串。

### <a name="return-value"></a>傳回值

如果成功，字串的長度為-1，如果不是。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_GETSTRING](/windows/desktop/Controls/tb-getstring)、 Windows SDK 中所述。

##  <a name="getstyle"></a>  CToolBarCtrl::GetStyle

取得目前套用至工具列控制項的樣式。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>傳回值

DWORD，其中包含組成[toolbar 控制項樣式](/windows/desktop/Controls/toolbar-control-and-button-styles)、 Windows SDK 中所述。

##  <a name="gettooltips"></a>  CToolBarCtrl::GetToolTips

如果任何項目，與工具列控制項產生關聯，請擷取工具提示控制項的控制代碼。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)工具列是否沒有相關聯的工具提示控制項，此工具列或 NULL 相關聯的物件。

### <a name="remarks"></a>備註

工具列控制項通常會建立並維護它自己的工具提示控制項，因為大部分的程式不需要呼叫此函式。

##  <a name="hittest"></a>  CToolBarCtrl::HitTest

判斷點落在工具列控制項中的位置。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>參數

*ppt*<br/>
指標[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)結構，包含點擊測試中的 x 座標`x`成員和 y 座標的點擊測試中`y`成員。 座標是相對於工具列的工作區。

### <a name="return-value"></a>傳回值

整數值，表示工具列上的某個點的位置。 如果值為零或正值，此傳回值會是點在於 nonseparator 項目的以零為起始的索引。

如果傳回的值為負數，點不在其內的按鈕。 傳回值的絕對值是分隔符號項目或接近 nonseparator 項目索引。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_HITTEST](/windows/desktop/Controls/tb-hittest)、 Windows SDK 中所述。

##  <a name="hidebutton"></a>  CToolBarCtrl::HideButton

隱藏或顯示指定的按鈕在工具列控制項中。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
隱藏或顯示的按鈕命令識別項。

*bHide*<br/>
True 會隱藏按鈕，以使它顯示為 FALSE。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果您想要變更多個按鈕的狀態，請考慮呼叫[SetState](#setstate)改。

##  <a name="indeterminate"></a>  CToolBarCtrl::Indeterminate

設定或清除不定狀態的工具列控制項中指定的按鈕。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
不確定狀態是要設定或清除的按鈕命令識別項。

*bIndeterminate*<br/>
如果為 true，則設定指定的按鈕，為 FALSE，則將其清除不定狀態。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

不確定顯示按鈕呈現灰色，例如文書處理器的方式在工具列上的 [粗體] 按鈕看起來時選取的文字包含粗體與一般的字元。 如果您想要變更多個按鈕的狀態，請考慮呼叫[SetState](#setstate)改。

##  <a name="insertbutton"></a>  CToolBarCtrl::InsertButton

在工具列控制項中插入按鈕。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
按鈕之以零為起始的索引。 此函式會插入至這個按鈕左邊的 [新增] 按鈕。

*lpButton*<br/>
位址`TBBUTTON`結構，其中包含要插入按鈕的相關資訊。 請參閱[CToolBarCtrl::AddButtons](#addbuttons)的說明`TBBUTTON`結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

使用的映像及/或您提供的索引必須有先前已加入至工具列控制項的字串清單[AddBitmap](#addbitmap)， [AddString](#addstring)，和/或[AddStrings](#addstrings)。

##  <a name="insertmarkhittest"></a>  CToolBarCtrl::InsertMarkHitTest

擷取點，以在工具列中的插入標記資訊。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>參數

*ppt*<br/>
指標[點](https://msdn.microsoft.com/library/windows/desktop/dd162805)結構，包含點擊的測試的座標，相對於用戶端區域的工具列。

*ptbim*<br/>
指標[TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark)接收插入標記資訊的結構。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_INSERTMARKHITTEST](/windows/desktop/Controls/tb-insertmarkhittest)、 Windows SDK 中所述。

##  <a name="isbuttonchecked"></a>  CToolBarCtrl::IsButtonChecked

決定是否要檢查在工具列控制項中指定的按鈕。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列上的按鈕命令識別項。

### <a name="return-value"></a>傳回值

如果已選取 按鈕，非零值。否則為零。

### <a name="remarks"></a>備註

請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。

##  <a name="isbuttonenabled"></a>  CToolBarCtrl::IsButtonEnabled

判斷是否已啟用工具列控制項中指定的按鈕。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列上的按鈕命令識別項。

### <a name="return-value"></a>傳回值

如果已啟用 按鈕，非零值。否則為零。

### <a name="remarks"></a>備註

請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。

##  <a name="isbuttonhidden"></a>  CToolBarCtrl::IsButtonHidden

決定是否要隱藏工具列控制項中指定的按鈕。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列上的按鈕命令識別項。

### <a name="return-value"></a>傳回值

非零值，如果按鈕處於隱藏狀態;否則為零。

### <a name="remarks"></a>備註

請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。

##  <a name="isbuttonhighlighted"></a>  CToolBarCtrl::IsButtonHighlighted

檢查反白顯示狀態的工具列按鈕。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
[in]工具列按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕已反白顯示正值的整數，0，表示按鈕不會反白顯示或-1 的錯誤，就會發生。

##  <a name="isbuttonindeterminate"></a>  CToolBarCtrl::IsButtonIndeterminate

決定工具列控制項中指定的按鈕為不定。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
[in]在工具列上的按鈕命令識別項。

### <a name="return-value"></a>傳回值

正整數如果按鈕是未定的如果零按鈕的逸出序列是不確定或-1，如果錯誤發生。

### <a name="remarks"></a>備註

不確定顯示按鈕呈現灰色，例如文書處理器的方式在工具列上的 [粗體] 按鈕時選取的文字包含粗體與一般字元的外觀。 請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。

##  <a name="isbuttonpressed"></a>  CToolBarCtrl::IsButtonPressed

判斷是否已按下工具列控制項中指定的按鈕。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
在工具列上的按鈕命令識別項。

### <a name="return-value"></a>傳回值

如果按下按鈕，否則為零，非零值。

### <a name="remarks"></a>備註

請考慮呼叫[GetState](#getstate)如果您想要擷取多個按鈕的狀態。

##  <a name="loadimages"></a>  CToolBarCtrl::LoadImages

將點陣圖載入到工具列控制項的影像清單中。

```
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>參數

*iBitmapID*<br/>
點陣圖，其中包含要載入的映像的識別碼。 若要指定您自己的點陣圖資源，將此參數設定為點陣圖資源的識別碼，並設定*hInst*為 NULL。 單一映像時，會加入您的點陣圖資源映像清單。 您可以藉由設定新增標準的系統定義的點陣圖*hinst* HINST_COMMCTRL 並將此參數設定為其中一個下列識別碼：

|點陣圖的 ID|描述|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|在大型的總管點陣圖|
|IDB_HIST_SMALL_COLOR|小型大小的總管點陣圖|
|IDB_STD_LARGE_COLOR|在大型的標準點陣圖|
|IDB_STD_SMALL_COLOR|標準的小型大小的點陣圖|
|IDB_VIEW_LARGE_COLOR|檢視大型點陣圖|
|IDB_VIEW_SMALL_COLOR|檢視小型大小的點陣圖|

*hinst*<br/>
呼叫的應用程式的程式執行個體控制代碼。 這個參數可以是 HINST_COMMCTRL 載入標準映像清單。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_LOADIMAGES](/windows/desktop/Controls/tb-loadimages)、 Windows SDK 中所述。

##  <a name="mapaccelerator"></a>  CToolBarCtrl::MapAccelerator

在工具列按鈕對應的加速器字元。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>參數

*chAccel*<br/>
要對應的加速器字元。 此字元是相同中按鈕的文字標有底線的字元。

*pIDBtn*<br/>
指標，接收對應至加速器中所指定的按鈕的命令識別碼 UINT *chAccel*。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_MAPACCELERATOR](/windows/desktop/Controls/tb-mapaccelerator)、 Windows SDK 中所述。

##  <a name="markbutton"></a>  CToolBarCtrl::MarkButton

設定反白顯示狀態指定按鈕的工具列控制項中。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的識別項。

*fHighlight*<br/>
指定要設定的反白顯示狀態。 根據預設，傳回 TRUE。 如果設為 FALSE，按鈕會設定為其預設狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_MARKBUTTON](/windows/desktop/Controls/tb-markbutton)、 Windows SDK 中所述。

##  <a name="movebutton"></a>  CToolBarCtrl::MoveButton

將按鈕從一個索引移動到另一個。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>參數

*nOldPos*<br/>
要移動的按鈕之以零起始的索引。

*nNewPos*<br/>
按鈕的目的以零為起始的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_MOVEBUTTON](/windows/desktop/Controls/tb-movebutton)、 Windows SDK 中所述。

##  <a name="pressbutton"></a>  CToolBarCtrl::PressButton

按下或釋放工具列控制項中指定的按鈕。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
[in]按下或放開按鈕命令識別項。

*bPress*<br/>
[in]按下指定的按鈕;，則為 TRUE釋放指定的按鈕，則為 FALSE。 預設值為 TRUE。

### <a name="return-value"></a>傳回值

如果方法成功，則為 TRUE否則為 FALSE。

### <a name="remarks"></a>備註

如果您想要變更多個按鈕的狀態，請考慮呼叫[SetState](#setstate)改。

這個方法會傳送[TB_PRESSBUTTON](/windows/desktop/Controls/tb-pressbutton)訊息，Windows SDK 中所述。

##  <a name="replacebitmap"></a>  CToolBarCtrl::ReplaceBitmap

新的點陣圖，取代目前的工具列控制項中現有的點陣圖。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pReplaceBitmap*|[in]指標[TBREPLACEBITMAP](/windows/desktop/api/commctrl/ns-commctrl-tbreplacebitmap)結構，描述要被取代的點陣圖和新的點陣圖。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TB_REPLACEBITMAP](/windows/desktop/Controls/tb-replacebitmap)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例以不同的點陣圖，取代 [標準] 工具列的點陣圖。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

##  <a name="restorestate"></a>  CToolBarCtrl::RestoreState

還原工具列控制項的狀態從登錄參數所指定的位置。

```
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別目前開啟的索引鍵，或任何下列預先定義保留的控制代碼值的登錄中：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 終止的字串，包含子機碼與值相關聯的名稱。 這個參數可以是 null 或空字串的指標。 值，如果參數是 NULL，會加入所識別的索引鍵*hKeyRoot*參數。

*lpszValueName*<br/>
指向字串，包含要擷取之值的名稱。 如果尚未存在的索引鍵中具有此名稱的值，則函式會將它新增至索引鍵。

##  <a name="savestate"></a>  CToolBarCtrl::SaveState

將工具列控制項的狀態儲存在登錄中參數所指定的位置中。

```
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別目前開啟的索引鍵，或任何下列預先定義保留的控制代碼值的登錄中：

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubKey*<br/>
指向以 null 終止的字串，包含子機碼與值相關聯的名稱。 這個參數可以是 null 或空字串的指標。 值，如果參數是 NULL，會加入所識別的索引鍵*hKeyRoot*參數。

*lpszValueName*<br/>
指向字串，包含要設定之值的名稱。 如果尚未存在的索引鍵中具有此名稱的值，則函式會將它新增至索引鍵。

##  <a name="setanchorhighlight"></a>  CToolBarCtrl::SetAnchorHighlight

設定錨點反白顯示的工具列設定。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>參數

*fAnchor*<br/>
[in]指定是否錨點反白顯示已啟用或停用。 如果此值為非零值，將會啟用醒目提示錨點。 如果此值為零，錨點醒目提示將會停用

### <a name="return-value"></a>傳回值

先前的錨點設定。 如果反白顯示已啟用，此值為非零值。 如果未啟用反白顯示，這個值會是零。

### <a name="remarks"></a>備註

這個方法會實作 Win32 訊息的行為[TB_SETANCHORHIGHLIGHT](/windows/desktop/Controls/tb-setanchorhighlight)、 Windows SDK 中所述。

##  <a name="setbitmapsize"></a>  CToolBarCtrl::SetBitmapSize

設定要加入至工具列控制項的實際點陣圖影像的大小。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
寬度和高度，單位為像素點陣圖影像。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

只加入工具列中的任何點陣圖之前，必須呼叫此函式。 如果應用程式沒有明確設定點陣圖大小，則會預設為 16 x 15 像素為單位。

##  <a name="setbuttoninfo"></a>  CToolBarCtrl::SetButtonInfo

在工具列中，設定現有按鈕的資訊。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的識別項。

*ptbbi*<br/>
指標[TBBUTTONINFO](/windows/desktop/api/commctrl/ns-commctrl-tbbuttoninfoa)接收按鈕資訊的結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETBUTTONINFO](/windows/desktop/Controls/tb-setbuttoninfo)、 Windows SDK 中所述。

##  <a name="setbuttonsize"></a>  CToolBarCtrl::SetButtonSize

在工具列控制項中，設定按鈕的大小。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
寬度和高度，單位為像素的按鈕。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

按鈕的大小都必須至少與它所含括的點陣圖大小一樣大。 只加入工具列中的任何點陣圖之前，必須呼叫此函式。 如果應用程式沒有明確設定按鈕的大小，則會預設為 24 x 22 像素為單位。

### <a name="example"></a>範例

  範例，請參閱[CToolBar::GetToolBarCtrl](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)。

##  <a name="setbuttonstructsize"></a>  CToolBarCtrl::SetButtonStructSize

指定的大小`TBBUTTON`結構。

```
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>參數

*nSize*<br/>
調整大小，以位元組為單位的`TBBUTTON`結構。

### <a name="remarks"></a>備註

如果您想要儲存中的額外資料`TBBUTTON`結構中，您可以衍生新的結構，從`TBBUTTON`，將成員加入您有需要或建立新的結構，其中包含`TBBUTTON`做為其第一個成員的結構。 然後，您會呼叫此函式以判斷工具列控制項的新結構的大小。

請參閱[CToolBarCtrl::AddButtons](#addbuttons)如需有關`TBBUTTON`結構。

##  <a name="setbuttonwidth"></a>  CToolBarCtrl::SetButtonWidth

設定工具列控制項中的最小和最大按鈕寬度。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>參數

*cxMin*<br/>
最小的按鈕寬度，單位為像素。 工具列按鈕絕對不會比這個值較窄。

*cxMax*<br/>
最大按鈕寬度，單位為像素。 如果按鈕文字太寬，控制項會顯示它具有省略符號點。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETBUTTONWIDTH](/windows/desktop/Controls/tb-setbuttonwidth)、 Windows SDK 中所述。

##  <a name="setcmdid"></a>  CToolBarCtrl::SetCmdID

設定時，按下指定的按鈕會傳送給主控視窗的命令識別碼。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
命令 ID 是要設定的按鈕之以零起始的索引。

*nID*<br/>
要設為 [選取] 按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果成功則為非零傳回否則為零。

##  <a name="setcolorscheme"></a>  CToolBarCtrl::SetColorScheme

設定目前的工具列控制項的色彩配置。

```
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*lpColorScheme*|[in]指標[新增的色彩配置](/windows/desktop/api/commctrl/ns-commctrl-tagcolorscheme)描述反白顯示色彩和陰影色彩的工具列控制項的結構。|

### <a name="remarks"></a>備註

如果在設定 Windows Vista 的視覺效果佈景主題，這個方法沒有任何作用。

這個方法會傳送[TB_SETCOLORSCHEME](/windows/desktop/Controls/tb-setcolorscheme)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會設定目前的工具列控制項的色彩配置。 程式碼範例將紅色的每個工具 按鈕的左邊和頂端邊緣和右邊緣和下邊緣藍色。 當使用者按下按鈕時，按鈕的紅色邊緣會變成藍色，其藍色邊緣會變成紅色。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

##  <a name="setdisabledimagelist"></a>  CToolBarCtrl::SetDisabledImageList

設定來顯示停用按鈕的工具列控制項會使用影像清單。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指標`CImageList`物件，其中包含可供顯示停用按鈕影像的工具列控制項的映像。

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)以前使用停用的顯示按鈕影像的工具列控制項的物件。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETDISABLEDIMAGELIST](/windows/desktop/Controls/tb-setdisabledimagelist)、 Windows SDK 中所述。 MFC 實作`SetDisabledImageList`使用`CImageList`物件，其中包含已停用的按鈕的工具列控制項的映像，而不是影像清單的控制代碼。

##  <a name="setdrawtextflags"></a>  CToolBarCtrl::SetDrawTextFlags

Win32 函式中設定的旗標[DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext)，用來繪製在指定的矩形中，根據旗標的設定方式進行格式化的文字。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>參數

*dwMask*<br/>
一或多個 Win32 函式中指定的 DT_ 旗標的組合[DrawText](/windows/desktop/api/winuser/nf-winuser-drawtext)，表示其中的位元*dwDTFlags*將在繪製文字時使用。

*dwDTFlags*<br/>
一或多個 Win32 函式中指定的 DT_ 旗標的組合`DrawText`，指出如何將繪製按鈕的文字。 這個值會傳遞至`DrawText`時繪製按鈕的文字。

### <a name="return-value"></a>傳回值

DWORD，其中包含先前的文字繪製旗標。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETDRAWTEXTFLAGS](/windows/desktop/Controls/tb-setdrawtextflags)、 Windows SDK 中所述。 此成員函式會設定旗標的 Win32 函式中`DrawText`，其中繪製的文字中指定的矩形中，根據旗標的設定方式格式化。

##  <a name="setextendedstyle"></a>  CToolBarCtrl::SetExtendedStyle

設定工具列控制項的延伸的樣式。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
值，指定新的延伸的樣式。 這個參數可以是工具列延伸樣式的組合。

### <a name="return-value"></a>傳回值

表示上一個擴充樣式 DWORD。 如需樣式的清單，請參閱 < [Toolbar 擴充樣式](/windows/desktop/Controls/toolbar-extended-styles)，Windows SDK 中。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETEXTENDEDSTYLE](/windows/desktop/Controls/tb-setextendedstyle)、 Windows SDK 中所述。

##  <a name="sethotimagelist"></a>  CToolBarCtrl::SetHotImageList

設定影像清單，工具列控制項會將用來顯示 「 熱 」 按鈕。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指標`CImageList`物件，其中包含要供工具列控制項來顯示作用中的按鈕影像的影像。

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)以前使用工具列控制項來顯示作用中的按鈕影像的物件。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETHOTIMAGELIST](/windows/desktop/Controls/tb-sethotimagelist)、 Windows SDK 中所述。

MFC 實作`SetHotImageList`使用`CImageList`物件，其中包含工具列控制項的作用中的按鈕映像，而不是影像清單的控制代碼。 當指標位於其上方時，作用中的按鈕會反白顯示。

##  <a name="sethotitem"></a>  CToolBarCtrl::SetHotItem

在工具列中，設定作用的項目。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>參數

*nHot*<br/>
將成為熱門的項目以零為起始的索引編號。 如果此值為-1，項目都不會作用。

### <a name="return-value"></a>傳回值

上一個熱門的項目或-1，如果沒有任何作用的項目索引。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETHOTITEM](/windows/desktop/Controls/tb-sethotitem)、 Windows SDK 中所述。

##  <a name="setimagelist"></a>  CToolBarCtrl::SetImageList

設定影像清單工具列將用來顯示其預設狀態中的按鈕。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指標`CImageList`物件，其中包含要供工具列控制項在其預設狀態中顯示按鈕影像的影像。

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md)以前使用工具列控制項在其預設狀態中顯示按鈕影像的物件。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETIMAGELIST](/windows/desktop/Controls/tb-setimagelist)、 Windows SDK 中所述。

MFC 實作`SetImageList`使用`CImageList`物件，其中包含工具列控制項的按鈕映像，而不是影像清單的控制代碼。

##  <a name="setindent"></a>  CToolBarCtrl::SetIndent

在工具列控制項中設定的第一個按鈕的縮排。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>參數

*iIndent*<br/>
像素為單位指定縮排的值。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

##  <a name="setinsertmark"></a>  CToolBarCtrl::SetInsertMark

設定目前的插入標記的工具列。

```
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>參數

*ptbim*<br/>
指標[TBINSERTMARK](/windows/desktop/api/commctrl/ns-commctrl-tbinsertmark)結構，包含插入標記。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETINSERTMARK](/windows/desktop/Controls/tb-setinsertmark)、 Windows SDK 中所述。

##  <a name="setinsertmarkcolor"></a>  CToolBarCtrl::SetInsertMarkColor

設定用來繪製的工具列插入標記的色彩。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
COLORREF 值，其中包含新的插入標記色彩。

### <a name="return-value"></a>傳回值

COLORREF 值，其中包含上一個插入標記色彩。

### <a name="remarks"></a>備註

此成員函式實作的 Win32 訊息的行為[TB_SETINSERTMARKCOLOR](/windows/desktop/Controls/tb-setinsertmarkcolor)、 Windows SDK 中所述。

##  <a name="setmaxtextrows"></a>  CToolBarCtrl::SetMaxTextRows

設定顯示於工具列按鈕上的文字資料列數目上限。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>參數

*iMaxRows*<br/>
若要設定的資料列的數目上限。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

##  <a name="setmetrics"></a>  CToolBarCtrl::SetMetrics

設定的計量`CToolBarCtrl`物件。

```
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>參數

*ptbm*<br/>
指標[TBMETRICS](/windows/desktop/api/commctrl/ns-commctrl-tbmetrics)結構`CToolBarCtrl`物件。

### <a name="remarks"></a>備註

此成員函式會模擬[TB_SETMETRICS](/windows/desktop/Controls/tb-setmetrics)訊息、 Windows SDK 中所述。

##  <a name="setowner"></a>  CToolBarCtrl::SetOwner

設定工具列控制項的主控視窗。

```
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
指標`CWnd`或`CWnd`-衍生將成為新的擁有者視窗工具列控制項的物件。

### <a name="remarks"></a>備註

主控視窗會收到通知，從工具列的視窗。

##  <a name="setpadding"></a>  CToolBarCtrl::SetPadding

設定目前的工具列控制項的水平和垂直邊框距離。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*nHorzPadding*|[in]指定工具列控制項的水平的填補像素為單位。|
|*nVertPadding*|[in]指定垂直填補的工具列控制項中，像素為單位。|

### <a name="return-value"></a>傳回值

DWORD 的低位文字包含先前的水平的填補值，而其高位文字包含先前的垂直的邊框距離值。 邊框距離值是以像素為單位測量。

### <a name="remarks"></a>備註

這個方法會傳送[TB_SETPADDING](/windows/desktop/Controls/tb-setpadding)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例設定目前的工具列控制項的水平和垂直邊框距離為 20 個像素。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

##  <a name="setpressedimagelist"></a>  CToolBarCtrl::SetPressedImageList

設定映像清單，其中目前的工具列控制項用來表示處於已按下狀態的按鈕。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iImageID*|[in]影像清單的以零為起始的索引。 如果您使用一個映像清單，請將這個參數設定為零。|
|*pImageList*|[in]指標[CImageList](../../mfc/reference/cimagelist-class.md)包含新的映像清單。|

### <a name="return-value"></a>傳回值

指標[CImageList](../../mfc/reference/cimagelist-class.md) ，包含目前的控制項，則為 NULL 的前一個映像清單，如果沒有這類映像清單設定。

### <a name="remarks"></a>備註

這個方法會傳送[TB_SETPRESSEDIMAGELIST](/windows/desktop/Controls/tb-setpressedimagelist)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會設定預設映像清單相同的已按下的映像清單。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

##  <a name="setrows"></a>  CToolBarCtrl::SetRows

會要求工具列控制項調整大小以要求的資料列數目。

```
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>參數

*nRows*<br/>
要求的資料列數目。

*bLarger*<br/>
會指示是否要使用多個資料列或較少的資料列，如果無法調整大小的工具列，為要求的資料列數目。

*lpRect*<br/>
指向[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](https://msdn.microsoft.com/library/windows/desktop/dd162897)結構，將會收到工具列的新週框矩形。

### <a name="remarks"></a>備註

如果工具列無法自行調整大小的要求的數目或資料列，它會自行調整大小設為下一步 較大或下一個較小有效大小，取決於值*bLarger*。 如果*bLarger*為 TRUE 時，新的資料列數目會大於要求的號碼。 如果*bLarger*為 FALSE 時，新的資料列數目將會小於要求的號碼。

可以排列按鈕，讓所有資料列擁有相同數目的 （除了可能是最後一個資料列） 的按鈕時，適用於工具列給定的資料列數目。 例如，包含四個按鈕的工具列可以不調整大小，以三個資料列因為最後兩個資料列都必須得更短。 如果您嘗試將其大小為三個資料列，您就會得到 4 個資料列，如果*bLarger*是 TRUE，且兩個資料列，如果*bLarger*是 FALSE。

如果工具列有分隔符號，給定的資料列數目時有效的規則是更複雜。 配置的計算，除非群組無法容納一個資料列上數個資料列會永遠不會中斷 （按鈕之前，先為分隔符號使用） 和最後一個按鈕群組中的按鈕群組。

如果群組不符合上一個資料列中下, 一個群組會啟動下一個資料列上，即使它可容納大型群組的結束位置的資料列。 此規則的目的是要更明顯的大型群組之間的區隔。 產生的垂直分隔符號會被視為資料列。

也請注意，`SetRows`成員函式一律會選擇產生最小的工具列大小配置。 建立工具列與 TBSTYLE_WRAPABLE 樣式和控制項只會套用上方所述的方法然後調整大小指定控制項的寬度。

此函式只可以呼叫所建立的 TBSTYLE_WRAPABLE 樣式的工具列。

##  <a name="setstate"></a>  CToolBarCtrl::SetState

在工具列控制項中設定指定的按鈕的狀態。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>參數

*nID*<br/>
命令按鈕的識別碼。

*nState*<br/>
狀態旗標。 它可以是按鈕狀態中所列的值的組合[CToolBarCtrl::AddButtons](#addbuttons)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此函式是特別有用，如果您想要設定一個以上的按鈕狀態。 若要只設定一個狀態，請使用下列成員函式的其中一個： [EnableButton](#enablebutton)， [CheckButton](#checkbutton)， [HideButton](#hidebutton)，[未定](#indeterminate)，或是[PressButton](#pressbutton)。

##  <a name="setstyle"></a>  CToolBarCtrl::SetStyle

設定工具列控制項的樣式。

```
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*cheaderctrl:: Create*<br/>
DWORD，其中包含組成[toolbar 控制項樣式](/windows/desktop/Controls/toolbar-control-and-button-styles)、 Windows SDK 中所述。

##  <a name="settooltips"></a>  CToolBarCtrl::SetToolTips

關聯工具列控制項中的工具提示控制項。

```
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>參數

*pTip*<br/>
指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件。

##  <a name="setwindowtheme"></a>  CToolBarCtrl::SetWindowTheme

設定的視覺化樣式`CToolBarCtrl`物件。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>參數

*pszSubAppName*<br/>
包含工具列視覺化樣式，若要設定的 Unicode 字串指標。

### <a name="return-value"></a>傳回值

不會使用傳回的值。

### <a name="remarks"></a>備註

此成員函式會模擬[TB_SETWINDOWTHEME](/windows/desktop/Controls/tb-setwindowtheme)訊息、 Windows SDK 中所述。

## <a name="see-also"></a>另請參閱

[MFC 範例 CMNCTRL1](../../visual-cpp-samples.md)<br/>
[MFC 範例 MFCIE](../../visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CToolBar 類別](../../mfc/reference/ctoolbar-class.md)
