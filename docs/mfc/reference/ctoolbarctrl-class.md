---
title: CToolBarCtrl 類別
ms.date: 11/04/2016
f1_keywords:
- CToolBarCtrl
- AFXCMN/CToolBarCtrl
- AFXCMN/CToolBarCtrl::CToolBarCtrl
- AFXCMN/CToolBarCtrl::AddBitmap
- AFXCMN/CToolBarCtrl::AddButtons
- AFXCMN/CToolBarCtrl::AddString
- AFXCMN/CToolBarCtrl::AddStrings
- AFXCMN/CToolBarCtrl::AutoSize
- AFXCMN/CToolBarCtrl::ChangeBitmap
- AFXCMN/CToolBarCtrl::CheckButton
- AFXCMN/CToolBarCtrl::CommandToIndex
- AFXCMN/CToolBarCtrl::Create
- AFXCMN/CToolBarCtrl::CreateEx
- AFXCMN/CToolBarCtrl::Customize
- AFXCMN/CToolBarCtrl::DeleteButton
- AFXCMN/CToolBarCtrl::EnableButton
- AFXCMN/CToolBarCtrl::GetAnchorHighlight
- AFXCMN/CToolBarCtrl::GetBitmap
- AFXCMN/CToolBarCtrl::GetBitmapFlags
- AFXCMN/CToolBarCtrl::GetButton
- AFXCMN/CToolBarCtrl::GetButtonCount
- AFXCMN/CToolBarCtrl::GetButtonInfo
- AFXCMN/CToolBarCtrl::GetButtonSize
- AFXCMN/CToolBarCtrl::GetColorScheme
- AFXCMN/CToolBarCtrl::GetDisabledImageList
- AFXCMN/CToolBarCtrl::GetDropTarget
- AFXCMN/CToolBarCtrl::GetExtendedStyle
- AFXCMN/CToolBarCtrl::GetHotImageList
- AFXCMN/CToolBarCtrl::GetHotItem
- AFXCMN/CToolBarCtrl::GetImageList
- AFXCMN/CToolBarCtrl::GetInsertMark
- AFXCMN/CToolBarCtrl::GetInsertMarkColor
- AFXCMN/CToolBarCtrl::GetItemRect
- AFXCMN/CToolBarCtrl::GetMaxSize
- AFXCMN/CToolBarCtrl::GetMaxTextRows
- AFXCMN/CToolBarCtrl::GetMetrics
- AFXCMN/CToolBarCtrl::GetPadding
- AFXCMN/CToolBarCtrl::GetPressedImageList
- AFXCMN/CToolBarCtrl::GetRect
- AFXCMN/CToolBarCtrl::GetRows
- AFXCMN/CToolBarCtrl::GetState
- AFXCMN/CToolBarCtrl::GetString
- AFXCMN/CToolBarCtrl::GetStyle
- AFXCMN/CToolBarCtrl::GetToolTips
- AFXCMN/CToolBarCtrl::HideButton
- AFXCMN/CToolBarCtrl::HitTest
- AFXCMN/CToolBarCtrl::Indeterminate
- AFXCMN/CToolBarCtrl::InsertButton
- AFXCMN/CToolBarCtrl::InsertMarkHitTest
- AFXCMN/CToolBarCtrl::IsButtonChecked
- AFXCMN/CToolBarCtrl::IsButtonEnabled
- AFXCMN/CToolBarCtrl::IsButtonHidden
- AFXCMN/CToolBarCtrl::IsButtonHighlighted
- AFXCMN/CToolBarCtrl::IsButtonIndeterminate
- AFXCMN/CToolBarCtrl::IsButtonPressed
- AFXCMN/CToolBarCtrl::LoadImages
- AFXCMN/CToolBarCtrl::MapAccelerator
- AFXCMN/CToolBarCtrl::MarkButton
- AFXCMN/CToolBarCtrl::MoveButton
- AFXCMN/CToolBarCtrl::PressButton
- AFXCMN/CToolBarCtrl::ReplaceBitmap
- AFXCMN/CToolBarCtrl::RestoreState
- AFXCMN/CToolBarCtrl::SaveState
- AFXCMN/CToolBarCtrl::SetAnchorHighlight
- AFXCMN/CToolBarCtrl::SetBitmapSize
- AFXCMN/CToolBarCtrl::SetButtonInfo
- AFXCMN/CToolBarCtrl::SetButtonSize
- AFXCMN/CToolBarCtrl::SetButtonStructSize
- AFXCMN/CToolBarCtrl::SetButtonWidth
- AFXCMN/CToolBarCtrl::SetCmdID
- AFXCMN/CToolBarCtrl::SetColorScheme
- AFXCMN/CToolBarCtrl::SetDisabledImageList
- AFXCMN/CToolBarCtrl::SetDrawTextFlags
- AFXCMN/CToolBarCtrl::SetExtendedStyle
- AFXCMN/CToolBarCtrl::SetHotImageList
- AFXCMN/CToolBarCtrl::SetHotItem
- AFXCMN/CToolBarCtrl::SetImageList
- AFXCMN/CToolBarCtrl::SetIndent
- AFXCMN/CToolBarCtrl::SetInsertMark
- AFXCMN/CToolBarCtrl::SetInsertMarkColor
- AFXCMN/CToolBarCtrl::SetMaxTextRows
- AFXCMN/CToolBarCtrl::SetMetrics
- AFXCMN/CToolBarCtrl::SetOwner
- AFXCMN/CToolBarCtrl::SetPadding
- AFXCMN/CToolBarCtrl::SetPressedImageList
- AFXCMN/CToolBarCtrl::SetRows
- AFXCMN/CToolBarCtrl::SetState
- AFXCMN/CToolBarCtrl::SetStyle
- AFXCMN/CToolBarCtrl::SetToolTips
- AFXCMN/CToolBarCtrl::SetWindowTheme
helpviewer_keywords:
- CToolBarCtrl [MFC], CToolBarCtrl
- CToolBarCtrl [MFC], AddBitmap
- CToolBarCtrl [MFC], AddButtons
- CToolBarCtrl [MFC], AddString
- CToolBarCtrl [MFC], AddStrings
- CToolBarCtrl [MFC], AutoSize
- CToolBarCtrl [MFC], ChangeBitmap
- CToolBarCtrl [MFC], CheckButton
- CToolBarCtrl [MFC], CommandToIndex
- CToolBarCtrl [MFC], Create
- CToolBarCtrl [MFC], CreateEx
- CToolBarCtrl [MFC], Customize
- CToolBarCtrl [MFC], DeleteButton
- CToolBarCtrl [MFC], EnableButton
- CToolBarCtrl [MFC], GetAnchorHighlight
- CToolBarCtrl [MFC], GetBitmap
- CToolBarCtrl [MFC], GetBitmapFlags
- CToolBarCtrl [MFC], GetButton
- CToolBarCtrl [MFC], GetButtonCount
- CToolBarCtrl [MFC], GetButtonInfo
- CToolBarCtrl [MFC], GetButtonSize
- CToolBarCtrl [MFC], GetColorScheme
- CToolBarCtrl [MFC], GetDisabledImageList
- CToolBarCtrl [MFC], GetDropTarget
- CToolBarCtrl [MFC], GetExtendedStyle
- CToolBarCtrl [MFC], GetHotImageList
- CToolBarCtrl [MFC], GetHotItem
- CToolBarCtrl [MFC], GetImageList
- CToolBarCtrl [MFC], GetInsertMark
- CToolBarCtrl [MFC], GetInsertMarkColor
- CToolBarCtrl [MFC], GetItemRect
- CToolBarCtrl [MFC], GetMaxSize
- CToolBarCtrl [MFC], GetMaxTextRows
- CToolBarCtrl [MFC], GetMetrics
- CToolBarCtrl [MFC], GetPadding
- CToolBarCtrl [MFC], GetPressedImageList
- CToolBarCtrl [MFC], GetRect
- CToolBarCtrl [MFC], GetRows
- CToolBarCtrl [MFC], GetState
- CToolBarCtrl [MFC], GetString
- CToolBarCtrl [MFC], GetStyle
- CToolBarCtrl [MFC], GetToolTips
- CToolBarCtrl [MFC], HideButton
- CToolBarCtrl [MFC], HitTest
- CToolBarCtrl [MFC], Indeterminate
- CToolBarCtrl [MFC], InsertButton
- CToolBarCtrl [MFC], InsertMarkHitTest
- CToolBarCtrl [MFC], IsButtonChecked
- CToolBarCtrl [MFC], IsButtonEnabled
- CToolBarCtrl [MFC], IsButtonHidden
- CToolBarCtrl [MFC], IsButtonHighlighted
- CToolBarCtrl [MFC], IsButtonIndeterminate
- CToolBarCtrl [MFC], IsButtonPressed
- CToolBarCtrl [MFC], LoadImages
- CToolBarCtrl [MFC], MapAccelerator
- CToolBarCtrl [MFC], MarkButton
- CToolBarCtrl [MFC], MoveButton
- CToolBarCtrl [MFC], PressButton
- CToolBarCtrl [MFC], ReplaceBitmap
- CToolBarCtrl [MFC], RestoreState
- CToolBarCtrl [MFC], SaveState
- CToolBarCtrl [MFC], SetAnchorHighlight
- CToolBarCtrl [MFC], SetBitmapSize
- CToolBarCtrl [MFC], SetButtonInfo
- CToolBarCtrl [MFC], SetButtonSize
- CToolBarCtrl [MFC], SetButtonStructSize
- CToolBarCtrl [MFC], SetButtonWidth
- CToolBarCtrl [MFC], SetCmdID
- CToolBarCtrl [MFC], SetColorScheme
- CToolBarCtrl [MFC], SetDisabledImageList
- CToolBarCtrl [MFC], SetDrawTextFlags
- CToolBarCtrl [MFC], SetExtendedStyle
- CToolBarCtrl [MFC], SetHotImageList
- CToolBarCtrl [MFC], SetHotItem
- CToolBarCtrl [MFC], SetImageList
- CToolBarCtrl [MFC], SetIndent
- CToolBarCtrl [MFC], SetInsertMark
- CToolBarCtrl [MFC], SetInsertMarkColor
- CToolBarCtrl [MFC], SetMaxTextRows
- CToolBarCtrl [MFC], SetMetrics
- CToolBarCtrl [MFC], SetOwner
- CToolBarCtrl [MFC], SetPadding
- CToolBarCtrl [MFC], SetPressedImageList
- CToolBarCtrl [MFC], SetRows
- CToolBarCtrl [MFC], SetState
- CToolBarCtrl [MFC], SetStyle
- CToolBarCtrl [MFC], SetToolTips
- CToolBarCtrl [MFC], SetWindowTheme
ms.assetid: 8f2f8ad2-05d7-4975-8715-3f2eed795248
ms.openlocfilehash: 50d3174d4569392be72efdad338eeaac3154ec56
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752218"
---
# <a name="ctoolbarctrl-class"></a>CToolBarCtrl 類別

提供 Windows 工具列通用控制項的功能。

## <a name="syntax"></a>語法

```
class CToolBarCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl:CToolBarCtrl](#ctoolbarctrl)|建構 `CToolBarCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CToolBarCtrl:: 新增位元圖](#addbitmap)|將一個或多個點陣圖按鈕圖像添加到可用於工具列控制件的按鈕圖像清單中。|
|[CToolBarCtrl:: 新增按鈕](#addbuttons)|將一個或多個按鈕添加到工具列控制項。|
|[CToolBarCtrl::添加String](#addstring)|將作為資源 ID 傳遞的新字串添加到工具列的內部字串清單中。|
|[CToolBarCtrl:: 新增字串](#addstrings)|將新的字串或字串(作為指向空分隔字串的緩衝區的指標)傳遞到工具列的內部字串清單中。|
|[CToolBarCtrl:自動調整](#autosize)|調整工具列控制的大小。|
|[CToolBarCtrl::更改位圖](#changebitmap)|更改當前工具列控制項中按鈕的點陣圖。|
|[CToolBarCtrl::檢查按鈕](#checkbutton)|檢查或清除工具列控制件中的給定按鈕。|
|[CToolBarctrl::命令索引](#commandtoindex)|檢索與指定命令標識符關聯的按鈕的零基索引。|
|[CToolBarCtrl::建立](#create)|創建工具列控制項並將其附加到`CToolBarCtrl`物件。|
|[CToolBarCtrl::建立Ex](#createex)|使用指定的 Windows 擴充樣式創建工具列控制項,並將`CToolBarCtrl`其附加到 物件。|
|[CToolBarCtrl:自訂](#customize)|顯示「自訂工具列」對話框。|
|[CToolBarCtrl::DeleteButton](#deletebutton)|從工具列控制項中刪除按鈕。|
|[CToolBarCtrl:開啟按鈕](#enablebutton)|啟用或禁用工具列控制件中的指定按鈕。|
|[CToolBarCtrl::取得錨點突出顯示](#getanchorhighlight)|檢索工具列的錨點高光設置。|
|[CToolBarCtrl::取得位元圖](#getbitmap)|檢索與工具列中的按鈕關聯的位圖的索引。|
|[CToolBarCtrl::取得位式射標記](#getbitmapflags)|獲取與工具列位圖關聯的標誌。|
|[CToolBarCtrl:取得按鈕](#getbutton)|檢索有關工具列控件中指定按鈕的資訊。|
|[CToolBarCtrl::取得按鈕計數](#getbuttoncount)|檢索工具列控件中當前按鈕的計數。|
|[CToolBarCtrl::取得按鈕資訊](#getbuttoninfo)|檢索工具列中按鈕的資訊。|
|[CToolBarCtrl:取得按鈕大小](#getbuttonsize)|檢索工具列按鈕的當前寬度和高度(以像素為單位)。|
|[CToolBarCtrl:取得顏色機制](#getcolorscheme)|檢索當前工具列控件的色彩配置。|
|[CToolBarCtrl:取得關閉影像清單](#getdisabledimagelist)|檢索工具列控制項用於顯示禁用按鈕的圖像清單。|
|[CToolBarCtrl::取得DropTarget](#getdroptarget)|檢索工具列控件的[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)介面。|
|[CToolBarCtrl::取得式延伸樣式](#getextendedstyle)|檢索工具列控件的擴展樣式。|
|[CToolBarCtrl:取得HotImage清單](#gethotimagelist)|檢索工具列控制項用於顯示「熱」按鈕的圖像清單。 當滑鼠指標位於上方時,將顯示一個熱按鈕。|
|[CToolBarCtrl:取得Hot專案](#gethotitem)|檢索工具列中熱項的索引。|
|[CToolBarCtrl:抓取圖片清單](#getimagelist)|檢索工具列控制項用於以預設狀態顯示按鈕的圖像清單。|
|[CToolBarCtrl::取得插入標記](#getinsertmark)|檢索工具列的當前插入標記。|
|[CToolBarCtrl::取得插入標記顏色](#getinsertmarkcolor)|檢索用於繪製工具列插入標記的顏色。|
|[CToolBarCtrl::取得專案](#getitemrect)|檢索工具列控件中按鈕的邊界矩形。|
|[CToolBarCtrl:取得最大尺寸](#getmaxsize)|檢索工具列中所有可見按鈕和分隔符的總大小。|
|[CToolBarCtrl::取得最大文字列](#getmaxtextrows)|檢索工具列按鈕上顯示的最大文本行數。|
|[CToolBarCtrl:取得指標](#getmetrics)|檢索工具列控件的指標。|
|[CToolBarCtrl::取得填充](#getpadding)|檢索當前工具列控件的水準和垂直填充。|
|[CToolBarCtrl:抓取被壓影像清單](#getpressedimagelist)|檢索當前工具列控制項用於表示處於按下狀態的按鈕的圖像清單。|
|[CToolBarCtrl::取得Rect](#getrect)|檢索指定工具列按鈕的邊界矩形。|
|[CToolBarCtrl::取得](#getrows)|檢索工具列中當前顯示的按鈕行數。|
|[CToolBarCtrl:取得狀態](#getstate)|檢索有關工具列控件中指定按鈕的狀態的資訊,例如是啟用、按下還是選中該按鈕。|
|[CToolBarCtrl::GetString](#getstring)|檢索工具列字串。|
|[CToolBarCtrl::取得樣式](#getstyle)|檢索當前用於工具列控件的樣式。|
|[CToolBarCtrl:抓取工具提示](#gettooltips)|檢索與工具列控件關聯的工具尖端控制項的句柄(如果有)。|
|[CToolBarCtrl:隱藏按鈕](#hidebutton)|在工具列控制項中隱藏或顯示指定的按鈕。|
|[CToolBarCtrl:hitTest](#hittest)|確定點位於工具列控件的位置。|
|[CToolBarctrl::不確定](#indeterminate)|設置或清除工具列控制項中指定按鈕的不確定(灰色)狀態。|
|[CToolBarCtrl::插入按鈕](#insertbutton)|在工具列控制項中插入按鈕。|
|[CToolBarCtrl::插入標記命中測試](#insertmarkhittest)|檢索工具列中點的插入標記資訊。|
|[CToolBarCtrl::是按鈕檢查](#isbuttonchecked)|告訴是否選擇的工具列控制檔中的指定按鈕。|
|[CToolBarCtrl:即啟用按鈕](#isbuttonenabled)|告訴工具列控制件中的指定按鈕是否已啟用。|
|[CToolBarCtrl::是按鈕隱藏](#isbuttonhidden)|告訴工具列控制件中的指定按鈕是否隱藏。|
|[CToolBarCtrl::按鍵突出顯示](#isbuttonhighlighted)|檢查工具列按鈕的突出顯示狀態。|
|[CToolBarctrl::是按鈕不確定](#isbuttonindeterminate)|告知工具列控件中指定按鈕的狀態是否不確定(灰色)。|
|[CToolBarCtrl::按鍵](#isbuttonpressed)|告訴是否按下工具列控制件中的指定按鈕。|
|[CToolBarCtrl::載入影像](#loadimages)|將點陣圖載入到工具列控制的影像清單中。|
|[CToolBarCtrl::地圖加速器](#mapaccelerator)|將快捷鍵字元映射到工具列按鈕。|
|[CToolBarCtrl::標記按鈕](#markbutton)|設置工具列控制項中給定按鈕的突出顯示狀態。|
|[CToolBarCtrl:: 移動按鈕](#movebutton)|將按鈕從一個索引移動到另一個索引。|
|[CToolBarCtrl::PresButton](#pressbutton)|按下或釋放工具列控制件中的指定按鈕。|
|[CToolBarCtrl::取代位圖](#replacebitmap)|將當前工具列控制件中的現有點陣圖替換為新的點陣圖。|
|[CToolBarCtrl::恢復狀態](#restorestate)|還原工具列控件的狀態。|
|[CToolBarCtrl::儲存狀態](#savestate)|保存工具列控件的狀態。|
|[CToolBarCtrl::設置錨點高光](#setanchorhighlight)|設置工具列的錨點高光設置。|
|[CToolBarCtrl::設定點陣圖大小](#setbitmapsize)|設置要添加到工具列控制件的位映射影像的大小。|
|[CToolBarCtrl::設定按鈕資訊](#setbuttoninfo)|設置工具列中現有按鈕的資訊。|
|[CToolBarCtrl::設定按鈕大小](#setbuttonsize)|設置要添加到工具列控制件的按鈕的大小。|
|[CToolBarctrl::設定按鈕的大小](#setbuttonstructsize)|指定結構的大小`TBBUTTON`。|
|[CToolBarCtrl::設定按鈕寬度](#setbuttonwidth)|設置工具列控制件中的最小和最大按鈕寬度。|
|[CToolBarCtrl::SetCmdID](#setcmdid)|設定在按下指定按鈕時要發送到所有者視窗的命令識別碼。|
|[CToolBarCtrl::設定顏色機制](#setcolorscheme)|設置當前工具列控件的色彩配置。|
|[CToolBarCtrl::設定關閉影像清單](#setdisabledimagelist)|設定工具列控制項將用於顯示禁用按鈕的圖像清單。|
|[CToolBarCtrl::設定繪製文字標誌](#setdrawtextflags)|設定 Win32 函數[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的標誌 ,用於在指定的矩形中繪製文本,根據標誌的設置方式進行格式化。|
|[CToolBarCtrl::設定式延伸樣式](#setextendedstyle)|設置工具列控件的擴展樣式。|
|[CToolBarCtrl::設定HotImage清單](#sethotimagelist)|設定工具列控制項將用於顯示「熱」按鈕的圖像清單。|
|[CToolBarCtrl::設定Hot專案](#sethotitem)|在工具列中設置熱項。|
|[CToolBarCtrl::設定影像清單](#setimagelist)|設定工具列用於顯示處於預設狀態的按鈕的圖像清單。|
|[CToolBarctrl:setindent](#setindent)|設置工具列控制項中第一個按鈕的縮進。|
|[CToolBarCtrl::設定插入標記](#setinsertmark)|設定工具列的目前插入標記。|
|[CToolBarCtrl::設定插入標記顏色](#setinsertmarkcolor)|設置用於繪製工具列插入標記的顏色。|
|[CToolBarCtrl::設定MaxTextRows](#setmaxtextrows)|設定工具列按鈕上顯示的最大文本行數。|
|[CToolBarCtrl::設定指標](#setmetrics)|設置工具列控件的指標。|
|[CToolBarCtrl::SetOwner](#setowner)|設置視窗以接收來自工具列控制項的通知訊息。|
|[CToolBarCtrl::設定](#setpadding)|設置當前工具列控制件的水準和垂直填充。|
|[CToolBarCtrl::設定被壓抑的影像清單](#setpressedimagelist)|設定當前工具列控制項用於表示處於按下狀態的按鈕的圖像清單。|
|[CToolBarCtrl::SetRows](#setrows)|設定工具列中顯示的按鈕行數。|
|[CToolBarCtrl::設定狀態](#setstate)|設定工具列控制項中指定按鈕的狀態。|
|[CToolBarCtrl::設定樣式](#setstyle)|設置工具列控件的樣式。|
|[CToolBarCtrl::設定工具提示](#settooltips)|將工具尖端控制件與工具列控制件關聯。|
|[CToolBarctrl::設定視窗主題](#setwindowtheme)|設置工具列控件的可視樣式。|

## <a name="remarks"></a>備註

此控制項(因此該`CToolBarCtrl`類別)僅適用於在 Windows 95/98 和 Windows NT 版本 3.51 及更高版本下運行的程式。

Windows 工具列公共控制項是包含一個或多個按鈕的矩形子視窗。 這些按鈕可以顯示位圖圖像、字串或兩者。 當用戶選擇一個按鈕時,它會向工具列的所有者視窗發送命令消息。 通常,工具列中的按鈕對應於應用程式功能表中的項;它們為使用者提供了一種更直接的方式來訪問應用程式的命令。

`CToolBarCtrl`物件包含幾個重要的內部數據結構:按鈕圖像位圖或圖像清單的清單、按鈕標籤字串的清單以及將圖像和/或字串與按鈕的位置`TBBUTTON`、樣式、狀態和命令 ID 相關聯的結構清單。 這些數據結構的每個元素都用零基索引來引用。 在使用`CToolBarCtrl`物件之前,必須設置這些數據結構。 字串清單只能用於按鈕標籤;因此,字串清單只能用於按鈕標籤。無法從工具列檢索字串。

若要使用 `CToolBarCtrl` 物件，您通常會執行下列步驟：

1. 建構 `CToolBarCtrl` 物件。

1. 呼叫[「創建](#create)」以創建 Windows 工具列通用控制項並將`CToolBarCtrl`其附加到 物件。 使用樣式指示工具列的樣式,例如為透明工具列TBSTYLE_TRANSPARENT,或支援下拉樣式按鈕的工具列TBSTYLE_DROPDOWN。

1. 確定您希望工具列上的按鈕顯示方式:

   - 要將點陣圖圖像用於按鈕,請透過調用[AddBitmap](#addbitmap)將按鈕點陣圖添加到工具列。

   - 要使用從影像清單中顯示的圖像進行按鈕,請透過調用[SetImageList、SetHotImageList](#sethotimagelist)或[「設定禁用影像清單](#setdisabledimagelist)」來[SetImageList](#setimagelist)指定影像清單。

   - 要對按鈕使用字串標籤,請使用調用[AddString](#addstring)和/或[AddString](#addstrings)將字串添加到工具列中。

1. 通過調用[AddButton](#addbuttons)向工具列添加按鈕結構。

1. 如果要在擁有者視窗中的工具列按鈕(不是`CFrameWnd`)中尋找工具提示,則需要處理工具列擁有者視窗中TTN_NEEDTEXT消息,如[「處理工具提示通知」](../../mfc/handling-tool-tip-notifications.md)中所述。 如果工具列的父視窗派生自`CFrameWnd`,則不會顯示工具提示,`CFrameWnd`因為提供了默認處理程式,因此無需進行任何額外工作。

1. 如果希望用戶能夠自定義工具列,請在擁有者視窗中處理自定義通知消息,如[處理自定義通知](../../mfc/handling-customization-notifications.md)中所述。

您可以使用[SaveState](#savestate)在註冊表和[RestoreState](#restorestate)中保存工具列控件的當前狀態,以便根據以前存儲在註冊表中的資訊還原狀態。 除了在應用程式使用之間保存工具列狀態外,應用程式通常在使用者開始自定義工具列之前存儲該狀態,以防用戶以後希望將工具列還原到其原始狀態。

## <a name="support-for-internet-explorer-version-40-and-later"></a>支援 IE 瀏覽器版本 4.0 及更高版本

為了支援 Internet Explorer 版本 4.0 及更高版本中引入的功能,MFC 為工具列控制件提供圖像清單支援以及透明和平面樣式。

透明工具列允許工具列下的用戶端顯示通過。 要創建透明工具列,請使用TBSTYLE_FLAT和TBSTYLE_TRANSPARENT樣式。 透明工具列具有熱跟蹤功能;也就是說,當滑鼠指標在工具列上的熱按鈕上移動時,按鈕的外觀會發生變化。 僅使用TBSTYLE_FLAT樣式創建的工具列將包含不透明的按鈕。

圖像清單支援允許對預設行為、熱圖像和禁用圖像進行更大的靈活性。 使用[GetImageList、GetHotImageList](#gethotimagelist)和[「取得禁用影像清單](#getdisabledimagelist)」使用透明工具列根據其[GetImageList](#getimagelist)狀態操作影像:

有關`CToolBarCtrl`使用的詳細資訊,請參閱[控制項](../../mfc/controls-mfc.md)[和使用 CToolBarCtrl](../../mfc/using-ctoolbarctrl.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CToolBarCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

## <a name="ctoolbarctrladdbitmap"></a><a name="addbitmap"></a>CToolBarCtrl:: 新增位元圖

將一個或多個按鈕圖像添加到工具列控制項中儲存的按鈕圖像清單中。

```
int AddBitmap(
    int nNumButtons,
    UINT nBitmapID);

int AddBitmap(
    int nNumButtons,
    CBitmap* pBitmap);
```

### <a name="parameters"></a>參數

*NNumButtons*<br/>
點陣圖中的按鈕圖像數。

*nBitmapID*<br/>
包含要添加的按鈕圖像或圖像的位圖的資源標識碼。

*pBitmap*<br/>
指向包含要`CBitmap`添加的按鈕圖像或圖像的物件的指標。

### <a name="return-value"></a>傳回值

第一個新圖像的零基索引(如果成功);否則 - 1。

### <a name="remarks"></a>備註

在將點陣圖添加到工具列之前,可以使用 Windows API[創建映射位映射](/windows/win32/api/commctrl/nf-commctrl-createmappedbitmap)來映射顏色。 如果將指標傳遞給`CBitMap`物件,則必須確保在銷毀工具列之前不會銷毀位圖。

## <a name="ctoolbarctrladdbuttons"></a><a name="addbuttons"></a>CToolBarCtrl:: 新增按鈕

將一個或多個按鈕添加到工具列控制項。

```
BOOL AddButtons(
    int nNumButtons,
    LPTBBUTTON lpButtons);
```

### <a name="parameters"></a>參數

*NNumButtons*<br/>
要添加的按鈕數。

*lpButtons*<br/>
包含要添加的按鈕`TBBUTTON`的資訊的結構陣列的位址。 陣列中的元素數必須與*nNumButton 指定的*按鈕數量相同。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

*lpButtons*指標指向結構陣列`TBBUTTON`。 每個`TBBUTTON`結構將新增的按鈕與按鈕的樣式、影像和/或字串、命令 ID、狀態和使用者定義的資料關聯:

```cpp
typedef struct _TBBUTTON {
    int iBitmap;    // zero-based index of button image
    int idCommand;  // command to be sent when button pressed
    BYTE fsState;   // button state--see below
    BYTE fsStyle;   // button style--see below
    DWORD dwData;   // application-defined value
    int iString;    // zero-based index of button label string
} TBBUTTON;
```

成員如下:

- `iBitmap`

   按鈕圖像的零索引,如果此按鈕沒有圖像,則為 -1。

- `idCommand`

   與按鈕關聯的命令標識碼。 選擇按鈕時,該標識符以WM_COMMAND消息發送。 如果`fsStyle`成員具有TBSTYLE_SEP值,則此成員必須為零。

- `fsState`

   按鈕狀態標誌。 它可以是下面列出的值的組合:

  - TBSTATE_CHECKED 按鈕具有TBSTYLE_CHECKED樣式,正在按下。

  - TBSTATE_ENABLED 該按鈕接受用戶輸入。 沒有此狀態的按鈕不接受使用者輸入,並且為灰色。

  - TBSTATE_HIDDEN 該按鈕不可見,無法接收用戶輸入。

  - TBSTATE_INDETERMINATE 該按鈕為灰色。

  - TBSTATE_PRESSED 按下按鈕。

  - TBSTATE_WRAP按鈕後面的換行符。 該按鈕還必須具有TBSTATE_ENABLED狀態。

- `fsStyle`

   按鈕樣式。 它可以是下面列出的值的組合:

  - TBSTYLE_BUTTON 創建標準按鈕。

  - TBSTYLE_CHECK 創建一個按鈕,每次使用者按下狀態和未按下狀態時切換該按鈕。 當按鈕處於按下狀態時,其背景顏色不同。

  - TBSTYLE_CHECKGROUP 創建一個檢查按鈕,直到按下組中的另一個按鈕。

  - TBSTYLE_GROUP 創建一個按鈕,直到按下組中的另一個按鈕。

  - TBSTYLE_SEP 創建分隔符,在按鈕組之間提供一個小間隙。 具有此樣式的按鈕不會接收使用者輸入。

- `dwData`

   使用者定義的數據。

- `iString`

   字串的零索引用作按鈕的標籤,如果此按鈕沒有字串,則為 -1。

提供索引的圖像和/或字串以前必須使用[AddBitmap、AddString](#addbitmap)和/或[AddString](#addstrings)添加到工具[AddString](#addstring)列控制項 清單中。

## <a name="ctoolbarctrladdstring"></a><a name="addstring"></a>CToolBarCtrl::添加String

將作為資源 ID 傳遞的新字串添加到工具列的內部字串清單中。

```
int AddString(UINT nStringID);
```

### <a name="parameters"></a>參數

*恩斯特林ID*<br/>
要加入工具列控制的字串清單的字串資源的資源識別碼。

### <a name="return-value"></a>傳回值

如果成功,則添加第一個新字串的零基索引;否則 -1。

## <a name="ctoolbarctrladdstrings"></a><a name="addstrings"></a>CToolBarCtrl:: 新增字串

將新字串或字串添加到可用於工具列控制件的字串清單中。

```
int AddStrings(LPCTSTR lpszStrings);
```

### <a name="parameters"></a>參數

*lpsz字串*<br/>
包含一個或多個要添加到工具列字串清單的空終止字串的緩衝區的位址。 最後一個字串必須用兩個空字元終止。

### <a name="return-value"></a>傳回值

如果成功,則添加第一個新字串的零基索引;否則 -1。

### <a name="remarks"></a>備註

緩衝區中的字串必須用空字元分隔。 必須確保最後一個字串具有兩個空終止符。 要正確格式化常量字串,可以將其編寫為:

[!code-cpp[NVC_MFCControlLadenDialog#72](../../mfc/codesnippet/cpp/ctoolbarctrl-class_1.cpp)]

或者：

[!code-cpp[NVC_MFCControlLadenDialog#73](../../mfc/codesnippet/cpp/ctoolbarctrl-class_2.cpp)]

不應將`CString`物件傳遞給此函數,因為不可能在`CString`中具有多個空字元。

## <a name="ctoolbarctrlautosize"></a><a name="autosize"></a>CToolBarCtrl:自動調整

調整整個工具列控制元件的大小。

```cpp
void AutoSize();
```

### <a name="remarks"></a>備註

當父視窗大小發生變化或工具列大小更改時(例如設置按鈕或位圖大小或添加字串時),應呼叫此函數。

## <a name="ctoolbarctrlchangebitmap"></a><a name="changebitmap"></a>CToolBarCtrl::更改位圖

更改當前工具列控制項中按鈕的點陣圖。

```
BOOL ChangeBitmap(
    int idButton,
    int iBitmap);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*idButton*|[在]要接收新點陣圖的按鈕的命令識別碼。|
|*iBitmap*|[在]當前工具列控制件的圖像清單中圖像的基於零的索引。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

如果此方法成功,系統將在指定的按鈕中顯示指定的圖像。

此方法發送[TB_CHANGEBITMAP](/windows/win32/Controls/tb-changebitmap)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼示例將 **「檔案儲存**」按鈕的位圖更改為 **「關於**」按鈕的點陣圖。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_3.cpp)]

## <a name="ctoolbarctrlcheckbutton"></a><a name="checkbutton"></a>CToolBarCtrl::檢查按鈕

檢查或清除工具列控制件中的給定按鈕。

```
BOOL CheckButton(
    int nID,
    BOOL bCheck = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要檢查或清除的按鈕的命令識別碼。

*b檢查*<br/>
TRUE 檢查按鈕,FALSE 將其清除。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

選中按鈕后,該按鈕似乎已按下。 如果要更改多個按鈕狀態,請考慮改為調用[SetState。](#setstate)

## <a name="ctoolbarctrlcommandtoindex"></a><a name="commandtoindex"></a>CToolBarctrl::命令索引

檢索與指定命令標識符關聯的按鈕的零基索引。

```
UINT CommandToIndex(UINT nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要查找其按鈕索引的命令 ID。

### <a name="return-value"></a>傳回值

與命令 ID 關聯的按鈕的零基索引。

### <a name="remarks"></a>備註

## <a name="ctoolbarctrlcreate"></a><a name="create"></a>CToolBarCtrl::建立

創建工具列控制項並將其附加到`CToolBarCtrl`物件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定工具列控制件的樣式。 工具欄必須始終具有WS_CHILD樣式。 此外,還可以指定工具列樣式和視窗樣式的任意組合,如**備註**項下所述。

*矩形*<br/>
可選地指定工具列控制的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/windows/win32/api/windef/ns-windef-rect)結構。

*pparentwnd*<br/>
指定工具列控制的父視窗。 它不得為 NULL。

*nID*<br/>
指定工具列控制項的識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

在兩個步驟`CToolBarCtrl`中構造 一個。 首先調用構造函數,然後調用`Create`,這將創建工具列控件並將其附加`CToolBarCtrl`到 物件。 將以下視窗樣式應用於工具列控制件。

- WS_CHILD始終

- WS_VISIBLE 通常

- WS_DISABLED很少

有關視窗樣式的說明,請參閱 Windows SDK 中[建立視窗](/windows/win32/api/winuser/nf-winuser-createwindoww)。

或者,應用[通用控件樣式](/windows/win32/Controls/common-control-styles)的組合,如 Windows SDK 中所述。

將工具列樣式的組合應用於控制項或按鈕本身。 這些樣式在 Windows SDK 中的主題[工具列控件和按鈕樣式](/windows/win32/Controls/toolbar-control-and-button-styles)中介紹。

要使用延伸工具列樣式,請呼叫`Create`後呼叫 Set[延伸樣式](#setextendedstyle)。 要建立式延伸視窗樣式的工具列,請致電[CToolBarCtrl::createEx](#createex)而不是`Create`。

工具列控制項會自動設定工具列視窗的大小和位置。 高度基於工具列中按鈕的高度。 寬度與父視窗工作區的寬度相同。 CCS_TOP和CCS_BOTTOM樣式確定工具列是沿工作區的頂部還是底部放置。 默認情況下,工具列具有CCS_TOP樣式。

## <a name="ctoolbarctrlcreateex"></a><a name="createex"></a>CToolBarCtrl::建立Ex

創建控制項(子視窗),並將其與`CToolBarCtrl`物件關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要創建的控制項的擴充樣式。 有關擴展 Windows 樣式的清單,請參閱 Windows SDK 中[創建 WindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定工具列控制件的樣式。 工具欄必須始終具有WS_CHILD樣式。 此外,還可以指定工具列樣式和視窗樣式的任意組合,如[「創建](#create)**」的備註**部分所述。

*矩形*<br/>
對[RECT](/windows/win32/api/windef/ns-windef-rect)結構的引用,描述要創建的視窗的大小和位置,在*pParentWnd*的用戶端座標中。

*pparentwnd*<br/>
指向控件的父視窗的指標。

*nID*<br/>
控制項的子視窗 ID。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而不是[「創建](#create)」來應用擴展的 Windows 樣式,該樣式由 Windows 擴充樣式前言**WS_EX_** 指定。 `CreateEx`使用*dwExStyle*指定的擴展 Windows 樣式創建控制項。 使用[Set 擴充樣式](#setextendedstyle)設定特定於控制項的擴充樣式。 例如,用於`CreateEx`將此類樣式設置為WS_EX_CONTEXTHELP,但用於`SetExtendedStyle`將此類樣式設置為TBSTYLE_EX_DRAWDDARROWS。 有關詳細資訊,請參閱 Windows SDK 中的[工具列擴充樣式中描述的樣式](/windows/win32/Controls/toolbar-extended-styles)。

## <a name="ctoolbarctrlctoolbarctrl"></a><a name="ctoolbarctrl"></a>CToolBarCtrl:CToolBarCtrl

建構 `CToolBarCtrl` 物件。

```
CToolBarCtrl();
```

### <a name="remarks"></a>備註

必須調用[Create](#create)以使工具列可用。

## <a name="ctoolbarctrlcustomize"></a><a name="customize"></a>CToolBarCtrl:自訂

顯示「自訂工具列」對話框。

```cpp
void Customize();
```

### <a name="remarks"></a>備註

此對話框允許用戶透過添加和刪除按鈕來自定義工具列。 要支援自定義,工具列的父窗口必須處理自定義通知消息,如[處理自定義通知](../../mfc/handling-customization-notifications.md)中所述。 工具列也必須使用CCS_ADJUSTABLE樣式創建,如[CToolBarCtrl::create](#create)中所述。

## <a name="ctoolbarctrldeletebutton"></a><a name="deletebutton"></a>CToolBarCtrl::DeleteButton

從工具列控制項中刪除按鈕。

```
BOOL DeleteButton(int nIndex);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要刪除的按鈕的零索引。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

## <a name="ctoolbarctrlenablebutton"></a><a name="enablebutton"></a>CToolBarCtrl:開啟按鈕

啟用或禁用工具列控制件中的指定按鈕。

```
BOOL EnableButton(
    int nID,
    BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要啟用或禁用按鈕的命令識別碼。

*b 啟用*<br/>
TRUE 啟用按鈕;FALSE 以禁用按鈕。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

啟用按鈕后,可以按下並檢查該按鈕。 如果要更改多個按鈕狀態,請考慮改為調用[SetState。](#setstate)

## <a name="ctoolbarctrlgetanchorhighlight"></a><a name="getanchorhighlight"></a>CToolBarCtrl::取得錨點突出顯示

檢索工具列的錨點高光設置。

```
BOOL GetAnchorHighlight() const;
```

### <a name="return-value"></a>傳回值

如果未為零,則啟用錨點突出顯示。 如果為零,則禁用錨點突出顯示。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_GETANCHORHIGHLIGHT](/windows/win32/Controls/tb-getanchorhighlight),如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetbitmap"></a><a name="getbitmap"></a>CToolBarCtrl::取得位元圖

檢索與工具列中的按鈕關聯的位圖的索引。

```
int GetBitmap(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要檢索其位圖索引的按鈕的命令標識碼。

### <a name="return-value"></a>傳回值

如果成功,則返回位圖的索引,否則返回零。

### <a name="remarks"></a>備註

在 Windows SDK 中實現[TB_GETBITMAP](/windows/win32/Controls/tb-getbitmap)的功能。

## <a name="ctoolbarctrlgetbitmapflags"></a><a name="getbitmapflags"></a>CToolBarCtrl::取得位式射標記

從工具列檢索位圖標誌。

```
UINT GetBitmapFlags() const;
```

### <a name="return-value"></a>傳回值

如果顯示螢幕可以支援大型工具列位圖,則具有TBBF_LARGE標誌集的 UINT,否則清除。

### <a name="remarks"></a>備註

應在創建工具列後,但在將位圖添加到工具列之前調用它。 返回值指示顯示器是否支援大點圖。 如果顯示支援大位圖,並且如果您選擇使用它們,請調用[SetBitmapSize 和](#setbitmapsize) [SetButtonSize,](#setbuttonsize)然後再使用[AddBitmap](#addbitmap)添加大點陣圖。

## <a name="ctoolbarctrlgetbutton"></a><a name="getbutton"></a>CToolBarCtrl:取得按鈕

檢索有關工具列控件中指定按鈕的資訊。

```
BOOL GetButton(
    int nIndex,
    LPTBBUTTON lpButton) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
用於檢索資訊的按鈕的零索引。

*lpButton*<br/>
要接收按鈕`TBBUTTON`資訊複本的結構的位址。 有關結構的資訊`TBBUTTON`, 請參考[CToolBarCtrl: 新增按鈕](#addbuttons)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlgetbuttoncount"></a><a name="getbuttoncount"></a>CToolBarCtrl::取得按鈕計數

檢索工具列控件中當前按鈕的計數。

```
int GetButtonCount() const;
```

### <a name="return-value"></a>傳回值

按鈕的計數。

## <a name="ctoolbarctrlgetbuttoninfo"></a><a name="getbuttoninfo"></a>CToolBarCtrl::取得按鈕資訊

檢索工具列中按鈕的資訊。

```
int GetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*普特比*<br/>
指向接收按鈕資訊的[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)結構的指標。

### <a name="return-value"></a>傳回值

按鈕的零基索引(如果成功);否則 -1。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETBUTTONINFO](/windows/win32/Controls/tb-getbuttoninfo)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetbuttonsize"></a><a name="getbuttonsize"></a>CToolBarCtrl:取得按鈕大小

獲取工具列按鈕的大小。

```
DWORD GetButtonSize() const;
```

### <a name="return-value"></a>傳回值

分別包含 LOWORD 和 HIWORD 中的寬度和高度值的 DWORD 值。

## <a name="ctoolbarctrlgetbuttontext"></a><a name="getbuttontext"></a>CToolBarCtrl:取得按鈕文字

檢索目前工具列控制項上指定按鈕的顯示文本。

```
CString GetButtonText(int idButton) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*idButton*|[在]其顯示文本檢索的按鈕的標識符。|

### <a name="return-value"></a>傳回值

包含指定按鈕的顯示文本的[CString。](../../atl-mfc-shared/using-cstring.md)

### <a name="remarks"></a>備註

此方法發送[TB_GETBUTTONTEXT](/windows/win32/Controls/tb-getbuttontext)訊息,這在 Windows SDK 中介紹。

## <a name="ctoolbarctrlgetcolorscheme"></a><a name="getcolorscheme"></a>CToolBarCtrl:取得顏色機制

檢索當前工具列控件的色彩配置。

```
BOOL GetColorScheme(COLORSCHEME* lpColorScheme) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*lpColor 計劃*|[出]指向接收顏色機制資訊的[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)結構的指標。 當此方法返回時,結構將描述工具列控件的高光顏色和陰影顏色。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TB_GETCOLORSCHEME](/windows/win32/Controls/tb-getcolorscheme)消息,這在 Windows SDK 中介紹。

## <a name="ctoolbarctrlgetdisabledimagelist"></a><a name="getdisabledimagelist"></a>CToolBarCtrl:取得關閉影像清單

檢索工具列控制項用於顯示禁用按鈕的圖像清單。

```
CImageList* GetDisabledImageList() const;
```

### <a name="return-value"></a>傳回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標,如果未設置禁用的圖像清單,則指向 NULL。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETDISABLEDIMAGELIST](/windows/win32/Controls/tb-getdisabledimagelist)的行為,如 Windows SDK 中所述。 的`GetDisabledImageList`MFC`CImageList`實現使用 包含工具列控制的按鈕影像的物件,而不是影像清單的句柄。

## <a name="ctoolbarctrlgetdroptarget"></a><a name="getdroptarget"></a>CToolBarCtrl::取得DropTarget

檢索工具列控件的[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)介面。

```
HRESULT GetDropTarget(IDropTarget** ppDropTarget) const;
```

### <a name="parameters"></a>參數

*ppDrop目標*<br/>
指向[IDropTarget](/windows/win32/api/oleidl/nn-oleidl-idroptarget)介面指標的指標。 如果發生錯誤,則在此位址中放置 NULL 指標。

### <a name="return-value"></a>傳回值

返回指示操作成功或失敗的 HRESULT 值。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETOBJECT](/windows/win32/Controls/tb-getobject)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetextendedstyle"></a><a name="getextendedstyle"></a>CToolBarCtrl::取得式延伸樣式

檢索工具列控件的擴展樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

表示工具列控制項目前使用的擴充樣式的 DWORD。 有關樣式清單,請參閱 Windows SDK 中的[工具列擴充樣式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETEXTENDEDSTYLE](/windows/win32/Controls/tb-getextendedstyle)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgethotimagelist"></a><a name="gethotimagelist"></a>CToolBarCtrl:取得HotImage清單

檢索工具列控制項用於顯示「熱」按鈕的圖像清單。 當滑鼠指標位於上方時,將顯示一個熱按鈕。

```
CImageList* GetHotImageList() const;
```

### <a name="return-value"></a>傳回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標,如果未設置禁用的圖像清單,則指向 NULL。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_GETHOTIMAGELIST](/windows/win32/Controls/tb-gethotimagelist),如 Windows SDK 中所述。 當滑鼠指標位於上方時,將顯示一個熱按鈕。

## <a name="ctoolbarctrlgethotitem"></a><a name="gethotitem"></a>CToolBarCtrl:取得Hot專案

檢索工具列中熱項的索引。

```
int GetHotItem() const;
```

### <a name="return-value"></a>傳回值

工具欄中熱項的零基索引。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETHOTITEM](/windows/win32/Controls/tb-gethotitem)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetimagelist"></a><a name="getimagelist"></a>CToolBarCtrl:抓取圖片清單

檢索工具列控制項用於以預設狀態顯示按鈕的圖像清單。

```
CImageList* GetImageList() const;
```

### <a name="return-value"></a>傳回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標,如果未設置影像清單,則為 NULL。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_GETIMAGELIST,](/windows/win32/Controls/tb-getimagelist)如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetinsertmark"></a><a name="getinsertmark"></a>CToolBarCtrl::取得插入標記

檢索工具列的當前插入標記。

```cpp
void GetInsertMark(TBINSERTMARK* ptbim) const;
```

### <a name="parameters"></a>參數

*普比姆*<br/>
指向接收插入標記的[TB INSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)結構的指標。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETINSERTMARK](/windows/win32/Controls/tb-getinsertmark)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CToolBarCtrl::取得插入標記顏色

檢索用於繪製工具列插入標記的顏色。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

包含目前插入標記顏色的 COLORREF 值。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETINSERTMARKCOLOR](/windows/win32/Controls/tb-getinsertmarkcolor)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetitemrect"></a><a name="getitemrect"></a>CToolBarCtrl::取得專案

檢索工具列控件中按鈕的邊界矩形。

```
BOOL GetItemRect(
    int nIndex,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nIndex*<br/>
用於檢索資訊的按鈕的零索引。

*lpRect*<br/>
接收邊界矩形座標的[RECT](/windows/win32/api/windef/ns-windef-rect)結構或[CRect](../../atl-mfc-shared/reference/crect-class.md)物件的位址。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此函數不檢索其狀態設置為TBSTATE_HIDDEN的按鈕的邊界矩形。

## <a name="ctoolbarctrlgetmaxsize"></a><a name="getmaxsize"></a>CToolBarCtrl:取得最大尺寸

檢索工具列中所有可見按鈕和分隔符的總大小。

```
BOOL GetMaxSize(LPSIZE pSize) const;
```

### <a name="parameters"></a>參數

*pSize*<br/>
指向接收項大小的[SIZE](/windows/win32/api/windef/ns-windef-size)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETMAXSIZE](/windows/win32/Controls/tb-getmaxsize)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetmaxtextrows"></a><a name="getmaxtextrows"></a>CToolBarCtrl::取得最大文字列

檢索工具列按鈕上顯示的最大文本行數。

```
int GetMaxTextRows() const;
```

### <a name="return-value"></a>傳回值

工具列按鈕上顯示的最大文本行數。

## <a name="ctoolbarctrlgetmetrics"></a><a name="getmetrics"></a>CToolBarCtrl:取得指標

檢索`CToolBarCtrl`物件的指標。

```cpp
void GetMetrics(LPTBMETRICS ptbm) const;
```

### <a name="parameters"></a>參數

*ptbm*<br/>
指向物件的[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)`CToolBarCtrl`結構的指標。

### <a name="remarks"></a>備註

此成員函數類比[TB_GETMETRICS](/windows/win32/Controls/tb-getmetrics)消息的功能,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetpadding"></a><a name="getpadding"></a>CToolBarCtrl::取得填充

檢索當前工具列控件的水準和垂直填充。

```
BOOL GetPadding(
    int* pnHorzPadding,
    int* pnVertPadding) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*pnHorzPadding*|[出]以像素為單位接收工具列控件的水準填充的整數。|
|*pnVertpadding*|[出]以像素為單位接收工具列控制件的垂直填充的整數。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TB_GETPADDING](/windows/win32/Controls/tb-getpadding)消息,這在 Windows SDK 中介紹。

## <a name="ctoolbarctrlgetpressedimagelist"></a><a name="getpressedimagelist"></a>CToolBarCtrl:抓取被壓影像清單

檢索當前工具列控制項用於表示處於按下狀態的按鈕的圖像清單。

```
CImageList* GetPressedImageList();
```

### <a name="return-value"></a>傳回值

指向包含當前控制項的影像清單的[CImageList 的](../../mfc/reference/cimagelist-class.md)指標,如果沒有設置此類影像清單,則指向 NULL。

### <a name="remarks"></a>備註

此方法發送[TB_GETPRESSEDIMAGELIST](/windows/win32/Controls/tb-getpressedimagelist)消息,這在 Windows SDK 中介紹。

## <a name="ctoolbarctrlgetrect"></a><a name="getrect"></a>CToolBarCtrl::取得Rect

檢索指定工具列按鈕的邊界矩形。

```
BOOL GetRect(
    int nID,
    LPRECT lpRect) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*lpRect*<br/>
指向[RECT](/windows/win32/api/windef/ns-windef-rect)結構的指標,用於接收邊界矩形資訊。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETRECT](/windows/win32/Controls/tb-getrect)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetrows"></a><a name="getrows"></a>CToolBarCtrl::取得

檢索工具列控制項目前顯示的按鈕行數。

```
int GetRows() const;
```

### <a name="return-value"></a>傳回值

工具列上目前顯示的按鈕行數。

### <a name="remarks"></a>備註

請注意,除非使用TBSTYLE_WRAPABLE樣式創建工具列,否則行數將始終為 1。

## <a name="ctoolbarctrlgetstate"></a><a name="getstate"></a>CToolBarCtrl:取得狀態

檢索有關工具列控件中指定按鈕的狀態的資訊,例如是啟用、按下還是選中該按鈕。

```
int GetState(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
要為其檢索資訊的按鈕的命令標識符。

### <a name="return-value"></a>傳回值

如果成功或 - 1,按鈕狀態資訊。 按鈕狀態資訊可以是[CToolBarCtrl 中列出的值的組合::addButton。](#addbuttons)

### <a name="remarks"></a>備註

如果要檢索多個按鈕狀態,此功能特別方便。 要檢查一個狀態,請使用以下成員函數之一:[啟用「正在按鈕](#isbuttonenabled)」、「[IsButtonHidden](#isbuttonhidden)[已選擇」 的「不在](#isbuttonchecked)[「「IsButton 不確定」。](#isbuttonindeterminate) [IsButtonPressed](#isbuttonpressed) 但是,`GetState`成員函數是檢測TBSTATE_WRAP按鈕狀態的唯一方法。

## <a name="ctoolbarctrlgetstring"></a><a name="getstring"></a>CToolBarCtrl::GetString

檢索工具列字串。

```
int GetString(
    int nString,
    LPTSTR lpstrString,
    int cchMaxLen) const;

int GetString(
    int nString,
    CString& str) const;
```

### <a name="parameters"></a>參數

*nString*<br/>
字串的索引。

*lpstrString*<br/>
指向用於返回字串的緩衝區的指標。

*chMaxLen*<br/>
緩衝區的長度(以位元組為單位)。

*Str*<br/>
字串。

### <a name="return-value"></a>傳回值

如果成功,字串的長度將 -1(如果不是)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_GETSTRING](/windows/win32/Controls/tb-getstring)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgetstyle"></a><a name="getstyle"></a>CToolBarCtrl::取得樣式

獲取當前應用於工具列控件的樣式。

```
DWORD GetStyle() const;
```

### <a name="return-value"></a>傳回值

包含[工具列控制樣式](/windows/win32/Controls/toolbar-control-and-button-styles)組合的 DWORD,如 Windows SDK 中所述。

## <a name="ctoolbarctrlgettooltips"></a><a name="gettooltips"></a>CToolBarCtrl:抓取工具提示

檢索與工具列控件關聯的工具尖端控制項的句柄(如果有)。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

如果工具列沒有關聯的工具提示控制項,則指向與此工具列關聯的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標或 NULL。

### <a name="remarks"></a>備註

由於工具列控件通常創建並維護其自己的工具提示控件,因此大多數程式不需要調用此函數。

## <a name="ctoolbarctrlhittest"></a><a name="hittest"></a>CToolBarCtrl:hitTest

確定點位於工具列控件的位置。

```
int HitTest(LPPOINT ppt) const;
```

### <a name="parameters"></a>參數

*Ppt*<br/>
指向[POINT](/windows/win32/api/windef/ns-windef-point)結構的指標,該結構`x`包含成員中命中測試的 x`y`座標和 成員中命中測試的 y 座標。 坐標相對於工具列的工作區。

### <a name="return-value"></a>傳回值

指示點在工具列上的位置的整數值。 如果該值為零或為正值,則此返回值是點所在的非分離器項的零基索引。

如果返回值為負,則點不在按鈕內。 返回值的絕對值是分隔符項或最近的非分離項的索引。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_HITTEST](/windows/win32/Controls/tb-hittest)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlhidebutton"></a><a name="hidebutton"></a>CToolBarCtrl:隱藏按鈕

在工具列控制項中隱藏或顯示指定的按鈕。

```
BOOL HideButton(
    int nID,
    BOOL bHide = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要隱藏或顯示的按鈕的命令識別碼。

*bHide*<br/>
TRUE 隱藏按鈕,FALSE 顯示它。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果要更改多個按鈕狀態,請考慮改為調用[SetState。](#setstate)

## <a name="ctoolbarctrlindeterminate"></a><a name="indeterminate"></a>CToolBarctrl::不確定

設置或清除工具列控制項中指定按鈕的不確定狀態。

```
BOOL Indeterminate(
    int nID,
    BOOL bIndeterminate = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
要設置或清除其不確定狀態的按鈕的命令識別碼。

*b 不確定*<br/>
TRUE 設置為指定按鈕的不確定狀態,FALSE 將其清除。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

不確定按鈕顯示為灰色,例如當所選文本同時包含粗體字元和常規字元時,字處理器工具列上的粗體按鈕的外觀。 如果要更改多個按鈕狀態,請考慮改為調用[SetState。](#setstate)

## <a name="ctoolbarctrlinsertbutton"></a><a name="insertbutton"></a>CToolBarCtrl::插入按鈕

在工具列控制項中插入按鈕。

```
BOOL InsertButton(
    int nIndex,
    LPTBBUTTON lpButton);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
按鈕的零索引。 此功能在此按鈕左側插入新按鈕。

*lpButton*<br/>
包含要插入`TBBUTTON`的按鈕資訊的結構的位址。 有關`TBBUTTON`結構的說明,請參閱[CToolBarCtrl:新增按鈕](#addbuttons)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

提供索引的圖像和/或字串以前必須使用[AddBitmap、AddString](#addbitmap)和/或[AddString](#addstrings)添加到工具[AddString](#addstring)列控制項 清單中。

## <a name="ctoolbarctrlinsertmarkhittest"></a><a name="insertmarkhittest"></a>CToolBarCtrl::插入標記命中測試

檢索工具列中點的插入標記資訊。

```
BOOL InsertMarkHitTest(
    LPPOINT ppt,
    LPTBINSERTMARK ptbim) const;
```

### <a name="parameters"></a>參數

*Ppt*<br/>
指向 POINT[結構的](/windows/win32/api/windef/ns-windef-point)指標,該結構包含命中測試座標,相對於工具列的工作區區域。

*普比姆*<br/>
指向接收插入標記資訊的[TB INSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_INSERTMARKHITTEST](/windows/win32/Controls/tb-insertmarkhittest)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlisbuttonchecked"></a><a name="isbuttonchecked"></a>CToolBarCtrl::是按鈕檢查

確定是否選擇的工具列控制檔中的指定按鈕。

```
BOOL IsButtonChecked(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果選中按鈕,則非零;否則為零。

### <a name="remarks"></a>備註

如果要檢索多個按鈕狀態,請考慮調用[GetState。](#getstate)

## <a name="ctoolbarctrlisbuttonenabled"></a><a name="isbuttonenabled"></a>CToolBarCtrl:即啟用按鈕

確定是否啟用了工具列控制件中的指定按鈕。

```
BOOL IsButtonEnabled(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果啟用了按鈕,則非零;否則為零。

### <a name="remarks"></a>備註

如果要檢索多個按鈕狀態,請考慮調用[GetState。](#getstate)

## <a name="ctoolbarctrlisbuttonhidden"></a><a name="isbuttonhidden"></a>CToolBarCtrl::是按鈕隱藏

確定工具列控制件中的指定按鈕是否隱藏。

```
BOOL IsButtonHidden(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕隱藏,則非零;否則為零。

### <a name="remarks"></a>備註

如果要檢索多個按鈕狀態,請考慮調用[GetState。](#getstate)

## <a name="ctoolbarctrlisbuttonhighlighted"></a><a name="isbuttonhighlighted"></a>CToolBarCtrl::按鍵突出顯示

檢查工具列按鈕的突出顯示狀態。

```
BOOL IsButtonHighlighted(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]工具列按鈕的命令 ID。

### <a name="return-value"></a>傳回值

如果按鈕高亮顯示,則為正整數;如果未突出顯示按鈕,則為 0;如果發生錯誤,則為 -1。

## <a name="ctoolbarctrlisbuttonindeterminate"></a><a name="isbuttonindeterminate"></a>CToolBarctrl::是按鈕不確定

確定工具列控制項中的指定按鈕是否不確定。

```
BOOL IsButtonIndeterminate(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按鈕不確定,則為正整數;如果按鈕不確定為零;如果發生錯誤,為 -1。

### <a name="remarks"></a>備註

不確定按鈕顯示為灰色,例如當所選文本同時包含粗體和常規字元時,字處理器工具列上的粗體按鈕的外觀。 如果要檢索多個按鈕狀態,請考慮調用[GetState。](#getstate)

## <a name="ctoolbarctrlisbuttonpressed"></a><a name="isbuttonpressed"></a>CToolBarCtrl::按鍵

確定是否按下工具列控制件中的指定按鈕。

```
BOOL IsButtonPressed(int nID) const;
```

### <a name="parameters"></a>參數

*nID*<br/>
工具列中按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果按下按鈕,則非零,否則為零。

### <a name="remarks"></a>備註

如果要檢索多個按鈕狀態,請考慮調用[GetState。](#getstate)

## <a name="ctoolbarctrlloadimages"></a><a name="loadimages"></a>CToolBarCtrl::載入影像

將點陣圖載入到工具列控制的影像清單中。

```cpp
void LoadImages(
    int iBitmapID,
    HINSTANCE hinst);
```

### <a name="parameters"></a>參數

*iBitmapID*<br/>
包含要載入的影像的點陣圖的 ID。 要指定自己的位圖資源,請為此參數設置為位圖資源的 ID,並將*hInst*設置為 NULL。 您的點陣圖資源將作為單個圖像添加到圖像清單中。 使用*hinst*設定為HINST_COMMCTRL並將此參數設定為以下 ID 之一,可以新增標準、系統定義的位圖:

|點陣圖代碼|描述|
|---------------|-----------------|
|IDB_HIST_LARGE_COLOR|大型資源管理員點陣圖|
|IDB_HIST_SMALL_COLOR|資源管理員圖|
|IDB_STD_LARGE_COLOR|大尺寸的標準點陣圖|
|IDB_STD_SMALL_COLOR|小尺寸的標準點陣圖|
|IDB_VIEW_LARGE_COLOR|檢視大尺寸點陣圖|
|IDB_VIEW_SMALL_COLOR|檢視小尺寸點陣圖|

*欣斯特*<br/>
對調用應用程式的程式實例句柄。 可以HINST_COMMCTRL此參數來載入標準映像清單。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_LOADIMAGES](/windows/win32/Controls/tb-loadimages)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlmapaccelerator"></a><a name="mapaccelerator"></a>CToolBarCtrl::地圖加速器

將快捷鍵字元映射到工具列按鈕。

```
BOOL MapAccelerator(
    TCHAR chAccel,
    UINT* pIDBtn);
```

### <a name="parameters"></a>參數

*查克爾*<br/>
要映射的加速器字元。 此字元與按鈕文本中帶下劃線字元的字元相同。

*pIDBtn*<br/>
指向 UINT 的指標,該指標接收對應於*chAccel*中指定的加速器的按鈕的命令識別碼。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_MAPACCELERATOR](/windows/win32/Controls/tb-mapaccelerator),如 Windows SDK 中所述。

## <a name="ctoolbarctrlmarkbutton"></a><a name="markbutton"></a>CToolBarCtrl::標記按鈕

設置工具列控制項中給定按鈕的突出顯示狀態。

```
BOOL MarkButton(
    int nID,
    BOOL fHighlight = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*f 突顯*<br/>
指定要設置的高光狀態。 預設情況下,TRUE。 如果設置為 FALSE,則按鈕將設置為其預設狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_MARKBUTTON](/windows/win32/Controls/tb-markbutton)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlmovebutton"></a><a name="movebutton"></a>CToolBarCtrl:: 移動按鈕

將按鈕從一個索引移動到另一個索引。

```
BOOL MoveButton(
    UINT nOldPos,
    UINT nNewPos);
```

### <a name="parameters"></a>參數

*內奧德波斯*<br/>
要移動的按鈕的零基索引。

*N 紐波斯*<br/>
按鈕目標的零基索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_MOVEBUTTON](/windows/win32/Controls/tb-movebutton)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlpressbutton"></a><a name="pressbutton"></a>CToolBarCtrl::PresButton

按下或釋放工具列控制件中的指定按鈕。

```
BOOL PressButton(int nID, BOOL bPress = TRUE);
```

### <a name="parameters"></a>參數

*nID*<br/>
[在]要按下或釋放按鈕的命令標識符。

*bPress*<br/>
[在]TRUE 以按指定的按鈕;FALSE 以釋放指定的按鈕。 預設值為 TRUE。

### <a name="return-value"></a>傳回值

如果方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

如果要更改多個按鈕狀態,請考慮改為調用[SetState。](#setstate)

此方法發送[TB_PRESSBUTTON](/windows/win32/Controls/tb-pressbutton)訊息,這在 Windows SDK 中介紹。

## <a name="ctoolbarctrlreplacebitmap"></a><a name="replacebitmap"></a>CToolBarCtrl::取代位圖

將當前工具列控制件中的現有點陣圖替換為新的點陣圖。

```
BOOL ReplaceBitmap(LPTBREPLACEBITMAP pReplaceBitmap);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*p 取代點陣圖*|[在]指向[TBREPLACEBITMAP](/windows/win32/api/commctrl/ns-commctrl-tbreplacebitmap)結構的指標,該結構描述要替換的位圖和新的位圖。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TB_REPLACEBITMAP](/windows/win32/Controls/tb-replacebitmap)訊息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼示例將標準工具列的位圖替換為不同的位圖。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_4.cpp)]

## <a name="ctoolbarctrlrestorestate"></a><a name="restorestate"></a>CToolBarCtrl::恢復狀態

從參數指定的註冊表中的位置還原工具列控件的狀態。

```cpp
void RestoreState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別註冊表中目前開啟的金鑰或以下任何預定義的保留句柄值:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubkey*<br/>
包含與該值關聯的子鍵的名稱的 null 連接端接字串。 這裡可以是 null 或指向空字串的指標。 如果參數為 NULL,則該值將添加到*hKeyRoot*參數標識的鍵中。

*lpszValue名稱*<br/>
指向包含要檢索的值的名稱的字串。 如果具有此名稱的值在鍵中不存在,則函數將其添加到鍵中。

## <a name="ctoolbarctrlsavestate"></a><a name="savestate"></a>CToolBarCtrl::儲存狀態

將工具列控制器的狀態保存在參數指定的註冊表中的位置。

```cpp
void SaveState(
    HKEY hKeyRoot,
    LPCTSTR lpszSubKey,
    LPCTSTR lpszValueName);
```

### <a name="parameters"></a>參數

*hKeyRoot*<br/>
識別註冊表中目前開啟的金鑰或以下任何預定義的保留句柄值:

- HKEY_CLASSES_ROOT

- HKEY_CURRENT_USER

- HKEY_LOCAL_MACHINE

- HKEY_USERS

*lpszSubkey*<br/>
包含與該值關聯的子鍵的名稱的 null 連接端接字串。 這裡可以是 null 或指向空字串的指標。 如果參數為 NULL,則該值將添加到*hKeyRoot*參數標識的鍵中。

*lpszValue名稱*<br/>
指向包含要設定的值名稱的字串。 如果具有此名稱的值在鍵中不存在,則函數將其添加到鍵中。

## <a name="ctoolbarctrlsetanchorhighlight"></a><a name="setanchorhighlight"></a>CToolBarCtrl::設置錨點高光

設置工具列的錨點高光設置。

```
BOOL SetAnchorHighlight(BOOL fAnchor = TRUE);
```

### <a name="parameters"></a>參數

*fAnchor*<br/>
[在]指定是啟用或禁用錨點突出顯示。 如果此值為非零,則將啟用錨點突出顯示。 如果此值為零,將禁用錨點突出顯示

### <a name="return-value"></a>傳回值

上一個錨點設置。 如果啟用了突出顯示,則此值為非零。 如果未啟用突出顯示,則此值為零。

### <a name="remarks"></a>備註

此方法實現 Win32 消息[TB_SETANCHORHIGHLIGHT](/windows/win32/Controls/tb-setanchorhighlight)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetbitmapsize"></a><a name="setbitmapsize"></a>CToolBarCtrl::設定點陣圖大小

設置要添加到工具列控制件的實際位映射影像的大小。

```
BOOL SetBitmapSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
位映射圖像的寬度和高度(以像素為單位)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

只有在向工具列添加任何位圖之前,才能調用此功能。 如果應用程式未顯式設置位圖大小,則預設為 16 x 15 圖元。

## <a name="ctoolbarctrlsetbuttoninfo"></a><a name="setbuttoninfo"></a>CToolBarCtrl::設定按鈕資訊

設置工具列中現有按鈕的資訊。

```
BOOL SetButtonInfo(
    int nID,
    TBBUTTONINFO* ptbbi);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕識別碼。

*普特比*<br/>
指向接收按鈕資訊的[TBBUTTONINFO](/windows/win32/api/commctrl/ns-commctrl-tbbuttoninfow)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

成員函數實現 Win32 消息[TB_SETBUTTONINFO](/windows/win32/Controls/tb-setbuttoninfo)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetbuttonsize"></a><a name="setbuttonsize"></a>CToolBarCtrl::設定按鈕大小

設置工具列控制項中按鈕的大小。

```
BOOL SetButtonSize(CSize size);
```

### <a name="parameters"></a>參數

*size*<br/>
按鈕的寬度和高度(以像素為單位)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

按鈕大小必須始終至少與它所包含的位圖大小一樣大。 只有在向工具列添加任何位圖之前,才能調用此功能。 如果應用程式未顯式設置按鈕大小,則預設為 24 x 22 圖元。

### <a name="example"></a>範例

  請參閱[CToolBar 的範例:獲取工具列。](../../mfc/reference/ctoolbar-class.md#gettoolbarctrl)

## <a name="ctoolbarctrlsetbuttonstructsize"></a><a name="setbuttonstructsize"></a>CToolBarctrl::設定按鈕的大小

指定結構的大小`TBBUTTON`。

```cpp
void SetButtonStructSize(int nSize);
```

### <a name="parameters"></a>參數

*nSize*<br/>
`TBBUTTON`結構的大小(以位元組為單位)。

### <a name="remarks"></a>備註

如果要在`TBBUTTON`結構中存儲額外的數據,可以從 中派生新`TBBUTTON`結構 ,添加所需的成員,或者創建一`TBBUTTON`個包含結構作為其第一個成員的新結構。 然後,您將調用此函數告訴工具列控制新結構的大小。

有關`TBBUTTON`結構的詳細資訊,請參閱[CToolBarCtrl:新增按鈕](#addbuttons)。

## <a name="ctoolbarctrlsetbuttonwidth"></a><a name="setbuttonwidth"></a>CToolBarCtrl::設定按鈕寬度

設置工具列控制件中的最小和最大按鈕寬度。

```
BOOL SetButtonWidth(
    int cxMin,
    int cxMax);
```

### <a name="parameters"></a>參數

*cxMin*<br/>
最小按鈕寬度(以像素為單位)。 工具列按鈕永遠不會比此值窄。

*cxMax*<br/>
最大按鈕寬度(以像素為單位)。 如果按鈕文本太寬,控件將顯示它與省略點。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_SETBUTTONWIDTH](/windows/win32/Controls/tb-setbuttonwidth)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetcmdid"></a><a name="setcmdid"></a>CToolBarCtrl::SetCmdID

設定按下指定按鈕時將發送到所有者視窗的命令識別碼。

```
BOOL SetCmdID(
    int nIndex,
    UINT nID);
```

### <a name="parameters"></a>參數

*nIndex*<br/>
要設置其命令 ID 的按鈕的零基索引。

*nID*<br/>
要將選擇按鈕設定為的命令 ID。

### <a name="return-value"></a>傳回值

如果成功,則返回非零;否則為零。

## <a name="ctoolbarctrlsetcolorscheme"></a><a name="setcolorscheme"></a>CToolBarCtrl::設定顏色機制

設置當前工具列控件的色彩配置。

```cpp
void SetColorScheme(const COLORSCHEME* lpColorScheme);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*lpColor 計劃*|[在]指向描述工具列控制件的高光顏色和陰影顏色的[COLORSCHEME](/windows/win32/api/commctrl/ns-commctrl-colorscheme)結構的指標。|

### <a name="remarks"></a>備註

如果設置了 Windows Vista 視覺主題,則此方法不起作用。

此方法發送[TB_SETCOLORSCHEME](/windows/win32/Controls/tb-setcolorscheme)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼示例設置當前工具列控制項的色彩配置。 代碼示例使每個工具按鈕的左邊緣和上邊緣為紅色,右邊緣和下邊緣為藍色。 當使用者按下按鈕時,按鈕的紅色邊緣變為藍色,其藍色邊緣變為紅色。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_5.cpp)]

## <a name="ctoolbarctrlsetdisabledimagelist"></a><a name="setdisabledimagelist"></a>CToolBarCtrl::設定關閉影像清單

設定工具列控制項將用於顯示禁用按鈕的圖像清單。

```
CImageList* SetDisabledImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指向包含工具列控制件`CImageList`用於顯示禁用按鈕圖像的圖像的物件的指標。

### <a name="return-value"></a>傳回值

指向以前由工具列控制件用於顯示禁用按鈕圖像的[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_SETDISABLEDIMAGELIST](/windows/win32/Controls/tb-setdisabledimagelist),如 Windows SDK 中所述。 的`SetDisabledImageList`MFC`CImageList`實現使用 包含工具列控制項關閉按鈕影像的物件,而不是影像清單的句柄。

## <a name="ctoolbarctrlsetdrawtextflags"></a><a name="setdrawtextflags"></a>CToolBarCtrl::設定繪製文字標誌

設定 Win32 函數[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中的標誌 ,用於在指定的矩形中繪製文本,根據標誌的設置方式進行格式化。

```
DWORD SetDrawTextFlags(
    DWORD dwMask,
    DWORD dwDTFlags);
```

### <a name="parameters"></a>參數

*dwMask*<br/>
Win32 函數[DrawText](/windows/win32/api/winuser/nf-winuser-drawtext)中指定的一個或多個DT_標誌的組合,指示在繪製文本時將使用*dwDTFlags*中的哪些位。

*dwDTFlags*<br/>
Win32 函`DrawText`數 中指定的一個或多個DT_標誌的組合,指示按鈕文本的繪製方式。 繪製按鈕文字`DrawText`時,此值將傳遞給該值。

### <a name="return-value"></a>傳回值

包含前一個文字繪圖標誌的 DWORD。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_SETDRAWTEXTFLAGS](/windows/win32/Controls/tb-setdrawtextflags),如 Windows SDK 中所述。 此成員函數設置 Win32 函數`DrawText`中的標誌 ,該函數在指定的矩形中繪製文本,根據標誌的設置方式進行格式化。

## <a name="ctoolbarctrlsetextendedstyle"></a><a name="setextendedstyle"></a>CToolBarCtrl::設定式延伸樣式

設置工具列控件的擴展樣式。

```
DWORD SetExtendedStyle(DWORD dwExStyle);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定新擴展樣式的值。 此參數可以是工具列擴展樣式的組合。

### <a name="return-value"></a>傳回值

表示以前擴展樣式的 DWORD。 有關樣式清單,請參閱 Windows SDK 中的[工具列擴充樣式](/windows/win32/Controls/toolbar-extended-styles)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_SETEXTENDEDSTYLE](/windows/win32/Controls/tb-setextendedstyle)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsethotimagelist"></a><a name="sethotimagelist"></a>CToolBarCtrl::設定HotImage清單

設定工具列控制項將用於顯示「熱」按鈕的圖像清單。

```
CImageList* SetHotImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指向包含工具列控制件`CImageList`用於顯示熱按鈕圖像的圖像的物件的指標。

### <a name="return-value"></a>傳回值

指向以前由工具列控制件用於顯示熱按鈕圖像的[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_SETHOTIMAGELIST](/windows/win32/Controls/tb-sethotimagelist)的行為,如 Windows SDK 中所述。

的`SetHotImageList`MFC`CImageList`實現使用 包含工具列控制的熱按鈕影像的物件,而不是影像清單的句柄。 當指標位於其上方時,將顯示一個熱按鈕突出顯示。

## <a name="ctoolbarctrlsethotitem"></a><a name="sethotitem"></a>CToolBarCtrl::設定Hot專案

在工具列中設置熱項。

```
int SetHotItem(int nHot);
```

### <a name="parameters"></a>參數

*nHot*<br/>
將變得熱的項的零基索引編號。 如果此值為 -1,則任何項都不會是熱的。

### <a name="return-value"></a>傳回值

上一個熱項的索引,如果沒有熱項,則為 -1。

### <a name="remarks"></a>備註

此成員函數實現 win32 消息[TB_SETHOTITEM](/windows/win32/Controls/tb-sethotitem)的行為,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetimagelist"></a><a name="setimagelist"></a>CToolBarCtrl::設定影像清單

設定工具列用於顯示處於預設狀態的按鈕的圖像清單。

```
CImageList* SetImageList(CImageList* pImageList);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指向`CImageList`工具列控制項用於以顯示其預設狀態的按鈕圖像的物件的指標。

### <a name="return-value"></a>傳回值

指向[CImageList](../../mfc/reference/cimagelist-class.md)物件的指標,以前工具列控制項用於以顯示其預設狀態的按鈕影像。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TB_SETIMAGELIST](/windows/win32/Controls/tb-setimagelist)的行為,如 Windows SDK 中所述。

的`SetImageList`MFC`CImageList`實現使用 包含工具列控制的按鈕影像的物件,而不是影像清單的句柄。

## <a name="ctoolbarctrlsetindent"></a><a name="setindent"></a>CToolBarctrl:setindent

設置工具列控制項中第一個按鈕的縮進。

```
BOOL SetIndent(int iIndent);
```

### <a name="parameters"></a>參數

*iindent*<br/>
指定縮進的值(以像素為單位)。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlsetinsertmark"></a><a name="setinsertmark"></a>CToolBarCtrl::設定插入標記

設定工具列的目前插入標記。

```cpp
void SetInsertMark(TBINSERTMARK* ptbim);
```

### <a name="parameters"></a>參數

*普比姆*<br/>
指向包含插入標記的[TB INSERTMARK](/windows/win32/api/commctrl/ns-commctrl-tbinsertmark)結構的指標。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_SETINSERTMARK,](/windows/win32/Controls/tb-setinsertmark)如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CToolBarCtrl::設定插入標記顏色

設置用於繪製工具列插入標記的顏色。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
包含新插入標記顏色的 COLORREF 值。

### <a name="return-value"></a>傳回值

包含前一個插入標記顏色的 COLORREF 值。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[的行為TB_SETINSERTMARKCOLOR](/windows/win32/Controls/tb-setinsertmarkcolor),如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetmaxtextrows"></a><a name="setmaxtextrows"></a>CToolBarCtrl::設定MaxTextRows

設定工具列按鈕上顯示的最大文本行數。

```
BOOL SetMaxTextRows(int iMaxRows);
```

### <a name="parameters"></a>參數

*iMaxRows*<br/>
要設置的最大行數。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

## <a name="ctoolbarctrlsetmetrics"></a><a name="setmetrics"></a>CToolBarCtrl::設定指標

設置`CToolBarCtrl`物件的指標。

```cpp
void SetMetrics(LPTBMETRICS ptbm);
```

### <a name="parameters"></a>參數

*ptbm*<br/>
指向物件的[TBMETRICS](/windows/win32/api/commctrl/ns-commctrl-tbmetrics)`CToolBarCtrl`結構的指標。

### <a name="remarks"></a>備註

此成員函數類比[TB_SETMETRICS](/windows/win32/Controls/tb-setmetrics)消息的功能,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsetowner"></a><a name="setowner"></a>CToolBarCtrl::SetOwner

設置工具列控制者的擁有者視窗。

```cpp
void SetOwner(CWnd* pWnd);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
指向`CWnd``CWnd`或 派生物件的指標,該物件將成為工具列控制件的新擁有者視窗。

### <a name="remarks"></a>備註

擁有者視窗是從工具列接收通知的視窗。

## <a name="ctoolbarctrlsetpadding"></a><a name="setpadding"></a>CToolBarCtrl::設定

設置當前工具列控制件的水準和垂直填充。

```
DWORD SetPadding(
    int nHorzPadding,
    int nVertPadding);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*nHorzPadding*|[在]指定工具列控制項的水平填充(以像素為單位)。|
|*nVertPadding*|[在]指定工具列控制元件的垂直填充(以像素為單位)。|

### <a name="return-value"></a>傳回值

低字包含上一個水準填充值的 DWORD,其高字包含以前的垂直填充值。 填充值以像素為單位進行測量。

### <a name="remarks"></a>備註

此方法發送[TB_SETPADDING](/windows/win32/Controls/tb-setpadding)訊息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼示例將當前工具列控制件的水準和垂直填充集為 20 圖元。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_6.cpp)]

## <a name="ctoolbarctrlsetpressedimagelist"></a><a name="setpressedimagelist"></a>CToolBarCtrl::設定被壓抑的影像清單

設定當前工具列控制項用於表示處於按下狀態的按鈕的圖像清單。

```
CImagelist* SetPressedImageList(
    int iImageID,
    CImageList* pImageList);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*iImageID*|[在]圖像清單的零基索引。 如果僅使用一個圖像清單,則此參數將設置為零。|
|*pImageList*|[在]指向包含新圖像清單的[CImageList 的](../../mfc/reference/cimagelist-class.md)指標。|

### <a name="return-value"></a>傳回值

指向包含當前控制項的上一個影像清單的[CImageList](../../mfc/reference/cimagelist-class.md)的指標,如果沒有設置此類影像清單,則指向 NULL。

### <a name="remarks"></a>備註

此方法發送[TB_SETPRESSEDIMAGELIST](/windows/win32/Controls/tb-setpressedimagelist)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼示例將按下的圖像清單設置為與預設圖像清單相同的圖像清單。

[!code-cpp[NVC_MFC_CToolBarCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctoolbarctrl-class_7.cpp)]

## <a name="ctoolbarctrlsetrows"></a><a name="setrows"></a>CToolBarCtrl::SetRows

要求工具列控件調整自身大小以調整為請求的行數。

```cpp
void SetRows(
    int nRows,
    BOOL bLarger,
    LPRECT lpRect);
```

### <a name="parameters"></a>參數

*nRows*<br/>
請求的行數。

*b 更大*<br/>
如果工具列無法調整為請求的行數,則說明是使用更多行還是減少行。

*lpRect*<br/>
指向將接收工具列的新邊界矩形的[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/windows/win32/api/windef/ns-windef-rect)結構。

### <a name="remarks"></a>備註

如果工具列無法將自身大小調整到請求的數位或行,則根據*bLarger*的值,它將調整自身大小以下一個較大的或下一個較小的有效大小。 如果*b 大比較為*TRUE,則新行數將大於請求的行數。 如果*b 更大*為 FALSE,則新行數將小於請求的數量。

如果可以排列按鈕,使所有行具有相同的按鈕數(可能最後一行除外),則給定數量的行對工具列有效。 例如,包含四個按鈕的工具列不能調整為三行,因為最後兩行必須變短。 如果嘗試將其大小調整為三行,則如果*b大比較*為 TRUE,則獲得四行;如果*b"較大"* 為 FALSE,則獲取兩行。

如果工具列中有分隔符,則給定行數有效時的規則會更加複雜。 計算佈局時,按鈕組(在組中第一個和最後一個按鈕之前帶有分隔符的按鈕)永遠不會在數行上分解,除非組不能容納一行。

如果組不適合一行,則下一個組將從下一行開始,即使它適合大型組結束的行。 此規則的目的是使大型組之間的分離更加明顯。 生成的垂直分隔符計為行。

另請注意,`SetRows`成員函數將始終選擇導致最小工具列大小的佈局。 使用TBSTYLE_WRAPABLE樣式創建工具列,然後調整控制件大小,只需應用上述方法,給定控制件的寬度。

只能為使用TBSTYLE_WRAPABLE樣式創建的工具列調用此功能。

## <a name="ctoolbarctrlsetstate"></a><a name="setstate"></a>CToolBarCtrl::設定狀態

設定工具列控制項中指定按鈕的狀態。

```
BOOL SetState(
    int nID,
    UINT nState);
```

### <a name="parameters"></a>參數

*nID*<br/>
按鈕的命令識別碼。

*n州*<br/>
州標誌。 它可以是[CToolBarCtrl 中](#addbuttons)為按鈕狀態列出的值的組合::addButton。

### <a name="return-value"></a>傳回值

如果成功則不為零，否則為 0。

### <a name="remarks"></a>備註

如果要設置多個按鈕狀態,此功能特別方便。 要設定一種狀態,請使用以下成員函數之一:[開啟按鈕](#enablebutton),[檢查按鈕](#checkbutton),[隱藏按鈕](#hidebutton),[不確定](#indeterminate)或[按按鈕](#pressbutton)。

## <a name="ctoolbarctrlsetstyle"></a><a name="setstyle"></a>CToolBarCtrl::設定樣式

設置工具列控件的樣式。

```cpp
void SetStyle(DWORD dwStyle);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
包含[工具列控制樣式](/windows/win32/Controls/toolbar-control-and-button-styles)組合的 DWORD,如 Windows SDK 中所述。

## <a name="ctoolbarctrlsettooltips"></a><a name="settooltips"></a>CToolBarCtrl::設定工具提示

將工具尖端控制件與工具列控制件關聯。

```cpp
void SetToolTips(CToolTipCtrl* pTip);
```

### <a name="parameters"></a>參數

*pTip*<br/>
指向[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。

## <a name="ctoolbarctrlsetwindowtheme"></a><a name="setwindowtheme"></a>CToolBarctrl::設定視窗主題

設置`CToolBarCtrl`物件的可視樣式。

```
HRESULT SetWindowTheme(LPCWSTR pszSubAppName);
```

### <a name="parameters"></a>參數

*pssSubApp 名稱*<br/>
指向要設置的工具列視覺樣式的 Unicode 字串的指標。

### <a name="return-value"></a>傳回值

不使用返回值。

### <a name="remarks"></a>備註

此成員函數類比[TB_SETWINDOWTHEME](/windows/win32/Controls/tb-setwindowtheme)訊息的功能,如 Windows SDK 中所述。

## <a name="see-also"></a>另請參閱

[MFC 樣品 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[MFC 範例 MFCIE](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CToolBar 類別](../../mfc/reference/ctoolbar-class.md)
