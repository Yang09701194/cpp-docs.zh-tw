---
title: CTreeCtrl 類別 |Microsoft 文件
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
dev_langs:
- C++
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 16eaca3857687e7039391cf15472a5a68b25a5c6
ms.sourcegitcommit: 208d445fd7ea202de1d372d3f468e784e77bd666
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 06/29/2018
ms.locfileid: "37123158"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class
提供 Windows 通用樹狀檢閱控制項的功能。  
  
## <a name="syntax"></a>語法  
  
```  
class CTreeCtrl : public CWnd  
```  
  
## <a name="members"></a>成員  
  
### <a name="public-constructors"></a>公用建構函式  
  
|名稱|描述|  
|----------|-----------------|  
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|建構 `CTreeCtrl` 物件。|  
  
### <a name="public-methods"></a>公用方法  
  
|名稱|描述|  
|----------|-----------------|  
|[CTreeCtrl::Create](#create)|建立樹狀檢視控制項，並將它附加至`CTreeCtrl`物件。|  
|[CTreeCtrl::CreateDragImage](#createdragimage)|建立指定的樹狀檢視項目產生拖曳點陣圖。|  
|[CTreeCtrl::CreateEx](#createex)|使用指定的 Windows 延伸樣式建立樹狀目錄控制項，並將它附加至`CTreeCtrl`物件。|  
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|刪除樹狀檢視控制項中的所有項目。|  
|[CTreeCtrl::DeleteItem](#deleteitem)|刪除樹狀檢視控制項中的新項目。|  
|[CTreeCtrl::EditLabel](#editlabel)|編輯指定的樹狀檢視項目就地。|  
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|取消樹狀檢視中的項目目前的樹狀檢視控制項的標籤上的編輯作業。|  
|[CTreeCtrl::EnsureVisible](#ensurevisible)|可確保樹狀結構檢視項目會顯示在其樹狀檢視控制項。|  
|[CTreeCtrl::Expand](#expand)|折疊，會展開或摺疊子項目指定的樹狀檢視項目。|  
|[CTreeCtrl::GetBkColor](#getbkcolor)|擷取目前的背景色彩的控制項。|  
|[CTreeCtrl::GetCheck](#getcheck)|擷取樹狀目錄控制項目的的核取狀態。|  
|[CTreeCtrl::GetChildItem](#getchilditem)|擷取指定的樹狀檢視項目的子系。|  
|[CTreeCtrl::GetCount](#getcount)|擷取樹狀檢視控制項相關聯的樹狀結構項目數目。|  
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|擷取拖放作業的目標。|  
|[CTreeCtrl::GetEditControl](#geteditcontrol)|擷取用來編輯指定的樹狀檢視項目編輯控制項的控制代碼。|  
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|擷取目前的樹狀檢視控制項使用的延伸的樣式。|  
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|擷取指定的樹狀檢視項目的第一個可見的項目。|  
|[CTreeCtrl::GetImageList](#getimagelist)|擷取樹狀檢視控制項相關聯的影像清單控制代碼。|  
|[CTreeCtrl::GetIndent](#getindent)|擷取的位移 （以像素為單位） 的樹狀檢視項目從其父代。|  
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|擷取用來繪製的樹狀檢視的插入標記的色彩。|  
|[CTreeCtrl::GetItem](#getitem)|擷取指定的樹狀檢視項目的屬性。|  
|[CTreeCtrl::GetItemData](#getitemdata)|傳回項目相關聯的 32 位元應用程式專屬值。|  
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|擷取指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。|  
|[CTreeCtrl::GetItemHeight](#getitemheight)|擷取目前的樹狀結構檢視項目高度。|  
|[CTreeCtrl::GetItemImage](#getitemimage)|擷取項目相關聯的映像。|  
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|擷取指定的組件目前的樹狀檢視控制項中的指定項目之周框。|  
|[CTreeCtrl::GetItemRect](#getitemrect)|擷取週框的樹狀檢視項目。|  
|[CTreeCtrl::GetItemState](#getitemstate)|傳回項目的狀態。|  
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|擷取目前的樹狀檢視控制項中所指定項目的擴充的狀態。|  
|[CTreeCtrl::GetItemText](#getitemtext)|傳回項目的文字。|  
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|擷取目前的樹狀檢視控制項中的最後一個展開項目。|  
|[CTreeCtrl::GetLineColor](#getlinecolor)|擷取目前的線條色彩的樹狀檢視控制項。|  
|[CTreeCtrl::GetNextItem](#getnextitem)|擷取符合指定的關聯性的下一個樹狀結構檢視項目。|  
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|擷取指定的樹狀檢視項目的下一個同層級。|  
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|擷取指定的樹狀檢視項目的下一個可見的項目。|  
|[CTreeCtrl::GetParentItem](#getparentitem)|擷取指定的樹狀檢視項目的父代。|  
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|擷取指定的樹狀檢視項目的的之前同層級。|  
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|擷取指定的樹狀檢視項目的上一個可見的項目。|  
|[CTreeCtrl::GetRootItem](#getrootitem)|擷取指定的樹狀檢視項目的根。|  
|[CTreeCtrl::GetScrollTime](#getscrolltime)|擷取樹狀檢視控制項的最大捲軸時間。|  
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|擷取目前的樹狀檢視控制項中選取的項目數目。|  
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|擷取目前選取的樹狀檢視項目。|  
|[CTreeCtrl::GetTextColor](#gettextcolor)|擷取目前的文字色彩的控制項。|  
|[CTreeCtrl::GetToolTips](#gettooltips)|擷取子樹狀檢視控制項使用的工具提示控制項的控制代碼。|  
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|擷取樹狀檢視控制項相關聯的可見的樹狀項目數目。|  
|[CTreeCtrl::HitTest](#hittest)|傳回目前的位置與相關的資料指標`CTreeCtrl`物件。|  
|[CTreeCtrl::InsertItem](#insertitem)|在樹狀檢視控制項中插入新項目。|  
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|傳回非零，如果指定的項目具有子項目。|  
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|將指定的存取範圍識別項對應至樹狀檢視中的項目目前的樹狀檢視控制項的控制代碼。|  
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|將指定的控制代碼對應至樹狀檢視中的項目目前的樹狀檢視控制項，協助工具應用程式識別項。|  
|[CTreeCtrl::Select](#select)|選取、 捲動到檢視，或重新繪製指定的樹狀檢視項目。|  
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|重新繪製樹狀結構項目，做為拖放作業的目標。|  
|[CTreeCtrl::SelectItem](#selectitem)|選取指定的樹狀檢視項目。|  
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|選取指定的樹狀檢視項目做為第一個可見的項目。|  
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|設定目前的樹狀檢視控制項的自動捲動速率。|  
|[CTreeCtrl::SetBkColor](#setbkcolor)|設定控制項的背景色彩。|  
|[CTreeCtrl::SetCheck](#setcheck)|設定樹狀目錄控制項目核取狀態。|  
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|設定目前的樹狀檢視控制項的延伸的樣式。|  
|[CTreeCtrl::SetImageList](#setimagelist)|設定樹狀檢視控制項相關聯的影像清單控制代碼。|  
|[CTreeCtrl::SetIndent](#setindent)|從其父代設定樹狀檢視項目位移 （以像素為單位）。|  
|[CTreeCtrl::SetInsertMark](#setinsertmark)|設定在樹狀檢視控制項的插入標記。|  
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製的樹狀檢視的插入標記的色彩。|  
|[CTreeCtrl::SetItem](#setitem)|設定指定的樹狀檢視項目的屬性。|  
|[CTreeCtrl::SetItemData](#setitemdata)|設定項目相關聯的 32 位元應用程式專屬值。|  
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|設定指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。|  
|[CTreeCtrl::SetItemHeight](#setitemheight)|檢視項目會設定樹狀結構的高度。|  
|[CTreeCtrl::SetItemImage](#setitemimage)|將映像產生關聯的項目。|  
|[CTreeCtrl::SetItemState](#setitemstate)|設定項目的狀態。|  
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|將指定的項目擴充的狀態設定目前的樹狀檢視控制項中。|  
|[CTreeCtrl::SetItemText](#setitemtext)|設定項目的文字。|  
|[CTreeCtrl::SetLineColor](#setlinecolor)|設定樹狀檢視控制項目前的線條色彩。|  
|[CTreeCtrl::SetScrollTime](#setscrolltime)|設定樹狀檢視控制項的最大捲軸時間。|  
|[CTreeCtrl::SetTextColor](#settextcolor)|設定控制項的文字色彩。|  
|[CTreeCtrl::SetToolTips](#settooltips)|設定工具提示控制項的樹狀檢視控制項的子系。|  
|[CTreeCtrl::ShowInfoTip](#showinfotip)|目前的樹狀檢視控制項中顯示資訊提示指定的項目。|  
|[CTreeCtrl::SortChildren](#sortchildren)|排序指定的父項目子系。|  
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|排序使用的應用程式定義的排序函式指定的父項目的子系。|  
  
## <a name="remarks"></a>備註  
 「 樹狀檢視控制項 」 是一個視窗，顯示在磁碟上的項目，例如標題在文件中的索引，或檔案和目錄中的項目階層式清單。 每個項目都包含標籤和選擇性點陣圖影像，因此，每個項目都可以擁有與自己相關的子項目清單。 使用者可以按一下項目以展開和摺疊子項目的關聯清單。  
  
 這個控制項 (因此`CTreeCtrl`類別) 僅適用於 Windows 98 和 Windows NT 的版本 4 下執行的程式和更新版本。  
  
 如需有關使用`CTreeCtrl`，請參閱：  
  
- [控制項](../../mfc/controls-mfc.md)  
  
- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)  
  
- [樹狀檢視控制項參考](http://msdn.microsoft.com/library/windows/desktop/bb759988)Windows SDK 中。  
  
-   知識庫文章 Q222905： 如何： 針對 CTreeCtrl 顯示操作功能表  
  
## <a name="inheritance-hierarchy"></a>繼承階層  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `CTreeCtrl`  
  
## <a name="requirements"></a>需求  
 **標頭：** afxcmn.h  
  
##  <a name="create"></a>  CTreeCtrl::Create  
 如果您指定的樹狀結構控制項在對話方塊範本，或如果您使用[CTreeView](../../mfc/reference/ctreeview-class.md)，建立對話方塊或檢視時自動建立樹狀目錄控制項。  
  
```  
virtual BOOL Create(
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 *dwStyle*  
 指定樹狀檢視控制項的樣式。 套用所述的視窗樣式[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)，和任何的組合[樹狀檢視控制項樣式](http://msdn.microsoft.com/library/windows/desktop/bb760013)Windows SDK 中所述。  
  
 *rect*  
 指定樹狀檢視控制項的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構。  
  
 *pParentWnd*  
 指定樹狀檢視控制項的父視窗，通常`CDialog`。 它不得為 NULL。  
  
 *nID*  
 指定樹狀檢視控制項的 id。  
  
### <a name="return-value"></a>傳回值  
 如果初始化成功，則為非零否則便是 0。  
  
### <a name="remarks"></a>備註  
 如果您想要建立做為一些其他視窗的子視窗的樹狀結構控制項中，使用`Create`成員函式。 如果您建立樹狀目錄控制項使用`Create`，您必須將它傳遞 WS_VISIBLE，除了其他樹狀目錄檢視的樣式。  
  
 您建構`CTreeCtrl`分成兩個步驟。 第一次呼叫建構函式，然後呼叫`Create`，建立樹狀檢視控制項，並將它附加至`CTreeCtrl`物件。  
  
 若要建立具有延伸的視窗樣式的樹狀目錄控制項，呼叫[CreateEx](#createex)而不是`Create`。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]  
  
##  <a name="createex"></a>  CTreeCtrl::CreateEx  
 呼叫此函式來建立控制項 （子視窗），並將它與相關聯`CTreeCtrl`物件。  
  
```  
virtual BOOL CreateEx(
    DWORD dwExStyle,  
    DWORD dwStyle,  
    const RECT& rect,  
    CWnd* pParentWnd,  
    UINT nID);
```  
  
### <a name="parameters"></a>參數  
 *dwExStyle*  
 指定正在建立的控制項的延伸的樣式。 如需延伸的視窗樣式的清單，請參閱*dwExStyle*參數[CreateWindowEx](http://msdn.microsoft.com/library/windows/desktop/ms632680) Windows SDK 中。  
  
 *dwStyle*  
 指定樹狀檢視控制項的樣式。 套用所述的視窗樣式[CreateWindow](http://msdn.microsoft.com/library/windows/desktop/ms632679)，和任何的組合[樹狀檢視控制項樣式](http://msdn.microsoft.com/library/windows/desktop/bb760013)Windows SDK 中所述。  
  
 *rect*  
 若要參考[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構描述的大小和位置來建立，用戶端座標中之視窗*pParentWnd*。  
  
 *pParentWnd*  
 為控制項的父視窗的指標。  
  
 *nID*  
 控制項的子視窗識別碼。  
  
### <a name="return-value"></a>傳回值  
 否則為 0，如果成功則為非零。  
  
### <a name="remarks"></a>備註  
 使用`CreateEx`而不是[建立](#create)套用延伸的視窗樣式，由 Windows 擴充的樣式序言**WS_EX_**。  
  
##  <a name="createdragimage"></a>  CTreeCtrl::CreateDragImage  
 呼叫此函式可在樹狀檢視控制項中建立特定的項目產生拖曳點陣圖、 建立影像清單的點陣圖，以及將點陣圖影像清單。  
  
```  
CImageList* CreateDragImage(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀項目拖曳出來，放到控制代碼。  
  
### <a name="return-value"></a>傳回值  
 指標影像清單拖曳點陣圖已加入其中，如果登錄成功。否則為 NULL。  
  
### <a name="remarks"></a>備註  
 應用程式中使用影像清單的函式顯示的影像，當被拖曳的項目。  
  
 `CImageList`物件是永久的而您必須刪除它完成。 例如:   
  
 [!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]  
  
##  <a name="ctreectrl"></a>  CTreeCtrl::CTreeCtrl  
 建構 `CTreeCtrl` 物件。  
  
```  
CTreeCtrl();
```  
  
##  <a name="deleteallitems"></a>  CTreeCtrl::DeleteAllItems  
 呼叫此函式可從樹狀檢視控制項中刪除所有項目。  
  
```  
BOOL DeleteAllItems();
```  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]  
  
##  <a name="deleteitem"></a>  CTreeCtrl::DeleteItem  
 呼叫此函式可從樹狀檢視控制項中刪除項目。  
  
```  
BOOL DeleteItem(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要刪除的樹狀結構項目控制代碼。 如果*hitem* TVI_ROOT 值中，從樹狀檢視控制項，會刪除所有的項目。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]  
  
##  <a name="editlabel"></a>  CTreeCtrl::EditLabel  
 呼叫此函式可開始就地編輯的指定的項目的文字。  
  
```  
CEdit* EditLabel(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀項目可供編輯的控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功的話，指標`CEdit`用來編輯項目文字的物件; 否則為 NULL。  
  
### <a name="remarks"></a>備註  
 以單行編輯控制項包含文字取代項目的文字來完成編輯。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]  
  
##  <a name="endeditlabelnow"></a>  CTreeCtrl::EndEditLabelNow  
 結束編輯作業上標籤的樹狀檢視中的項目目前的樹狀檢視控制項時。  
  
```  
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*fCancelWithoutSave*|捨棄之前完成的編輯作業或為 FALSE，則之前完成操作，將變更儲存至樹狀檢視項目樹狀檢視項目的變更，則為 TRUE。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_ENDEDITLABELNOW](http://msdn.microsoft.com/library/windows/desktop/bb773564) Windows SDK 中所述的訊息。  
  
##  <a name="ensurevisible"></a>  CTreeCtrl::EnsureVisible  
 呼叫此函式可確保顯示樹狀檢視項目。  
  
```  
BOOL EnsureVisible(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 控制代碼進行可見的樹狀結構項目。  
  
### <a name="return-value"></a>傳回值  
 為 true，則會傳回系統若捲動以確保指定的項目顯示的樹狀檢視控制項中的項目。 否則，傳回的值為 FALSE。  
  
### <a name="remarks"></a>備註  
 如有必要，函式展開父項目，或捲動樹狀檢視控制項，讓項目為可見。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]  
  
##  <a name="expand"></a>  CTreeCtrl::Expand  
 如果任何項目，與指定的父項目相關聯，請呼叫此函式可展開或摺疊子項目的清單。  
  
```  
BOOL Expand(
    HTREEITEM hItem,  
    UINT nCode);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要展開的樹狀目錄項目的控制代碼。  
  
 *則 nCode*  
 旗標，指出要採取的動作類型。 這個旗標可以有下列值之一：  
  
- TVE_COLLAPSE 摺疊清單。  
  
- TVE_COLLAPSERESET 摺疊清單，並移除子項目。 TVIS_EXPANDEDONCE 狀態旗標會重設。 這個旗標必須搭配 TVE_COLLAPSE 旗標。  
  
- TVE_EXPAND 會展開清單。  
  
- 如果它目前已擴充，或將它擴充，如果目前已摺疊，TVE_TOGGLE 摺疊清單。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::EnsureVisible](#ensurevisible)。  
  
##  <a name="getbkcolor"></a>  CTreeCtrl::GetBkColor  
 此成員函式實作的 Win32 訊息行為[TVM_GETBKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773570)、 Windows SDK 中所述。  
  
```  
COLORREF GetBkColor() const;  
```  
  
### <a name="return-value"></a>傳回值  
 COLORREF 值，表示控制項目前的視窗背景色彩。 如果此值為-1，控制項是否使用系統的視窗色彩。 在此情況下，您可以使用`::GetSysColor(COLOR_WINDOW)`取得控制項使用的目前系統色彩。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetTextColor](#settextcolor)。  
  
##  <a name="getcheck"></a>  CTreeCtrl::GetCheck  
 呼叫此成員函式擷取項目的核取狀態。  
  
```  
BOOL GetCheck(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 這是要接收的狀態資訊相關 HTREEITEM。  
  
### <a name="return-value"></a>傳回值  
 如果選取的樹狀目錄控制項目; 非零，否則便是 0。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetCheck](#setcheck)。  
  
##  <a name="getchilditem"></a>  CTreeCtrl::GetChildItem  
 呼叫此函式可擷取的樹狀目錄檢視項目，是所指定的項目子系*hItem*。  
  
```  
HTREEITEM GetChildItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功; 的子系項目控點否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]  
  
##  <a name="getcount"></a>  CTreeCtrl::GetCount  
 呼叫此函式可擷取的樹狀檢視控制項中的項目計數。  
  
```  
UINT GetCount() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在樹狀檢視控制項中的項目數目。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]  
  
##  <a name="getdrophilightitem"></a>  CTreeCtrl::GetDropHilightItem  
 呼叫此函式可擷取的項目是拖放作業的目標。  
  
```  
HTREEITEM GetDropHilightItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 成功; 如果卸除的項目控點否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]  
  
##  <a name="geteditcontrol"></a>  CTreeCtrl::GetEditControl  
 呼叫此函式可擷取用來編輯樹狀檢視項目的文字編輯控制項的控制代碼。  
  
```  
CEdit* GetEditControl() const;  
```  
  
### <a name="return-value"></a>傳回值  
 用來成功; 如果編輯項目文字編輯控制項的指標否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]  
  
##  <a name="getextendedstyle"></a>  CTreeCtrl::GetExtendedStyle  
 擷取目前的樹狀檢視控制項使用的延伸的樣式。  
  
```  
DWORD GetExtendedStyle() const;  
```  
  
### <a name="return-value"></a>傳回值  
 值，包含的位元組合 (OR) 目前的樹狀檢視控制項的延伸樣式。 如需詳細資訊，請參閱[樹狀檢視控制項擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb759981)。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_GETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb773580) Windows SDK 中所述的訊息。  
  
##  <a name="getfirstvisibleitem"></a>  CTreeCtrl::GetFirstVisibleItem  
 呼叫此函式可擷取樹狀檢視控制項的第一個可見項目。  
  
```  
HTREEITEM GetFirstVisibleItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 控制代碼的第一個可見的項目。否則為 NULL。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetCheck](#setcheck)。  
  
##  <a name="getimagelist"></a>  CTreeCtrl::GetImageList  
 呼叫此函式可擷取一般的控制代碼或狀態樹狀檢視控制項相關聯的映像清單。  
  
```  
CImageList* GetImageList(UINT nImageList) const;  
```  
  
### <a name="parameters"></a>參數  
 *nImageList*  
 要擷取影像清單的類型。 影像清單可以是下列值之一：  
  
- TVSIL_NORMAL 擷取一般影像清單中，包含樹狀檢視項目選取及未選取映像。  
  
- TVSIL_STATE 擷取狀態的影像清單，其中包含使用者定義的狀態中的樹狀結構檢視項目的映像。  
  
### <a name="return-value"></a>傳回值  
 如果成功; 控制項的影像清單的指標否則為 NULL。  
  
### <a name="remarks"></a>備註  
 在樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。 當選取的項目，並不選取項目顯示的其他時，會顯示一個影像。 例如，項目可能會顯示開啟的資料夾，選取時，關閉的資料夾時未選取。  
  
 如需有關影像清單的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)類別。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]  
  
##  <a name="getindent"></a>  CTreeCtrl::GetIndent  
 呼叫此函式可擷取的量，以像素為單位，相對於其父項目縮排項目子系。  
  
```  
UINT GetIndent() const;  
```  
  
### <a name="return-value"></a>傳回值  
 縮排數量，以像素表示。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]  
  
##  <a name="getinsertmarkcolor"></a>  CTreeCtrl::GetInsertMarkColor  
 此成員函式實作的 Win32 訊息行為[TVM_GETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773590)、 Windows SDK 中所述。  
  
```  
COLORREF GetInsertMarkColor() const;  
```  
  
### <a name="return-value"></a>傳回值  
 COLORREF 值，其中包含目前的插入標記色彩。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]  
  
##  <a name="getitem"></a>  CTreeCtrl::GetItem  
 呼叫此函式可擷取指定的樹狀檢視項目的屬性。  
  
```  
BOOL GetItem(TVITEM* pItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *pItem*  
 指標[TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456)結構，Windows SDK 中所述。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::DeleteItem](#deleteitem)。  
  
##  <a name="getitemdata"></a>  CTreeCtrl::GetItemData  
 呼叫此函式可擷取與指定的項目相關聯的 32 位元應用程式專屬值。  
  
```  
DWORD_PTR GetItemData(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要擷取其資料的項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 與所指定的項目相關聯的 32 位元應用程式專屬值*hItem*。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]  
  
##  <a name="getitemexpandedimageindex"></a>  CTreeCtrl::GetItemExpandedImageIndex  
 擷取指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。  
  
```  
int GetItemExpandedImageIndex(HTREEITEM hItem)const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|控制代碼的樹狀檢視控制項項目。|  
  
### <a name="return-value"></a>傳回值  
 指定的項目展開的狀態時所顯示之影像的索引。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_GETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773596) Windows SDK 中所述的訊息。 訊息傳回[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構描述樹狀檢視控制項項目，然後按一下 這個方法會擷取`iExpandedImage`從該結構的成員。  
  
##  <a name="getitemheight"></a>  CTreeCtrl::GetItemHeight  
 此成員函式實作的 Win32 訊息行為[TVM_GETITEMHEIGHT](http://msdn.microsoft.com/library/windows/desktop/bb773599)、 Windows SDK 中所述。  
  
```  
SHORT GetItemHeight() const;  
```  
  
### <a name="return-value"></a>傳回值  
 項目，像素為單位的高度。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]  
  
##  <a name="getitemimage"></a>  CTreeCtrl::GetItemImage  
 在樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。  
  
```  
BOOL GetItemImage(
    HTREEITEM hItem,  
    int& nImage,  
    int& nSelectedImage) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要擷取的映像的項目控制代碼。  
  
 *nImage*  
 整數，接收樹狀檢視控制項影像清單內的項目影像的索引。  
  
 *nSelectedImage*  
 整數，會收到的項目樹狀檢視控制項影像清單中選取映像的索引。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 項目的標籤左邊顯示的影像。 當選取的項目，並不選取項目顯示的其他時，會顯示一個影像。 例如，項目可能會顯示開啟的資料夾，選取時，關閉的資料夾時未選取。  
  
 呼叫此函式可擷取的項目映像和其樹狀檢視控制項影像清單中選取的映像的索引。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]  
  
##  <a name="getitempartrect"></a>  CTreeCtrl::GetItemPartRect  
 擷取指定的組件目前的樹狀檢視控制項中的指定項目之周框。  
  
```  
BOOL GetItemPartRect(
    HTREEITEM hItem,   
    int nPart,   
    LPRECT lpRect)const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|控制代碼的樹狀檢視控制項項目。|  
|[in]*nPart*|組件識別碼。 必須設定為 TVGIPR_BUTTON。|  
|[out]*lpRect*|指標[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)結構。 如果此方法成功，結構接收部分所指定的矩形座標*hItem*和*nPart*。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 每個樹狀目錄控制項目限於圖形矩形。 只要按一下該矩形中的點時，項目即為*叫用*。 如此矩形中的點按一下時，所識別的項目，這個方法會傳回最大矩形*hItem*參數叫用。  
  
 這個方法會傳送 TVM_GETITEMPARTRECT 訊息，Windows SDK 中所述。 如需詳細資訊，請參閱[TreeView_GetItemPartRect](http://msdn.microsoft.com/library/windows/desktop/bb773847)巨集。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會使用存取範圍識別項和[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法來擷取的控制代碼的根樹狀結構檢視項目。 然後，此範例會使用控制代碼和[CTreeCtrl::GetItemPartRect](#getitempartrect)方法，以 3D 周圍繪製矩形該項目。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 我們使用[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)根樹狀結構檢視項目產生關聯的存取範圍識別項的方法。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]  
  
##  <a name="getitemrect"></a>  CTreeCtrl::GetItemRect  
 呼叫此函式可擷取週框矩形*hItem*並判斷它是否可見。  
  
```  
BOOL GetItemRect(
    HTREEITEM hItem,  
    LPRECT lpRect,  
    BOOL bTextOnly) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀檢視控制項項目控制代碼。  
  
 *lpRect*  
 指標[RECT](http://msdn.microsoft.com/library/windows/desktop/dd162897)接收之周框的結構。 座標是相對於樹狀檢閱控制項的左上角。  
  
 *bTextOnly*  
 如果這個參數不是零，週框矩形會包含項目的文字。 否則它會在樹狀檢視控制項中包含項目都會佔用的整行。  
  
### <a name="return-value"></a>傳回值  
 如果週框矩形中包含的項目可見，則為非零*lpRect*。 否則為 0 與*lpRect*未初始化。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]  
  
##  <a name="getitemstate"></a>  CTreeCtrl::GetItemState  
 傳回所指定項目的狀態*hItem*。  
  
```  
UINT GetItemState(
    HTREEITEM hItem,  
    UINT nStateMask) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要擷取其狀態的項目控制代碼。  
  
 *nStateMask*  
 遮罩，指示要擷取的一或多個狀態。 如需有關可能的值為*nStateMask*的討論內容，請參閱 <<c4> `state` 和`stateMask`成員[TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456) Windows SDK 中的結構。  
  
### <a name="return-value"></a>傳回值  
 UINT 保存 nStateMask 所指定之值的位元 OR。 如需可能的值資訊，請參閱[CTreeCtrl::GetItem](#getitem)。 若要尋找特定狀態的值，執行狀態值和傳回值的位元 AND 運算，如下列範例所示。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]  
  
##  <a name="getitemstateex"></a>  CTreeCtrl::GetItemStateEx  
 擷取目前的樹狀檢視控制項中所指定項目的擴充的狀態。  
  
```  
UINT GetItemStateEx(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|控制代碼的樹狀檢視控制項項目。|  
  
### <a name="return-value"></a>傳回值  
 項目的擴充的狀態。 如需詳細資訊，請參閱`uStateEx`隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_GETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773596) Windows SDK 中所述的訊息。 訊息傳回[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構描述樹狀檢視控制項項目，而且這個方法會擷取`uStateEx`從該結構的成員。  
  
##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText  
 傳回所指定項目的文字*hItem*。  
  
```  
CString GetItemText(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要擷取其文字的項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 A`CString`物件，其中包含項目的文字。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetNextItem](#getnextitem)。  
  
##  <a name="getlastvisibleitem"></a>  CTreeCtrl::GetLastVisibleItem  
 擷取目前的樹狀檢視控制項中的最後一個未展開的節點項目。  
  
```  
HTREEITEM GetLastVisibleItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 最後一個節點未展開項目方法是否成功的; 控制代碼否則為 NULL。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_GETNEXTITEM](http://msdn.microsoft.com/library/windows/desktop/bb773622) Windows SDK 中所述的訊息。 如需詳細資訊，請參閱中的 TVGN_LASTVISIBLE 旗標*旗標*該訊息的參數。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 一或多個這些變數用於下一個範例。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會擷取最後一個未展開的樹狀檢視節點項控制代碼，，然後繪製 3D 矩形以圍繞該項目。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]  
  
##  <a name="getlinecolor"></a>  CTreeCtrl::GetLineColor  
 此成員函式實作的 win32 訊息行為[TVM_GETLINECOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773619)、 Windows SDK 中所述。  
  
```  
COLORREF GetLineColor() const;  
```  
  
### <a name="return-value"></a>傳回值  
 目前的線條色彩。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]  
  
##  <a name="getnextitem"></a>  CTreeCtrl::GetNextItem  
 呼叫此函式可擷取的樹狀目錄檢視項目，具有指定的關聯性，並由*則 nCode*參數至*hItem*。  
  
```  
HTREEITEM GetNextItem(
    HTREEITEM hItem,  
    UINT nCode) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
 *則 nCode*  
 旗標，表示要關聯型別*hItem*。 這個旗標可以是下列值之一：  
  
- TVGN_CARET 擷取目前選取的項目。  
  
- TVGN_CHILD 擷取第一個子項目所指定的項目*hItem*參數。  
  
- TVGN_DROPHILITE 擷取的項目是拖放作業的目標。  
  
- TVGN_FIRSTVISIBLE 擷取的第一個可見項目。  
  
- TVGN_LASTVISIBLE 擷取最後一個項目展開樹狀目錄中。 這不會擷取最後一個項目顯示在樹狀檢視 視窗中。  
  
- TVGN_NEXT 擷取下一個同層級項目。  
  
- TVGN_NEXTVISIBLE 擷取下一個可見項目後面指定的項目。  
  
- TVGN_PARENT 擷取指定之項目的父代。  
  
- TVGN_PREVIOUS 擷取上一個同層級項目。  
  
- TVGN_PREVIOUSVISIBLE 擷取位於指定的項目的第一個可見項目。  
  
- TVGN_ROOT 擷取第一個子系項目，其中指定的項目所屬的根項目。  
  
### <a name="return-value"></a>傳回值  
 下一個項目成功; 如果控制代碼否則為 NULL。  
  
### <a name="remarks"></a>備註  
 如果正在擷取的項目樹狀結構的根節點，此函數會傳回 NULL。 例如，如果您使用此訊息在樹狀檢視中的根節點的第一層子系 TVGN_PARENT 旗標時，訊息會傳回 NULL。  
  
### <a name="example"></a>範例  
 如需使用`GetNextItem`在迴圈中，請參閱[CTreeCtrl::DeleteItem](#deleteitem)。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]  
  
##  <a name="getnextsiblingitem"></a>  CTreeCtrl::GetNextSiblingItem  
 呼叫此函式可擷取下一個同層級*hItem*。  
  
```  
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 控制代碼的下一個同層級項目。否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]  
  
##  <a name="getnextvisibleitem"></a>  CTreeCtrl::GetNextVisibleItem  
 呼叫此函式可擷取的下一個可見的項目*hItem*。  
  
```  
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 控制代碼的下一個可見項目。否則為 NULL。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetCheck](#setcheck)。  
  
##  <a name="getparentitem"></a>  CTreeCtrl::GetParentItem  
 呼叫此函式可擷取的父代*hItem*。  
  
```  
HTREEITEM GetParentItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 與父項目; 控制代碼否則為 NULL。  
  
### <a name="remarks"></a>備註  
 如果指定之項目的父代是樹狀結構的根節點，此函數會傳回 NULL。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::EnsureVisible](#ensurevisible)。  
  
##  <a name="getprevsiblingitem"></a>  CTreeCtrl::GetPrevSiblingItem  
 呼叫此函式可擷取的前一個同層級*hItem*。  
  
```  
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 控制代碼的之前同層級。否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]  
  
##  <a name="getprevvisibleitem"></a>  CTreeCtrl::GetPrevVisibleItem  
 呼叫此函式可擷取的前一個可見的項目*hItem*。  
  
```  
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 控制代碼的上一個可見的項目。否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]  
  
##  <a name="getrootitem"></a>  CTreeCtrl::GetRootItem  
 呼叫此函式可擷取樹狀檢視控制項的根項目。  
  
```  
HTREEITEM GetRootItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 控制代碼的根項目。否則為 NULL。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::EditLabel](#editlabel)。  
  
##  <a name="getscrolltime"></a>  CTreeCtrl::GetScrollTime  
 呼叫此成員函式可擷取樹狀檢視控制項的最大捲軸時間。  
  
```  
UINT GetScrollTime() const;  
```  
  
### <a name="return-value"></a>傳回值  
 最大捲軸的時間，以毫秒為單位。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 win32 訊息行為[TVM_GETSCROLLTIME](http://msdn.microsoft.com/library/windows/desktop/bb773625)、 Windows SDK 中所述。  
  
##  <a name="getselectedcount"></a>  CTreeCtrl::GetSelectedCount  
 擷取目前的樹狀檢視控制項中選取的項目數目。  
  
```  
UINT GetSelectedCount();
```  
  
### <a name="return-value"></a>傳回值  
 選取的項目數目。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_GETSELECTEDCOUNT](http://msdn.microsoft.com/library/windows/desktop/bb773629) Windows SDK 中所述的訊息。  
  
##  <a name="getselecteditem"></a>  CTreeCtrl::GetSelectedItem  
 呼叫此函式可擷取樹狀檢閱控制項的目前選取的項目。  
  
```  
HTREEITEM GetSelectedItem() const;  
```  
  
### <a name="return-value"></a>傳回值  
 選取的項目; 的控制代碼否則為 NULL。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]  
  
##  <a name="gettextcolor"></a>  CTreeCtrl::GetTextColor  
 此成員函式實作的 Win32 訊息行為[TVM_GETTEXTCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773633)、 Windows SDK 中所述。  
  
```  
COLORREF GetTextColor() const;  
```  
  
### <a name="return-value"></a>傳回值  
 COLORREF 值，表示目前的文字色彩。 如果此值為-1，控制項是否使用系統色彩的文字色彩。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetTextColor](#settextcolor)。  
  
##  <a name="gettooltips"></a>  CTreeCtrl::GetToolTips  
 此成員函式實作的 Win32 訊息行為[TVM_GETTOOLTIPS](http://msdn.microsoft.com/library/windows/desktop/bb773729)、 Windows SDK 中所述。  
  
```  
CToolTipCtrl* GetToolTips() const;  
```  
  
### <a name="return-value"></a>傳回值  
 指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)樹狀結構控制項中所使用的物件。 如果[建立](#create)成員函式使用的樣式 TVS_NOTOOLTIPS、 使用任何工具提示，以及會傳回 NULL。  
  
### <a name="remarks"></a>備註  
 MFC 實作`GetToolTips`傳回`CToolTipCtrl`物件，它由樹狀控制中，而不是工具提示控制項的控制代碼。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]  
  
##  <a name="getvisiblecount"></a>  CTreeCtrl::GetVisibleCount  
 呼叫此函式可擷取的樹狀檢視控制項中可見的項目計數。  
  
```  
UINT GetVisibleCount() const;  
```  
  
### <a name="return-value"></a>傳回值  
 在樹狀檢視控制項中; 可見的項目數目否則為-1。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetCheck](#setcheck)。  
  
##  <a name="hittest"></a>  CTreeCtrl::HitTest  
 呼叫此函式可判斷相對於用戶端區域的樹狀檢視控制項的指定點的位置。  
  
```  
HTREEITEM HitTest(
    CPoint pt,  
    UINT* pFlags = NULL) const;  
  
HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;  
```  
  
### <a name="parameters"></a>參數  
 *pt*  
 用戶端座標點的測試。  
  
 *pFlags*  
 接收的點擊測試結果的相關資訊的整數指標。 它可以是其中一個或多個值列在`flags`< 備註 > 一節中的成員。  
  
 *pHitTestInfo*  
 位址[TVHITTESTINFO](http://msdn.microsoft.com/library/windows/desktop/bb773448)結構，其中包含要進行點擊測試，而且位置會接收的點擊測試結果的相關資訊。  
  
### <a name="return-value"></a>傳回值  
 如果沒有項目都會佔用點所佔用的指定的點或為 NULL 的樹狀檢視項目控制代碼。  
  
### <a name="remarks"></a>備註  
 呼叫此函式時， *pt*參數會指定要測試點的座標。 如果沒有項目都會佔用點，函數會傳回位於指定的點則為 NULL 的項目控制代碼。 此外， *pFlags*參數會包含值，指出指定點的位置。 可能的值為：  
  
|||  
|-|-|  
|值|意義|  
|TVHT_ABOVE|用戶端區域上方。|  
|TVHT_BELOW|以下的用戶端區域。|  
|TVHT_NOWHERE|在用戶端區域中，但最後一個項目下方。|  
|TVHT_ONITEM|上的點陣圖或項目相關聯的標籤。|  
|TVHT_ONITEMBUTTON|上一個項目相關聯的按鈕。|  
|TVHT_ONITEMICON|上一個項目相關聯的點陣圖。|  
|TVHT_ONITEMINDENT|中的項目相關聯的縮排。|  
|TVHT_ONITEMLABEL|上一個項目相關聯的標籤 （字串）。|  
|TVHT_ONITEMRIGHT|在區域中，右邊的某個項目。|  
|TVHT_ONITEMSTATEICON|在樹狀檢視項目的狀態圖示，位於使用者定義的狀態。|  
|TVHT_TOLEFT|工作區的左邊。|  
|TVHT_TORIGHT|以用戶端區域的權限。|  
|||  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]  
  
##  <a name="insertitem"></a>  CTreeCtrl::InsertItem  
 呼叫此函式可在樹狀檢視控制項中插入新項目。  
  
```  
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

 
HTREEITEM InsertItem(
    UINT nMask,  
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    UINT nState,  
    UINT nStateMask,  
    LPARAM lParam,  
    HTREEITEM hParent,  
    HTREEITEM hInsertAfter);

 
HTREEITEM InsertItem(
    LPCTSTR lpszItem,  
    HTREEITEM hParent = TVI_ROOT,  
    HTREEITEM hInsertAfter = TVI_LAST);

 
HTREEITEM InsertItem(
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    HTREEITEM hParent = TVI_ROOT,  
    HTREEITEM hInsertAfter = TVI_LAST);
```  
  
### <a name="parameters"></a>參數  
 *lpInsertStruct*  
 指標`TVINSERTSTRUCT`，指定要插入之樹狀檢視項目的屬性。  
  
 *nMask*  
 整數，指定要設定的屬性。 請參閱`TVITEM`Windows SDK 中的結構。  
  
 *lpszItem*  
 字串，包含的項目文字的位址。  
  
 *nImage*  
 樹狀檢視控制項影像清單中的項目影像的索引。  
  
 *nSelectedImage*  
 樹狀檢視控制項影像清單中的項目選取的映像的索引。  
  
 *nState*  
 指定的項目狀態的值。 請參閱樹狀檢視控制項目狀態的適當狀態清單的 Windows SDK 中。  
  
 *nStateMask*  
 指定要設定哪些狀態。 請參閱`TVITEM`Windows SDK 中的結構。  
  
 *lParam*  
 與項目相關聯的 32 位元應用程式專屬值。  
  
 *hParent*  
 插入的項目之父代的控制代碼。  
  
 *hInsertAfter*  
 要插入新項目之後的項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 新的項目成功; 如果控制代碼否則為 NULL。  
  
### <a name="remarks"></a>備註  
 此範例示範情況下您可能會想插入樹狀目錄控制項目時，使用每個版本的函式。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]  
  
##  <a name="itemhaschildren"></a>  CTreeCtrl::ItemHasChildren  
 使用此函數來判斷是否樹狀結構項目指定*hItem*有子系的項目。  
  
```  
BOOL ItemHasChildren(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果樹狀結構項目所指定非零， *hItem*有子系的項目; 如果不為 0。  
  
### <a name="remarks"></a>備註  
 因此，您可以接著使用如果[CTreeCtrl::GetChildItem](#getchilditem)来擷取這些子項目。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetSelectedItem](#getselecteditem)。  
  
##  <a name="mapaccidtoitem"></a>  CTreeCtrl::MapAccIdToItem  
 將指定的存取範圍識別項對應至樹狀檢視中的項目目前的樹狀檢視控制項的控制代碼。  
  
```  
HTREEITEM MapAccIdToItem(UINT uAccId) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*uAccId*|樹狀檢視項目中的項目範圍識別項。|  
  
### <a name="return-value"></a>傳回值  
 樹狀檢視項目之控制代碼 ( `HTREEITEM`) 會對應至*uAccId*參數。 如需詳細資訊，請參閱*hItem*隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構。  
  
### <a name="remarks"></a>備註  
 協助工具是應用程式，協助殘障人士使用電腦。 存取範圍識別項由`IAccessible`介面來唯一地指定在視窗中的項目。 如需有關存取範圍識別項的詳細資訊，請搜尋"有關 Active Accessibility 支援 」 主題，網址[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。  
  
 這個方法會傳送[TVM_MAPACCIDTOHTREEITEM](http://msdn.microsoft.com/library/windows/desktop/bb773734) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會使用存取範圍識別項和[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法來擷取的控制代碼的根樹狀結構檢視項目。 此範例會使用控制代碼和[CTreeCtrl::GetItemPartRect](#getitempartrect)方法，以 3D 周圍繪製矩形該項目。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 我們使用[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)根樹狀結構檢視項目產生關聯的存取範圍識別項的方法。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]  
  
##  <a name="mapitemtoaccid"></a>  CTreeCtrl::MapItemToAccID  
 對應指定的控制代碼，樹狀檢視中的項目目前的樹狀檢視控制項的協助工具應用程式識別項。  
  
```  
UINT MapItemToAccID(HTREEITEM hItem) const;  
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|樹狀檢視中的項目控制項的控制代碼。 如需詳細資訊，請參閱*hItem*隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構。|  
  
### <a name="return-value"></a>傳回值  
 存取範圍識別項對應至*hItem*參數。  
  
### <a name="remarks"></a>備註  
 協助工具是應用程式，協助殘障人士使用電腦。 存取範圍識別項由`IAccessible`介面來唯一地指定在視窗中的項目。 如需有關存取範圍識別項的詳細資訊，請搜尋"有關 Active Accessibility 支援 」 主題，網址[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。  
  
 這個方法會傳送[TVM_MAPHTREEITEMTOACCID](http://msdn.microsoft.com/library/windows/desktop/bb773735) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會取得樹狀檢視控制項項目的識別碼。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 這個程式碼範例會取得根國家/地區節點的唯一識別碼。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]  
  
##  <a name="select"></a>  CTreeCtrl::Select  
 呼叫此函式可選取特定的樹狀檢視項目，項目捲動到檢視，或重新繪製用來表示拖放操作目標的樣式項目。  
  
```  
BOOL Select(
    HTREEITEM hItem,  
    UINT nCode);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
 *則 nCode*  
 要採取的動作類型。 這個參數可以是下列值之一：  
  
- TVGN_CARET 設定指定項目的選取項目。  
  
- TVGN_DROPHILITE 重新繪製用來表示拖放操作目標的樣式中指定的項目。  
  
- 使指定的項目是第一個可見的項目樹狀結構檢視垂直 TVGN_FIRSTVISIBLE 捲動。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果*則 nCode*包含值 TVGN_CARET，父視窗會收到 TVN_SELCHANGING 和 TVN_SELCHANGED 通知訊息。 此外，如果指定的項目已摺疊的父項目的子系，在父系的子項目清單會展開以顯示指定的項目。 在此情況下，父視窗會收到 TVN_ITEMEXPANDING 和 TVN_ITEMEXPANDED 通知訊息。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::HitTest](#hittest)。  
  
##  <a name="selectdroptarget"></a>  CTreeCtrl::SelectDropTarget  
 呼叫此函式以重新繪製用來表示拖放操作目標的樣式項目。  
  
```  
BOOL SelectDropTarget(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]  
  
##  <a name="selectitem"></a>  CTreeCtrl::SelectItem  
 呼叫此函式可選取特定的樹狀檢視項目。  
  
```  
BOOL SelectItem(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 樹狀結構項目控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如果*hItem*為 NULL，則此函式會不選取任何項目。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]  
  
##  <a name="selectsetfirstvisible"></a>  CTreeCtrl::SelectSetFirstVisible  
 呼叫此函式可垂直捲動樹狀檢視，使給定項目的第一個可見的項目。  
  
```  
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 將為第一個可見項目的樹狀目錄項目的控制代碼。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 此函式會傳送訊息至使用 TVM_SELECTITEM 和 TVGN_FIRSTVISIBLE 訊息參數視窗。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]  
  
##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo  
 設定目前的樹狀檢視控制項的自動捲動速率。  
  
```  
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,   
    UINT uUpdateTime);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*uPixelsPerSec*|每秒来捲動的像素數目。|  
|[in]*uUpdateTime*|更新控制項的時間間隔。|  
  
### <a name="return-value"></a>傳回值  
 一律傳回 TRUE。  
  
### <a name="remarks"></a>備註  
 自動捲動參數可用來看不到目前的項目捲動到檢視。 樹狀檢視控制項必須延伸樣式中所述 TVS_EX_AUTOHSCROLL[樹狀檢視控制項的延伸樣式](http://msdn.microsoft.com/library/windows/desktop/bb759981)。  
  
 這個方法會傳送[TVM_SETAUTOSCROLLINFO](http://msdn.microsoft.com/library/windows/desktop/bb773738) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會設定目前的樹狀檢視控制項的自動捲動行為。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 我們故意組成的樹狀檢視控制項窄，讓它自動必須捲動至顯示具有焦點的樹狀結構項目。 程式碼範例會設定樹狀檢視控制項，可自動捲動秒每隔 5 秒，直到樹狀結構項目檢視中 30 像素為單位。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]  
  
##  <a name="setbkcolor"></a>  CTreeCtrl::SetBkColor  
 此成員函式實作的 Win32 訊息行為[TVM_SETBKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773741)、 Windows SDK 中所述。  
  
```  
COLORREF SetBkColor(COLORREF clr);
```  
  
### <a name="parameters"></a>參數  
 *clr*  
 COLORREF 值，其中包含新的背景色彩。 如果此值為-1，控制項將會還原為使用系統色彩的背景色彩。  
  
### <a name="return-value"></a>傳回值  
 COLORREF 值，表示目前的文字色彩。 如果此值為-1，控制項是否使用系統色彩的文字色彩。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::SetTextColor](#settextcolor)。  
  
##  <a name="setcheck"></a>  CTreeCtrl::SetCheck  
 呼叫此成員函式可將樹狀目錄控制項目的的核取狀態。  
  
```  
BOOL SetCheck(
    HTREEITEM hItem,  
    BOOL fCheck = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 若要接收的核取狀態變更 HTREEITEM。  
  
 *來瞧*  
 指出是否要 checked 或 unchecked 樹狀目錄控制項目。 根據預設，`SetCheck`設定要檢查的項目。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 樹狀目錄控制項目會檢查時 (*來瞧*設為 TRUE)，以相鄰的核取記號，出現的項目。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]  
  
### <a name="example"></a>範例  
 若要使用核取方塊，設定 TVS_CHECKBOXES 之前填入樹狀目錄控制項。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]  
  
##  <a name="setextendedstyle"></a>  CTreeCtrl::SetExtendedStyle  
 設定目前的樹狀檢視控制項的延伸的樣式。  
  
```  
DWORD SetExtendedStyle(
    DWORD dwExMask,   
    DWORD dwExStyles);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*dwExMask*|位元遮罩，指定目前的樹狀檢視控制項中的樣式會受到這個方法。 如果此參數為零，則會忽略，而*dwExStyles*參數指派給樹狀檢視控制項。<br /><br /> 指定零或的位元組合 (OR) 中所述的樣式[樹狀檢視控制項擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb759981)。|  
|[in]*dwExStyles*|位元遮罩，指定目前的樹狀檢視中的樣式控制才能設定或清除。<br /><br /> 若要設定樣式的組合，指定的位元組合 (OR) 中所述的樣式[樹狀檢視控制項擴充樣式](http://msdn.microsoft.com/library/windows/desktop/bb759981)。 若要清除的樣式的一組，指定零。|  
  
### <a name="return-value"></a>傳回值  
 值，包含先前擴充控制項的樣式。  
  
### <a name="remarks"></a>備註  
 這個方法會清除中指定的樣式*dwExMask*參數，然後設定中指定的樣式*dwExStyles*參數。 只有對應的位元的延伸的樣式*dwExMask*變更。  
  
 這個方法會傳送[TVM_SETEXTENDEDSTYLE](http://msdn.microsoft.com/library/windows/desktop/bb773744) Windows SDK 中所述的訊息。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會將 TVS_EX_AUTOHSCROLL 擴充樣式加入至目前的樹狀檢視控制項。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 我們故意組成的樹狀檢視控制項窄，讓它自動必須捲動至顯示具有焦點的樹狀結構項目。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]  
  
##  <a name="setimagelist"></a>  CTreeCtrl::SetImageList  
 呼叫此函式可設定標準或狀態影像清單的樹狀檢視控制項，並且重繪其控制項使用新的映像。  
  
```  
CImageList* SetImageList(
    CImageList* pImageList,  
    int nImageListType);
```  
  
### <a name="parameters"></a>參數  
 *pImageList*  
 若要指派的影像清單的指標。 如果*pImageList*是 NULL，所有映像會從樹狀檢視控制項中移除。  
  
 *nImageListType*  
 若要設定的影像清單的類型。 影像清單可以是下列值之一：  
  
- TVSIL_NORMAL 設定一般影像清單中，包含樹狀檢視項目選取及未選取映像。 您必須使用此狀態的覆疊影像。  
  
- TVSIL_STATE 設定狀態的影像清單，其中包含使用者定義的狀態中的樹狀結構檢視項目的映像。  
  
### <a name="return-value"></a>傳回值  
 指標上述映像清單中，如果有的話。否則為 NULL。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetImageList](#getimagelist)。  
  
##  <a name="setindent"></a>  CTreeCtrl::SetIndent  
 呼叫此函式可設定樹狀檢視控制項的縮排寬度，並且重繪控制項，以反映新的寬度。  
  
```  
void SetIndent(UINT nIndent);
```  
  
### <a name="parameters"></a>參數  
 *nIndent*  
 縮排的像素為單位的寬度。 如果*nIndent*小於超過系統定義最小寬度，新的寬度設定為系統定義的最小值。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetIndent](#getindent)。  
  
##  <a name="setinsertmark"></a>  CTreeCtrl::SetInsertMark  
 此成員函式實作的 Win32 訊息行為[TVM_SETINSERTMARK](http://msdn.microsoft.com/library/windows/desktop/bb773753)、 Windows SDK 中所述。  
  
```  
BOOL SetInsertMark(
    HTREEITEM hItem,  
    BOOL fAfter = TRUE);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 指定即將放置在哪一個項目插入標記的 HTREEITEM。 如果這個引數為 NULL，則會移除插入標記。  
  
 *fAfter*  
 布林值，指定是否插入標記就會變成之前或之後指定的項目。 如果這個引數不是零，插入標記就會放在項目之後。 如果這個引數為零時，插入標記就會放在項目之前。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]  
  
##  <a name="setinsertmarkcolor"></a>  CTreeCtrl::SetInsertMarkColor  
 此成員函式實作的 Win32 訊息行為[TVM_SETINSERTMARKCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773755)、 Windows SDK 中所述。  
  
```  
COLORREF SetInsertMarkColor(COLORREF clrNew);
```  
  
### <a name="parameters"></a>參數  
 *clrNew*  
 包含新插入標記色彩 COLORREF 值。  
  
### <a name="return-value"></a>傳回值  
 包含前一個插入標記色彩 COLORREF 值。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)。  
  
##  <a name="setitem"></a>  CTreeCtrl::SetItem  
 呼叫此函式可設定的屬性指定的樹狀檢視項目。  
  
```  
BOOL SetItem(TVITEM* pItem);

 
BOOL SetItem(
    HTREEITEM hItem,  
    UINT nMask,  
    LPCTSTR lpszItem,  
    int nImage,  
    int nSelectedImage,  
    UINT nState,  
    UINT nStateMask,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>參數  
 *pItem*  
 指標[TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456)結構，其中包含新的項目屬性，Windows SDK 中所述。  
  
 *hItem*  
 重新設定其屬性的項目控制代碼。 請參閱`hItem`隸屬`TVITEM`Windows SDK 中的結構。  
  
 *nMask*  
 整數，指定要設定的屬性。 請參閱`mask`隸屬`TVITEM`結構。  
  
 *lpszItem*  
 字串，包含的項目文字的位址。  
  
 *nImage*  
 樹狀檢視控制項影像清單中的項目影像的索引。 請參閱`iImage`隸屬`TVITEM`結構。  
  
 *nSelectedImage*  
 樹狀檢視控制項影像清單中的項目選取的映像的索引。 請參閱`iSelectedImage`隸屬`TVITEM`結構。  
  
 *nState*  
 指定的項目狀態的值。 請參閱`State`隸屬`TVITEM`結構。  
  
 *nStateMask*  
 指定要設定哪些狀態。 請參閱`stateMask`隸屬`TVITEM`結構。  
  
 *lParam*  
 與項目相關聯的 32 位元應用程式專屬值。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 在`TVITEM`結構`hItem`成員識別項目，而`mask`成員指定要設定的屬性。  
  
 如果`mask`成員或*nMask*參數會指定 TVIF_TEXT 值，`pszText`成員或*lpszItem*是以 null 結束的字串的位址和`cchTextMax`成員會被忽略。 如果`mask`(或*nMask*) 指定 TVIF_STATE 值`stateMask`成員或*nStateMask*參數會指定哪一個項目狀態變更和`state`成員或*nState*參數會包含這些狀態的值。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]  
  
##  <a name="setitemdata"></a>  CTreeCtrl::SetItemData  
 呼叫此函式可設定與指定的項目相關聯的 32 位元應用程式專屬值。  
  
```  
BOOL SetItemData(
    HTREEITEM hItem,  
    DWORD_PTR dwData);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 要擷取其資料的項目控制代碼。  
  
 *dwData*  
 與所指定的項目相關聯的 32 位元應用程式專屬值*hItem*。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]  
  
##  <a name="setitemexpandedimageindex"></a>  CTreeCtrl::SetItemExpandedImageIndex  
 設定指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。  
  
```  
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,   
    int iExpandedImage);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|控制代碼的樹狀檢視控制項項目。|  
|[in]*iExpandedImage*|指定的項目展開的狀態時所顯示之影像的索引。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_SETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773758) Windows SDK 中所述的訊息。 這個方法會將指派*iExpandedImage*參數`iExpandedImage`隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構，然後使用該結構的訊息中。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例是簡單的測試，來判斷是否[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)方法會傳回所設定的值[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)方法。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]  
  
##  <a name="setitemheight"></a>  CTreeCtrl::SetItemHeight  
 此成員函式實作的 Win32 訊息行為[TVM_SETITEMHEIGHT](http://msdn.microsoft.com/library/windows/desktop/bb773761)、 Windows SDK 中所述。  
  
```  
SHORT SetItemHeight(SHORT cyHeight);
```  
  
### <a name="parameters"></a>參數  
 *cyHeight*  
 在樹狀結構檢視中，像素為單位指定新的每個項目高度。 如果這個引數小於之影像的高度，則它會設為影像的高度。 如果這個引數不是即使，會四捨五入至最接近甚至值。 如果這個引數為-1，控制項將會還原成使用預設項目高度。  
  
### <a name="return-value"></a>傳回值  
 先前的項目，像素為單位的高度。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetItemHeight](#getitemheight)。  
  
##  <a name="setitemimage"></a>  CTreeCtrl::SetItemImage  
 將映像產生關聯的項目。  
  
```  
BOOL SetItemImage(
    HTREEITEM hItem,  
    int nImage,  
    int nSelectedImage);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 若要設定其映像的項目控制代碼。  
  
 *nImage*  
 樹狀檢視控制項影像清單中的項目影像的索引。  
  
 *nSelectedImage*  
 樹狀檢視控制項影像清單中的項目選取的映像的索引。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 在樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。 項目的標籤左邊顯示的影像。 當選取的項目，並不選取項目顯示的其他時，會顯示一個影像。 例如，項目可能會顯示開啟的資料夾，選取時，關閉的資料夾時未選取。  
  
 呼叫此函式可設定的項目映像和其樹狀檢視控制項影像清單中選取的映像的索引。  
  
 如需有關映像的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetItemImage](#getitemimage)。  
  
##  <a name="setitemstate"></a>  CTreeCtrl::SetItemState  
 設定所指定項目的狀態*hItem*。  
  
```  
BOOL SetItemState(
    HTREEITEM hItem,  
    UINT nState,  
    UINT nStateMask);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 若要設定其狀態的項目控制代碼。  
  
 *nState*  
 指定新項目的狀態。  
  
 *nStateMask*  
 指定要變更的狀態。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 如需狀態資訊，請參閱[CTreeCtrl::GetItem](#getitem)。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetItemState](#getitemstate)。  
  
##  <a name="setitemstateex"></a>  CTreeCtrl::SetItemStateEx  
 將指定的項目擴充的狀態設定目前的樹狀檢視控制項中。  
  
```  
BOOL SetItemStateEx(
    HTREEITEM hItem,   
    UINT uStateEx);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|控制代碼的樹狀檢視控制項項目。|  
|[in]*uStateEx*|項目的擴充的狀態。 如需詳細資訊，請參閱`uStateEx`隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構。|  
  
### <a name="return-value"></a>傳回值  
 如果此方法成功，則為 TRUE否則為 FALSE。  
  
### <a name="remarks"></a>備註  
 這個方法會傳送[TVM_SETITEM](http://msdn.microsoft.com/library/windows/desktop/bb773758) Windows SDK 中所述的訊息。 這個方法會將指派*uStateEx*參數`uStateEx`隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構，然後使用該結構的訊息中。  
  
### <a name="example"></a>範例  
 下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 程式碼範例也會定義的不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]  
  
### <a name="example"></a>範例  
 下列程式碼範例會設定樹狀檢視項目為已停用狀態。 在先前章節中的程式碼範例中，不會顯示，我們會建立根國家/地區為美國節點、 子節點的狀態賓州和美國華盛頓州和城市，這些狀態中的樹狀結構項目所組成的樹狀檢視。 這個程式碼範例會設定為已停用狀態的賓州節點。  
  
 [!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]  
  
##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText  
 設定所指定項目的文字*hItem*。  
  
```  
BOOL SetItemText(
    HTREEITEM hItem,  
    LPCTSTR lpszItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 若要設定其文字的項目控制代碼。  
  
 *lpszItem*  
 包含項目的新的文字字串的位址  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]  
  
##  <a name="setlinecolor"></a>  CTreeCtrl::SetLineColor  
 呼叫此成員函式設定樹狀檢視控制項的目前線條色彩。  
  
```  
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```  
  
### <a name="parameters"></a>參數  
 *clrNew*  
 新的線條色彩。  
  
### <a name="return-value"></a>傳回值  
 先前的線條色彩。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 win32 訊息行為[TVM_SETLINECOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773764)、 Windows SDK 中所述。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]  
  
##  <a name="setscrolltime"></a>  CTreeCtrl::SetScrollTime  
 呼叫此成員函式可設定樹狀檢視控制項的最大捲軸的時間。  
  
```  
UINT SetScrollTime(UINT uScrollTime);
```  
  
### <a name="parameters"></a>參數  
 *uScrollTime*  
 新最大捲軸的時間，以毫秒為單位。 如果此值為小於 100，就會四捨五入到 100。  
  
### <a name="return-value"></a>傳回值  
 前一個最大捲軸的時間，以毫秒為單位。  
  
### <a name="remarks"></a>備註  
 此成員函式實作的 win32 訊息行為[TVM_SETSCROLLTIME](http://msdn.microsoft.com/library/windows/desktop/bb773767)、 Windows SDK 中所述。  
  
##  <a name="settextcolor"></a>  CTreeCtrl::SetTextColor  
 此成員函式實作的 Win32 訊息行為[TVM_SETTEXTCOLOR](http://msdn.microsoft.com/library/windows/desktop/bb773769)、 Windows SDK 中所述。  
  
```  
COLORREF SetTextColor(COLORREF clr);
```  
  
### <a name="parameters"></a>參數  
 *clr*  
 COLORREF 值，其中包含新的文字色彩。 如果這個引數為-1，控制項將會還原為使用系統色彩的文字色彩。  
  
### <a name="return-value"></a>傳回值  
 COLORREF 值，表示先前的文字色彩。 此值為-1，如果控制項已使用系統色彩的文字色彩。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]  
  
##  <a name="settooltips"></a>  CTreeCtrl::SetToolTips  
 此成員函式實作的 Win32 訊息行為[TVM_SETTOOLTIPS](http://msdn.microsoft.com/library/windows/desktop/bb773772)、 Windows SDK 中所述。  
  
```  
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```  
  
### <a name="parameters"></a>參數  
 *pWndTip*  
 指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)樹狀目錄控制項將使用的物件。  
  
### <a name="return-value"></a>傳回值  
 指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件，包含先前使用的控制項或為 NULL 如果先前不使用任何工具提示的工具提示。  
  
### <a name="remarks"></a>備註  
 若要使用工具提示，指出當您建立的 TVS_NOTOOLTIPS 樣式`CTreeCtrl`物件。  
  
### <a name="example"></a>範例  
  請參閱範例的[CTreeCtrl::GetToolTips](#gettooltips)。  
  
##  <a name="showinfotip"></a>  CTreeCtrl::ShowInfoTip  
 目前的樹狀檢視控制項中顯示資訊提示指定的項目。  
  
```  
void ShowInfoTip(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
  
|參數|描述|  
|---------------|-----------------|  
|[in]*hItem*|樹狀檢視中的項目控制項控制代碼。 如需詳細資訊，請參閱`hItem`隸屬[TVITEMEX](http://msdn.microsoft.com/library/windows/desktop/bb773459)結構。|  
  
### <a name="remarks"></a>備註  
 如需有關工具提示和資訊提示之間的差異的詳細資訊，請搜尋 「 工具提示和資訊提示 」 主題，網址[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。  
  
 這個方法會傳送[TVM_SHOWINFOTIP](http://msdn.microsoft.com/library/windows/desktop/bb773779) Windows SDK 中所述的訊息。  
  
##  <a name="sortchildren"></a>  CTreeCtrl::SortChildren  
 呼叫此函式可依字母順序排序樹狀檢視控制項中指定的父項目的子項目。  
  
```  
BOOL SortChildren(HTREEITEM hItem);
```  
  
### <a name="parameters"></a>參數  
 *hItem*  
 父項目，其中的子系項目是要排序的控制代碼。 如果*hItem*是 NULL，排序將會繼續從樹狀結構的根。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 `SortChildren` 不會遞迴所有樹狀結構。只有的直接子系*hItem*將進行排序。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]  
  
##  <a name="sortchildrencb"></a>  CTreeCtrl::SortChildrenCB  
 呼叫此函式可排序樹狀檢視項目使用的應用程式定義的回呼函式比較的項目。  
  
```  
BOOL SortChildrenCB(LPTVSORTCB pSort);
```  
  
### <a name="parameters"></a>參數  
 *pSort*  
 指標[TVSORTCB](http://msdn.microsoft.com/library/windows/desktop/bb773462)結構。  
  
### <a name="return-value"></a>傳回值  
 如果成功則為非零；否則為 0。  
  
### <a name="remarks"></a>備註  
 結構的比較函式， `lpfnCompare`，必須傳回負值正如果第一個項目應該在第二個值，如果第一個項目應該遵循第二個，或如果兩個項目相等。  
  
 *LParam1*和*lParam2*參數會對應至`lParam`隸屬[TVITEM](http://msdn.microsoft.com/library/windows/desktop/bb773456)結構的兩個項目進行比較。 *LParamSort*參數會對應至`lParam`隸屬`TV_SORTCB`結構。  
  
### <a name="example"></a>範例  
 [!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]  
  
 [!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]  
  
## <a name="see-also"></a>另請參閱  
 [MFC 範例 CMNCTRL1](../../visual-cpp-samples.md)   
 [CWnd 類別](../../mfc/reference/cwnd-class.md)   
 [階層架構圖表](../../mfc/hierarchy-chart.md)   
 [CImageList 類別](../../mfc/reference/cimagelist-class.md)
