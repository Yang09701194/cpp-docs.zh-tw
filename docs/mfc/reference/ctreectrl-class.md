---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 6fe7b133fa01285f85dc28dc8d8ca01e027f4a5c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81373312"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 通用樹狀檢閱控制項的功能。

## <a name="syntax"></a>語法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|建構 `CTreeCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl::創建](#create)|創建樹視圖控制件並將其附加到`CTreeCtrl`物件。|
|[CTreeCtrl::創建拖動影像](#createdragimage)|為指定的樹視圖項創建拖動點陣圖。|
|[CTreeCtrl::創建Ex](#createex)|使用指定的 Windows 擴充樣式創建樹控制元件並將`CTreeCtrl`其附加到 物件。|
|[CTreeCtrl::DeleteAll專案](#deleteallitems)|刪除樹視圖控制件中的所有項。|
|[CTreeCtrl::Delete專案](#deleteitem)|刪除樹視圖控制件中的新項。|
|[CTreeCtrl::編輯標籤](#editlabel)|就地編輯指定的樹視圖項。|
|[CTreeCtrl::結束編輯標籤現在](#endeditlabelnow)|取消目前樹檢視控制項中樹檢視項標籤的編輯操作。|
|[CTreeCtrl::確保可見](#ensurevisible)|確保樹視圖項在其樹視圖控件中可見。|
|[CTreeCtrl::展開](#expand)|展開或摺疊指定樹視圖項的子項。|
|[CTreeCtrl::GetBkColor](#getbkcolor)|檢索控制項的背景顏色。|
|[CTreeCtrl:取得檢查](#getcheck)|檢索樹控件項的檢查狀態。|
|[CTreeCtrl:獲取兒童專案](#getchilditem)|檢索指定樹視圖項的子項。|
|[CTreeCtrl::獲取計數](#getcount)|檢索與樹視圖控件關聯的樹項數。|
|[CTreeCtrl::獲取DropHilight專案](#getdrophilightitem)|檢索拖放操作的目標。|
|[CTreeCtrl:取得編輯控制](#geteditcontrol)|檢索用於編輯指定樹視圖項的編輯控制項的句柄。|
|[CTreeCtrl::獲取式延伸樣式](#getextendedstyle)|檢索當前樹視圖控制項正在使用的擴充樣式。|
|[CTreeCtrl:取得第一個可見項](#getfirstvisibleitem)|檢索指定樹視圖項的第一個可見項。|
|[CTreeCtrl:抓取影像清單](#getimagelist)|檢索與樹視圖控件關聯的圖像清單的句柄。|
|[CTreectrl:取得縮進](#getindent)|從樹視圖項的父級檢索樹視圖項的偏移量(以像素為單位)。|
|[CTreeCtrl::取得插入標記顏色](#getinsertmarkcolor)|檢索用於繪製樹視圖的插入標記的顏色。|
|[CTreeCtrl:取得專案](#getitem)|檢索指定樹視圖項的屬性。|
|[CTreeCtrl:抓取項目資料](#getitemdata)|返回與項關聯的特定於應用程式的值。|
|[CTreeCtrl::取得專案擴展圖像索引](#getitemexpandedimageindex)|檢索圖像的索引,當當前樹視圖控件的指定項處於展開狀態時要顯示。|
|[CTreeCtrl::獲取專案高度](#getitemheight)|檢索樹視圖項的當前高度。|
|[CTreeCtrl::獲取項目圖像](#getitemimage)|檢索與項目關聯的圖像。|
|[CTreeCtrl::獲取專案部分重整](#getitempartrect)|檢索目前樹檢視控制項中指定項的指定部分的邊界矩形。|
|[CTreeCtrl::獲取專案重新完成](#getitemrect)|檢索樹視圖項的邊界矩形。|
|[CTreeCtrl::獲取項目狀態](#getitemstate)|返回項的狀態。|
|[CTreeCtrl::獲取項目狀態Ex](#getitemstateex)|檢索目前樹視圖控制項中指定項的擴展狀態。|
|[CTreeCtrl::獲取項目文字](#getitemtext)|返回項的文本。|
|[CTreeCtrl::獲取最後可見的專案](#getlastvisibleitem)|檢索當前樹視圖控件中的最後一個展開項。|
|[CTreeCtrl::獲取線彩](#getlinecolor)|檢索樹檢視控制件的當前線顏色。|
|[CTreeCtrl::獲取下一個專案](#getnextitem)|檢索與指定關係匹配的下一個樹視圖項。|
|[CTreeCtrl::獲取下一個同級專案](#getnextsiblingitem)|檢索指定樹視圖項的下一個同級。|
|[CTreeCtrl::取得下一個可可見的專案](#getnextvisibleitem)|檢索指定樹視圖項的下一個可見項。|
|[CTreeCtrl:獲取父項](#getparentitem)|檢索指定樹視圖項的父項。|
|[CTreeCtrl::取得Prevsibling專案](#getprevsiblingitem)|檢索指定樹視圖項的上一個同級。|
|[CTreeCtrl::獲取可明顯專案](#getprevvisibleitem)|檢索指定樹視圖項的上一個可見項。|
|[CTreeCtrl:取得根專案](#getrootitem)|檢索指定樹視圖項的根。|
|[CTreeCtrl::獲取滾動時間](#getscrolltime)|檢索樹檢視控制件的最大滾動時間。|
|[CTreeCtrl:獲取精選計數](#getselectedcount)|檢索當前樹視圖控件中的選定項數。|
|[CTreeCtrl:取得選定專案](#getselecteditem)|檢索當前選定的樹視圖項。|
|[CTreeCtrl:取得文字顏色](#gettextcolor)|檢索控制項目前的目前文字顏色。|
|[CTreeCtrl:抓取工具提示](#gettooltips)|檢索樹檢視控制件使用的子 ToolTip 控制件的句柄。|
|[CTreeCtrl:取得可見計數](#getvisiblecount)|檢索與樹視圖控件關聯的可見樹項數。|
|[CTreeCtrl:hitTest](#hittest)|返回與物件相關的游標的`CTreeCtrl`當前位置。|
|[CTreeCtrl::插入專案](#insertitem)|在樹視圖控制項中插入新專案。|
|[CTreeCtrl::專案哈斯兒童](#itemhaschildren)|如果指定的項具有子項,則返回非零。|
|[CTreectrl:mapAccIdtoitem](#mapaccidtoitem)|將指定的輔助功能識別符映射到當前樹視圖控制件中的樹視圖項。|
|[CTreectrl::映射專案到AccID](#mapitemtoaccid)|將指定的句柄映射到當前樹視圖控制項中的樹視圖項到輔助功能識別符。|
|[CTreeCtrl::選擇](#select)|選擇、滾動到檢視或重繪指定的樹視圖項。|
|[CTreeCtrl::選擇DropTarget](#selectdroptarget)|將樹項重新繪製為拖放操作的目標。|
|[CTreeCtrl:選擇項目](#selectitem)|選擇指定的樹視圖項。|
|[CTreeCtrl::選擇第一個可見](#selectsetfirstvisible)|選擇指定的樹視圖項作為第一個可見項。|
|[CTreeCtrl::設定自動滾動資訊](#setautoscrollinfo)|設置當前樹視圖控制件的自動滾動速率。|
|[CTreeCtrl::SetBkColor](#setbkcolor)|設置控制的背景顏色。|
|[CTreeCtrl::設置檢查](#setcheck)|設置樹控件項的檢查狀態。|
|[CTreeCtrl::設定式延伸樣式](#setextendedstyle)|設置當前樹視圖控制件的擴展樣式。|
|[CTreeCtrl::設定影像清單](#setimagelist)|設置與樹檢視控制件關聯的圖像清單的句柄。|
|[CTreectrl::setindent](#setindent)|從樹視圖項的父級設置樹視圖項的偏移量(以像素為單位)。|
|[CTreeCtrl::設定插入標記](#setinsertmark)|在樹視圖控制項中設置插入標記。|
|[CTreeCtrl::設定插入標記顏色](#setinsertmarkcolor)|設置用於繪製樹檢視的插入標記的顏色。|
|[CTreeCtrl:設定專案](#setitem)|設置指定樹檢視項的屬性。|
|[CTreeCtrl::設定項目數據](#setitemdata)|設置與項關聯的特定於應用程式的值。|
|[CTreeCtrl::設定專案擴展影像索引](#setitemexpandedimageindex)|將圖像的索引設置在當前樹視圖控制件的指定項處於展開狀態時顯示。|
|[CTreeCtrl::設定專案高度](#setitemheight)|設置樹視圖項的高度。|
|[CTreeCtrl::設定項目圖像](#setitemimage)|將圖像與項目關聯。|
|[CTreeCtrl::設定項目狀態](#setitemstate)|設置項的狀態。|
|[CTreeCtrl::設定項目狀態Ex](#setitemstateex)|設置當前樹檢視控制項中指定項的擴展狀態。|
|[CTreeCtrl::設定項目文字](#setitemtext)|設置項目的文字。|
|[CTreeCtrl::設定線顏色](#setlinecolor)|設置樹檢視控制件的當前線顏色。|
|[CTreeCtrl::設置滾動時間](#setscrolltime)|設置樹視圖控制件的最大滾動時間。|
|[CTreeCtrl::設定文字顏色](#settextcolor)|設定控制項的文字顏色。|
|[CTreeCtrl::設定工具提示](#settooltips)|設置樹檢視控制件的子工具提示控制項。|
|[CTreeCtrl::顯示資訊提示](#showinfotip)|在目前樹檢視控制項中顯示指定項的資訊提示。|
|[CTreeCtrl::排序兒童](#sortchildren)|對給定父項的子項進行排序。|
|[CTreeCtrl::排序兒童CB](#sortchildrencb)|使用應用程式定義的排序函數對給定父項的子項進行排序。|

## <a name="remarks"></a>備註

"樹視圖控制件"是顯示項的分層列表的視窗,例如文檔中的標題、索引中的條目或磁碟上的文件和目錄。 每個項目都包含標籤和選擇性點陣圖影像，因此，每個項目都可以擁有與自己相關的子項目清單。 使用者可以按一下項目以展開和摺疊子項目的關聯清單。

此控制項(因此類別`CTreeCtrl`)僅適用於在 Windows 98 和 Windows NT 版本 4 及更高版本版本 4 下運行的程式。

有關`CTreeCtrl`使用的詳細資訊,請參閱:

- [控制項](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- Windows SDK 中的[樹狀圖控制者參考](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a>CTreeCtrl::創建

如果在對話框樣本中指定樹控件,或者如果您使用的[是 CTreeView,](../../mfc/reference/ctreeview-class.md)則在創建對話方塊或視圖時會自動創建樹控件。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定樹視圖控件的樣式。 應用[「創建視窗](/windows/win32/api/winuser/nf-winuser-createwindoww)」中描述的視窗樣式,以及 Windows SDK 中所述樹[檢視控制元件樣式](/windows/win32/Controls/tree-view-control-window-styles)的任何組合。

*矩形*<br/>
指定樹檢視控制的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/previous-versions/dd162897\(v=vs.85\))結構。

*pparentwnd*<br/>
指定樹狀圖控制的父視窗(通常為`CDialog`。 它不得為 NULL。

*nID*<br/>
指定樹檢視控制件的識別碼。

### <a name="return-value"></a>傳回值

初始化成功時非零;否則 0。

### <a name="remarks"></a>備註

如果要將樹控件創建為其他視窗的子視窗,請使用`Create`成員函數。 如果使用 創建樹控`Create`件 ,則除了其他樹視圖樣式外,還必須將其WS_VISIBLE傳遞。

在兩個步驟`CTreeCtrl`中構造 一個。 首先調用構造函數,然後調用`Create`,這將創建樹視圖控件並將其附加`CTreeCtrl`到 物件。

要使用延伸視窗樣式建立樹控制項,請呼叫[CreateEx](#createex)`Create`而不是 。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a>CTreeCtrl::創建Ex

呼叫此函數以建立控制項(子視窗),並將其與`CTreeCtrl`物件關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定要創建的控制項的擴充樣式。 有關擴展 Windows 樣式的清單,請參閱 Windows SDK 中[創建 WindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定樹視圖控件的樣式。 應用[「創建視窗](/windows/win32/api/winuser/nf-winuser-createwindoww)」中描述的視窗樣式,以及 Windows SDK 中所述樹[檢視控制元件樣式](/windows/win32/Controls/tree-view-control-window-styles)的任何組合。

*矩形*<br/>
對[RECT](/previous-versions/dd162897\(v=vs.85\))結構的引用,描述要創建的視窗的大小和位置,在*pParentWnd*的用戶端座標中。

*pparentwnd*<br/>
指向控件的父視窗的指標。

*nID*<br/>
控制項的子視窗 ID。

### <a name="return-value"></a>傳回值

如果成功,則為非零,否則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而不是[「創建](#create)」來應用擴展的 Windows 樣式,該樣式由 Windows 擴充樣式前言**WS_EX_** 指定。

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a>CTreeCtrl::創建拖動影像

呼叫此函數可為樹檢視控制件中的給定項創建拖動位圖,為位圖創建圖像清單,並將位圖添加到圖像清單中。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要拖動的樹項的句柄。

### <a name="return-value"></a>傳回值

指向向其添加拖動位圖的圖像清單(如果成功);如果成功,則指向圖像清單。否則 NULL。

### <a name="remarks"></a>備註

應用程式使用圖像清單函數在拖動項目時顯示圖像。

該`CImageList`對像是永久性的,您必須在完成該物件後將其刪除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a>CTreeCtrl::CTreeCtrl

建構 `CTreeCtrl` 物件。

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a>CTreeCtrl::DeleteAll專案

呼叫此函數以從樹檢視控制件中刪除所有項。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a>CTreeCtrl::Delete專案

呼叫此函數以從樹檢視控制件中刪除項。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要刪除的樹項的句柄。 如果*hitem*具有TVI_ROOT值,則所有項都將從樹視圖控件中刪除。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a>CTreeCtrl::編輯標籤

呼叫此函數開始就地編輯指定項目的文本。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要編輯的樹項的句柄。

### <a name="return-value"></a>傳回值

如果成功,則指向用於編輯`CEdit`專案文本的物件的指標;如果成功,則指向用於編輯專案文本的物件。否則 NULL。

### <a name="remarks"></a>備註

編輯是通過將專案的文本替換為包含文本的單行編輯控制件來完成的。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a>CTreeCtrl::結束編輯標籤現在

完成目前樹檢視控制件中樹檢視項標籤的編輯操作。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*f 取消而不儲存*|[在]TRUE 在結束編輯操作之前放棄對樹視圖項的更改,或者 FALSE 在結束操作之前保存對樹視圖項的更改。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)消息,這在 Windows SDK 中介紹。

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a>CTreeCtrl::確保可見

調用此函數以確保樹視圖項可見。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
使樹項可見的句柄。

### <a name="return-value"></a>傳回值

如果系統滾動樹視圖控制項中的項,則返回 TRUE,以確保指定的項可見。 否則,返回值為 FALSE。

### <a name="remarks"></a>備註

如有必要,該函數將展開父項或滾動樹視圖控件,以便該項可見。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a>CTreeCtrl::展開

呼叫此函數以展開或摺疊與給定父項關聯的子項清單(如果有)。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要展開的樹項的句柄。

*n代碼*<br/>
指示要執行的操作類型的標誌。 這個標誌可以具有以下值之一:

- TVE_COLLAPSE摺疊清單。

- TVE_COLLAPSERESET摺疊清單並刪除子項。 TVIS_EXPANDEDONCE狀態標誌重置。 此標誌必須與TVE_COLLAPSE標誌一起使用。

- TVE_EXPAND展開清單。

- TVE_TOGGLE如果清單當前已展開或展開清單(如果當前已折疊)。"折疊"。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::確保可見](#ensurevisible)。

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a>CTreeCtrl::GetBkColor

此成員函數實現 Win32 消息[的行為TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor),如 Windows SDK 中所述。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

表示控制項的目前的視窗背景顏色的 COLORREF 值。 如果此值為 -1,則控制項使用系統視窗顏色。 在這種情況下,可以使用`::GetSysColor(COLOR_WINDOW)`來獲取控制項正在使用的當前系統顏色。

### <a name="example"></a>範例

  請參考[CTreeCtrl 的範例::設定文字顏色](#settextcolor)。

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a>CTreeCtrl:取得檢查

調用此成員函數以檢索項的檢查狀態。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
接收狀態資訊的 HTREEITEM。

### <a name="return-value"></a>傳回值

如果檢查樹控件項,則非零;否則 0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::SetCheck](#setcheck)。

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a>CTreeCtrl:獲取兒童專案

呼叫此函數以檢索是*hItem*指定的項的子項的樹視圖項。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

子項的句柄(如果成功);否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a>CTreeCtrl::獲取計數

調用此函數以檢索樹視圖控制件中的項計數。

```
UINT GetCount() const;
```

### <a name="return-value"></a>傳回值

樹視圖控制項中的項數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a>CTreeCtrl::獲取DropHilight專案

調用此函數以檢索拖放操作的目標項。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>傳回值

專案句柄在成功時丟棄;否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a>CTreeCtrl:取得編輯控制

呼叫此函數以檢索用於編輯樹檢視項文本的編輯控制項的句柄。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

指向編輯控件的指標,用於編輯專案文本(如果成功);否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a>CTreeCtrl::獲取式延伸樣式

檢索當前樹視圖控制項正在使用的擴充樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

包含目前樹檢視控制元件擴展樣式的位元組合 (OR) 的值。 有關詳細資訊,請參閱[樹檢視控制元件延伸樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>備註

此方法發送[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)消息,這在 Windows SDK 中介紹。

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a>CTreeCtrl:取得第一個可見項

調用此函數以檢索樹視圖控制項的第一個可見項。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>傳回值

第一個可見項的句柄;否則 NULL。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::SetCheck](#setcheck)。

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a>CTreeCtrl:抓取影像清單

呼叫此函式以檢索與樹檢視控制項關聯的正常影像清單或狀態影像清單的句柄。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>參數

*n 影像清單*<br/>
要檢索的圖像清單的類型。 影像清單可以是以下值之一:

- TVSIL_NORMAL檢索正常影像清單,其中包含樹視圖項的選定圖像和非選定圖像。

- TVSIL_STATE檢索狀態圖像清單,其中包含處於使用者定義狀態的樹視圖項的圖像。

### <a name="return-value"></a>傳回值

如果成功,指向控件的圖像列表的指標;否則 NULL。

### <a name="remarks"></a>備註

樹視圖控制件中的每個項都可以具有與其關聯的一對位映射圖像。 選擇項目時顯示一個圖像,另一個圖像在未選中項目時顯示。 例如,專案在選擇時可能會顯示打開的資料夾,在未選中時顯示關閉的資料夾。

有關圖像清單的詳細資訊,請參閱[CImageList](../../mfc/reference/cimagelist-class.md)類。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a>CTreectrl:取得縮進

調用此函數以檢索子項相對於其父項縮進的金額(以像素為單位)。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>傳回值

以像素為單位測得的縮進量。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CTreeCtrl::取得插入標記顏色

此成員函數實現 Win32 消息[TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)的行為,如 Windows SDK 中所述。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

包含目前插入標記顏色的 COLORREF 值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a>CTreeCtrl:取得專案

調用此函數以檢索指定的樹視圖項的屬性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
指向[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標,如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl::Delete 專案)的範例](#deleteitem)。

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a>CTreeCtrl:抓取項目資料

調用此函數以檢索與指定項關聯的特定於應用程式的值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要檢索其數據的項的句柄。

### <a name="return-value"></a>傳回值

與*hItem*指定的項目關聯的指標大小的應用程式特定值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a>CTreeCtrl::取得專案擴展圖像索引

檢索圖像的索引,當當前樹視圖控件的指定項處於展開狀態時要顯示。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]處理樹視圖控件項。|

### <a name="return-value"></a>傳回值

指定項處於展開狀態時要顯示的圖像索引。

### <a name="remarks"></a>備註

此方法發送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息,這在 Windows SDK 中介紹。 此消息返回描述樹視圖控件項的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構,然後此方法從該結構`iExpandedImage`檢索 成員。

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a>CTreeCtrl::獲取專案高度

此成員函數實現 Win32 消息[的行為TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight),如 Windows SDK 中所述。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>傳回值

專案的高度(以像素為單位)。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a>CTreeCtrl::獲取項目圖像

樹視圖控制件中的每個項都可以具有與其關聯的一對位映射圖像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要檢索其映射的項的句柄。

*n 影像*<br/>
在樹檢視控制件的圖像清單中接收項圖像索引的整數。

*n 選擇的影像*<br/>
在樹檢視控制件的圖像清單中接收項選定圖像的索引的整數。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

圖像顯示在項目標籤的左側。 選擇項目時顯示一個圖像,另一個圖像在未選中項目時顯示。 例如,專案在選擇時可能會顯示打開的資料夾,在未選中時顯示關閉的資料夾。

呼叫此函數以在樹檢視控制件的圖像清單中檢索專案圖像及其所選圖像的索引。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a>CTreeCtrl::獲取專案部分重整

檢索目前樹檢視控制項中指定項的指定部分的邊界矩形。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]處理樹視圖控件項。|
|*n部份*|[在]零件的標識碼。 必須設置為TVGIPR_BUTTON。|
|*lpRect*|[出]指向[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標。 如果此方法成功,則結構將接收*hItem*和*nPart*指定的零件的矩形座標。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

每個樹控件項都受圖形矩形的約束。 每當按下這個矩形中的點時,該項即表示*為命中*。 此方法返回最大的矩形,這樣當單擊矩形中的點時,將命中*hItem*參數標識的項。

此方法發送TVM_GETITEMPARTRECT消息,這在 Windows SDK 中介紹。 有關詳細資訊,請參閱[TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)宏。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例使用輔助功能識別碼和[CTreeCtrl:mapAccIdToItem](#mapaccidtoitem)方法檢索根樹視圖項的句柄。 然後,該示例使用句柄和[CTreeCtrl::getItemPartrect](#getitempartrect)方法在該專案周圍繪製一個 3D 矩形。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 我們使用[CTreeCtrl:mapItemToAccID](#mapitemtoaccid)方法將根樹視圖項與輔助功能識別碼相關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a>CTreeCtrl::獲取專案重新完成

呼叫此函數以檢索*hItem*的邊界矩形,並確定它是否可見。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹視圖控件項的句柄。

*lpRect*<br/>
指向接收邊界矩形的[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標。 坐標相對於樹視圖控件的左上角。

*只有文字*<br/>
如果此參數是非零,則邊界矩形僅包括項的文本。 否則,它包括項在樹視圖控件中佔用的整行。

### <a name="return-value"></a>傳回值

如果項可見,則非零 *,lpRect*中包含邊界矩形。 否則,0 與*lpRect*未初始化。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a>CTreeCtrl::獲取項目狀態

傳回*hItem*指定的項目的狀態。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要檢索其狀態的項的句柄。

*nStateMask*<br/>
指示要檢索的一個或多個狀態的蒙版。 有關*nStateMask*的可能值的詳細資訊,請參閱 Windows`state``stateMask` SDK 中[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構和 成員的討論。

### <a name="return-value"></a>傳回值

一種 UINT,它儲存 nState Mask 指定的值的位或值。 有關可能值的資訊,請參閱[CTreeCtrl::getItem](#getitem)。 要查找特定狀態的值,應執行狀態值和返回值的位和操作,如以下示例所示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a>CTreeCtrl::獲取項目狀態Ex

檢索目前樹視圖控制項中指定項的擴展狀態。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]處理樹視圖控件項。|

### <a name="return-value"></a>傳回值

項的擴展狀態。 有關詳細資訊,請參閱`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。

### <a name="remarks"></a>備註

此方法發送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)消息,這在 Windows SDK 中介紹。 此消息返回描述樹視圖控件項的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構,此方法從該結構`uStateEx`檢索 成員。

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a>CTreeCtrl::獲取項目文字

傳回*hItem*指定的項目的文字。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要檢索其文本的項的句柄。

### <a name="return-value"></a>傳回值

包含`CString`項文字的物件。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得下一個專案](#getnextitem)。

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a>CTreeCtrl::獲取最後可見的專案

檢索當前樹視圖控件中的最後一個未展開的節點項。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>傳回值

如果該方法成功,則對最後一個未展開的節點項的句柄;否則,NULL。

### <a name="remarks"></a>備註

此方法發送[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)消息,這在 Windows SDK 中介紹。 有關詳細資訊,請參閱該消息*的標誌*參數中的TVGN_LASTVISIBLE標誌。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 在下一個示例中,使用其中一個或多個變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例檢索最後一個未展開的樹視圖節點項的句柄,然後圍繞該專案繪製一個 3D 矩形。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a>CTreeCtrl::獲取線彩

此成員函數實現 Win32 消息[TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)的行為,如 Windows SDK 中所述。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>傳回值

當前線顏色。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a>CTreeCtrl::獲取下一個專案

呼叫此函式以檢索有指定關係(由*nCode*參數指示)的樹檢視項目到*hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

*n代碼*<br/>
指示與*hItem*的關係類型的標誌。 這個標誌可以是以下值之一:

- TVGN_CARET檢索當前選定的項。

- TVGN_CHILD檢索*hItem*參數指定的項的第一個子項。

- TVGN_DROPHILITE檢索拖放操作的目標項。

- TVGN_FIRSTVISIBLE檢索第一個可見項。

- TVGN_LASTVISIBLE檢索樹中的最後一個展開項。 這不會檢索樹視圖視窗中可見的最後一個項。

- TVGN_NEXT檢索下一個同級項。

- TVGN_NEXTVISIBLE檢索指定項後面的下一個可見項。

- TVGN_PARENT檢索指定項的父項。

- TVGN_PREVIOUS檢索上一個同級項。

- TVGN_PREVIOUSVISIBLE檢索指定項之前的第一個可見項。

- TVGN_ROOT檢索指定項為部件的根項的第一個子項。

### <a name="return-value"></a>傳回值

下一項的句柄(如果成功);否則 NULL。

### <a name="remarks"></a>備註

如果正在檢索的項是樹的根節點,則此功能將返回 NULL。 例如,如果在樹視圖根節點的第一級子節點上使用帶有TVGN_PARENT標誌的此消息,則消息將返回 NULL。

### <a name="example"></a>範例

有關`GetNextItem`在循環中使用的範例,請參閱[CTreeCtrl::DeleteItem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a>CTreeCtrl::獲取下一個同級專案

呼叫此函數以檢索*hItem*的下一個同級。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

下一個同級項的句柄;否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a>CTreeCtrl::取得下一個可可見的專案

呼叫此函數以檢索*hItem*的下一個可見項。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

下一個可見項的句柄;否則 NULL。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::SetCheck](#setcheck)。

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a>CTreeCtrl:獲取父項

呼叫此函式以檢索*hItem*的父項目 。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

父項的句柄;否則 NULL。

### <a name="remarks"></a>備註

如果指定項的父項是樹的根節點,則此功能將返回 NULL。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::確保可見](#ensurevisible)。

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a>CTreeCtrl::取得Prevsibling專案

呼叫此函數以檢索*hItem*的上一個同級。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

上一個同級的句柄;否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a>CTreeCtrl::獲取可明顯專案

呼叫此函數以檢索*hItem*的上一個可見項。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

上一個可見項的句柄;否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a>CTreeCtrl:取得根專案

調用此函數以檢索樹視圖控件的根項。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>傳回值

根項的句柄;否則 NULL。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::編輯標籤](#editlabel)。

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a>CTreeCtrl::獲取滾動時間

調用此成員函數以檢索樹檢視控制項的最大滾動時間。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>傳回值

最大滾動時間(以毫秒為單位)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)的行為,如 Windows SDK 中所述。

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a>CTreeCtrl:獲取精選計數

檢索當前樹視圖控件中的選定項數。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>傳回值

所選項的數量。

### <a name="remarks"></a>備註

此方法發送[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)訊息,這在 Windows SDK 中介紹。

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a>CTreeCtrl:取得選定專案

調用此函數以檢索樹檢視控制件的當前選定項。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

所選項的句柄;否則 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a>CTreeCtrl:取得文字顏色

此成員函數實現 Win32 消息[TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)的行為,如 Windows SDK 中所述。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

表示目前文字顏色的 COLORREF 值。 如果此值為 -1,則控制項將使用文字顏色的系統顏色。

### <a name="example"></a>範例

  請參考[CTreeCtrl 的範例::設定文字顏色](#settextcolor)。

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a>CTreeCtrl:抓取工具提示

此成員函數實現 Win32 消息[TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)的行為,如 Windows SDK 中所述。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

指向樹控件使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。 如果[「創建](#create)成員」函數使用樣式TVS_NOTOOLTIPS,則不使用工具提示,並且傳回 NULL。

### <a name="remarks"></a>備註

的`GetToolTips`MFC`CToolTipCtrl`實現返回 由樹控制件使用的物件,而不是工具提示控制項的句柄。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a>CTreeCtrl:取得可見計數

調用此函數以檢索樹視圖控制項中可見項的計數。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>傳回值

樹視圖控件中的可見項數;否則 - 1。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::SetCheck](#setcheck)。

## <a name="ctreectrlhittest"></a><a name="hittest"></a>CTreeCtrl:hitTest

調用此函數以確定指定點相對於樹檢視控制項的工作區的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
要測試的點的客戶端座標。

*pFlags*<br/>
指向接收命中測試結果資訊的整數的指標。 它可以是「備註」部分中`flags`成員下列出的一個或多個值。

*pHitTestInfo*<br/>
包含命中測試位置並接收命中測試結果資訊的[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)結構的位址。

### <a name="return-value"></a>傳回值

如果沒有任何項佔用該點,則佔用指定點的樹視圖項的句柄或 NULL。

### <a name="remarks"></a>備註

呼叫此函數時 *,pt*參數指定要測試的點的座標。 如果沒有專案佔用該點,則函數返回指定點處的項句柄或 NULL。 此外 *,pFlags*參數包含指示指定點位置的值。 可能的值包括：

|||
|-|-|
|值|意義|
|TVHT_ABOVE|在工作區上方。|
|TVHT_BELOW|在工作區下方。|
|TVHT_NOWHERE|在工作區中,但位於最後一個項的下方。|
|TVHT_ONITEM|在與項目關聯的位圖或標籤上。|
|TVHT_ONITEMBUTTON|在與項目關聯的按鈕上。|
|TVHT_ONITEMICON|在與項目關聯的位圖上。|
|TVHT_ONITEMINDENT|在與項關聯的縮進中。|
|TVHT_ONITEMLABEL|在與項目關聯的標籤(字串)上。|
|TVHT_ONITEMRIGHT|在項目右側的區域。|
|TVHT_ONITEMSTATEICON|在處於用戶定義狀態的樹視圖項的狀態圖示上。|
|TVHT_TOLEFT|在工作區的左側。|
|TVHT_TORIGHT|在工作區的右側。|
|||

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a>CTreeCtrl::插入專案

調用此函數以在樹檢視控制項中插入新項。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>參數

*lpInsertstruct*<br/>
指向的指標`TVINSERTSTRUCT`,用於指定要插入的樹視圖項的屬性。

*nMask*<br/>
指定要設置的屬性的整數。 請參閱`TVITEM`Windows SDK 中的結構。

*lpszItem*<br/>
包含項目的字串的位址。

*n 影像*<br/>
樹視圖控制件的圖像清單中項圖像的索引。

*n 選擇的影像*<br/>
樹視圖控制件的圖像清單中專案選取的索引。

*n州*<br/>
指定項狀態的值。 有關適當狀態的清單,請參閱 Windows SDK 中的樹視圖控件項狀態。

*nStateMask*<br/>
指定要設置哪些狀態。 請參閱`TVITEM`Windows SDK 中的結構。

*lParam*<br/>
與項關聯的指標大小的應用程式特定值。

*h 家長*<br/>
插入項的父項的句柄。

*h 插入後*<br/>
要插入新項目的項的句柄。

### <a name="return-value"></a>傳回值

如果成功,處理新專案;否則 NULL。

### <a name="remarks"></a>備註

該示例顯示在插入樹控件項時可能需要使用函數的每個版本的情況。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a>CTreeCtrl::專案哈斯兒童

使用此函數可以確定*hItem*指定的樹項是否具有子項。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

如果*hItem*指定的樹項具有子項,則非零;0,如果沒有。

### <a name="remarks"></a>備註

如果是這樣,則可以使用[CTreeCtrl::getChildItem](#getchilditem)檢索這些子項。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得選定專案](#getselecteditem)。

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a>CTreectrl:mapAccIdtoitem

將指定的輔助功能識別符映射到當前樹檢視控制項中的樹視圖項的句柄。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uAccId*|[在]樹視圖項中元素的輔助功能識別碼。|

### <a name="return-value"></a>傳回值

對應於*uAccId*參數`HTREEITEM`的樹 檢視( ) 的句柄。 有關詳細資訊,請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。

### <a name="remarks"></a>備註

輔助功能是幫助殘障人士使用電腦的應用程式。 `IAccessible`介面使用輔助功能識別碼在視窗中唯一指定元素。 有關輔助功能識別碼的詳細資訊,在[Microsoft開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索"關於活動輔助功能支援"主題。

此方法發送[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例使用輔助功能識別碼和[CTreeCtrl:mapAccIdToItem](#mapaccidtoitem)方法檢索根樹視圖項的句柄。 該示例使用句柄和[CTreeCtrl::GetItemPartrect](#getitempartrect)方法在該專案周圍繪製一個 3D 矩形。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 我們使用[CTreeCtrl:mapItemToAccID](#mapitemtoaccid)方法將根樹視圖項與輔助功能識別碼相關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a>CTreectrl::映射專案到AccID

將當前樹檢視控制項中的樹檢視項的指定句柄映射到輔助功能識別符。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]控件中的樹視圖項的句柄。 有關詳細資訊,請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。|

### <a name="return-value"></a>傳回值

對應於*hItem*參數的輔助功能識別碼。

### <a name="remarks"></a>備註

輔助功能是幫助殘障人士使用電腦的應用程式。 `IAccessible`介面使用輔助功能識別碼在視窗中唯一指定元素。 有關輔助功能識別碼的詳細資訊,在[Microsoft開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)中搜索"關於活動輔助功能支援"主題。

此方法發送[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)消息,這在Windows SDK中介紹。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例獲取樹視圖控制項項的標識號。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 此代碼示例獲取根國家/區域節點的唯一標識號。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a>CTreeCtrl::選擇

調用此函數以選擇給定的樹檢視項、將專案滾動到檢視中,或重繪用於指示拖放操作目標的樣式中的項。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

*n代碼*<br/>
要執行的操作類型。 這裡可以是以下值之一:

- TVGN_CARET 將所選內容設置到給定項。

- TVGN_DROPHILITE重繪用於指示拖放操作目標的樣式中的給定項。

- TVGN_FIRSTVISIBLE垂直滾動樹視圖,以便給定項是第一個可見項。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*nCode*包含該值TVGN_CARET,則父視窗將接收TVN_SELCHANGING並TVN_SELCHANGED通知消息。 此外,如果指定的項是摺疊父項的子項,則父項的子項清單將展開以顯示指定的項。 在這種情況下,父視窗接收TVN_ITEMEXPANDING和TVN_ITEMEXPANDED通知消息。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::hitTest](#hittest)。

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a>CTreeCtrl::選擇DropTarget

調用此函數以重繪用於指示拖放操作目標的樣式中的項。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a>CTreeCtrl:選擇項目

調用此函數以選擇給定的樹視圖項。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹項的句柄。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*hItem*為 NULL,則此函數不選擇任何專案。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a>CTreeCtrl::選擇第一個可見

調用此函數垂直滾動樹視圖,以便給定項是第一個可見項。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設置為第一個可見項的樹項的句柄。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

函數向視窗發送一條消息,其中帶有TVM_SELECTITEM和TVGN_FIRSTVISIBLE消息參數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a>CTreeCtrl::設定自動滾動資訊

設置當前樹視圖控制件的自動滾動速率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uPixelsPerSec*|[在]每秒要滾動的像素數。|
|*u 更新時間*|[在]控件更新之間的時間間隔。|

### <a name="return-value"></a>傳回值

始終返回 TRUE。

### <a name="remarks"></a>備註

自動滾動參數用於滾動到查看當前不可見的專案。 樹視圖控件必須具有TVS_EX_AUTOHSCROLL擴展樣式,這在[樹視圖控件擴展樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述。

此方法發送[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例設置當前樹視圖控制件的自動滾動行為。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 我們特意使樹視圖控件變窄,以便它必須自動滾動以顯示具有焦點的樹項。 代碼示例將樹視圖控件設置為每 5 秒自動滾動 30 圖元,直到樹項處於檢視中。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a>CTreeCtrl::SetBkColor

此成員函數實現 Win32 消息[TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)的行為,如 Windows SDK 中所述。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*Clr*<br/>
包含新背景顏色的 COLORREF 值。 如果此值為 -1,則控制項將恢復為使用背景顏色的系統顏色。

### <a name="return-value"></a>傳回值

表示目前文字顏色的 COLORREF 值。 如果此值為 -1,則控制項將使用文字顏色的系統顏色。

### <a name="example"></a>範例

  請參考[CTreeCtrl 的範例::設定文字顏色](#settextcolor)。

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a>CTreeCtrl::設置檢查

調用此成員函數以設置樹控件項的檢查狀態。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
接收檢查狀態更改的 HTREEITEM。

*f檢查*<br/>
指示是要檢查樹控件項還是取消選中。 預設情況下,`SetCheck`將要檢查的項設定。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

當樹控件項選中時 *(fCheck*設置為 TRUE),該項將顯示一個相鄰的複選標記。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>範例

要使用複選框,請在填充樹控件之前設置TVS_CHECKBOXES。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a>CTreeCtrl::設定式延伸樣式

設置當前樹視圖控制件的擴展樣式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*dwExMask*|[在]指定當前樹視圖控件中哪些樣式受此方法影響的位掩碼。 如果此參數為零,則忽略該參數,並將*dwExStyles*參數的值分配給樹視圖控制項。<br /><br /> 指定[樹視圖控制元件擴展樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述的樣式的零或位組合 (OR)。|
|*dwExStyles*|[在]指定要設定或清除的當前樹檢視控制件中的樣式的位掩碼。<br /><br /> 要設置樣式的組合,請指定[樹視圖控制項擴展樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中描述的樣式的位組合 (OR)。 要清除一組樣式,請指定零。|

### <a name="return-value"></a>傳回值

包含上一個擴展控制項樣式的值。

### <a name="remarks"></a>備註

此方法清除*dwExMask*參數中指定的樣式,然後設置*dwExStyles*參數中指定的樣式。 只有對應於*dwExMask*中的位的擴展樣式才會更改。

此方法發送[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)消息,這在 Windows SDK 中介紹。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例將TVS_EX_AUTOHSCROLL擴展樣式添加到當前樹視圖控制項。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 我們特意使樹視圖控件變窄,以便它必須自動滾動以顯示具有焦點的樹項。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a>CTreeCtrl::設定影像清單

呼叫此函數可設定樹檢視控制件的正常影像或狀態圖像清單,並使用新圖像重新繪製控制件。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
指向要分配的圖像清單的指標。 如果*pImageList*為 NULL,則所有圖像都將從樹檢視控制項中刪除。

*n 影像清單類型*<br/>
要設置的圖像清單的類型。 影像清單可以是以下值之一:

- TVSIL_NORMAL 設置正常圖像清單,其中包含樹視圖項的選定圖像和非選定圖像。 必須使用此狀態來疊加圖像。

- TVSIL_STATE 設置狀態圖像清單,其中包含處於使用者定義狀態的樹視圖項的圖像。

### <a name="return-value"></a>傳回值

指向上一個圖像清單(如果有);如果指向上一個圖像清單(如果有);否則 NULL。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::抓取影像清單](#getimagelist)。

## <a name="ctreectrlsetindent"></a><a name="setindent"></a>CTreectrl::setindent

調用此函數可設置樹視圖控制件的縮進寬度,並重繪控制項以反映新寬度。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>參數

*n 因登特*<br/>
縮進的寬度(以像素為單位)。 如果*nIndent*小於系統定義的最小寬度,則新寬度將設置為系統定義的最小寬度。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得縮排](#getindent)。

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a>CTreeCtrl::設定插入標記

此成員函數實現 Win32 消息[TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)的行為,如 Windows SDK 中所述。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
HTREEITEM,用於指定插入標記將放置在哪個專案上。 如果此參數為 NULL,則插入標記將被刪除。

*f 後*<br/>
BOOL 值,用於指定插入標記是放置在指定項之前還是之後。 如果此參數為非零,則插入標記將放在項之後。 如果此參數為零,則插入標記將放置在項之前。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CTreeCtrl::設定插入標記顏色

此成員函數實現 Win32 消息[TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)的行為,如 Windows SDK 中所述。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
包含新插入標記顏色的 COLORREF 值。

### <a name="return-value"></a>傳回值

包含前一個插入標記顏色的 COLORREF 值。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得 InsertMarkColor](#getinsertmarkcolor)。

## <a name="ctreectrlsetitem"></a><a name="setitem"></a>CTreeCtrl:設定專案

調用此函數以設置指定的樹視圖項的屬性。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
指向包含新項目屬性的[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標,如 Windows SDK 中所述。

*hItem*<br/>
要設置其屬性的項的句柄。 請參閱`hItem`Windows SDK`TVITEM`中的結構成員。

*nMask*<br/>
指定要設置的屬性的整數。 請參閱`TVITEM`結構`mask`的成員。

*lpszItem*<br/>
包含項目的字串的位址。

*n 影像*<br/>
樹視圖控制件的圖像清單中項圖像的索引。 請參閱`TVITEM`結構`iImage`的成員。

*n 選擇的影像*<br/>
樹視圖控制件的圖像清單中專案選取的索引。 請參閱`TVITEM`結構`iSelectedImage`的成員。

*n州*<br/>
指定項狀態的值。 請參閱`TVITEM`結構`State`的成員。

*nStateMask*<br/>
指定要設置哪些狀態。 請參閱`TVITEM`結構`stateMask`的成員。

*lParam*<br/>
與項關聯的指標大小的應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

在結構`TVITEM`中`hItem`, 成員識別`mask`項, 成員指定要設置的屬性。

如果`mask`成員或*nMask*參數指定TVIF_TEXT`pszText`值, 則成員或*lpszItem*是 null 終止`cchTextMax`字串的位址,並且該成員將被忽略。 如果`mask`(或*nMask*`stateMask`) 指定TVIF_STATE值,則成員或*nStateMask*參數指定要更改的`state`項狀態,並且成員或*nState*參數包含這些狀態的值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a>CTreeCtrl::設定項目數據

呼叫此函數以設置與指定項關聯的特定於應用程式的值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要檢索其數據的項的句柄。

*dwData*<br/>
與*hItem*指定的項目關聯的指標大小的應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a>CTreeCtrl::設定專案擴展影像索引

將圖像的索引設置在當前樹視圖控制件的指定項處於展開狀態時顯示。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]處理樹視圖控件項。|
|*i 擴充影像*|[在]指定項處於展開狀態時要顯示的圖像索引。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息,這在 Windows SDK 中介紹。 此方法將*itvImage*參數`iExpandedImage`分配給[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員,然後在消息中使用該結構。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例是一個微不足道的測試,用於確定[CTreeCtrl::getItem 擴展圖像索引](#getitemexpandedimageindex)方法是否返回[CTreeCtrl::SetItem 擴展圖像索引](#setitemexpandedimageindex)方法設置的值。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a>CTreeCtrl::設定專案高度

此成員函數實現 Win32 消息[TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)的行為,如 Windows SDK 中所述。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>參數

*賽高地*<br/>
指定樹視圖中每個專案的新高度(以像素為單位)。 如果此參數小於圖像的高度,則它將設置為圖像的高度。 如果此參數不是偶數,它將向下舍入到最接近的偶數值。 如果此參數為 -1,則控制項將恢復為使用其預設項高度。

### <a name="return-value"></a>傳回值

項的上一個高度(以像素為單位)。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得專案高度](#getitemheight)。

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a>CTreeCtrl::設定項目圖像

將圖像與項目關聯。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設置其圖像的項的句柄。

*n 影像*<br/>
樹視圖控制件的圖像清單中項圖像的索引。

*n 選擇的影像*<br/>
樹視圖控制件的圖像清單中專案選取的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

樹視圖控制件中的每個項都可以具有與其關聯的一對位映射圖像。 圖像顯示在項目標籤的左側。 選擇項目時顯示一個圖像,另一個圖像在未選中項目時顯示。 例如,專案在選擇時可能會顯示打開的資料夾,在未選中時顯示關閉的資料夾。

呼叫此函數以在樹檢視控制件的圖像清單中設置專案圖像及其所選圖像的索引。

有關影像的詳細資訊,請參閱[CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得項目影像](#getitemimage)。

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a>CTreeCtrl::設定項目狀態

設定*hItem*指定的項目的狀態。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設置其狀態的項的句柄。

*n州*<br/>
指定專案的新狀態。

*nStateMask*<br/>
指定要更改哪些狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

有關狀態的資訊,請參閱[CTreeCtrl::取得專案](#getitem)。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得項目狀態](#getitemstate)。

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a>CTreeCtrl::設定項目狀態Ex

設置當前樹檢視控制項中指定項的擴展狀態。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]處理樹視圖控件項。|
|*uStateEx*|[在]項的擴展狀態。 有關詳細資訊,請參閱`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。|

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則,FALSE。

### <a name="remarks"></a>備註

此方法發送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)消息,這在 Windows SDK 中介紹。 此方法將*uStateEx*參數分配給`uStateEx`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員,然後在消息中使用該結構。

### <a name="example"></a>範例

以下代碼範例定義用於存取目前樹檢視`m_treeCtrl`控制項的變數 。 代碼示例還定義了無符號整數和幾個 HTREEITEM 變數。 這些變數在下一個示例中使用。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

以下代碼示例將樹視圖項設置為禁用狀態。 在代碼示例的早期版本(未顯示)中,我們創建了一個樹視圖,該視圖包括美國的根國家/區域節點、賓夕法尼亞州和華盛頓州的子節點以及這些州城市的樹項。 此代碼示例將賓夕法尼亞州節點設為禁用狀態。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a>CTreeCtrl::設定項目文字

設定*hItem*指定的項目的文字。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設置其文本的項的句柄。

*lpszItem*<br/>
引入項目新文字的字串的位址

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a>CTreeCtrl::設定線顏色

呼叫此成員函數以設定樹檢視控制項的當前線顏色。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
新線顏色。

### <a name="return-value"></a>傳回值

上一行顏色。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)的行為,如 Windows SDK 中所述。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a>CTreeCtrl::設置滾動時間

調用此成員函數以設置樹視圖控制項的最大滾動時間。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>參數

*uScrollTime*<br/>
新的最大滾動時間(以毫秒為單位)。 如果此值小於 100,則該值將四捨五入為 100。

### <a name="return-value"></a>傳回值

上一個最大滾動時間(以毫秒為單位)。

### <a name="remarks"></a>備註

此成員函數實現 Win32 消息[TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)的行為,如 Windows SDK 中所述。

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a>CTreeCtrl::設定文字顏色

此成員函數實現 Win32 消息[TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)的行為,如 Windows SDK 中所述。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*Clr*<br/>
包含新文字顏色的 COLORREF 值。 如果此參數為 -1,則控制項將恢復為使用文字顏色的系統顏色。

### <a name="return-value"></a>傳回值

表示上一個文字顏色的 COLORREF 值。 如果此值為 -1,則控制項使用文字顏色的系統顏色。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a>CTreeCtrl::設定工具提示

此成員函數實現 Win32 消息[TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)的行為,如 Windows SDK 中所述。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pwndTip*<br/>
指向樹控件將使用的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。

### <a name="return-value"></a>傳回值

指向包含控制項以前使用的工具提示的[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標,如果以前未使用工具提示,則指向 NULL。

### <a name="remarks"></a>備註

要使用工具提示,請指示創建`CTreeCtrl`物件時TVS_NOTOOLTIPS樣式。

### <a name="example"></a>範例

  請參閱[CTreeCtrl 的範例::取得工具提示](#gettooltips)。

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a>CTreeCtrl::顯示資訊提示

在目前樹檢視控制項中顯示指定項的資訊提示。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[在]控件中樹視圖項的句柄。 有關詳細資訊,請參閱`hItem`[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。|

### <a name="remarks"></a>備註

有關工具提示和資訊提示之間的差異的詳細資訊,請搜索[Microsoft 開發人員網路](https://go.microsoft.com/fwlink/p/?linkid=56322)上的「工具提示和資訊提示」主題。

此方法發送[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)訊息,這在 Windows SDK 中介紹。

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a>CTreeCtrl::排序兒童

調用此函數以字母順序對樹檢視控制項中給定父項的子項進行排序。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要排序子項的父項的句柄。 如果*hItem*為 NULL,則排序將從樹根進行。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

`SortChildren`不會通過樹再詛咒;只有*hItem*的直系子級才會排序。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a>CTreeCtrl::排序兒童CB

調用此函數,使用比較項的應用程式定義的回調函數對樹視圖項進行排序。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>參數

*pSort*<br/>
指向[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果第一個項應位於`lpfnCompare`第二個項之前,則結構的比較函數 () 必須返回負值;如果第一個項應遵循第二個項,則返回負值;如果兩個項等效,則返回 0。

*lParam1*和*lParam2*參數`lParam`對應於要 比較的兩個專案的[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的成員。 *lParamSort*參數對應`lParam``TV_SORTCB`於 結構的成員。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另請參閱

[MFC 樣品 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CImageList 類別](../../mfc/reference/cimagelist-class.md)
