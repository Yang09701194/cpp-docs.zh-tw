---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 830c3b39e08252029933addde7d31ab84819b336
ms.sourcegitcommit: fcb48824f9ca24b1f8bd37d647a4d592de1cc925
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/15/2019
ms.locfileid: "69502362"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 通用樹狀檢閱控制項的功能。

## <a name="syntax"></a>語法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|建構 `CTreeCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|說明|
|----------|-----------------|
|[CTreeCtrl::Create](#create)|建立樹狀檢視控制項，並將其附加至`CTreeCtrl`物件。|
|[CTreeCtrl::CreateDragImage](#createdragimage)|建立指定之樹狀檢視專案的拖曳點陣圖。|
|[CTreeCtrl::CreateEx](#createex)|建立具有指定之 Windows 擴充樣式的樹狀目錄控制項，並將其`CTreeCtrl`附加至物件。|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|刪除樹狀檢視控制項中的所有專案。|
|[CTreeCtrl::DeleteItem](#deleteitem)|刪除樹狀檢視控制項中的新專案。|
|[CTreeCtrl::EditLabel](#editlabel)|就地編輯指定的樹狀檢視專案。|
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|取消目前樹狀檢視控制項中樹狀檢視專案的標籤上的編輯作業。|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|確保樹狀檢視專案顯示在其樹狀檢視控制項中。|
|[CTreeCtrl::Expand](#expand)|展開或折迭指定之樹狀檢視專案的子專案。|
|[CTreeCtrl::GetBkColor](#getbkcolor)|抓取控制項目前的背景色彩。|
|[CTreeCtrl::GetCheck](#getcheck)|抓取樹狀目錄控制項專案的檢查狀態。|
|[CTreeCtrl::GetChildItem](#getchilditem)|抓取指定之樹狀檢視專案的子系。|
|[CTreeCtrl::GetCount](#getcount)|抓取與樹狀檢視控制項相關聯的樹狀目錄專案數目。|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|抓取拖放作業的目標。|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|抓取編輯控制項的控制碼，用來編輯指定的樹狀檢視專案。|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|抓取目前樹狀檢視控制項使用的延伸樣式。|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|抓取指定之樹狀檢視專案的第一個可見專案。|
|[CTreeCtrl::GetImageList](#getimagelist)|抓取與樹狀檢視控制項相關聯之影像清單的控制碼。|
|[CTreeCtrl::GetIndent](#getindent)|從父代抓取樹狀檢視專案的位移（以圖元為單位）。|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|抓取用來繪製樹狀檢視之插入標記的色彩。|
|[CTreeCtrl::GetItem](#getitem)|抓取指定之樹狀檢視專案的屬性。|
|[CTreeCtrl::GetItemData](#getitemdata)|傳回與專案相關聯之32位應用程式的特定值。|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|抓取目前樹狀檢視控制項的指定專案處於擴充狀態時，所要顯示的影像索引。|
|[CTreeCtrl::GetItemHeight](#getitemheight)|抓取樹狀檢視專案的目前高度。|
|[CTreeCtrl::GetItemImage](#getitemimage)|抓取與專案相關聯的影像。|
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|抓取目前樹狀檢視控制項中指定專案之指定部分的周框。|
|[CTreeCtrl::GetItemRect](#getitemrect)|抓取樹狀檢視專案的周框。|
|[CTreeCtrl::GetItemState](#getitemstate)|傳回專案的狀態。|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|抓取目前樹狀檢視控制項中指定專案的擴充狀態。|
|[CTreeCtrl::GetItemText](#getitemtext)|傳回專案的文字。|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|抓取目前樹狀檢視控制項中的最後一個展開專案。|
|[CTreeCtrl::GetLineColor](#getlinecolor)|抓取樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl::GetNextItem](#getnextitem)|抓取符合指定之關聯性的下一個樹狀檢視專案。|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|抓取指定之樹狀檢視專案的下一個兄弟。|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|抓取指定之樹狀檢視專案的下一個可見專案。|
|[CTreeCtrl::GetParentItem](#getparentitem)|抓取指定之樹狀檢視專案的父系。|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|抓取指定之樹狀檢視專案的上一個同級。|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|抓取指定之樹狀檢視專案的先前可見專案。|
|[CTreeCtrl::GetRootItem](#getrootitem)|抓取指定之樹狀檢視專案的根目錄。|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|抓取樹狀檢視控制項的最大滾動時間。|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|抓取目前樹狀檢視控制項中選取專案的數目。|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|抓取目前選取的樹狀檢視專案。|
|[CTreeCtrl::GetTextColor](#gettextcolor)|抓取控制項目前的文字色彩。|
|[CTreeCtrl::GetToolTips](#gettooltips)|抓取樹狀檢視控制項所使用之子工具提示控制項的控制碼。|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|抓取與樹狀檢視控制項相關聯之可見樹狀目錄專案的數目。|
|[CTreeCtrl::HitTest](#hittest)|傳回與`CTreeCtrl`物件相關之資料指標的目前位置。|
|[CTreeCtrl::InsertItem](#insertitem)|在樹狀檢視控制項中插入新專案。|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|如果指定的專案有子專案，則傳回非零。|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|將指定的存取範圍識別碼對應至目前樹狀檢視控制項中樹狀檢視專案的控制碼。|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|將指定的控制碼對應至目前樹狀檢視控制項中的樹狀檢視專案，以提供存取範圍識別碼。|
|[CTreeCtrl::Select](#select)|選取、滾動到視圖，或重新繪製指定的樹狀檢視專案。|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|重新繪製樹狀目錄專案作為拖放作業的目標。|
|[CTreeCtrl::SelectItem](#selectitem)|選取指定的樹狀檢視專案。|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|選取指定的樹狀檢視專案作為第一個可見專案。|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|設定目前樹狀檢視控制項的 autoscroll 速率。|
|[CTreeCtrl::SetBkColor](#setbkcolor)|設定控制項的背景色彩。|
|[CTreeCtrl::SetCheck](#setcheck)|設定樹狀目錄控制項專案的檢查狀態。|
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|設定目前樹狀檢視控制項的延伸樣式。|
|[CTreeCtrl::SetImageList](#setimagelist)|設定與樹狀檢視控制項相關聯之影像清單的控制碼。|
|[CTreeCtrl::SetIndent](#setindent)|設定樹狀檢視專案從其父系的位移（以圖元為單位）。|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|設定樹狀檢視控制項中的插入標記。|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製樹狀檢視之插入標記的色彩。|
|[CTreeCtrl::SetItem](#setitem)|設定指定之樹狀檢視專案的屬性。|
|[CTreeCtrl::SetItemData](#setitemdata)|設定與專案相關聯的32位應用程式特定值。|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|設定當目前樹狀檢視控制項的指定專案處於擴充狀態時，所要顯示的影像索引。|
|[CTreeCtrl::SetItemHeight](#setitemheight)|設定樹狀檢視專案的高度。|
|[CTreeCtrl::SetItemImage](#setitemimage)|將影像與專案產生關聯。|
|[CTreeCtrl::SetItemState](#setitemstate)|設定專案的狀態。|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|設定目前樹狀檢視控制項中指定專案的擴充狀態。|
|[CTreeCtrl::SetItemText](#setitemtext)|設定專案的文字。|
|[CTreeCtrl::SetLineColor](#setlinecolor)|設定樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|設定樹狀檢視控制項的最大滾動時間。|
|[CTreeCtrl::SetTextColor](#settextcolor)|設定控制項的文字色彩。|
|[CTreeCtrl::SetToolTips](#settooltips)|設定樹狀檢視控制項的子工具提示控制項。|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|顯示目前樹狀檢視控制項中指定專案的提示。|
|[CTreeCtrl::SortChildren](#sortchildren)|排序給定父專案的子系。|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|使用應用程式定義的排序函數，排序指定之父專案的子系。|

## <a name="remarks"></a>備註

「樹狀檢視控制項」是一個視窗，它會顯示專案的階層式清單，例如檔中的標題、索引中的專案，或磁片上的檔案和目錄。 每個項目都包含標籤和選擇性點陣圖影像，因此，每個項目都可以擁有與自己相關的子項目清單。 使用者可以按一下項目以展開和摺疊子項目的關聯清單。

這個控制項（因此`CTreeCtrl`類別）僅適用于在 windows 98 和 windows NT 4 版和更新版本下執行的程式。

如需有關使用`CTreeCtrl`的詳細資訊，請參閱：

- [控制項](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- Windows SDK 中的[樹狀檢視控制項參考](/windows/win32/Controls/tree-view-control-reference)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

##  <a name="create"></a>CTreeCtrl：： Create

如果您在對話方塊範本中指定樹狀目錄控制項，或如果您使用[CTreeView](../../mfc/reference/ctreeview-class.md)，則會在建立對話方塊或視圖時自動建立樹狀目錄控制項。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用如 [ [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)] 所述的視窗樣式，以及 [[樹狀檢視] 控制項樣式](/windows/win32/Controls/tree-view-control-window-styles)的任何組合，如 Windows SDK 中所述。

*rect*<br/>
指定樹狀檢視控制項的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/previous-versions/dd162897\(v=vs.85\))結構。

*pParentWnd*<br/>
指定樹狀檢視控制項的父視窗，通常是`CDialog`。 不得為 Null。

*nID*<br/>
指定樹狀檢視控制項的識別碼。

### <a name="return-value"></a>傳回值

如果初始化成功，則為非零;否則為0。

### <a name="remarks"></a>備註

如果您想要建立樹狀目錄控制項做為其他視窗的子視窗，請使用`Create`成員函式。 如果您使用`Create`建立樹狀目錄控制項，除了其他樹狀檢視樣式以外，您還必須傳遞它 WS_VISIBLE。

您可以使用`CTreeCtrl`兩個步驟來建立。 首先呼叫此函式，然後`Create`呼叫，它會建立樹狀檢視控制項並將其附加`CTreeCtrl`至物件。

若要建立具有延伸視窗樣式的樹狀目錄控制項，請呼叫[CreateEx](#createex)，而不是`Create`。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

##  <a name="createex"></a>CTreeCtrl：： CreateEx

呼叫這個函式以建立控制項（子視窗），並將它與`CTreeCtrl`物件產生關聯。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定所要建立之控制項的延伸樣式。 如需擴充 Windows 樣式的清單，請參閱 Windows SDK 中[CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw)的*dwExStyle*參數。

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用如 [ [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww)] 所述的視窗樣式，以及 [[樹狀檢視] 控制項樣式](/windows/win32/Controls/tree-view-control-window-styles)的任何組合，如 Windows SDK 中所述。

*rect*<br/>
[矩形](/previous-versions/dd162897\(v=vs.85\))結構的參考，描述要建立之視窗的大小和位置，以*pParentWnd*的用戶端座標表示。

*pParentWnd*<br/>
做為控制項父系之視窗的指標。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

如果成功，則為非零，否則為0。

### <a name="remarks"></a>備註

使用`CreateEx` ，而不是[Create](#create)來套用擴充的 windows 樣式（由 Windows 擴充樣式指定于**WS_EX_** 的前面）。

##  <a name="createdragimage"></a>CTreeCtrl：： CreateDragImage

呼叫此函式可針對樹狀檢視控制項中的指定專案建立拖曳點陣圖、建立點陣圖的影像清單，以及將點陣圖新增至影像清單。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要拖曳之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

已加入拖曳點陣圖之影像清單的指標（如果成功）;否則為 Null。

### <a name="remarks"></a>備註

當拖曳專案時，應用程式會使用影像清單功能來顯示影像。

物件`CImageList`是永久的，而且您必須在完成時將它刪除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

##  <a name="ctreectrl"></a>CTreeCtrl：： CTreeCtrl

建構 `CTreeCtrl` 物件。

```
CTreeCtrl();
```

##  <a name="deleteallitems"></a>CTreeCtrl：:D eleteAllItems

呼叫此函式可從樹狀檢視控制項中刪除所有專案。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

##  <a name="deleteitem"></a>CTreeCtrl：:D eleteItem

呼叫此函式可從樹狀檢視控制項中刪除專案。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要刪除之樹狀結構專案的控制碼。 如果*hitem*具有 TVI_ROOT 值，則會從樹狀檢視控制項中刪除所有專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

##  <a name="editlabel"></a>CTreeCtrl：： EditLabel

呼叫此函式可開始就地編輯指定的專案文字。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要編輯之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為用來`CEdit`編輯專案文字之物件的指標; 否則為 Null。

### <a name="remarks"></a>備註

藉由以包含文字的單行編輯控制項取代專案的文字，即可完成編輯。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

##  <a name="endeditlabelnow"></a>CTreeCtrl：： EndEditLabelNow

結束目前樹狀檢視控制項中樹狀檢視專案標籤上的編輯作業。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*fCancelWithoutSave*|在TRUE 表示在結束編輯作業之前捨棄樹狀檢視專案的變更，或 FALSE 則會在結束作業之前，先將變更儲存至樹狀檢視專案。|

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_ENDEDITLABELNOW](/windows/win32/Controls/tvm-endeditlabelnow)訊息，如 Windows SDK 中所述。

##  <a name="ensurevisible"></a>CTreeCtrl：： EnsureVisible

呼叫此函式可確保樹狀檢視專案可見。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要顯示之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果系統滾動樹狀檢視控制項中的專案，以確保可以看見指定的專案，則傳回 TRUE。 否則，傳回值為 FALSE。

### <a name="remarks"></a>備註

如有必要，函式會展開父專案，或滾動樹狀檢視控制項，讓專案可見。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

##  <a name="expand"></a>CTreeCtrl：： Expand

呼叫此函式可展開或折迭與指定的父專案相關聯之子專案的清單（如果有的話）。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要展開之樹狀結構專案的控制碼。

*nCode*<br/>
表示要採取之動作類型的旗標。 此旗標可以具有下列其中一個值：

- TVE_COLLAPSE 折迭清單。

- TVE_COLLAPSERESET 折迭清單並移除子專案。 TVIS_EXPANDEDONCE 狀態旗標會重設。 此旗標必須與 TVE_COLLAPSE 旗標搭配使用。

- TVE_EXPAND 會展開清單。

- TVE_TOGGLE 會折迭目前已展開的清單，如果目前已折迭，則會將它展開。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： EnsureVisible](#ensurevisible)的範例。

##  <a name="getbkcolor"></a>CTreeCtrl：： GetBkColor

此成員函式會執行 Win32 message [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor)的行為，如 Windows SDK 中所述。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

COLORRE光圈值，表示控制項目前的視窗背景色彩。 如果此值為-1，則控制項會使用系統視窗色彩。 在此情況下，您可以`::GetSysColor(COLOR_WINDOW)`使用來取得控制項目前使用的系統色彩。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetTextColor](#settextcolor)的範例。

##  <a name="getcheck"></a>CTreeCtrl：： GetCheck

呼叫這個成員函式以抓取專案的檢查狀態。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要接收狀態資訊的 HTREEITEM。

### <a name="return-value"></a>傳回值

如果選取樹狀目錄控制項專案，則為非零;否則為0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetCheck](#setcheck)的範例。

##  <a name="getchilditem"></a>CTreeCtrl：： GetChildItem

呼叫此函式可抓取樹狀檢視專案，這是由*hItem*所指定之專案的子系。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為子專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

##  <a name="getcount"></a>CTreeCtrl：： GetCount

呼叫此函式可取得樹狀檢視控制項中的專案計數。

```
UINT GetCount() const;
```

### <a name="return-value"></a>傳回值

樹狀檢視控制項中的專案數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

##  <a name="getdrophilightitem"></a>CTreeCtrl：： GetDropHilightItem

呼叫此函式可抓取做為拖放作業目標的專案。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>傳回值

如果成功，則會捨棄專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="geteditcontrol"></a>CTreeCtrl：： GetEditControl

呼叫此函式可抓取編輯控制項的控制碼，用來編輯樹狀檢視專案的文字。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

用來編輯專案文字的編輯控制項指標（如果成功）;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

##  <a name="getextendedstyle"></a>CTreeCtrl：： GetExtendedStyle

抓取目前樹狀檢視控制項使用的延伸樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

值，其中包含目前樹狀檢視控制項的延伸樣式的位元組合（或）。 如需詳細資訊，請參閱[樹狀檢視控制項延伸樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETEXTENDEDSTYLE](/windows/win32/Controls/tvm-getextendedstyle)訊息，如 Windows SDK 中所述。

##  <a name="getfirstvisibleitem"></a>CTreeCtrl：： GetFirstVisibleItem

呼叫此函式可抓取樹狀檢視控制項的第一個可見專案。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>傳回值

第一個可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetCheck](#setcheck)的範例。

##  <a name="getimagelist"></a>CTreeCtrl：： GetImageList

呼叫此函式可抓取與樹狀檢視控制項相關聯之一般或狀態影像清單的控制碼。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>參數

*nImageList*<br/>
要取出之影像清單的類型。 影像清單可以是下列其中一個值：

- TVSIL_NORMAL 會抓取一般影像清單，其中包含樹狀檢視專案所選取和 nonselected 的影像。

- TVSIL_STATE 會抓取狀態影像清單，其中包含處於使用者定義狀態之樹狀檢視專案的影像。

### <a name="return-value"></a>傳回值

如果成功，則為控制項影像清單的指標;否則為 Null。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個專案都可以有一對與它相關聯的點陣圖影像。 當選取專案時，會顯示一個影像，另一個則會在未選取專案時顯示。 例如，專案可能會在選取時顯示開啟的資料夾，而當未選取時，則會顯示 [已關閉] 資料夾。

如需影像清單的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)類別。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

##  <a name="getindent"></a>CTreeCtrl：： Setindent

呼叫這個函式以圖元為單位，抓取子專案相對於其父專案的縮排量。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>傳回值

以圖元為單位的縮排量。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

##  <a name="getinsertmarkcolor"></a>CTreeCtrl：： GetInsertMarkColor

此成員函式會執行 Win32 message [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor)的行為，如 Windows SDK 中所述。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

包含目前插入標記色彩的 COLORRE光圈值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

##  <a name="getitem"></a>CTreeCtrl：： GetItem

呼叫此函式可抓取指定之樹狀檢視專案的屬性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標，如 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：:D eleteitem](#deleteitem)的範例。

##  <a name="getitemdata"></a>CTreeCtrl：： GetItemData

呼叫此函式可取得與指定專案相關聯的32位應用程式特定值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其資料之專案的控制碼。

### <a name="return-value"></a>傳回值

與*hItem*所指定之專案相關聯的32位應用程式特定值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

##  <a name="getitemexpandedimageindex"></a>CTreeCtrl：： GetItemExpandedImageIndex

抓取目前樹狀檢視控制項的指定專案處於擴充狀態時，所要顯示的影像索引。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|在樹狀檢視控制項專案的控制碼。|

### <a name="return-value"></a>傳回值

當指定的專案處於擴充狀態時，所要顯示之影像的索引。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)訊息，如 Windows SDK 中所述。 該訊息會傳回描述樹狀檢視控制項專案的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構，然後這個方法`iExpandedImage`會從該結構抓取成員。

##  <a name="getitemheight"></a>CTreeCtrl：： GetItemHeight

此成員函式會執行 Win32 message [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight)的行為，如 Windows SDK 中所述。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>傳回值

專案的高度（以圖元為單位）。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

##  <a name="getitemimage"></a>CTreeCtrl：： GetItemImage

樹狀檢視控制項中的每個專案都可以有一對與它相關聯的點陣圖影像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其影像之專案的控制碼。

*nImage*<br/>
在樹狀檢視控制項的影像清單中接收專案影像索引的整數。

*nSelectedImage*<br/>
在樹狀檢視控制項的影像清單中，接收專案選取之影像索引的整數。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

影像會出現在專案標籤的左側。 當選取專案時，會顯示一個影像，另一個則會在未選取專案時顯示。 例如，專案可能會在選取時顯示開啟的資料夾，而當未選取時，則會顯示 [已關閉] 資料夾。

呼叫此函式可在樹狀檢視控制項的影像清單中，抓取專案影像的索引和其選取的影像。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

##  <a name="getitempartrect"></a>CTreeCtrl：： GetItemPartRect

抓取目前樹狀檢視控制項中指定專案之指定部分的周框。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>參數

|參數|說明|
|---------------|-----------------|
|*hItem*|在樹狀檢視控制項專案的控制碼。|
|*nPart*|在元件的識別碼。 必須設定為 TVGIPR_BUTTON。|
|*lpRect*|脫銷[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標。 如果此方法成功，結構會接收*hItem*和*nPart*所指定之元件的矩形座標。|

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

每個樹狀目錄控制項專案都是由圖形矩形所限制。 只要按下該矩形中的某個點，就會*叫用此專案。* 這個方法會傳回最大的矩形，因此當按下矩形中的某個點時，就會叫用*hItem*參數所識別的專案。

這個方法會傳送 TVM_GETITEMPARTRECT 訊息，如 Windows SDK 中所述。 如需詳細資訊，請參閱[TreeView_GetItemPartRect](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)宏。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別碼和[CTreeCtrl：： MapAccIdToItem](#mapaccidtoitem)方法，來抓取根樹狀檢視專案的控制碼。 然後，此範例會使用控制碼和[CTreeCtrl：： GetItemPartRect](#getitempartrect)方法，在該專案周圍繪製3d 矩形。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 我們使用了[CTreeCtrl：： MapItemToAccID](#mapitemtoaccid)方法，將根樹狀檢視專案與存取範圍識別碼產生關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="getitemrect"></a>CTreeCtrl：： GetItemRect

呼叫此函式可抓取*hItem*的周框，並判斷它是否為可見的。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀檢視控制項專案的控制碼。

*lpRect*<br/>
接收周框之[RECT](/previous-versions/dd162897\(v=vs.85\))結構的指標。 座標相對於樹狀檢視控制項的左上角。

*bTextOnly*<br/>
如果此參數為非零值，周框矩形只會包含專案的文字。 否則，它會包含專案在樹狀檢視控制項中佔用的整行。

### <a name="return-value"></a>傳回值

如果專案是可見的，則為非零，包含在*lpRect*中的周框矩形。 否則為0，且*lpRect*未初始化。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

##  <a name="getitemstate"></a>CTreeCtrl：： GetItemState

傳回*hItem*所指定之專案的狀態。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其狀態之專案的控制碼。

*nStateMask*<br/>
遮罩，表示要抓取的一或多個狀態。 如需*nStateMask*可能值的詳細資訊，請參閱中的`state`和 `stateMask` [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) 結構的成員討論 Windows SDK。

### <a name="return-value"></a>傳回值

包含 nStateMask 所指定值之位 OR 的 UINT。 如需可能值的資訊，請參閱[CTreeCtrl：： GetItem](#getitem)。 若要尋找特定狀態的值，請執行 state 值和傳回值的位 AND 運算，如下列範例所示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

##  <a name="getitemstateex"></a>CTreeCtrl：： GetItemStateEx

抓取目前樹狀檢視控制項中指定專案的擴充狀態。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|在樹狀檢視控制項專案的控制碼。|

### <a name="return-value"></a>傳回值

專案的擴充狀態。 如需詳細資訊，請`uStateEx`參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETITEM](/windows/win32/Controls/tvm-getitem)訊息，如 Windows SDK 中所述。 該訊息會傳回描述樹狀檢視控制項專案的[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構，而這個方法`uStateEx`會從該結構抓取成員。

##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText

傳回*hItem*所指定之專案的文字。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其文字之專案的控制碼。

### <a name="return-value"></a>傳回值

`CString`物件，其中包含專案的文字。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetNextItem](#getnextitem)的範例。

##  <a name="getlastvisibleitem"></a>CTreeCtrl：： GetLastVisibleItem

抓取目前樹狀檢視控制項中最後一個未展開的節點專案。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>傳回值

如果方法成功，則為最後一個未展開的節點專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETNEXTITEM](/windows/win32/Controls/tvm-getnextitem)訊息，如 Windows SDK 中所述。 如需詳細資訊，請參閱該訊息的*旗*標參數中的 TVGN_LASTVISIBLE 旗標。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數的其中一個或多個。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會抓取最後一個未展開之樹狀檢視節點專案的控制碼，然後在該專案周圍繪製3D 矩形。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

##  <a name="getlinecolor"></a>CTreeCtrl：： GetLineColor

此成員函式會執行 win32 message [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor)的行為，如 Windows SDK 中所述。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>傳回值

目前的線條色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

##  <a name="getnextitem"></a>CTreeCtrl：： GetNextItem

呼叫此函式可將具有指定之關聯性（由*nCode*參數表示）的樹狀檢視專案，抓取至*hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

*nCode*<br/>
表示要*hItem*之關聯類型的旗標。 此旗標可以是下列其中一個值：

- TVGN_CARET 會抓取目前選取的專案。

- TVGN_CHILD 會抓取*hItem*參數所指定之專案的第一個子專案。

- TVGN_DROPHILITE 會抓取做為拖放作業目標的專案。

- TVGN_FIRSTVISIBLE 會抓取第一個可見的專案。

- TVGN_LASTVISIBLE 會抓取樹狀結構中的最後一個展開專案。 這不會抓取樹狀檢視視窗中顯示的最後一個專案。

- TVGN_NEXT 會抓取下一個兄弟專案。

- TVGN_NEXTVISIBLE 會抓取指定專案之後的下一個可見專案。

- TVGN_PARENT 會抓取指定專案的父系。

- TVGN_PREVIOUS 會抓取上一個兄弟專案。

- TVGN_PREVIOUSVISIBLE 會抓取位於指定專案之前的第一個可見專案。

- TVGN_ROOT 會抓取所指定專案所屬之根專案的第一個子專案。

### <a name="return-value"></a>傳回值

如果成功，則為下一個專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

如果要抓取的專案是樹狀結構的根節點，則此函式會傳回 Null。 例如，如果您在樹狀檢視的根節點的第一層子系上使用此訊息搭配 TVGN_PARENT 旗標，則訊息會傳回 Null。

### <a name="example"></a>範例

如需在迴圈中`GetNextItem`使用的範例，請參閱[CTreeCtrl：:D eleteitem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

##  <a name="getnextsiblingitem"></a>CTreeCtrl：： GetNextSiblingItem

呼叫此函式可取出*hItem*的下一個兄弟。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

下一個兄弟專案的控制碼。否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

##  <a name="getnextvisibleitem"></a>CTreeCtrl：： GetNextVisibleItem

呼叫此函式可取出*hItem*的下一個可見專案。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

下一個可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetCheck](#setcheck)的範例。

##  <a name="getparentitem"></a>CTreeCtrl：： GetParentItem

呼叫此函式可取得*hItem*的父系。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

父代專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

如果指定專案的父系是樹狀結構的根節點，則此函式會傳回 Null。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： EnsureVisible](#ensurevisible)的範例。

##  <a name="getprevsiblingitem"></a>CTreeCtrl：： GetPrevSiblingItem

呼叫此函式可抓取*hItem*的前一個兄弟。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

上一個同級的控制碼。否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

##  <a name="getprevvisibleitem"></a>CTreeCtrl：： GetPrevVisibleItem

呼叫此函式可抓取*hItem*的先前可見專案。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

先前可見專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

##  <a name="getrootitem"></a>CTreeCtrl：： GetRootItem

呼叫此函式可抓取樹狀檢視控制項的根專案。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>傳回值

根專案的控制碼;否則為 Null。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： EditLabel](#editlabel)的範例。

##  <a name="getscrolltime"></a>CTreeCtrl：： GetScrollTime

呼叫這個成員函式，以取得樹狀檢視控制項的最大滾動時間。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>傳回值

滾動時間上限（以毫秒為單位）。

### <a name="remarks"></a>備註

此成員函式會執行 win32 message [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime)的行為，如 Windows SDK 中所述。

##  <a name="getselectedcount"></a>CTreeCtrl：： GetSelectedCount

抓取目前樹狀檢視控制項中選取專案的數目。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>傳回值

所選取專案的數目。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETSELECTEDCOUNT](/windows/win32/Controls/tvm-getselectedcount)訊息，如 Windows SDK 中所述。

##  <a name="getselecteditem"></a>CTreeCtrl：： GetSelectedItem

呼叫此函式可取得目前選取的樹狀檢視控制項專案。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

所選取專案的控制碼;否則為 Null。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

##  <a name="gettextcolor"></a>CTreeCtrl：： GetTextColor

此成員函式會執行 Win32 message [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor)的行為，如 Windows SDK 中所述。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

代表目前文字色彩的 COLORRE光圈值。 如果此值為-1，則控制項會使用文字色彩的系統色彩。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetTextColor](#settextcolor)的範例。

##  <a name="gettooltips"></a>CTreeCtrl：： GetToolTips

此成員函式會執行 Win32 message [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips)的行為，如 Windows SDK 中所述。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

樹狀目錄控制項所要使用之[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。 如果[Create](#create)成員函式使用樣式 TVS_NOTOOLTIPS，則不會使用任何工具提示，而且會傳回 Null。

### <a name="remarks"></a>備註

的 MFC 執行`GetToolTips` `CToolTipCtrl`會傳回物件，此物件是由樹狀結構控制項所使用，而不是工具提示控制項的控制碼。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

##  <a name="getvisiblecount"></a>CTreeCtrl：： GetVisibleCount

呼叫此函式可取得樹狀檢視控制項中可見專案的計數。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>傳回值

樹狀檢視控制項中可見專案的數目;否則為-1。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetCheck](#setcheck)的範例。

##  <a name="hittest"></a>CTreeCtrl：： HitTest

呼叫此函式可判斷相對於樹狀檢視控制項工作區之指定點的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
要測試之點的用戶端座標。

*pFlags*<br/>
整數的指標，接收點擊測試結果的相關資訊。 它可以是 [備註] 區段中的`flags`成員底下所列出的一或多個值。

*pHitTestInfo*<br/>
[TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo)結構的位址，其中包含要進行點擊測試的位置，並接收點擊測試結果的相關資訊。

### <a name="return-value"></a>傳回值

如果樹狀檢視專案的控制碼佔用指定的點，則為; 如果沒有任何專案，則為 Null。

### <a name="remarks"></a>備註

呼叫這個函式時， *pt*參數會指定要測試之點的座標。 函式會傳回位於指定點之專案的控制碼，如果沒有任何專案佔用點則為 Null。 此外， *pFlags*參數包含一個值，表示指定點的位置。 可能的值為：

|||
|-|-|
|值|意義|
|TVHT_ABOVE|在工作區上方。|
|TVHT_BELOW|在工作區底下。|
|TVHT_NOWHERE|在工作區中，但在最後一個專案之下。|
|TVHT_ONITEM|在與專案相關聯的點陣圖或標籤上。|
|TVHT_ONITEMBUTTON|與專案相關聯的按鈕。|
|TVHT_ONITEMICON|在與專案相關聯的點陣圖上。|
|TVHT_ONITEMINDENT|與專案相關聯的縮排。|
|TVHT_ONITEMLABEL|與專案相關聯的標籤（字串）。|
|TVHT_ONITEMRIGHT|在專案右邊的區域中。|
|TVHT_ONITEMSTATEICON|在處於使用者定義狀態之樹狀檢視專案的狀態圖示上。|
|TVHT_TOLEFT|在工作區的左邊。|
|TVHT_TORIGHT|在工作區的右邊。|
|||

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="insertitem"></a>CTreeCtrl：： InsertItem

呼叫此函式可在樹狀檢視控制項中插入新專案。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>參數

*lpInsertStruct*<br/>
的指標`TVINSERTSTRUCT` ，指定要插入之樹狀檢視專案的屬性。

*nMask*<br/>
指定要設定之屬性的整數。 請參閱`TVITEM` Windows SDK 中的結構。

*lpszItem*<br/>
包含專案文字之字串的位址。

*nImage*<br/>
樹狀檢視控制項的影像清單中，專案影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中，專案所選取影像的索引。

*nState*<br/>
指定專案狀態的值。 如需適當狀態的清單，請參閱 Windows SDK 中的樹狀檢視控制項專案狀態。

*nStateMask*<br/>
指定要設定的狀態。 請參閱`TVITEM` Windows SDK 中的結構。

*lParam*<br/>
與專案相關聯的32位應用程式特定值。

*hParent*<br/>
插入專案之父系的控制碼。

*hInsertAfter*<br/>
要插入新專案之專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功，則為新專案的控制碼;否則為 Null。

### <a name="remarks"></a>備註

這個範例會示範在插入樹狀目錄控制項專案時，您可能會想要使用每個函式版本的情況。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

##  <a name="itemhaschildren"></a>CTreeCtrl：： ItemHasChildren

使用此函式來判斷*hItem*所指定的樹狀結構專案是否有子專案。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果*hItem*所指定的樹狀結構專案有子專案，則為非零值;如果不是，則為0。

### <a name="remarks"></a>備註

若是如此，您就可以使用[CTreeCtrl：： GetChildItem](#getchilditem)來取出這些子專案。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetSelectedItem](#getselecteditem)的範例。

##  <a name="mapaccidtoitem"></a>CTreeCtrl：： MapAccIdToItem

將指定的存取範圍識別碼對應至目前樹狀檢視控制項中樹狀檢視專案的控制碼。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uAccId*|在樹狀檢視專案中元素的存取範圍識別碼。|

### <a name="return-value"></a>傳回值

對應至 uAccId 參數之樹狀檢視專案（ `HTREEITEM`）的控制碼。 如需詳細資訊，請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。

### <a name="remarks"></a>備註

協助工具輔助是協助殘障人士使用電腦的應用程式。 `IAccessible`介面會使用存取範圍識別碼，在視窗中唯一指定元素。 如需有關協助工具識別碼的詳細資訊，請在[Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)搜尋「關於 Active Accessibility 支援」主題。

這個方法會傳送[TVM_MAPACCIDTOHTREEITEM](/windows/win32/Controls/tvm-mapaccidtohtreeitem)訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別碼和[CTreeCtrl：： MapAccIdToItem](#mapaccidtoitem)方法，來抓取根樹狀檢視專案的控制碼。 此範例會使用 handle 和[CTreeCtrl：： GetItemPartRect](#getitempartrect)方法，在該專案周圍繪製3d 矩形。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 我們使用了[CTreeCtrl：： MapItemToAccID](#mapitemtoaccid)方法，將根樹狀檢視專案與存取範圍識別碼產生關聯。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="mapitemtoaccid"></a>CTreeCtrl：： MapItemToAccID

將目前樹狀檢視控制項中樹狀檢視專案的指定控制碼對應至存取範圍識別碼。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|在控制項中樹狀檢視專案的控制碼。 如需詳細資訊，請參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的*hItem*成員。|

### <a name="return-value"></a>傳回值

對應至*hItem*參數的存取範圍識別碼。

### <a name="remarks"></a>備註

協助工具輔助是協助殘障人士使用電腦的應用程式。 `IAccessible`介面會使用存取範圍識別碼，在視窗中唯一指定元素。 如需有關協助工具識別碼的詳細資訊，請在[Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)搜尋「關於 Active Accessibility 支援」主題。

這個方法會傳送[TVM_MAPHTREEITEMTOACCID](/windows/win32/Controls/tvm-maphtreeitemtoaccid)訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會取得樹狀檢視控制項專案的識別碼。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 這個程式碼範例會取得根國家/地區節點的唯一識別碼。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

##  <a name="select"></a>CTreeCtrl：： Select

呼叫此函式以選取給定的樹狀檢視專案、將專案拖曳到 view 中，或以用來表示拖放作業目標的樣式重新繪製專案。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

*nCode*<br/>
要採取的動作類型。 這個參數可以是下列其中一個值：

- TVGN_CARET 會將選取範圍設定為指定的專案。

- TVGN_DROPHILITE 會以用來表示拖放作業目標的樣式來重新繪製指定的專案。

- TVGN_FIRSTVISIBLE 會垂直捲動樹狀檢視，讓指定的專案是第一個可見的專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*nCode*包含 TVGN_CARET 值，父視窗會收到 TVN_SELCHANGING 和 TVN_SELCHANGED 通知訊息。 此外，如果指定的專案是折迭父專案的子系，則會展開父系的子專案清單，以顯示指定的專案。 在此情況下，父視窗會接收 TVN_ITEMEXPANDING 和 TVN_ITEMEXPANDED 通知訊息。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： HitTest](#hittest)的範例。

##  <a name="selectdroptarget"></a>  CTreeCtrl::SelectDropTarget

呼叫此函式可重繪用來表示拖放作業目標的樣式專案。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="selectitem"></a>CTreeCtrl：： SelectItem

呼叫此函式以選取給定的樹狀檢視專案。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*hItem*為 Null，則此函式不會選取任何專案。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="selectsetfirstvisible"></a>CTreeCtrl：： SelectSetFirstVisible

呼叫這個函式以垂直方式滾動樹狀檢視，讓指定的專案是第一個可見的專案。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定為第一個可見專案之樹狀結構專案的控制碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

函式會使用 TVM_SELECTITEM 和 TVGN_FIRSTVISIBLE 訊息參數將訊息傳送至視窗。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo

設定目前樹狀檢視控制項的 autoscroll 速率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uPixelsPerSec*|在每秒要滾動的圖元數。|
|*uUpdateTime*|在控制項更新之間的時間間隔。|

### <a name="return-value"></a>傳回值

一律傳回 TRUE。

### <a name="remarks"></a>備註

Autoscroll 參數是用來將目前看不到的專案向外流覽。 樹狀檢視控制項必須具有 TVS_EX_AUTOHSCROLL 擴充樣式，如[樹狀檢視控制項延伸樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所述。

這個方法會傳送[TVM_SETAUTOSCROLLINFO](/windows/win32/Controls/tvm-setautoscrollinfo)訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會設定目前樹狀檢視控制項的 autoscroll 行為。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 我們刻意讓樹狀檢視控制項縮小，使其必須自動滾動，以顯示具有焦點的樹狀結構專案。 此程式碼範例會將樹狀檢視控制項設定為每隔5秒自動滾動30圖元，直到樹狀結構專案處於檢視狀態為止。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

##  <a name="setbkcolor"></a>CTreeCtrl：： SetBkColor

此成員函式會執行 Win32 message [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor)的行為，如 Windows SDK 中所述。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*clr*<br/>
包含新背景色彩的 COLORRE光圈值。 如果此值為-1，控制項將會還原為使用背景色彩的系統色彩。

### <a name="return-value"></a>傳回值

代表目前文字色彩的 COLORRE光圈值。 如果此值為-1，則控制項會使用文字色彩的系統色彩。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： SetTextColor](#settextcolor)的範例。

##  <a name="setcheck"></a>CTreeCtrl：： SetCheck

呼叫這個成員函式可設定樹狀目錄控制項專案的檢查狀態。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要接收檢查狀態變更的 HTREEITEM。

*fCheck*<br/>
指出是否要檢查或取消選取樹狀目錄控制項專案。 根據預設， `SetCheck`會設定要檢查的專案。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

當核取樹狀目錄控制項專案時（*來*設定為 TRUE），專案會以連續的核取記號顯示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>範例

若要使用核取方塊，請在填入樹狀目錄控制項之前，先設定 TVS_CHECKBOXES。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

##  <a name="setextendedstyle"></a>CTreeCtrl：： SetExtendedStyle

設定目前樹狀檢視控制項的延伸樣式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*dwExMask*|在位元遮罩，指定目前樹狀檢視控制項中的哪些樣式受此方法影響。 如果此參數為零，則會忽略它，並將*dwExStyles*參數的值指派給樹狀檢視控制項。<br /><br /> 指定[樹狀檢視控制項延伸樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所描述的零或位元組合（or）。|
|*dwExStyles*|在位元遮罩，指定要設定或清除的目前樹狀檢視控制項中的樣式。<br /><br /> 若要設定樣式的組合，請指定[樹狀檢視控制項延伸樣式](/windows/win32/Controls/tree-view-control-window-extended-styles)中所述樣式的位元組合（or）。 若要清除一組樣式，請指定零。|

### <a name="return-value"></a>傳回值

值，其中包含先前的擴充控制項樣式。

### <a name="remarks"></a>備註

這個方法會清除*dwExMask*參數中指定的樣式，然後設定*dwExStyles*參數中指定的樣式。 只有對應到*dwExMask*中之位的擴充樣式會變更。

這個方法會傳送[TVM_SETEXTENDEDSTYLE](/windows/win32/Controls/tvm-setextendedstyle)訊息，如 Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會將 TVS_EX_AUTOHSCROLL 擴充樣式加入至目前的樹狀檢視控制項。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 我們刻意讓樹狀檢視控制項縮小，使其必須自動滾動，以顯示具有焦點的樹狀結構專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

##  <a name="setimagelist"></a>CTreeCtrl：： SetImageList

呼叫此函式可設定樹狀檢視控制項的一般或狀態影像清單，並使用新的影像重新繪製控制項。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
要指派之影像清單的指標。 如果*pImageList*為 Null，則會從樹狀檢視控制項中移除所有影像。

*nImageListType*<br/>
要設定之影像清單的類型。 影像清單可以是下列其中一個值：

- TVSIL_NORMAL 會設定標準影像清單，其中包含樹狀檢視專案的選取和 nonselected 影像。 您必須將此狀態用於重迭影像。

- TVSIL_STATE 會設定狀態影像清單，其中包含處於使用者定義狀態之樹狀檢視專案的影像。

### <a name="return-value"></a>傳回值

先前影像清單的指標（如果有的話）。否則為 Null。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetImageList](#getimagelist)的範例。

##  <a name="setindent"></a>CTreeCtrl：： SetIndent

呼叫此函式可設定樹狀檢視控制項的縮排寬度，並重繪控制項以反映新的寬度。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>參數

*nIndent*<br/>
縮排的寬度（以圖元為單位）。 如果*nIndent*小於系統定義的最小寬度，新的寬度會設定為系統定義的最小值。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： setindent](#getindent)的範例。

##  <a name="setinsertmark"></a>CTreeCtrl：： SetInsertMark

此成員函式會執行 Win32 message [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark)的行為，如 Windows SDK 中所述。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
HTREEITEM，指定將放置插入標記的專案。 如果這個引數為 Null，則會移除插入標記。

*fAfter*<br/>
布林值，指定插入標記是否放在指定的專案之前或之後。 如果這個引數不是零，則插入標記會放在專案之後。 如果這個引數為零，則插入標記會放在專案之前。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

##  <a name="setinsertmarkcolor"></a>CTreeCtrl：： SetInsertMarkColor

此成員函式會執行 Win32 message [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor)的行為，如 Windows SDK 中所述。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
包含新插入標記色彩的 COLORRE光圈值。

### <a name="return-value"></a>傳回值

包含上一個插入標記色彩的 COLORRE光圈值。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetInsertMarkColor](#getinsertmarkcolor)的範例。

##  <a name="setitem"></a>CTreeCtrl：： SetItem

呼叫此函式可設定指定之樹狀檢視專案的屬性。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的指標，其中包含新的專案屬性，如 Windows SDK 中所述。

*hItem*<br/>
要設定其屬性之專案的控制碼。 請參閱 Windows SDK 中`TVITEM`結構的成員。`hItem`

*nMask*<br/>
指定要設定之屬性的整數。 請參閱`TVITEM`結構的成員。`mask`

*lpszItem*<br/>
包含專案文字之字串的位址。

*nImage*<br/>
樹狀檢視控制項的影像清單中，專案影像的索引。 請參閱`TVITEM`結構的成員。`iImage`

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中，專案所選取影像的索引。 請參閱`TVITEM`結構的成員。`iSelectedImage`

*nState*<br/>
指定專案狀態的值。 請參閱`TVITEM`結構的成員。`State`

*nStateMask*<br/>
指定要設定的狀態。 請參閱`TVITEM`結構的成員。`stateMask`

*lParam*<br/>
與專案相關聯的32位應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

在結構中`hItem` ，成員會識別專案，而`mask`成員會指定要設定的屬性。 `TVITEM`

`pszText` `cchTextMax`如果成員或 nMask 參數指定 TVIF_TEXT 值，則成員或 lpszItem 就是以 null 結束的字串位址，而該成員會被忽略。 `mask` 如果`mask` （或*nMask*）指定 TVIF_STATE 值，則`stateMask`成員或*nStateMask* `state`參數會指定要變更的專案狀態，而 member 或*nState*參數會包含的值。這些狀態。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

##  <a name="setitemdata"></a>CTreeCtrl：： SetItemData

呼叫此函式可設定與指定專案相關聯的32位應用程式特定值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要抓取其資料之專案的控制碼。

*dwData*<br/>
與*hItem*所指定之專案相關聯的32位應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

##  <a name="setitemexpandedimageindex"></a>CTreeCtrl：： SetItemExpandedImageIndex

設定當目前樹狀檢視控制項的指定專案處於擴充狀態時，所要顯示的影像索引。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>參數

|參數|說明|
|---------------|-----------------|
|*hItem*|在樹狀檢視控制項專案的控制碼。|
|*iExpandedImage*|在當指定的專案處於擴充狀態時，所要顯示之影像的索引。|

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)訊息，如 Windows SDK 中所述。 這個方法會將*iExpandedImage*參數指派給`iExpandedImage` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員，然後在訊息中使用該結構。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例是一個簡單的測試，用來判斷[CTreeCtrl：： GetItemExpandedImageIndex](#getitemexpandedimageindex)方法是否會傳回[CTreeCtrl：： SetItemExpandedImageIndex](#setitemexpandedimageindex)方法所設定的值。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

##  <a name="setitemheight"></a>CTreeCtrl：： SetItemHeight

此成員函式會執行 Win32 message [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight)的行為，如 Windows SDK 中所述。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>參數

*cyHeight*<br/>
指定樹狀檢視中每個專案的新高度（以圖元為單位）。 如果這個引數小於影像的高度，則會設定為影像的高度。 如果這個引數不是偶數，則會四捨五入到最接近的偶數值。 如果這個引數為-1，控制項將會還原為使用其預設專案高度。

### <a name="return-value"></a>傳回值

先前的專案高度（以圖元為單位）。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetItemHeight](#getitemheight)的範例。

##  <a name="setitemimage"></a>CTreeCtrl：： SetItemImage

將影像與專案產生關聯。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其影像之專案的控制碼。

*nImage*<br/>
樹狀檢視控制項的影像清單中，專案影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中，專案所選取影像的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個專案都可以有一對與它相關聯的點陣圖影像。 影像會出現在專案標籤的左側。 當選取專案時，會顯示一個影像，另一個則會在未選取專案時顯示。 例如，專案可能會在選取時顯示開啟的資料夾，而當未選取時，則會顯示 [已關閉] 資料夾。

呼叫此函式可設定專案影像的索引，以及其在樹狀檢視控制項的影像清單中所選取的影像。

如需映射的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetItemImage](#getitemimage)的範例。

##  <a name="setitemstate"></a>CTreeCtrl：： SetItemState

設定*hItem*所指定之專案的狀態。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其狀態之專案的控制碼。

*nState*<br/>
指定專案的新狀態。

*nStateMask*<br/>
指定要變更的狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如需狀態的詳細資訊，請參閱[CTreeCtrl：： GetItem](#getitem)。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetItemState](#getitemstate)的範例。

##  <a name="setitemstateex"></a>CTreeCtrl：： SetItemStateEx

設定目前樹狀檢視控制項中指定專案的擴充狀態。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|在樹狀檢視控制項專案的控制碼。|
|*uStateEx*|在專案的擴充狀態。 如需詳細資訊，請`uStateEx`參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。|

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_SETITEM](/windows/win32/Controls/tvm-setitem)訊息，如 Windows SDK 中所述。 這個方法會將*uStateEx*參數指派給`uStateEx` [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員，然後在訊息中使用該結構。

### <a name="example"></a>範例

下列程式碼範例會定義用來`m_treeCtrl`存取目前樹狀檢視控制項的變數。 此程式碼範例也會定義不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例會使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會將樹狀檢視專案設定為停用狀態。 在程式碼範例的先前區段中（未顯示），我們建立了樹狀檢視，其中包含美國的根國家/地區節點、賓夕法尼亞州和華盛頓州的子節點，以及那些州城市的樹狀結構專案。 這個程式碼範例會將 [賓夕法尼亞州] 節點設定為停用狀態。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText

設定*hItem*所指定之專案的文字。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要設定其文字之專案的控制碼。

*lpszItem*<br/>
字串的位址，其中包含專案的新文字

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

##  <a name="setlinecolor"></a>CTreeCtrl：： SetLineColor

呼叫這個成員函式可設定樹狀檢視控制項的目前線條色彩。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
新的線條色彩。

### <a name="return-value"></a>傳回值

先前的線條色彩。

### <a name="remarks"></a>備註

此成員函式會執行 win32 message [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor)的行為，如 Windows SDK 中所述。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

##  <a name="setscrolltime"></a>CTreeCtrl：： SetScrollTime

呼叫這個成員函式，以設定樹狀檢視控制項的最大滾動時間。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>參數

*uScrollTime*<br/>
新的滾動時間上限（以毫秒為單位）。 如果這個值小於100，則會進位至100。

### <a name="return-value"></a>傳回值

先前的最大滾動時間（以毫秒為單位）。

### <a name="remarks"></a>備註

此成員函式會執行 win32 message [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime)的行為，如 Windows SDK 中所述。

##  <a name="settextcolor"></a>CTreeCtrl：： SetTextColor

此成員函式會執行 Win32 message [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor)的行為，如 Windows SDK 中所述。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*clr*<br/>
包含新文字色彩的 COLORRE光圈值。 如果這個引數為-1，控制項將會還原為使用文字色彩的系統色彩。

### <a name="return-value"></a>傳回值

代表上一個文字色彩的 COLORRE光圈值。 如果此值為-1，表示控制項使用的是文字色彩的系統色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

##  <a name="settooltips"></a>CTreeCtrl：： SetToolTips

此成員函式會執行 Win32 message [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips)的行為，如 Windows SDK 中所述。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pWndTip*<br/>
樹狀目錄控制項將使用之[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標。

### <a name="return-value"></a>傳回值

[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件的指標，其中包含控制項先前使用的工具提示，如果先前未使用任何工具提示，則為 Null。

### <a name="remarks"></a>備註

若要使用工具提示，請在建立`CTreeCtrl`物件時指出 TVS_NOTOOLTIPS 樣式。

### <a name="example"></a>範例

  請參閱[CTreeCtrl：： GetToolTips](#gettooltips)的範例。

##  <a name="showinfotip"></a>CTreeCtrl：： ShowInfoTip

顯示目前樹狀檢視控制項中指定專案的提示。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|在控制項中樹狀檢視專案的控制碼。 如需詳細資訊，請`hItem`參閱[TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)結構的成員。|

### <a name="remarks"></a>備註

如需工具提示與提示之間差異的詳細資訊，請搜尋[Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322)的「工具提示與提示」主題。

這個方法會傳送[TVM_SHOWINFOTIP](/windows/win32/Controls/tvm-showinfotip)訊息，如 Windows SDK 中所述。

##  <a name="sortchildren"></a>CTreeCtrl：： SortChildren

呼叫此函式，依字母順序排序樹狀檢視控制項中指定之父專案的子專案。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要排序其子專案的父專案的控制碼。 如果*hItem*為 Null，則會從樹狀結構的根目錄繼續排序。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

`SortChildren`不會遞迴通過樹狀結構;只有*hItem*的直屬子系會進行排序。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

##  <a name="sortchildrencb"></a>CTreeCtrl：： SortChildrenCB

呼叫此函式，以使用會比較專案的應用程式定義回呼函數來排序樹狀檢視專案。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>參數

*pSort*<br/>
[TVSORTCB](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)結構的指標。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果第一個專案應該在`lpfnCompare`第二個專案的前面，則此結構的比較函式必須傳回負值，如果第一個專案應該在第二個專案後面，則為正值; 如果兩個專案相等，則為零。

*LParam1*和*lParam2*參數會`lParam`對應到兩個要比較的專案之[TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw)結構的成員。 *LParamSort*參數會對應至`lParam` `TV_SORTCB`結構的成員。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另請參閱

[MFC 範例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CImageList 類別](../../mfc/reference/cimagelist-class.md)
