---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 3819e861b7a5e6ff27fe632a33413b588a5a4835
ms.sourcegitcommit: c7f90df497e6261764893f9cc04b5d1f1bf0b64b
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/05/2019
ms.locfileid: "58782000"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

提供 Windows 通用樹狀檢閱控制項的功能。

## <a name="syntax"></a>語法

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|建構 `CTreeCtrl` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CTreeCtrl::Create](#create)|建立樹狀檢視控制項，並將它附加至`CTreeCtrl`物件。|
|[CTreeCtrl::CreateDragImage](#createdragimage)|建立指定的樹狀檢視項目產生拖曳點陣圖。|
|[CTreeCtrl::CreateEx](#createex)|使用指定的 Windows 延伸樣式中建立樹狀目錄控制項，並將它附加至`CTreeCtrl`物件。|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|刪除樹狀檢視控制項中的所有項目。|
|[CTreeCtrl::DeleteItem](#deleteitem)|刪除樹狀檢視控制項中的新項目。|
|[CTreeCtrl::EditLabel](#editlabel)|編輯指定的樹狀檢視項目就地。|
|[CTreeCtrl::EndEditLabelNow](#endeditlabelnow)|取消標籤上的樹狀檢視中的項目目前的樹狀檢視控制項的編輯作業。|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|可確保樹狀檢視項目會顯示在其樹狀檢視控制項。|
|[CTreeCtrl::Expand](#expand)|展開時，或收合，指定的樹狀檢視項目的子項目。|
|[CTreeCtrl::GetBkColor](#getbkcolor)|擷取目前的背景色彩的控制項。|
|[CTreeCtrl::GetCheck](#getcheck)|擷取樹狀目錄控制項目核取狀態。|
|[CTreeCtrl::GetChildItem](#getchilditem)|擷取指定的樹狀檢視項目的子系。|
|[CTreeCtrl::GetCount](#getcount)|擷取樹狀檢視控制項相關聯的樹狀結構項目數目。|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|擷取拖放作業的目標。|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|擷取用來編輯指定的樹狀檢視項目編輯控制項的控制代碼。|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|擷取目前的樹狀檢視控制項使用的延伸的樣式。|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|擷取指定的樹狀檢視項目的第一個可見的項目。|
|[CTreeCtrl::GetImageList](#getimagelist)|擷取樹狀檢視控制項相關聯之影像清單的控制代碼。|
|[CTreeCtrl::GetIndent](#getindent)|擷取其父代的位移 （以像素為單位） 的樹狀檢視項目。|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|擷取用來繪製的樹狀檢視中插入標記的色彩。|
|[CTreeCtrl::GetItem](#getitem)|擷取指定的樹狀檢視項目的屬性。|
|[CTreeCtrl::GetItemData](#getitemdata)|傳回項目相關聯的 32 位元應用程式特定值。|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|擷取要顯示目前的樹狀檢視控制項的指定項目處於展開狀態時的影像索引。|
|[CTreeCtrl::GetItemHeight](#getitemheight)|擷取目前的樹狀檢視項目高度。|
|[CTreeCtrl::GetItemImage](#getitemimage)|擷取項目相關聯的映像。|
|[CTreeCtrl::GetItemPartRect](#getitempartrect)|擷取指定的組件，指定目前的樹狀檢視控制項中項目的週框。|
|[CTreeCtrl::GetItemRect](#getitemrect)|擷取樹狀檢視項目的週框。|
|[CTreeCtrl::GetItemState](#getitemstate)|傳回項目的狀態。|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|擷取指定的項目目前的樹狀檢視控制項中的擴充的狀態。|
|[CTreeCtrl::GetItemText](#getitemtext)|傳回項目的文字。|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|擷取目前的樹狀檢視控制項中的最後一個擴充項目。|
|[CTreeCtrl::GetLineColor](#getlinecolor)|擷取樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl::GetNextItem](#getnextitem)|擷取下一步 樹狀檢視項目符合指定的關聯性。|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|擷取指定的樹狀檢視項目的下一個同層級。|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|擷取指定的樹狀檢視項目的下一個可見的項目。|
|[CTreeCtrl::GetParentItem](#getparentitem)|擷取指定的樹狀檢視項目的父代。|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|擷取指定的樹狀檢視項目的前一個同層級。|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|擷取指定的樹狀檢視項目的上一個可見的項目。|
|[CTreeCtrl::GetRootItem](#getrootitem)|擷取指定的樹狀檢視項目的根目錄。|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|擷取樹狀檢視控制項的最大捲軸時間。|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|擷取目前的樹狀檢視控制項中的選取項目數目。|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|擷取目前選取的樹狀檢視項目。|
|[CTreeCtrl::GetTextColor](#gettextcolor)|擷取控制項的目前文字色彩。|
|[CTreeCtrl::GetToolTips](#gettooltips)|擷取子樹狀檢視控制項所使用的工具提示控制項的控制代碼。|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|擷取樹狀檢視控制項相關聯的可見的樹狀結構項目數目。|
|[CTreeCtrl::HitTest](#hittest)|傳回目前位置相關的資料指標`CTreeCtrl`物件。|
|[CTreeCtrl::InsertItem](#insertitem)|在樹狀檢視控制項中插入新項目。|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|傳回非零值，如果指定的項目有子項目。|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|將指定的存取範圍識別項對應至 樹狀檢視中的項目目前的樹狀檢視控制項的控制代碼。|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|將指定的控制代碼對應到樹狀檢視中的項目目前的樹狀檢視控制項，為協助工具的識別碼。|
|[CTreeCtrl::Select](#select)|選取、 將捲動至檢視，或重新繪製指定的樹狀檢視項目。|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|重新繪製樹狀結構項目，做為拖放作業的目標。|
|[CTreeCtrl::SelectItem](#selectitem)|選取指定的樹狀檢視項目。|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|選取指定的樹狀檢視項目做為第一個可見的項目。|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|設定目前的樹狀檢視控制項的自動捲動速率。|
|[CTreeCtrl::SetBkColor](#setbkcolor)|設定控制項的背景色彩。|
|[CTreeCtrl::SetCheck](#setcheck)|設定的核取狀態的樹狀目錄控制項目。|
|[CTreeCtrl::SetExtendedStyle](#setextendedstyle)|設定目前的樹狀檢視控制項的延伸的樣式。|
|[CTreeCtrl::SetImageList](#setimagelist)|設定影像清單與樹狀檢視控制項相關聯的控制代碼。|
|[CTreeCtrl::SetIndent](#setindent)|設定從其父代的位移 （以像素為單位） 的樹狀檢視項目。|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|設定樹狀檢視控制項中的插入標記。|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|設定用來繪製的樹狀檢視中插入標記的色彩。|
|[CTreeCtrl::SetItem](#setitem)|設定指定的樹狀檢視項目的屬性。|
|[CTreeCtrl::SetItemData](#setitemdata)|設定項目相關聯的 32 位元應用程式特定值。|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|設定要指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。|
|[CTreeCtrl::SetItemHeight](#setitemheight)|檢視項目會設定樹狀結構的高度。|
|[CTreeCtrl::SetItemImage](#setitemimage)|將映像與某個項目產生關聯。|
|[CTreeCtrl::SetItemState](#setitemstate)|設定項目的狀態。|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|將指定的項目擴充的狀態設定目前的樹狀檢視控制項中。|
|[CTreeCtrl::SetItemText](#setitemtext)|設定項目的文字。|
|[CTreeCtrl::SetLineColor](#setlinecolor)|設定樹狀檢視控制項的目前線條色彩。|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|設定樹狀檢視控制項的最大捲軸時間。|
|[CTreeCtrl::SetTextColor](#settextcolor)|設定控制項的文字色彩。|
|[CTreeCtrl::SetToolTips](#settooltips)|設定工具提示控制項的樹狀檢視控制項的子系。|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|在目前的樹狀檢視控制項中顯示資訊提示指定的項目。|
|[CTreeCtrl::SortChildren](#sortchildren)|排序給定的父項目的子系。|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|排序給定的父項目使用的應用程式定義的排序函式的子系。|

## <a name="remarks"></a>備註

「 樹狀檢視控制項 」 是一個顯示在磁碟的項目，例如標題在文件中的索引，或檔案和目錄的項目階層式清單的視窗。 每個項目都包含標籤和選擇性點陣圖影像，因此，每個項目都可以擁有與自己相關的子項目清單。 使用者可以按一下項目以展開和摺疊子項目的關聯清單。

這個控制項 (並因此`CTreeCtrl`類別) 僅適用於在 Windows 98 和 Windows NT 第 4 版下執行的程式和更新版本。

如需有關使用`CTreeCtrl`，請參閱：

- [控制項](../../mfc/controls-mfc.md)

- [使用 CTreeCtrl](../../mfc/using-ctreectrl.md)

- [樹狀檢視控制項參考](/windows/desktop/Controls/tree-view-control-reference)Windows SDK 中。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>需求

**標頭：** afxcmn.h

##  <a name="create"></a>  CTreeCtrl::Create

如果您指定的樹狀結構控制項在對話方塊範本，或如果您使用[CTreeView](../../mfc/reference/ctreeview-class.md)，建立對話方塊或檢視時，會自動建立 「 樹狀目錄控制項。

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用樣式視窗中所述[CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa)，及任何組合[樹狀檢視控制項的樣式](/windows/desktop/Controls/tree-view-control-window-styles)Windows SDK 中所述。

*rect*<br/>
指定樹狀檢視控制項的大小和位置。 它可以是[CRect](../../atl-mfc-shared/reference/crect-class.md)物件或[RECT](/previous-versions/dd162897\(v=vs.85\))結構。

*pParentWnd*<br/>
指定樹狀檢視控制項的父視窗，通常`CDialog`。 它必須不是 NULL。

*nID*<br/>
指定樹狀檢視控制項的識別碼。

### <a name="return-value"></a>傳回值

非零值，如果初始化成功;否則為 0。

### <a name="remarks"></a>備註

如果您想要建立做為一些其他視窗的子視窗的樹狀結構控制項中，使用`Create`成員函式。 如果您建立樹狀目錄控制項使用`Create`，您必須將它傳遞 WS_VISIBLE，除了其他的樹狀結構檢視樣式。

您建構`CTreeCtrl`兩個步驟。 第一次呼叫建構函式，然後呼叫`Create`，這會建立樹狀檢視控制項，並將它附加至`CTreeCtrl`物件。

若要建立具有延伸的視窗樣式的樹狀目錄控制項，呼叫[CreateEx](#createex)而不是`Create`。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

##  <a name="createex"></a>  CTreeCtrl::CreateEx

呼叫此函式來建立控制項 （子視窗），但其關聯`CTreeCtrl`物件。

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>參數

*dwExStyle*<br/>
指定正在建立之控制項的延伸的樣式。 如需延伸的 Windows 樣式的清單，請參閱 < *dwExStyle*參數[CreateWindowEx](/windows/desktop/api/winuser/nf-winuser-createwindowexa) Windows SDK 中。

*dwStyle*<br/>
指定樹狀檢視控制項的樣式。 套用樣式視窗中所述[CreateWindow](/windows/desktop/api/winuser/nf-winuser-createwindowa)，及任何組合[樹狀檢視控制項的樣式](/windows/desktop/Controls/tree-view-control-window-styles)Windows SDK 中所述。

*rect*<br/>
參考[RECT](/previous-versions/dd162897\(v=vs.85\))結構描述的大小和位置，在中建立工作區座標中的視窗*pParentWnd*。

*pParentWnd*<br/>
是控制項的父視窗的指標。

*nID*<br/>
控制項的子視窗識別碼。

### <a name="return-value"></a>傳回值

非零值，如果成功則為 0。

### <a name="remarks"></a>備註

使用`CreateEx`而非[建立](#create)套用延伸的 Windows 樣式，由 Windows 延伸的樣式前置詞**WS_EX_**。

##  <a name="createdragimage"></a>  CTreeCtrl::CreateDragImage

呼叫此函式來建立樹狀檢視控制項中的指定項目產生拖曳點陣圖建立點陣圖中的映像清單，將點陣圖新增至映像清單。

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄項目，拖曳控點。

### <a name="return-value"></a>傳回值

指標影像清單拖曳點陣圖已加入，如果登錄成功。否則為 NULL。

### <a name="remarks"></a>備註

應用程式會使用影像清單函式，來顯示影像，當被拖曳的項目。

`CImageList`物件是永久的而且您必須將它完成時刪除。 例如：

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

##  <a name="ctreectrl"></a>  CTreeCtrl::CTreeCtrl

建構 `CTreeCtrl` 物件。

```
CTreeCtrl();
```

##  <a name="deleteallitems"></a>  CTreeCtrl::DeleteAllItems

呼叫此函式可從樹狀檢視控制項中刪除所有項目。

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

##  <a name="deleteitem"></a>  CTreeCtrl::DeleteItem

呼叫此函式可從樹狀檢視控制項中刪除項目。

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要刪除的樹狀結構項目控點。 如果*hitem* TVI_ROOT 值中，從樹狀檢視控制項，會刪除所有的項目。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

##  <a name="editlabel"></a>  CTreeCtrl::EditLabel

呼叫此函式以開始進行就地編輯指定的項目文字。

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
若要編輯的樹狀結構項目控點。

### <a name="return-value"></a>傳回值

如果成功，指標`CEdit`用來編輯項目文字的物件; 否則為 NULL。

### <a name="remarks"></a>備註

以單行編輯控制項包含的文字取代項目的文字，來完成編輯。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

##  <a name="endeditlabelnow"></a>  CTreeCtrl::EndEditLabelNow

結束編輯作業上標籤的樹狀檢視中的項目目前的樹狀檢視控制項。

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*fCancelWithoutSave*|[in]若要捨棄之前結束編輯作業或為 FALSE，則將變更儲存至樹狀檢視項目，在做出結論作業之前的樹狀檢視項目變更，則為 TRUE。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_ENDEDITLABELNOW](/windows/desktop/Controls/tvm-endeditlabelnow)訊息，Windows SDK 中所述。

##  <a name="ensurevisible"></a>  CTreeCtrl::EnsureVisible

呼叫此函式來確定可以看見的樹狀檢視項目。

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
成為可見的樹狀結構項目控點。

### <a name="return-value"></a>傳回值

為 true，則會傳回系統如果捲動以確保指定的項目為可見的樹狀檢視控制項中的項目。 否則，傳回的值為 FALSE。

### <a name="remarks"></a>備註

如有必要，函式展開父項目，或捲動樹狀檢視控制項，讓項目為可見。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

##  <a name="expand"></a>  CTreeCtrl::Expand

如果任何項目，與指定的父項目產生關聯，請呼叫此函式可展開或摺疊子項目清單。

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要展開的樹狀結構項目控點。

*nCode*<br/>
旗標，指出要採取的動作類型。 這個旗標可以有下列值之一：

- TVE_COLLAPSE 摺疊清單。

- TVE_COLLAPSERESET 摺疊清單，並移除子項目。 TVIS_EXPANDEDONCE 狀態旗標會重設。 這個旗標必須搭配 TVE_COLLAPSE 旗標。

- TVE_EXPAND 展開清單。

- 如果它目前已擴充，或將它擴充，如果目前摺疊，TVE_TOGGLE 摺疊清單。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::EnsureVisible](#ensurevisible)。

##  <a name="getbkcolor"></a>  CTreeCtrl::GetBkColor

此成員函式實作的 Win32 訊息的行為[TVM_GETBKCOLOR](/windows/desktop/Controls/tvm-getbkcolor)、 Windows SDK 中所述。

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>傳回值

COLORREF 值，表示控制項的目前視窗背景色彩。 如果此值為-1，控制項就使用系統的視窗色彩。 在此情況下，您可以使用`::GetSysColor(COLOR_WINDOW)`取得控制項使用的目前系統色彩。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetTextColor](#settextcolor)。

##  <a name="getcheck"></a>  CTreeCtrl::GetCheck

呼叫此成員函式，來擷取項目的核取狀態。

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
這是要接收的狀態資訊相關 HTREEITEM。

### <a name="return-value"></a>傳回值

如果已選取樹狀目錄控制項目，非零值。否則為 0。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetCheck](#setcheck)。

##  <a name="getchilditem"></a>  CTreeCtrl::GetChildItem

呼叫此函式可擷取的樹狀目錄檢視項目，是藉由指定的項目子系*hItem*。

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

如果成功則子系項目的控制代碼否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

##  <a name="getcount"></a>  CTreeCtrl::GetCount

呼叫此函式可擷取的樹狀檢視控制項中的項目計數。

```
UINT GetCount() const;
```

### <a name="return-value"></a>傳回值

在樹狀檢視控制項中的項目數目。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

##  <a name="getdrophilightitem"></a>  CTreeCtrl::GetDropHilightItem

呼叫此函式可擷取的項目，拖放作業的目標。

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>傳回值

如果成功則卸除的項目控點否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="geteditcontrol"></a>  CTreeCtrl::GetEditControl

呼叫此函式可擷取用來編輯樹狀檢視項目的文字編輯控制項的控制代碼。

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>傳回值

變數的指標，用來編輯項目文字，如果成功，編輯控制項否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

##  <a name="getextendedstyle"></a>  CTreeCtrl::GetExtendedStyle

擷取目前的樹狀檢視控制項使用的延伸的樣式。

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>傳回值

值，包含的位元組合 (OR) 目前的樹狀檢視控制項的延伸樣式。 如需詳細資訊，請參閱 <<c0> [ 樹狀檢視控制項擴充樣式](/windows/desktop/Controls/tree-view-control-window-extended-styles)。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETEXTENDEDSTYLE](/windows/desktop/Controls/tvm-getextendedstyle)訊息，Windows SDK 中所述。

##  <a name="getfirstvisibleitem"></a>  CTreeCtrl::GetFirstVisibleItem

呼叫此函式可擷取樹狀檢視控制項的第一個可見項目。

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>傳回值

控制代碼的第一個可見的項目;否則為 NULL。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetCheck](#setcheck)。

##  <a name="getimagelist"></a>  CTreeCtrl::GetImageList

呼叫此函式可擷取的控制代碼為 「 標準 」 或 「 狀態樹狀檢視控制項相關聯的映像清單。

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>參數

*nImageList*<br/>
要擷取的映像清單的類型。 影像清單可以是下列值之一：

- TVSIL_NORMAL 擷取一般的映像清單，其中包含樹狀檢視項目選取及未選取映像。

- TVSIL_STATE 擷取狀態的影像清單，其中包含使用者定義狀態的樹狀檢視項目的映像。

### <a name="return-value"></a>傳回值

如果成功則控制項的影像清單的指標否則為 NULL。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。 選取的項目，和其他顯示項目若未選取時，會顯示一個映像。 例如，項目可能會顯示開啟的資料夾時選取它並關閉的資料夾時未選取。

如需有關影像清單的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)類別。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

##  <a name="getindent"></a>  CTreeCtrl::GetIndent

呼叫此函式可擷取量，以像素為單位，相對於其父項目縮排項目子系。

```
UINT GetIndent() const;
```

### <a name="return-value"></a>傳回值

縮排的量，以像素表示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

##  <a name="getinsertmarkcolor"></a>  CTreeCtrl::GetInsertMarkColor

此成員函式實作的 Win32 訊息的行為[TVM_GETINSERTMARKCOLOR](/windows/desktop/Controls/tvm-getinsertmarkcolor)、 Windows SDK 中所述。

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>傳回值

COLORREF 值，包含目前的插入標記色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

##  <a name="getitem"></a>  CTreeCtrl::GetItem

呼叫此函式可擷取指定的樹狀檢視項目的屬性。

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>參數

*pItem*<br/>
指標[TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema)結構，在 Windows SDK 中所述。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::DeleteItem](#deleteitem)。

##  <a name="getitemdata"></a>  CTreeCtrl::GetItemData

呼叫此函式可擷取與指定的項目相關聯的 32 位元應用程式特定值。

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要擷取其資料的項目控制代碼。

### <a name="return-value"></a>傳回值

使用指定的項目相關聯的 32 位元應用程式專屬值*hItem*。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

##  <a name="getitemexpandedimageindex"></a>  CTreeCtrl::GetItemExpandedImageIndex

擷取要顯示目前的樹狀檢視控制項的指定項目處於展開狀態時的影像索引。

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]控制代碼的樹狀檢視控制項項目。|

### <a name="return-value"></a>傳回值

要指定的項目處於展開狀態時所顯示之影像的索引。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETITEM](/windows/desktop/Controls/tvm-getitem)訊息，Windows SDK 中所述。 訊息傳回[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構描述樹狀檢視控制項項目，然後按一下 這個方法會擷取`iExpandedImage`從該結構的成員。

##  <a name="getitemheight"></a>  CTreeCtrl::GetItemHeight

此成員函式實作的 Win32 訊息的行為[TVM_GETITEMHEIGHT](/windows/desktop/Controls/tvm-getitemheight)、 Windows SDK 中所述。

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>傳回值

項目，像素為單位的高度。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

##  <a name="getitemimage"></a>  CTreeCtrl::GetItemImage

樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要擷取其映像的項目控制代碼。

*nImage*<br/>
整數，接收在樹狀檢視控制項的影像清單內的項目影像的索引。

*nSelectedImage*<br/>
整數，接收的項目樹狀檢視控制項的影像清單中選取的影像索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

映像會出現在左邊的項目標籤。 選取的項目，和其他顯示項目若未選取時，會顯示一個映像。 例如，項目可能會顯示開啟的資料夾時選取它並關閉的資料夾時未選取。

呼叫此函式可擷取的索引項目的映像和其樹狀檢視控制項的影像清單中選取的映像。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

##  <a name="getitempartrect"></a>  CTreeCtrl::GetItemPartRect

擷取指定的組件，指定目前的樹狀檢視控制項中項目的週框。

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]控制代碼的樹狀檢視控制項項目。|
|*nPart*|[in]組件的識別碼。 必須設定為 TVGIPR_BUTTON。|
|*lpRect*|[out]指標[RECT](/previous-versions/dd162897\(v=vs.85\))結構。 如果這個方法成功，結構就會收到所指定的部分的矩形座標*hItem*並*nPart*。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

圖形矩形會受限於每個樹狀目錄控制項目。 每當按一下該矩形中的點時，項目要*點擊*。 如此矩形中的點按一下的時，所識別的項目，這個方法會傳回最大矩形*hItem*參數叫用。

這個方法會傳送 TVM_GETITEMPARTRECT 訊息，這 Windows SDK 中所述。 如需詳細資訊，請參閱 < [TreeView_GetItemPartRect](/windows/desktop/api/commctrl/nf-commctrl-treeview_getitempartrect)巨集。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別項和[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法來擷取根樹狀檢視項目的控制代碼。 然後此範例會使用控制代碼並[CTreeCtrl::GetItemPartRect](#getitempartrect) 3D 周圍繪製矩形該項目的的方法。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 我們使用了[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)根樹狀檢視項目相關聯的存取範圍識別項的方法。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="getitemrect"></a>  CTreeCtrl::GetItemRect

呼叫此函式可擷取指定的週框*hItem*並判斷它是否可見。

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀檢視控制項項目的控制代碼。

*lpRect*<br/>
指標[RECT](/previous-versions/dd162897\(v=vs.85\))接收的週框的結構。 座標是相對於樹狀檢視控制項的左上角。

*bTextOnly*<br/>
如果這個參數不是零，週框矩形會包含項目的文字。 否則它會在樹狀檢視控制項中包含項目所佔用的整行。

### <a name="return-value"></a>傳回值

週框的矩形中包含的項目是可見的如果為非零*lpRect*。 否則為 0 且*lpRect*未初始化。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

##  <a name="getitemstate"></a>  CTreeCtrl::GetItemState

傳回指定的項目狀態*hItem*。

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要擷取其狀態的項目控制代碼。

*nStateMask*<br/>
遮罩，指出要擷取的一或多個狀態。 如需可能值的詳細資訊*nStateMask*，請參閱討論`state`和`stateMask`的成員[TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema) Windows SDK 中的結構。

### <a name="return-value"></a>傳回值

UINT 保存 nStateMask 所指定之值的位元 OR。 如需可能值的資訊，請參閱[CTreeCtrl::GetItem](#getitem)。 若要尋找特定狀態的值，請執行位元的 AND 運算的狀態值和傳回值，如下列範例所示。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

##  <a name="getitemstateex"></a>  CTreeCtrl::GetItemStateEx

擷取指定的項目目前的樹狀檢視控制項中的擴充的狀態。

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]控制代碼的樹狀檢視控制項項目。|

### <a name="return-value"></a>傳回值

項目的擴充的狀態。 如需詳細資訊，請參閱 <<c0> `uStateEx` 隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETITEM](/windows/desktop/Controls/tvm-getitem)訊息，Windows SDK 中所述。 訊息傳回[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構描述樹狀檢視控制項項目，且這個方法會擷取`uStateEx`從該結構的成員。

##  <a name="getitemtext"></a>  CTreeCtrl::GetItemText

傳回指定的項目中的文字*hItem*。

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
要擷取其文字的項目控制代碼。

### <a name="return-value"></a>傳回值

A`CString`物件，其中包含項目的文字。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetNextItem](#getnextitem)。

##  <a name="getlastvisibleitem"></a>  CTreeCtrl::GetLastVisibleItem

擷取目前的樹狀檢視控制項中的最後一個未展開的節點項目。

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>傳回值

最後一個未展開的節點項目方法會成功; 如果控制代碼否則為 NULL。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETNEXTITEM](/windows/desktop/Controls/tvm-getnextitem)訊息，Windows SDK 中所述。 如需詳細資訊，請參閱中的 TVGN_LASTVISIBLE 旗標*旗標*該訊息的參數。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 一或多個這些變數會用於下一個範例。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會擷取最後一個未展開的樹狀檢視節點項目，控制代碼，，然後繪製 3D 矩形以圍繞該項目。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

##  <a name="getlinecolor"></a>  CTreeCtrl::GetLineColor

此成員函式實作的 win32 訊息的行為[TVM_GETLINECOLOR](/windows/desktop/Controls/tvm-getlinecolor)、 Windows SDK 中所述。

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>傳回值

目前的線條色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

##  <a name="getnextitem"></a>  CTreeCtrl::GetNextItem

呼叫此函式可擷取的樹狀目錄檢視項目，具有指定的關聯性，並由*則 nCode*參數，以*hItem*。

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

*nCode*<br/>
旗標，指出關聯性的型別*hItem*。 這個旗標可以是下列值之一：

- TVGN_CARET 擷取目前選取的項目。

- TVGN_CHILD 擷取第一個子項目所指定之項目的*hItem*參數。

- TVGN_DROPHILITE 擷取做為目標的拖放作業的項目。

- TVGN_FIRSTVISIBLE 擷取第一個可見的項目。

- TVGN_LASTVISIBLE 擷取最後一個項目展開樹狀目錄中。 這不會擷取最後一個項目顯示在樹狀檢視 視窗中。

- TVGN_NEXT 擷取下一個同層級項目。

- TVGN_NEXTVISIBLE 擷取下一個可見項目後面指定的項目。

- TVGN_PARENT 擷取所指定項目的父代。

- TVGN_PREVIOUS 擷取上一個同層級項目。

- TVGN_PREVIOUSVISIBLE 擷取的第一個可見的項目之前指定的項目。

- TVGN_ROOT 擷取第一個子項目指定的項目是組件的根項目。

### <a name="return-value"></a>傳回值

如果成功則下一個項目的控制代碼否則為 NULL。

### <a name="remarks"></a>備註

如果要擷取的項目樹狀結構的根節點，此函式會傳回 NULL。 比方說，如果您使用此訊息在樹狀檢視中的根節點的第一層子系 TVGN_PARENT 旗標時，訊息就會傳回 NULL。

### <a name="example"></a>範例

如需使用的範例`GetNextItem`在迴圈中，請參閱[CTreeCtrl::DeleteItem](#deleteitem)。

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

##  <a name="getnextsiblingitem"></a>  CTreeCtrl::GetNextSiblingItem

呼叫此函式來擷取下一個同層級*hItem*。

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

下一個同層級項目的控制代碼否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

##  <a name="getnextvisibleitem"></a>  CTreeCtrl::GetNextVisibleItem

呼叫此函式可擷取的下一個可見的項目*hItem*。

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

下一個可見的項目; 的控制代碼否則為 NULL。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetCheck](#setcheck)。

##  <a name="getparentitem"></a>  CTreeCtrl::GetParentItem

呼叫此函式可擷取的父代*hItem*。

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

父項目的控制代碼否則為 NULL。

### <a name="remarks"></a>備註

如果指定項目的父代是樹狀結構的根節點，此函式會傳回 NULL。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::EnsureVisible](#ensurevisible)。

##  <a name="getprevsiblingitem"></a>  CTreeCtrl::GetPrevSiblingItem

呼叫此函式可擷取的前一個同層級*hItem*。

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

控制代碼的之前同層級;否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

##  <a name="getprevvisibleitem"></a>  CTreeCtrl::GetPrevVisibleItem

呼叫此函式可擷取的上一個可見的項目*hItem*。

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

控制代碼的上一個可見的項目;否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

##  <a name="getrootitem"></a>  CTreeCtrl::GetRootItem

呼叫此函式可擷取樹狀檢視控制項的根項目。

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>傳回值

根項目的控制代碼否則為 NULL。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::EditLabel](#editlabel)。

##  <a name="getscrolltime"></a>  CTreeCtrl::GetScrollTime

呼叫此成員函式可擷取樹狀檢視控制項的最大捲軸時間。

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>傳回值

最大捲軸的時間，以毫秒為單位。

### <a name="remarks"></a>備註

此成員函式實作的 win32 訊息的行為[TVM_GETSCROLLTIME](/windows/desktop/Controls/tvm-getscrolltime)、 Windows SDK 中所述。

##  <a name="getselectedcount"></a>  CTreeCtrl::GetSelectedCount

擷取目前的樹狀檢視控制項中的選取項目數目。

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>傳回值

選取的項目數目。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_GETSELECTEDCOUNT](/windows/desktop/Controls/tvm-getselectedcount)訊息，Windows SDK 中所述。

##  <a name="getselecteditem"></a>  CTreeCtrl::GetSelectedItem

呼叫此函式可擷取的樹狀檢視控制項的目前選取的項目。

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>傳回值

選取的項目; 的控制代碼否則為 NULL。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

##  <a name="gettextcolor"></a>  CTreeCtrl::GetTextColor

此成員函式實作的 Win32 訊息的行為[TVM_GETTEXTCOLOR](/windows/desktop/Controls/tvm-gettextcolor)、 Windows SDK 中所述。

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>傳回值

COLORREF 值，表示目前的文字色彩。 如果此值為-1，控制項就使用系統色彩的文字色彩。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetTextColor](#settextcolor)。

##  <a name="gettooltips"></a>  CTreeCtrl::GetToolTips

此成員函式實作的 Win32 訊息的行為[TVM_GETTOOLTIPS](/windows/desktop/Controls/tvm-gettooltips)、 Windows SDK 中所述。

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>傳回值

指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)樹狀結構控制項中所使用的物件。 如果[建立](#create)成員函式會使用樣式 TVS_NOTOOLTIPS、 使用任何工具提示，並會傳回 NULL。

### <a name="remarks"></a>備註

MFC 實作`GetToolTips`傳回`CToolTipCtrl`物件，它由樹狀控制中，而不是工具提示控制項的控制代碼。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

##  <a name="getvisiblecount"></a>  CTreeCtrl::GetVisibleCount

呼叫此函式可擷取的樹狀檢視控制項中可見的項目計數。

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>傳回值

在樹狀檢視控制項; 中的可見項目數目否則為-1。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetCheck](#setcheck)。

##  <a name="hittest"></a>  CTreeCtrl::HitTest

呼叫此函式可判斷樹狀檢視控制項相對於用戶端區域的指定點的位置。

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>參數

*pt*<br/>
要測試 用戶端端點的座標。

*pFlags*<br/>
接收的點擊測試結果的相關資訊的整數指標。 它可以是其中一或多個值列在`flags`< 備註 > 一節中的成員。

*pHitTestInfo*<br/>
位址[TVHITTESTINFO](/windows/desktop/api/commctrl/ns-commctrl-tagtvhittestinfo)結構，其中包含要進行點擊測試，位置接收的點擊測試結果的相關資訊。

### <a name="return-value"></a>傳回值

佔用指定之樹狀檢視項目的控制代碼點，或如果沒有任何項目所佔用的點，則為 NULL。

### <a name="remarks"></a>備註

呼叫此函式時， *pt*參數會指定要測試點的座標。 如果沒有任何項目所佔用的點，函式會傳回位於指定的點或 NULL 的項目控制代碼。 颾魤 ㄛ *pFlags*參數會包含值，指出指定點的位置。 可能的值為：

|||
|-|-|
|值|意義|
|TVHT_ABOVE|用戶端區域上方。|
|TVHT_BELOW|以下的用戶端區域。|
|TVHT_NOWHERE|在用戶端區域中，但最後一個項目下方。|
|TVHT_ONITEM|點陣圖或項目相關聯的標籤。|
|TVHT_ONITEMBUTTON|在 項目相關聯的按鈕。|
|TVHT_ONITEMICON|在 項目相關聯的點陣圖。|
|TVHT_ONITEMINDENT|中的項目相關聯的縮排。|
|TVHT_ONITEMLABEL|在 項目相關聯的標籤 （字串）。|
|TVHT_ONITEMRIGHT|在右邊的項目區域。|
|TVHT_ONITEMSTATEICON|在樹狀檢視項目的 [狀態] 圖示上，這是在使用者定義的狀態。|
|TVHT_TOLEFT|工作區的左邊。|
|TVHT_TORIGHT|以工作區的權限。|
|||

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="insertitem"></a>  CTreeCtrl::InsertItem

呼叫此函式可在 樹狀檢視控制項中插入新項目。

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>參數

*lpInsertStruct*<br/>
指標`TVINSERTSTRUCT`，指定要插入樹狀檢視項目的屬性。

*nMask*<br/>
整數，指定要設定的屬性。 請參閱`TVITEM`Windows SDK 中的結構。

*lpszItem*<br/>
字串，包含的項目文字的位址。

*nImage*<br/>
樹狀檢視控制項的影像清單中的項目影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中的項目選取的映像的索引。

*nState*<br/>
指定的項目狀態的值。 請參閱樹狀檢視控制項目狀態的適當狀態清單的 Windows SDK 中。

*nStateMask*<br/>
指定要設定哪些狀態。 請參閱`TVITEM`Windows SDK 中的結構。

*lParam*<br/>
項目相關聯的 32 位元應用程式特定值。

*hParent*<br/>
插入的項目之父代的控制代碼。

*hInsertAfter*<br/>
要插入新項目之後的項目控點。

### <a name="return-value"></a>傳回值

如果成功，新項目的控制代碼否則為 NULL。

### <a name="remarks"></a>備註

此範例示範的情況下，您可能想要插入樹狀目錄控制項目時，請使用函式的每個版本。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

##  <a name="itemhaschildren"></a>  CTreeCtrl::ItemHasChildren

使用此函式來判斷所指定的樹狀結構項目是否*hItem*有子項目。

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

如果樹狀結構項目所指定非零值*hItem*含有子系項目，如果不為 0。

### <a name="remarks"></a>備註

因此，您可以接著使用如果[CTreeCtrl::GetChildItem](#getchilditem)擷取這些子項目。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetSelectedItem](#getselecteditem)。

##  <a name="mapaccidtoitem"></a>  CTreeCtrl::MapAccIdToItem

將指定的存取範圍識別項對應樹狀檢視中的項目目前的樹狀檢視控制項的控制代碼。

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uAccId*|[in]協助工具樹狀檢視項目中的項目識別碼。|

### <a name="return-value"></a>傳回值

樹狀檢視項目的控制代碼 ( `HTREEITEM`)，其對應於*uAccId*參數。 如需詳細資訊，請參閱 < *hItem*隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構。

### <a name="remarks"></a>備註

協助工具是應用程式，協助殘障人士使用的電腦。 存取範圍識別項會由`IAccessible`介面，以唯一地指定在視窗中的 項目。 如需有關協助工具的識別項的詳細資訊，請搜尋 「 有關 Active Accessibility 支援 「 會議中發表[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。

這個方法會傳送[TVM_MAPACCIDTOHTREEITEM](/windows/desktop/Controls/tvm-mapaccidtohtreeitem)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會使用存取範圍識別項和[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)方法來擷取根樹狀檢視項目的控制代碼。 此範例會使用控制代碼並[CTreeCtrl::GetItemPartRect](#getitempartrect) 3D 周圍繪製矩形該項目的的方法。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 我們使用了[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)根樹狀檢視項目相關聯的存取範圍識別項的方法。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

##  <a name="mapitemtoaccid"></a>  CTreeCtrl::MapItemToAccID

將指定的樹狀檢視中的項目目前的樹狀檢視控制項的控制代碼對應範圍識別項。

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]樹狀檢視中的項目控制項的控制代碼。 如需詳細資訊，請參閱 < *hItem*隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構。|

### <a name="return-value"></a>傳回值

對應至的存取範圍識別項*hItem*參數。

### <a name="remarks"></a>備註

協助工具是應用程式，協助殘障人士使用的電腦。 存取範圍識別項會由`IAccessible`介面，以唯一地指定在視窗中的 項目。 如需有關協助工具的識別項的詳細資訊，請搜尋 「 有關 Active Accessibility 支援 「 會議中發表[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。

這個方法會傳送[TVM_MAPHTREEITEMTOACCID](/windows/desktop/Controls/tvm-maphtreeitemtoaccid)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會取得的樹狀檢視控制項項目識別碼。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 此程式碼範例會取得根國家/地區節點的唯一識別碼。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

##  <a name="select"></a>  CTreeCtrl::Select

呼叫此函式以選取指定的樹狀檢視項目、 捲軸項目，檢視，或重新繪製用來表示拖放作業的目標的樣式項目。

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

*nCode*<br/>
要採取的動作類型。 這個參數可以是下列值之一：

- TVGN_CARET 會將選取項目設定為指定的項目。

- TVGN_DROPHILITE 重新繪製指定的項目在樣式中，用來表示拖放作業的目標。

- TVGN_FIRSTVISIBLE 捲動樹狀結構檢視，以垂直方式讓指定的項目是第一個可見的項目。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*則 nCode*包含值 TVGN_CARET，父視窗接收 TVN_SELCHANGING 和 TVN_SELCHANGED 通知訊息。 此外，如果指定的項目是摺疊之父項目的子系，子項目的父項的清單會展開以顯示指定的項目。 在此情況下，父視窗會接收 TVN_ITEMEXPANDING 和 TVN_ITEMEXPANDED 通知訊息。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::HitTest](#hittest)。

##  <a name="selectdroptarget"></a>  CTreeCtrl::SelectDropTarget

呼叫此函式以重新繪製用來表示拖放作業的目標的樣式項目。

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

##  <a name="selectitem"></a>  CTreeCtrl::SelectItem

呼叫此函式以選取指定的樹狀檢視項目。

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
樹狀目錄中項目的控制代碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如果*hItem*是 NULL，則此函式會不選取任何項目。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

##  <a name="selectsetfirstvisible"></a>  CTreeCtrl::SelectSetFirstVisible

呼叫此函式可垂直捲動樹狀檢視，以便指定的項目是第一個可見的項目。

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
設為第一個可見的項目樹狀結構項目的控制代碼。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

函式會將訊息傳送至視窗使用 TVM_SELECTITEM 和 TVGN_FIRSTVISIBLE 訊息參數。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

##  <a name="setautoscrollinfo"></a>  CTreeCtrl::SetAutoscrollInfo

設定目前的樹狀檢視控制項的自動捲動速率。

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*uPixelsPerSec*|[in]每秒来捲動的像素數目。|
|*uUpdateTime*|[in]更新控制項的時間間隔。|

### <a name="return-value"></a>傳回值

一律會傳回 TRUE。

### <a name="remarks"></a>備註

自動捲動參數用來捲動至檢視，因此看不到目前的項目。 樹狀檢視控制項必須有 TVS_EX_AUTOHSCROLL 延伸樣式中所述[樹狀檢視控制項的延伸樣式](/windows/desktop/Controls/tree-view-control-window-extended-styles)。

這個方法會傳送[TVM_SETAUTOSCROLLINFO](/windows/desktop/Controls/tvm-setautoscrollinfo)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會設定目前的樹狀檢視控制項的自動捲動行為。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 我們刻意做樹狀檢視控制項窄，因此它必須自動捲動以顯示具有焦點的樹狀結構項目。 程式碼範例會設定樹狀檢視控制項，表示自動捲動 30 個像素，每秒每隔 5 秒，直到樹狀結構項目在檢視中。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

##  <a name="setbkcolor"></a>  CTreeCtrl::SetBkColor

此成員函式實作的 Win32 訊息的行為[TVM_SETBKCOLOR](/windows/desktop/Controls/tvm-setbkcolor)、 Windows SDK 中所述。

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*clr*<br/>
COLORREF 值，其中包含新的背景色彩。 如果此值為-1，控制項將會還原為使用系統色彩的背景色彩。

### <a name="return-value"></a>傳回值

COLORREF 值，表示目前的文字色彩。 如果此值為-1，控制項就使用系統色彩的文字色彩。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::SetTextColor](#settextcolor)。

##  <a name="setcheck"></a>  CTreeCtrl::SetCheck

呼叫此成員函式可設定樹狀目錄控制項目其核取狀態。

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
若要接收的核取狀態變更 HTREEITEM。

*fCheck*<br/>
指出是否要選取或取消選取樹狀目錄控制項目。 根據預設，`SetCheck`設定要檢查的項目。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

在檢查樹狀目錄控制項目時 ( *fCheck*設為 TRUE)，項目會顯示相鄰的核取記號。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>範例

若要使用核取方塊，設定 TVS_CHECKBOXES 之前填入樹狀結構控制項中。

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

##  <a name="setextendedstyle"></a>  CTreeCtrl::SetExtendedStyle

設定目前的樹狀檢視控制項的延伸的樣式。

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*dwExMask*|[in]位元遮罩，指定目前的樹狀檢視控制項中的哪一個樣式會受到這個方法。 如果此參數為零，則會忽略，而*dwExStyles*參數指派給樹狀檢視控制項。<br /><br /> 指定零個或的位元組合 (OR) 中所述的樣式[樹狀檢視控制項擴充樣式](/windows/desktop/Controls/tree-view-control-window-extended-styles)。|
|*dwExStyles*|[in]位元遮罩，指定控制項才能設定或清除的目前的樹狀檢視中的樣式。<br /><br /> 若要設定樣式的組合，指定的位元組合 (OR) 中所述的樣式[樹狀檢視控制項擴充樣式](/windows/desktop/Controls/tree-view-control-window-extended-styles)。 若要清除的樣式集，指定零。|

### <a name="return-value"></a>傳回值

值，包含先前擴充控制項的樣式。

### <a name="remarks"></a>備註

這個方法會清除在指定的樣式*dwExMask*參數，然後設定中指定的樣式*dwExStyles*參數。 只有對應到中的位元的延伸的樣式*dwExMask*變更。

這個方法會傳送[TVM_SETEXTENDEDSTYLE](/windows/desktop/Controls/tvm-setextendedstyle)訊息，Windows SDK 中所述。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會將目前的樹狀檢視控制項中的 TVS_EX_AUTOHSCROLL 延伸樣式。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 我們刻意做樹狀檢視控制項窄，因此它必須自動捲動以顯示具有焦點的樹狀結構項目。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

##  <a name="setimagelist"></a>  CTreeCtrl::SetImageList

呼叫此函式可設定一般或樹狀結構的狀態影像清單檢視控制項，並且重繪其使用新的映像的控制項。

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>參數

*pImageList*<br/>
若要將指派的影像清單的指標。 如果*pImageList*是 NULL，所有映像會從樹狀檢視控制項中移除。

*nImageListType*<br/>
若要設定的影像清單的類型。 影像清單可以是下列值之一：

- TVSIL_NORMAL 設定一般的映像清單，其中包含樹狀檢視項目選取及未選取映像。 您必須使用此狀態的重疊影像。

- TVSIL_STATE 設定狀態的影像清單，其中包含使用者定義狀態的樹狀檢視項目的映像。

### <a name="return-value"></a>傳回值

上述映像清單中，如果有的話，指標否則為 NULL。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetImageList](#getimagelist)。

##  <a name="setindent"></a>  CTreeCtrl::SetIndent

呼叫此函式可設定樹狀檢視控制項的縮排的寬度，並且重繪的控制項，以反映新的寬度。

```
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>參數

*nIndent*<br/>
寬度，單位為像素的縮排。 如果*nIndent*小於比系統定莪最小寬度，新的寬度設定為系統定義的最小值。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetIndent](#getindent)。

##  <a name="setinsertmark"></a>  CTreeCtrl::SetInsertMark

此成員函式實作的 Win32 訊息的行為[TVM_SETINSERTMARK](/windows/desktop/Controls/tvm-setinsertmark)、 Windows SDK 中所述。

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>參數

*hItem*<br/>
指定的項目上放置插入標記的 HTREEITEM。 如果這個引數為 NULL，則會移除插入標記。

*fAfter*<br/>
BOOL 值，指定之前或之後指定的項目，是否要放置插入標記。 如果這個引數為非零值，插入標記將會放在項目之後。 如果這個引數為零，插入標記將會放在項目之前。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

##  <a name="setinsertmarkcolor"></a>  CTreeCtrl::SetInsertMarkColor

此成員函式實作的 Win32 訊息的行為[TVM_SETINSERTMARKCOLOR](/windows/desktop/Controls/tvm-setinsertmarkcolor)、 Windows SDK 中所述。

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
COLORREF 值，其中包含新的插入標記色彩。

### <a name="return-value"></a>傳回值

COLORREF 值，其中包含上一個插入標記色彩。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)。

##  <a name="setitem"></a>  CTreeCtrl::SetItem

呼叫此函式可設定的屬性指定的樹狀檢視項目。

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>參數

*pItem*<br/>
指標[TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema)結構，其中包含新的項目屬性，如 Windows SDK 中所述。

*hItem*<br/>
重新設定其屬性的項目控點。 請參閱`hItem`隸屬`TVITEM`Windows SDK 中的結構。

*nMask*<br/>
整數，指定要設定的屬性。 請參閱`mask`隸屬`TVITEM`結構。

*lpszItem*<br/>
字串，包含的項目文字的位址。

*nImage*<br/>
樹狀檢視控制項的影像清單中的項目影像的索引。 請參閱`iImage`隸屬`TVITEM`結構。

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中的項目選取的映像的索引。 請參閱`iSelectedImage`隸屬`TVITEM`結構。

*nState*<br/>
指定的項目狀態的值。 請參閱`State`隸屬`TVITEM`結構。

*nStateMask*<br/>
指定要設定哪些狀態。 請參閱`stateMask`隸屬`TVITEM`結構。

*lParam*<br/>
項目相關聯的 32 位元應用程式特定值。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

在 `TVITEM`結構`hItem`成員識別項目，和`mask`成員指定要設定的屬性。

如果`mask`成員或*nMask*參數指定 TVIF_TEXT 值`pszText`成員或有*lpszItem*是以 null 結束的字串的位址和`cchTextMax`成員會被忽略。 如果`mask`(或*nMask*) 指定 TVIF_STATE 值`stateMask`成員或有*nStateMask*參數指定哪一個項目狀態變更和`state`成員或*nState*參數會包含這些狀態的值。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

##  <a name="setitemdata"></a>  CTreeCtrl::SetItemData

呼叫此函式來設定與指定的項目相關聯的 32 位元應用程式特定值。

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>參數

*hItem*<br/>
要擷取其資料的項目控制代碼。

*dwData*<br/>
使用指定的項目相關聯的 32 位元應用程式專屬值*hItem*。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

##  <a name="setitemexpandedimageindex"></a>  CTreeCtrl::SetItemExpandedImageIndex

設定要指定的項目目前的樹狀檢視控制項的展開狀態時所顯示之影像的索引。

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]控制代碼的樹狀檢視控制項項目。|
|*iExpandedImage*|[in]要指定的項目處於展開狀態時所顯示之影像的索引。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_SETITEM](/windows/desktop/Controls/tvm-setitem)訊息，Windows SDK 中所述。 這個方法會指派*iExpandedImage*參數來`iExpandedImage`隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構，然後按一下 建構訊息中的使用。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例是簡單的測試，以判斷是否[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)方法會傳回所設定的值[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)方法。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

##  <a name="setitemheight"></a>  CTreeCtrl::SetItemHeight

此成員函式實作的 Win32 訊息的行為[TVM_SETITEMHEIGHT](/windows/desktop/Controls/tvm-setitemheight)、 Windows SDK 中所述。

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>參數

*cyHeight*<br/>
在樹狀結構檢視中，像素為單位指定每個項目的新的高度。 如果這個引數小於影像的高度，它將會設定至影像的高度。 如果這個引數不是偶數，將會四捨五入至最接近甚至值。 如果這個引數為-1，控制項將會還原為使用其預設項目高度。

### <a name="return-value"></a>傳回值

先前的項目，像素為單位的高度。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetItemHeight](#getitemheight)。

##  <a name="setitemimage"></a>  CTreeCtrl::SetItemImage

將映像與某個項目產生關聯。

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>參數

*hItem*<br/>
若要設定其映像的項目控制代碼。

*nImage*<br/>
樹狀檢視控制項的影像清單中的項目影像的索引。

*nSelectedImage*<br/>
樹狀檢視控制項的影像清單中的項目選取的映像的索引。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

樹狀檢視控制項中的每個項目可以有一組與其相關聯的點陣圖影像。 映像會出現在左邊的項目標籤。 選取的項目，和其他顯示項目若未選取時，會顯示一個映像。 例如，項目可能會顯示開啟的資料夾時選取它並關閉的資料夾時未選取。

呼叫此函式可設定的索引項目的映像和其樹狀檢視控制項的影像清單中選取的映像。

如需有關映像的詳細資訊，請參閱[CImageList](../../mfc/reference/cimagelist-class.md)。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetItemImage](#getitemimage)。

##  <a name="setitemstate"></a>  CTreeCtrl::SetItemState

設定指定的項目狀態*hItem*。

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>參數

*hItem*<br/>
若要設定其狀態的項目控制代碼。

*nState*<br/>
指定項目的新狀態。

*nStateMask*<br/>
指定要變更的狀態。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

如需狀態的資訊，請參閱[CTreeCtrl::GetItem](#getitem)。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetItemState](#getitemstate)。

##  <a name="setitemstateex"></a>  CTreeCtrl::SetItemStateEx

將指定的項目擴充的狀態設定目前的樹狀檢視控制項中。

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]控制代碼的樹狀檢視控制項項目。|
|*uStateEx*|[in]項目的擴充的狀態。 如需詳細資訊，請參閱 <<c0> `uStateEx` 隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構。|

### <a name="return-value"></a>傳回值

如果成功，這個方法，則為 TRUE。否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會傳送[TVM_SETITEM](/windows/desktop/Controls/tvm-setitem)訊息，Windows SDK 中所述。 這個方法會指派*uStateEx*參數來`uStateEx`隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構，然後按一下 建構訊息中的使用。

### <a name="example"></a>範例

下列程式碼範例會定義變數`m_treeCtrl`，也就是用來存取目前的樹狀檢視控制項。 在程式碼範例也會定義一個不帶正負號的整數和數個 HTREEITEM 變數。 下一個範例中使用這些變數。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>範例

下列程式碼範例會設定已停用狀態的樹狀檢視項目。 在先前章節中的程式碼範例中，未顯示，我們會建立包含美國州名的根國家/地區節點、 子節點的狀態賓夕法尼亞州和華盛頓州和城市，這些狀態的樹狀結構項目樹狀結構檢視。 此程式碼範例將賓夕法尼亞州節點設定已停用狀態。

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

##  <a name="setitemtext"></a>  CTreeCtrl::SetItemText

設定所指定之項目的文字*hItem*。

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
若要設定其文字的項目控制代碼。

*lpszItem*<br/>
字串，包含項目的新文字的位址

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

##  <a name="setlinecolor"></a>  CTreeCtrl::SetLineColor

呼叫此成員函式設定樹狀檢視控制項的目前線條色彩。

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>參數

*clrNew*<br/>
新的線條色彩。

### <a name="return-value"></a>傳回值

先前的線條色彩。

### <a name="remarks"></a>備註

此成員函式實作的 win32 訊息的行為[TVM_SETLINECOLOR](/windows/desktop/Controls/tvm-setlinecolor)、 Windows SDK 中所述。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

##  <a name="setscrolltime"></a>  CTreeCtrl::SetScrollTime

呼叫此成員函式可設定樹狀檢閱控制項的最大捲軸的時間。

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>參數

*uScrollTime*<br/>
新最大捲軸的時間，以毫秒為單位。 如果此值為小於 100，則會捨入到最多 100。

### <a name="return-value"></a>傳回值

前一個最大捲軸的時間，以毫秒為單位。

### <a name="remarks"></a>備註

此成員函式實作的 win32 訊息的行為[TVM_SETSCROLLTIME](/windows/desktop/Controls/tvm-setscrolltime)、 Windows SDK 中所述。

##  <a name="settextcolor"></a>  CTreeCtrl::SetTextColor

此成員函式實作的 Win32 訊息的行為[TVM_SETTEXTCOLOR](/windows/desktop/Controls/tvm-settextcolor)、 Windows SDK 中所述。

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>參數

*clr*<br/>
COLORREF 值，其中包含新的文字色彩。 如果這個引數為-1，控制項將會還原為使用系統色彩的文字色彩。

### <a name="return-value"></a>傳回值

COLORREF 值，表示先前的文字色彩。 如果此值為-1，控制項使用系統色彩的文字色彩。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

##  <a name="settooltips"></a>  CTreeCtrl::SetToolTips

此成員函式實作的 Win32 訊息的行為[TVM_SETTOOLTIPS](/windows/desktop/Controls/tvm-settooltips)、 Windows SDK 中所述。

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>參數

*pWndTip*<br/>
指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)樹狀目錄控制項將使用的物件。

### <a name="return-value"></a>傳回值

指標[CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md)物件，其中包含工具提示，就如同先前不使用任何工具提示一樣，先前使用控制項，則為 NULL。

### <a name="remarks"></a>備註

若要使用的工具提示，指出當您建立的 TVS_NOTOOLTIPS 樣式`CTreeCtrl`物件。

### <a name="example"></a>範例

  範例，請參閱[CTreeCtrl::GetToolTips](#gettooltips)。

##  <a name="showinfotip"></a>  CTreeCtrl::ShowInfoTip

在目前的樹狀檢視控制項中顯示資訊提示指定的項目。

```
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

|參數|描述|
|---------------|-----------------|
|*hItem*|[in]樹狀檢視中的項目控制項控制代碼。 如需詳細資訊，請參閱 <<c0> `hItem` 隸屬[TVITEMEX](/windows/desktop/api/commctrl/ns-commctrl-tagtvitemexa)結構。|

### <a name="remarks"></a>備註

如需有關工具提示與提示之間的差異的詳細資訊，請搜尋 「 工具提示和資訊提示 」 中發表[Microsoft Developer Network](http://go.microsoft.com/fwlink/p/?linkid=56322)。

這個方法會傳送[TVM_SHOWINFOTIP](/windows/desktop/Controls/tvm-showinfotip)訊息，Windows SDK 中所述。

##  <a name="sortchildren"></a>  CTreeCtrl::SortChildren

呼叫此函式可依字母順序排序指定的父項目樹狀檢視控制項中的子項目。

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>參數

*hItem*<br/>
與父項目，其中的子系項目是要排序的控制代碼。 如果*hItem*是 NULL，排序將會繼續從樹狀結構的根目錄。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

`SortChildren` 不會遞迴到樹狀結構;只有的直接子系*hItem*將排序。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

##  <a name="sortchildrencb"></a>  CTreeCtrl::SortChildrenCB

呼叫此函式來排序樹狀檢視項目使用的應用程式定義的回呼函式來比較項目。

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>參數

*pSort*<br/>
指標[TVSORTCB](/windows/desktop/api/commctrl/ns-commctrl-tagtvsortcb)結構。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

結構的比較函式， `lpfnCompare`，必須傳回的負數的值如果第一個項目之前，應該還有第二個，正值如果第一個項目應該遵循第二個，或零，如果兩個項目相等。

*LParam1*並*lParam2*參數會對應至`lParam`成員[TVITEM](/windows/desktop/api/commctrl/ns-commctrl-tagtvitema)結構的兩個項目進行比較。 *LParamSort*參數會對應至`lParam`的成員`TV_SORTCB`結構。

### <a name="example"></a>範例

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>另請參閱

[MFC 範例 CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[CWnd 類別](../../mfc/reference/cwnd-class.md)<br/>
[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[CImageList 類別](../../mfc/reference/cimagelist-class.md)
