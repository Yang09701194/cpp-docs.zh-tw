---
title: CWinAppEx 類別
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: c222567703d0e57480c00f6f2bf9e78f16979150
ms.sourcegitcommit: 7ecd91d8ce18088a956917cdaf3a3565bd128510
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/16/2020
ms.locfileid: "79420880"
---
# <a name="cwinappex-class"></a>CWinAppEx 類別

`CWinAppEx` 會處理應用程式狀態、將狀態儲存到登錄、從登錄載入狀態、初始化應用程式管理員，以及提供這些相同應用程式管理員的連結。

   如需詳細資訊，請參閱位於**VC\\atlmfc\\src\\** Visual Studio 安裝的 mfc 資料夾中的原始程式碼。
## <a name="syntax"></a>語法

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CWinAppEx：： CWinAppEx](#cwinappex)|建構 `CWinAppEx` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CWinAppEx：： CleanState](#cleanstate)|從 Windows 登錄移除應用程式的相關資訊。|
|[CWinAppEx：： EnableLoadWindowPlacement](#enableloadwindowplacement)|指定應用程式是否要從登錄載入主框架視窗的初始大小和位置。|
|[CWinAppEx：： EnableTearOffMenus](#enabletearoffmenus)|啟用應用程式的卸載功能表。|
|[CWinAppEx：： EnableUserTools](#enableusertools)|可讓使用者在應用程式中建立自訂功能表命令。|
|[CWinAppEx：： ExitInstance](#exitinstance)|由架構從 `Run` 成員函式中呼叫，以結束應用程式的這個實例。 （覆寫[CWinApp：： ExitInstance](../../mfc/reference/cwinapp-class.md#exitinstance)。）|
|[CWinAppEx：： GetBinary](#getbinary)|讀取與指定的登錄值相關聯的二進位資料。|
|[CWinAppEx：： GetCoNtextMenuManager](#getcontextmenumanager)|傳回全域[CCoNtextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件的指標。|
|[CWinAppEx：： GetDataVersion](#getdataversion)||
|[CWinAppEx：： GetDataVersionMajor](#getdataversionmajor)|傳回儲存在 Windows 登錄中之應用程式的主要版本。|
|[CWinAppEx：： GetDataVersionMinor](#getdataversionminor)|傳回儲存在 Windows 登錄中之應用程式的次要版本。|
|[CWinAppEx：： GetInt](#getint)|從登錄中讀取與指定值相關聯的數值資料。|
|[CWinAppEx：： GetKeyboardManager](#getkeyboardmanager)|傳回全域[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)物件的指標。|
|[CWinAppEx：： GetMouseManager](#getmousemanager)|傳回全域[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件的指標。|
|[CWinAppEx：： GetObject](#getobject)|從登錄中讀取與指定值相關聯的 `CObject`衍生資料。|
|[CWinAppEx：： GetRegSectionPath](#getregsectionpath)|傳回做為登錄機碼路徑的字串。 這個路徑會串連提供的相對路徑與應用程式路徑。|
|[CWinAppEx：： GetRegistryBase](#getregistrybase)|傳回應用程式的登錄路徑。|
|[CWinAppEx：： GetSectionBinary](#getsectionbinary)|從登錄讀取與指定索引鍵和值相關聯的二進位資料。|
|[CWinAppEx：： GetSectionInt](#getsectionint)|從登錄中讀取與指定索引鍵和值相關聯的數值資料。|
|[CWinAppEx：： GetSectionObject](#getsectionobject)|從登錄讀取與指定索引鍵和值相關聯 `CObject` 資料。|
|[CWinAppEx：： GetSectionString](#getsectionstring)|從登錄讀取與指定索引鍵和值相關聯的字串資料。|
|[CWinAppEx：： GetShellManager](#getshellmanager)|傳回全域[CShellManager](../../mfc/reference/cshellmanager-class.md)物件的指標。|
|[CWinAppEx：： GetString](#getstring)|從登錄讀取與指定值相關聯的字串資料。|
|[CWinAppEx：： GetTooltipManager](#gettooltipmanager)|傳回全域[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件的指標。|
|[CWinAppEx：： GetUserToolsManager](#getusertoolsmanager)|傳回全域[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)物件的指標。|
|[CWinAppEx：： InitCoNtextMenuManager](#initcontextmenumanager)|初始化 `CContextMenuManager` 物件。|
|[CWinAppEx：： InitKeyboardManager](#initkeyboardmanager)|初始化 `CKeyboardManager` 物件。|
|[CWinAppEx：： InitMouseManager](#initmousemanager)|初始化 `CMouseManager` 物件。|
|[CWinAppEx：： InitShellManager](#initshellmanager)|初始化 `CShellManager` 類別|
|[CWinAppEx：： InitTooltipManager](#inittooltipmanager)|初始化 `CTooltipManager` 類別。|
|[CWinAppEx：： IsResourceSmartUpdate](#isresourcesmartupdate)||
|[CWinAppEx：： IsStateExists](#isstateexists)|指出指定的索引鍵是否在登錄中。|
|[CWinAppEx：： LoadState](#loadstate)|從登錄載入應用程式狀態。|
|[CWinAppEx：： OnAppCoNtextHelp](#onappcontexthelp)|當使用者要求**自訂**對話方塊的內容說明時，由架構呼叫。|
|[CWinAppEx：： OnViewDoubleClick](#onviewdoubleclick)|當使用者按兩下應用程式中的任何位置時，會呼叫使用者定義的命令。|
|[CWinAppEx：： OnWorkspaceIdle](#onworkspaceidle)||
|[CWinAppEx：： SaveState](#savestate)|將應用程式架構的狀態寫入 Windows 登錄。|
|[CWinAppEx：： SetRegistryBase](#setregistrybase)|設定預設登錄機碼的路徑。 這個金鑰會作為所有後續登錄呼叫的根目錄。|
|[CWinAppEx：： ShowPopupMenu](#showpopupmenu)|顯示快顯功能表。|
|[CWinAppEx：： WriteBinary](#writebinary)|將二進位資料寫入指定的登錄值。|
|[CWinAppEx：： WriteInt](#writeint)|將數值資料寫入指定的登錄值。|
|[CWinAppEx：： WriteObject](#writeobject)|將衍生自[CObject 類別](../../mfc/reference/cobject-class.md)的資料寫入指定的登錄值。|
|[CWinAppEx：： WriteSectionBinary](#writesectionbinary)|將二進位資料寫入至指定之登錄機碼的值。|
|[CWinAppEx：： WriteSectionInt](#writesectionint)|將數值資料寫入指定之登錄機碼的值。|
|[CWinAppEx：： WriteSectionObject](#writesectionobject)|將衍生自 `CObject` 類別的資料寫入指定之登錄機碼的值。|
|[CWinAppEx：： WriteSectionString](#writesectionstring)|將字串資料寫入指定之登錄機碼的值。|
|[CWinAppEx：： WriteString](#writestring)|將字串資料寫入指定的登錄值。|

### <a name="protected-methods"></a>受保護的方法

|名稱|描述|
|----------|-----------------|
|[CWinAppEx：： LoadCustomState](#loadcustomstate)|已載入應用程式狀態時由架構呼叫。|
|[CWinAppEx：： LoadWindowPlacement](#loadwindowplacement)|從登錄載入應用程式的大小和位置時，由架構呼叫。 載入的資料包括應用程式上次關閉時的主框架大小和位置。|
|[CWinAppEx：： OnClosingMainFrame](#onclosingmainframe)|當主框架視窗正在處理 WM_CLOSE 時，由架構呼叫。|
|[CWinAppEx：:P reLoadState](#preloadstate)|在載入應用程式狀態之前，立即由架構呼叫。|
|[CWinAppEx：:P reSaveState](#presavestate)|由架構在儲存應用程式狀態之前立即呼叫。|
|[CWinAppEx：： ReloadWindowPlacement](#reloadwindowplacement)|從登錄重載所提供視窗的大小和位置|
|[CWinAppEx：： SaveCustomState](#savecustomstate)|由架構在將應用程式狀態寫入登錄後呼叫。|
|[CWinAppEx：： StoreWindowPlacement](#storewindowplacement)|由架構呼叫，以將主框架的大小和位置寫入登錄中。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CWinAppEx：： m_bForceImageReset](#m_bforceimagereset)|指定當載入包含工具列的框架視窗時，架構是否會重設所有工具列影像。|

## <a name="remarks"></a>備註

MFC 架構所提供的大部分功能都取決於 `CWinAppEx` 類別。 您可以透過下列兩種方式的其中一種，將 `CWinAppEx` 類別併入您的應用程式：

- 在主執行緒中，建立 `CWinAppEx` 類別。

- 從 `CWinAppEx`衍生主要應用程式類別。

將 `CWinAppEx` 併入應用程式之後，您可以初始化任何一個應用程式管理員。 使用應用程式管理員之前，您必須呼叫適當的 initialize 方法將它初始化。 若要取得特定管理員的指標，請呼叫相關聯的 get 方法。 `CWinAppEx` 類別會管理下列應用程式管理員： [CMouseManager 類別](../../mfc/reference/cmousemanager-class.md)、 [CCoNtextMenuManager 類別](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)、 [CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)和[CMenuTearOffManager 類別](../../mfc/reference/cmenutearoffmanager-class.md)。

## <a name="inheritance-hierarchy"></a>繼承階層

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>需求

**標頭：** afxwinappex。h

##  <a name="cleanstate"></a>CWinAppEx：： CleanState

從 Windows 登錄中移除應用程式的所有相關資訊。

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>參數

*lpszSectionName*<br/>
在包含登錄機碼路徑的字串。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法會從登錄的特定區段中清除應用程式資料。 您可以使用參數*lpszSectionName*來指定要清除的區段。 如果*lpszSectionName*為 Null，這個方法將會使用儲存在 `CWinAppEx` 物件中的預設登錄路徑。 若要取得預設的登錄路徑，請使用[CWinAppEx：： GetRegistryBase](#getregistrybase)。

##  <a name="cwinappex"></a>CWinAppEx：： CWinAppEx

建構 `CWinAppEx` 物件。

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>參數

*bResourceSmartUpdate*<br/>
在布林值參數，指定工作區物件是否應偵測並處理資源更新。

### <a name="remarks"></a>備註

`CWinAppEx` 類別具有初始化方法、提供將應用程式資訊儲存和載入至登錄的功能，以及控制全域應用程式設定。 它也可讓您使用全域管理員，例如[CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)。 每個應用程式只能有一個 `CWinAppEx` 類別的實例。

##  <a name="enableloadwindowplacement"></a>CWinAppEx：： EnableLoadWindowPlacement

指定應用程式是否要從登錄載入主框架視窗的初始大小和位置。

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*bEnable*<br/>
在指定應用程式是否從登錄載入主框架視窗的初始大小和位置。

### <a name="remarks"></a>備註

根據預設，主畫面格的大小和位置會與其他應用程式設定一起從登錄載入。 這會在[CWinAppEx：： LoadState](#loadstate)期間發生。 如果您不想要從登錄載入初始視窗位置，請呼叫這個方法，並將*bEnable*設為 FALSE。

##  <a name="enabletearoffmenus"></a>CWinAppEx：： EnableTearOffMenus

建立並初始化[CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md)物件。

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>參數

*lpszRegEntry*<br/>
在包含登錄機碼路徑的字串。 應用程式會使用這個登錄機碼來儲存卸載功能表的資訊。

*uiCmdFirst*<br/>
在第一個關閉的功能表識別碼。

*uiCmdLast*<br/>
在上次關閉功能表識別碼。

### <a name="return-value"></a>傳回值

如果成功建立並初始化 `CMenuTearOffManager`，則為 TRUE;如果發生錯誤或 `CMenuTearOffManager` 已經存在，則為 FALSE。

### <a name="remarks"></a>備註

使用此函式可在您的應用程式中啟用卸載功能表。 您應該從 `InitInstance`呼叫此函式。

##  <a name="enableusertools"></a>CWinAppEx：： EnableUserTools

可讓使用者建立自訂功能表命令，以減少應用程式中的按鍵。 這個方法會建立[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)物件。

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>參數

*uiCmdToolsDummy*<br/>
在不帶正負號的整數，架構會用來做為 [使用者工具] 功能表的命令 ID 預留位置。

*uiCmdFirst*<br/>
在第一個使用者工具命令的命令識別碼。

*uiCmdLast*<br/>
在最後一個使用者工具命令的命令 ID。

*pToolRTC*<br/>
在`CUserToolsManager` 物件用來建立新使用者工具的類別。

*uArgMenuID*<br/>
在引數功能表識別碼。

*uInitDirMenuID*<br/>
在初始工具目錄的功能表識別碼。

### <a name="return-value"></a>傳回值

如果方法會建立並初始化 `CUserToolsManager` 物件，則為 TRUE;如果方法失敗或 `CUserToolsManager` 物件已經存在，則為 FALSE。

### <a name="remarks"></a>備註

當您啟用使用者定義的工具時，架構會自動支援可在自訂期間延伸的動態功能表。 架構會將每個新的專案與外部命令產生關聯。 當使用者從 [**工具**] 功能表選取適當的專案時，此架構會叫用這些命令。

每次使用者加入新專案時，架構都會建立新的物件。 新物件的類別類型是由*pToolRTC*所定義。 *PToolRTC*類別類型必須衍生自[CUserTool 類別](../../mfc/reference/cusertool-class.md)。

如需使用者工具以及如何將它們併入應用程式的詳細資訊，請參閱[使用者定義的工具](../../mfc/user-defined-tools.md)。

##  <a name="exitinstance"></a>CWinAppEx：： ExitInstance

```
virtual int ExitInstance();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getbinary"></a>CWinAppEx：： GetBinary

從指定的登錄機碼讀取二進位資料。

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄機碼名稱的字串。

*ppData*<br/>
脫銷緩衝區的指標，此方法會以二進位資料填滿。

*pBytes*<br/>
脫銷不帶正負號整數的指標，此方法會用來寫入讀取的位元組數目。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會讀取寫入登錄的二進位資料。 若要將資料寫入登錄，請使用[CWinAppEx：： WriteBinary](#writebinary)和[CWinAppEx：： WriteSectionBinary](#writesectionbinary)方法。

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getcontextmenumanager"></a>CWinAppEx：： GetCoNtextMenuManager

傳回全域[CCoNtextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件的指標。

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>傳回值

全域 `CContextMenuManager` 物件的指標。

### <a name="remarks"></a>備註

如果 CCoNtextMenuManager 物件未初始化，此函式會在傳回指標之前呼叫[CWinAppEx：： InitCoNtextMenuManager](#initcontextmenumanager) 。

##  <a name="getdataversion"></a>CWinAppEx：： GetDataVersion

```
int GetDataVersion() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="getdataversionmajor"></a>CWinAppEx：： GetDataVersionMajor

當您呼叫[CWinAppEx：： SaveState](#savestate)時，傳回儲存在 Windows 登錄中的應用程式主要版本。

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>傳回值

包含主要版本號碼的整數值。

##  <a name="getdataversionminor"></a>CWinAppEx：： GetDataVersionMinor

當您呼叫[CWinAppEx：： SaveState](#savestate)時，傳回儲存在 Windows 登錄中之應用程式的次要版本。

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>傳回值

包含次要版本號碼的整數值。

##  <a name="getint"></a>CWinAppEx：： GetInt

從指定的登錄機碼讀取整數資料。

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄專案名稱的字串。

*nDefault*<br/>
在如果指定的登錄專案不存在，此方法會傳回的預設值。

### <a name="return-value"></a>傳回值

如果方法成功，則為登錄資料;否則， *nDefault*。

### <a name="remarks"></a>備註

這個方法會從登錄讀取整數資料。 如果沒有與*lpszEntry*所指示之登錄機碼相關聯的整數資料，這個方法會傳回*nDefault*。 若要將資料寫入登錄，請使用[CWinAppEx：： WriteSectionInt](#writesectionint)和[CWinAppEx：： WriteInt](#writeint)方法。

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getkeyboardmanager"></a>CWinAppEx：： GetKeyboardManager

傳回全域[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)物件的指標。

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>傳回值

全域 `CKeyboardManager` 物件的指標。

### <a name="remarks"></a>備註

如果鍵盤管理員未初始化，則此函式會先呼叫[CWinAppEx：： InitKeyboardManager](#initkeyboardmanager) ，然後再傳回指標。

##  <a name="getmousemanager"></a>CWinAppEx：： GetMouseManager

傳回全域[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件的指標。

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>傳回值

全域 `CMouseManager` 物件的指標。

### <a name="remarks"></a>備註

如果滑鼠管理員未初始化，則此函式會在傳回指標之前呼叫[CWinAppEx：： InitMouseManager](#initmousemanager) 。

##  <a name="getobject"></a>CWinAppEx：： GetObject

從登錄讀取[CObject](../../mfc/reference/cobject-class.md)dervied 資料。

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在字串，包含登錄專案的相對路徑。

*obj*<br/>
脫銷`CObject`的參考。 方法會使用此參考來儲存登錄資料。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法會從登錄中讀取衍生自 `CObject`的資料。 若要將 `CObject` 資料寫入登錄，請使用[CWinAppEx：： WriteObject](#writeobject)或[CWinAppEx：： WriteSectionObject](#writesectionobject)。

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getregistrybase"></a>CWinAppEx：： GetRegistryBase

抓取應用程式的預設登錄路徑。

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>傳回值

字串，包含預設登錄位置的路徑。

### <a name="remarks"></a>備註

存取登錄之[CWinAppEx 類別](../../mfc/reference/cwinappex-class.md)的所有方法都會在預設位置啟動。 使用此方法來取出預設登錄位置的路徑。 請使用[CWinAppEx：： SetRegistryBase](#setregistrybase)來變更預設登錄位置。

##  <a name="getregsectionpath"></a>CWinAppEx：： GetRegSectionPath

建立並傳回登錄機碼的絕對路徑。

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>參數

*szSectionAdd*<br/>
在包含登錄機碼之相對路徑的字串。

### <a name="return-value"></a>傳回值

`CString`，其中包含登錄機碼的絕對路徑。

### <a name="remarks"></a>備註

這個方法會藉由將*szSectionAdd*中的相對路徑附加至應用程式的預設登錄位置，來定義登錄機碼的絕對路徑。 若要取得預設的登錄機碼，請使用[CWinAppEx：： GetRegistryBase](#getregistrybase)方法。

##  <a name="getsectionbinary"></a>CWinAppEx：： GetSectionBinary

讀取登錄中的二進位資料。

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼之相對路徑的字串。

*lpszEntry*<br/>
在字串，包含要讀取的值。

*ppData*<br/>
脫銷方法用來儲存資料之緩衝區的指標。

*pBytes*<br/>
脫銷不帶正負號整數的指標。 方法會將*ppData*的大小寫入此參數。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會使用[CWinAppEx：： WriteBinary](#writebinary)和[CWinAppEx：： WriteSectionBinary](#writesectionbinary)方法，讀取寫入登錄的二進位資料。

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getsectionint"></a>CWinAppEx：： GetSectionInt

從登錄讀取整數資料。

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼之相對路徑的字串。

*lpszEntry*<br/>
在字串，包含要讀取的值。

*nDefault*<br/>
在當指定的值不存在時，所要傳回的預設值。

### <a name="return-value"></a>傳回值

儲存在指定登錄值中的整數資料。如果資料不存在，則*nDefault* 。

### <a name="remarks"></a>備註

使用[CWinAppEx：： WriteInt](#writeint)和[CWinAppEx：： WriteSectionInt](#writesectionint)方法，將整數資料寫入登錄。

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是新增至您應用程式的預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getsectionobject"></a>CWinAppEx：： GetSectionObject

從登錄讀取[CObject](../../mfc/reference/cobject-class.md)登錄資料。

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼之相對路徑的字串。

*lpszEntry*<br/>
在字串，包含要讀取的值。

*obj*<br/>
脫銷`CObject`的參考。 方法會使用此 `CObject` 來儲存登錄資料。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

這個方法會從登錄讀取資料。 讀取的資料為 `CObject` 資料，或衍生自 `CObject`的類別資料。 若要將 `CObject` 資料寫入登錄，請使用[CWinAppEx：： WriteObject](#writeobject)或[CWinAppEx：： WriteSectionObject](#writesectionobject)。

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getsectionstring"></a>CWinAppEx：： GetSectionString

從登錄讀取字串資料。

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼之相對路徑的字串。

*lpszEntry*<br/>
在字串，包含要讀取的值。

*lpszDefault*<br/>
在當指定的值不存在時，所要傳回的預設值。

### <a name="return-value"></a>傳回值

如果資料存在，則儲存在指定登錄值中的字串資料為;否則， *lpszDefault*。

### <a name="remarks"></a>備註

這個方法會讀取寫入登錄的字串資料。 請使用[CWinAppEx：： WriteString](#writestring)和[CWinAppEx：： WriteSectionString](#writesectionstring) ，將字串資料寫入登錄。

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="getshellmanager"></a>CWinAppEx：： GetShellManager

傳回全域[CShellManager](../../mfc/reference/cshellmanager-class.md)物件的指標。

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>傳回值

全域 `CShellManager` 物件的指標。

### <a name="remarks"></a>備註

如果未初始化 `CShellManager` 物件，此函式會先呼叫[CWinAppEx：： InitShellManager](#initshellmanager) ，然後再傳回指標。

##  <a name="getstring"></a>CWinAppEx：： GetString

從指定的登錄機碼讀取字串資料。

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄機碼名稱的字串

*lpzDefault*<br/>
在如果指定的登錄專案不存在，此方法會傳回的預設值。

### <a name="return-value"></a>傳回值

成功時儲存在登錄中的字串資料;否則， *lpszDefault* 。

### <a name="remarks"></a>備註

這個方法會讀取寫入登錄的字串資料。 若要將資料寫入登錄，請使用[CWinAppEx：： WriteString](#writestring)或[CWinAppEx：： WriteSectionString](#writesectionstring)方法。

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="gettooltipmanager"></a>CWinAppEx：： GetTooltipManager

傳回全域[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件的指標。

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>傳回值

全域 `CTooltipManager` 物件的指標。

### <a name="remarks"></a>備註

如果未初始化 `CTooltipManager` 物件，此函式會先呼叫[CWinAppEx：： InitTooltipManager](#inittooltipmanager) ，然後再傳回指標。

##  <a name="getusertoolsmanager"></a>CWinAppEx：： GetUserToolsManager

傳回全域[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)物件的指標。

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>傳回值

全域 `CUserToolsManager` 物件的指標;如果應用程式未啟用使用者工具管理，則為 Null。

### <a name="remarks"></a>備註

在您取得 `CUserToolsManager` 物件的指標之前，您必須呼叫[CWinAppEx：： EnableUserTools](#enableusertools)來初始化管理員。

##  <a name="initcontextmenumanager"></a>CWinAppEx：： InitCoNtextMenuManager

初始化[CCoNtextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件。

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>傳回值

如果方法會建立 CCoNtextMenuManager 物件，則為非零。如果 `CContextMenuManager` 物件已經存在，則為0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx：： GetCoNtextMenuManager](#getcontextmenumanager)，該方法的預設實值會呼叫 `InitContextMenuManager`。

如果您的應用程式已經有內容功能表管理員，而且您呼叫 `InitContextMenuManager`，您的應用程式將會發生判斷[提示失敗。](diagnostic-services.md#assert) 因此，如果您直接建立 `CContextMenuManager` 物件，則不應呼叫 `InitContextMenuManager`。 如果您不是使用自訂 `CContextMenuManager`，您應該使用 `GetContextMenuManager` 來建立 `CContextMenuManager` 物件。

##  <a name="initkeyboardmanager"></a>CWinAppEx：： InitKeyboardManager

初始化[CKeyboardManager](../../mfc/reference/ckeyboardmanager-class.md)物件。

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>傳回值

如果方法建立 `CKeyboardManager` 物件，則為非零。如果 `CKeyboardManager` 物件已經存在，則為0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx：： GetKeyboardManager](#getkeyboardmanager)，該方法的預設實值會呼叫 `InitKeyboardManager`。

如果您的應用程式已經有鍵盤管理員，而且您呼叫 `InitKeyboardManager`，您的應用程式將會發生判斷[提示失敗。](diagnostic-services.md#assert) 因此，如果您直接建立 `CKeyboardManager` 物件，則不應呼叫 `InitKeyboardManager`。 如果您不是使用自訂 `CKeyboardManager`，您應該使用 `GetKeyboardManager` 來建立 `CKeyboardManager` 物件。

##  <a name="initmousemanager"></a>CWinAppEx：： InitMouseManager

初始化[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件。

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>傳回值

如果方法建立 `CMouseManager` 物件，則為非零。如果 `CMouseManager` 物件已經存在，則為0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx：： GetMouseManager](#getmousemanager)，該方法的預設實值會呼叫 `InitMouseManager`。

如果您的應用程式已經有滑鼠管理員，而且您呼叫 `InitMouseManager`，您的應用程式將會發生判斷[提示失敗。](diagnostic-services.md#assert) 因此，如果您直接建立 `CMouseManager` 物件，則不應呼叫 `InitMouseManager`。 如果您不是使用自訂 `CMouseManager`，您應該使用 `GetMouseManager` 來建立 `CMouseManager` 物件。

##  <a name="initshellmanager"></a>CWinAppEx：： InitShellManager

初始化[CShellManager](../../mfc/reference/cshellmanager-class.md)物件。

```
BOOL InitShellManager();
```

### <a name="return-value"></a>傳回值

如果方法建立 `CShellManager` 物件，則為非零。如果 `CShellManager` 物件已經存在，則為0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx：： GetShellManager](#getshellmanager)，該方法的預設實值會呼叫 `InitShellManager`。

如果您的應用程式已經有 shell 管理員，而且您呼叫 `InitShellManager`，則您[的應用](diagnostic-services.md#assert)程式會引發判斷提示失敗。 因此，如果您直接建立 `CShellManager` 物件，請勿呼叫 `InitShellManager`。 如果您不是使用自訂 `CShellManager`，請使用 `GetShellManager` 來建立 `CShellManager` 物件。

##  <a name="inittooltipmanager"></a>CWinAppEx：： InitTooltipManager

初始化[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件。

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>傳回值

如果方法建立 `CTooltipManager` 物件，則為非零。如果 `CTooltipManager` 物件已經存在，則為0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx：： GetTooltipManager](#gettooltipmanager)，該方法的預設實值會呼叫 `InitTooltipManager`。

如果您的應用程式已經有工具提示管理員，而且您呼叫 `InitTooltipManager`，則您的應用程式將會發生[ASSERT](diagnostic-services.md#assert)失敗。 因此，如果您直接建立 `CTooltipManager` 物件，則不應呼叫 `InitTooltipManager`。 如果您不是使用自訂 `CTooltipManager`，您應該使用 `GetTooltipManager` 來建立 `CTooltipManager` 物件。

##  <a name="isresourcesmartupdate"></a>CWinAppEx：： IsResourceSmartUpdate

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="isstateexists"></a>CWinAppEx：： IsStateExists

指出指定的索引鍵是否在登錄中。

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>參數

*lpszSectionName*<br/>
在包含登錄機碼路徑的字串。

### <a name="return-value"></a>傳回值

如果機碼位於登錄中，則為非零值;否則為0。

##  <a name="loadcustomstate"></a>CWinAppEx：： LoadCustomState

架構在從登錄載入應用程式的狀態之後，會呼叫這個方法。

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>備註

如果您想要在應用程式從登錄載入狀態之後執行任何處理，請覆寫這個方法。 根據預設，這個方法不會執行任何操作。

若要從登錄載入自訂狀態資訊，必須先使用[CWinAppEx：： SaveCustomState](#savecustomstate)儲存資訊。

##  <a name="loadstate"></a>CWinAppEx：： LoadState

從 Windows 登錄讀取應用程式狀態。

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
在框架視窗物件的指標。 方法會將登錄中的狀態資訊套用到此框架視窗。

*lpszSectionName*<br/>
在包含登錄機碼之相對路徑的字串。

*pFrameImpl*<br/>
在`CFrameImpl` 物件的指標。 方法會將登錄中的狀態資訊套用到此框架視窗。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法會載入應用程式的狀態，以及框架視窗的任何狀態資訊。 框架視窗的載入資訊會套用到提供的框架視窗。 如果您未提供框架視窗，則只會載入應用程式狀態資訊。 應用程式資訊包括[CMouseManager 類別](../../mfc/reference/cmousemanager-class.md)、 [CCoNtextMenuManager 類別](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)的狀態。

`CFrameImpl::OnLoadFrame` 呼叫的預設執行 `LoadState`。

*LpszSectionName*參數不是登錄專案的絕對路徑。 它是新增至您應用程式的預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="loadwindowplacement"></a>CWinAppEx：： LoadWindowPlacement

從登錄載入主框架視窗的大小和位置時，由架構呼叫。

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>參數

*rectNormalPosition*<br/>
脫銷矩形，其中包含主要框架視窗在還原位置的座標。

*nFlags*<br/>
脫銷旗標可控制最小化視窗的位置，以及作業系統如何在最小化視窗和還原的視窗之間切換。

*nShowCmd*<br/>
脫銷指定視窗顯示狀態的整數。 如需可能值的詳細資訊，請參閱[CWnd：： ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

根據預設，MFC 會在應用程式啟動時，自動載入主框架視窗的先前位置和狀態。 如需有關如何將此資訊儲存在登錄中的詳細資訊，請參閱[CWinAppEx：： StoreWindowPlacement](#storewindowplacement)。

如果您想要載入主框架視窗的其他相關資訊，請覆寫這個方法。

##  <a name="m_bforceimagereset"></a>CWinAppEx：： m_bForceImageReset

指定架構在重載包含工具列的框架視窗時，是否重設所有工具列影像。

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>備註

`m_bForceImageReset` 的資料成員是受保護的變數。

##  <a name="onappcontexthelp"></a>CWinAppEx：： OnAppCoNtextHelp

當使用者要求 [**自訂**] 對話方塊的內容說明時，架構會呼叫這個方法。

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>參數

*pWndControl*<br/>
在使用者叫用內容說明之視窗物件的指標。

*dwHelpIDArray[]*<br/>
在保留的值。

### <a name="remarks"></a>備註

這個方法目前保留供日後使用。 預設的執行不會執行任何操作，而且架構目前不會呼叫它。

##  <a name="onclosingmainframe"></a>CWinAppEx：： OnClosingMainFrame

當框架視窗正在處理 WM_CLOSE 時，架構會呼叫這個方法。

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>參數

*pFrameImpl*<br/>
在`CFrameImpl` 物件的指標。

### <a name="remarks"></a>備註

這個方法的預設執行會儲存*pFrameImpl*的狀態。

##  <a name="onviewdoubleclick"></a>CWinAppEx：： OnViewDoubleClick

當使用者按兩下該視圖內的任何位置時，會呼叫與視圖相關聯的使用者定義命令。

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>參數

*pWnd*<br/>
在衍生自[CView 類別](../../mfc/reference/cview-class.md)之物件的指標。

*iViewId*<br/>
在視圖識別碼。

### <a name="return-value"></a>傳回值

如果架構找到命令，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

為了支援自訂滑鼠行為，當您處理 WM_LBUTTONDBLCLK 訊息時，必須呼叫此函式。 這個方法會執行與*iViewId*所提供之視圖識別碼相關聯的命令。 如需自訂滑鼠行為的詳細資訊，請參閱[鍵盤和滑鼠自訂](../../mfc/keyboard-and-mouse-customization.md)。

##  <a name="onworkspaceidle"></a>CWinAppEx：： OnWorkspaceIdle

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>參數

在*CWnd&#38;*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

##  <a name="preloadstate"></a>CWinAppEx：:P reLoadState

架構會在從登錄載入應用程式的狀態之前，立即呼叫此方法。

```
virtual void PreLoadState();
```

### <a name="remarks"></a>備註

如果您想要在架構載入應用程式狀態之前立即進行任何處理，請覆寫這個方法。

##  <a name="presavestate"></a>CWinAppEx：:P reSaveState

架構會在儲存應用程式狀態之前立即呼叫此方法。

```
virtual void PreSaveState();
```

### <a name="remarks"></a>備註

如果您想要在架構儲存應用程式狀態之前立即進行任何處理，請覆寫這個方法。

##  <a name="reloadwindowplacement"></a>CWinAppEx：： ReloadWindowPlacement

從登錄重載視窗的大小和位置。

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
在框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功，則為非零;如果載入失敗或沒有要載入的資料，則為0。

### <a name="remarks"></a>備註

使用函數[CWinAppEx：： StoreWindowPlacement](#storewindowplacement) ，將視窗的大小和位置寫入登錄。

##  <a name="savecustomstate"></a>CWinAppEx：： SaveCustomState

架構會在將應用程式的狀態儲存至登錄之後，呼叫這個方法。

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>備註

如果您想要在應用程式將狀態儲存至登錄之後執行任何處理，請覆寫這個方法。 根據預設，這個方法不會執行任何操作。

##  <a name="savestate"></a>CWinAppEx：： SaveState

將應用程式狀態寫入 Windows 登錄。

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>參數

*lpszSectionName*<br/>
在包含登錄機碼之相對路徑的字串。

*pFrameImpl*<br/>
在`CFrameImpl` 物件的指標。 此框架會儲存至 Windows 登錄。

*pFrame*<br/>
在框架視窗物件的指標。 此框架會儲存至 Windows 登錄。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會儲存應用程式的狀態，以及所提供框架視窗的任何狀態資訊。 如果您未提供框架視窗，此方法只會儲存應用程式狀態。 應用程式資訊包括[CMouseManager 類別](../../mfc/reference/cmousemanager-class.md)、 [CCoNtextMenuManager 類別](../../mfc/reference/ccontextmenumanager-class.md)、 [CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)的狀態。

*LpszSectionName*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

##  <a name="setregistrybase"></a>CWinAppEx：： SetRegistryBase

設定應用程式的預設登錄路徑。

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>參數

*lpszSectionName*<br/>
在包含登錄機碼路徑的字串。

### <a name="return-value"></a>傳回值

字串，包含預設登錄位置的路徑。

### <a name="remarks"></a>備註

存取登錄之[CWinAppEx 類別](../../mfc/reference/cwinappex-class.md)的所有方法都會在預設位置啟動。 使用此方法來變更該預設登錄位置。 請使用[CWinAppEx：： GetRegistryBase](#getregistrybase)來取出預設的登錄位置。

##  <a name="showpopupmenu"></a>CWinAppEx：： ShowPopupMenu

顯示快顯功能表。

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>參數

*uiMenuResId*<br/>
在功能表資源識別碼。

*此處*<br/>
在[CPoint](../../atl-mfc-shared/reference/cpoint-class.md) ，指定功能表在螢幕座標中的位置。

*pWnd*<br/>
在擁有快顯功能表之視窗的指標。

### <a name="return-value"></a>傳回值

如果成功顯示快捷方式功能表，則為非零;否則為0。

### <a name="remarks"></a>備註

這個方法會顯示與*uiMenuResId*相關聯的功能表。

若要支援快顯功能表，您必須具有[CCoNtextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件。 如果您尚未初始化 `CContextMenuManager` 物件，`ShowPopupMenu` 將會失敗。

##  <a name="storewindowplacement"></a>CWinAppEx：： StoreWindowPlacement

由架構呼叫，以將主框架視窗的大小和位置寫入登錄中。

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>參數

*nFlags*<br/>
在旗標可控制最小化視窗的位置，以及作業系統如何在最小化視窗和還原的視窗之間切換。

*nShowCmd*<br/>
在指定視窗顯示狀態的整數。 如需可能值的詳細資訊，請參閱[CWnd：： ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

*rectNormalPosition*<br/>
在矩形，其中包含主要框架視窗在已還原狀態時的座標。

### <a name="return-value"></a>傳回值

如果成功，則為非零;否則為0。

### <a name="remarks"></a>備註

根據預設，MFC 會在應用程式結束之前，自動儲存主框架視窗的位置和狀態。 這項資訊會儲存在 Windows 登錄中，位於應用程式預設登錄位置的 WindowPlacement 機碼底下。 如需有關應用程式預設登錄位置的詳細資訊，請參閱[CWinAppEx：： GetRegistryBase](#getregistrybase)。

如果您想要儲存主框架視窗的其他相關資訊，請覆寫這個方法。

##  <a name="writebinary"></a>CWinAppEx：： WriteBinary

將二進位資料寫入登錄。

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄機碼名稱的字串。

*pData*<br/>
在要儲存的資料。

*nBytes*<br/>
在*PData*的大小（以位元組為單位）。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的機碼不存在，此方法將會建立它。

##  <a name="writeint"></a>CWinAppEx：： WriteInt

將數值資料寫入登錄。

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄機碼名稱的字串。

*N 值*<br/>
在要儲存的資料。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的機碼不存在，此方法將會建立它。

##  <a name="writeobject"></a>CWinAppEx：： WriteObject

將衍生自[CObject 類別](../../mfc/reference/cobject-class.md)的資料寫入登錄。

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在字串，包含要設定的值。

*obj*<br/>
在方法將儲存 `CObject` 資料的參考。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

這個方法會將*obj*資料寫入至預設登錄機碼下的指定值。 請使用[CWinAppEx：： GetRegistryBase](#getregistrybase)來判斷目前的登錄機碼。

##  <a name="writesectionbinary"></a>CWinAppEx：： WriteSectionBinary

將二進位資料寫入登錄中的值。

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼名稱的字串

*lpszEntry*<br/>
在字串，包含要設定的值。

*pData*<br/>
在要寫入登錄的資料。

*nBytes*<br/>
在*PData*的大小（以位元組為單位）。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的機碼不存在，此方法將會建立它。

##  <a name="writesectionint"></a>CWinAppEx：： WriteSectionInt

將數值資料寫入登錄。

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼之相對路徑的字串。

*lpszEntry*<br/>
在字串，包含要設定的值。

*N 值*<br/>
在要寫入登錄的資料。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的機碼不存在，此方法將會建立它。

##  <a name="writesectionobject"></a>CWinAppEx：： WriteSectionObject

將衍生自[CObject 類別](../../mfc/reference/cobject-class.md)的資料寫入至特定的登錄值。

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼名稱的字串。

*lpszEntry*<br/>
在字串，包含要設定之值的名稱。

*obj*<br/>
在要儲存的資料。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的值不存在於*lpszSubSection*所指定的登錄機碼底下，此方法將會建立該值。

##  <a name="writesectionstring"></a>CWinAppEx：： WriteSectionString

將字串資料寫入至登錄中的值。

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>參數

*lpszSubSection*<br/>
在包含登錄機碼名稱的字串。

*lpszEntry*<br/>
在字串，包含要設定的值。

*lpszValue*<br/>
在要寫入登錄的字串資料。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszSubSection*參數不是登錄專案的絕對路徑。 它是附加至應用程式預設登錄機碼結尾的相對路徑。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lpszEntry*所指定的值不存在於*lpszSubSection*之下，這個方法將會建立它。

##  <a name="writestring"></a>CWinAppEx：： WriteString

將字串資料寫入登錄。

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
在包含登錄機碼名稱的字串。

*lpszValue*<br/>
在要儲存的資料。

### <a name="return-value"></a>傳回值

如果此方法成功，則為 TRUE;否則為 FALSE。

### <a name="remarks"></a>備註

*LpszEntry*參數是位於應用程式預設登錄機碼底下的登錄專案名稱。 若要取得或設定預設的登錄機碼，請分別使用[CWinAppEx：： GetRegistryBase](#getregistrybase)和[CWinAppEx：： SetRegistryBase](#setregistrybase)方法。

如果*lspzEntry*所指定的機碼不存在，此方法將會建立它。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp 類別](../../mfc/reference/cwinapp-class.md)<br/>
[CMouseManager 類別](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager 類別](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)
