---
title: CWinAppEx 類別
ms.date: 11/04/2016
f1_keywords:
- CWinAppEx
- AFXWINAPPEX/CWinAppEx
- AFXWINAPPEX/CWinAppEx::CWinAppEx
- AFXWINAPPEX/CWinAppEx::CleanState
- AFXWINAPPEX/CWinAppEx::EnableLoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::EnableTearOffMenus
- AFXWINAPPEX/CWinAppEx::EnableUserTools
- AFXWINAPPEX/CWinAppEx::ExitInstance
- AFXWINAPPEX/CWinAppEx::GetBinary
- AFXWINAPPEX/CWinAppEx::GetContextMenuManager
- AFXWINAPPEX/CWinAppEx::GetDataVersion
- AFXWINAPPEX/CWinAppEx::GetDataVersionMajor
- AFXWINAPPEX/CWinAppEx::GetDataVersionMinor
- AFXWINAPPEX/CWinAppEx::GetInt
- AFXWINAPPEX/CWinAppEx::GetKeyboardManager
- AFXWINAPPEX/CWinAppEx::GetMouseManager
- AFXWINAPPEX/CWinAppEx::GetObject
- AFXWINAPPEX/CWinAppEx::GetRegSectionPath
- AFXWINAPPEX/CWinAppEx::GetRegistryBase
- AFXWINAPPEX/CWinAppEx::GetSectionBinary
- AFXWINAPPEX/CWinAppEx::GetSectionInt
- AFXWINAPPEX/CWinAppEx::GetSectionObject
- AFXWINAPPEX/CWinAppEx::GetSectionString
- AFXWINAPPEX/CWinAppEx::GetShellManager
- AFXWINAPPEX/CWinAppEx::GetString
- AFXWINAPPEX/CWinAppEx::GetTooltipManager
- AFXWINAPPEX/CWinAppEx::GetUserToolsManager
- AFXWINAPPEX/CWinAppEx::InitContextMenuManager
- AFXWINAPPEX/CWinAppEx::InitKeyboardManager
- AFXWINAPPEX/CWinAppEx::InitMouseManager
- AFXWINAPPEX/CWinAppEx::InitShellManager
- AFXWINAPPEX/CWinAppEx::InitTooltipManager
- AFXWINAPPEX/CWinAppEx::IsResourceSmartUpdate
- AFXWINAPPEX/CWinAppEx::IsStateExists
- AFXWINAPPEX/CWinAppEx::LoadState
- AFXWINAPPEX/CWinAppEx::OnAppContextHelp
- AFXWINAPPEX/CWinAppEx::OnViewDoubleClick
- AFXWINAPPEX/CWinAppEx::OnWorkspaceIdle
- AFXWINAPPEX/CWinAppEx::SaveState
- AFXWINAPPEX/CWinAppEx::SetRegistryBase
- AFXWINAPPEX/CWinAppEx::ShowPopupMenu
- AFXWINAPPEX/CWinAppEx::WriteBinary
- AFXWINAPPEX/CWinAppEx::WriteInt
- AFXWINAPPEX/CWinAppEx::WriteObject
- AFXWINAPPEX/CWinAppEx::WriteSectionBinary
- AFXWINAPPEX/CWinAppEx::WriteSectionInt
- AFXWINAPPEX/CWinAppEx::WriteSectionObject
- AFXWINAPPEX/CWinAppEx::WriteSectionString
- AFXWINAPPEX/CWinAppEx::WriteString
- AFXWINAPPEX/CWinAppEx::LoadCustomState
- AFXWINAPPEX/CWinAppEx::LoadWindowPlacement
- AFXWINAPPEX/CWinAppEx::OnClosingMainFrame
- AFXWINAPPEX/CWinAppEx::PreLoadState
- AFXWINAPPEX/CWinAppEx::PreSaveState
- AFXWINAPPEX/CWinAppEx::ReloadWindowPlacement
- AFXWINAPPEX/CWinAppEx::SaveCustomState
- AFXWINAPPEX/CWinAppEx::StoreWindowPlacement
- AFXWINAPPEX/CWinAppEx::m_bForceImageReset
helpviewer_keywords:
- CWinAppEx [MFC], CWinAppEx
- CWinAppEx [MFC], CleanState
- CWinAppEx [MFC], EnableLoadWindowPlacement
- CWinAppEx [MFC], EnableTearOffMenus
- CWinAppEx [MFC], EnableUserTools
- CWinAppEx [MFC], ExitInstance
- CWinAppEx [MFC], GetBinary
- CWinAppEx [MFC], GetContextMenuManager
- CWinAppEx [MFC], GetDataVersion
- CWinAppEx [MFC], GetDataVersionMajor
- CWinAppEx [MFC], GetDataVersionMinor
- CWinAppEx [MFC], GetInt
- CWinAppEx [MFC], GetKeyboardManager
- CWinAppEx [MFC], GetMouseManager
- CWinAppEx [MFC], GetObject
- CWinAppEx [MFC], GetRegSectionPath
- CWinAppEx [MFC], GetRegistryBase
- CWinAppEx [MFC], GetSectionBinary
- CWinAppEx [MFC], GetSectionInt
- CWinAppEx [MFC], GetSectionObject
- CWinAppEx [MFC], GetSectionString
- CWinAppEx [MFC], GetShellManager
- CWinAppEx [MFC], GetString
- CWinAppEx [MFC], GetTooltipManager
- CWinAppEx [MFC], GetUserToolsManager
- CWinAppEx [MFC], InitContextMenuManager
- CWinAppEx [MFC], InitKeyboardManager
- CWinAppEx [MFC], InitMouseManager
- CWinAppEx [MFC], InitShellManager
- CWinAppEx [MFC], InitTooltipManager
- CWinAppEx [MFC], IsResourceSmartUpdate
- CWinAppEx [MFC], IsStateExists
- CWinAppEx [MFC], LoadState
- CWinAppEx [MFC], OnAppContextHelp
- CWinAppEx [MFC], OnViewDoubleClick
- CWinAppEx [MFC], OnWorkspaceIdle
- CWinAppEx [MFC], SaveState
- CWinAppEx [MFC], SetRegistryBase
- CWinAppEx [MFC], ShowPopupMenu
- CWinAppEx [MFC], WriteBinary
- CWinAppEx [MFC], WriteInt
- CWinAppEx [MFC], WriteObject
- CWinAppEx [MFC], WriteSectionBinary
- CWinAppEx [MFC], WriteSectionInt
- CWinAppEx [MFC], WriteSectionObject
- CWinAppEx [MFC], WriteSectionString
- CWinAppEx [MFC], WriteString
- CWinAppEx [MFC], LoadCustomState
- CWinAppEx [MFC], LoadWindowPlacement
- CWinAppEx [MFC], OnClosingMainFrame
- CWinAppEx [MFC], PreLoadState
- CWinAppEx [MFC], PreSaveState
- CWinAppEx [MFC], ReloadWindowPlacement
- CWinAppEx [MFC], SaveCustomState
- CWinAppEx [MFC], StoreWindowPlacement
- CWinAppEx [MFC], m_bForceImageReset
ms.assetid: a3d3e053-3e22-463f-9444-c73abb1bb9d7
ms.openlocfilehash: 1e022f09986f5d49ab2bba44c62cb716ce939a0c
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81369620"
---
# <a name="cwinappex-class"></a>CWinAppEx 類別

`CWinAppEx`處理應用程式狀態,將狀態保存到註冊表,從註冊表載入狀態,初始化應用程式管理員,並提供指向這些相同的應用程式管理器的連結。

有關詳細資訊,請參閱位於 Visual Studio 安裝的**VC\\\\\\atlmfc src mfc**資料夾中的原始程式碼。

## <a name="syntax"></a>語法

```
class CWinAppEx : public CWinApp
```

## <a name="members"></a>成員

### <a name="public-constructors"></a>公用建構函式

|名稱|描述|
|----------|-----------------|
|[CWinAppEx:CWinAppEx](#cwinappex)|建構 `CWinAppEx` 物件。|

### <a name="public-methods"></a>公用方法

|名稱|描述|
|----------|-----------------|
|[CWinAppEx::清潔狀態](#cleanstate)|從 Windows 註冊表中刪除有關應用程式的資訊。|
|[CWinAppEx:開啟載入視窗放置](#enableloadwindowplacement)|指定應用程式是否將從註冊表載入主框架視窗的初始大小和位置。|
|[CWinAppEx::啟用"離開功能表"](#enabletearoffmenus)|為應用程式啟用分淚功能表。|
|[CWinAppEx:啟用使用者工具](#enableusertools)|使用戶能夠在應用程式中創建自定義功能表命令。|
|[CWinAppEx:退出實例](#exitinstance)|由框架從`Run`成員函數中調用以退出應用程式的此實例。 (覆蓋[CWinApp:退出實例](../../mfc/reference/cwinapp-class.md#exitinstance).)|
|[CWinAppEx:取得 Binary](#getbinary)|讀取與指定註冊表值關聯的二進位數據。|
|[CWinAppEx:抓取內容選單管理員](#getcontextmenumanager)|返回指向全域[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件的指標。|
|[CWinAppEx:取得資料版本](#getdataversion)||
|[CWinAppEx:取得資料版本主要](#getdataversionmajor)|返回保存在 Windows 註冊表中的應用程式的主要版本。|
|[CWinAppEx:取得資料版本次要](#getdataversionminor)|返回保存在 Windows 註冊表中的應用程式的次要版本。|
|[CWinAppEx:Getint](#getint)|從註冊表讀取與指定值關聯的數字數據。|
|[CWinAppEx:取得鍵盤管理員](#getkeyboardmanager)|返回指向全域[鍵盤管理器](../../mfc/reference/ckeyboardmanager-class.md)物件的指標。|
|[CWinAppEx:取得滑鼠管理員](#getmousemanager)|返回指向全域[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件的指標。|
|[CWinAppEx:取得物件](#getobject)|讀取`CObject`與註冊表中的指定值關聯的派生數據。|
|[CWinAppEx:取得 RegSectionPath](#getregsectionpath)|返回作為註冊表項路徑的字串。 此路徑將所提供的相對路徑與應用程式路徑串聯。|
|[CWinAppEx:取得註冊庫](#getregistrybase)|返回應用程式的註冊錶路徑。|
|[CWinAppEx:獲取截面二進位](#getsectionbinary)|從註冊表讀取與指定密鑰和值關聯的二進位資料。|
|[CWinAppEx:獲取科科因](#getsectionint)|從與指定鍵和值關聯的註冊表中讀取數位數據。|
|[CWinAppEx:取得節點物件](#getsectionobject)|從`CObject`註冊表讀取與指定密鑰和值關聯的數據。|
|[CWinAppEx:取得節串](#getsectionstring)|從註冊表讀取與指定鍵和值關聯的字串數據。|
|[CWinAppEx:取得殼牌管理員](#getshellmanager)|返回指向全域[CShellManager](../../mfc/reference/cshellmanager-class.md)物件的指標。|
|[CWinAppEx:GetString](#getstring)|從註冊表讀取與指定值關聯的字串數據。|
|[CWinAppEx:抓取工具提示管理員](#gettooltipmanager)|返回指向全域[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件的指標。|
|[CWinAppEx:取得使用者工具管理員](#getusertoolsmanager)|返回指向全域[CUserTools Manager](../../mfc/reference/cusertoolsmanager-class.md)物件的指標。|
|[CWinAppEx::在it上下文選單管理器](#initcontextmenumanager)|初始化 `CContextMenuManager` 物件。|
|[CWinAppEx::Init鍵盤管理員](#initkeyboardmanager)|初始化 `CKeyboardManager` 物件。|
|[CWinAppEx::InitMouse管理員](#initmousemanager)|初始化 `CMouseManager` 物件。|
|[CWinAppEx::InitShell管理員](#initshellmanager)|初始化類`CShellManager`|
|[CWinAppEx::InitTooltip管理員](#inittooltipmanager)|初始化 `CTooltipManager` 類別。|
|[CWinAppEx:是資源智慧更新](#isresourcesmartupdate)||
|[CWinAppEx:是否存在](#isstateexists)|指示指定的密鑰是否位於註冊表中。|
|[CWinAppEx::載入狀態](#loadstate)|從註冊表載入應用程式狀態。|
|[CWinAppEx:應用上下文説明](#onappcontexthelp)|當使用者請求 **「自定義」** 對話方塊的上下文説明時,由框架調用。|
|[CWinAppEx::OnView雙擊](#onviewdoubleclick)|當用戶雙擊應用程式中的任何位置時調用使用者定義的命令。|
|[CWinAppEx:在工作空間上](#onworkspaceidle)||
|[CWinAppEx::保存狀態](#savestate)|將應用程式框架的狀態寫入 Windows 註冊表。|
|[CWinAppEx::設置註冊庫](#setregistrybase)|設置預設註冊表項的路徑。 此鍵將作為所有後續註冊表調用的根。|
|[CWinAppEx::顯示彈出選單](#showpopupmenu)|顯示彈出式功能表。|
|[CWinAppEx::寫入二進制](#writebinary)|將二進位數據寫入指定的註冊表值。|
|[CWinAppEx::寫入](#writeint)|將數位數據寫入指定的註冊表值。|
|[CWinAppEx:寫入物件](#writeobject)|將派生自[CObject 類別](../../mfc/reference/cobject-class.md)資料寫入指定的註冊表值。|
|[CWinAppEx::寫節二進制](#writesectionbinary)|將二進位數據寫入指定註冊表項的值。|
|[CWinAppEx::寫科因](#writesectionint)|將數位資料寫入指定註冊表項的值。|
|[CWinAppEx:寫節物件](#writesectionobject)|將數據派生自類`CObject`寫入指定註冊表項的值。|
|[CWinAppEx::寫節串](#writesectionstring)|將字串資料寫入指定註冊表項的值。|
|[CWinAppEx::寫字串](#writestring)|將字串資料寫入指定的註冊表值。|

### <a name="protected-methods"></a>保護方法

|名稱|描述|
|----------|-----------------|
|[CWinAppEx::載入自訂狀態](#loadcustomstate)|載入應用程式狀態時由框架調用。|
|[CWinAppEx::載入視窗放置](#loadwindowplacement)|當框架從註冊表載入應用程式的大小和位置時,由它調用。 載入的資料包括應用程式上次關閉時主幀的大小和位置。|
|[CWinAppEx::打開主框架](#onclosingmainframe)|當主框架視窗正在處理時,框架調用WM_CLOSE。|
|[CWinAppEx::P重新載入狀態](#preloadstate)|在載入應用程式狀態之前由框架呼叫。|
|[CWinAppEx::P重新儲存狀態](#presavestate)|在保存應用程式狀態之前由框架調用。|
|[CWinAppEx::重新載入視窗放置](#reloadwindowplacement)|從註冊表重新載入的視窗大小和位置|
|[CWinAppEx::保存自定義狀態](#savecustomstate)|框架在將應用程式狀態寫入註冊表后調用它。|
|[CWinAppEx::商店視窗放置](#storewindowplacement)|由框架調用,將主框架的大小和位置寫入註冊錶。|

### <a name="data-members"></a>資料成員

|名稱|描述|
|----------|-----------------|
|[CWinAppEx:m_bForceImageReset](#m_bforceimagereset)|指定在載入包含工具列的框架視窗時,框架是否會重置所有工具列圖像。|

## <a name="remarks"></a>備註

MFC 框架提供的大部分功能取決於`CWinAppEx`類別 。 您可以透過以下兩種`CWinAppEx`方式 之一個類別的應用程式中:

- 在主`CWinAppEx`線程中構造類。

- 從`CWinAppEx`派生主應用程式類。

合併`CWinAppEx`到應用程式中後,可以初始化任一個應用程式管理器。 在使用應用程式管理員之前,必須透過調用適當的初始化方法初始化它。 要獲取指向特定管理器的指標,請調用關聯的 get 方法。 這個`CWinAppEx`類別管理以下應用程式管理員[:CMouseManager 類別](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)類別[、C鍵盤管理員類別](../../mfc/reference/ckeyboardmanager-class.md)[、CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)和[CMenuTearoffManager 類別](../../mfc/reference/cmenutearoffmanager-class.md)。

## <a name="inheritance-hierarchy"></a>繼承階層架構

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

[CWinApp](../../mfc/reference/cwinapp-class.md)

[CWinAppEx](../../mfc/reference/cwinappex-class.md)

## <a name="requirements"></a>需求

**標題:** afxwinappex.h

## <a name="cwinappexcleanstate"></a><a name="cleanstate"></a>CWinAppEx::清潔狀態

從 Windows 註冊表中刪除有關應用程式的所有資訊。

```
virtual BOOL CleanState(LPCTSTR lpszSectionName=NULL);
```

### <a name="parameters"></a>參數

*lpsz節名稱*<br/>
[在]包含註冊表項路徑的字串。

### <a name="return-value"></a>傳回值

如果方法成功,則非零;否則 0。

### <a name="remarks"></a>備註

此方法從註冊表的特定部分清除應用程序數據。 您可以使用參數*lpszSectionName*指定要清除的部分。 如果*lpszSectionName*為 NULL,則此方法將使用儲存`CWinAppEx`在物件中的 預設註冊錶路徑。 要取得預設註冊表路徑,請使用[CWinAppEx::取得註冊庫](#getregistrybase)。

## <a name="cwinappexcwinappex"></a><a name="cwinappex"></a>CWinAppEx:CWinAppEx

建構 `CWinAppEx` 物件。

```
CWinAppEx(BOOL bResourceSmartUpdate = FALSE);
```

### <a name="parameters"></a>參數

*b 資源智慧更新*<br/>
[在]一個布爾參數,用於指定工作區物件是否應檢測和處理資源更新。

### <a name="remarks"></a>備註

該`CWinAppEx`類具有初始化方法,提供用於將應用程式資訊保存和載入到註冊表的功能,並控制全域應用程式設置。 它可以使用全域管理員,如[鍵盤管理員類別](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)。 每個應用程式只能有`CWinAppEx`一個類的實例。

## <a name="cwinappexenableloadwindowplacement"></a><a name="enableloadwindowplacement"></a>CWinAppEx:開啟載入視窗放置

指定應用程式是否將從註冊表載入主框架視窗的初始大小和位置。

```
void EnableLoadWindowPlacement(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>參數

*b 啟用*<br/>
[在]指定應用程式是否從註冊表載入主框架視窗的初始大小和位置。

### <a name="remarks"></a>備註

默認情況下,主幀的大小和位置與其他應用程式設置一起從註冊表載入。 這發生在[CWinAppEx::載入狀態](#loadstate)。 如果不想從註冊表載入初始視窗放置,請調用此方法,將*bEnable*設置為 FALSE。

## <a name="cwinappexenabletearoffmenus"></a><a name="enabletearoffmenus"></a>CWinAppEx::啟用"離開功能表"

創建並初始化[CMenuTearOffManager](../../mfc/reference/cmenutearoffmanager-class.md)物件。

```
BOOL EnableTearOffMenus(
    LPCTSTR lpszRegEntry,
    const UINT uiCmdFirst,
    const UINT uiCmdLast);
```

### <a name="parameters"></a>參數

*lpszRegEntry*<br/>
[在]包含註冊表項路徑的字串。 應用程式使用此註冊表項存儲拆解功能表的資訊。

*uiCmdFirst*<br/>
[在]第一個撕下功能表 ID。

*uiCmdLast*<br/>
[在]上次撕下功能表 ID。

### <a name="return-value"></a>傳回值

如果成功創建`CMenuTearOffManager`和初始化,則為 TRUE;如果發生錯誤或已存在錯誤,`CMenuTearOffManager`則 FALSE。

### <a name="remarks"></a>備註

使用此功能在應用程式中啟用分義功能表。 應從`InitInstance`調用此函數。

## <a name="cwinappexenableusertools"></a><a name="enableusertools"></a>CWinAppEx:啟用使用者工具

使用戶能夠創建自定義功能表命令,以減少應用程式中的擊鍵。 此方法創建一個[CUserToolsManager](../../mfc/reference/cusertoolsmanager-class.md)物件。

```
BOOL EnableUserTools(
    const UINT uiCmdToolsDummy,
    const UINT uiCmdFirst,
    const UINT uiCmdLast,
    CRuntimeClass* pToolRTC = RUNTIME_CLASS(CUserTool),
    UINT uArgMenuID = 0,
    UINT uInitDirMenuID = 0);
```

### <a name="parameters"></a>參數

*uiCmdToolsDummy*<br/>
[在]框架用作使用者工具功能表的命令 ID 的占位符的無符號整數。

*uiCmdFirst*<br/>
[在]第一個使用者工具命令的命令 ID。

*uiCmdLast*<br/>
[在]最後一個使用者工具命令的命令 ID。

*pToolRTC*<br/>
[在]對象用於創建新`CUserToolsManager`使用者工具的類。

*uArgMenuID*<br/>
[在]參數功能表ID。

*烏伊尼特迪爾梅尼*<br/>
[在]初始工具目錄的功能表 ID。

### <a name="return-value"></a>傳回值

如果方法創建並初始化物件,則為`CUserToolsManager`TRUE;如果方法創建並初始化物件,則為 TRUE。如果方法失敗或物件已存在,`CUserToolsManager`則 FALSE。

### <a name="remarks"></a>備註

啟用使用者定義的工具時,框架將自動支援可在自定義期間擴展的動態功能表。 框架將每個新專案與外部命令關聯。 當使用者從 **「工具」** 選單中選擇適當的項時,框架將調用這些命令。

每次使用者添加新項時,框架都會創建一個新物件。 新物件的類類型由*pToolRTC*定義。 *pToolRTC*類別必須將派生自[CUserTool 類別](../../mfc/reference/cusertool-class.md)。

有關使用者工具以及如何將它們合併到應用程式中的詳細資訊,請參閱[使用者定義的工具](../../mfc/user-defined-tools.md)。

## <a name="cwinappexexitinstance"></a><a name="exitinstance"></a>CWinAppEx:退出實例

```
virtual int ExitInstance();
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cwinappexgetbinary"></a><a name="getbinary"></a>CWinAppEx:取得 Binary

從指定的註冊表項讀取二進位數據。

```
BOOL GetBinary(
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項名稱的字串。

*ppData*<br/>
[出]指向方法填充二進位數據的緩衝區的指標。

*p 位元組*<br/>
[出]指向無符號整數的指標,該方法用於寫入讀取的位元組數。

### <a name="return-value"></a>傳回值

如果成功,則為 TRUE;否則。

### <a name="remarks"></a>備註

此方法讀取寫入註冊表的二進位數據。 要將數據寫入註冊表,請使用[CWinAppEx::寫入 Binary](#writebinary)和[CWinAppEx::WriteCCBinary。](#writesectionbinary)

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetcontextmenumanager"></a><a name="getcontextmenumanager"></a>CWinAppEx:抓取內容選單管理員

返回指向全域[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件的指標。

```
CContextMenuManager* GetContextMenuManager();
```

### <a name="return-value"></a>傳回值

指向全域`CContextMenuManager`物件的指標。

### <a name="remarks"></a>備註

如果未初始化 CContextMenuManager 物件,則此函數在返回指標之前調用[CWinAppEx::initContext MenuManager。](#initcontextmenumanager)

## <a name="cwinappexgetdataversion"></a><a name="getdataversion"></a>CWinAppEx:取得資料版本

```
int GetDataVersion() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cwinappexgetdataversionmajor"></a><a name="getdataversionmajor"></a>CWinAppEx:取得資料版本主要

返回調用[CWinAppEx:::保存狀態](#savestate)時保存在 Windows 註冊表中的應用程式的主要版本。

```
int GetDataVersionMajor() const;
```

### <a name="return-value"></a>傳回值

包含主要版本號的整數值。

## <a name="cwinappexgetdataversionminor"></a><a name="getdataversionminor"></a>CWinAppEx:取得資料版本次要

返回調用[CWinAppEx:::保存狀態](#savestate)時保存在 Windows 註冊表中的應用程式的次要版本。

```
int GetDataVersionMinor() const;
```

### <a name="return-value"></a>傳回值

包含次要版本號的整數值。

## <a name="cwinappexgetint"></a><a name="getint"></a>CWinAppEx:Getint

從指定的註冊表項讀取整數數據。

```
int GetInt(
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項名稱的字串。

*n預設*<br/>
[在]如果指定的註冊表項不存在,該方法返回的預設值。

### <a name="return-value"></a>傳回值

如果方法成功,則註冊表數據;否則*n 預設*。

### <a name="remarks"></a>備註

此方法從註冊表讀取整數數據。 如果沒有與*lpszEntry*指示的註冊表項關聯的整數資料,則此方法將傳回*nDefault*。 要將數據寫入註冊表,請使用[CWinAppEx::WriteSectionint](#writesectionint)和[CWinAppEx::WriteInt。](#writeint)

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetkeyboardmanager"></a><a name="getkeyboardmanager"></a>CWinAppEx:取得鍵盤管理員

返回指向全域[鍵盤管理器](../../mfc/reference/ckeyboardmanager-class.md)物件的指標。

```
CKeyboardManager* GetKeyboardManager();
```

### <a name="return-value"></a>傳回值

指向全域`CKeyboardManager`物件的指標。

### <a name="remarks"></a>備註

如果未初始化鍵盤管理員,則此函數在返回指標之前呼叫[CWinAppEx::Init 鍵盤管理員](#initkeyboardmanager)。

## <a name="cwinappexgetmousemanager"></a><a name="getmousemanager"></a>CWinAppEx:取得滑鼠管理員

返回指向全域[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件的指標。

```
CMouseManager* GetMouseManager();
```

### <a name="return-value"></a>傳回值

指向全域`CMouseManager`物件的指標。

### <a name="remarks"></a>備註

如果未初始化滑鼠管理器,則此函數在返回指標之前調用[CWinAppEx::InitMouseManager。](#initmousemanager)

## <a name="cwinappexgetobject"></a><a name="getobject"></a>CWinAppEx:取得物件

從註冊表讀取[CObject](../../mfc/reference/cobject-class.md)- dervied 資料。

```
BOOL GetObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項的相對路徑的字串。

*obj*<br/>
[出]對的`CObject`引用。 該方法使用此引用來存儲註冊表數據。

### <a name="return-value"></a>傳回值

如果方法成功,則非零;否則 0。

### <a name="remarks"></a>備註

此方法從 派生`CObject`自的註冊表讀取數據。 要將資料`CObject`寫入註冊表,請使用[CWinAppEx::writeObject](#writeobject)或[CWinAppEx::WriteSectionObject](#writesectionobject)。

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetregistrybase"></a><a name="getregistrybase"></a>CWinAppEx:取得註冊庫

檢索應用程式的預設註冊錶路徑。

```
LPCTSTR GetRegistryBase();
```

### <a name="return-value"></a>傳回值

包含預設註冊表位置的路徑的字串。

### <a name="remarks"></a>備註

訪問註冊表的[CWinAppEx 類](../../mfc/reference/cwinappex-class.md)的所有方法都從預設位置開始。 使用此方法檢索預設註冊表位置的路徑。 使用[CWinAppEx::設置註冊庫](#setregistrybase)以更改預設註冊表位置。

## <a name="cwinappexgetregsectionpath"></a><a name="getregsectionpath"></a>CWinAppEx:取得 RegSectionPath

創建並返回註冊表項的絕對路徑。

```
CString GetRegSectionPath(LPCTSTR szSectionAdd = _T(""));
```

### <a name="parameters"></a>參數

*sz節新增*<br/>
[在]包含註冊表項的相對路徑的字串。

### <a name="return-value"></a>傳回值

包含`CString`註冊表項目的絕對路徑的 。

### <a name="remarks"></a>備註

此方法通過將*szSectionAdd*中的相對路徑追加到應用程式的預設註冊表位置來定義註冊表項的絕對路徑。 要獲取預設註冊表項,請使用[CWinAppEx::getRegistryBase](#getregistrybase)的方法。

## <a name="cwinappexgetsectionbinary"></a><a name="getsectionbinary"></a>CWinAppEx:獲取截面二進位

從註冊表讀取二進位數據。

```
BOOL GetSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項的相對路徑的字串。

*lpszEntry*<br/>
[在]包含要讀取的值的字串。

*ppData*<br/>
[出]指向方法存儲數據的緩衝區的指標。

*p 位元組*<br/>
[出]指向無符號整數的指標。 該方法將*ppData*的大小寫入此參數。

### <a name="return-value"></a>傳回值

如果成功，則為 TRUE，否則為 FALSE。

### <a name="remarks"></a>備註

此方法使用[CWinAppEx::writeBinary](#writebinary)和[CWinAppEx::WriteCWinAppEx::WriteCCbinary)](#writesectionbinary)讀取寫入註冊表的二進位數據。

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetsectionint"></a><a name="getsectionint"></a>CWinAppEx:獲取科科因

從註冊表讀取整數數據。

```
int GetSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nDefault = 0);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項的相對路徑的字串。

*lpszEntry*<br/>
[在]包含要讀取的值的字串。

*n預設*<br/>
[在]如果指定值不存在,則返回的預設值。

### <a name="return-value"></a>傳回值

存儲在指定註冊表值中的整數數據;n 如果資料不存在,*則預設為。*

### <a name="remarks"></a>備註

使用[CWinAppEx::WriteInt](#writeint)和[CWinAppEx:writeSectionint](#writesectionint)的方法將整數數據寫入註冊表。

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是添加到應用程式的預設註冊表項末尾的相對路徑。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetsectionobject"></a><a name="getsectionobject"></a>CWinAppEx:取得節點物件

從註冊表讀取[CObject](../../mfc/reference/cobject-class.md)註冊表數據。

```
BOOL GetSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項的相對路徑的字串。

*lpszEntry*<br/>
[在]包含要讀取的值的字串。

*obj*<br/>
[出]對的`CObject`引用。 該方法使用它`CObject`來存儲註冊表數據。

### <a name="return-value"></a>傳回值

如果成功則為非零；否則為 0。

### <a name="remarks"></a>備註

此方法從註冊表讀取數據。 讀取的資料是`CObject`從 衍生的類別資料或`CObject`資料 。 要將資料`CObject`寫入註冊表,請使用[CWinAppEx::writeObject](#writeobject)或[CWinAppEx::WriteSectionObject](#writesectionobject)。

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetsectionstring"></a><a name="getsectionstring"></a>CWinAppEx:取得節串

從註冊表讀取字串資料。

```
CString GetSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = _T(""));
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項的相對路徑的字串。

*lpszEntry*<br/>
[在]包含要讀取的值的字串。

*lpszDefault*<br/>
[在]如果指定值不存在,則返回的預設值。

### <a name="return-value"></a>傳回值

如果數據存在,則存儲在指定註冊表值中的字串數據;否則*lpszDefault*。

### <a name="remarks"></a>備註

此方法讀取寫入註冊表的字串資料。 使用[CWinAppEx::WriteString](#writestring)和[CWinAppEx:write 節位元串](#writesectionstring)寫入註冊表。

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgetshellmanager"></a><a name="getshellmanager"></a>CWinAppEx:取得殼牌管理員

返回指向全域[CShellManager](../../mfc/reference/cshellmanager-class.md)物件的指標。

```
CShellManager* GetShellManager();
```

### <a name="return-value"></a>傳回值

指向全域`CShellManager`物件的指標。

### <a name="remarks"></a>備註

如果未初始`CShellManager`化物件,此函數在返回指標之前調用[CWinAppEx::InitShellManager。](#initshellmanager)

## <a name="cwinappexgetstring"></a><a name="getstring"></a>CWinAppEx:GetString

從指定的註冊表項讀取字串資料。

```
CString GetString(
    LPCTSTR lpszEntry,
    LPCTSTR lpzDefault= _T(""));
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項目名稱的字串

*lpzDefault*<br/>
[在]如果指定的註冊表項不存在,該方法返回的預設值。

### <a name="return-value"></a>傳回值

如果成功,存儲在註冊表中的字串數據;*否則,lpszDefault。*

### <a name="remarks"></a>備註

此方法讀取寫入註冊表的字串資料。 要將資料寫入註冊表,請使用[CWinAppEx::WriteString](#writestring)或[CWinAppEx::Write 節字串](#writesectionstring)。

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexgettooltipmanager"></a><a name="gettooltipmanager"></a>CWinAppEx:抓取工具提示管理員

返回指向全域[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件的指標。

```
CTooltipManager* GetTooltipManager();
```

### <a name="return-value"></a>傳回值

指向全域`CTooltipManager`物件的指標。

### <a name="remarks"></a>備註

如果未初始`CTooltipManager`化物件,此函數在返回指標之前調用[CWinAppEx::InitTooltipManager。](#inittooltipmanager)

## <a name="cwinappexgetusertoolsmanager"></a><a name="getusertoolsmanager"></a>CWinAppEx:取得使用者工具管理員

返回指向全域[CUserTools Manager](../../mfc/reference/cusertoolsmanager-class.md)物件的指標。

```
CUserToolsManager* GetUserToolsManager();
```

### <a name="return-value"></a>傳回值

指向全域物件的指標;`CUserToolsManager`指向全域物件的指標如果未為應用程式啟用使用者工具管理,則為 NULL。

### <a name="remarks"></a>備註

在檢索指向物件的`CUserToolsManager`指標之前,必須通過調用[CWinAppEx::啟用UserTools](#enableusertools)來初始化管理器。

## <a name="cwinappexinitcontextmenumanager"></a><a name="initcontextmenumanager"></a>CWinAppEx::在it上下文選單管理器

初始化[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件。

```
BOOL InitContextMenuManager();
```

### <a name="return-value"></a>傳回值

如果方法創建 CContextMenuManager 物件,則非零;如果物件已`CContextMenuManager`存在,則為 0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx::取得ContextMenuManager,](#getcontextmenumanager)該方法的預設實現`InitContextMenuManager`呼叫 。

如果應用程式已具有上下文菜單管理器,並且調用`InitContextMenuManager`,則應用程式將出現[ASSERT](diagnostic-services.md#assert)失敗。 因此,如果直接創建物件`InitContextMenuManager`,`CContextMenuManager`則不應呼叫。 如果不使用自定義`CContextMenuManager`,則應`GetContextMenuManager`使用`CContextMenuManager`來創建 物件。

## <a name="cwinappexinitkeyboardmanager"></a><a name="initkeyboardmanager"></a>CWinAppEx::Init鍵盤管理員

初始化[鍵盤管理員](../../mfc/reference/ckeyboardmanager-class.md)物件。

```
BOOL InitKeyboardManager();
```

### <a name="return-value"></a>傳回值

如果方法創建`CKeyboardManager`物件,則非零;如果物件已`CKeyboardManager`存在,則為 0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx::取得鍵盤管理員](#getkeyboardmanager),則該方法的預設實現`InitKeyboardManager`呼叫 。

如果應用程式已具有鍵盤管理器,並且調用`InitKeyboardManager`,則應用程式將出現[ASSERT](diagnostic-services.md#assert)失敗。 因此,如果直接創建物件`InitKeyboardManager`,`CKeyboardManager`則不應呼叫。 如果不使用自定義`CKeyboardManager`,則應`GetKeyboardManager`使用`CKeyboardManager`來創建 物件。

## <a name="cwinappexinitmousemanager"></a><a name="initmousemanager"></a>CWinAppEx::InitMouse管理員

初始化[CMouseManager](../../mfc/reference/cmousemanager-class.md)物件。

```
BOOL InitMouseManager();
```

### <a name="return-value"></a>傳回值

如果方法創建`CMouseManager`物件,則非零;如果物件已`CMouseManager`存在,則為 0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx::GetMouseManager,](#getmousemanager)該方法的預設實現`InitMouseManager`呼叫 。

如果應用程式已具有滑鼠管理器,並且呼叫`InitMouseManager`,則應用程式將出現[ASSERT](diagnostic-services.md#assert)失敗。 因此,如果直接創建`InitMouseManager`物件`CMouseManager`, 則不應呼叫。 如果不使用自定義`CMouseManager`,則應`GetMouseManager`使用`CMouseManager`來創建 物件。

## <a name="cwinappexinitshellmanager"></a><a name="initshellmanager"></a>CWinAppEx::InitShell管理員

初始化[CShellManager](../../mfc/reference/cshellmanager-class.md)物件。

```
BOOL InitShellManager();
```

### <a name="return-value"></a>傳回值

如果方法創建`CShellManager`物件,則非零;如果物件已`CShellManager`存在,則為 0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx::getShellManager,](#getshellmanager)該方法的預設實現`InitShellManager`呼叫 。

如果應用程式已具有 shell 管理器,並且`InitShellManager`呼叫 ,則應用程式將引發[ASSERT](diagnostic-services.md#assert)失敗。 因此,如果直接創建`InitShellManager`物件,`CShellManager`請不要呼叫。 如果不使用自定義`CShellManager`,請`GetShellManager`使用`CShellManager`創建 物件。

## <a name="cwinappexinittooltipmanager"></a><a name="inittooltipmanager"></a>CWinAppEx::InitTooltip管理員

初始化[CTooltipManager](../../mfc/reference/ctooltipmanager-class.md)物件。

```
BOOL InitTooltipManager();
```

### <a name="return-value"></a>傳回值

如果方法創建`CTooltipManager`物件,則非零;如果物件已`CTooltipManager`存在,則為 0。

### <a name="remarks"></a>備註

如果您呼叫[CWinAppEx::getTooltipManager,](#gettooltipmanager)該方法的預設實現`InitTooltipManager`呼叫 。

如果應用程式已有工具提示管理員,並且您呼叫`InitTooltipManager`,則應用程式將出現[ASSERT](diagnostic-services.md#assert)失敗。 因此,如果直接創建物件`InitTooltipManager`,`CTooltipManager`則不應呼叫。 如果不使用自定義`CTooltipManager`,則應`GetTooltipManager`使用`CTooltipManager`來創建 物件。

## <a name="cwinappexisresourcesmartupdate"></a><a name="isresourcesmartupdate"></a>CWinAppEx:是資源智慧更新

```
BOOL IsResourceSmartUpdate() const;
```

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cwinappexisstateexists"></a><a name="isstateexists"></a>CWinAppEx:是否存在

指示指定的密鑰是否位於註冊表中。

```
BOOL IsStateExists(LPCTSTR lpszSectionName);
```

### <a name="parameters"></a>參數

*lpsz節名稱*<br/>
[在]包含註冊表項路徑的字串。

### <a name="return-value"></a>傳回值

如果金鑰在註冊表中,則非零;否則 0。

## <a name="cwinappexloadcustomstate"></a><a name="loadcustomstate"></a>CWinAppEx::載入自訂狀態

框架在從註冊表載入應用程式的狀態後調用此方法。

```
virtual void LoadCustomState();
```

### <a name="remarks"></a>備註

如果要在應用程式從註冊表載入狀態後執行任何處理,請重寫此方法。 默認情況下,此方法不執行任何操作。

為了從註冊表載入自定義狀態資訊,必須首先使用[CWinAppEx:::保存自定義狀態保存](#savecustomstate)資訊。

## <a name="cwinappexloadstate"></a><a name="loadstate"></a>CWinAppEx::載入狀態

從 Windows 註冊表讀取應用程式狀態。

```
BOOL LoadState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL LoadState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

virtual BOOL LoadState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
[在]指向幀視窗物件的指標。 該方法將註冊表中的狀態資訊應用於此幀視窗。

*lpsz節名稱*<br/>
[在]包含註冊表項的相對路徑的字串。

*pFrameImpl*<br/>
[在]指向`CFrameImpl`物件的指標。 該方法將註冊表中的狀態資訊應用於此幀視窗。

### <a name="return-value"></a>傳回值

如果成功,則非零;0 否則。

### <a name="remarks"></a>備註

此方法載入應用程式的狀態和幀視窗的任何狀態資訊。 幀視窗的載入資訊應用於提供的幀視窗。 如果不提供幀視窗,則僅載入應用程式狀態資訊。 應用程式資訊包括[CMouseManager 類](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager 類](../../mfc/reference/ccontextmenumanager-class.md)[、C鍵盤管理員類](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)的狀態。

調用`CFrameImpl::OnLoadFrame``LoadState`的默認實現。

*lpszSectionName*參數不是註冊表項的絕對路徑。 它是添加到應用程式的預設註冊表項末尾的相對路徑。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexloadwindowplacement"></a><a name="loadwindowplacement"></a>CWinAppEx::載入視窗放置

當框架從註冊表載入主框架視窗的大小和位置時,由框架調用。

```
virtual BOOL LoadWindowPlacement(
    CRect& rectNormalPosition,
    int& nFlags,
    int& nShowCmd);
```

### <a name="parameters"></a>參數

*rect 正常位置*<br/>
[出]在主框架窗口處於還原位置時包含其座標的矩形。

*nFlags*<br/>
[出]控制最小化視窗的位置以及作業系統在最小化視窗和還原視窗之間切換的方式的標誌。

*nShowCmd*<br/>
[出]指定視窗的顯示狀態的整數。 有關可能值的詳細資訊,請參閱[CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

### <a name="return-value"></a>傳回值

如果成功,則非零;0 否則。

### <a name="remarks"></a>備註

默認情況下,MFC 在應用程式啟動時自動載入主框架視窗的上一個位置和狀態。 有關此資訊如何儲存在註冊表中的詳細資訊,請參閱[CWinAppEx::儲存視窗放置](#storewindowplacement)。

如果要載入有關主框架視窗的其他資訊,則重寫此方法。

## <a name="cwinappexm_bforceimagereset"></a><a name="m_bforceimagereset"></a>CWinAppEx:m_bForceImageReset

指定框架在重新載入包含工具列的框架視窗時是否重置所有工具列圖像。

```
BOOL m_bForceImageReset;
```

### <a name="remarks"></a>備註

數據`m_bForceImageReset`成員是受保護的變數。

## <a name="cwinappexonappcontexthelp"></a><a name="onappcontexthelp"></a>CWinAppEx:應用上下文説明

當使用者請求**自定義**對話方塊的上下文説明時,框架將調用此方法。

```
virtual void OnAppContextHelp(
    CWnd* pWndControl,
    const DWORD dwHelpIDArray[]);
```

### <a name="parameters"></a>參數

*pWndControl*<br/>
[在]指向視窗物件的指標,使用者在調用上下文時説明該視窗物件。

*dwHelpIDArray]**<br/>
[在]保留值。

### <a name="remarks"></a>備註

此方法當前保留以供將來使用。 預設實現不執行任何操作,並且框架當前不調用它。

## <a name="cwinappexonclosingmainframe"></a><a name="onclosingmainframe"></a>CWinAppEx::打開主框架

當幀視窗正在處理WM_CLOSE時,框架調用此方法。

```
virtual void OnClosingMainFrame(CFrameImpl* pFrameImpl);
```

### <a name="parameters"></a>參數

*pFrameImpl*<br/>
[在]指向`CFrameImpl`物件的指標。

### <a name="remarks"></a>備註

此方法的預設實現保存*pFrameImpl*的狀態。

## <a name="cwinappexonviewdoubleclick"></a><a name="onviewdoubleclick"></a>CWinAppEx::OnView雙擊

呼叫使用者定義的指令,當使用者按兩下該檢視中的任意位置時,該命令與視圖關聯。

```
virtual BOOL OnViewDoubleClick(
    CWnd* pWnd,
    int iViewId);
```

### <a name="parameters"></a>參數

*pwnd*<br/>
[在]指向從[CView 類](../../mfc/reference/cview-class.md)派生的物件的指標。

*iViewId*<br/>
[在]視圖 ID。

### <a name="return-value"></a>傳回值

如果框架找到命令,則為 TRUE;如果框架找到命令,則為 TRUE。否則 FALSE。

### <a name="remarks"></a>備註

為了支援自定義滑鼠行為,您必須在處理WM_LBUTTONDBLCLK消息時調用此函數。 此方法將執行與*iViewId*提供的檢視 ID 關聯的命令。 有關自訂滑鼠行為的詳細資訊,請參閱[鍵盤和滑鼠自訂](../../mfc/keyboard-and-mouse-customization.md)。

## <a name="cwinappexonworkspaceidle"></a><a name="onworkspaceidle"></a>CWinAppEx:在工作空間上

```
virtual BOOL OnWorkspaceIdle(CWnd*);
```

### <a name="parameters"></a>參數

[在]*CWnd&#38;*<br/>

### <a name="return-value"></a>傳回值

### <a name="remarks"></a>備註

## <a name="cwinappexpreloadstate"></a><a name="preloadstate"></a>CWinAppEx::P重新載入狀態

框架在從註冊表載入應用程式的狀態之前立即調用此方法。

```
virtual void PreLoadState();
```

### <a name="remarks"></a>備註

如果要在框架載入應用程式狀態之前立即執行任何處理,請重寫此方法。

## <a name="cwinappexpresavestate"></a><a name="presavestate"></a>CWinAppEx::P重新儲存狀態

框架在保存應用程式狀態之前立即調用此方法。

```
virtual void PreSaveState();
```

### <a name="remarks"></a>備註

如果要在框架保存應用程式狀態之前立即執行任何處理,請重寫此方法。

## <a name="cwinappexreloadwindowplacement"></a><a name="reloadwindowplacement"></a>CWinAppEx::重新載入視窗放置

從註冊表重新載入視窗的大小和位置。

```
virtual BOOL ReloadWindowPlacement(CFrameWnd* pFrame);
```

### <a name="parameters"></a>參數

*pFrame*<br/>
[在]指向框架視窗的指標。

### <a name="return-value"></a>傳回值

如果方法成功,則非零;如果負載失敗或沒有要載入的數據,則為 0。

### <a name="remarks"></a>備註

使用函數[CWinAppEx::儲存視窗放置](#storewindowplacement)將視窗的大小和位置寫入註冊表。

## <a name="cwinappexsavecustomstate"></a><a name="savecustomstate"></a>CWinAppEx::保存自定義狀態

框架在將應用程式的狀態保存到註冊表后調用此方法。

```
virtual void SaveCustomState();
```

### <a name="remarks"></a>備註

如果要在應用程式將狀態保存到註冊表后執行任何處理,請重寫此方法。 默認情況下,此方法不執行任何操作。

## <a name="cwinappexsavestate"></a><a name="savestate"></a>CWinAppEx::保存狀態

將應用程式狀態寫入 Windows 註冊表。

```
virtual BOOL SaveState(
    LPCTSTR lpszSectionName = NULL,
    CFrameImpl* pFrameImpl = NULL);

BOOL SaveState(
    CMDIFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    CFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);

BOOL SaveState(
    COleIPFrameWndEx* pFrame,
    LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>參數

*lpsz節名稱*<br/>
[在]包含註冊表項的相對路徑的字串。

*pFrameImpl*<br/>
[在]指向`CFrameImpl`物件的指標。 此框架將保存到 Windows 註冊表。

*pFrame*<br/>
[在]指向幀視窗物件的指標。 此框架將保存到 Windows 註冊表。

### <a name="return-value"></a>傳回值

如果成功,則為 TRUE;否則。

### <a name="remarks"></a>備註

此方法保存應用程式的狀態和提供幀視窗的任何狀態資訊。 如果不提供幀視窗,該方法將僅保存應用程式狀態。 應用程式資訊包括[CMouseManager 類](../../mfc/reference/cmousemanager-class.md)[、CContextMenuManager 類](../../mfc/reference/ccontextmenumanager-class.md)[、C鍵盤管理員類](../../mfc/reference/ckeyboardmanager-class.md)和[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)的狀態。

*lpszSectionName*參數不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

## <a name="cwinappexsetregistrybase"></a><a name="setregistrybase"></a>CWinAppEx::設置註冊庫

設置應用程式的預設註冊錶路徑。

```
LPCTSTR SetRegistryBase(LPCTSTR lpszSectionName = NULL);
```

### <a name="parameters"></a>參數

*lpsz節名稱*<br/>
[在]包含註冊表項路徑的字串。

### <a name="return-value"></a>傳回值

包含預設註冊表位置的路徑的字串。

### <a name="remarks"></a>備註

訪問註冊表的[CWinAppEx 類](../../mfc/reference/cwinappex-class.md)的所有方法都從預設位置開始。 使用此方法更改該預設註冊表位置。 使用[CWinAppEx:獲取註冊庫](#getregistrybase)來檢索默認註冊表位置。

## <a name="cwinappexshowpopupmenu"></a><a name="showpopupmenu"></a>CWinAppEx::顯示彈出選單

顯示彈出式功能表。

```
virtual BOOL ShowPopupMenu(
    UINT uiMenuResId,
    const CPoint& point,
    CWnd* pWnd);
```

### <a name="parameters"></a>參數

*uiMenuResId*<br/>
[在]功能表資源識別碼。

*點*<br/>
[在]指定選單在螢幕座標中位置的[CPoint。](../../atl-mfc-shared/reference/cpoint-class.md)

*pwnd*<br/>
[在]指向具有彈出功能表的視窗的指標。

### <a name="return-value"></a>傳回值

如果彈出功能表成功顯示,則非零;0 否則。

### <a name="remarks"></a>備註

此方法顯示與*uiMenuResId*關聯的功能表。

要支援彈出式功能表,您必須具有[CContextMenuManager](../../mfc/reference/ccontextmenumanager-class.md)物件。 如果尚未初始化物件,`CContextMenuManager``ShowPopupMenu`將失敗。

## <a name="cwinappexstorewindowplacement"></a><a name="storewindowplacement"></a>CWinAppEx::商店視窗放置

由框架調用,將主框架視窗的大小和位置寫入註冊表。

```
virtual BOOL StoreWindowPlacement(
    const CRect& rectNormalPosition,
    int nFlags,
    int nShowCmd);
```

### <a name="parameters"></a>參數

*nFlags*<br/>
[在]控制最小化視窗的位置以及作業系統在最小化視窗和還原視窗之間切換的方式的標誌。

*nShowCmd*<br/>
[在]指定視窗的顯示狀態的整數。 有關可能值的詳細資訊,請參閱[CWnd::ShowWindow](../../mfc/reference/cwnd-class.md#showwindow)。

*rect 正常位置*<br/>
[在]在主框架視窗處於還原狀態時包含其座標的矩形。

### <a name="return-value"></a>傳回值

如果成功,則非零;0 否則。

### <a name="remarks"></a>備註

預設情況下,MFC 會在應用程式退出之前自動保存主框架視窗的位置和狀態。 此資訊儲存在應用程式的預設註冊表位置的「視窗放置」鍵下的 Windows 註冊表中。 有關應用程式的預設註冊表位置的詳細資訊,請參閱[CWinAppEx::取得註冊庫](#getregistrybase)。

如果要存儲有關主框架視窗的其他資訊,則重寫此方法。

## <a name="cwinappexwritebinary"></a><a name="writebinary"></a>CWinAppEx::寫入二進制

將二進位數據寫入註冊表。

```
BOOL WriteBinary(
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項名稱的字串。

*pData*<br/>
[在]要存儲的數據。

*n 位元組*<br/>
[在]*pData*的大小(以位元組為單位)。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

如果*lpszentry*指定的鍵不存在,則此方法將創建它。

## <a name="cwinappexwriteint"></a><a name="writeint"></a>CWinAppEx::寫入

將數位數據寫入註冊表。

```
BOOL WriteInt(
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項名稱的字串。

*n值*<br/>
[在]要存儲的數據。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

如果*lpszentry*指定的鍵不存在,則此方法將創建它。

## <a name="cwinappexwriteobject"></a><a name="writeobject"></a>CWinAppEx:寫入物件

將派生自[CObject 類](../../mfc/reference/cobject-class.md)的數據寫入註冊表。

```
BOOL WriteObject(
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含要設定的值的字串。

*obj*<br/>
[在]對`CObject`方法將存儲的數據的引用。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

此方法將*obj*資料寫入預設註冊表項下的指定值。 使用[CWinAppEx:獲取註冊庫](#getregistrybase)以確定當前的註冊表項。

## <a name="cwinappexwritesectionbinary"></a><a name="writesectionbinary"></a>CWinAppEx::寫節二進制

將二進位資料寫入註冊表中的值。

```
BOOL WriteSectionBinary(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項目名稱的字串

*lpszEntry*<br/>
[在]包含要設定的值的字串。

*pData*<br/>
[在]要寫入註冊表的數據。

*n 位元組*<br/>
[在]*pData*的大小(以位元組為單位)。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

如果*lpszentry*指定的鍵不存在,則此方法將創建它。

## <a name="cwinappexwritesectionint"></a><a name="writesectionint"></a>CWinAppEx::寫科因

將數位數據寫入註冊表。

```
BOOL WriteSectionInt(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項的相對路徑的字串。

*lpszEntry*<br/>
[在]包含要設定的值的字串。

*n值*<br/>
[在]要寫入註冊表的數據。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是附加到應用程式的預設註冊表項的相對路徑。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

如果*lpszentry*指定的鍵不存在,則此方法將創建它。

## <a name="cwinappexwritesectionobject"></a><a name="writesectionobject"></a>CWinAppEx:寫節物件

將派生自[CObject 類別](../../mfc/reference/cobject-class.md)資料寫入特定的註冊表值。

```
BOOL WriteSectionObject(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    CObject& obj);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項名稱的字串。

*lpszEntry*<br/>
[在]包含要設定的值的名稱的字串。

*obj*<br/>
[在]要存儲的數據。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要獲取或設置預設註冊表項,請使用[CWinAppEx::獲取註冊庫](#getregistrybase)和[CWinAppEx::setRegistryBase](#setregistrybase)的方法。

如果*lpszEntry*指定的值在*lpszSubSection*指定的註冊表項下不存在,則此方法將創建該值。

## <a name="cwinappexwritesectionstring"></a><a name="writesectionstring"></a>CWinAppEx::寫節串

將字串資料寫入註冊表中的值。

```
BOOL WriteSectionString(
    LPCTSTR lpszSubSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>參數

*lpsz 子節*<br/>
[在]包含註冊表項名稱的字串。

*lpszEntry*<br/>
[在]包含要設定的值的字串。

*lpszValue*<br/>
[在]要寫入註冊表的字串數據。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszSubSection 參數*不是註冊表項的絕對路徑。 它是一個相對路徑,追加到應用程式的預設註冊表項的末尾。 要獲取或設置預設註冊表項,請使用[CWinAppEx::獲取註冊庫](#getregistrybase)和[CWinAppEx::setRegistryBase](#setregistrybase)的方法。

如果*lpszEntry*指定的值在*lpszSubSection*下不存在,則此方法將創建它。

## <a name="cwinappexwritestring"></a><a name="writestring"></a>CWinAppEx::寫字串

將字串資料寫入註冊表。

```
BOOL WriteString(
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>參數

*lpszEntry*<br/>
[在]包含註冊表項名稱的字串。

*lpszValue*<br/>
[在]要存儲的數據。

### <a name="return-value"></a>傳回值

如果此方法成功,則為 TRUE;否則 FALSE。

### <a name="remarks"></a>備註

*lpszEntry*參數是位於應用程式的預設註冊表項下的註冊表項的名稱。 要取得或設定預設註冊表項,請使用[CWinAppEx::取得註冊庫](#getregistrybase)和[CWinAppEx::設定註冊表項的方法](#setregistrybase)。

如果*lspzentry*指定的鍵不存在,則此方法將創建它。

## <a name="see-also"></a>另請參閱

[階層架構圖表](../../mfc/hierarchy-chart.md)<br/>
[類別](../../mfc/reference/mfc-classes.md)<br/>
[CWinApp 類別](../../mfc/reference/cwinapp-class.md)<br/>
[滑鼠管理員類別](../../mfc/reference/cmousemanager-class.md)<br/>
[CContextMenuManager 類別](../../mfc/reference/ccontextmenumanager-class.md)<br/>
[CKeyboardManager 類別](../../mfc/reference/ckeyboardmanager-class.md)<br/>
[CUserToolsManager 類別](../../mfc/reference/cusertoolsmanager-class.md)
