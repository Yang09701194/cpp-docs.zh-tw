---
title: MFC 應用程式精靈、資料庫支援
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: c13d56d2fee45e130aba81168188bec6d8828d51
ms.sourcegitcommit: c123cc76bb2b6c5cde6f4c425ece420ac733bf70
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/14/2020
ms.locfileid: "81365884"
---
# <a name="database-support-mfc-application-wizard"></a>MFC 應用程式精靈、資料庫支援

此頁提供了允許您為專案指定資料庫支援級別(如有必要,包括數據源)的選項。

- **資料庫支援**

   設置項目的資料庫支持級別。

   |選項|描述|
   |------------|-----------------|
   |**None**|不提供資料庫支援。 這是預設選項。|
   |**只有標題檔案**|為應用程式提供基本級別的資料庫支援。 如果在**客戶端類型**下選擇 ODBC 支援,MFC 應用程式精靈將標題檔 AFXDB 包括在專案中。H。 它添加連結庫,但不會創建任何特定於資料庫的類。 您可以稍後創建記錄集,並使用它們來檢查和更新記錄。 如果在**客戶端類型**下選擇 OLE DB 支援,則包括以下標頭檔:ATLBASE。H AFXOLEDB。H ATLPLUS。H|
   |**沒有檔案支援的資料庫檢視**|包括資料庫標頭檔、連結庫、記錄檢視和記錄集。 (僅適用於在["應用程式類型"](../../mfc/reference/application-type-mfc-application-wizard.md)頁中選擇**的文檔/檢視體系結構支援**選項的應用程式。此選項包括文件支援,但不支援序列化。 如果選擇包括資料庫檢視,則必須指定數據源。|
   |**支援檔案的資料庫檢視**|包括資料庫標頭檔、連結庫、記錄檢視和記錄集。 (僅適用於在 **"應用程式類型"** 頁中選擇**的文檔/檢視體系結構支援**選項的應用程式。這個選項支援文件序列化,例如,您可以使用該序列化來更新使用者設定檔檔。 資料庫應用程式通常以每記錄為基礎,而不是基於每個檔運行,因此不需要序列化。 但是,您可能有序列化的特殊用途。 如果選擇包括資料庫檢視,則必須指定數據源。|

   > [!NOTE]
   > 在 **「資料庫支援**」 下,如果選擇**沒有檔案支援的資料庫檢視**或**具有檔案支援的資料庫檢視**,則檢視類派生會因**客戶端類型**選擇而異,如下所示:

  - 如果在**客戶端型**態 下選擇**ODBC,** 則應用程式的檢視類別派生自[CRecordView](../../mfc/reference/crecordview-class.md)。 此類與[CRecordset](../../mfc/reference/crecordset-class.md)派生類相關聯,MFC 應用程式精靈還會為您創建該類。 此選項提供了一個基於窗體的應用程式,其中記錄視圖用於通過其記錄集查看和更新記錄。

  - 如果在**客戶端類型**下選擇**OLE DB,** 則檢視類派生自[COleDBRecordView](../../mfc/reference/coledbrecordview-class.md),並且它與[CTable](../../data/oledb/ctable-class.md)或[CCommand](../../data/oledb/ccommand-class.md)派生類相關聯。

- **用戶端類型**

   指示專案是使用 OLE DB 還是 ODBC 類。

   |選項|描述|
   |------------|-----------------|
   |**OLE DB**|選擇這個選項後,按下 **「資料來源**」按鈕將呼叫 **「資料連結屬性**」向導,以説明您創建與 OLE 資料庫資料來源的連接。|
   |**ODBC**|選擇這個選項後,按下 **「資料來源**」按鈕將呼叫 **「選擇資料來源**」向導,以説明您創建到 ODBC 資料來源的連接。|

- **資料來源**

   > [!NOTE]
   > ATL OLE DB 消費者嚮導和 MFC ODBC 消費者嚮導在 Visual Studio 2019 及更高版本中不可用。 您仍能手動新增功能。 如需詳細資訊，請參閱[未使用精靈建立消費者](../../data/oledb/creating-a-consumer-without-using-a-wizard.md)。

   按下 **「資料來源**」按鈕可使用指定的驅動程式或提供程式和資料庫設定數據來源。 如果在 **「用戶端類型」** 選項中選擇 OLE DB,則此按鈕將顯示 **「資料連結屬性**」對話框。 如果在 **「用戶端類型」** 選項中選擇 ODBC,則此按鈕提供 **「選擇數據源**」對話方塊。 僅當選擇在應用程式中包含資料庫檢視時,此選項才可用。

   |選項|描述|
   |------------|-----------------|
   |**資料連結屬性**(OLE DB)|使用指定的 OLE DB 提供程式建立指定的數據來源。 您必須指定 OLE DB 提供程式、資料的位置、資料源、登錄 ID 和(可選)密碼。 有關此對話框的詳細資訊,請參閱[ATL OLE DB 消費者精靈](../../atl/reference/atl-ole-db-consumer-wizard.md)中的**資料來源**。|
   |**選擇資料來源**(ODBC)|使用指定的 ODBC 驅動程式建立指定的數據來源。 您必須選擇資料來源名稱才能為資料來源選擇表。 嚮導將表的所有列綁定到`CRecordset`派生類的成員變數。 有關此對話框的詳細資訊,請參閱[MFC ODBC 消費者精靈](../../mfc/reference/mfc-odbc-consumer-wizard.md)中的**資料來源**。|

- **產生屬性化資料庫類別**

   僅適用於 OLE DB 用戶端。 指定生成的專案中的資料庫類是否使用屬性。

- **繫結所有欄**

   僅適用於 ODBC 用戶端。 指定是否綁定所選表中的所有欄。 如果選擇此框,則綁定所有列;如果選擇此框,則為所有列綁定。如果不選擇此框,則不會綁定任何列,並且必須在記錄集類中手動綁定它們。

- **型別**

   僅適用於 ODBC 用戶端。 指定記錄集是動態集還是快照,如下表所述。

   |選項|描述|
   |------------|-----------------|
   |**動態集**|指定記錄集是動態集。 動態集是查詢的結果,該查詢向查詢資料庫的數據提供索引視圖。 動態集僅緩存原始數據的整體索引,因此比快照提供性能提升。 索引直接指向查詢結果找到的每個記錄,並指示是否刪除了記錄。 您還可以存取查詢記錄中的更新資訊。|
   |**快照式**|指定記錄集是快照。 快照是查詢的結果,是某個時間點對資料庫的視圖。 查詢結果找到的所有記錄都將被快取,因此您看不到對原始記錄的任何更改。|

## <a name="see-also"></a>另請參閱

[MFC 應用程式精靈](../../mfc/reference/mfc-application-wizard.md)
