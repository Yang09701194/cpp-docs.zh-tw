---
title: "MFC 應用程式精靈、資料庫支援 | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vc.appwiz.mfc.exe.database"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "MFC 應用程式精靈, 資料庫支援"
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
caps.latest.revision: 9
caps.handback.revision: 6
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# MFC 應用程式精靈、資料庫支援
[!INCLUDE[vs2017banner](../../assembler/inline/includes/vs2017banner.md)]

這個頁面提供選項，可允許您為專案指定資料庫支援的層級 \(必要時加上資料來源\)。  
  
 **資料庫支援**  
 設定專案的資料庫支援層級。  
  
|選項|說明|  
|--------|--------|  
|**無**|不提供任何資料庫支援。  這是預設選項。|  
|**只有標頭檔**|為應用程式提供基本層級的資料庫支援。<br /><br /> <ul><li>如果在 \[**用戶端類型**\] 之下選取 \[ODBC\] 支援，則 MFC 應用程式精靈將在專案中包含標頭檔 AFXDB.H。  這樣會加入連結程式庫，但不會建立任何特定資料庫類別。  您可於稍後建立資料錄集，並使用他們來檢查和更新資料錄。</li><li>若您在 \[用戶端類型\] 之下選取 \[OLE DB\] 支援，則會包含下列標頭檔：<br /><br /> <ul><li>ATLBASE.H</li><li>AFXOLEDB.H</li><li>ATLPLUS.H</li></ul></li></ul>|  
|**不提供檔案支援的資料庫檢視**|包括資料庫標頭檔、連結程式庫、資料錄檢視以及資料錄集 \(僅適用於在[應用程式類型](../../mfc/reference/application-type-mfc-application-wizard.md)頁面中選取 \[支援文件\/檢視架構\] 選項的應用程式\)。本選項包括文件支援但不包括序列化 \(Serialization\) 支援。  如果您選擇包含資料庫檢視，則必須指定資料來源。|  
|**提供檔案支援的資料庫檢視**|包括資料庫標頭檔、連結程式庫、資料錄檢視以及資料錄集 \(僅適用於在 \[**應用程式類型**\] 頁面中選取 \[支援文件\/檢視架構\] 選項的應用程式\)。本選項支援文件序列化，例如您可用來更新使用者設定檔。  資料庫應用程式通常以每筆資料錄為操作基準，而非每個檔案，因此不需要序列化。  不過，您可以用特殊的方式來運用序列化。  如果您選擇包含資料庫檢視，則必須指定資料來源。|  
  
> [!NOTE]
>  在 \[資料庫支援\] 之下，如果您選取 \[不提供檔案支援的資料庫檢視\] 或 \[提供檔案支援的資料庫檢視\]，則檢視類別的衍生會依 \[用戶端類型\] 的選擇而有所不同，如下所示：  
  
-   若您在 \[用戶端類型\] 下選取 \[ODBC\]，則應用程式的檢視類別會衍生自 [CRecordView](../../mfc/reference/crecordview-class.md)。  本類別與 [CRecordset](../../mfc/reference/crecordset-class.md) 衍生的類別相關聯，而 MFC 應用程式精靈亦為您建立這種類別。  本選項提供表單架構應用程式，資料錄檢視可透過其資料錄集，用來檢視與更新資料錄。  
  
-   如果您在 \[用戶端類型\] 下選取 \[OLE DB\]，則檢視類別會衍生自 [COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)，並與 [CTable](../../data/oledb/ctable-class.md) 或 [CCommand](../../data/oledb/ccommand-class.md) 衍生的類別相關聯。  
  
 **用戶端類型**  
 指出您的專案使用 OLE DB 或者使用 ODBC 類別。  
  
|選項|說明|  
|--------|--------|  
|**OLE DB**|在本選項已選取時，按一下 \[**資料來源**\] 按鈕叫用 \(Invoke\) \[**資料連結內容**\] 精靈，以協助建立 OLE DB 資料來源的連結。|  
|**ODBC**|在選取本選項時，按一下 \[**資料來源**\] 按鈕叫用 \[選取資料來源\] 精靈，以協助建立 ODBC 資料來源的連結。|  
  
 **Data Source**  
 按一下 \[**資料來源**\] 按鈕可使用指定的驅動程式或提供者和資料庫，來設定資料來源。  如果您在 \[用戶端類型\] 選項中選取 \[OLE DB\]，本按鈕會顯示 \[**資料連結內容**\] 對話方塊。  若您在 \[用戶端類型\] 選項中選取 \[ODBC\]，則本按鈕會提供 \[選取資料來源\] 對話方塊。  本選項僅於選擇在應用程式中包含資料庫檢視時適用。  
  
|選項|說明|  
|--------|--------|  
|**資料連結內容** \(OLE DB\)|使用指定的 OLE DB 提供者，建立特定的資料來源。  您必須指定 OLE DB 提供者、資料的位置、資料來源、登入 ID 以及 \(選擇性\) 密碼。  如需本對話方塊的詳細資訊，請參閱 [ATL OLE DB 消費者精靈](../../atl/reference/atl-ole-db-consumer-wizard.md)中的 \[資料來源\]。|  
|**選取資料來源** \(ODBC\)|使用特定 ODBC 驅動程式，建立指定資料來源。  您必須選取資料來源名稱，以選擇資料來源的資料表。  精靈將資料表中所有資料行，繫結到 `CRecordset` 衍生類別的成員變數。  如需本對話方塊的詳細說明，請參閱 [MFC ODBC 消費者精靈](../../mfc/reference/mfc-odbc-consumer-wizard.md)中的 \[資料來源\]。|  
  
> [!NOTE]
>  在以前的版本中，按下 SHIFT 鍵再按一下 \[**資料來源**\] 按鈕，會開啟 \[開啟舊檔\] 對話方塊，讓您選取資料連結檔 \(.udl\)。  這個功能已不再支援。  
  
 **產生屬性化資料庫類別**  
 僅適用於 OLE DB 用戶端。  指定在產生專案中的資料庫類別是否使用屬性。  
  
 **繫結所有資料行**  
 僅適用於 ODBC 用戶端。  指定是否要繫結選取資料表中的所有資料行。  如果您選取這個方塊，則會繫結所有資料行；如果您不選取這個方塊，則不會繫結任何資料行，而您必須在資料錄集類別中手動繫結它們。  
  
 **型別**  
 僅適用於 ODBC 用戶端。  指定資料錄集是動態集 \(Dynaset\) 或快照集 \(Snapshot\)，如下表所述。  
  
|選項|說明|  
|--------|--------|  
|**動態集**|指定資料錄集是動態集。  動態集是查詢的結果，提供查詢資料庫資料的索引檢視表。  動態集只快取原始資料的整數索引，因此在效能上比快照集有利。  索引會直接指向查詢結果找到的每個資料錄，並指出資料錄是否已移除，  您也可存取查詢資料錄中的更新資訊。|  
|快照集|指定資料錄集是快照集。  快照集是查詢的結果，提供在某個時間點上資料庫的檢視表。  查詢結果找到的所有資料錄都是快取的，因此您不會看到原始資料錄的任何變更。|  
  
## 請參閱  
 [MFC 應用程式精靈](../../mfc/reference/mfc-application-wizard.md)