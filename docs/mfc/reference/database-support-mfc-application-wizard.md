---
title: MFC 應用程式精靈、資料庫支援
ms.date: 11/04/2016
f1_keywords:
- vc.appwiz.mfc.exe.database
helpviewer_keywords:
- MFC Application Wizard, database support
ms.assetid: 9ddf4558-fd41-4ac7-8d9b-c93d9c68ab59
ms.openlocfilehash: 9635b7e045812cc90c5d6e9662b8475e411a0b48
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/31/2018
ms.locfileid: "50654203"
---
# <a name="database-support-mfc-application-wizard"></a>MFC 應用程式精靈、資料庫支援

此頁面提供可讓您指定的資料庫層級的選項為您的專案支援 （再加上資料來源，如有必要）。

- **資料庫支援**

   設定您專案的資料庫支援的層級。

   |選項|描述|
   |------------|-----------------|
   |**無**|不會提供資料庫支援。 這是預設選項。|
   |**僅限標頭檔**|提供您的應用程式的資料庫支援基本的層級。 如果您選取 ODBC 支援底下**用戶端類型**，包含專案中的標頭檔 AFXDB 的 MFC 應用程式精靈。H. 它會新增連結程式庫，但它不會建立任何資料庫特有類別。 您可以稍後再建立資料錄集，並使用它們來檢查和更新記錄。 如果您選取 OLE DB 支援底下**用戶端類型**，會包含下列標頭檔： ATLBASE。H AFXOLEDB。H ATLPLUS。H|
   |**不附檔案支援的資料庫檢視**|包含資料庫標頭檔、 連結程式庫、 資料錄檢視和資料錄集。 (僅適用於應用程式**文件/檢視架構支援**中選取選項[應用程式類型](../../mfc/reference/application-type-mfc-application-wizard.md)頁面。)這個選項會包含文件支援，但沒有序列化支援。 如果您選擇要包含的資料庫檢視，您必須指定資料的來源。|
   |**附檔案支援的資料庫檢視**|包含資料庫標頭檔、 連結程式庫、 資料錄檢視和資料錄集。 (僅適用於應用程式**文件/檢視架構支援**中選取選項**應用程式類型**頁面。)此選項支援文件序列化，您可以使用，例如，若要更新的使用者設定檔。 資料庫應用程式通常會對各個記錄而不是每個檔案為基礎，因此不需要序列化。 不過，您可能必須序列化的特殊用途。 如果您選擇要包含的資料庫檢視，您必須指定資料的來源。|

   > [!NOTE]
   > 底下**資料庫支援**，如果您選取其中一個**資料庫檢視不附檔案支援**或**資料庫檢視附檔案支援**，檢視類別的衍生不同，取決於在您**用戶端類型**選取項目，如下所示：

   - 如果您選取**ODBC**下方**用戶端型別**，則應用程式的檢視類別衍生自[CRecordView](../../mfc/reference/crecordview-class.md)。 此類別相關聯[CRecordset](../../mfc/reference/crecordset-class.md)-衍生的類別，MFC 應用程式精靈也會為您建立。 此選項可讓您以 form 為基礎的應用程式中的資料錄檢視用來檢視及更新透過其資料錄集的記錄。

   - 如果您選取**OLE DB**下方**用戶端型別**，然後檢視類別衍生自[COleDBRecordView](../../mfc/reference/coledbrecordview-class.md)，和其相關聯[CTable](../../data/oledb/ctable-class.md)或是[CCommand](../../data/oledb/ccommand-class.md)-衍生的類別。

- **用戶端類型**

   指出專案是否使用 OLE DB 或 ODBC 類別。

   |選項|描述|
   |------------|-----------------|
   |**OLE DB**|選取此選項時，按一下**資料來源** 按鈕會叫用**資料連結屬性**精靈來協助您建立的 OLE DB 資料來源的連接。|
   |**ODBC**|選取此選項時，按一下**資料來源** 按鈕會叫用**選取資料來源**精靈來協助您建立 ODBC 資料來源的連接。|

- **資料來源**

   按一下 [**資料來源**設為使用指定的驅動程式或提供者和資料庫的資料來源] 按鈕。 如果您選取中的 OLE DB**用戶端型別**選項時，此按鈕會顯示**資料連結屬性** 對話方塊。 如果您選取中的 ODBC**用戶端型別**選項，此按鈕可**選取資料來源** 對話方塊。 只有當您選擇要包含在您的應用程式中的資料庫檢視時，才使用此選項。

   |選項|描述|
   |------------|-----------------|
   |**資料連結屬性**(OLE DB)|建立使用指定的 OLE DB 提供者的指定的資料來源。 您必須指定 OLE DB 提供者、 資料、 資料來源、 登入識別碼和 （選擇性） 密碼的位置。 如需此對話方塊的詳細資訊，請參閱**資料來源**中[ATL OLE DB 消費者精靈](../../atl/reference/atl-ole-db-consumer-wizard.md)。|
   |**選取資料來源**(ODBC)|建立指定的資料來源，使用指定的 ODBC 驅動程式。 您必須選取來選擇資料來源資料表的資料來源名稱。 精靈將資料表的所有資料行繫結至的成員變數`CRecordset`-衍生的類別。 如需此對話方塊的詳細資訊，請參閱**資料來源**中[MFC ODBC 消費者精靈](../../mfc/reference/mfc-odbc-consumer-wizard.md)。|

   > [!NOTE]
   > 在舊版中，Shift 鍵按一下**資料來源**按鈕開啟 開啟舊檔的對話方塊，讓您選取的資料連結 (.udl) 檔案。 不再支援這項功能。

- **產生使用屬性的資料庫類別**

   適用於 OLE DB 用戶端。 指定是否在產生的專案中的資料庫類別使用的屬性。

- **所有的資料行繫結**

   適用於 ODBC 用戶端。 指定選取的資料表中的所有資料行是否會繫結。 如果您選取此方塊時，會繫結所有資料行;如果您未選取此方塊，沒有資料行繫結，以及您必須將其繫結以手動方式在資料錄集類別中。

- **Type**

   適用於 ODBC 用戶端。 指定資料錄集是動態集或快照集下, 表中所述。

   |選項|描述|
   |------------|-----------------|
   |**動態集**|指定資料錄集是動態集。 動態集是可查詢的資料庫資料的索引檢視表查詢的結果。 動態集快取的整數索引的原始資料，並因此提供了一效能中取得快照集。 直接到每一筆記錄的索引點找到為查詢的結果，並指出是否要移除記錄。 您也會有查詢記錄中的更新資訊的存取權。|
   |**快照集**|指定資料錄集是快照集。 快照是查詢的結果，而且時間是在某個時間點的資料庫的檢視。 快取查詢結果所發現的所有記錄，因此您不會看到原始記錄的任何變更。|

## <a name="see-also"></a>另請參閱

[MFC 應用程式精靈](../../mfc/reference/mfc-application-wizard.md)
