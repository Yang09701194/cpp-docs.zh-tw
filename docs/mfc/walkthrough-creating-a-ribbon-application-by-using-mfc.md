---
title: 逐步解說：使用 MFC 建立功能區應用程式
ms.date: 11/04/2016
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: a74e8863c32199d1c0309f70bceae867993ce721
ms.sourcegitcommit: c3093251193944840e3d0a068ecc30e6449624ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/04/2019
ms.locfileid: "57271329"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>逐步解說：使用 MFC 建立功能區應用程式

本逐步解說示範如何使用**MFC 應用程式精靈**建立預設具有功能區的應用程式。 您接著可以藉由新增擴充功能區**自訂**功能區分類**我的最愛**功能區面板]，然後再新增 [一些常用命令的面板。

## <a name="prerequisites"></a>必要條件

本逐步解說假設您已設定要使用的 Visual Studio**一般開發設定**。 如果您使用不同的設定，某些下列指示中所參考的使用者介面 (UI) 項目可能不會顯示。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>若要建立具有功能區的 MFC 應用程式

1. 使用**MFC 應用程式精靈**建立具有功能區的 MFC 應用程式。 若要在執行精靈時，**檔案**功能表上，指向**新增**，然後按一下**專案**。

1. 在**新的專案**對話方塊方塊中，展開**Visual c + +** 節點下的**已安裝的範本**，選取**MFC**，然後選取  **MFC 應用程式**。 輸入專案名稱，例如*MFCRibbonApp*，然後按一下**確定**。

1. 在 設定下列選項**MFC 應用程式精靈**:

    1. 在 **應用程式類型**下方區段**視覺化樣式和色彩**，選取**Office 2007 （藍色佈景主題）**。

    1. 在 **複合文件支援**區段中，請確定**無**已選取。

    1. 在 **文件範本屬性**區段中**副檔名**方塊中，輸入此應用程式所建立文件，例如，副檔名*mfcrbnapp*.

    1. 在 **資料庫支援**區段中，請確定**無**已選取。

    1. 在 **使用者介面功能**區段中，請確定**使用功能區**已選取。

    1. 根據預設， **MFC 應用程式精靈**新增幾個停駐窗格的支援。 由於這個逐步解說只示範功能區，因此您可以從應用程式移除這些選項。 在 **進階功能**區段中，清除所有選項。

1. 按一下 **完成**建立 MFC 應用程式。

1. 建置並執行該應用程式，以確認應用程式建立成功。 若要在建置應用程式時，**建置**功能表上，按一下**建置方案**。 如果應用程式建置成功，會將它執行，即可**開始偵錯**上**偵錯**功能表。

    精靈會自動建立一個功能區，有一個名為的功能區分類**首頁**。 這個功能區包含三個功能區面板，名為**剪貼簿**，**檢視**，並**視窗**。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>若要將分類和面板加入至功能區

1. 若要開啟精靈所建立，在功能區資源**檢視**功能表上，指向**其他 Windows** ，然後按一下 **資源檢視**。 在 **資源檢視**，按一下**功能區**，然後按兩下**IDR_RIBBON**。

1. 首先，將自訂類別加入功能區按兩下**分類**中**工具箱**。

    標題的分類**Category1**建立。 根據預設，該分類包含一個面板。

    以滑鼠右鍵按一下**Category1** ，然後按一下**屬性**。 在 **屬性**視窗中，變更**標題**來*自訂*。

    **Large Images**並**Small Images**屬性會指定可做為功能區項目，此類別中的圖示的點陣圖。 由於建立自訂點陣圖並不在本逐步解說的討論範圍內，因此請重複使用精靈所建立的點陣圖。 小型點陣圖是 16 像素 x 16 像素。 使用小影像，即可存取的點陣圖`IDB_FILESMALL`資源識別碼。 大型點陣圖是 32 像素 x 32 像素。 針對大型映像，使用所存取的點陣圖`IDB_FILELARGE`資源識別碼。

    > [!NOTE]
    > 在 HDPI (高像素密度) 顯示器上，就會自動使用影像的 HDPI 版本。

1. 接下來，要自訂面板。 面板是用來將彼此邏輯相關的項目群組在一起。 例如，在**首頁**這個應用程式 索引標籤**剪下**，**複製**，並**貼上**命令都位於上**剪貼簿**面板。 若要自訂 [面板] 中，以滑鼠右鍵按一下**Panel1** ，然後按一下**屬性**。 在 **屬性**視窗中，變更**標題**來*我的最愛*。

    您可以指定**映像索引**面板。 此數字會指定如果功能區面板加入至顯示的圖示**快速存取工具列**。 圖示不會顯示在 功能區面板本身。

1. 若要確認是否已成功建立功能區分類和面板，請預覽功能區控制項。 在 [ **Ribbon 編輯器工具列**，按一下**測試 Ribbon** ] 按鈕。 A**自訂**索引標籤並**我的最愛**面板應該會顯示在功能區上。

### <a name="to-add-elements-to-the-ribbon-panels"></a>若要將項目加入至功能區面板

1. 若要加入您在上一個程序中建立的面板中的項目，將控制項從**Ribbon 編輯器**一節**工具箱**以 [設計] 檢視中的面板。

1. 首先，新增**列印** 按鈕。 **列印** 按鈕會有包含一個子功能表**快速列印**使用預設的印表機進行列印的命令。 已為這個應用程式定義了這兩個命令， 它們位於應用程式 功能表。

    若要建立**列印**按鈕，將按鈕工具拖曳至面板。

    在 **屬性**視窗中，變更**識別碼**屬性設**ID_FILE_PRINT**，這應該已定義。 變更**Caption**要*列印*。 變更**映像索引**要*4*。

    若要建立**快速列印**按鈕，再按一下 屬性值 欄位旁**功能表項目**，然後按一下省略符號 (**...**).在 **項目編輯器**，按一下未標記**新增**按鈕，以建立功能表項目。 在 **屬性**視窗中，變更**標題**來*快速列印*，**識別碼**到*ID_FILE_PRINT_DIRECT*，並**映像**要*5*。 影像屬性會指定**快速列印**中的圖示`IDB_FILESMALL`點陣圖資源。

1. 若要確認按鈕已加入至功能區面板，請建置並執行應用程式。 若要在建置應用程式時，**建置**功能表上，按一下**建置方案**。 如果應用程式建置成功，請按一下 執行應用程式**開始偵錯**上**偵錯**功能表。 **列印** 按鈕和下拉式方塊**我的最愛** 面板上**自訂**應該顯示 功能區上的索引標籤。

## <a name="next-steps"></a>後續步驟

[如何：自訂快速存取工具列](../mfc/how-to-customize-the-quick-access-toolbar.md)

[如何：自訂的應用程式按鈕](../mfc/how-to-customize-the-application-button.md)

如需端對端範例，請參閱[範例 （MFC 功能套件）](../visual-cpp-samples.md)。

## <a name="see-also"></a>另請參閱

[逐步解說](../mfc/walkthroughs-mfc.md)<br/>
[範例 （MFC 功能套件）](../visual-cpp-samples.md)
