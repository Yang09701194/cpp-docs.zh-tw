---
title: 逐步解說： 使用 MFC 建立功能區應用程式 |Microsoft 文件
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon aplication (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7f715830c110f03811202d2e98dc097bfe712208
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>逐步解說：使用 MFC 建立功能區應用程式
本逐步解說示範如何使用**MFC 應用程式精靈**建立預設具有功能區的應用程式。 接著，您可以展開功能區加入**自訂**具有功能區分類**我的最愛**功能區面板，然後將加入一些常用命令至面板。  
  
## <a name="prerequisites"></a>必要條件  
 本逐步解說假設您已設定[!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)]使用**一般開發設定**。 如果您使用不同的設定，在下列指示中所參考的某些使用者介面 (UI) 項目可能不會顯示出來。 如需如何變更設定，請參閱[如何： 重設您的設定](http://msdn.microsoft.com/en-us/c95c51be-e609-4769-abba-65e6beedec76)。  
  
### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>若要建立具有功能區的 MFC 應用程式  
  
1.  使用**MFC 應用程式精靈**建立具有功能區的 MFC 應用程式。 若要在執行精靈時，**檔案**功能表上，指向**新增**，然後按一下 **專案**。  
  
2.  在**新專案**對話方塊方塊中，展開  **Visual c + +** 節點下的**已安裝的範本**，選取**MFC**，然後選取  **MFC 應用程式**。 例如，輸入專案的名稱`MFCRibbonApp`，然後按一下 **確定**。  
  
3.  第一頁上**MFC 應用程式精靈**，按一下 **下一步**。  
  
4.  在**應用程式類型**頁面的 **視覺化樣式和色彩**，選取**Office 2007 （藍色主題）**。 保持其他設定不變。 按 [ **下一步**]。  
  
5.  在**複合文件支援**頁面上，請確定**無**已選取，然後按一下 **下一步**。  
  
6.  在**文件範本屬性**頁面上，於**副檔名**方塊中，輸入檔案的副檔名，例如此應用程式建立的文件`mfcrbnapp`。 按 [ **下一步**]。  
  
7.  在**資料庫支援**頁面上，請確定**無**已選取，然後按一下 **下一步**。  
  
8.  在**使用者介面功能**頁面上，請確定**使用功能區**已選取。 按 [ **下一步**]。  
  
9. 根據預設， **MFC 應用程式精靈**加入數個停駐窗格的支援。 由於這個逐步解說只示範功能區，因此您可以從應用程式移除這些選項。 在**進階功能**頁面上，清除所有選項。 按 [ **下一步**]。  
  
10. 在**產生的類別**頁面上，按一下**完成**建立 MFC 應用程式。  
  
11. 建置並執行該應用程式，以確認應用程式建立成功。 在建置應用程式，**建置**功能表上，按一下 **建置方案**。 如果應用程式建置成功，執行按一下**開始偵錯**上**偵錯**功能表。  
  
     精靈會自動建立具有一個名為功能區類別的功能區**首頁**。 這個功能區包含三個功能區面板，名為**剪貼簿**，**檢視**，和**視窗**。  
  
### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>若要將分類和面板加入至功能區  
  
1.  若要開啟精靈所建立，在功能區資源**檢視**功能表上，指向**其他視窗**，然後按一下 **資源檢視**。 在**資源檢視**，按一下 **功能區**，然後按兩下  **IDR_RIBBON**。  
  
2.  首先，加入按兩下功能區自訂分類**類別**中**工具箱**。  
  
     分類標題**Category1**建立。 根據預設，該分類包含一個面板。  
  
     以滑鼠右鍵按一下**Category1** ，然後按一下 **屬性**。 在**屬性**視窗中，變更**標題**至`Custom`。  
  
     **大型影像**和**Small Images**屬性會指定做為此類別中的功能區項目圖示的點陣圖。 由於建立自訂點陣圖並不在本逐步解說的討論範圍內，因此請重複使用精靈所建立的點陣圖。 小型點陣圖是 16 像素 x 16 像素。 若為小型影像，請使用由 IDB_FILESMALL 資源 ID 所存取的點陣圖。 大型點陣圖是 32 像素 x 32 像素。 若為大型影像，請使用由 IDB_FILELARGE 資源 ID 所存取的點陣圖。  
  
    > [!NOTE]
    >  在 HDPI (高像素密度) 顯示器上，就會自動使用影像的 HDPI 版本。  
  
3.  接下來，要自訂面板。 面板是用來將彼此邏輯相關的項目群組在一起。 例如，在**首頁** 索引標籤的這個應用程式，**剪下**，**複製**，和**貼上**命令都位於**剪貼簿**面板。 若要自訂面板，請以滑鼠右鍵按一下**Panel1** ，然後按一下 **屬性**。 在**屬性**視窗中，變更**標題**至`Favorites`。  
  
     您可以指定**映像索引**面板。 此數字會指定如果在功能區面板加入至顯示的圖示**快速存取工具列**。 圖示不會顯示在功能區面板本身。  
  
4.  若要確認是否已成功建立功能區分類和面板，請預覽功能區控制項。 在**Ribbon 編輯器工具列**，按一下 [**測試 Ribbon** ] 按鈕。 A**自訂** 索引標籤和**我的最愛**面板應該出現在功能區上。  
  
### <a name="to-add-elements-to-the-ribbon-panels"></a>若要將項目加入至功能區面板  
  
1.  若要將項目加入至您在上一個程序中建立的面板，將控制項從**Ribbon 編輯器**區段**工具箱**至 [設計] 檢視中的面板。  
  
2.  首先，新增**列印** 按鈕。 **列印**按鈕會有子功能表，其中包含**快速列印**命令使用預設印表機進行列印。 已為這個應用程式定義了這兩個命令， 它們位於應用程式功能表上。  
  
     若要建立**列印**按鈕，將按鈕工具拖曳到 [面板]。  
  
     在**屬性**視窗中，變更**識別碼**屬性**ID_FILE_PRINT**，它應該已定義。 變更**標題**至`Print`。 變更**映像索引**至`4`。  
  
     若要建立**快速列印**按鈕，再按一下屬性值資料行旁邊**功能表項目**，然後按一下省略符號 (**...**).在**項目編輯器**，按一下加上標籤**新增**按鈕以建立功能表項目。 在**屬性**視窗中，變更**標題**至`Quick Print`，**識別碼**至`ID_FILE_PRINT_DIRECT`，和**映像**至`5`. 該影像屬性會指定 IDB_FILESMALL 點陣圖資源中的快速列印圖示。  
  
3.  若要確認按鈕已加入至功能區面板，請建置並執行應用程式。 在建置應用程式，**建置**功能表上，按一下 **建置方案**。 如果應用程式建置成功，則執行應用程式，即可**開始偵錯**上**偵錯**功能表。 **列印**按鈕和下拉式方塊上**我的最愛**面板**自訂**應該顯示在功能區上的索引標籤。  
  
## <a name="next-steps"></a>後續步驟  
 [如何：自訂快速存取工具列](../mfc/how-to-customize-the-quick-access-toolbar.md)  
  
 [如何：自訂應用程式按鈕](../mfc/how-to-customize-the-application-button.md)  
  
 如需端對端範例，請參閱[範例 （MFC 功能套件）](../visual-cpp-samples.md)。  
  
## <a name="see-also"></a>另請參閱  
 [逐步解說](../mfc/walkthroughs-mfc.md)   
 [範例 （MFC 功能套件）](../visual-cpp-samples.md)

