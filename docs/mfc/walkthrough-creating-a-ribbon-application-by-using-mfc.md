---
title: "逐步解說：使用 MFC 建立功能區應用程式 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - "建立功能區應用程式 (MFC)"
  - "功能區應用程式, 建立 (MFC)"
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
caps.latest.revision: 21
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
caps.handback.revision: 17
---
# 逐步解說：使用 MFC 建立功能區應用程式
[!INCLUDE[vs2017banner](../assembler/inline/includes/vs2017banner.md)]

本逐步解說示範如何使用 \[**MFC 應用程式精靈**\] 來建立預設具有功能區的應用程式。  接著可以加入具有 \[**Favorites**\] 功能區面板的 \[**Custom**\] 功能區分類，並在該面板中加入一些常用命令以擴充功能區。  
  
## 必要條件  
 這個逐步解說是假設您已設定 [!INCLUDE[vsprvs](../assembler/masm/includes/vsprvs_md.md)] 使用 \[**一般開發設定**\]。  如果您使用不同的設定，在下列指示中所參考的某些使用者介面 \(UI\) 項目可能不會顯示出來。  如需如何變更設定的詳細資訊，請參閱[How to: Reset Your Settings](http://msdn.microsoft.com/zh-tw/c95c51be-e609-4769-abba-65e6beedec76)。  
  
### 若要建立具有功能區的 MFC 應用程式  
  
1.  使用 \[**MFC 應用程式精靈**\] 建立具有功能區的 MFC 應用程式。  要執行精靈，先在 \[**檔案**\] 功能表上，指向 \[**新增**\]，然後按一下 \[**專案**\]。  
  
2.  在 \[**新增專案**\] 對話方塊中，展開 \[**已安裝的範本**\] 底下的 \[ **Visual C\+\+**\] 節點，選取 \[**MFC**\]，然後選取 \[**MFC 應用程式**\]。  輸入專案名稱，例如，`MFCRibbonApp`，然後按一下 \[**確定**\]。  
  
3.  在 \[**MFC 應用程式精靈**\] 的第一個頁面上，按 \[**下一步**\]。  
  
4.  在 \[**應用程式類型**\] 頁面上，在 \[**視覺化樣式和色彩**\] 底下，選取 \[**Office 2007 \(藍色主題\)**\]。  保持其他設定不變。  按 \[**下一步**\]。  
  
5.  在 \[**複合文件支援**\] 頁面上，確定已選取 \[**無**\]，然後按一下 \[**下一步**\]。  
  
6.  在 \[**文件範本屬性**\] 頁面上，在 \[**副檔名**\] 方塊中，輸入這個應用程式所建立的文件的副檔名，例如，`mfcrbnapp`。  按 \[**下一步**\]。  
  
7.  在 \[**資料庫支援**\] 頁面上，確定已選取 \[**無**\]，然後按一下 \[**下一步**\]。  
  
8.  在 \[**使用者介面功能**\] 頁面上，確定已選取 \[**使用功能區**\]。  按 \[**下一步**\]。  
  
9. 根據預設，\[**MFC 應用程式精靈**\] 會加入對數個停駐窗格的支援。  由於這個逐步解說只示範功能區，因此您可以從應用程式移除這些選項。  在 \[**進階功能**\] 頁面中，清除所有選項。  按 \[**下一步**\]。  
  
10. 在 \[**產生的類別**\] 頁面上，按一下 \[**完成**\] 即可建立 MFC 應用程式。  
  
11. 建置並執行該應用程式，以確認應用程式建立成功。  若要建置應用程式，請按一下 \[**建置**\] 功能表上的 \[**建置方案**\]。  如果應用程式建置成功，請按一下 \[**偵錯**\] 功能表上的 \[**開始偵錯**\] 以執行它。  
  
     精靈會自動建立功能區，功能區中含有一個名為 \[**首頁**\] 的功能區分類。  這個功能區包含三個功能區面板，名為 \[**剪貼簿**\]、\[**檢視**\] 和 \[**視窗**\]。  
  
### 若要將分類和面板加入至功能區  
  
1.  在 \[**檢視**\] 功能表上，指向 \[**其他視窗**\]，然後按一下 \[**資源檢視**\]，以開啟精靈所建立的功能區資源。  在 \[**資源檢視**\] 中，按一下 \[**功能區**\]，然後按兩下 \[**IDR\_RIBBON**\]。  
  
2.  首先，藉由按兩下 \[**工具箱**\] 中的 \[**分類**\]，將自訂分類加入至功能區。  
  
     隨即建立一個標題為 \[**Category1**\] 的分類。  根據預設，該分類包含一個面板。  
  
     以滑鼠右鍵按一下 \[**Category1**\]，然後按一下 \[**屬性**\]。  在 \[**屬性**\] 視窗中，將 \[**標題**\] 變更為 `Custom`。  
  
     \[**大型影像**\] 和 \[**小型影像**\] 屬性會指定要做為此分類中之功能區項目圖示的點陣圖。  由於建立自訂點陣圖並不在本逐步解說的討論範圍內，因此請重複使用精靈所建立的點陣圖。  小型點陣圖是 16 像素 x 16 像素。  若為小型影像，請使用由 IDB\_FILESMALL 資源 ID 所存取的點陣圖。  大型點陣圖是 32 像素 x 32 像素。  若為大型影像，請使用由 IDB\_FILELARGE 資源 ID 所存取的點陣圖。  
  
    > [!NOTE]
    >  在 HDPI \(高像素密度\) 顯示器上，就會自動使用影像的 HDPI 版本。  
  
3.  接下來，要自訂面板。  面板是用來將彼此邏輯相關的項目群組在一起。  例如，在這個應用程式的 \[**首頁**\] 索引標籤上，\[**剪下**\]、\[**複製**\] 和 \[**貼上**\] 命令都位於 \[**剪貼簿**\] 面板。  若要自訂面板，以滑鼠右鍵按一下 \[**Panel1**\]，然後按一下 \[**屬性**\]。  在 \[**屬性**\] 視窗中，將 \[**標題**\] 變更為 `Favorites`。  
  
     您可以指定面板的 \[**影像索引**\]。  這個數字會指定當功能區面板加入至 \[**快速存取工具列**\] 時所顯示的圖示。  圖示不會顯示在功能區面板本身。  
  
4.  若要確認是否已成功建立功能區分類和面板，請預覽功能區控制項。  在 \[**Ribbon 編輯器**\] 工具列中，按一下 \[**測試 Ribbon**\] 按鈕。  功能區上應該會顯示 \[**Custom**\] 索引標籤和 \[**Favorites**\] 面板。  
  
### 若要將項目加入至功能區面板  
  
1.  若要將項目加入至您在先前程序中所建立的面板，請在設計檢視中將 \[**工具箱**\] 的 \[**Ribbon 編輯器**\] 區段中的控制項拖曳到面板。  
  
2.  首先，加入 \[**列印**\] 按鈕。  \[**列印**\] 按鈕會有一個子功能表，其中包含可使用預設印表機進行列印的 \[**快速列印**\] 命令。  已為這個應用程式定義了這兩個命令，  它們位於應用程式功能表上。  
  
     若要建立 \[**列印**\] 按鈕，請將按鈕工具拖曳至面板。  
  
     在 \[**屬性**\] 視窗中，將 \[**ID**\] 屬性變更為 \[**ID\_FILE\_PRINT**\] \(應該已定義\)。  將 \[**標題**\] 變更為 `Print`。  將 \[**影像索引**\] 變更為 `4`。  
  
     若要建立 \[**快速列印**\] 按鈕，按一下 \[**功能表項目**\] 旁邊的屬性值資料行，然後按一下省略符號 \(**...**\)。  在 \[**項目編輯器**\] 中，按一下未標記的 \[**加入**\] 按鈕以建立功能表項目。  在 \[**屬性**\] 視窗中，將 \[**標題**\] 變更為 `Quick Print`，將 \[**ID**\] 變更為 `ID_FILE_PRINT_DIRECT`，以及將 \[**影像**\] 變更為 `5`。  該影像屬性會指定 IDB\_FILESMALL 點陣圖資源中的快速列印圖示。  
  
3.  若要確認按鈕已加入至功能區面板，請建置並執行應用程式。  若要建置應用程式，請按一下 \[**建置**\] 功能表上的 \[**建置方案**\]。  如果應用程式建置成功，請按一下 \[**偵錯**\] 功能表上的 \[**開始偵錯**\] 執行應用程式。  功能區的 \[**Custom**\] 索引標籤上的 \[**Favorites**\] 面板中應該會顯示 \[**列印**\] 按鈕和下拉式方塊。  
  
## 後續步驟  
 [如何：自訂快速存取工具列](../mfc/how-to-customize-the-quick-access-toolbar.md)  
  
 [如何：自訂應用程式按鈕](../mfc/how-to-customize-the-application-button.md)  
  
 如需端對端範例，請參閱[範例 \(MFC 功能套件\)](../top/visual-cpp-samples.md)。  
  
## 請參閱  
 [逐步解說](../mfc/walkthroughs-mfc.md)   
 [範例 \(MFC 功能套件\)](../top/visual-cpp-samples.md)