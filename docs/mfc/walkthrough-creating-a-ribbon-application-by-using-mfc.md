---
title: 逐步解說：使用 MFC 建立功能區應用程式
ms.date: 09/09/2019
helpviewer_keywords:
- ribbon application, creating (MFC)
- creating a ribbon application (MFC)
ms.assetid: e61393e2-1d6b-4594-a7ce-157d3d1b0d9f
ms.openlocfilehash: 0f81b27d479b15864302b21a467bff9489ba465a
ms.sourcegitcommit: b8c22e6d555cf833510753cba7a368d57e5886db
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/29/2020
ms.locfileid: "76821918"
---
# <a name="walkthrough-creating-a-ribbon-application-by-using-mfc"></a>逐步解說：使用 MFC 建立功能區應用程式

本逐步解說會示範如何使用**MFC 應用程式精靈**來建立預設具有功能區的應用程式。 接著，您可以新增具有 [我的最愛 **]** 功能區面板的**自訂**功能區類別，然後將一些常用的命令新增至面板，以展開功能區。

## <a name="prerequisites"></a>必要條件：

本逐步解說假設您已將 Visual Studio 設定為使用 **[一般開發設定**]。 如果您使用不同的設定，則可能不會顯示下列指示中所參考的某些使用者介面（UI）元素。

### <a name="to-create-an-mfc-application-that-has-a-ribbon"></a>若要建立具有功能區的 MFC 應用程式

1. 使用**Mfc 應用程式精靈**來建立具有功能區的 mfc 應用程式。 如需如何為您的 Visual Studio 版本開啟嚮導的指示，請參閱[逐步解說：使用新的 MFC Shell 控制項](walkthrough-using-the-new-mfc-shell-controls.md)。

1. 在 [ **MFC 應用程式精靈]** 中設定下列選項：

    1. 在 [**應用程式類型**] 區段的 [**視覺化樣式和色彩**] 底下，選取 **[Office 2007 （藍色主題）** ]。

    1. 在 [**複合檔案支援**] 區段中，確認已選取 [**無**]。

    1. 在 [檔**範本屬性**] 區段的 [**副檔名**] 方塊中，輸入此應用程式所建立之檔的副檔名，例如*mfcrbnapp*。

    1. 在 [**資料庫支援**] 區段中（僅限 Visual Studio 2015），請確定已選取 [**無**]。

    1. 在 [**使用者介面功能**] 區段中，確認已選取 [**使用功能區**]。

    1. 根據預設， **MFC 應用程式精靈**會新增數個停駐窗格的支援。 由於這個逐步解說只示範功能區，因此您可以從應用程式移除這些選項。 在 [ **Advanced Features** ] 區段中，清除所有選項。

1. 按一下 **[完成]** 以建立 MFC 應用程式。

1. 建置並執行該應用程式，以確認應用程式建立成功。 若要建立應用程式，請在 [**建立**] 功能表上，按一下 [**建立方案**]。 如果成功建立應用程式，請按一下 [**調試**程式] 功能表上的 [**開始調試**] 來執行。

    Wizard 會自動建立一個功能區，其中具有一個名為**Home**的功能區分類。 這個功能區包含三個功能區面板，名為 [**剪貼**簿]、[ **View**] 和 [ **Window]** 。

### <a name="to-add-a-category-and-panel-to-the-ribbon"></a>若要將分類和面板加入至功能區

1. 若要開啟嚮導建立的功能區資源，請在 [ **View** ] 功能表上，指向 [**其他視窗**]，然後按一下 [**資源檢視**]。 在**資源檢視**中，按一下 [**功能區**]，然後按兩下 [ **IDR_RIBBON**]。

1. 首先，在 [**工具箱**] 中按兩下 [**類別**]，將自訂類別加入至功能區。

    已建立標題為**Category1**的分類。 根據預設，該分類包含一個面板。

    以滑鼠右鍵按一下 [ **Category1** ]，然後按一下 [**屬性**]。 在 [**屬性**] 視窗中，將**標題**變更為 [*自訂*]。

    [**大型影像**] 和 [**小型影像**] 屬性會指定用來做為此類別中功能區元素圖示的點陣圖。 由於建立自訂點陣圖並不在本逐步解說的討論範圍內，因此請重複使用精靈所建立的點陣圖。 小型點陣圖是 16 像素 x 16 像素。 針對小型影像，請使用 `IDB_FILESMALL` 資源識別碼所存取的點陣圖。 大型點陣圖是 32 像素 x 32 像素。 若為大型影像，請使用 `IDB_FILELARGE` 資源識別碼所存取的點陣圖。

    > [!NOTE]
    > 在 HDPI (高像素密度) 顯示器上，就會自動使用影像的 HDPI 版本。

1. 接下來，要自訂面板。 面板是用來將彼此邏輯相關的項目群組在一起。 例如，在此應用程式的 [**首頁**] 索引標籤上，**剪**下、**複製**和**貼**上命令全都位於 [**剪貼**簿] 面板上。 若要自訂面板，請以滑鼠右鍵按一下 [ **Panel1** ]，然後按一下 [**屬性**]。 在 [**屬性**] 視窗中，將**標題**變更為*我的最愛。*

    您可以指定面板的**影像索引**。 這個數位會指定當功能區面板加入至**快速存取工具列**時所顯示的圖示。 圖示不會顯示在功能區面板本身。

1. 若要確認是否已成功建立功能區分類和面板，請預覽功能區控制項。 在 [**功能區編輯器] 工具列**上，按一下 [**測試] 功能區**按鈕。 功能區上應該會顯示**自訂**索引標籤和 [我的最**愛] 面板**。

### <a name="to-add-elements-to-the-ribbon-panels"></a>若要將項目加入至功能區面板

1. 若要將專案加入至您在上一個程式中建立的面板，請將控制項從 [**工具箱**] 的 [**功能區編輯器**] 區段拖曳到設計檢視中的面板。

1. 首先，新增 [**列印**] 按鈕。 [**列印**] 按鈕會有一個子功能表，其中包含使用預設印表機列印的 [**快速列印**] 命令。 已為這個應用程式定義了這兩個命令， 它們位於 [應用程式] 功能表上。

    若要建立 [**列印**] 按鈕，請將按鈕工具拖曳至面板。

    在 [**屬性**] 視窗中，將 [**識別碼**] 屬性變更為**ID_FILE_PRINT**，這應該已經定義。 將**標題**變更為 [*列印*]。 將 [**影像索引**] 變更為*4*。

    若要建立 [**快速列印**] 按鈕，請按一下 [**功能表項目**] 旁的 [屬性值] 資料行，然後按一下省略號（ **...** ）。在 [**專案編輯器**] 中，按一下未標記的 [**新增**] 按鈕，以建立功能表項目。 在 **屬性** 視窗中，將 **標題** 變更為 *快速列印*、**識別碼** 設為  *ID_FILE_PRINT_DIRECT*，*並將***影像** Image 屬性會指定 `IDB_FILESMALL` bitmap 資源中的**快速列印**圖示。

1. 若要確認按鈕已加入至功能區面板，請建置並執行應用程式。 若要建立應用程式，請在 [**建立**] 功能表上，按一下 [**建立方案**]。 如果成功建立應用程式，請按一下 [**調試**程式] 功能表上的 [**啟動調試**程式] 來執行應用程式。 應該會顯示功能區上 [**自訂**] 索引標籤上 [**我的最愛] 面板上**的 [**列印**] 按鈕和下拉式方塊。

## <a name="next-steps"></a>後續步驟

[如何：自訂快速存取工具列](../mfc/how-to-customize-the-quick-access-toolbar.md)

[如何：自訂應用程式按鈕](../mfc/how-to-customize-the-application-button.md)

如需端對端範例，請參閱[範例（MFC 功能套件）](../overview/visual-cpp-samples.md)。

## <a name="see-also"></a>請參閱

[逐步解說](../mfc/walkthroughs-mfc.md)<br/>
[範例（MFC 功能套件）](../overview/visual-cpp-samples.md)
