---
title: 2.4.1 for 建構
ms.date: 11/04/2016
ms.assetid: 27d2cbce-786b-4819-91d3-d55b2cc57a5e
ms.openlocfilehash: adf2d5d0580f3b65f90ab68ca21885be12abf678
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/31/2018
ms.locfileid: "50496508"
---
# <a name="241-for-construct"></a>2.4.1 for 建構

**針對**指示詞會識別反覆工作共用建構，指定相關聯的迴圈的反覆項目，則會以平行方式執行。 反覆項目**針對**迴圈會分散到存在於小組執行平行建構，它會繫結的執行緒。 語法**針對**建構如下所示：

```
#pragma omp for [clause[[,] clause] ... ] new-line for-loop
```

子句可以是下列其中一項：

**private(** *variable-list* **)**

**firstprivate(** *variable-list* **)**

**lastprivate(** *variable-list* **)**

**減少 (** *運算子* **:** *變數清單* **)**

**排序**

**排程 (** *種類*[**，** *chunk_size*] **)**

**nowait**

**For**指示詞會置於對應的結構中的限制**如**迴圈。 具體來說，對應**針對**迴圈必須有標準的圖形：

**為 (** *init expr* **;***var 邏輯 op b*;*incr expr* **)**

*init expr*<br/>
下列其中一項：

*var* = *lb*

*整數型別 var* = *lb*

*incr expr*<br/>
下列其中一項：

++ *var*

*var* ++

-- *var*

*var* --

*var* += *incr*

*var* -= *incr*

*var* = *var* + *incr*

*var* = *incr* + *var*

*var* = *var* - *incr*

*var*<br/>
帶正負號的整數變數。 如果此變數會否則共用，它會隱含地變成私用的持續期間**針對**。   此變數不會修改主體內**針對**陳述式。 除非指定變數，否則**lastprivate**，不定迴圈之後其值。

*邏輯作業*<br/>
下列其中一項：

<

\<=

>

\>=

*lb*， *b*，和*incr*<br>
迴圈不變的整數運算式。 沒有任何同步處理，這些運算式的評估期間。 因此，任何評估的副作用產生未定的結果。

請注意，標準格式可讓要計算項目，以迴圈的迴圈反覆項目數目。 此計算執行中的型別具有值*var*之後整數提升。 特別是當值*b* - *lb* + *incr* ，型別，結果是無法確定無法表示。 此外，如果*邏輯 op*是 < 或\<= then *incr expr*必須造成*var*增加在迴圈的每個反覆項目。   如果*邏輯 op*是 > 或 > = then *incr expr*必須造成*var*減少在迴圈的每個反覆項目。

**排程**子句會指定如何的反覆項目**如**迴圈會分配給小組的執行緒。 程式的正確性不得相依於哪一個執行緒執行的特定反覆項目。 值*chunk_size*，如果指定，必須是正數值為迴圈而異的整數運算式。 沒有任何在此運算式的評估期間的同步處理。 因此，任何評估的副作用產生未定的結果。 排程*種類*可以是下列其中之一：

表 2-1**排程**子句*種類*值

|||
|-|-|
|靜態|當**排程 (靜態** *chunk_size* **)** 指定反覆項目分成區塊大小所指定的*chunk_size*。 區塊會以靜態方式指派順序執行緒編號以循環配置資源方式小組中的執行緒。 若未*chunk_size*指定時，反覆運算空間會分割成區塊 （chunk） 的其中一個指派給每個執行緒的區塊大小，大約等於。|
|動態|當**排程 (動態** *chunk_size* **)** 指定反覆項目可分為區塊，每個都包含一系列*chunk_size*反覆項目。 每個區塊會指派給正在等候指派的執行緒。 執行緒執行的反覆項目區塊，然後等到其下一步 的指派，任何區塊會保持指派。 請注意，若要指派的最後一個區塊可能會有較少的反覆項目。 若未*chunk_size*指定，則會預設為 1。|
|引導式|當**排程 (引導式，** *chunk_size* **)** 指定，以減少大小的區塊中的執行緒指派反覆項目。 當執行緒完成其指派的區塊的反覆項目時，它會動態指派另一個區塊，直到沒有任何存在。 針對*chunk_size*為 1，每個區塊的大小是大約未指派除以的執行緒數目的反覆項目數目。 這些大小以指數方式減少大約為 1 中。 針對*chunk_size*具有值*k*大於 1，大小減少大約為以指數方式*k*，差異在於最後一個區塊可能會有少於*k*反覆項目。 若未*chunk_size*指定，則會預設為 1。|
|執行階段|當**schedule （runtime)** 指定時，相關的排程會延後執行階段決定。 排程*種類*，而且可以在執行階段選擇區塊的大小，藉由設定環境變數**OMP_SCHEDULE**。 如果未設定這個環境變數，產生的排程是由實作定義。 當**schedule （runtime)** 指定，則*chunk_size*不得指定。|

沒有明確定義**排程**子句，則預設**排程**是由實作定義。

OpenMP 相容的程式不應依賴正確執行的特定排程。 程式不應依賴排程*種類*符合精確地提供上述的描述，因為它是可以在相同的排程的實作有變化*種類*跨不同的編譯器。 描述可用來選取的排程，適用於特定的情況。

**排序**子句必須要有何時**排序**指示詞將繫結至**如**建構。

結尾沒有隱含的障礙**for**建構，除非**nowait**指定子句。

若要限制**針對**指示詞如下所示：

- **For**迴圈必須是結構化的區塊中，且，此外，其執行必須不結束**中斷**陳述式。

- 值，迴圈的控制運算式**for**與相關聯的迴圈**如**指示詞必須是相同的小組中的所有執行緒。

- **針對**迴圈反覆項目變數必須具有帶正負號的整數類型。

- 只有一個**排程**子句可能會出現在**如**指示詞。

- 只有一個**排序**子句可能會出現在**如**指示詞。

- 只有一個**nowait**子句可能會出現在**如**指示詞。

- 如果未指定，或任何側邊效果內的頻率*chunk_size*， *lb*， *b*，或*incr*運算式就會發生。

- 值*chunk_size*運算式必須是相同的小組中的所有執行緒。

## <a name="cross-references"></a>交叉參考：

- **私用**， **firstprivate**， **lastprivate**，和**減少**子句，請參閱[區段 2.7.2](../../parallel/openmp/2-7-2-data-sharing-attribute-clauses.md) 25 頁上。

- **OMP_SCHEDULE**環境變數，請參閱[第 4.1 節](../../parallel/openmp/4-1-omp-schedule.md)48 頁上。

- **排序**建構，請參閱 <<c2> [ 一節 2.6.6](../../parallel/openmp/2-6-6-ordered-construct.md) 22 頁面上。

- [附錄 D](../../parallel/openmp/d-using-the-schedule-clause.md)，頁面 93，提供有關使用排程子句的詳細資訊。